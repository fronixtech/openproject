{"version":3,"mappings":"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AAwBA,IAAiBA,KACzC,gBAA4C/E,WAAoBA,KAChE,WACAhD,yCAGA,UAEA0H,yCAEA,QADA5H,KACAC,IAAyBA,mBAAuBA,IAChDD,oBAOA,QALAE,qBACA+H,KACA/E,KACAH,KACA8F,KACAQ,IAAwBA,IAAiBA,MACzC,WACA,MACAtG,KACA,qBAAwDkG,WAAgBA,KACxE,WACA/F,yCAEgB2R,EAAQ5M,uBACxBY,eAEA,QACA,wBAAsEY,WAAgBA,KACtFV,OACA7F,0CAIA,SACA,CACAkb,oBACAC,OACAC,WAGA,OAjHA,GAyHA,YAEA,aACA,+CAFIvE,EAASha,KAIbA,mCACA,8BACAG,KAAmBiH,OAAOlH,wCAAiE,wBAC3F,gBACAC,GAEAH,2CACA,0BAEAA,2CACA,oBACA,gBAGAE,EAFA,MAjBA,CAsBEkH,OASF,yBACA,MA+CA,kBACA,MAUA,cACA,SACA,gBACA,WACAnH,MACAyZ,WACA8E,qBACAjH,aAGA,gBAEA,IADApX,QACAmX,UACA,oBACApP,GACAuW,uBAIA,SA7BAC,MACAxW,KACA,gBACA,WACAlF,qBACA2b,gBAGA,SAxDAC,eACA5b,KACA,0BACAA,EAEA,2BACA,YAAoBA,WAAyBA,MAC7C,WACAsG,UACA,KACA,MACA,eACAJ,WAEA,GADA2V,qCACA5V,YACA,YACAF,+BACAG,mBAGA,CACA,IACAgC,UADAxB,4BACAxB,OACAlI,QAA2BkC,4BAC3BgJ,GACA2T,qCAIA/V,YACA,MACAoC,UADAxB,iBACAxB,OACAlI,QACAkC,KACA4c,WACAC,QACAC,aACAC,uCACAvF,oBACA8E,kCAEAtT,GACA2T,+BAqCA,yBACA5e,yBAEA0e,KAMA,gBACA,IACAxe,EACA+H,EAFAhI,4BAIA,WACA,QAAgCgI,WAA8BA,MAE9D,IADA/E,QACA+b,OACA,SAA0B9X,OAAelH,yBACzC,UACAC,IACA,SAEA6C,IACA,YAMA,QAAgCkF,WAA8BA,MAC9D,MACA,IADA/E,QACA+b,0BACA/e,IACA,OAIA,WACAA,GACA+e,OACAld,QACAmd,QAEA5H,aAEAvX,iBAEAG,EA9CAif,WACA7H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","names":["constructor","t","e","r","o","this","q","draggingDisabled","permissionDenied","I18n","fallback","destroyDrake","drake","destroy","registerDrag","dragula","containers","nativeElement","revertOnSpill","on","classList","add","isDragging$","next","dataset","dragHelperId","Ye","itemSelector","mirrorSelector","eventData","bind","handleDrop","draggableWorkPackages$","value","filter","id","handleDropError","length","concat","workPackageDisabledExplanation","workPackageDisabled","disabled","reason","authorisation","can","calendarService","dateEditable","text","find","u","moment","startDate","s","dueDate","diff","href","title","subject","duration","days","extendedProps","workPackage","U","l","factory","Xe","Ke","le","j","gn","unsaved_title","component","bn","xn","yn","mn","Sn","containerClasses","show","authorisationService","inputs","hideTableOptions","ngOnInit","super","wpTableFilters","hidden","push","setPartition","currentPartition","data","partition","staticQueryName","loadInitialQuery","reloadOnEventAdded","refresh","selectors","wn","se","N","Rn","xe","Qe","zn","Wn","jn","position","zIndex","bottom","left","background","borderColor","borderStyle","borderWidth","padding","fontSize","borderTopRightRadius","schedulerLicenseKey","a","optionRefiners","viewContainerAppends","Un","Ln","className","De","__proto__","Array","n","Object","apply","Pe","de","i","pt","ut","dt","passive","window","direction","style","document","ke","Xn","er","d","h","v","f","p","right","top","tr","c","nr","or","Yn","g","parentBound","naturalBound","elWidth","elHeight","textAlign","xScrollbarWidth","yScrollbarWidth","st","isRtl","ref","ar","Jn","el","pe","ur","pr","mt","shrinkWidths","forceYScrollbars","forceXScrollbars","scrollerClientWidths","scrollerClientHeights","sectionRowMaxHeights","m","b","S","_","role","width","B","cr","key","C","E","R","w","D","k","P","H","A","tableColGroupNode","tableMinWidth","clientWidth","clientHeight","expandRows","syncRowHeights","rowSyncHeights","reportRowHeightChange","V","L","ir","ln","Math","hasShrinkCol","totalColWidth","totalColMinWidth","allowXScrolling","cols","deps","ce","scrollGridImpl","years","months","hours","minutes","seconds","milliseconds","labelInterval","slotDuration","console","mr","St","yr","year","Z","month","week","weekday","hour","minute","omitZeroMinute","meridiem","br","start","ge","wr","Sr","date","T","hookProps","M","level","view","Rr","Er","dateMarker","dateEnv","viewApi","omitTime","colSpan","height","Cr","_r","Pr","end","unit","minWidth","Dr","dateProfile","isAxis","kr","omitTimeZoneOffset","Tr","Rt","cellElRefs","offsetWidth","Ir","dateSpan","range","allDay","dayEl","seg","Dt","gr","Ie","isStart","isEnd","Mr","Pt","extraClassNames","zr","resourceId","allDayDate","visibility","isTimeScale","ze","eventInstanceHeights","moreLinkHeights","index","span","thickness","hcoords","Or","_t","Et","businessHourSegs","Ar","Hr","Boolean","coords","positionToHit","rect","layer","Wr","bt","slatCoords","slotCushionMaxWidth","forceScrollLeft","type","isSticky","chunks","content","xt","liquid","Nr","viewSpec","sections","initialView","views","timeline","usesMinMaxTime","eventResizableFromStart","timelineDay","timelineWeek","weeks","timelineMonth","timelineYear","He","x","Zr","resourceStore","resourceEntityExpansions","Yr","$r","Jr","Kr","eo","eventUiBases","to","Ae","resources","url","method","startParam","endParam","timeZoneParam","extraParams","ao","parseMeta","meta","io","_raw","sourceId","sourceDefId","publicId","isFetching","latestFetchId","fetchRange","co","We","lo","uo","resourceSource","context","fetchId","rawResources","error","fo","parentId","children","businessHours","eventEditable","eventStartEditable","eventDurationEditable","eventConstraint","eventOverlap","eventAllow","eventClassNames","eventBackgroundColor","eventBorderColor","eventTextColor","eventColor","ui","editable","startEditable","durationEditable","constraint","overlap","allow","classNames","backgroundColor","textColor","color","je","ho","vo","go","mo","yo","resourceIds","resourceEditable","propName","propValue","oldResource","resource","revert","resourceHash","get","enumerable","configurable","$","constraints","standardProps","resourceSourceInput","Ao","initialResources","eventResourceEditable","refetchResourcesOnNavigate","resourceOrder","filterResourcesWithEvents","resourceGroupField","resourceAreaWidth","resourceAreaColumns","resourcesInitiallyExpanded","datesAboveResources","needsResourceData","resourceAreaHeaderClassNames","resourceAreaHeaderContent","resourceAreaHeaderDidMount","resourceAreaHeaderWillUnmount","resourceGroupLabelClassNames","resourceGroupLabelContent","resourceGroupLabelDidMount","resourceGroupLabelWillUnmount","resourceLabelClassNames","resourceLabelContent","resourceLabelDidMount","resourceLabelWillUnmount","resourceLaneClassNames","resourceLaneContent","resourceLaneDidMount","resourceLaneWillUnmount","resourceGroupLaneClassNames","resourceGroupLaneContent","resourceGroupLaneDidMount","resourceGroupLaneWillUnmount","No","resourcesSet","resourceAdd","resourceChange","resourceRemove","qo","didMount","Ne","ignoreRange","fetch","startStr","endStr","timeZone","Wo","message","jo","join","Lo","qe","Wt","extraHookProps","extraDataAttrs","extraDateSpan","jt","firstCol","lastCol","dateSelectionSegs","Y","fgEventSegs","bgEventSegs","eventDrag","eventResize","eventSelection","affectedInstances","segs","isEvent","resourceFields","Ut","Fo","Lt","Bo","ye","rowSpans","depth","isExpanded","hasChildren","group","spec","Vo","reducers","po","bo","isLoadingFuncs","eventRefiners","eventDefMemberAdders","isDraggableTransformers","optionDefaults","Ot","eventDragMutationMassagers","matchResourceId","setResourceId","eventDefMutationAppliers","dateSelectionTransformers","datePointTransforms","dateSpanTransforms","viewPropsTransformers","isPropsValid","splitProps","eventStore","ko","externalDefTransforms","eventDropTransformers","newResource","optionChangeHandlers","listenerRefiners","propSetHandlers","_o","Le","K","Jo","z","fieldValue","I","Xo","Gt","Ko","ni","groupValue","Bt","At","ti","Zt","$t","ai","si","li","ci","di","fi","rowElRefs","pi","vi","Nt","eventResizeSegs","rowNodes","Oe","gi","resourceAreaWidthOverride","clearTimeout","elRef","tableClassName","rowContent","outerContent","scrollerElRef","forceScrollTop","scrollTop","elementDraggingImpl","Jt","wi","bi","qt","mi","forceTimeScroll","spreadsheetColWidths","kt","superHeaderRendering","spreadsheetBodyRows","timeCols","timeBodyContent","hi","resourceScroll","headerClassNames","headerContent","headerDidMount","headerWillUnmount","cellClassNames","field","labelClassNames","labelContent","labelDidMount","labelWillUnmount","laneClassNames","laneContent","laneDidMount","laneWillUnmount","zo","isVGrouping","groupSpecs","colSpecs","orderSpecs","$o","qr","resourceTimeline","resourceTimelineDay","resourceTimelineWeek","resourceTimelineMonth","resourceTimelineYear","Map","getView","activeViews","J","detectChanges","viewContainerRef","createEmbeddedView","set","ngOnDestroy","destroyAll","from","values","forEach","destroyView","size","clear","destroyDetached","detachedViews","pop","markForDestruction","delete","indexOf","remove","F","we","Ve","Di","subtract","toDate","viewBox","oxw","calendar","Kt","isEmpty$","pipe","searchString$","getValue","showImage","empty_state","no_results","G","calendarDrag","querySpace","results","values$","elements","map","includes","actions$","ofType","placeholder","tn","X","wpFilters","updates$","_e","workPackageRemoved$","untilDestroyed","tt","searchWorkPackages","subscribe","isLoading$","rn","currentlyVisibleFilters","urlParamsHelper","filterBuilderFrom","addExistingFilters","apiV3Service","withOptionalProject","currentProject","work_packages","filtered","pageSize","O","notificationService","handleRawError","clearInput","showDisabledText","orientation","openStateLink","$state","Xt","workPackageId","tabIdentifier","query","filters","buildV3GetFilters","keys","operator","ee","te","autocomplete","Vi","currentProjectService","principals","alreadySelected","selectUser","selectAssignee","emit","ne","re","dropzoneHovered$","et","draggingItem$","event","dropzoneAllowed$","dragging","isHovering","canDrop","live$","capabilitiesResourceService","fetchCapabilities","_embedded","reduce","_links","principal","nt","principalIds$","showAddAssignee$","loadingIndicatorService","table","stop","add_existing","assignee","add_assignee","remove_assignee","noData","two_weeks","one_week","today","drag_here_to_remove","cannot_drag_here","updating","successful_update","principalsResourceService","byIds","resizeObserver","initializeCalendar","projectIdentifier","identifier","ucCalendar","getApi","refetchEvents","resize$","updateSize","params$","fetchPrincipals","principals$","getResources","self","addResource","name","statuses","resizeObs","disconnect","configuration","initialized","then","calendarOptions$","calendarOptions","selectable","plugins","Ci","titleFormat","day","buttonText","headerToolbar","center","slotLabelFormat","html","resourceTimelineTwoWeeks","dateIncrement","progressiveEventRendering","eventSources","events","calendarEventsFunction","display","select","handleDateClicked","renderTemplate","resourceContent","unrenderTemplate","droppable","updateEvent","eventDragStart","source","pointerEvents","addBackgroundEvents","eventDragStop","removeProperty","removeBackGroundEvents","eventDrop","eventReceive","dispatch","eventContent","eventId","eventWillUnmount","currentWorkPackages$","ot","assigneeCaps$","Mn","clearLoading","mapToCalendarEvents","viewLookup","removeExternalEvents","updateTimeframe","loading$","setTimeout","complete","toastService","addSuccess","isDraggedEvent","domNodes","rootNodes","toISOString","timeText","isDragging","toString","isResizing","showAssigneeAddRow","addAssignee","findIndex","replace","modify","removeAssignee","isWpEndDateInCurrentView","currentEnd","setHours","Date","isWpStartDateInCurrentView","currentStart","isStatusClosed","status","isClosed","removeEvent","halEditing","edit","setValue","saveChangeset","wpAssignee","eventConstraints","wpStartDate","wpEndDate","openNewSplitCreate","getEndDateFromTimestamp","defaults","requestedState","keepTab","goCurrentDetailsState","goCurrentShowState","shouldShowAsGhost","updateDates","projectedResource","addLoading","save","halNotification","showError","schemaCache","of","writable","isAttributeEditable","project","eventDate","format","toggleAddExistingPane","showAddExistingPane","addExistingToggle","blur","getEvents","Ee","addEvent","oe","Ce","ba","parent","redirectTo","vn","params","query_id","dynamic","cdate","cview","query_props","bodyClasses","baseRoute","hn","Q","wa","$e","states","Se","W","cn","dn","fn","un","Sa"],"sources":["./src/app/features/team-planner/team-planner/calendar-drag-drop.service.ts","./src/app/features/team-planner/team-planner/planner/team-planner.actions.ts","./src/app/features/work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.html","./src/app/features/team-planner/team-planner/page/team-planner-page.component.ts","./node_modules/@fullcalendar/premium-common/main.js","webpack:///tslib?8da9","webpack:///tslib?5c80","./node_modules/@fullcalendar/scrollgrid/main.js","./node_modules/@fullcalendar/timeline/main.js","webpack:///tslib?9277","./node_modules/@fullcalendar/resource-common/main.js","webpack:///tslib?0abe","./node_modules/@fullcalendar/resource-timeline/main.js","./src/app/features/team-planner/team-planner/planner/event-view-lookup.service.ts","./src/app/features/team-planner/team-planner/planner/loading-skeleton-data.ts","./src/app/features/team-planner/team-planner/add-work-packages/add-existing-pane.component.html","./src/app/features/team-planner/team-planner/add-work-packages/add-existing-pane.component.ts","./src/app/shared/components/op-content-loader/op-principal-loading-skeleton/op-principal-loading-skeleton.component.ts","./src/app/shared/components/op-content-loader/op-principal-loading-skeleton/op-principal-loading-skeleton.component.html","./src/app/features/team-planner/team-planner/assignee/add-assignee.component.ts","./src/app/features/team-planner/team-planner/assignee/add-assignee.component.html","./src/app/shared/components/op-content-loader/op-wp-loading-skeleton/op-wp-loading-skeleton.component.ts","./src/app/shared/components/op-content-loader/op-wp-loading-skeleton/op-wp-loading-skeleton.component.html","./src/app/features/team-planner/team-planner/planner/team-planner.component.html","./src/app/features/team-planner/team-planner/planner/team-planner.component.ts","./src/app/features/team-planner/team-planner/team-planner.routes.ts","./src/app/features/team-planner/team-planner/team-planner.module.ts"],"sourcesContent":["import {\n  ElementRef,\n  Injectable,\n} from '@angular/core';\nimport { ThirdPartyDraggable } from '@fullcalendar/interaction';\nimport { DragMetaInput } from '@fullcalendar/common';\nimport { Drake } from 'dragula';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { BehaviorSubject } from 'rxjs';\nimport { SchemaCacheService } from 'core-app/core/schemas/schema-cache.service';\nimport { AuthorisationService } from 'core-app/core/model-auth/model-auth.service';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { OpCalendarService } from 'core-app/features/calendar/op-calendar.service';\n\n@Injectable()\nexport class CalendarDragDropService {\n  drake:Drake;\n\n  draggableWorkPackages$ = new BehaviorSubject<WorkPackageResource[]>([]);\n\n  isDragging$ = new BehaviorSubject<string|undefined>(undefined);\n\n  text = {\n    draggingDisabled: {\n      permissionDenied: this.I18n.t('js.team_planner.modify.errors.permission_denied'),\n      fallback: this.I18n.t('js.team_planner.modify.errors.fallback'),\n    },\n  };\n\n  constructor(\n    readonly authorisation:AuthorisationService,\n    readonly schemaCache:SchemaCacheService,\n    readonly calendarService:OpCalendarService,\n    readonly I18n:I18nService,\n  ) {\n  }\n\n  destroyDrake():void {\n    if (this.drake) {\n      this.drake.destroy();\n    }\n  }\n\n  registerDrag(container:ElementRef, itemSelector:string):void {\n    this.drake = dragula({\n      containers: [container.nativeElement],\n      revertOnSpill: true,\n    });\n\n    this.drake.on('drag', (el:HTMLElement) => {\n      el.classList.add('gu-transit');\n      this.isDragging$.next(el.dataset.dragHelperId);\n    });\n\n    this.drake.on('dragend', () => {\n      this.isDragging$.next(undefined);\n    });\n\n    // eslint-disable-next-line no-new\n    new ThirdPartyDraggable(container.nativeElement, {\n      itemSelector,\n      mirrorSelector: '.gu-mirror', // the dragging element that dragula renders\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n      eventData: this.eventData.bind(this),\n    });\n  }\n\n  handleDrop(workPackage:WorkPackageResource):void {\n    this.draggableWorkPackages$\n      .next(this\n        .draggableWorkPackages$\n        .value\n        .filter((wp) => wp.id !== workPackage.id));\n  }\n\n  handleDropError(workPackage:WorkPackageResource):void {\n    const oldDraggables = this.draggableWorkPackages$.value;\n    const isElementStillVisible = oldDraggables.filter((wp) => wp.id === workPackage.id).length === 1;\n\n    if (!isElementStillVisible) {\n      this.draggableWorkPackages$\n        .next(oldDraggables.concat(workPackage));\n    }\n  }\n\n  workPackageDisabledExplanation(workPackage:WorkPackageResource):string {\n    const isDisabled = this.workPackageDisabled(workPackage);\n\n    if (isDisabled.disabled && isDisabled.reason) {\n      return isDisabled.reason;\n    }\n\n    return '';\n  }\n\n  private workPackageDisabled(workPackage:WorkPackageResource):{ disabled:boolean, reason?:string } {\n    if (!this.authorisation.can('work_packages', 'editWorkPackage')) {\n      return { disabled: true, reason: this.text.draggingDisabled.permissionDenied };\n    }\n\n    if (!this.calendarService.dateEditable(workPackage)) {\n      return { disabled: true, reason: this.text.draggingDisabled.fallback };\n    }\n\n    return { disabled: false };\n  }\n\n  private eventData(eventEl:HTMLElement):undefined|DragMetaInput {\n    const wpID = eventEl.dataset.dragHelperId;\n    if (!wpID) {\n      return undefined;\n    }\n\n    const workPackage = this.draggableWorkPackages$.value.find((wp) => wp.id === wpID);\n    if (!workPackage) {\n      return undefined;\n    }\n\n    const startDate = moment(workPackage.startDate);\n    const dueDate = moment(workPackage.dueDate);\n    const diff = dueDate.diff(startDate, 'days') + 1;\n\n    return {\n      id: `${workPackage.href as string}-external`,\n      title: workPackage.subject,\n      duration: {\n        days: diff || 1,\n      },\n      extendedProps: {\n        workPackage,\n      },\n    };\n  }\n}\n","import { ID } from '@datorama/akita';\nimport {\n  action,\n  props,\n} from 'ts-action';\n\nexport const teamPlannerEventRemoved = action(\n  '[Team planner] Event removed from team planner',\n  props<{ workPackage:ID }>(),\n);\n\nexport const teamPlannerEventAdded = action(\n  '[Team planner] External event added to the team planner',\n  props<{ workPackage:ID }>(),\n);\n","<div class=\"work-packages-partitioned-query-space--container\"\n     [ngClass]=\"currentPartition\">\n  <div class=\"toolbar-container -editable\">\n    <div class=\"toolbar\">\n      <op-back-button *ngIf=\"backButtonCallback\"\n                      class=\"op-back-button\"\n                      linkClass=\"op-back-button_mobile-full-width\"\n                      [customBackMethod]=\"backButtonCallback\">\n      </op-back-button>\n\n      <editable-toolbar-title [title]=\"selectedTitle\"\n                              [inFlight]=\"toolbarDisabled\"\n                              [showSaveCondition]=\"showToolbarSaveButton\"\n                              (onSave)=\"changeChangesFromTitle($event)\"\n                              (onEmptySubmit)=\"updateTitleName('')\"\n                              [editable]=\"titleEditingEnabled\">\n      </editable-toolbar-title>\n\n      <ul class=\"toolbar-items hide-when-print\"\n          *ngIf=\"showToolbar\">\n        <ng-container *ngFor=\"let definition of toolbarButtonComponents\">\n          <li class=\"toolbar-item\"\n              *ngIf=\"!definition.show || definition.show()\"\n              [ngClass]=\"definition.containerClasses\">\n            <ndc-dynamic [ndcDynamicComponent]=\"definition.component\"\n                         [ndcDynamicInputs]=\"definition.inputs\"\n                         [ndcDynamicInjector]=\"injector\"\n                         [ndcDynamicOutputs]=\"definition.outputs\">\n            </ndc-dynamic>\n          </li>\n        </ng-container>\n      </ul>\n    </div>\n  </div>\n\n  <div class=\"work-packages-partitioned-query-space--filter-area\">\n    <ndc-dynamic *ngIf=\"filterContainerDefinition\"\n                 [ndcDynamicComponent]=\"filterContainerDefinition.component\"\n                 [ndcDynamicInputs]=\"filterContainerDefinition.inputs\"\n                 [ndcDynamicOutputs]=\"filterContainerDefinition.outputs\"\n                 [ndcDynamicInjector]=\"injector\">\n    </ndc-dynamic>\n  </div>\n\n  <div class=\"work-packages-partitioned-page--content-container\">\n    <!-- Left content view -->\n    <div class=\"work-packages-partitioned-page--content-left loading-indicator--location\"\n         data-indicator-name=\"table\"\n         ui-view=\"content-left\">\n    </div>\n\n    <!-- Right content view -->\n    <div class=\"work-packages-partitioned-page--content-right\"\n         ui-view=\"content-right\"></div>\n  </div>\n</div>\n","import {\n  ChangeDetectionStrategy,\n  Component,\n  OnInit,\n} from '@angular/core';\nimport {\n  DynamicComponentDefinition,\n  PartitionedQuerySpacePageComponent,\n  ToolbarButtonComponentDefinition,\n  ViewPartitionState,\n} from 'core-app/features/work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component';\nimport { ZenModeButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/zen-mode-toggle-button/zen-mode-toggle-button.component';\nimport { WorkPackageFilterButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/wp-filter-button/wp-filter-button.component';\nimport { WorkPackageFilterContainerComponent } from 'core-app/features/work-packages/components/filters/filter-container/filter-container.directive';\nimport { QueryParamListenerService } from 'core-app/features/work-packages/components/wp-query/query-param-listener.service';\nimport { QueryResource } from 'core-app/features/hal/resources/query-resource';\nimport { WorkPackageSettingsButtonComponent } from 'core-app/features/work-packages/components/wp-buttons/wp-settings-button/wp-settings-button.component';\nimport { CalendarDragDropService } from 'core-app/features/team-planner/team-planner/calendar-drag-drop.service';\nimport { OpProjectIncludeComponent } from 'core-app/shared/components/project-include/project-include.component';\nimport {\n  EffectCallback,\n  EffectHandler,\n} from 'core-app/core/state/effects/effect-handler.decorator';\nimport { teamPlannerEventAdded } from 'core-app/features/team-planner/team-planner/planner/team-planner.actions';\nimport { InjectField } from 'core-app/shared/helpers/angular/inject-field.decorator';\nimport { ActionsService } from 'core-app/core/state/actions/actions.service';\nimport { OpCalendarService } from 'core-app/features/calendar/op-calendar.service';\n\n@EffectHandler\n@Component({\n  templateUrl: '../../../work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.html',\n  styleUrls: [\n    '../../../work-packages/routing/partitioned-query-space-page/partitioned-query-space-page.component.sass',\n  ],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    QueryParamListenerService,\n    OpCalendarService,\n    CalendarDragDropService,\n  ],\n})\nexport class TeamPlannerPageComponent extends PartitionedQuerySpacePageComponent implements OnInit {\n  @InjectField() actions$:ActionsService;\n\n  text = {\n    title: this.I18n.t('js.team_planner.title'),\n    unsaved_title: this.I18n.t('js.team_planner.unsaved_title'),\n  };\n\n  /** Go back using back-button */\n  backButtonCallback:() => void;\n\n  /** Current query title to render */\n  selectedTitle = this.text.unsaved_title;\n\n  filterContainerDefinition:DynamicComponentDefinition = {\n    component: WorkPackageFilterContainerComponent,\n  };\n\n  /** We need to pass the correct partition state to the view to manage the grid */\n  currentPartition:ViewPartitionState = '-split';\n\n  /** Show a toolbar */\n  showToolbar = true;\n\n  /** Toolbar is not editable */\n  titleEditingEnabled = false;\n\n  /** Savable */\n  showToolbarSaveButton = true;\n\n  /** Toolbar is always enabled */\n  toolbarDisabled = false;\n\n  /** Define the buttons shown in the toolbar */\n  toolbarButtonComponents:ToolbarButtonComponentDefinition[] = [\n    {\n      component: OpProjectIncludeComponent,\n    },\n    {\n      component: WorkPackageFilterButtonComponent,\n    },\n    {\n      component: ZenModeButtonComponent,\n    },\n    {\n      component: WorkPackageSettingsButtonComponent,\n      containerClasses: 'hidden-for-mobile',\n      show: ():boolean => this.authorisationService.can('query', 'updateImmediately'),\n      inputs: {\n        hideTableOptions: true,\n      },\n    },\n  ];\n\n  public ngOnInit():void {\n    super.ngOnInit();\n\n    this.wpTableFilters.hidden.push(\n      'assignee',\n      'startDate',\n      'dueDate',\n      'memberOfGroup',\n      'assignedToRole',\n      'assigneeOrGroup',\n      'project',\n    );\n  }\n\n  /**\n   * We need to set the current partition to the grid to ensure\n   * either side gets expanded to full width if we're not in '-split' mode.\n   *\n   * @param state The current or entering state\n   */\n  setPartition(state:{ data:{ partition?:ViewPartitionState } }):void {\n    this.currentPartition = state.data?.partition || '-split';\n  }\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  protected staticQueryName(query:QueryResource):string {\n    return this.text.unsaved_title;\n  }\n\n  /**\n   * @protected\n   */\n  protected loadInitialQuery():void {\n    // We never load the initial query as the calendar service does all that.\n  }\n\n  /**\n   * Reload the team planner page if an external event was added.\n   * This is currently not handled by the HalEvents system, as it only\n   * detects updates to _existing_ or created events already rendered.\n   */\n  @EffectCallback(teamPlannerEventAdded)\n  reloadOnEventAdded():void {\n    void this.refresh(false, false);\n  }\n}\n","/*!\nFullCalendar Scheduler v5.10.1\nDocs & License: https://fullcalendar.io/scheduler\n(c) 2021 Adam Shaw\n*/\nimport { createElement, Fragment, config, isValidDate, addDays, createPlugin } from '@fullcalendar/common';\n\nvar RELEASE_DATE = '2021-11-03'; // for Scheduler\nvar UPGRADE_WINDOW = 365 + 7; // days. 1 week leeway, for tz shift reasons too\nvar INVALID_LICENSE_URL = 'http://fullcalendar.io/docs/schedulerLicenseKey#invalid';\nvar OUTDATED_LICENSE_URL = 'http://fullcalendar.io/docs/schedulerLicenseKey#outdated';\nvar PRESET_LICENSE_KEYS = [\n    'GPL-My-Project-Is-Open-Source',\n    'CC-Attribution-NonCommercial-NoDerivatives',\n];\nvar CSS = {\n    position: 'absolute',\n    zIndex: 99999,\n    bottom: '1px',\n    left: '1px',\n    background: '#eee',\n    borderColor: '#ddd',\n    borderStyle: 'solid',\n    borderWidth: '1px 1px 0 0',\n    padding: '2px 4px',\n    fontSize: '12px',\n    borderTopRightRadius: '3px',\n};\nfunction buildLicenseWarning(context) {\n    var key = context.options.schedulerLicenseKey;\n    var currentUrl = typeof window !== 'undefined' ? window.location.href : '';\n    if (!isImmuneUrl(currentUrl)) {\n        var status_1 = processLicenseKey(key);\n        if (status_1 !== 'valid') {\n            return (createElement(\"div\", { className: \"fc-license-message\", style: CSS }, (status_1 === 'outdated') ? (createElement(Fragment, null,\n                'Your license key is too old to work with this version. ',\n                createElement(\"a\", { href: OUTDATED_LICENSE_URL }, \"More Info\"))) : (createElement(Fragment, null,\n                'Your license key is invalid. ',\n                createElement(\"a\", { href: INVALID_LICENSE_URL }, \"More Info\")))));\n        }\n    }\n    return null;\n}\n/*\nThis decryption is not meant to be bulletproof. Just a way to remind about an upgrade.\n*/\nfunction processLicenseKey(key) {\n    if (PRESET_LICENSE_KEYS.indexOf(key) !== -1) {\n        return 'valid';\n    }\n    var parts = (key || '').match(/^(\\d+)-fcs-(\\d+)$/);\n    if (parts && (parts[1].length === 10)) {\n        var purchaseDate = new Date(parseInt(parts[2], 10) * 1000);\n        var releaseDate = new Date(config.mockSchedulerReleaseDate || RELEASE_DATE);\n        if (isValidDate(releaseDate)) { // token won't be replaced in dev mode\n            var minPurchaseDate = addDays(releaseDate, -UPGRADE_WINDOW);\n            if (minPurchaseDate < purchaseDate) {\n                return 'valid';\n            }\n            return 'outdated';\n        }\n    }\n    return 'invalid';\n}\nfunction isImmuneUrl(url) {\n    return /\\w+:\\/\\/fullcalendar\\.io\\/|\\/examples\\/[\\w-]+\\.html$/.test(url);\n}\n\nvar OPTION_REFINERS = {\n    schedulerLicenseKey: String,\n};\n\nvar main = createPlugin({\n    optionRefiners: OPTION_REFINERS,\n    viewContainerAppends: [buildLicenseWarning],\n});\n\nexport default main;\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","/*!\nFullCalendar Scheduler v5.10.1\nDocs & License: https://fullcalendar.io/scheduler\n(c) 2021 Adam Shaw\n*/\nimport { Emitter, DelayedRunner, removeElement, computeEdges, findElements, translateRect, computeInnerRect, applyStyle, createRef, setRef, getIsRtlScrollbarOnLeft, createElement, Scroller, isPropsEqual, BaseComponent, memoizeArraylike, renderMicroColGroup, RefMap, memoizeHashlike, getScrollGridClassNames, getCanVGrowWithinCell, Fragment, getSectionClassNames, getAllowYScrolling, getSectionHasLiquidHeight, renderChunkContent, config, computeShrinkWidth, getScrollbarWidths, collectFromHash, mapHash, isArraysEqual, sanitizeShrinkWidth, hasShrinkWidth, compareObjs, isColPropsEqual, createPlugin } from '@fullcalendar/common';\nimport premiumCommonPlugin from '@fullcalendar/premium-common';\nimport { __extends, __assign, __spreadArray } from 'tslib';\n\nvar WHEEL_EVENT_NAMES = 'wheel mousewheel DomMouseScroll MozMousePixelScroll'.split(' ');\n/*\nALSO, with the ability to disable touch\n*/\nvar ScrollListener = /** @class */ (function () {\n    function ScrollListener(el) {\n        var _this = this;\n        this.el = el;\n        this.emitter = new Emitter();\n        this.isScrolling = false;\n        this.isTouching = false; // user currently has finger down?\n        this.isRecentlyWheeled = false;\n        this.isRecentlyScrolled = false;\n        this.wheelWaiter = new DelayedRunner(this._handleWheelWaited.bind(this));\n        this.scrollWaiter = new DelayedRunner(this._handleScrollWaited.bind(this));\n        // Handlers\n        // ----------------------------------------------------------------------------------------------\n        this.handleScroll = function () {\n            _this.startScroll();\n            _this.emitter.trigger('scroll', _this.isRecentlyWheeled, _this.isTouching);\n            _this.isRecentlyScrolled = true;\n            _this.scrollWaiter.request(500);\n        };\n        // will fire *before* the scroll event is fired (might not cause a scroll)\n        this.handleWheel = function () {\n            _this.isRecentlyWheeled = true;\n            _this.wheelWaiter.request(500);\n        };\n        // will fire *before* the scroll event is fired (might not cause a scroll)\n        this.handleTouchStart = function () {\n            _this.isTouching = true;\n        };\n        this.handleTouchEnd = function () {\n            _this.isTouching = false;\n            // if the user ended their touch, and the scroll area wasn't moving,\n            // we consider this to be the end of the scroll.\n            if (!_this.isRecentlyScrolled) {\n                _this.endScroll(); // won't fire if already ended\n            }\n        };\n        el.addEventListener('scroll', this.handleScroll);\n        el.addEventListener('touchstart', this.handleTouchStart, { passive: true });\n        el.addEventListener('touchend', this.handleTouchEnd);\n        for (var _i = 0, WHEEL_EVENT_NAMES_1 = WHEEL_EVENT_NAMES; _i < WHEEL_EVENT_NAMES_1.length; _i++) {\n            var eventName = WHEEL_EVENT_NAMES_1[_i];\n            el.addEventListener(eventName, this.handleWheel);\n        }\n    }\n    ScrollListener.prototype.destroy = function () {\n        var el = this.el;\n        el.removeEventListener('scroll', this.handleScroll);\n        el.removeEventListener('touchstart', this.handleTouchStart, { passive: true });\n        el.removeEventListener('touchend', this.handleTouchEnd);\n        for (var _i = 0, WHEEL_EVENT_NAMES_2 = WHEEL_EVENT_NAMES; _i < WHEEL_EVENT_NAMES_2.length; _i++) {\n            var eventName = WHEEL_EVENT_NAMES_2[_i];\n            el.removeEventListener(eventName, this.handleWheel);\n        }\n    };\n    // Start / Stop\n    // ----------------------------------------------------------------------------------------------\n    ScrollListener.prototype.startScroll = function () {\n        if (!this.isScrolling) {\n            this.isScrolling = true;\n            this.emitter.trigger('scrollStart', this.isRecentlyWheeled, this.isTouching);\n        }\n    };\n    ScrollListener.prototype.endScroll = function () {\n        if (this.isScrolling) {\n            this.emitter.trigger('scrollEnd');\n            this.isScrolling = false;\n            this.isRecentlyScrolled = true;\n            this.isRecentlyWheeled = false;\n            this.scrollWaiter.clear();\n            this.wheelWaiter.clear();\n        }\n    };\n    ScrollListener.prototype._handleScrollWaited = function () {\n        this.isRecentlyScrolled = false;\n        // only end the scroll if not currently touching.\n        // if touching, the scrolling will end later, on touchend.\n        if (!this.isTouching) {\n            this.endScroll(); // won't fire if already ended\n        }\n    };\n    ScrollListener.prototype._handleWheelWaited = function () {\n        this.isRecentlyWheeled = false;\n    };\n    return ScrollListener;\n}());\n\n// TODO: assume the el has no borders?\nfunction getScrollCanvasOrigin(scrollEl) {\n    var rect = scrollEl.getBoundingClientRect();\n    var edges = computeEdges(scrollEl); // TODO: pass in isRtl?\n    return {\n        left: rect.left + edges.borderLeft + edges.scrollbarLeft - getScrollFromLeftEdge(scrollEl),\n        top: rect.top + edges.borderTop - scrollEl.scrollTop,\n    };\n}\nfunction getScrollFromLeftEdge(el) {\n    var scrollLeft = el.scrollLeft;\n    var computedStyles = window.getComputedStyle(el); // TODO: pass in isRtl instead?\n    if (computedStyles.direction === 'rtl') {\n        switch (getRtlScrollSystem()) {\n            case 'negative':\n                scrollLeft *= -1; // convert to 'reverse'. fall through...\n            case 'reverse': // scrollLeft is distance between scrollframe's right edge scrollcanvas's right edge\n                scrollLeft = el.scrollWidth - scrollLeft - el.clientWidth;\n        }\n    }\n    return scrollLeft;\n}\nfunction setScrollFromLeftEdge(el, scrollLeft) {\n    var computedStyles = window.getComputedStyle(el); // TODO: pass in isRtl instead?\n    if (computedStyles.direction === 'rtl') {\n        switch (getRtlScrollSystem()) {\n            case 'reverse':\n                scrollLeft = el.scrollWidth - scrollLeft;\n                break;\n            case 'negative':\n                scrollLeft = -(el.scrollWidth - scrollLeft);\n                break;\n        }\n    }\n    el.scrollLeft = scrollLeft;\n}\n// Horizontal Scroll System Detection\n// ----------------------------------------------------------------------------------------------\nvar _rtlScrollSystem;\nfunction getRtlScrollSystem() {\n    return _rtlScrollSystem || (_rtlScrollSystem = detectRtlScrollSystem());\n}\nfunction detectRtlScrollSystem() {\n    var el = document.createElement('div');\n    el.style.position = 'absolute';\n    el.style.top = '-1000px';\n    el.style.width = '1px';\n    el.style.height = '1px';\n    el.style.overflow = 'scroll';\n    el.style.direction = 'rtl';\n    el.style.fontSize = '100px';\n    el.innerHTML = 'A';\n    document.body.appendChild(el);\n    var system;\n    if (el.scrollLeft > 0) {\n        system = 'positive'; // scroll is a positive number from the left edge\n    }\n    else {\n        el.scrollLeft = 1;\n        if (el.scrollLeft > 0) {\n            system = 'reverse'; // scroll is a positive number from the right edge\n        }\n        else {\n            system = 'negative'; // scroll is a negative number from the right edge\n        }\n    }\n    removeElement(el);\n    return system;\n}\n\nvar IS_MS_EDGE = typeof navigator !== 'undefined' && /Edge/.test(navigator.userAgent); // TODO: what about Chromeum-based Edge?\nvar STICKY_SELECTOR = '.fc-sticky';\n/*\nuseful beyond the native position:sticky for these reasons:\n- support in IE11\n- nice centering support\n\nREQUIREMENT: fc-sticky elements, if the fc-sticky className is taken away, should NOT have relative or absolute positioning.\nThis is because we attach the coords with JS, and the VDOM might take away the fc-sticky class but doesn't know kill the positioning.\n\nTODO: don't query text-align:center. isn't compatible with flexbox centering. instead, check natural X coord within parent container\n*/\nvar StickyScrolling = /** @class */ (function () {\n    function StickyScrolling(scrollEl, isRtl) {\n        var _this = this;\n        this.scrollEl = scrollEl;\n        this.isRtl = isRtl;\n        this.usingRelative = null;\n        this.updateSize = function () {\n            var scrollEl = _this.scrollEl;\n            var els = findElements(scrollEl, STICKY_SELECTOR);\n            var elGeoms = _this.queryElGeoms(els);\n            var viewportWidth = scrollEl.clientWidth;\n            var viewportHeight = scrollEl.clientHeight;\n            if (_this.usingRelative) {\n                var elDestinations = _this.computeElDestinations(elGeoms, viewportWidth); // read before prepPositioning\n                assignRelativePositions(els, elGeoms, elDestinations, viewportWidth, viewportHeight);\n            }\n            else {\n                assignStickyPositions(els, elGeoms, viewportWidth);\n            }\n        };\n        this.usingRelative =\n            !getStickySupported() || // IE11\n                // https://stackoverflow.com/questions/56835658/in-microsoft-edge-sticky-positioning-doesnt-work-when-combined-with-dir-rtl\n                (IS_MS_EDGE && isRtl);\n        if (this.usingRelative) {\n            this.listener = new ScrollListener(scrollEl);\n            this.listener.emitter.on('scrollEnd', this.updateSize);\n        }\n    }\n    StickyScrolling.prototype.destroy = function () {\n        if (this.listener) {\n            this.listener.destroy();\n        }\n    };\n    StickyScrolling.prototype.queryElGeoms = function (els) {\n        var _a = this, scrollEl = _a.scrollEl, isRtl = _a.isRtl;\n        var canvasOrigin = getScrollCanvasOrigin(scrollEl);\n        var elGeoms = [];\n        for (var _i = 0, els_1 = els; _i < els_1.length; _i++) {\n            var el = els_1[_i];\n            var parentBound = translateRect(computeInnerRect(el.parentNode, true, true), // weird way to call this!!!\n            -canvasOrigin.left, -canvasOrigin.top);\n            var elRect = el.getBoundingClientRect();\n            var computedStyles = window.getComputedStyle(el);\n            var textAlign = window.getComputedStyle(el.parentNode).textAlign; // ask the parent\n            var naturalBound = null;\n            if (textAlign === 'start') {\n                textAlign = isRtl ? 'right' : 'left';\n            }\n            else if (textAlign === 'end') {\n                textAlign = isRtl ? 'left' : 'right';\n            }\n            if (computedStyles.position !== 'sticky') {\n                naturalBound = translateRect(elRect, -canvasOrigin.left - (parseFloat(computedStyles.left) || 0), // could be 'auto'\n                -canvasOrigin.top - (parseFloat(computedStyles.top) || 0));\n            }\n            elGeoms.push({\n                parentBound: parentBound,\n                naturalBound: naturalBound,\n                elWidth: elRect.width,\n                elHeight: elRect.height,\n                textAlign: textAlign,\n            });\n        }\n        return elGeoms;\n    };\n    // only for IE\n    StickyScrolling.prototype.computeElDestinations = function (elGeoms, viewportWidth) {\n        var scrollEl = this.scrollEl;\n        var viewportTop = scrollEl.scrollTop;\n        var viewportLeft = getScrollFromLeftEdge(scrollEl);\n        var viewportRight = viewportLeft + viewportWidth;\n        return elGeoms.map(function (elGeom) {\n            var elWidth = elGeom.elWidth, elHeight = elGeom.elHeight, parentBound = elGeom.parentBound, naturalBound = elGeom.naturalBound;\n            var destLeft; // relative to canvas topleft\n            var destTop; // \"\n            switch (elGeom.textAlign) {\n                case 'left':\n                    destLeft = viewportLeft;\n                    break;\n                case 'right':\n                    destLeft = viewportRight - elWidth;\n                    break;\n                case 'center':\n                    destLeft = (viewportLeft + viewportRight) / 2 - elWidth / 2; /// noooo, use half-width insteadddddddd\n                    break;\n            }\n            destLeft = Math.min(destLeft, parentBound.right - elWidth);\n            destLeft = Math.max(destLeft, parentBound.left);\n            destTop = viewportTop;\n            destTop = Math.min(destTop, parentBound.bottom - elHeight);\n            destTop = Math.max(destTop, naturalBound.top); // better to use natural top for upper bound\n            return { left: destLeft, top: destTop };\n        });\n    };\n    return StickyScrolling;\n}());\nfunction assignRelativePositions(els, elGeoms, elDestinations, viewportWidth, viewportHeight) {\n    els.forEach(function (el, i) {\n        var _a = elGeoms[i], naturalBound = _a.naturalBound, parentBound = _a.parentBound;\n        var parentWidth = parentBound.right - parentBound.left;\n        var parentHeight = parentBound.bottom - parentBound.bottom;\n        var left;\n        var top;\n        if (parentWidth > viewportWidth ||\n            parentHeight > viewportHeight) {\n            left = elDestinations[i].left - naturalBound.left;\n            top = elDestinations[i].top - naturalBound.top;\n        }\n        else { // if parent container can be completely in view, we don't need stickiness\n            left = '';\n            top = '';\n        }\n        applyStyle(el, {\n            position: 'relative',\n            left: left,\n            right: -left,\n            top: top,\n        });\n    });\n}\nfunction assignStickyPositions(els, elGeoms, viewportWidth) {\n    els.forEach(function (el, i) {\n        var _a = elGeoms[i], textAlign = _a.textAlign, elWidth = _a.elWidth, parentBound = _a.parentBound;\n        var parentWidth = parentBound.right - parentBound.left;\n        var left;\n        if (textAlign === 'center' &&\n            parentWidth > viewportWidth) {\n            left = (viewportWidth - elWidth) / 2;\n        }\n        else { // if parent container can be completely in view, we don't need stickiness\n            left = '';\n        }\n        applyStyle(el, {\n            left: left,\n            right: left,\n            top: 0,\n        });\n    });\n}\nvar _isStickySupported;\nfunction getStickySupported() {\n    if (_isStickySupported == null) {\n        _isStickySupported = computeStickySupported();\n    }\n    return _isStickySupported;\n}\nfunction computeStickySupported() {\n    var el = document.createElement('div');\n    el.style.position = 'sticky';\n    document.body.appendChild(el);\n    var val = window.getComputedStyle(el).position;\n    removeElement(el);\n    return val === 'sticky';\n}\n\nvar ClippedScroller = /** @class */ (function (_super) {\n    __extends(ClippedScroller, _super);\n    function ClippedScroller() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.elRef = createRef();\n        _this.state = {\n            xScrollbarWidth: 0,\n            yScrollbarWidth: 0,\n        };\n        _this.handleScroller = function (scroller) {\n            _this.scroller = scroller;\n            setRef(_this.props.scrollerRef, scroller);\n        };\n        _this.handleSizing = function () {\n            var props = _this.props;\n            if (props.overflowY === 'scroll-hidden') {\n                _this.setState({ yScrollbarWidth: _this.scroller.getYScrollbarWidth() });\n            }\n            if (props.overflowX === 'scroll-hidden') {\n                _this.setState({ xScrollbarWidth: _this.scroller.getXScrollbarWidth() });\n            }\n        };\n        return _this;\n    }\n    ClippedScroller.prototype.render = function () {\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var isScrollbarOnLeft = context.isRtl && getIsRtlScrollbarOnLeft();\n        var overcomeLeft = 0;\n        var overcomeRight = 0;\n        var overcomeBottom = 0;\n        if (props.overflowX === 'scroll-hidden') {\n            overcomeBottom = state.xScrollbarWidth;\n        }\n        if (props.overflowY === 'scroll-hidden') {\n            if (state.yScrollbarWidth != null) {\n                if (isScrollbarOnLeft) {\n                    overcomeLeft = state.yScrollbarWidth;\n                }\n                else {\n                    overcomeRight = state.yScrollbarWidth;\n                }\n            }\n        }\n        return (createElement(\"div\", { ref: this.elRef, className: 'fc-scroller-harness' + (props.liquid ? ' fc-scroller-harness-liquid' : '') },\n            createElement(Scroller, { ref: this.handleScroller, elRef: this.props.scrollerElRef, overflowX: props.overflowX === 'scroll-hidden' ? 'scroll' : props.overflowX, overflowY: props.overflowY === 'scroll-hidden' ? 'scroll' : props.overflowY, overcomeLeft: overcomeLeft, overcomeRight: overcomeRight, overcomeBottom: overcomeBottom, maxHeight: typeof props.maxHeight === 'number'\n                    ? (props.maxHeight + (props.overflowX === 'scroll-hidden' ? state.xScrollbarWidth : 0))\n                    : '', liquid: props.liquid, liquidIsAbsolute: true }, props.children)));\n    };\n    ClippedScroller.prototype.componentDidMount = function () {\n        this.handleSizing();\n        this.context.addResizeHandler(this.handleSizing);\n    };\n    ClippedScroller.prototype.componentDidUpdate = function (prevProps) {\n        if (!isPropsEqual(prevProps, this.props)) { // an external change?\n            this.handleSizing();\n        }\n    };\n    ClippedScroller.prototype.componentWillUnmount = function () {\n        this.context.removeResizeHandler(this.handleSizing);\n    };\n    ClippedScroller.prototype.needsXScrolling = function () {\n        return this.scroller.needsXScrolling();\n    };\n    ClippedScroller.prototype.needsYScrolling = function () {\n        return this.scroller.needsYScrolling();\n    };\n    return ClippedScroller;\n}(BaseComponent));\n\nvar ScrollSyncer = /** @class */ (function () {\n    function ScrollSyncer(isVertical, scrollEls) {\n        var _this = this;\n        this.isVertical = isVertical;\n        this.scrollEls = scrollEls;\n        this.isPaused = false;\n        this.scrollListeners = scrollEls.map(function (el) { return _this.bindScroller(el); });\n    }\n    ScrollSyncer.prototype.destroy = function () {\n        for (var _i = 0, _a = this.scrollListeners; _i < _a.length; _i++) {\n            var scrollListener = _a[_i];\n            scrollListener.destroy();\n        }\n    };\n    ScrollSyncer.prototype.bindScroller = function (el) {\n        var _this = this;\n        var _a = this, scrollEls = _a.scrollEls, isVertical = _a.isVertical;\n        var scrollListener = new ScrollListener(el);\n        var onScroll = function (isWheel, isTouch) {\n            if (!_this.isPaused) {\n                if (!_this.masterEl || (_this.masterEl !== el && (isWheel || isTouch))) {\n                    _this.assignMaster(el);\n                }\n                if (_this.masterEl === el) { // dealing with current\n                    for (var _i = 0, scrollEls_1 = scrollEls; _i < scrollEls_1.length; _i++) {\n                        var otherEl = scrollEls_1[_i];\n                        if (otherEl !== el) {\n                            if (isVertical) {\n                                otherEl.scrollTop = el.scrollTop;\n                            }\n                            else {\n                                otherEl.scrollLeft = el.scrollLeft;\n                            }\n                        }\n                    }\n                }\n            }\n        };\n        var onScrollEnd = function () {\n            if (_this.masterEl === el) {\n                _this.masterEl = null;\n            }\n        };\n        scrollListener.emitter.on('scroll', onScroll);\n        scrollListener.emitter.on('scrollEnd', onScrollEnd);\n        return scrollListener;\n    };\n    ScrollSyncer.prototype.assignMaster = function (el) {\n        this.masterEl = el;\n        for (var _i = 0, _a = this.scrollListeners; _i < _a.length; _i++) {\n            var scrollListener = _a[_i];\n            if (scrollListener.el !== el) {\n                scrollListener.endScroll(); // to prevent residual scrolls from reclaiming master\n            }\n        }\n    };\n    /*\n    will normalize the scrollLeft value\n    */\n    ScrollSyncer.prototype.forceScrollLeft = function (scrollLeft) {\n        this.isPaused = true;\n        for (var _i = 0, _a = this.scrollListeners; _i < _a.length; _i++) {\n            var listener = _a[_i];\n            setScrollFromLeftEdge(listener.el, scrollLeft);\n        }\n        this.isPaused = false;\n    };\n    ScrollSyncer.prototype.forceScrollTop = function (top) {\n        this.isPaused = true;\n        for (var _i = 0, _a = this.scrollListeners; _i < _a.length; _i++) {\n            var listener = _a[_i];\n            listener.el.scrollTop = top;\n        }\n        this.isPaused = false;\n    };\n    return ScrollSyncer;\n}());\n\n/*\nTODO: make <ScrollGridSection> subcomponent\nNOTE: doesn't support collapsibleWidth (which is sortof a hack anyway)\n*/\nvar ScrollGrid = /** @class */ (function (_super) {\n    __extends(ScrollGrid, _super);\n    function ScrollGrid() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.compileColGroupStats = memoizeArraylike(compileColGroupStat, isColGroupStatsEqual);\n        _this.renderMicroColGroups = memoizeArraylike(renderMicroColGroup); // yucky to memoize VNodes, but much more efficient for consumers\n        _this.clippedScrollerRefs = new RefMap();\n        // doesn't hold non-scrolling els used just for padding\n        _this.scrollerElRefs = new RefMap(_this._handleScrollerEl.bind(_this));\n        _this.chunkElRefs = new RefMap(_this._handleChunkEl.bind(_this));\n        _this.getStickyScrolling = memoizeArraylike(initStickyScrolling, null, destroyStickyScrolling);\n        _this.getScrollSyncersBySection = memoizeHashlike(initScrollSyncer.bind(_this, true), null, destroyScrollSyncer);\n        _this.getScrollSyncersByColumn = memoizeHashlike(initScrollSyncer.bind(_this, false), null, destroyScrollSyncer);\n        _this.stickyScrollings = [];\n        _this.scrollSyncersBySection = {};\n        _this.scrollSyncersByColumn = {};\n        // for row-height-syncing\n        _this.rowUnstableMap = new Map(); // no need to groom. always self-cancels\n        _this.rowInnerMaxHeightMap = new Map();\n        _this.anyRowHeightsChanged = false;\n        _this.recentSizingCnt = 0;\n        _this.state = {\n            shrinkWidths: [],\n            forceYScrollbars: false,\n            forceXScrollbars: false,\n            scrollerClientWidths: {},\n            scrollerClientHeights: {},\n            sectionRowMaxHeights: [],\n        };\n        _this.handleSizing = function (isForcedResize, sectionRowMaxHeightsChanged) {\n            if (!_this.allowSizing()) {\n                return;\n            }\n            if (!sectionRowMaxHeightsChanged) { // something else changed, probably external\n                _this.anyRowHeightsChanged = true;\n            }\n            var otherState = {};\n            // if reacting to self-change of sectionRowMaxHeightsChanged, or not stable, don't do anything\n            if (isForcedResize || (!sectionRowMaxHeightsChanged && !_this.rowUnstableMap.size)) {\n                otherState.sectionRowMaxHeights = _this.computeSectionRowMaxHeights();\n            }\n            _this.setState(__assign(__assign({ shrinkWidths: _this.computeShrinkWidths() }, _this.computeScrollerDims()), otherState), function () {\n                if (!_this.rowUnstableMap.size) {\n                    _this.updateStickyScrolling(); // needs to happen AFTER final positioning committed to DOM\n                }\n            });\n        };\n        _this.handleRowHeightChange = function (rowEl, isStable) {\n            var _a = _this, rowUnstableMap = _a.rowUnstableMap, rowInnerMaxHeightMap = _a.rowInnerMaxHeightMap;\n            if (!isStable) {\n                rowUnstableMap.set(rowEl, true);\n            }\n            else {\n                rowUnstableMap.delete(rowEl);\n                var innerMaxHeight = getRowInnerMaxHeight(rowEl);\n                if (!rowInnerMaxHeightMap.has(rowEl) || rowInnerMaxHeightMap.get(rowEl) !== innerMaxHeight) {\n                    rowInnerMaxHeightMap.set(rowEl, innerMaxHeight);\n                    _this.anyRowHeightsChanged = true;\n                }\n                if (!rowUnstableMap.size && _this.anyRowHeightsChanged) {\n                    _this.anyRowHeightsChanged = false;\n                    _this.setState({\n                        sectionRowMaxHeights: _this.computeSectionRowMaxHeights(),\n                    });\n                }\n            }\n        };\n        return _this;\n    }\n    ScrollGrid.prototype.render = function () {\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var shrinkWidths = state.shrinkWidths;\n        var colGroupStats = this.compileColGroupStats(props.colGroups.map(function (colGroup) { return [colGroup]; }));\n        var microColGroupNodes = this.renderMicroColGroups(colGroupStats.map(function (stat, i) { return [stat.cols, shrinkWidths[i]]; }));\n        var classNames = getScrollGridClassNames(props.liquid, context);\n        var _b = this.getDims(); _b[0]; _b[1];\n        // TODO: make DRY\n        var sectionConfigs = props.sections;\n        var configCnt = sectionConfigs.length;\n        var configI = 0;\n        var currentConfig;\n        var headSectionNodes = [];\n        var bodySectionNodes = [];\n        var footSectionNodes = [];\n        while (configI < configCnt && (currentConfig = sectionConfigs[configI]).type === 'header') {\n            headSectionNodes.push(this.renderSection(currentConfig, configI, colGroupStats, microColGroupNodes, state.sectionRowMaxHeights, true));\n            configI += 1;\n        }\n        while (configI < configCnt && (currentConfig = sectionConfigs[configI]).type === 'body') {\n            bodySectionNodes.push(this.renderSection(currentConfig, configI, colGroupStats, microColGroupNodes, state.sectionRowMaxHeights, false));\n            configI += 1;\n        }\n        while (configI < configCnt && (currentConfig = sectionConfigs[configI]).type === 'footer') {\n            footSectionNodes.push(this.renderSection(currentConfig, configI, colGroupStats, microColGroupNodes, state.sectionRowMaxHeights, true));\n            configI += 1;\n        }\n        var isBuggy = !getCanVGrowWithinCell(); // see NOTE in SimpleScrollGrid\n        var roleAttrs = { role: 'rowgroup' };\n        return createElement('table', {\n            ref: props.elRef,\n            role: 'grid',\n            className: classNames.join(' '),\n        }, renderMacroColGroup(colGroupStats, shrinkWidths), Boolean(!isBuggy && headSectionNodes.length) && createElement.apply(void 0, __spreadArray(['thead', roleAttrs], headSectionNodes)), Boolean(!isBuggy && bodySectionNodes.length) && createElement.apply(void 0, __spreadArray(['tbody', roleAttrs], bodySectionNodes)), Boolean(!isBuggy && footSectionNodes.length) && createElement.apply(void 0, __spreadArray(['tfoot', roleAttrs], footSectionNodes)), isBuggy && createElement.apply(void 0, __spreadArray(__spreadArray(__spreadArray(['tbody', roleAttrs], headSectionNodes), bodySectionNodes), footSectionNodes)));\n    };\n    ScrollGrid.prototype.renderSection = function (sectionConfig, sectionIndex, colGroupStats, microColGroupNodes, sectionRowMaxHeights, isHeader) {\n        var _this = this;\n        if ('outerContent' in sectionConfig) {\n            return (createElement(Fragment, { key: sectionConfig.key }, sectionConfig.outerContent));\n        }\n        return (createElement(\"tr\", { key: sectionConfig.key, role: \"presentation\", className: getSectionClassNames(sectionConfig, this.props.liquid).join(' ') }, sectionConfig.chunks.map(function (chunkConfig, i) { return _this.renderChunk(sectionConfig, sectionIndex, colGroupStats[i], microColGroupNodes[i], chunkConfig, i, (sectionRowMaxHeights[sectionIndex] || [])[i] || [], isHeader); })));\n    };\n    ScrollGrid.prototype.renderChunk = function (sectionConfig, sectionIndex, colGroupStat, microColGroupNode, chunkConfig, chunkIndex, rowHeights, isHeader) {\n        if ('outerContent' in chunkConfig) {\n            return (createElement(Fragment, { key: chunkConfig.key }, chunkConfig.outerContent));\n        }\n        var state = this.state;\n        var scrollerClientWidths = state.scrollerClientWidths, scrollerClientHeights = state.scrollerClientHeights;\n        var _a = this.getDims(), sectionCnt = _a[0], chunksPerSection = _a[1];\n        var index = sectionIndex * chunksPerSection + chunkIndex;\n        var sideScrollIndex = (!this.context.isRtl || getIsRtlScrollbarOnLeft()) ? chunksPerSection - 1 : 0;\n        var isVScrollSide = chunkIndex === sideScrollIndex;\n        var isLastSection = sectionIndex === sectionCnt - 1;\n        var forceXScrollbars = isLastSection && state.forceXScrollbars; // NOOOO can result in `null`\n        var forceYScrollbars = isVScrollSide && state.forceYScrollbars; // NOOOO can result in `null`\n        var allowXScrolling = colGroupStat && colGroupStat.allowXScrolling; // rename?\n        var allowYScrolling = getAllowYScrolling(this.props, sectionConfig); // rename? do in section func?\n        var chunkVGrow = getSectionHasLiquidHeight(this.props, sectionConfig); // do in section func?\n        var expandRows = sectionConfig.expandRows && chunkVGrow;\n        var tableMinWidth = (colGroupStat && colGroupStat.totalColMinWidth) || '';\n        var content = renderChunkContent(sectionConfig, chunkConfig, {\n            tableColGroupNode: microColGroupNode,\n            tableMinWidth: tableMinWidth,\n            clientWidth: scrollerClientWidths[index] !== undefined ? scrollerClientWidths[index] : null,\n            clientHeight: scrollerClientHeights[index] !== undefined ? scrollerClientHeights[index] : null,\n            expandRows: expandRows,\n            syncRowHeights: Boolean(sectionConfig.syncRowHeights),\n            rowSyncHeights: rowHeights,\n            reportRowHeightChange: this.handleRowHeightChange,\n        }, isHeader);\n        var overflowX = forceXScrollbars ? (isLastSection ? 'scroll' : 'scroll-hidden') :\n            !allowXScrolling ? 'hidden' :\n                (isLastSection ? 'auto' : 'scroll-hidden');\n        var overflowY = forceYScrollbars ? (isVScrollSide ? 'scroll' : 'scroll-hidden') :\n            !allowYScrolling ? 'hidden' :\n                (isVScrollSide ? 'auto' : 'scroll-hidden');\n        // it *could* be possible to reduce DOM wrappers by only doing a ClippedScroller when allowXScrolling or allowYScrolling,\n        // but if these values were to change, the inner components would be unmounted/remounted because of the parent change.\n        content = (createElement(ClippedScroller, { ref: this.clippedScrollerRefs.createRef(index), scrollerElRef: this.scrollerElRefs.createRef(index), overflowX: overflowX, overflowY: overflowY, liquid: chunkVGrow, maxHeight: sectionConfig.maxHeight }, content));\n        return createElement(isHeader ? 'th' : 'td', {\n            key: chunkConfig.key,\n            ref: this.chunkElRefs.createRef(index),\n            role: 'presentation',\n        }, content);\n    };\n    ScrollGrid.prototype.componentDidMount = function () {\n        this.updateScrollSyncers();\n        this.handleSizing(false);\n        this.context.addResizeHandler(this.handleSizing);\n    };\n    ScrollGrid.prototype.componentDidUpdate = function (prevProps, prevState) {\n        this.updateScrollSyncers();\n        // TODO: need better solution when state contains non-sizing things\n        this.handleSizing(false, prevState.sectionRowMaxHeights !== this.state.sectionRowMaxHeights);\n    };\n    ScrollGrid.prototype.componentWillUnmount = function () {\n        this.context.removeResizeHandler(this.handleSizing);\n        this.destroyStickyScrolling();\n        this.destroyScrollSyncers();\n    };\n    ScrollGrid.prototype.allowSizing = function () {\n        var now = new Date();\n        if (!this.lastSizingDate ||\n            now.valueOf() > this.lastSizingDate.valueOf() + config.SCROLLGRID_RESIZE_INTERVAL) {\n            this.lastSizingDate = now;\n            this.recentSizingCnt = 0;\n            return true;\n        }\n        return (this.recentSizingCnt += 1) <= 10;\n    };\n    ScrollGrid.prototype.computeShrinkWidths = function () {\n        var _this = this;\n        var colGroupStats = this.compileColGroupStats(this.props.colGroups.map(function (colGroup) { return [colGroup]; }));\n        var _a = this.getDims(), sectionCnt = _a[0], chunksPerSection = _a[1];\n        var cnt = sectionCnt * chunksPerSection;\n        var shrinkWidths = [];\n        colGroupStats.forEach(function (colGroupStat, i) {\n            if (colGroupStat.hasShrinkCol) {\n                var chunkEls = _this.chunkElRefs.collect(i, cnt, chunksPerSection); // in one col\n                shrinkWidths[i] = computeShrinkWidth(chunkEls);\n            }\n        });\n        return shrinkWidths;\n    };\n    // has the side effect of grooming rowInnerMaxHeightMap\n    // TODO: somehow short-circuit if there are no new height changes\n    ScrollGrid.prototype.computeSectionRowMaxHeights = function () {\n        var newHeightMap = new Map();\n        var _a = this.getDims(), sectionCnt = _a[0], chunksPerSection = _a[1];\n        var sectionRowMaxHeights = [];\n        for (var sectionI = 0; sectionI < sectionCnt; sectionI += 1) {\n            var sectionConfig = this.props.sections[sectionI];\n            var assignableHeights = []; // chunk, row\n            if (sectionConfig && sectionConfig.syncRowHeights) {\n                var rowHeightsByChunk = [];\n                for (var chunkI = 0; chunkI < chunksPerSection; chunkI += 1) {\n                    var index = sectionI * chunksPerSection + chunkI;\n                    var rowHeights = [];\n                    var chunkEl = this.chunkElRefs.currentMap[index];\n                    if (chunkEl) {\n                        rowHeights = findElements(chunkEl, '.fc-scrollgrid-sync-table tr').map(function (rowEl) {\n                            var max = getRowInnerMaxHeight(rowEl);\n                            newHeightMap.set(rowEl, max);\n                            return max;\n                        });\n                    }\n                    else {\n                        rowHeights = [];\n                    }\n                    rowHeightsByChunk.push(rowHeights);\n                }\n                var rowCnt = rowHeightsByChunk[0].length;\n                var isEqualRowCnt = true;\n                for (var chunkI = 1; chunkI < chunksPerSection; chunkI += 1) {\n                    var isOuterContent = sectionConfig.chunks[chunkI] && sectionConfig.chunks[chunkI].outerContent !== undefined; // can be null\n                    if (!isOuterContent && rowHeightsByChunk[chunkI].length !== rowCnt) { // skip outer content\n                        isEqualRowCnt = false;\n                        break;\n                    }\n                }\n                if (!isEqualRowCnt) {\n                    var chunkHeightSums = [];\n                    for (var chunkI = 0; chunkI < chunksPerSection; chunkI += 1) {\n                        chunkHeightSums.push(sumNumbers(rowHeightsByChunk[chunkI]) + rowHeightsByChunk[chunkI].length);\n                    }\n                    var maxTotalSum = Math.max.apply(Math, chunkHeightSums);\n                    for (var chunkI = 0; chunkI < chunksPerSection; chunkI += 1) {\n                        var rowInChunkCnt = rowHeightsByChunk[chunkI].length;\n                        var rowInChunkTotalHeight = maxTotalSum - rowInChunkCnt; // subtract border\n                        // height of non-first row. we do this to avoid rounding, because it's unreliable within a table\n                        var rowInChunkHeightOthers = Math.floor(rowInChunkTotalHeight / rowInChunkCnt);\n                        // whatever is leftover goes to the first row\n                        var rowInChunkHeightFirst = rowInChunkTotalHeight - rowInChunkHeightOthers * (rowInChunkCnt - 1);\n                        var rowInChunkHeights = [];\n                        var row = 0;\n                        if (row < rowInChunkCnt) {\n                            rowInChunkHeights.push(rowInChunkHeightFirst);\n                            row += 1;\n                        }\n                        while (row < rowInChunkCnt) {\n                            rowInChunkHeights.push(rowInChunkHeightOthers);\n                            row += 1;\n                        }\n                        assignableHeights.push(rowInChunkHeights);\n                    }\n                }\n                else {\n                    for (var chunkI = 0; chunkI < chunksPerSection; chunkI += 1) {\n                        assignableHeights.push([]);\n                    }\n                    for (var row = 0; row < rowCnt; row += 1) {\n                        var rowHeightsAcrossChunks = [];\n                        for (var chunkI = 0; chunkI < chunksPerSection; chunkI += 1) {\n                            var h = rowHeightsByChunk[chunkI][row];\n                            if (h != null) { // protect against outerContent\n                                rowHeightsAcrossChunks.push(h);\n                            }\n                        }\n                        var maxHeight = Math.max.apply(Math, rowHeightsAcrossChunks);\n                        for (var chunkI = 0; chunkI < chunksPerSection; chunkI += 1) {\n                            assignableHeights[chunkI].push(maxHeight);\n                        }\n                    }\n                }\n            }\n            sectionRowMaxHeights.push(assignableHeights);\n        }\n        this.rowInnerMaxHeightMap = newHeightMap;\n        return sectionRowMaxHeights;\n    };\n    ScrollGrid.prototype.computeScrollerDims = function () {\n        var scrollbarWidth = getScrollbarWidths();\n        var _a = this.getDims(), sectionCnt = _a[0], chunksPerSection = _a[1];\n        var sideScrollI = (!this.context.isRtl || getIsRtlScrollbarOnLeft()) ? chunksPerSection - 1 : 0;\n        var lastSectionI = sectionCnt - 1;\n        var currentScrollers = this.clippedScrollerRefs.currentMap;\n        var scrollerEls = this.scrollerElRefs.currentMap;\n        var forceYScrollbars = false;\n        var forceXScrollbars = false;\n        var scrollerClientWidths = {};\n        var scrollerClientHeights = {};\n        for (var sectionI = 0; sectionI < sectionCnt; sectionI += 1) { // along edge\n            var index = sectionI * chunksPerSection + sideScrollI;\n            var scroller = currentScrollers[index];\n            if (scroller && scroller.needsYScrolling()) {\n                forceYScrollbars = true;\n                break;\n            }\n        }\n        for (var chunkI = 0; chunkI < chunksPerSection; chunkI += 1) { // along last row\n            var index = lastSectionI * chunksPerSection + chunkI;\n            var scroller = currentScrollers[index];\n            if (scroller && scroller.needsXScrolling()) {\n                forceXScrollbars = true;\n                break;\n            }\n        }\n        for (var sectionI = 0; sectionI < sectionCnt; sectionI += 1) {\n            for (var chunkI = 0; chunkI < chunksPerSection; chunkI += 1) {\n                var index = sectionI * chunksPerSection + chunkI;\n                var scrollerEl = scrollerEls[index];\n                if (scrollerEl) {\n                    // TODO: weird way to get this. need harness b/c doesn't include table borders\n                    var harnessEl = scrollerEl.parentNode;\n                    scrollerClientWidths[index] = Math.floor(harnessEl.getBoundingClientRect().width - ((chunkI === sideScrollI && forceYScrollbars)\n                        ? scrollbarWidth.y // use global because scroller might not have scrollbars yet but will need them in future\n                        : 0));\n                    scrollerClientHeights[index] = Math.floor(harnessEl.getBoundingClientRect().height - ((sectionI === lastSectionI && forceXScrollbars)\n                        ? scrollbarWidth.x // use global because scroller might not have scrollbars yet but will need them in future\n                        : 0));\n                }\n            }\n        }\n        return { forceYScrollbars: forceYScrollbars, forceXScrollbars: forceXScrollbars, scrollerClientWidths: scrollerClientWidths, scrollerClientHeights: scrollerClientHeights };\n    };\n    ScrollGrid.prototype.updateStickyScrolling = function () {\n        var isRtl = this.context.isRtl;\n        var argsByKey = this.scrollerElRefs.getAll().map(function (scrollEl) { return [scrollEl, isRtl]; });\n        var stickyScrollings = this.getStickyScrolling(argsByKey);\n        stickyScrollings.forEach(function (stickyScrolling) { return stickyScrolling.updateSize(); });\n        this.stickyScrollings = stickyScrollings;\n    };\n    ScrollGrid.prototype.destroyStickyScrolling = function () {\n        this.stickyScrollings.forEach(destroyStickyScrolling);\n    };\n    ScrollGrid.prototype.updateScrollSyncers = function () {\n        var _a = this.getDims(), sectionCnt = _a[0], chunksPerSection = _a[1];\n        var cnt = sectionCnt * chunksPerSection;\n        var scrollElsBySection = {};\n        var scrollElsByColumn = {};\n        var scrollElMap = this.scrollerElRefs.currentMap;\n        for (var sectionI = 0; sectionI < sectionCnt; sectionI += 1) {\n            var startIndex = sectionI * chunksPerSection;\n            var endIndex = startIndex + chunksPerSection;\n            scrollElsBySection[sectionI] = collectFromHash(scrollElMap, startIndex, endIndex, 1); // use the filtered\n        }\n        for (var col = 0; col < chunksPerSection; col += 1) {\n            scrollElsByColumn[col] = this.scrollerElRefs.collect(col, cnt, chunksPerSection); // DON'T use the filtered\n        }\n        this.scrollSyncersBySection = this.getScrollSyncersBySection(scrollElsBySection);\n        this.scrollSyncersByColumn = this.getScrollSyncersByColumn(scrollElsByColumn);\n    };\n    ScrollGrid.prototype.destroyScrollSyncers = function () {\n        mapHash(this.scrollSyncersBySection, destroyScrollSyncer);\n        mapHash(this.scrollSyncersByColumn, destroyScrollSyncer);\n    };\n    ScrollGrid.prototype.getChunkConfigByIndex = function (index) {\n        var chunksPerSection = this.getDims()[1];\n        var sectionI = Math.floor(index / chunksPerSection);\n        var chunkI = index % chunksPerSection;\n        var sectionConfig = this.props.sections[sectionI];\n        return sectionConfig && sectionConfig.chunks[chunkI];\n    };\n    ScrollGrid.prototype.forceScrollLeft = function (col, scrollLeft) {\n        var scrollSyncer = this.scrollSyncersByColumn[col];\n        if (scrollSyncer) {\n            scrollSyncer.forceScrollLeft(scrollLeft);\n        }\n    };\n    ScrollGrid.prototype.forceScrollTop = function (sectionI, scrollTop) {\n        var scrollSyncer = this.scrollSyncersBySection[sectionI];\n        if (scrollSyncer) {\n            scrollSyncer.forceScrollTop(scrollTop);\n        }\n    };\n    ScrollGrid.prototype._handleChunkEl = function (chunkEl, key) {\n        var chunkConfig = this.getChunkConfigByIndex(parseInt(key, 10));\n        if (chunkConfig) { // null if section disappeared. bad, b/c won't null-set the elRef\n            setRef(chunkConfig.elRef, chunkEl);\n        }\n    };\n    ScrollGrid.prototype._handleScrollerEl = function (scrollerEl, key) {\n        var chunkConfig = this.getChunkConfigByIndex(parseInt(key, 10));\n        if (chunkConfig) { // null if section disappeared. bad, b/c won't null-set the elRef\n            setRef(chunkConfig.scrollerElRef, scrollerEl);\n        }\n    };\n    ScrollGrid.prototype.getDims = function () {\n        var sectionCnt = this.props.sections.length;\n        var chunksPerSection = sectionCnt ? this.props.sections[0].chunks.length : 0;\n        return [sectionCnt, chunksPerSection];\n    };\n    return ScrollGrid;\n}(BaseComponent));\nScrollGrid.addStateEquality({\n    shrinkWidths: isArraysEqual,\n    scrollerClientWidths: isPropsEqual,\n    scrollerClientHeights: isPropsEqual,\n});\nfunction sumNumbers(numbers) {\n    var sum = 0;\n    for (var _i = 0, numbers_1 = numbers; _i < numbers_1.length; _i++) {\n        var n = numbers_1[_i];\n        sum += n;\n    }\n    return sum;\n}\nfunction getRowInnerMaxHeight(rowEl) {\n    var innerHeights = findElements(rowEl, '.fc-scrollgrid-sync-inner').map(getElHeight);\n    if (innerHeights.length) {\n        return Math.max.apply(Math, innerHeights);\n    }\n    return 0;\n}\nfunction getElHeight(el) {\n    return el.offsetHeight; // better to deal with integers, for rounding, for PureComponent\n}\nfunction renderMacroColGroup(colGroupStats, shrinkWidths) {\n    var children = colGroupStats.map(function (colGroupStat, i) {\n        var width = colGroupStat.width;\n        if (width === 'shrink') {\n            width = colGroupStat.totalColWidth + sanitizeShrinkWidth(shrinkWidths[i]) + 1; // +1 for border :(\n        }\n        return ( // eslint-disable-next-line react/jsx-key\n        createElement(\"col\", { style: { width: width } }));\n    });\n    return createElement.apply(void 0, __spreadArray(['colgroup', {}], children));\n}\nfunction compileColGroupStat(colGroupConfig) {\n    var totalColWidth = sumColProp(colGroupConfig.cols, 'width'); // excludes \"shrink\"\n    var totalColMinWidth = sumColProp(colGroupConfig.cols, 'minWidth');\n    var hasShrinkCol = hasShrinkWidth(colGroupConfig.cols);\n    var allowXScrolling = colGroupConfig.width !== 'shrink' && Boolean(totalColWidth || totalColMinWidth || hasShrinkCol);\n    return {\n        hasShrinkCol: hasShrinkCol,\n        totalColWidth: totalColWidth,\n        totalColMinWidth: totalColMinWidth,\n        allowXScrolling: allowXScrolling,\n        cols: colGroupConfig.cols,\n        width: colGroupConfig.width,\n    };\n}\nfunction sumColProp(cols, propName) {\n    var total = 0;\n    for (var _i = 0, cols_1 = cols; _i < cols_1.length; _i++) {\n        var col = cols_1[_i];\n        var val = col[propName];\n        if (typeof val === 'number') {\n            total += val * (col.span || 1);\n        }\n    }\n    return total;\n}\nvar COL_GROUP_STAT_EQUALITY = {\n    cols: isColPropsEqual,\n};\nfunction isColGroupStatsEqual(stat0, stat1) {\n    return compareObjs(stat0, stat1, COL_GROUP_STAT_EQUALITY);\n}\n// for memoizers...\nfunction initScrollSyncer(isVertical) {\n    var scrollEls = [];\n    for (var _i = 1; _i < arguments.length; _i++) {\n        scrollEls[_i - 1] = arguments[_i];\n    }\n    return new ScrollSyncer(isVertical, scrollEls);\n}\nfunction destroyScrollSyncer(scrollSyncer) {\n    scrollSyncer.destroy();\n}\nfunction initStickyScrolling(scrollEl, isRtl) {\n    return new StickyScrolling(scrollEl, isRtl);\n}\nfunction destroyStickyScrolling(stickyScrolling) {\n    stickyScrolling.destroy();\n}\n\nvar main = createPlugin({\n    deps: [\n        premiumCommonPlugin,\n    ],\n    scrollGridImpl: ScrollGrid,\n});\nconfig.SCROLLGRID_RESIZE_INTERVAL = 500;\n\nexport default main;\nexport { ScrollGrid, setScrollFromLeftEdge };\n","/*!\nFullCalendar Scheduler v5.10.1\nDocs & License: https://fullcalendar.io/scheduler\n(c) 2021 Adam Shaw\n*/\nimport './main.css';\n\nimport { config, createFormatter, greatestDurationDenominator, asCleanDays, createDuration, wholeDivideDurations, asRoughMs, addDays, startOfDay, asRoughSeconds, asRoughMinutes, diffWholeDays, isInt, computeVisibleDayRange, padStart, createElement, ContentHook, BaseComponent, memoizeObjArg, buildClassNameNormalizer, memoize, getDateMeta, getSlotClassNames, getDayClassNames, MountHook, buildNavLinkAttrs, Fragment, rangeContainsMarker, PositionCache, findDirectChildren, createRef, NowTimer, NowIndicatorRoot, findElements, RenderHook, RefMap, multiplyDuration, SegHierarchy, groupIntersectingEntries, buildIsoString, computeEarliestSegStart, buildEventRangeKey, BgEvent, getSegMeta, renderFill, intersectRanges, addMs, Slicer, StandardEvent, MoreLinkRoot, setRef, sortEventSegs, mapHash, isPropsEqual, DateComponent, getStickyHeaderDates, getStickyFooterScrollbar, ViewRoot, renderScrollShim, createPlugin } from '@fullcalendar/common';\nimport premiumCommonPlugin from '@fullcalendar/premium-common';\nimport { __extends, __assign } from 'tslib';\nimport { ScrollGrid } from '@fullcalendar/scrollgrid';\n\nvar MIN_AUTO_LABELS = 18; // more than `12` months but less that `24` hours\nvar MAX_AUTO_SLOTS_PER_LABEL = 6; // allows 6 10-min slots in an hour\nvar MAX_AUTO_CELLS = 200; // allows 4-days to have a :30 slot duration\nconfig.MAX_TIMELINE_SLOTS = 1000;\n// potential nice values for slot-duration and interval-duration\nvar STOCK_SUB_DURATIONS = [\n    { years: 1 },\n    { months: 1 },\n    { days: 1 },\n    { hours: 1 },\n    { minutes: 30 },\n    { minutes: 15 },\n    { minutes: 10 },\n    { minutes: 5 },\n    { minutes: 1 },\n    { seconds: 30 },\n    { seconds: 15 },\n    { seconds: 10 },\n    { seconds: 5 },\n    { seconds: 1 },\n    { milliseconds: 500 },\n    { milliseconds: 100 },\n    { milliseconds: 10 },\n    { milliseconds: 1 },\n];\nfunction buildTimelineDateProfile(dateProfile, dateEnv, allOptions, dateProfileGenerator) {\n    var tDateProfile = {\n        labelInterval: allOptions.slotLabelInterval,\n        slotDuration: allOptions.slotDuration,\n    };\n    validateLabelAndSlot(tDateProfile, dateProfile, dateEnv); // validate after computed grid duration\n    ensureLabelInterval(tDateProfile, dateProfile, dateEnv);\n    ensureSlotDuration(tDateProfile, dateProfile, dateEnv);\n    var input = allOptions.slotLabelFormat;\n    var rawFormats = Array.isArray(input) ? input :\n        (input != null) ? [input] :\n            computeHeaderFormats(tDateProfile, dateProfile, dateEnv, allOptions);\n    tDateProfile.headerFormats = rawFormats.map(function (rawFormat) { return createFormatter(rawFormat); });\n    tDateProfile.isTimeScale = Boolean(tDateProfile.slotDuration.milliseconds);\n    var largeUnit = null;\n    if (!tDateProfile.isTimeScale) {\n        var slotUnit = greatestDurationDenominator(tDateProfile.slotDuration).unit;\n        if (/year|month|week/.test(slotUnit)) {\n            largeUnit = slotUnit;\n        }\n    }\n    tDateProfile.largeUnit = largeUnit;\n    tDateProfile.emphasizeWeeks =\n        asCleanDays(tDateProfile.slotDuration) === 1 &&\n            currentRangeAs('weeks', dateProfile, dateEnv) >= 2 &&\n            !allOptions.businessHours;\n    /*\n    console.log('label interval =', timelineView.labelInterval.humanize())\n    console.log('slot duration =', timelineView.slotDuration.humanize())\n    console.log('header formats =', timelineView.headerFormats)\n    console.log('isTimeScale', timelineView.isTimeScale)\n    console.log('largeUnit', timelineView.largeUnit)\n    */\n    var rawSnapDuration = allOptions.snapDuration;\n    var snapDuration;\n    var snapsPerSlot;\n    if (rawSnapDuration) {\n        snapDuration = createDuration(rawSnapDuration);\n        snapsPerSlot = wholeDivideDurations(tDateProfile.slotDuration, snapDuration);\n        // ^ TODO: warning if not whole?\n    }\n    if (snapsPerSlot == null) {\n        snapDuration = tDateProfile.slotDuration;\n        snapsPerSlot = 1;\n    }\n    tDateProfile.snapDuration = snapDuration;\n    tDateProfile.snapsPerSlot = snapsPerSlot;\n    // more...\n    var timeWindowMs = asRoughMs(dateProfile.slotMaxTime) - asRoughMs(dateProfile.slotMinTime);\n    // TODO: why not use normalizeRange!?\n    var normalizedStart = normalizeDate(dateProfile.renderRange.start, tDateProfile, dateEnv);\n    var normalizedEnd = normalizeDate(dateProfile.renderRange.end, tDateProfile, dateEnv);\n    // apply slotMinTime/slotMaxTime\n    // TODO: View should be responsible.\n    if (tDateProfile.isTimeScale) {\n        normalizedStart = dateEnv.add(normalizedStart, dateProfile.slotMinTime);\n        normalizedEnd = dateEnv.add(addDays(normalizedEnd, -1), dateProfile.slotMaxTime);\n    }\n    tDateProfile.timeWindowMs = timeWindowMs;\n    tDateProfile.normalizedRange = { start: normalizedStart, end: normalizedEnd };\n    var slotDates = [];\n    var date = normalizedStart;\n    while (date < normalizedEnd) {\n        if (isValidDate(date, tDateProfile, dateProfile, dateProfileGenerator)) {\n            slotDates.push(date);\n        }\n        date = dateEnv.add(date, tDateProfile.slotDuration);\n    }\n    tDateProfile.slotDates = slotDates;\n    // more...\n    var snapIndex = -1;\n    var snapDiff = 0; // index of the diff :(\n    var snapDiffToIndex = [];\n    var snapIndexToDiff = [];\n    date = normalizedStart;\n    while (date < normalizedEnd) {\n        if (isValidDate(date, tDateProfile, dateProfile, dateProfileGenerator)) {\n            snapIndex += 1;\n            snapDiffToIndex.push(snapIndex);\n            snapIndexToDiff.push(snapDiff);\n        }\n        else {\n            snapDiffToIndex.push(snapIndex + 0.5);\n        }\n        date = dateEnv.add(date, tDateProfile.snapDuration);\n        snapDiff += 1;\n    }\n    tDateProfile.snapDiffToIndex = snapDiffToIndex;\n    tDateProfile.snapIndexToDiff = snapIndexToDiff;\n    tDateProfile.snapCnt = snapIndex + 1; // is always one behind\n    tDateProfile.slotCnt = tDateProfile.snapCnt / tDateProfile.snapsPerSlot;\n    // more...\n    tDateProfile.isWeekStarts = buildIsWeekStarts(tDateProfile, dateEnv);\n    tDateProfile.cellRows = buildCellRows(tDateProfile, dateEnv);\n    tDateProfile.slotsPerLabel = wholeDivideDurations(tDateProfile.labelInterval, tDateProfile.slotDuration);\n    return tDateProfile;\n}\n/*\nsnaps to appropriate unit\n*/\nfunction normalizeDate(date, tDateProfile, dateEnv) {\n    var normalDate = date;\n    if (!tDateProfile.isTimeScale) {\n        normalDate = startOfDay(normalDate);\n        if (tDateProfile.largeUnit) {\n            normalDate = dateEnv.startOf(normalDate, tDateProfile.largeUnit);\n        }\n    }\n    return normalDate;\n}\n/*\nsnaps to appropriate unit\n*/\nfunction normalizeRange(range, tDateProfile, dateEnv) {\n    if (!tDateProfile.isTimeScale) {\n        range = computeVisibleDayRange(range);\n        if (tDateProfile.largeUnit) {\n            var dayRange = range; // preserve original result\n            range = {\n                start: dateEnv.startOf(range.start, tDateProfile.largeUnit),\n                end: dateEnv.startOf(range.end, tDateProfile.largeUnit),\n            };\n            // if date is partially through the interval, or is in the same interval as the start,\n            // make the exclusive end be the *next* interval\n            if (range.end.valueOf() !== dayRange.end.valueOf() || range.end <= range.start) {\n                range = {\n                    start: range.start,\n                    end: dateEnv.add(range.end, tDateProfile.slotDuration),\n                };\n            }\n        }\n    }\n    return range;\n}\nfunction isValidDate(date, tDateProfile, dateProfile, dateProfileGenerator) {\n    if (dateProfileGenerator.isHiddenDay(date)) {\n        return false;\n    }\n    if (tDateProfile.isTimeScale) {\n        // determine if the time is within slotMinTime/slotMaxTime, which may have wacky values\n        var day = startOfDay(date);\n        var timeMs = date.valueOf() - day.valueOf();\n        var ms = timeMs - asRoughMs(dateProfile.slotMinTime); // milliseconds since slotMinTime\n        ms = ((ms % 86400000) + 86400000) % 86400000; // make negative values wrap to 24hr clock\n        return ms < tDateProfile.timeWindowMs; // before the slotMaxTime?\n    }\n    return true;\n}\nfunction validateLabelAndSlot(tDateProfile, dateProfile, dateEnv) {\n    var currentRange = dateProfile.currentRange;\n    // make sure labelInterval doesn't exceed the max number of cells\n    if (tDateProfile.labelInterval) {\n        var labelCnt = dateEnv.countDurationsBetween(currentRange.start, currentRange.end, tDateProfile.labelInterval);\n        if (labelCnt > config.MAX_TIMELINE_SLOTS) {\n            console.warn('slotLabelInterval results in too many cells');\n            tDateProfile.labelInterval = null;\n        }\n    }\n    // make sure slotDuration doesn't exceed the maximum number of cells\n    if (tDateProfile.slotDuration) {\n        var slotCnt = dateEnv.countDurationsBetween(currentRange.start, currentRange.end, tDateProfile.slotDuration);\n        if (slotCnt > config.MAX_TIMELINE_SLOTS) {\n            console.warn('slotDuration results in too many cells');\n            tDateProfile.slotDuration = null;\n        }\n    }\n    // make sure labelInterval is a multiple of slotDuration\n    if (tDateProfile.labelInterval && tDateProfile.slotDuration) {\n        var slotsPerLabel = wholeDivideDurations(tDateProfile.labelInterval, tDateProfile.slotDuration);\n        if (slotsPerLabel === null || slotsPerLabel < 1) {\n            console.warn('slotLabelInterval must be a multiple of slotDuration');\n            tDateProfile.slotDuration = null;\n        }\n    }\n}\nfunction ensureLabelInterval(tDateProfile, dateProfile, dateEnv) {\n    var currentRange = dateProfile.currentRange;\n    var labelInterval = tDateProfile.labelInterval;\n    if (!labelInterval) {\n        // compute based off the slot duration\n        // find the largest label interval with an acceptable slots-per-label\n        var input = void 0;\n        if (tDateProfile.slotDuration) {\n            for (var _i = 0, STOCK_SUB_DURATIONS_1 = STOCK_SUB_DURATIONS; _i < STOCK_SUB_DURATIONS_1.length; _i++) {\n                input = STOCK_SUB_DURATIONS_1[_i];\n                var tryLabelInterval = createDuration(input);\n                var slotsPerLabel = wholeDivideDurations(tryLabelInterval, tDateProfile.slotDuration);\n                if (slotsPerLabel !== null && slotsPerLabel <= MAX_AUTO_SLOTS_PER_LABEL) {\n                    labelInterval = tryLabelInterval;\n                    break;\n                }\n            }\n            // use the slot duration as a last resort\n            if (!labelInterval) {\n                labelInterval = tDateProfile.slotDuration;\n            }\n            // compute based off the view's duration\n            // find the largest label interval that yields the minimum number of labels\n        }\n        else {\n            for (var _a = 0, STOCK_SUB_DURATIONS_2 = STOCK_SUB_DURATIONS; _a < STOCK_SUB_DURATIONS_2.length; _a++) {\n                input = STOCK_SUB_DURATIONS_2[_a];\n                labelInterval = createDuration(input);\n                var labelCnt = dateEnv.countDurationsBetween(currentRange.start, currentRange.end, labelInterval);\n                if (labelCnt >= MIN_AUTO_LABELS) {\n                    break;\n                }\n            }\n        }\n        tDateProfile.labelInterval = labelInterval;\n    }\n    return labelInterval;\n}\nfunction ensureSlotDuration(tDateProfile, dateProfile, dateEnv) {\n    var currentRange = dateProfile.currentRange;\n    var slotDuration = tDateProfile.slotDuration;\n    if (!slotDuration) {\n        var labelInterval = ensureLabelInterval(tDateProfile, dateProfile, dateEnv); // will compute if necessary\n        // compute based off the label interval\n        // find the largest slot duration that is different from labelInterval, but still acceptable\n        for (var _i = 0, STOCK_SUB_DURATIONS_3 = STOCK_SUB_DURATIONS; _i < STOCK_SUB_DURATIONS_3.length; _i++) {\n            var input = STOCK_SUB_DURATIONS_3[_i];\n            var trySlotDuration = createDuration(input);\n            var slotsPerLabel = wholeDivideDurations(labelInterval, trySlotDuration);\n            if (slotsPerLabel !== null && slotsPerLabel > 1 && slotsPerLabel <= MAX_AUTO_SLOTS_PER_LABEL) {\n                slotDuration = trySlotDuration;\n                break;\n            }\n        }\n        // only allow the value if it won't exceed the view's # of slots limit\n        if (slotDuration) {\n            var slotCnt = dateEnv.countDurationsBetween(currentRange.start, currentRange.end, slotDuration);\n            if (slotCnt > MAX_AUTO_CELLS) {\n                slotDuration = null;\n            }\n        }\n        // use the label interval as a last resort\n        if (!slotDuration) {\n            slotDuration = labelInterval;\n        }\n        tDateProfile.slotDuration = slotDuration;\n    }\n    return slotDuration;\n}\nfunction computeHeaderFormats(tDateProfile, dateProfile, dateEnv, allOptions) {\n    var format1;\n    var format2;\n    var labelInterval = tDateProfile.labelInterval;\n    var unit = greatestDurationDenominator(labelInterval).unit;\n    var weekNumbersVisible = allOptions.weekNumbers;\n    var format0 = (format1 = (format2 = null));\n    // NOTE: weekNumber computation function wont work\n    if ((unit === 'week') && !weekNumbersVisible) {\n        unit = 'day';\n    }\n    switch (unit) {\n        case 'year':\n            format0 = { year: 'numeric' }; // '2015'\n            break;\n        case 'month':\n            if (currentRangeAs('years', dateProfile, dateEnv) > 1) {\n                format0 = { year: 'numeric' }; // '2015'\n            }\n            format1 = { month: 'short' }; // 'Jan'\n            break;\n        case 'week':\n            if (currentRangeAs('years', dateProfile, dateEnv) > 1) {\n                format0 = { year: 'numeric' }; // '2015'\n            }\n            format1 = { week: 'narrow' }; // 'Wk4'\n            break;\n        case 'day':\n            if (currentRangeAs('years', dateProfile, dateEnv) > 1) {\n                format0 = { year: 'numeric', month: 'long' }; // 'January 2014'\n            }\n            else if (currentRangeAs('months', dateProfile, dateEnv) > 1) {\n                format0 = { month: 'long' }; // 'January'\n            }\n            if (weekNumbersVisible) {\n                format1 = { week: 'short' }; // 'Wk 4'\n            }\n            format2 = { weekday: 'narrow', day: 'numeric' }; // 'Su 9'\n            break;\n        case 'hour':\n            if (weekNumbersVisible) {\n                format0 = { week: 'short' }; // 'Wk 4'\n            }\n            if (currentRangeAs('days', dateProfile, dateEnv) > 1) {\n                format1 = { weekday: 'short', day: 'numeric', month: 'numeric', omitCommas: true }; // Sat 4/7\n            }\n            format2 = {\n                hour: 'numeric',\n                minute: '2-digit',\n                omitZeroMinute: true,\n                meridiem: 'short',\n            };\n            break;\n        case 'minute':\n            // sufficiently large number of different minute cells?\n            if ((asRoughMinutes(labelInterval) / 60) >= MAX_AUTO_SLOTS_PER_LABEL) {\n                format0 = {\n                    hour: 'numeric',\n                    meridiem: 'short',\n                };\n                format1 = function (params) { return (':' + padStart(params.date.minute, 2) // ':30'\n                ); };\n            }\n            else {\n                format0 = {\n                    hour: 'numeric',\n                    minute: 'numeric',\n                    meridiem: 'short',\n                };\n            }\n            break;\n        case 'second':\n            // sufficiently large number of different second cells?\n            if ((asRoughSeconds(labelInterval) / 60) >= MAX_AUTO_SLOTS_PER_LABEL) {\n                format0 = { hour: 'numeric', minute: '2-digit', meridiem: 'lowercase' }; // '8:30 PM'\n                format1 = function (params) { return (':' + padStart(params.date.second, 2) // ':30'\n                ); };\n            }\n            else {\n                format0 = { hour: 'numeric', minute: '2-digit', second: '2-digit', meridiem: 'lowercase' }; // '8:30:45 PM'\n            }\n            break;\n        case 'millisecond':\n            format0 = { hour: 'numeric', minute: '2-digit', second: '2-digit', meridiem: 'lowercase' }; // '8:30:45 PM'\n            format1 = function (params) { return ('.' + padStart(params.millisecond, 3)); };\n            break;\n    }\n    return [].concat(format0 || [], format1 || [], format2 || []);\n}\n// Compute the number of the give units in the \"current\" range.\n// Won't go more precise than days.\n// Will return `0` if there's not a clean whole interval.\nfunction currentRangeAs(unit, dateProfile, dateEnv) {\n    var range = dateProfile.currentRange;\n    var res = null;\n    if (unit === 'years') {\n        res = dateEnv.diffWholeYears(range.start, range.end);\n    }\n    else if (unit === 'months') {\n        res = dateEnv.diffWholeMonths(range.start, range.end);\n    }\n    else if (unit === 'weeks') {\n        res = dateEnv.diffWholeMonths(range.start, range.end);\n    }\n    else if (unit === 'days') {\n        res = diffWholeDays(range.start, range.end);\n    }\n    return res || 0;\n}\nfunction buildIsWeekStarts(tDateProfile, dateEnv) {\n    var slotDates = tDateProfile.slotDates, emphasizeWeeks = tDateProfile.emphasizeWeeks;\n    var prevWeekNumber = null;\n    var isWeekStarts = [];\n    for (var _i = 0, slotDates_1 = slotDates; _i < slotDates_1.length; _i++) {\n        var slotDate = slotDates_1[_i];\n        var weekNumber = dateEnv.computeWeekNumber(slotDate);\n        var isWeekStart = emphasizeWeeks && (prevWeekNumber !== null) && (prevWeekNumber !== weekNumber);\n        prevWeekNumber = weekNumber;\n        isWeekStarts.push(isWeekStart);\n    }\n    return isWeekStarts;\n}\nfunction buildCellRows(tDateProfile, dateEnv) {\n    var slotDates = tDateProfile.slotDates;\n    var formats = tDateProfile.headerFormats;\n    var cellRows = formats.map(function () { return []; }); // indexed by row,col\n    var slotAsDays = asCleanDays(tDateProfile.slotDuration);\n    var guessedSlotUnit = slotAsDays === 7 ? 'week' :\n        slotAsDays === 1 ? 'day' :\n            null;\n    // specifically for navclicks\n    var rowUnitsFromFormats = formats.map(function (format) { return (format.getLargestUnit ? format.getLargestUnit() : null); });\n    // builds cellRows and slotCells\n    for (var i = 0; i < slotDates.length; i += 1) {\n        var date = slotDates[i];\n        var isWeekStart = tDateProfile.isWeekStarts[i];\n        for (var row = 0; row < formats.length; row += 1) {\n            var format = formats[row];\n            var rowCells = cellRows[row];\n            var leadingCell = rowCells[rowCells.length - 1];\n            var isLastRow = row === formats.length - 1;\n            var isSuperRow = formats.length > 1 && !isLastRow; // more than one row and not the last\n            var newCell = null;\n            var rowUnit = rowUnitsFromFormats[row] || (isLastRow ? guessedSlotUnit : null);\n            if (isSuperRow) {\n                var text = dateEnv.format(date, format);\n                if (!leadingCell || (leadingCell.text !== text)) {\n                    newCell = buildCellObject(date, text, rowUnit);\n                }\n                else {\n                    leadingCell.colspan += 1;\n                }\n            }\n            else if (!leadingCell ||\n                isInt(dateEnv.countDurationsBetween(tDateProfile.normalizedRange.start, date, tDateProfile.labelInterval))) {\n                var text = dateEnv.format(date, format);\n                newCell = buildCellObject(date, text, rowUnit);\n            }\n            else {\n                leadingCell.colspan += 1;\n            }\n            if (newCell) {\n                newCell.weekStart = isWeekStart;\n                rowCells.push(newCell);\n            }\n        }\n    }\n    return cellRows;\n}\nfunction buildCellObject(date, text, rowUnit) {\n    return { date: date, text: text, rowUnit: rowUnit, colspan: 1, isWeekStart: false };\n}\n\nvar TimelineHeaderThInner = /** @class */ (function (_super) {\n    __extends(TimelineHeaderThInner, _super);\n    function TimelineHeaderThInner() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimelineHeaderThInner.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        return (createElement(ContentHook, { hookProps: props.hookProps, content: context.options.slotLabelContent, defaultContent: renderInnerContent }, function (innerElRef, innerContent) { return (createElement(\"a\", __assign({ ref: innerElRef, className: 'fc-timeline-slot-cushion fc-scrollgrid-sync-inner' + (props.isSticky ? ' fc-sticky' : '') }, props.navLinkAttrs), innerContent)); }));\n    };\n    return TimelineHeaderThInner;\n}(BaseComponent));\nfunction renderInnerContent(props) {\n    return props.text;\n}\nfunction refineHookProps(input) {\n    return {\n        level: input.level,\n        date: input.dateEnv.toDate(input.dateMarker),\n        view: input.viewApi,\n        text: input.text,\n    };\n}\n\nvar TimelineHeaderTh = /** @class */ (function (_super) {\n    __extends(TimelineHeaderTh, _super);\n    function TimelineHeaderTh() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.refineHookProps = memoizeObjArg(refineHookProps);\n        _this.normalizeClassNames = buildClassNameNormalizer();\n        _this.buildCellNavLinkAttrs = memoize(buildCellNavLinkAttrs);\n        return _this;\n    }\n    TimelineHeaderTh.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var dateEnv = context.dateEnv, options = context.options;\n        var cell = props.cell, dateProfile = props.dateProfile, tDateProfile = props.tDateProfile;\n        // the cell.rowUnit is f'd\n        // giving 'month' for a 3-day view\n        // workaround: to infer day, do NOT time\n        var dateMeta = getDateMeta(cell.date, props.todayRange, props.nowDate, dateProfile);\n        var classNames = ['fc-timeline-slot', 'fc-timeline-slot-label'].concat(cell.rowUnit === 'time' // TODO: so slot classnames for week/month/bigger. see note above about rowUnit\n            ? getSlotClassNames(dateMeta, context.theme)\n            : getDayClassNames(dateMeta, context.theme));\n        if (cell.isWeekStart) {\n            classNames.push('fc-timeline-slot-em');\n        }\n        var hookProps = this.refineHookProps({\n            level: props.rowLevel,\n            dateMarker: cell.date,\n            text: cell.text,\n            dateEnv: context.dateEnv,\n            viewApi: context.viewApi,\n        });\n        var customClassNames = this.normalizeClassNames(options.slotLabelClassNames, hookProps);\n        return (createElement(MountHook, { hookProps: hookProps, didMount: options.slotLabelDidMount, willUnmount: options.slotLabelWillUnmount }, function (rootElRef) { return (createElement(\"th\", { ref: rootElRef, className: classNames.concat(customClassNames).join(' '), \"data-date\": dateEnv.formatIso(cell.date, { omitTime: !tDateProfile.isTimeScale, omitTimeZoneOffset: true }), colSpan: cell.colspan },\n            createElement(\"div\", { className: \"fc-timeline-slot-frame\", style: { height: props.rowInnerHeight } },\n                createElement(TimelineHeaderThInner, { hookProps: hookProps, isSticky: props.isSticky, navLinkAttrs: _this.buildCellNavLinkAttrs(context, cell.date, cell.rowUnit) })))); }));\n    };\n    return TimelineHeaderTh;\n}(BaseComponent));\nfunction buildCellNavLinkAttrs(context, cellDate, rowUnit) {\n    return (rowUnit && rowUnit !== 'time')\n        ? buildNavLinkAttrs(context, cellDate, rowUnit)\n        : {};\n}\n\nvar TimelineHeaderRows = /** @class */ (function (_super) {\n    __extends(TimelineHeaderRows, _super);\n    function TimelineHeaderRows() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimelineHeaderRows.prototype.render = function () {\n        var _a = this.props, dateProfile = _a.dateProfile, tDateProfile = _a.tDateProfile, rowInnerHeights = _a.rowInnerHeights, todayRange = _a.todayRange, nowDate = _a.nowDate;\n        var cellRows = tDateProfile.cellRows;\n        return (createElement(Fragment, null, cellRows.map(function (rowCells, rowLevel) {\n            var isLast = rowLevel === cellRows.length - 1;\n            var isChrono = tDateProfile.isTimeScale && isLast; // the final row, with times?\n            var classNames = [\n                'fc-timeline-header-row',\n                isChrono ? 'fc-timeline-header-row-chrono' : '',\n            ];\n            return ( // eslint-disable-next-line react/no-array-index-key\n            createElement(\"tr\", { key: rowLevel, className: classNames.join(' ') }, rowCells.map(function (cell) { return (createElement(TimelineHeaderTh, { key: cell.date.toISOString(), cell: cell, rowLevel: rowLevel, dateProfile: dateProfile, tDateProfile: tDateProfile, todayRange: todayRange, nowDate: nowDate, rowInnerHeight: rowInnerHeights && rowInnerHeights[rowLevel], isSticky: !isLast })); })));\n        })));\n    };\n    return TimelineHeaderRows;\n}(BaseComponent));\n\nvar TimelineCoords = /** @class */ (function () {\n    function TimelineCoords(slatRootEl, // okay to expose?\n    slatEls, dateProfile, tDateProfile, dateEnv, isRtl) {\n        this.slatRootEl = slatRootEl;\n        this.dateProfile = dateProfile;\n        this.tDateProfile = tDateProfile;\n        this.dateEnv = dateEnv;\n        this.isRtl = isRtl;\n        this.outerCoordCache = new PositionCache(slatRootEl, slatEls, true, // isHorizontal\n        false);\n        // for the inner divs within the slats\n        // used for event rendering and scrollTime, to disregard slat border\n        this.innerCoordCache = new PositionCache(slatRootEl, findDirectChildren(slatEls, 'div'), true, // isHorizontal\n        false);\n    }\n    TimelineCoords.prototype.isDateInRange = function (date) {\n        return rangeContainsMarker(this.dateProfile.currentRange, date);\n    };\n    // results range from negative width of area to 0\n    TimelineCoords.prototype.dateToCoord = function (date) {\n        var tDateProfile = this.tDateProfile;\n        var snapCoverage = this.computeDateSnapCoverage(date);\n        var slotCoverage = snapCoverage / tDateProfile.snapsPerSlot;\n        var slotIndex = Math.floor(slotCoverage);\n        slotIndex = Math.min(slotIndex, tDateProfile.slotCnt - 1);\n        var partial = slotCoverage - slotIndex;\n        var _a = this, innerCoordCache = _a.innerCoordCache, outerCoordCache = _a.outerCoordCache;\n        if (this.isRtl) {\n            return outerCoordCache.originClientRect.width - (outerCoordCache.rights[slotIndex] -\n                (innerCoordCache.getWidth(slotIndex) * partial));\n        }\n        return (outerCoordCache.lefts[slotIndex] +\n            (innerCoordCache.getWidth(slotIndex) * partial));\n    };\n    TimelineCoords.prototype.rangeToCoords = function (range) {\n        return {\n            start: this.dateToCoord(range.start),\n            end: this.dateToCoord(range.end),\n        };\n    };\n    TimelineCoords.prototype.durationToCoord = function (duration) {\n        var _a = this, dateProfile = _a.dateProfile, tDateProfile = _a.tDateProfile, dateEnv = _a.dateEnv, isRtl = _a.isRtl;\n        var coord = 0;\n        if (dateProfile) {\n            var date = dateEnv.add(dateProfile.activeRange.start, duration);\n            if (!tDateProfile.isTimeScale) {\n                date = startOfDay(date);\n            }\n            coord = this.dateToCoord(date);\n            // hack to overcome the left borders of non-first slat\n            if (!isRtl && coord) {\n                coord += 1;\n            }\n        }\n        return coord;\n    };\n    TimelineCoords.prototype.coordFromLeft = function (coord) {\n        if (this.isRtl) {\n            return this.outerCoordCache.originClientRect.width - coord;\n        }\n        return coord;\n    };\n    // returned value is between 0 and the number of snaps\n    TimelineCoords.prototype.computeDateSnapCoverage = function (date) {\n        return computeDateSnapCoverage(date, this.tDateProfile, this.dateEnv);\n    };\n    return TimelineCoords;\n}());\n// returned value is between 0 and the number of snaps\nfunction computeDateSnapCoverage(date, tDateProfile, dateEnv) {\n    var snapDiff = dateEnv.countDurationsBetween(tDateProfile.normalizedRange.start, date, tDateProfile.snapDuration);\n    if (snapDiff < 0) {\n        return 0;\n    }\n    if (snapDiff >= tDateProfile.snapDiffToIndex.length) {\n        return tDateProfile.snapCnt;\n    }\n    var snapDiffInt = Math.floor(snapDiff);\n    var snapCoverage = tDateProfile.snapDiffToIndex[snapDiffInt];\n    if (isInt(snapCoverage)) { // not an in-between value\n        snapCoverage += snapDiff - snapDiffInt; // add the remainder\n    }\n    else {\n        // a fractional value, meaning the date is not visible\n        // always round up in this case. works for start AND end dates in a range.\n        snapCoverage = Math.ceil(snapCoverage);\n    }\n    return snapCoverage;\n}\nfunction coordToCss(hcoord, isRtl) {\n    if (hcoord === null) {\n        return { left: '', right: '' };\n    }\n    if (isRtl) {\n        return { right: hcoord, left: '' };\n    }\n    return { left: hcoord, right: '' };\n}\nfunction coordsToCss(hcoords, isRtl) {\n    if (!hcoords) {\n        return { left: '', right: '' };\n    }\n    if (isRtl) {\n        return { right: hcoords.start, left: -hcoords.end };\n    }\n    return { left: hcoords.start, right: -hcoords.end };\n}\n\nvar TimelineHeader = /** @class */ (function (_super) {\n    __extends(TimelineHeader, _super);\n    function TimelineHeader() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.rootElRef = createRef();\n        return _this;\n    }\n    TimelineHeader.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        // TODO: very repetitive\n        // TODO: make part of tDateProfile?\n        var timerUnit = greatestDurationDenominator(props.tDateProfile.slotDuration).unit;\n        // WORKAROUND: make ignore slatCoords when out of sync with dateProfile\n        var slatCoords = props.slatCoords && props.slatCoords.dateProfile === props.dateProfile ? props.slatCoords : null;\n        return (createElement(NowTimer, { unit: timerUnit }, function (nowDate, todayRange) { return (createElement(\"div\", { className: \"fc-timeline-header\", ref: _this.rootElRef },\n            createElement(\"table\", { \"aria-hidden\": true, className: \"fc-scrollgrid-sync-table\", style: { minWidth: props.tableMinWidth, width: props.clientWidth } },\n                props.tableColGroupNode,\n                createElement(\"tbody\", null,\n                    createElement(TimelineHeaderRows, { dateProfile: props.dateProfile, tDateProfile: props.tDateProfile, nowDate: nowDate, todayRange: todayRange, rowInnerHeights: props.rowInnerHeights }))),\n            context.options.nowIndicator && (\n            // need to have a container regardless of whether the current view has a visible now indicator\n            // because apparently removal of the element resets the scroll for some reasons (issue #5351).\n            // this issue doesn't happen for the timeline body however (\n            createElement(\"div\", { className: \"fc-timeline-now-indicator-container\" }, (slatCoords && slatCoords.isDateInRange(nowDate)) && (createElement(NowIndicatorRoot, { isAxis: true, date: nowDate }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"div\", { ref: rootElRef, className: ['fc-timeline-now-indicator-arrow'].concat(classNames).join(' '), style: coordToCss(slatCoords.dateToCoord(nowDate), context.isRtl) }, innerContent)); })))))); }));\n    };\n    TimelineHeader.prototype.componentDidMount = function () {\n        this.updateSize();\n    };\n    TimelineHeader.prototype.componentDidUpdate = function () {\n        this.updateSize();\n    };\n    TimelineHeader.prototype.updateSize = function () {\n        if (this.props.onMaxCushionWidth) {\n            this.props.onMaxCushionWidth(this.computeMaxCushionWidth());\n        }\n    };\n    TimelineHeader.prototype.computeMaxCushionWidth = function () {\n        return Math.max.apply(Math, findElements(this.rootElRef.current, '.fc-timeline-header-row:last-child .fc-timeline-slot-cushion').map(function (el) { return el.getBoundingClientRect().width; }));\n    };\n    return TimelineHeader;\n}(BaseComponent));\n\nvar TimelineSlatCell = /** @class */ (function (_super) {\n    __extends(TimelineSlatCell, _super);\n    function TimelineSlatCell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimelineSlatCell.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        var dateEnv = context.dateEnv, options = context.options, theme = context.theme;\n        var date = props.date, tDateProfile = props.tDateProfile, isEm = props.isEm;\n        var dateMeta = getDateMeta(props.date, props.todayRange, props.nowDate, props.dateProfile);\n        var classNames = ['fc-timeline-slot', 'fc-timeline-slot-lane'];\n        var dataAttrs = { 'data-date': dateEnv.formatIso(date, { omitTimeZoneOffset: true, omitTime: !tDateProfile.isTimeScale }) };\n        var hookProps = __assign(__assign({ date: dateEnv.toDate(props.date) }, dateMeta), { view: context.viewApi });\n        if (isEm) {\n            classNames.push('fc-timeline-slot-em');\n        }\n        if (tDateProfile.isTimeScale) {\n            classNames.push(isInt(dateEnv.countDurationsBetween(tDateProfile.normalizedRange.start, props.date, tDateProfile.labelInterval)) ?\n                'fc-timeline-slot-major' :\n                'fc-timeline-slot-minor');\n        }\n        classNames.push.apply(classNames, (props.isDay\n            ? getDayClassNames(dateMeta, theme)\n            : getSlotClassNames(dateMeta, theme)));\n        return (createElement(RenderHook, { hookProps: hookProps, classNames: options.slotLaneClassNames, content: options.slotLaneContent, didMount: options.slotLaneDidMount, willUnmount: options.slotLaneWillUnmount, elRef: props.elRef }, function (rootElRef, customClassNames, innerElRef, innerContent) { return (createElement(\"td\", __assign({ ref: rootElRef, className: classNames.concat(customClassNames).join(' ') }, dataAttrs),\n            createElement(\"div\", { ref: innerElRef }, innerContent))); }));\n    };\n    return TimelineSlatCell;\n}(BaseComponent));\n\nvar TimelineSlatsBody = /** @class */ (function (_super) {\n    __extends(TimelineSlatsBody, _super);\n    function TimelineSlatsBody() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimelineSlatsBody.prototype.render = function () {\n        var props = this.props;\n        var tDateProfile = props.tDateProfile, cellElRefs = props.cellElRefs;\n        var slotDates = tDateProfile.slotDates, isWeekStarts = tDateProfile.isWeekStarts;\n        var isDay = !tDateProfile.isTimeScale && !tDateProfile.largeUnit;\n        return (createElement(\"tbody\", null,\n            createElement(\"tr\", null, slotDates.map(function (slotDate, i) {\n                var key = slotDate.toISOString();\n                return (createElement(TimelineSlatCell, { key: key, elRef: cellElRefs.createRef(key), date: slotDate, dateProfile: props.dateProfile, tDateProfile: tDateProfile, nowDate: props.nowDate, todayRange: props.todayRange, isEm: isWeekStarts[i], isDay: isDay }));\n            }))));\n    };\n    return TimelineSlatsBody;\n}(BaseComponent));\n\nvar TimelineSlats = /** @class */ (function (_super) {\n    __extends(TimelineSlats, _super);\n    function TimelineSlats() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.rootElRef = createRef();\n        _this.cellElRefs = new RefMap();\n        _this.handleScrollRequest = function (request) {\n            var onScrollLeftRequest = _this.props.onScrollLeftRequest;\n            var coords = _this.coords;\n            if (onScrollLeftRequest && coords) {\n                if (request.time) {\n                    var scrollLeft = coords.coordFromLeft(coords.durationToCoord(request.time));\n                    onScrollLeftRequest(scrollLeft);\n                }\n                return true;\n            }\n            return null; // best?\n        };\n        return _this;\n    }\n    TimelineSlats.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        return (createElement(\"div\", { className: \"fc-timeline-slots\", ref: this.rootElRef },\n            createElement(\"table\", { \"aria-hidden\": true, className: context.theme.getClass('table'), style: {\n                    minWidth: props.tableMinWidth,\n                    width: props.clientWidth,\n                } },\n                props.tableColGroupNode,\n                createElement(TimelineSlatsBody, { cellElRefs: this.cellElRefs, dateProfile: props.dateProfile, tDateProfile: props.tDateProfile, nowDate: props.nowDate, todayRange: props.todayRange }))));\n    };\n    TimelineSlats.prototype.componentDidMount = function () {\n        this.updateSizing();\n        this.scrollResponder = this.context.createScrollResponder(this.handleScrollRequest);\n    };\n    TimelineSlats.prototype.componentDidUpdate = function (prevProps) {\n        this.updateSizing();\n        this.scrollResponder.update(prevProps.dateProfile !== this.props.dateProfile);\n    };\n    TimelineSlats.prototype.componentWillUnmount = function () {\n        this.scrollResponder.detach();\n        if (this.props.onCoords) {\n            this.props.onCoords(null);\n        }\n    };\n    TimelineSlats.prototype.updateSizing = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        if (props.clientWidth !== null && // is sizing stable?\n            this.scrollResponder\n        // ^it's possible to have clientWidth immediately after mount (when returning from print view), but w/o scrollResponder\n        ) {\n            var rootEl = this.rootElRef.current;\n            if (rootEl.offsetWidth) { // not hidden by css\n                this.coords = new TimelineCoords(this.rootElRef.current, collectCellEls(this.cellElRefs.currentMap, props.tDateProfile.slotDates), props.dateProfile, props.tDateProfile, context.dateEnv, context.isRtl);\n                if (props.onCoords) {\n                    props.onCoords(this.coords);\n                }\n                this.scrollResponder.update(false); // TODO: wouldn't have to do this if coords were in state\n            }\n        }\n    };\n    TimelineSlats.prototype.positionToHit = function (leftPosition) {\n        var outerCoordCache = this.coords.outerCoordCache;\n        var _a = this.context, dateEnv = _a.dateEnv, isRtl = _a.isRtl;\n        var tDateProfile = this.props.tDateProfile;\n        var slatIndex = outerCoordCache.leftToIndex(leftPosition);\n        if (slatIndex != null) {\n            // somewhat similar to what TimeGrid does. consolidate?\n            var slatWidth = outerCoordCache.getWidth(slatIndex);\n            var partial = isRtl ?\n                (outerCoordCache.rights[slatIndex] - leftPosition) / slatWidth :\n                (leftPosition - outerCoordCache.lefts[slatIndex]) / slatWidth;\n            var localSnapIndex = Math.floor(partial * tDateProfile.snapsPerSlot);\n            var start = dateEnv.add(tDateProfile.slotDates[slatIndex], multiplyDuration(tDateProfile.snapDuration, localSnapIndex));\n            var end = dateEnv.add(start, tDateProfile.snapDuration);\n            return {\n                dateSpan: {\n                    range: { start: start, end: end },\n                    allDay: !this.props.tDateProfile.isTimeScale,\n                },\n                dayEl: this.cellElRefs.currentMap[slatIndex],\n                left: outerCoordCache.lefts[slatIndex],\n                right: outerCoordCache.rights[slatIndex],\n            };\n        }\n        return null;\n    };\n    return TimelineSlats;\n}(BaseComponent));\nfunction collectCellEls(elMap, slotDates) {\n    return slotDates.map(function (slotDate) {\n        var key = slotDate.toISOString();\n        return elMap[key];\n    });\n}\n\nfunction computeSegHCoords(segs, minWidth, timelineCoords) {\n    var hcoords = [];\n    if (timelineCoords) {\n        for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n            var seg = segs_1[_i];\n            var res = timelineCoords.rangeToCoords(seg);\n            var start = Math.round(res.start); // for barely-overlapping collisions\n            var end = Math.round(res.end); //\n            if (end - start < minWidth) {\n                end = start + minWidth;\n            }\n            hcoords.push({ start: start, end: end });\n        }\n    }\n    return hcoords;\n}\nfunction computeFgSegPlacements(segs, segHCoords, // might not have for every seg\neventInstanceHeights, // might not have for every seg\nmoreLinkHeights, // might not have for every more-link\nstrictOrder, maxStackCnt) {\n    var segInputs = [];\n    var crudePlacements = []; // when we don't know dims\n    for (var i = 0; i < segs.length; i += 1) {\n        var seg = segs[i];\n        var instanceId = seg.eventRange.instance.instanceId;\n        var height = eventInstanceHeights[instanceId];\n        var hcoords = segHCoords[i];\n        if (height && hcoords) {\n            segInputs.push({\n                index: i,\n                span: hcoords,\n                thickness: height,\n            });\n        }\n        else {\n            crudePlacements.push({\n                seg: seg,\n                hcoords: hcoords,\n                top: null,\n            });\n        }\n    }\n    var hierarchy = new SegHierarchy();\n    if (strictOrder != null) {\n        hierarchy.strictOrder = strictOrder;\n    }\n    if (maxStackCnt != null) {\n        hierarchy.maxStackCnt = maxStackCnt;\n    }\n    var hiddenEntries = hierarchy.addSegs(segInputs);\n    var hiddenPlacements = hiddenEntries.map(function (entry) { return ({\n        seg: segs[entry.index],\n        hcoords: entry.span,\n        top: null,\n    }); });\n    var hiddenGroups = groupIntersectingEntries(hiddenEntries);\n    var moreLinkInputs = [];\n    var moreLinkCrudePlacements = [];\n    var extractSeg = function (entry) { return segs[entry.index]; };\n    for (var i = 0; i < hiddenGroups.length; i += 1) {\n        var hiddenGroup = hiddenGroups[i];\n        var sortedSegs = hiddenGroup.entries.map(extractSeg);\n        var height = moreLinkHeights[buildIsoString(computeEarliestSegStart(sortedSegs))]; // not optimal :(\n        if (height != null) {\n            // NOTE: the hiddenGroup's spanStart/spanEnd are already computed by rangeToCoords. computed during input.\n            moreLinkInputs.push({\n                index: segs.length + i,\n                thickness: height,\n                span: hiddenGroup.span,\n            });\n        }\n        else {\n            moreLinkCrudePlacements.push({\n                seg: sortedSegs,\n                hcoords: hiddenGroup.span,\n                top: null,\n            });\n        }\n    }\n    // add more-links into the hierarchy, but don't limit\n    hierarchy.maxStackCnt = -1;\n    hierarchy.addSegs(moreLinkInputs);\n    var visibleRects = hierarchy.toRects();\n    var visiblePlacements = [];\n    var maxHeight = 0;\n    for (var _i = 0, visibleRects_1 = visibleRects; _i < visibleRects_1.length; _i++) {\n        var rect = visibleRects_1[_i];\n        var segIndex = rect.index;\n        visiblePlacements.push({\n            seg: segIndex < segs.length\n                ? segs[segIndex] // a real seg\n                : hiddenGroups[segIndex - segs.length].entries.map(extractSeg),\n            hcoords: rect.span,\n            top: rect.levelCoord,\n        });\n        maxHeight = Math.max(maxHeight, rect.levelCoord + rect.thickness);\n    }\n    return [\n        visiblePlacements.concat(crudePlacements, hiddenPlacements, moreLinkCrudePlacements),\n        maxHeight,\n    ];\n}\n\nvar TimelineLaneBg = /** @class */ (function (_super) {\n    __extends(TimelineLaneBg, _super);\n    function TimelineLaneBg() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimelineLaneBg.prototype.render = function () {\n        var props = this.props;\n        var highlightSeg = [].concat(props.eventResizeSegs, props.dateSelectionSegs);\n        return props.timelineCoords && (createElement(\"div\", { className: \"fc-timeline-bg\" },\n            this.renderSegs(props.businessHourSegs || [], props.timelineCoords, 'non-business'),\n            this.renderSegs(props.bgEventSegs || [], props.timelineCoords, 'bg-event'),\n            this.renderSegs(highlightSeg, props.timelineCoords, 'highlight')));\n    };\n    TimelineLaneBg.prototype.renderSegs = function (segs, timelineCoords, fillType) {\n        var _a = this.props, todayRange = _a.todayRange, nowDate = _a.nowDate;\n        var isRtl = this.context.isRtl;\n        var segHCoords = computeSegHCoords(segs, 0, timelineCoords);\n        var children = segs.map(function (seg, i) {\n            var hcoords = segHCoords[i];\n            var hStyle = coordsToCss(hcoords, isRtl);\n            return (createElement(\"div\", { key: buildEventRangeKey(seg.eventRange), className: \"fc-timeline-bg-harness\", style: hStyle }, fillType === 'bg-event' ?\n                createElement(BgEvent, __assign({ seg: seg }, getSegMeta(seg, todayRange, nowDate))) :\n                renderFill(fillType)));\n        });\n        return createElement(Fragment, null, children);\n    };\n    return TimelineLaneBg;\n}(BaseComponent));\n\nvar TimelineLaneSlicer = /** @class */ (function (_super) {\n    __extends(TimelineLaneSlicer, _super);\n    function TimelineLaneSlicer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimelineLaneSlicer.prototype.sliceRange = function (origRange, dateProfile, dateProfileGenerator, tDateProfile, dateEnv) {\n        var normalRange = normalizeRange(origRange, tDateProfile, dateEnv);\n        var segs = [];\n        // protect against when the span is entirely in an invalid date region\n        if (computeDateSnapCoverage(normalRange.start, tDateProfile, dateEnv)\n            < computeDateSnapCoverage(normalRange.end, tDateProfile, dateEnv)) {\n            // intersect the footprint's range with the grid's range\n            var slicedRange = intersectRanges(normalRange, tDateProfile.normalizedRange);\n            if (slicedRange) {\n                segs.push({\n                    start: slicedRange.start,\n                    end: slicedRange.end,\n                    isStart: slicedRange.start.valueOf() === normalRange.start.valueOf()\n                        && isValidDate(slicedRange.start, tDateProfile, dateProfile, dateProfileGenerator),\n                    isEnd: slicedRange.end.valueOf() === normalRange.end.valueOf()\n                        && isValidDate(addMs(slicedRange.end, -1), tDateProfile, dateProfile, dateProfileGenerator),\n                });\n            }\n        }\n        return segs;\n    };\n    return TimelineLaneSlicer;\n}(Slicer));\n\nvar DEFAULT_TIME_FORMAT = createFormatter({\n    hour: 'numeric',\n    minute: '2-digit',\n    omitZeroMinute: true,\n    meridiem: 'narrow',\n});\nvar TimelineEvent = /** @class */ (function (_super) {\n    __extends(TimelineEvent, _super);\n    function TimelineEvent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TimelineEvent.prototype.render = function () {\n        var props = this.props;\n        return (createElement(StandardEvent, __assign({}, props, { extraClassNames: ['fc-timeline-event', 'fc-h-event'], defaultTimeFormat: DEFAULT_TIME_FORMAT, defaultDisplayEventTime: !props.isTimeScale })));\n    };\n    return TimelineEvent;\n}(BaseComponent));\n\nvar TimelineLaneMoreLink = /** @class */ (function (_super) {\n    __extends(TimelineLaneMoreLink, _super);\n    function TimelineLaneMoreLink() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.rootElRef = createRef();\n        return _this;\n    }\n    TimelineLaneMoreLink.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var hiddenSegs = props.hiddenSegs, elRef = props.elRef, placement = props.placement, resourceId = props.resourceId;\n        var top = placement.top, hcoords = placement.hcoords;\n        var isVisible = hcoords && top !== null;\n        var hStyle = coordsToCss(hcoords, context.isRtl);\n        var extraDateSpan = resourceId ? { resourceId: resourceId } : {};\n        return (createElement(MoreLinkRoot, { allDayDate: null, moreCnt: hiddenSegs.length, allSegs: hiddenSegs, hiddenSegs: hiddenSegs, alignmentElRef: this.rootElRef, dateProfile: props.dateProfile, todayRange: props.todayRange, extraDateSpan: extraDateSpan, popoverContent: function () { return (createElement(Fragment, null, hiddenSegs.map(function (seg) {\n                var instanceId = seg.eventRange.instance.instanceId;\n                return (createElement(\"div\", { key: instanceId, style: { visibility: props.isForcedInvisible[instanceId] ? 'hidden' : '' } },\n                    createElement(TimelineEvent, __assign({ isTimeScale: props.isTimeScale, seg: seg, isDragging: false, isResizing: false, isDateSelecting: false, isSelected: instanceId === props.eventSelection }, getSegMeta(seg, props.todayRange, props.nowDate)))));\n            }))); } }, function (rootElRef, classNames, innerElRef, innerContent, handleClick, title, isExpanded, popoverId) { return (createElement(\"a\", { ref: function (el) {\n                setRef(rootElRef, el); // for MoreLinkRoot\n                setRef(elRef, el); // for props props\n                setRef(_this.rootElRef, el); // for this component\n            }, className: ['fc-timeline-more-link'].concat(classNames).join(' '), style: __assign({ visibility: isVisible ? '' : 'hidden', top: top || 0 }, hStyle), onClick: handleClick, title: title, \"aria-expanded\": isExpanded, \"aria-controls\": popoverId },\n            createElement(\"div\", { ref: innerElRef, className: \"fc-timeline-more-link-inner fc-sticky\" }, innerContent))); }));\n    };\n    return TimelineLaneMoreLink;\n}(BaseComponent));\n\nvar TimelineLane = /** @class */ (function (_super) {\n    __extends(TimelineLane, _super);\n    function TimelineLane() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.slicer = new TimelineLaneSlicer();\n        _this.sortEventSegs = memoize(sortEventSegs);\n        _this.harnessElRefs = new RefMap();\n        _this.moreElRefs = new RefMap();\n        _this.innerElRef = createRef();\n        // TODO: memoize event positioning\n        _this.state = {\n            eventInstanceHeights: {},\n            moreLinkHeights: {},\n        };\n        return _this;\n    }\n    TimelineLane.prototype.render = function () {\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var options = context.options;\n        var dateProfile = props.dateProfile, tDateProfile = props.tDateProfile;\n        var slicedProps = this.slicer.sliceProps(props, dateProfile, tDateProfile.isTimeScale ? null : props.nextDayThreshold, context, // wish we didn't have to pass in the rest of the args...\n        dateProfile, context.dateProfileGenerator, tDateProfile, context.dateEnv);\n        var mirrorSegs = (slicedProps.eventDrag ? slicedProps.eventDrag.segs : null) ||\n            (slicedProps.eventResize ? slicedProps.eventResize.segs : null) ||\n            [];\n        var fgSegs = this.sortEventSegs(slicedProps.fgEventSegs, options.eventOrder);\n        var fgSegHCoords = computeSegHCoords(fgSegs, options.eventMinWidth, props.timelineCoords);\n        var _b = computeFgSegPlacements(fgSegs, fgSegHCoords, state.eventInstanceHeights, state.moreLinkHeights, options.eventOrderStrict, options.eventMaxStack), fgPlacements = _b[0], fgHeight = _b[1];\n        var isForcedInvisible = // TODO: more convenient\n         (slicedProps.eventDrag ? slicedProps.eventDrag.affectedInstances : null) ||\n            (slicedProps.eventResize ? slicedProps.eventResize.affectedInstances : null) ||\n            {};\n        return (createElement(Fragment, null,\n            createElement(TimelineLaneBg, { businessHourSegs: slicedProps.businessHourSegs, bgEventSegs: slicedProps.bgEventSegs, timelineCoords: props.timelineCoords, eventResizeSegs: slicedProps.eventResize ? slicedProps.eventResize.segs : [] /* bad new empty array? */, dateSelectionSegs: slicedProps.dateSelectionSegs, nowDate: props.nowDate, todayRange: props.todayRange }),\n            createElement(\"div\", { className: \"fc-timeline-events fc-scrollgrid-sync-inner\", ref: this.innerElRef, style: { height: fgHeight } },\n                this.renderFgSegs(fgPlacements, isForcedInvisible, false, false, false),\n                this.renderFgSegs(buildMirrorPlacements(mirrorSegs, props.timelineCoords, fgPlacements), {}, Boolean(slicedProps.eventDrag), Boolean(slicedProps.eventResize), false))));\n    };\n    TimelineLane.prototype.componentDidMount = function () {\n        this.updateSize();\n    };\n    TimelineLane.prototype.componentDidUpdate = function (prevProps, prevState) {\n        if (prevProps.eventStore !== this.props.eventStore || // external thing changed?\n            prevProps.timelineCoords !== this.props.timelineCoords || // external thing changed?\n            prevState.moreLinkHeights !== this.state.moreLinkHeights // HACK. see addStateEquality\n        ) {\n            this.updateSize();\n        }\n    };\n    TimelineLane.prototype.updateSize = function () {\n        var _this = this;\n        var props = this.props;\n        var timelineCoords = props.timelineCoords;\n        if (props.onHeightChange) {\n            props.onHeightChange(this.innerElRef.current, false);\n        }\n        if (timelineCoords) {\n            this.setState({\n                eventInstanceHeights: mapHash(this.harnessElRefs.currentMap, function (harnessEl) { return (Math.round(harnessEl.getBoundingClientRect().height)); }),\n                moreLinkHeights: mapHash(this.moreElRefs.currentMap, function (moreEl) { return (Math.round(moreEl.getBoundingClientRect().height)); }),\n            }, function () {\n                if (props.onHeightChange) {\n                    props.onHeightChange(_this.innerElRef.current, true);\n                }\n            });\n        }\n    };\n    TimelineLane.prototype.renderFgSegs = function (segPlacements, isForcedInvisible, isDragging, isResizing, isDateSelecting) {\n        var _a = this, harnessElRefs = _a.harnessElRefs, moreElRefs = _a.moreElRefs, props = _a.props, context = _a.context;\n        var isMirror = isDragging || isResizing || isDateSelecting;\n        return (createElement(Fragment, null, segPlacements.map(function (segPlacement) {\n            var seg = segPlacement.seg, hcoords = segPlacement.hcoords, top = segPlacement.top;\n            if (Array.isArray(seg)) { // a more-link\n                var isoStr = buildIsoString(computeEarliestSegStart(seg));\n                return (createElement(TimelineLaneMoreLink, { key: 'm:' + isoStr /* \"m\" for \"more\" */, elRef: moreElRefs.createRef(isoStr), hiddenSegs: seg, placement: segPlacement, dateProfile: props.dateProfile, nowDate: props.nowDate, todayRange: props.todayRange, isTimeScale: props.tDateProfile.isTimeScale, eventSelection: props.eventSelection, resourceId: props.resourceId, isForcedInvisible: isForcedInvisible }));\n            }\n            var instanceId = seg.eventRange.instance.instanceId;\n            var isVisible = isMirror || Boolean(!isForcedInvisible[instanceId] && hcoords && top !== null);\n            var hStyle = coordsToCss(hcoords, context.isRtl);\n            return (createElement(\"div\", { key: 'e:' + instanceId /* \"e\" for \"event\" */, ref: isMirror ? null : harnessElRefs.createRef(instanceId), className: \"fc-timeline-event-harness\", style: __assign({ visibility: isVisible ? '' : 'hidden', top: top || 0 }, hStyle) },\n                createElement(TimelineEvent, __assign({ isTimeScale: props.tDateProfile.isTimeScale, seg: seg, isDragging: isDragging, isResizing: isResizing, isDateSelecting: isDateSelecting, isSelected: instanceId === props.eventSelection /* TODO: bad for mirror? */ }, getSegMeta(seg, props.todayRange, props.nowDate)))));\n        })));\n    };\n    return TimelineLane;\n}(BaseComponent));\nTimelineLane.addStateEquality({\n    eventInstanceHeights: isPropsEqual,\n    moreLinkHeights: isPropsEqual,\n});\nfunction buildMirrorPlacements(mirrorSegs, timelineCoords, fgPlacements) {\n    if (!mirrorSegs.length || !timelineCoords) {\n        return [];\n    }\n    var topsByInstanceId = buildAbsoluteTopHash(fgPlacements); // TODO: cache this at first render?\n    return mirrorSegs.map(function (seg) { return ({\n        seg: seg,\n        hcoords: timelineCoords.rangeToCoords(seg),\n        top: topsByInstanceId[seg.eventRange.instance.instanceId],\n    }); });\n}\nfunction buildAbsoluteTopHash(placements) {\n    var topsByInstanceId = {};\n    for (var _i = 0, placements_1 = placements; _i < placements_1.length; _i++) {\n        var placement = placements_1[_i];\n        var seg = placement.seg;\n        if (!Array.isArray(seg)) { // doesn't represent a more-link\n            topsByInstanceId[seg.eventRange.instance.instanceId] = placement.top;\n        }\n    }\n    return topsByInstanceId;\n}\n\nvar TimelineGrid = /** @class */ (function (_super) {\n    __extends(TimelineGrid, _super);\n    function TimelineGrid() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.slatsRef = createRef();\n        _this.state = {\n            coords: null,\n        };\n        _this.handeEl = function (el) {\n            if (el) {\n                _this.context.registerInteractiveComponent(_this, { el: el });\n            }\n            else {\n                _this.context.unregisterInteractiveComponent(_this);\n            }\n        };\n        _this.handleCoords = function (coords) {\n            _this.setState({ coords: coords });\n            if (_this.props.onSlatCoords) {\n                _this.props.onSlatCoords(coords);\n            }\n        };\n        return _this;\n    }\n    TimelineGrid.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var options = context.options;\n        var dateProfile = props.dateProfile, tDateProfile = props.tDateProfile;\n        var timerUnit = greatestDurationDenominator(tDateProfile.slotDuration).unit;\n        return (createElement(\"div\", { className: \"fc-timeline-body\", ref: this.handeEl, style: {\n                minWidth: props.tableMinWidth,\n                height: props.clientHeight,\n                width: props.clientWidth,\n            } },\n            createElement(NowTimer, { unit: timerUnit }, function (nowDate, todayRange) { return (createElement(Fragment, null,\n                createElement(TimelineSlats, { ref: _this.slatsRef, dateProfile: dateProfile, tDateProfile: tDateProfile, nowDate: nowDate, todayRange: todayRange, clientWidth: props.clientWidth, tableColGroupNode: props.tableColGroupNode, tableMinWidth: props.tableMinWidth, onCoords: _this.handleCoords, onScrollLeftRequest: props.onScrollLeftRequest }),\n                createElement(TimelineLane, { dateProfile: dateProfile, tDateProfile: props.tDateProfile, nowDate: nowDate, todayRange: todayRange, nextDayThreshold: options.nextDayThreshold, businessHours: props.businessHours, eventStore: props.eventStore, eventUiBases: props.eventUiBases, dateSelection: props.dateSelection, eventSelection: props.eventSelection, eventDrag: props.eventDrag, eventResize: props.eventResize, timelineCoords: state.coords }),\n                (options.nowIndicator && state.coords && state.coords.isDateInRange(nowDate)) && (createElement(\"div\", { className: \"fc-timeline-now-indicator-container\" },\n                    createElement(NowIndicatorRoot, { isAxis: false, date: nowDate }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"div\", { ref: rootElRef, className: ['fc-timeline-now-indicator-line'].concat(classNames).join(' '), style: coordToCss(state.coords.dateToCoord(nowDate), context.isRtl) }, innerContent)); }))))); })));\n    };\n    // Hit System\n    // ------------------------------------------------------------------------------------------\n    TimelineGrid.prototype.queryHit = function (positionLeft, positionTop, elWidth, elHeight) {\n        var slats = this.slatsRef.current;\n        var slatHit = slats.positionToHit(positionLeft);\n        if (slatHit) {\n            return {\n                dateProfile: this.props.dateProfile,\n                dateSpan: slatHit.dateSpan,\n                rect: {\n                    left: slatHit.left,\n                    right: slatHit.right,\n                    top: 0,\n                    bottom: elHeight,\n                },\n                dayEl: slatHit.dayEl,\n                layer: 0,\n            };\n        }\n        return null;\n    };\n    return TimelineGrid;\n}(DateComponent));\n\nvar TimelineView = /** @class */ (function (_super) {\n    __extends(TimelineView, _super);\n    function TimelineView() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.buildTimelineDateProfile = memoize(buildTimelineDateProfile);\n        _this.scrollGridRef = createRef();\n        _this.state = {\n            slatCoords: null,\n            slotCushionMaxWidth: null,\n        };\n        _this.handleSlatCoords = function (slatCoords) {\n            _this.setState({ slatCoords: slatCoords });\n        };\n        _this.handleScrollLeftRequest = function (scrollLeft) {\n            var scrollGrid = _this.scrollGridRef.current;\n            scrollGrid.forceScrollLeft(0, scrollLeft);\n        };\n        _this.handleMaxCushionWidth = function (slotCushionMaxWidth) {\n            _this.setState({\n                slotCushionMaxWidth: Math.ceil(slotCushionMaxWidth), // for less rerendering TODO: DRY\n            });\n        };\n        return _this;\n    }\n    TimelineView.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var options = context.options;\n        var stickyHeaderDates = !props.forPrint && getStickyHeaderDates(options);\n        var stickyFooterScrollbar = !props.forPrint && getStickyFooterScrollbar(options);\n        var tDateProfile = this.buildTimelineDateProfile(props.dateProfile, context.dateEnv, options, context.dateProfileGenerator);\n        var extraClassNames = [\n            'fc-timeline',\n            options.eventOverlap === false ? 'fc-timeline-overlap-disabled' : '',\n        ];\n        var slotMinWidth = options.slotMinWidth;\n        var slatCols = buildSlatCols(tDateProfile, slotMinWidth || this.computeFallbackSlotMinWidth(tDateProfile));\n        var sections = [\n            {\n                type: 'header',\n                key: 'header',\n                isSticky: stickyHeaderDates,\n                chunks: [{\n                        key: 'timeline',\n                        content: function (contentArg) { return (createElement(TimelineHeader, { dateProfile: props.dateProfile, clientWidth: contentArg.clientWidth, clientHeight: contentArg.clientHeight, tableMinWidth: contentArg.tableMinWidth, tableColGroupNode: contentArg.tableColGroupNode, tDateProfile: tDateProfile, slatCoords: state.slatCoords, onMaxCushionWidth: slotMinWidth ? null : _this.handleMaxCushionWidth })); },\n                    }],\n            },\n            {\n                type: 'body',\n                key: 'body',\n                liquid: true,\n                chunks: [{\n                        key: 'timeline',\n                        content: function (contentArg) { return (createElement(TimelineGrid, __assign({}, props, { clientWidth: contentArg.clientWidth, clientHeight: contentArg.clientHeight, tableMinWidth: contentArg.tableMinWidth, tableColGroupNode: contentArg.tableColGroupNode, tDateProfile: tDateProfile, onSlatCoords: _this.handleSlatCoords, onScrollLeftRequest: _this.handleScrollLeftRequest }))); },\n                    }],\n            },\n        ];\n        if (stickyFooterScrollbar) {\n            sections.push({\n                type: 'footer',\n                key: 'footer',\n                isSticky: true,\n                chunks: [{\n                        key: 'timeline',\n                        content: renderScrollShim,\n                    }],\n            });\n        }\n        return (createElement(ViewRoot, { viewSpec: context.viewSpec }, function (rootElRef, classNames) { return (createElement(\"div\", { ref: rootElRef, className: extraClassNames.concat(classNames).join(' ') },\n            createElement(ScrollGrid, { ref: _this.scrollGridRef, liquid: !props.isHeightAuto && !props.forPrint, collapsibleWidth: false, colGroups: [\n                    { cols: slatCols },\n                ], sections: sections }))); }));\n    };\n    TimelineView.prototype.computeFallbackSlotMinWidth = function (tDateProfile) {\n        return Math.max(30, ((this.state.slotCushionMaxWidth || 0) / tDateProfile.slotsPerLabel));\n    };\n    return TimelineView;\n}(DateComponent));\nfunction buildSlatCols(tDateProfile, slotMinWidth) {\n    return [{\n            span: tDateProfile.slotCnt,\n            minWidth: slotMinWidth || 1, // needs to be a non-zero number to trigger horizontal scrollbars!??????\n        }];\n}\n\nvar main = createPlugin({\n    deps: [\n        premiumCommonPlugin,\n    ],\n    initialView: 'timelineDay',\n    views: {\n        timeline: {\n            component: TimelineView,\n            usesMinMaxTime: true,\n            eventResizableFromStart: true, // how is this consumed for TimelineView tho?\n        },\n        timelineDay: {\n            type: 'timeline',\n            duration: { days: 1 },\n        },\n        timelineWeek: {\n            type: 'timeline',\n            duration: { weeks: 1 },\n        },\n        timelineMonth: {\n            type: 'timeline',\n            duration: { months: 1 },\n        },\n        timelineYear: {\n            type: 'timeline',\n            duration: { years: 1 },\n        },\n    },\n});\n\nexport default main;\nexport { TimelineCoords, TimelineHeader, TimelineHeaderRows, TimelineLane, TimelineLaneBg, TimelineLaneSlicer, TimelineSlats, TimelineView, buildSlatCols, buildTimelineDateProfile, coordToCss, coordsToCss };\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","/*!\nFullCalendar Scheduler v5.10.1\nDocs & License: https://fullcalendar.io/scheduler\n(c) 2021 Adam Shaw\n*/\nimport { memoize, filterHash, rangesIntersect, isPropsEqual, mapHash, combineEventUis, refineProps, guid, identity, rangesEqual, parseBusinessHours, createEventUi, parseClassNames, EventApi, CalendarApi, Splitter, mergeEventStores, isPropsValid, parseFieldSpecs, unpromisify, requestJson, createElement, ViewContextType, formatDayString, RenderHook, BaseComponent, NowTimer, Fragment, TableDateCell, TableDowCell, computeFallbackHeaderFormat, flexibleCompare, compareByFieldSpecs, createPlugin } from '@fullcalendar/common';\nimport premiumCommonPlugin from '@fullcalendar/premium-common';\nimport { __assign, __extends, __spreadArray } from 'tslib';\n\nfunction massageEventDragMutation(eventMutation, hit0, hit1) {\n    var resource0 = hit0.dateSpan.resourceId;\n    var resource1 = hit1.dateSpan.resourceId;\n    if (resource0 && resource1 &&\n        resource0 !== resource1) {\n        eventMutation.resourceMutation = {\n            matchResourceId: resource0,\n            setResourceId: resource1,\n        };\n    }\n}\n/*\nTODO: all this would be much easier if we were using a hash!\n*/\nfunction applyEventDefMutation(eventDef, mutation, context) {\n    var resourceMutation = mutation.resourceMutation;\n    if (resourceMutation && computeResourceEditable(eventDef, context)) {\n        var index = eventDef.resourceIds.indexOf(resourceMutation.matchResourceId);\n        if (index !== -1) {\n            var resourceIds = eventDef.resourceIds.slice(); // copy\n            resourceIds.splice(index, 1); // remove\n            if (resourceIds.indexOf(resourceMutation.setResourceId) === -1) { // not already in there\n                resourceIds.push(resourceMutation.setResourceId); // add\n            }\n            eventDef.resourceIds = resourceIds;\n        }\n    }\n}\n/*\nHACK\nTODO: use EventUi system instead of this\n*/\nfunction computeResourceEditable(eventDef, context) {\n    var resourceEditable = eventDef.resourceEditable;\n    if (resourceEditable == null) {\n        var source = eventDef.sourceId && context.getCurrentData().eventSources[eventDef.sourceId];\n        if (source) {\n            resourceEditable = source.extendedProps.resourceEditable; // used the Source::extendedProps hack\n        }\n        if (resourceEditable == null) {\n            resourceEditable = context.options.eventResourceEditable;\n            if (resourceEditable == null) {\n                resourceEditable = context.options.editable; // TODO: use defaults system instead\n            }\n        }\n    }\n    return resourceEditable;\n}\nfunction transformEventDrop(mutation, context) {\n    var resourceMutation = mutation.resourceMutation;\n    if (resourceMutation) {\n        var calendarApi = context.calendarApi;\n        return {\n            oldResource: calendarApi.getResourceById(resourceMutation.matchResourceId),\n            newResource: calendarApi.getResourceById(resourceMutation.setResourceId),\n        };\n    }\n    return {\n        oldResource: null,\n        newResource: null,\n    };\n}\n\nvar ResourceDataAdder = /** @class */ (function () {\n    function ResourceDataAdder() {\n        this.filterResources = memoize(filterResources);\n    }\n    ResourceDataAdder.prototype.transform = function (viewProps, calendarProps) {\n        if (calendarProps.viewSpec.optionDefaults.needsResourceData) {\n            return {\n                resourceStore: this.filterResources(calendarProps.resourceStore, calendarProps.options.filterResourcesWithEvents, calendarProps.eventStore, calendarProps.dateProfile.activeRange),\n                resourceEntityExpansions: calendarProps.resourceEntityExpansions,\n            };\n        }\n        return null;\n    };\n    return ResourceDataAdder;\n}());\nfunction filterResources(resourceStore, doFilterResourcesWithEvents, eventStore, activeRange) {\n    if (doFilterResourcesWithEvents) {\n        var instancesInRange = filterEventInstancesInRange(eventStore.instances, activeRange);\n        var hasEvents_1 = computeHasEvents(instancesInRange, eventStore.defs);\n        __assign(hasEvents_1, computeAncestorHasEvents(hasEvents_1, resourceStore));\n        return filterHash(resourceStore, function (resource, resourceId) { return hasEvents_1[resourceId]; });\n    }\n    return resourceStore;\n}\nfunction filterEventInstancesInRange(eventInstances, activeRange) {\n    return filterHash(eventInstances, function (eventInstance) { return rangesIntersect(eventInstance.range, activeRange); });\n}\nfunction computeHasEvents(eventInstances, eventDefs) {\n    var hasEvents = {};\n    for (var instanceId in eventInstances) {\n        var instance = eventInstances[instanceId];\n        for (var _i = 0, _a = eventDefs[instance.defId].resourceIds; _i < _a.length; _i++) {\n            var resourceId = _a[_i];\n            hasEvents[resourceId] = true;\n        }\n    }\n    return hasEvents;\n}\n/*\nmark resources as having events if any of their ancestors have them\nNOTE: resourceStore might not have all the resources that hasEvents{} has keyed\n*/\nfunction computeAncestorHasEvents(hasEvents, resourceStore) {\n    var res = {};\n    for (var resourceId in hasEvents) {\n        var resource = void 0;\n        while ((resource = resourceStore[resourceId])) {\n            resourceId = resource.parentId; // now functioning as the parentId\n            if (resourceId) {\n                res[resourceId] = true;\n            }\n            else {\n                break;\n            }\n        }\n    }\n    return res;\n}\n/*\nfor making sure events that have editable resources are always draggable in resource views\n*/\nfunction transformIsDraggable(val, eventDef, eventUi, context) {\n    if (!val) {\n        var state = context.getCurrentData();\n        var viewSpec = state.viewSpecs[state.currentViewType];\n        if (viewSpec.optionDefaults.needsResourceData) {\n            if (computeResourceEditable(eventDef, context)) {\n                return true;\n            }\n        }\n    }\n    return val;\n}\n\n// for when non-resource view should be given EventUi info (for event coloring/constraints based off of resource data)\nvar ResourceEventConfigAdder = /** @class */ (function () {\n    function ResourceEventConfigAdder() {\n        this.buildResourceEventUis = memoize(buildResourceEventUis, isPropsEqual);\n        this.injectResourceEventUis = memoize(injectResourceEventUis);\n    }\n    ResourceEventConfigAdder.prototype.transform = function (viewProps, calendarProps) {\n        if (!calendarProps.viewSpec.optionDefaults.needsResourceData) {\n            return {\n                eventUiBases: this.injectResourceEventUis(viewProps.eventUiBases, viewProps.eventStore.defs, this.buildResourceEventUis(calendarProps.resourceStore)),\n            };\n        }\n        return null;\n    };\n    return ResourceEventConfigAdder;\n}());\nfunction buildResourceEventUis(resourceStore) {\n    return mapHash(resourceStore, function (resource) { return resource.ui; });\n}\nfunction injectResourceEventUis(eventUiBases, eventDefs, resourceEventUis) {\n    return mapHash(eventUiBases, function (eventUi, defId) {\n        if (defId) { // not the '' key\n            return injectResourceEventUi(eventUi, eventDefs[defId], resourceEventUis);\n        }\n        return eventUi;\n    });\n}\nfunction injectResourceEventUi(origEventUi, eventDef, resourceEventUis) {\n    var parts = [];\n    // first resource takes precedence, which fights with the ordering of combineEventUis, thus the unshifts\n    for (var _i = 0, _a = eventDef.resourceIds; _i < _a.length; _i++) {\n        var resourceId = _a[_i];\n        if (resourceEventUis[resourceId]) {\n            parts.unshift(resourceEventUis[resourceId]);\n        }\n    }\n    parts.unshift(origEventUi);\n    return combineEventUis(parts);\n}\n\nvar defs = []; // TODO: use plugin system\nfunction registerResourceSourceDef(def) {\n    defs.push(def);\n}\nfunction getResourceSourceDef(id) {\n    return defs[id];\n}\nfunction getResourceSourceDefs() {\n    return defs;\n}\n\n// TODO: make this a plugin-able parser\n// TODO: success/failure\nvar RESOURCE_SOURCE_REFINERS = {\n    id: String,\n    // for array. TODO: move to resource-array\n    resources: identity,\n    // for json feed. TODO: move to resource-json-feed\n    url: String,\n    method: String,\n    startParam: String,\n    endParam: String,\n    timeZoneParam: String,\n    extraParams: identity,\n};\nfunction parseResourceSource(input) {\n    var inputObj;\n    if (typeof input === 'string') {\n        inputObj = { url: input };\n    }\n    else if (typeof input === 'function' || Array.isArray(input)) {\n        inputObj = { resources: input };\n    }\n    else if (typeof input === 'object' && input) { // non-null object\n        inputObj = input;\n    }\n    if (inputObj) {\n        var _a = refineProps(inputObj, RESOURCE_SOURCE_REFINERS), refined = _a.refined, extra = _a.extra;\n        warnUnknownProps(extra);\n        var metaRes = buildResourceSourceMeta(refined);\n        if (metaRes) {\n            return {\n                _raw: input,\n                sourceId: guid(),\n                sourceDefId: metaRes.sourceDefId,\n                meta: metaRes.meta,\n                publicId: refined.id || '',\n                isFetching: false,\n                latestFetchId: '',\n                fetchRange: null,\n            };\n        }\n    }\n    return null;\n}\nfunction buildResourceSourceMeta(refined) {\n    var defs = getResourceSourceDefs();\n    for (var i = defs.length - 1; i >= 0; i -= 1) { // later-added plugins take precedence\n        var def = defs[i];\n        var meta = def.parseMeta(refined);\n        if (meta) {\n            return { meta: meta, sourceDefId: i };\n        }\n    }\n    return null;\n}\nfunction warnUnknownProps(props) {\n    for (var propName in props) {\n        console.warn(\"Unknown resource prop '\" + propName + \"'\");\n    }\n}\n\nfunction reduceResourceSource(source, action, context) {\n    var options = context.options, dateProfile = context.dateProfile;\n    if (!source || !action) {\n        return createSource(options.initialResources || options.resources, dateProfile.activeRange, options.refetchResourcesOnNavigate, context);\n    }\n    switch (action.type) {\n        case 'RESET_RESOURCE_SOURCE':\n            return createSource(action.resourceSourceInput, dateProfile.activeRange, options.refetchResourcesOnNavigate, context);\n        case 'PREV': // TODO: how do we track all actions that affect dateProfile :(\n        case 'NEXT':\n        case 'CHANGE_DATE':\n        case 'CHANGE_VIEW_TYPE':\n            return handleRangeChange(source, dateProfile.activeRange, options.refetchResourcesOnNavigate, context);\n        case 'RECEIVE_RESOURCES':\n        case 'RECEIVE_RESOURCE_ERROR':\n            return receiveResponse(source, action.fetchId, action.fetchRange);\n        case 'REFETCH_RESOURCES':\n            return fetchSource(source, dateProfile.activeRange, context);\n        default:\n            return source;\n    }\n}\nfunction createSource(input, activeRange, refetchResourcesOnNavigate, context) {\n    if (input) {\n        var source = parseResourceSource(input);\n        source = fetchSource(source, refetchResourcesOnNavigate ? activeRange : null, context);\n        return source;\n    }\n    return null;\n}\nfunction handleRangeChange(source, activeRange, refetchResourcesOnNavigate, context) {\n    if (refetchResourcesOnNavigate &&\n        !doesSourceIgnoreRange(source) &&\n        (!source.fetchRange || !rangesEqual(source.fetchRange, activeRange))) {\n        return fetchSource(source, activeRange, context);\n    }\n    return source;\n}\nfunction doesSourceIgnoreRange(source) {\n    return Boolean(getResourceSourceDef(source.sourceDefId).ignoreRange);\n}\nfunction fetchSource(source, fetchRange, context) {\n    var sourceDef = getResourceSourceDef(source.sourceDefId);\n    var fetchId = guid();\n    sourceDef.fetch({\n        resourceSource: source,\n        range: fetchRange,\n        context: context,\n    }, function (res) {\n        context.dispatch({\n            type: 'RECEIVE_RESOURCES',\n            fetchId: fetchId,\n            fetchRange: fetchRange,\n            rawResources: res.rawResources,\n        });\n    }, function (error) {\n        context.dispatch({\n            type: 'RECEIVE_RESOURCE_ERROR',\n            fetchId: fetchId,\n            fetchRange: fetchRange,\n            error: error,\n        });\n    });\n    return __assign(__assign({}, source), { isFetching: true, latestFetchId: fetchId });\n}\nfunction receiveResponse(source, fetchId, fetchRange) {\n    if (fetchId === source.latestFetchId) {\n        return __assign(__assign({}, source), { isFetching: false, fetchRange: fetchRange });\n    }\n    return source;\n}\n\nvar PRIVATE_ID_PREFIX = '_fc:';\nvar RESOURCE_REFINERS = {\n    id: String,\n    parentId: String,\n    children: identity,\n    title: String,\n    businessHours: identity,\n    extendedProps: identity,\n    // event-ui\n    eventEditable: Boolean,\n    eventStartEditable: Boolean,\n    eventDurationEditable: Boolean,\n    eventConstraint: identity,\n    eventOverlap: Boolean,\n    eventAllow: identity,\n    eventClassNames: parseClassNames,\n    eventBackgroundColor: String,\n    eventBorderColor: String,\n    eventTextColor: String,\n    eventColor: String,\n};\n/*\nneeds a full store so that it can populate children too\n*/\nfunction parseResource(raw, parentId, store, context) {\n    if (parentId === void 0) { parentId = ''; }\n    var _a = refineProps(raw, RESOURCE_REFINERS), refined = _a.refined, extra = _a.extra;\n    var resource = {\n        id: refined.id || (PRIVATE_ID_PREFIX + guid()),\n        parentId: refined.parentId || parentId,\n        title: refined.title || '',\n        businessHours: refined.businessHours ? parseBusinessHours(refined.businessHours, context) : null,\n        ui: createEventUi({\n            editable: refined.eventEditable,\n            startEditable: refined.eventStartEditable,\n            durationEditable: refined.eventDurationEditable,\n            constraint: refined.eventConstraint,\n            overlap: refined.eventOverlap,\n            allow: refined.eventAllow,\n            classNames: refined.eventClassNames,\n            backgroundColor: refined.eventBackgroundColor,\n            borderColor: refined.eventBorderColor,\n            textColor: refined.eventTextColor,\n            color: refined.eventColor,\n        }, context),\n        extendedProps: __assign(__assign({}, extra), refined.extendedProps),\n    };\n    // help out ResourceApi from having user modify props\n    Object.freeze(resource.ui.classNames);\n    Object.freeze(resource.extendedProps);\n    if (store[resource.id]) ;\n    else {\n        store[resource.id] = resource;\n        if (refined.children) {\n            for (var _i = 0, _b = refined.children; _i < _b.length; _i++) {\n                var childInput = _b[_i];\n                parseResource(childInput, resource.id, store, context);\n            }\n        }\n    }\n    return resource;\n}\n/*\nTODO: use this in more places\n*/\nfunction getPublicId(id) {\n    if (id.indexOf(PRIVATE_ID_PREFIX) === 0) {\n        return '';\n    }\n    return id;\n}\n\nfunction reduceResourceStore(store, action, source, context) {\n    if (!store || !action) {\n        return {};\n    }\n    switch (action.type) {\n        case 'RECEIVE_RESOURCES':\n            return receiveRawResources(store, action.rawResources, action.fetchId, source, context);\n        case 'ADD_RESOURCE':\n            return addResource(store, action.resourceHash);\n        case 'REMOVE_RESOURCE':\n            return removeResource(store, action.resourceId);\n        case 'SET_RESOURCE_PROP':\n            return setResourceProp(store, action.resourceId, action.propName, action.propValue);\n        case 'SET_RESOURCE_EXTENDED_PROP':\n            return setResourceExtendedProp(store, action.resourceId, action.propName, action.propValue);\n        default:\n            return store;\n    }\n}\nfunction receiveRawResources(existingStore, inputs, fetchId, source, context) {\n    if (source.latestFetchId === fetchId) {\n        var nextStore = {};\n        for (var _i = 0, inputs_1 = inputs; _i < inputs_1.length; _i++) {\n            var input = inputs_1[_i];\n            parseResource(input, '', nextStore, context);\n        }\n        return nextStore;\n    }\n    return existingStore;\n}\nfunction addResource(existingStore, additions) {\n    // TODO: warn about duplicate IDs\n    return __assign(__assign({}, existingStore), additions);\n}\nfunction removeResource(existingStore, resourceId) {\n    var newStore = __assign({}, existingStore);\n    delete newStore[resourceId];\n    // promote children\n    for (var childResourceId in newStore) { // a child, *maybe* but probably not\n        if (newStore[childResourceId].parentId === resourceId) {\n            newStore[childResourceId] = __assign(__assign({}, newStore[childResourceId]), { parentId: '' });\n        }\n    }\n    return newStore;\n}\nfunction setResourceProp(existingStore, resourceId, name, value) {\n    var _a, _b;\n    var existingResource = existingStore[resourceId];\n    // TODO: sanitization\n    if (existingResource) {\n        return __assign(__assign({}, existingStore), (_a = {}, _a[resourceId] = __assign(__assign({}, existingResource), (_b = {}, _b[name] = value, _b)), _a));\n    }\n    return existingStore;\n}\nfunction setResourceExtendedProp(existingStore, resourceId, name, value) {\n    var _a, _b;\n    var existingResource = existingStore[resourceId];\n    if (existingResource) {\n        return __assign(__assign({}, existingStore), (_a = {}, _a[resourceId] = __assign(__assign({}, existingResource), { extendedProps: __assign(__assign({}, existingResource.extendedProps), (_b = {}, _b[name] = value, _b)) }), _a));\n    }\n    return existingStore;\n}\n\nfunction reduceResourceEntityExpansions(expansions, action) {\n    var _a;\n    if (!expansions || !action) {\n        return {};\n    }\n    switch (action.type) {\n        case 'SET_RESOURCE_ENTITY_EXPANDED':\n            return __assign(__assign({}, expansions), (_a = {}, _a[action.id] = action.isExpanded, _a));\n        default:\n            return expansions;\n    }\n}\n\nfunction reduceResources(state, action, context) {\n    var resourceSource = reduceResourceSource(state && state.resourceSource, action, context);\n    var resourceStore = reduceResourceStore(state && state.resourceStore, action, resourceSource, context);\n    var resourceEntityExpansions = reduceResourceEntityExpansions(state && state.resourceEntityExpansions, action);\n    return {\n        resourceSource: resourceSource,\n        resourceStore: resourceStore,\n        resourceEntityExpansions: resourceEntityExpansions,\n    };\n}\n\nvar EVENT_REFINERS = {\n    resourceId: String,\n    resourceIds: identity,\n    resourceEditable: Boolean,\n};\nfunction generateEventDefResourceMembers(refined) {\n    return {\n        resourceIds: ensureStringArray(refined.resourceIds)\n            .concat(refined.resourceId ? [refined.resourceId] : []),\n        resourceEditable: refined.resourceEditable,\n    };\n}\nfunction ensureStringArray(items) {\n    return (items || []).map(function (item) { return String(item); });\n}\n\nfunction transformDateSelectionJoin(hit0, hit1) {\n    var resourceId0 = hit0.dateSpan.resourceId;\n    var resourceId1 = hit1.dateSpan.resourceId;\n    if (resourceId0 && resourceId1) {\n        return { resourceId: resourceId0 };\n    }\n    return null;\n}\n\nvar ResourceApi = /** @class */ (function () {\n    function ResourceApi(_context, _resource) {\n        this._context = _context;\n        this._resource = _resource;\n    }\n    ResourceApi.prototype.setProp = function (name, value) {\n        var oldResource = this._resource;\n        this._context.dispatch({\n            type: 'SET_RESOURCE_PROP',\n            resourceId: oldResource.id,\n            propName: name,\n            propValue: value,\n        });\n        this.sync(oldResource);\n    };\n    ResourceApi.prototype.setExtendedProp = function (name, value) {\n        var oldResource = this._resource;\n        this._context.dispatch({\n            type: 'SET_RESOURCE_EXTENDED_PROP',\n            resourceId: oldResource.id,\n            propName: name,\n            propValue: value,\n        });\n        this.sync(oldResource);\n    };\n    ResourceApi.prototype.sync = function (oldResource) {\n        var context = this._context;\n        var resourceId = oldResource.id;\n        // TODO: what if dispatch didn't complete synchronously?\n        this._resource = context.getCurrentData().resourceStore[resourceId];\n        context.emitter.trigger('resourceChange', {\n            oldResource: new ResourceApi(context, oldResource),\n            resource: this,\n            revert: function () {\n                var _a;\n                context.dispatch({\n                    type: 'ADD_RESOURCE',\n                    resourceHash: (_a = {},\n                        _a[resourceId] = oldResource,\n                        _a),\n                });\n            },\n        });\n    };\n    ResourceApi.prototype.remove = function () {\n        var context = this._context;\n        var internalResource = this._resource;\n        var resourceId = internalResource.id;\n        context.dispatch({\n            type: 'REMOVE_RESOURCE',\n            resourceId: resourceId,\n        });\n        context.emitter.trigger('resourceRemove', {\n            resource: this,\n            revert: function () {\n                var _a;\n                context.dispatch({\n                    type: 'ADD_RESOURCE',\n                    resourceHash: (_a = {},\n                        _a[resourceId] = internalResource,\n                        _a),\n                });\n            },\n        });\n    };\n    ResourceApi.prototype.getParent = function () {\n        var context = this._context;\n        var parentId = this._resource.parentId;\n        if (parentId) {\n            return new ResourceApi(context, context.getCurrentData().resourceSource[parentId]);\n        }\n        return null;\n    };\n    ResourceApi.prototype.getChildren = function () {\n        var thisResourceId = this._resource.id;\n        var context = this._context;\n        var resourceStore = context.getCurrentData().resourceStore;\n        var childApis = [];\n        for (var resourceId in resourceStore) {\n            if (resourceStore[resourceId].parentId === thisResourceId) {\n                childApis.push(new ResourceApi(context, resourceStore[resourceId]));\n            }\n        }\n        return childApis;\n    };\n    /*\n    this is really inefficient!\n    TODO: make EventApi::resourceIds a hash or keep an index in the Calendar's state\n    */\n    ResourceApi.prototype.getEvents = function () {\n        var thisResourceId = this._resource.id;\n        var context = this._context;\n        var _a = context.getCurrentData().eventStore, defs = _a.defs, instances = _a.instances;\n        var eventApis = [];\n        for (var instanceId in instances) {\n            var instance = instances[instanceId];\n            var def = defs[instance.defId];\n            if (def.resourceIds.indexOf(thisResourceId) !== -1) { // inefficient!!!\n                eventApis.push(new EventApi(context, def, instance));\n            }\n        }\n        return eventApis;\n    };\n    Object.defineProperty(ResourceApi.prototype, \"id\", {\n        get: function () { return getPublicId(this._resource.id); },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"title\", {\n        get: function () { return this._resource.title; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"eventConstraint\", {\n        get: function () { return this._resource.ui.constraints[0] || null; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"eventOverlap\", {\n        get: function () { return this._resource.ui.overlap; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"eventAllow\", {\n        get: function () { return this._resource.ui.allows[0] || null; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"eventBackgroundColor\", {\n        get: function () { return this._resource.ui.backgroundColor; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"eventBorderColor\", {\n        get: function () { return this._resource.ui.borderColor; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"eventTextColor\", {\n        get: function () { return this._resource.ui.textColor; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"eventClassNames\", {\n        // NOTE: user can't modify these because Object.freeze was called in event-def parsing\n        get: function () { return this._resource.ui.classNames; },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ResourceApi.prototype, \"extendedProps\", {\n        get: function () { return this._resource.extendedProps; },\n        enumerable: false,\n        configurable: true\n    });\n    ResourceApi.prototype.toPlainObject = function (settings) {\n        if (settings === void 0) { settings = {}; }\n        var internal = this._resource;\n        var ui = internal.ui;\n        var publicId = this.id;\n        var res = {};\n        if (publicId) {\n            res.id = publicId;\n        }\n        if (internal.title) {\n            res.title = internal.title;\n        }\n        if (settings.collapseEventColor && ui.backgroundColor && ui.backgroundColor === ui.borderColor) {\n            res.eventColor = ui.backgroundColor;\n        }\n        else {\n            if (ui.backgroundColor) {\n                res.eventBackgroundColor = ui.backgroundColor;\n            }\n            if (ui.borderColor) {\n                res.eventBorderColor = ui.borderColor;\n            }\n        }\n        if (ui.textColor) {\n            res.eventTextColor = ui.textColor;\n        }\n        if (ui.classNames.length) {\n            res.eventClassNames = ui.classNames;\n        }\n        if (Object.keys(internal.extendedProps).length) {\n            if (settings.collapseExtendedProps) {\n                __assign(res, internal.extendedProps);\n            }\n            else {\n                res.extendedProps = internal.extendedProps;\n            }\n        }\n        return res;\n    };\n    ResourceApi.prototype.toJSON = function () {\n        return this.toPlainObject();\n    };\n    return ResourceApi;\n}());\nfunction buildResourceApis(resourceStore, context) {\n    var resourceApis = [];\n    for (var resourceId in resourceStore) {\n        resourceApis.push(new ResourceApi(context, resourceStore[resourceId]));\n    }\n    return resourceApis;\n}\n\nCalendarApi.prototype.addResource = function (input, scrollTo) {\n    var _a;\n    var _this = this;\n    if (scrollTo === void 0) { scrollTo = true; }\n    var currentState = this.getCurrentData();\n    var resourceHash;\n    var resource;\n    if (input instanceof ResourceApi) {\n        resource = input._resource;\n        resourceHash = (_a = {}, _a[resource.id] = resource, _a);\n    }\n    else {\n        resourceHash = {};\n        resource = parseResource(input, '', resourceHash, currentState);\n    }\n    this.dispatch({\n        type: 'ADD_RESOURCE',\n        resourceHash: resourceHash,\n    });\n    if (scrollTo) {\n        // TODO: wait til dispatch completes somehow\n        this.trigger('_scrollRequest', { resourceId: resource.id });\n    }\n    var resourceApi = new ResourceApi(currentState, resource);\n    currentState.emitter.trigger('resourceAdd', {\n        resource: resourceApi,\n        revert: function () {\n            _this.dispatch({\n                type: 'REMOVE_RESOURCE',\n                resourceId: resource.id,\n            });\n        },\n    });\n    return resourceApi;\n};\nCalendarApi.prototype.getResourceById = function (id) {\n    id = String(id);\n    var currentState = this.getCurrentData(); // eslint-disable-line react/no-this-in-sfc\n    if (currentState.resourceStore) { // guard against calendar with no resource functionality\n        var rawResource = currentState.resourceStore[id];\n        if (rawResource) {\n            return new ResourceApi(currentState, rawResource);\n        }\n    }\n    return null;\n};\nCalendarApi.prototype.getResources = function () {\n    var currentState = this.getCurrentData();\n    var resourceStore = currentState.resourceStore;\n    var resourceApis = [];\n    if (resourceStore) { // guard against calendar with no resource functionality\n        for (var resourceId in resourceStore) {\n            resourceApis.push(new ResourceApi(currentState, resourceStore[resourceId]));\n        }\n    }\n    return resourceApis;\n};\nCalendarApi.prototype.getTopLevelResources = function () {\n    var currentState = this.getCurrentData();\n    var resourceStore = currentState.resourceStore;\n    var resourceApis = [];\n    if (resourceStore) { // guard against calendar with no resource functionality\n        for (var resourceId in resourceStore) {\n            if (!resourceStore[resourceId].parentId) {\n                resourceApis.push(new ResourceApi(currentState, resourceStore[resourceId]));\n            }\n        }\n    }\n    return resourceApis;\n};\nCalendarApi.prototype.refetchResources = function () {\n    this.dispatch({\n        type: 'REFETCH_RESOURCES',\n    });\n};\nfunction transformDatePoint(dateSpan, context) {\n    return dateSpan.resourceId ?\n        { resource: context.calendarApi.getResourceById(dateSpan.resourceId) } :\n        {};\n}\nfunction transformDateSpan(dateSpan, context) {\n    return dateSpan.resourceId ?\n        { resource: context.calendarApi.getResourceById(dateSpan.resourceId) } :\n        {};\n}\n\n/*\nsplits things BASED OFF OF which resources they are associated with.\ncreates a '' entry which is when something has NO resource.\n*/\nvar ResourceSplitter = /** @class */ (function (_super) {\n    __extends(ResourceSplitter, _super);\n    function ResourceSplitter() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ResourceSplitter.prototype.getKeyInfo = function (props) {\n        return __assign({ '': {} }, props.resourceStore);\n    };\n    ResourceSplitter.prototype.getKeysForDateSpan = function (dateSpan) {\n        return [dateSpan.resourceId || ''];\n    };\n    ResourceSplitter.prototype.getKeysForEventDef = function (eventDef) {\n        var resourceIds = eventDef.resourceIds;\n        if (!resourceIds.length) {\n            return [''];\n        }\n        return resourceIds;\n    };\n    return ResourceSplitter;\n}(Splitter));\n\nfunction isPropsValidWithResources(combinedProps, context) {\n    var splitter = new ResourceSplitter();\n    var sets = splitter.splitProps(__assign(__assign({}, combinedProps), { resourceStore: context.getCurrentData().resourceStore }));\n    for (var resourceId in sets) {\n        var props = sets[resourceId];\n        // merge in event data from the non-resource segment\n        if (resourceId && sets['']) { // current segment is not the non-resource one, and there IS a non-resource one\n            props = __assign(__assign({}, props), { eventStore: mergeEventStores(sets[''].eventStore, props.eventStore), eventUiBases: __assign(__assign({}, sets[''].eventUiBases), props.eventUiBases) });\n        }\n        if (!isPropsValid(props, context, { resourceId: resourceId }, filterConfig.bind(null, resourceId))) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction filterConfig(resourceId, config) {\n    return __assign(__assign({}, config), { constraints: filterConstraints(resourceId, config.constraints) });\n}\nfunction filterConstraints(resourceId, constraints) {\n    return constraints.map(function (constraint) {\n        var defs = constraint.defs;\n        if (defs) { // we are dealing with an EventStore\n            // if any of the events define constraints to resources that are NOT this resource,\n            // then this resource is unconditionally prohibited, which is what a `false` value does.\n            for (var defId in defs) {\n                var resourceIds = defs[defId].resourceIds;\n                if (resourceIds.length && resourceIds.indexOf(resourceId) === -1) { // TODO: use a hash?!!! (for other reasons too)\n                    return false;\n                }\n            }\n        }\n        return constraint;\n    });\n}\n\nfunction transformExternalDef(dateSpan) {\n    return dateSpan.resourceId ?\n        { resourceId: dateSpan.resourceId } :\n        {};\n}\n\nEventApi.prototype.getResources = function () {\n    var calendarApi = this._context.calendarApi;\n    return this._def.resourceIds.map(function (resourceId) { return calendarApi.getResourceById(resourceId); });\n};\nEventApi.prototype.setResources = function (resources) {\n    var resourceIds = [];\n    // massage resources -> resourceIds\n    for (var _i = 0, resources_1 = resources; _i < resources_1.length; _i++) {\n        var resource = resources_1[_i];\n        var resourceId = null;\n        if (typeof resource === 'string') {\n            resourceId = resource;\n        }\n        else if (typeof resource === 'number') {\n            resourceId = String(resource);\n        }\n        else if (resource instanceof ResourceApi) {\n            resourceId = resource.id; // guaranteed to always have an ID. hmmm\n        }\n        else {\n            console.warn('unknown resource type: ' + resource);\n        }\n        if (resourceId) {\n            resourceIds.push(resourceId);\n        }\n    }\n    this.mutate({\n        standardProps: {\n            resourceIds: resourceIds,\n        },\n    });\n};\n\nvar optionChangeHandlers = {\n    resources: handleResources,\n};\nfunction handleResources(newSourceInput, context) {\n    var oldSourceInput = context.getCurrentData().resourceSource._raw;\n    if (oldSourceInput !== newSourceInput) {\n        context.dispatch({\n            type: 'RESET_RESOURCE_SOURCE',\n            resourceSourceInput: newSourceInput,\n        });\n    }\n}\n\nvar DEFAULT_RESOURCE_ORDER = parseFieldSpecs('id,title');\nfunction handleResourceStore(resourceStore, calendarData) {\n    var emitter = calendarData.emitter;\n    if (emitter.hasHandlers('resourcesSet')) {\n        emitter.trigger('resourcesSet', buildResourceApis(resourceStore, calendarData));\n    }\n}\n\nvar OPTION_REFINERS = {\n    initialResources: identity,\n    resources: identity,\n    eventResourceEditable: Boolean,\n    refetchResourcesOnNavigate: Boolean,\n    resourceOrder: parseFieldSpecs,\n    filterResourcesWithEvents: Boolean,\n    resourceGroupField: String,\n    resourceAreaWidth: identity,\n    resourceAreaColumns: identity,\n    resourcesInitiallyExpanded: Boolean,\n    datesAboveResources: Boolean,\n    needsResourceData: Boolean,\n    resourceAreaHeaderClassNames: identity,\n    resourceAreaHeaderContent: identity,\n    resourceAreaHeaderDidMount: identity,\n    resourceAreaHeaderWillUnmount: identity,\n    resourceGroupLabelClassNames: identity,\n    resourceGroupLabelContent: identity,\n    resourceGroupLabelDidMount: identity,\n    resourceGroupLabelWillUnmount: identity,\n    resourceLabelClassNames: identity,\n    resourceLabelContent: identity,\n    resourceLabelDidMount: identity,\n    resourceLabelWillUnmount: identity,\n    resourceLaneClassNames: identity,\n    resourceLaneContent: identity,\n    resourceLaneDidMount: identity,\n    resourceLaneWillUnmount: identity,\n    resourceGroupLaneClassNames: identity,\n    resourceGroupLaneContent: identity,\n    resourceGroupLaneDidMount: identity,\n    resourceGroupLaneWillUnmount: identity,\n};\nvar LISTENER_REFINERS = {\n    resourcesSet: identity,\n    resourceAdd: identity,\n    resourceChange: identity,\n    resourceRemove: identity,\n};\n\nregisterResourceSourceDef({\n    ignoreRange: true,\n    parseMeta: function (refined) {\n        if (Array.isArray(refined.resources)) {\n            return refined.resources;\n        }\n        return null;\n    },\n    fetch: function (arg, successCallback) {\n        successCallback({\n            rawResources: arg.resourceSource.meta,\n        });\n    },\n});\n\nregisterResourceSourceDef({\n    parseMeta: function (refined) {\n        if (typeof refined.resources === 'function') {\n            return refined.resources;\n        }\n        return null;\n    },\n    fetch: function (arg, success, failure) {\n        var dateEnv = arg.context.dateEnv;\n        var func = arg.resourceSource.meta;\n        var publicArg = arg.range ? {\n            start: dateEnv.toDate(arg.range.start),\n            end: dateEnv.toDate(arg.range.end),\n            startStr: dateEnv.formatIso(arg.range.start),\n            endStr: dateEnv.formatIso(arg.range.end),\n            timeZone: dateEnv.timeZone,\n        } : {};\n        // TODO: make more dry with EventSourceFunc\n        // TODO: accept a response?\n        unpromisify(func.bind(null, publicArg), function (rawResources) {\n            success({ rawResources: rawResources }); // needs an object response\n        }, failure);\n    },\n});\n\nregisterResourceSourceDef({\n    parseMeta: function (refined) {\n        if (refined.url) {\n            return {\n                url: refined.url,\n                method: (refined.method || 'GET').toUpperCase(),\n                extraParams: refined.extraParams,\n            };\n        }\n        return null;\n    },\n    fetch: function (arg, successCallback, failureCallback) {\n        var meta = arg.resourceSource.meta;\n        var requestParams = buildRequestParams(meta, arg.range, arg.context);\n        requestJson(meta.method, meta.url, requestParams, function (rawResources, xhr) {\n            successCallback({ rawResources: rawResources, xhr: xhr });\n        }, function (message, xhr) {\n            failureCallback({ message: message, xhr: xhr });\n        });\n    },\n});\n// TODO: somehow consolidate with event json feed\nfunction buildRequestParams(meta, range, context) {\n    var dateEnv = context.dateEnv, options = context.options;\n    var startParam;\n    var endParam;\n    var timeZoneParam;\n    var customRequestParams;\n    var params = {};\n    if (range) {\n        startParam = meta.startParam;\n        if (startParam == null) {\n            startParam = options.startParam;\n        }\n        endParam = meta.endParam;\n        if (endParam == null) {\n            endParam = options.endParam;\n        }\n        timeZoneParam = meta.timeZoneParam;\n        if (timeZoneParam == null) {\n            timeZoneParam = options.timeZoneParam;\n        }\n        params[startParam] = dateEnv.formatIso(range.start);\n        params[endParam] = dateEnv.formatIso(range.end);\n        if (dateEnv.timeZone !== 'local') {\n            params[timeZoneParam] = dateEnv.timeZone;\n        }\n    }\n    // retrieve any outbound GET/POST data from the options\n    if (typeof meta.extraParams === 'function') {\n        // supplied as a function that returns a key/value object\n        customRequestParams = meta.extraParams();\n    }\n    else {\n        // probably supplied as a straight key/value object\n        customRequestParams = meta.extraParams || {};\n    }\n    __assign(params, customRequestParams);\n    return params;\n}\n\n// TODO: not used for Spreadsheet. START USING. difficult because of col-specific rendering props\nfunction ResourceLabelRoot(props) {\n    return (createElement(ViewContextType.Consumer, null, function (context) {\n        var options = context.options;\n        var hookProps = {\n            resource: new ResourceApi(context, props.resource),\n            date: props.date ? context.dateEnv.toDate(props.date) : null,\n            view: context.viewApi,\n        };\n        var dataAttrs = {\n            'data-resource-id': props.resource.id,\n            'data-date': props.date ? formatDayString(props.date) : undefined,\n        };\n        return (createElement(RenderHook, { hookProps: hookProps, classNames: options.resourceLabelClassNames, content: options.resourceLabelContent, defaultContent: renderInnerContent, didMount: options.resourceLabelDidMount, willUnmount: options.resourceLabelWillUnmount }, function (rootElRef, classNames, innerElRef, innerContent) { return props.children(rootElRef, classNames, // TODO: pass in 'fc-resource' ?\n        dataAttrs, innerElRef, innerContent); }));\n    }));\n}\nfunction renderInnerContent(props) {\n    return props.resource.title || props.resource.id;\n}\n\nvar ResourceCell = /** @class */ (function (_super) {\n    __extends(ResourceCell, _super);\n    function ResourceCell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ResourceCell.prototype.render = function () {\n        var props = this.props;\n        return (createElement(ResourceLabelRoot, { resource: props.resource, date: props.date }, function (elRef, customClassNames, dataAttrs, innerElRef, innerContent) { return (createElement(\"th\", __assign({ ref: elRef, role: \"columnheader\", className: ['fc-col-header-cell', 'fc-resource'].concat(customClassNames).join(' '), colSpan: props.colSpan }, dataAttrs),\n            createElement(\"div\", { className: \"fc-scrollgrid-sync-inner\" },\n                createElement(\"span\", { className: [\n                        'fc-col-header-cell-cushion',\n                        props.isSticky ? 'fc-sticky' : '',\n                    ].join(' '), ref: innerElRef }, innerContent)))); }));\n    };\n    return ResourceCell;\n}(BaseComponent));\n\nvar ResourceDayHeader = /** @class */ (function (_super) {\n    __extends(ResourceDayHeader, _super);\n    function ResourceDayHeader() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.buildDateFormat = memoize(buildDateFormat);\n        return _this;\n    }\n    ResourceDayHeader.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var dateFormat = this.buildDateFormat(context.options.dayHeaderFormat, props.datesRepDistinctDays, props.dates.length);\n        return (createElement(NowTimer, { unit: \"day\" }, function (nowDate, todayRange) {\n            if (props.dates.length === 1) {\n                return _this.renderResourceRow(props.resources, props.dates[0]);\n            }\n            if (context.options.datesAboveResources) {\n                return _this.renderDayAndResourceRows(props.dates, dateFormat, todayRange, props.resources);\n            }\n            return _this.renderResourceAndDayRows(props.resources, props.dates, dateFormat, todayRange);\n        }));\n    };\n    ResourceDayHeader.prototype.renderResourceRow = function (resources, date) {\n        var resourceCells = resources.map(function (resource) { return (createElement(ResourceCell, { key: resource.id, resource: resource, colSpan: 1, date: date })); });\n        return this.buildTr(resourceCells, 'resources');\n    };\n    ResourceDayHeader.prototype.renderDayAndResourceRows = function (dates, dateFormat, todayRange, resources) {\n        var dateCells = [];\n        var resourceCells = [];\n        for (var _i = 0, dates_1 = dates; _i < dates_1.length; _i++) {\n            var date = dates_1[_i];\n            dateCells.push(this.renderDateCell(date, dateFormat, todayRange, resources.length, null, true));\n            for (var _a = 0, resources_1 = resources; _a < resources_1.length; _a++) {\n                var resource = resources_1[_a];\n                resourceCells.push(createElement(ResourceCell, { key: resource.id + ':' + date.toISOString(), resource: resource, colSpan: 1, date: date }));\n            }\n        }\n        return (createElement(Fragment, null,\n            this.buildTr(dateCells, 'day'),\n            this.buildTr(resourceCells, 'resources')));\n    };\n    ResourceDayHeader.prototype.renderResourceAndDayRows = function (resources, dates, dateFormat, todayRange) {\n        var resourceCells = [];\n        var dateCells = [];\n        for (var _i = 0, resources_2 = resources; _i < resources_2.length; _i++) {\n            var resource = resources_2[_i];\n            resourceCells.push(createElement(ResourceCell, { key: resource.id, resource: resource, colSpan: dates.length, isSticky: true }));\n            for (var _a = 0, dates_2 = dates; _a < dates_2.length; _a++) {\n                var date = dates_2[_a];\n                dateCells.push(this.renderDateCell(date, dateFormat, todayRange, 1, resource));\n            }\n        }\n        return (createElement(Fragment, null,\n            this.buildTr(resourceCells, 'resources'),\n            this.buildTr(dateCells, 'day')));\n    };\n    // a cell with date text. might have a resource associated with it\n    ResourceDayHeader.prototype.renderDateCell = function (date, dateFormat, todayRange, colSpan, resource, isSticky) {\n        var props = this.props;\n        var keyPostfix = resource ? \":\" + resource.id : '';\n        var extraHookProps = resource ? { resource: new ResourceApi(this.context, resource) } : {};\n        var extraDataAttrs = resource ? { 'data-resource-id': resource.id } : {};\n        return props.datesRepDistinctDays ? (createElement(TableDateCell, { key: date.toISOString() + keyPostfix, date: date, dateProfile: props.dateProfile, todayRange: todayRange, colCnt: props.dates.length * props.resources.length, dayHeaderFormat: dateFormat, colSpan: colSpan, isSticky: isSticky, extraHookProps: extraHookProps, extraDataAttrs: extraDataAttrs })) : (createElement(TableDowCell // we can't leverage the pure-componentness becausae the extra* props are new every time :(\n        , { key: date.getUTCDay() + keyPostfix, dow: date.getUTCDay(), dayHeaderFormat: dateFormat, colSpan: colSpan, isSticky: isSticky, extraHookProps: extraHookProps, extraDataAttrs: extraDataAttrs }));\n    };\n    ResourceDayHeader.prototype.buildTr = function (cells, key) {\n        var renderIntro = this.props.renderIntro;\n        if (!cells.length) {\n            cells = [createElement(\"td\", { key: 0 }, \"\\u00A0\")];\n        }\n        return (createElement(\"tr\", { key: key, role: \"row\" },\n            renderIntro && renderIntro(key),\n            cells));\n    };\n    return ResourceDayHeader;\n}(BaseComponent));\nfunction buildDateFormat(dayHeaderFormat, datesRepDistinctDays, dayCnt) {\n    return dayHeaderFormat || computeFallbackHeaderFormat(datesRepDistinctDays, dayCnt);\n}\n\nvar ResourceIndex = /** @class */ (function () {\n    function ResourceIndex(resources) {\n        var indicesById = {};\n        var ids = [];\n        for (var i = 0; i < resources.length; i += 1) {\n            var id = resources[i].id;\n            ids.push(id);\n            indicesById[id] = i;\n        }\n        this.ids = ids;\n        this.indicesById = indicesById;\n        this.length = resources.length;\n    }\n    return ResourceIndex;\n}());\n\nvar AbstractResourceDayTableModel = /** @class */ (function () {\n    function AbstractResourceDayTableModel(dayTableModel, resources, context) {\n        this.dayTableModel = dayTableModel;\n        this.resources = resources;\n        this.context = context;\n        this.resourceIndex = new ResourceIndex(resources);\n        this.rowCnt = dayTableModel.rowCnt;\n        this.colCnt = dayTableModel.colCnt * resources.length;\n        this.cells = this.buildCells();\n    }\n    AbstractResourceDayTableModel.prototype.buildCells = function () {\n        var _a = this, rowCnt = _a.rowCnt, dayTableModel = _a.dayTableModel, resources = _a.resources;\n        var rows = [];\n        for (var row = 0; row < rowCnt; row += 1) {\n            var rowCells = [];\n            for (var dateCol = 0; dateCol < dayTableModel.colCnt; dateCol += 1) {\n                for (var resourceCol = 0; resourceCol < resources.length; resourceCol += 1) {\n                    var resource = resources[resourceCol];\n                    var extraHookProps = { resource: new ResourceApi(this.context, resource) };\n                    var extraDataAttrs = { 'data-resource-id': resource.id };\n                    var extraClassNames = ['fc-resource'];\n                    var extraDateSpan = { resourceId: resource.id };\n                    var date = dayTableModel.cells[row][dateCol].date;\n                    rowCells[this.computeCol(dateCol, resourceCol)] = {\n                        key: resource.id + ':' + date.toISOString(),\n                        date: date,\n                        extraHookProps: extraHookProps,\n                        extraDataAttrs: extraDataAttrs,\n                        extraClassNames: extraClassNames,\n                        extraDateSpan: extraDateSpan,\n                    };\n                }\n            }\n            rows.push(rowCells);\n        }\n        return rows;\n    };\n    return AbstractResourceDayTableModel;\n}());\n\n/*\nresources over dates\n*/\nvar ResourceDayTableModel = /** @class */ (function (_super) {\n    __extends(ResourceDayTableModel, _super);\n    function ResourceDayTableModel() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ResourceDayTableModel.prototype.computeCol = function (dateI, resourceI) {\n        return resourceI * this.dayTableModel.colCnt + dateI;\n    };\n    /*\n    all date ranges are intact\n    */\n    ResourceDayTableModel.prototype.computeColRanges = function (dateStartI, dateEndI, resourceI) {\n        return [\n            {\n                firstCol: this.computeCol(dateStartI, resourceI),\n                lastCol: this.computeCol(dateEndI, resourceI),\n                isStart: true,\n                isEnd: true,\n            },\n        ];\n    };\n    return ResourceDayTableModel;\n}(AbstractResourceDayTableModel));\n\n/*\ndates over resources\n*/\nvar DayResourceTableModel = /** @class */ (function (_super) {\n    __extends(DayResourceTableModel, _super);\n    function DayResourceTableModel() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DayResourceTableModel.prototype.computeCol = function (dateI, resourceI) {\n        return dateI * this.resources.length + resourceI;\n    };\n    /*\n    every single day is broken up\n    */\n    DayResourceTableModel.prototype.computeColRanges = function (dateStartI, dateEndI, resourceI) {\n        var segs = [];\n        for (var i = dateStartI; i <= dateEndI; i += 1) {\n            var col = this.computeCol(i, resourceI);\n            segs.push({\n                firstCol: col,\n                lastCol: col,\n                isStart: i === dateStartI,\n                isEnd: i === dateEndI,\n            });\n        }\n        return segs;\n    };\n    return DayResourceTableModel;\n}(AbstractResourceDayTableModel));\n\nvar NO_SEGS = []; // for memoizing\nvar VResourceJoiner = /** @class */ (function () {\n    function VResourceJoiner() {\n        this.joinDateSelection = memoize(this.joinSegs);\n        this.joinBusinessHours = memoize(this.joinSegs);\n        this.joinFgEvents = memoize(this.joinSegs);\n        this.joinBgEvents = memoize(this.joinSegs);\n        this.joinEventDrags = memoize(this.joinInteractions);\n        this.joinEventResizes = memoize(this.joinInteractions);\n    }\n    /*\n    propSets also has a '' key for things with no resource\n    */\n    VResourceJoiner.prototype.joinProps = function (propSets, resourceDayTable) {\n        var dateSelectionSets = [];\n        var businessHoursSets = [];\n        var fgEventSets = [];\n        var bgEventSets = [];\n        var eventDrags = [];\n        var eventResizes = [];\n        var eventSelection = '';\n        var keys = resourceDayTable.resourceIndex.ids.concat(['']); // add in the all-resource key\n        for (var _i = 0, keys_1 = keys; _i < keys_1.length; _i++) {\n            var key = keys_1[_i];\n            var props = propSets[key];\n            dateSelectionSets.push(props.dateSelectionSegs);\n            businessHoursSets.push(key ? props.businessHourSegs : NO_SEGS); // don't include redundant all-resource businesshours\n            fgEventSets.push(key ? props.fgEventSegs : NO_SEGS); // don't include fg all-resource segs\n            bgEventSets.push(props.bgEventSegs);\n            eventDrags.push(props.eventDrag);\n            eventResizes.push(props.eventResize);\n            eventSelection = eventSelection || props.eventSelection;\n        }\n        return {\n            dateSelectionSegs: this.joinDateSelection.apply(this, __spreadArray([resourceDayTable], dateSelectionSets)),\n            businessHourSegs: this.joinBusinessHours.apply(this, __spreadArray([resourceDayTable], businessHoursSets)),\n            fgEventSegs: this.joinFgEvents.apply(this, __spreadArray([resourceDayTable], fgEventSets)),\n            bgEventSegs: this.joinBgEvents.apply(this, __spreadArray([resourceDayTable], bgEventSets)),\n            eventDrag: this.joinEventDrags.apply(this, __spreadArray([resourceDayTable], eventDrags)),\n            eventResize: this.joinEventResizes.apply(this, __spreadArray([resourceDayTable], eventResizes)),\n            eventSelection: eventSelection,\n        };\n    };\n    VResourceJoiner.prototype.joinSegs = function (resourceDayTable) {\n        var segGroups = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            segGroups[_i - 1] = arguments[_i];\n        }\n        var resourceCnt = resourceDayTable.resources.length;\n        var transformedSegs = [];\n        for (var i = 0; i < resourceCnt; i += 1) {\n            for (var _a = 0, _b = segGroups[i]; _a < _b.length; _a++) {\n                var seg = _b[_a];\n                transformedSegs.push.apply(transformedSegs, this.transformSeg(seg, resourceDayTable, i));\n            }\n            for (var _c = 0, _d = segGroups[resourceCnt]; _c < _d.length; _c++) { // one beyond. the all-resource\n                var seg = _d[_c];\n                transformedSegs.push.apply(// one beyond. the all-resource\n                transformedSegs, this.transformSeg(seg, resourceDayTable, i));\n            }\n        }\n        return transformedSegs;\n    };\n    /*\n    for expanding non-resource segs to all resources.\n    only for public use.\n    no memoizing.\n    */\n    VResourceJoiner.prototype.expandSegs = function (resourceDayTable, segs) {\n        var resourceCnt = resourceDayTable.resources.length;\n        var transformedSegs = [];\n        for (var i = 0; i < resourceCnt; i += 1) {\n            for (var _i = 0, segs_1 = segs; _i < segs_1.length; _i++) {\n                var seg = segs_1[_i];\n                transformedSegs.push.apply(transformedSegs, this.transformSeg(seg, resourceDayTable, i));\n            }\n        }\n        return transformedSegs;\n    };\n    VResourceJoiner.prototype.joinInteractions = function (resourceDayTable) {\n        var interactions = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            interactions[_i - 1] = arguments[_i];\n        }\n        var resourceCnt = resourceDayTable.resources.length;\n        var affectedInstances = {};\n        var transformedSegs = [];\n        var anyInteractions = false;\n        var isEvent = false;\n        for (var i = 0; i < resourceCnt; i += 1) {\n            var interaction = interactions[i];\n            if (interaction) {\n                anyInteractions = true;\n                for (var _a = 0, _b = interaction.segs; _a < _b.length; _a++) {\n                    var seg = _b[_a];\n                    transformedSegs.push.apply(transformedSegs, this.transformSeg(seg, resourceDayTable, i));\n                }\n                __assign(affectedInstances, interaction.affectedInstances);\n                isEvent = isEvent || interaction.isEvent;\n            }\n            if (interactions[resourceCnt]) { // one beyond. the all-resource\n                for (var _c = 0, _d = interactions[resourceCnt].segs; _c < _d.length; _c++) {\n                    var seg = _d[_c];\n                    transformedSegs.push.apply(transformedSegs, this.transformSeg(seg, resourceDayTable, i));\n                }\n            }\n        }\n        if (anyInteractions) {\n            return {\n                affectedInstances: affectedInstances,\n                segs: transformedSegs,\n                isEvent: isEvent,\n            };\n        }\n        return null;\n    };\n    return VResourceJoiner;\n}());\n\n/*\nTODO: just use ResourceHash somehow? could then use the generic ResourceSplitter\n*/\nvar VResourceSplitter = /** @class */ (function (_super) {\n    __extends(VResourceSplitter, _super);\n    function VResourceSplitter() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    VResourceSplitter.prototype.getKeyInfo = function (props) {\n        var resourceDayTableModel = props.resourceDayTableModel;\n        var hash = mapHash(resourceDayTableModel.resourceIndex.indicesById, function (i) { return resourceDayTableModel.resources[i]; }); // :(\n        hash[''] = {};\n        return hash;\n    };\n    VResourceSplitter.prototype.getKeysForDateSpan = function (dateSpan) {\n        return [dateSpan.resourceId || ''];\n    };\n    VResourceSplitter.prototype.getKeysForEventDef = function (eventDef) {\n        var resourceIds = eventDef.resourceIds;\n        if (!resourceIds.length) {\n            return [''];\n        }\n        return resourceIds;\n    };\n    return VResourceSplitter;\n}(Splitter));\n\n/*\ndoesn't accept grouping\n*/\nfunction flattenResources(resourceStore, orderSpecs) {\n    return buildRowNodes(resourceStore, [], orderSpecs, false, {}, true)\n        .map(function (node) { return node.resource; });\n}\nfunction buildRowNodes(resourceStore, groupSpecs, orderSpecs, isVGrouping, expansions, expansionDefault) {\n    var complexNodes = buildHierarchy(resourceStore, isVGrouping ? -1 : 1, groupSpecs, orderSpecs);\n    var flatNodes = [];\n    flattenNodes(complexNodes, flatNodes, isVGrouping, [], 0, expansions, expansionDefault);\n    return flatNodes;\n}\nfunction flattenNodes(complexNodes, res, isVGrouping, rowSpans, depth, expansions, expansionDefault) {\n    for (var i = 0; i < complexNodes.length; i += 1) {\n        var complexNode = complexNodes[i];\n        var group = complexNode.group;\n        if (group) {\n            if (isVGrouping) {\n                var firstRowIndex = res.length;\n                var rowSpanIndex = rowSpans.length;\n                flattenNodes(complexNode.children, res, isVGrouping, rowSpans.concat(0), depth, expansions, expansionDefault);\n                if (firstRowIndex < res.length) {\n                    var firstRow = res[firstRowIndex];\n                    var firstRowSpans = firstRow.rowSpans = firstRow.rowSpans.slice();\n                    firstRowSpans[rowSpanIndex] = res.length - firstRowIndex;\n                }\n            }\n            else {\n                var id = group.spec.field + ':' + group.value;\n                var isExpanded = expansions[id] != null ? expansions[id] : expansionDefault;\n                res.push({ id: id, group: group, isExpanded: isExpanded });\n                if (isExpanded) {\n                    flattenNodes(complexNode.children, res, isVGrouping, rowSpans, depth + 1, expansions, expansionDefault);\n                }\n            }\n        }\n        else if (complexNode.resource) {\n            var id = complexNode.resource.id;\n            var isExpanded = expansions[id] != null ? expansions[id] : expansionDefault;\n            res.push({\n                id: id,\n                rowSpans: rowSpans,\n                depth: depth,\n                isExpanded: isExpanded,\n                hasChildren: Boolean(complexNode.children.length),\n                resource: complexNode.resource,\n                resourceFields: complexNode.resourceFields,\n            });\n            if (isExpanded) {\n                flattenNodes(complexNode.children, res, isVGrouping, rowSpans, depth + 1, expansions, expansionDefault);\n            }\n        }\n    }\n}\nfunction buildHierarchy(resourceStore, maxDepth, groupSpecs, orderSpecs) {\n    var resourceNodes = buildResourceNodes(resourceStore, orderSpecs);\n    var builtNodes = [];\n    for (var resourceId in resourceNodes) {\n        var resourceNode = resourceNodes[resourceId];\n        if (!resourceNode.resource.parentId) {\n            insertResourceNode(resourceNode, builtNodes, groupSpecs, 0, maxDepth, orderSpecs);\n        }\n    }\n    return builtNodes;\n}\nfunction buildResourceNodes(resourceStore, orderSpecs) {\n    var nodeHash = {};\n    for (var resourceId in resourceStore) {\n        var resource = resourceStore[resourceId];\n        nodeHash[resourceId] = {\n            resource: resource,\n            resourceFields: buildResourceFields(resource),\n            children: [],\n        };\n    }\n    for (var resourceId in resourceStore) {\n        var resource = resourceStore[resourceId];\n        if (resource.parentId) {\n            var parentNode = nodeHash[resource.parentId];\n            if (parentNode) {\n                insertResourceNodeInSiblings(nodeHash[resourceId], parentNode.children, orderSpecs);\n            }\n        }\n    }\n    return nodeHash;\n}\nfunction insertResourceNode(resourceNode, nodes, groupSpecs, depth, maxDepth, orderSpecs) {\n    if (groupSpecs.length && (maxDepth === -1 || depth <= maxDepth)) {\n        var groupNode = ensureGroupNodes(resourceNode, nodes, groupSpecs[0]);\n        insertResourceNode(resourceNode, groupNode.children, groupSpecs.slice(1), depth + 1, maxDepth, orderSpecs);\n    }\n    else {\n        insertResourceNodeInSiblings(resourceNode, nodes, orderSpecs);\n    }\n}\nfunction ensureGroupNodes(resourceNode, nodes, groupSpec) {\n    var groupValue = resourceNode.resourceFields[groupSpec.field];\n    var groupNode;\n    var newGroupIndex;\n    // find an existing group that matches, or determine the position for a new group\n    if (groupSpec.order) {\n        for (newGroupIndex = 0; newGroupIndex < nodes.length; newGroupIndex += 1) {\n            var node = nodes[newGroupIndex];\n            if (node.group) {\n                var cmp = flexibleCompare(groupValue, node.group.value) * groupSpec.order;\n                if (cmp === 0) {\n                    groupNode = node;\n                    break;\n                }\n                else if (cmp < 0) {\n                    break;\n                }\n            }\n        }\n    }\n    else { // the groups are unordered\n        for (newGroupIndex = 0; newGroupIndex < nodes.length; newGroupIndex += 1) {\n            var node = nodes[newGroupIndex];\n            if (node.group && groupValue === node.group.value) {\n                groupNode = node;\n                break;\n            }\n        }\n    }\n    if (!groupNode) {\n        groupNode = {\n            group: {\n                value: groupValue,\n                spec: groupSpec,\n            },\n            children: [],\n        };\n        nodes.splice(newGroupIndex, 0, groupNode);\n    }\n    return groupNode;\n}\nfunction insertResourceNodeInSiblings(resourceNode, siblings, orderSpecs) {\n    var i;\n    for (i = 0; i < siblings.length; i += 1) {\n        var cmp = compareByFieldSpecs(siblings[i].resourceFields, resourceNode.resourceFields, orderSpecs); // TODO: pass in ResourceApi?\n        if (cmp > 0) { // went 1 past. insert at i\n            break;\n        }\n    }\n    siblings.splice(i, 0, resourceNode);\n}\nfunction buildResourceFields(resource) {\n    var obj = __assign(__assign(__assign({}, resource.extendedProps), resource.ui), resource);\n    delete obj.ui;\n    delete obj.extendedProps;\n    return obj;\n}\nfunction isGroupsEqual(group0, group1) {\n    return group0.spec === group1.spec && group0.value === group1.value;\n}\n\nvar main = createPlugin({\n    deps: [\n        premiumCommonPlugin,\n    ],\n    reducers: [\n        reduceResources,\n    ],\n    isLoadingFuncs: [\n        function (state) { return state.resourceSource && state.resourceSource.isFetching; },\n    ],\n    eventRefiners: EVENT_REFINERS,\n    eventDefMemberAdders: [generateEventDefResourceMembers],\n    isDraggableTransformers: [transformIsDraggable],\n    eventDragMutationMassagers: [massageEventDragMutation],\n    eventDefMutationAppliers: [applyEventDefMutation],\n    dateSelectionTransformers: [transformDateSelectionJoin],\n    datePointTransforms: [transformDatePoint],\n    dateSpanTransforms: [transformDateSpan],\n    viewPropsTransformers: [ResourceDataAdder, ResourceEventConfigAdder],\n    isPropsValid: isPropsValidWithResources,\n    externalDefTransforms: [transformExternalDef],\n    eventDropTransformers: [transformEventDrop],\n    optionChangeHandlers: optionChangeHandlers,\n    optionRefiners: OPTION_REFINERS,\n    listenerRefiners: LISTENER_REFINERS,\n    propSetHandlers: { resourceStore: handleResourceStore },\n});\n\nexport default main;\nexport { AbstractResourceDayTableModel, DEFAULT_RESOURCE_ORDER, DayResourceTableModel, ResourceApi, ResourceDayHeader, ResourceDayTableModel, ResourceLabelRoot, ResourceSplitter, VResourceJoiner, VResourceSplitter, buildResourceFields, buildRowNodes, flattenResources, getPublicId, isGroupsEqual };\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || Array.prototype.slice.call(from));\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","/*!\nFullCalendar Scheduler v5.10.1\nDocs & License: https://fullcalendar.io/scheduler\n(c) 2021 Adam Shaw\n*/\nimport './main.css';\n\nimport { createElement, Fragment, ContentHook, BaseComponent, memoizeObjArg, buildClassNameNormalizer, MountHook, RenderHook, isArraysEqual, createRef, RefMap, findElements, elementClosest, PositionCache, memoize, greatestDurationDenominator, NowTimer, NowIndicatorRoot, DateComponent, config, getStickyHeaderDates, getStickyFooterScrollbar, renderScrollShim, ViewRoot, createPlugin } from '@fullcalendar/common';\nimport premiumCommonPlugin from '@fullcalendar/premium-common';\nimport timelinePlugin, { TimelineLane, TimelineLaneSlicer, TimelineSlats, TimelineLaneBg, coordToCss, buildTimelineDateProfile, buildSlatCols, TimelineHeader } from '@fullcalendar/timeline';\nimport resourceCommonPlugin, { ResourceApi, buildResourceFields, getPublicId, isGroupsEqual, ResourceSplitter, buildRowNodes, DEFAULT_RESOURCE_ORDER } from '@fullcalendar/resource-common';\nimport { __spreadArray, __extends, __assign } from 'tslib';\nimport { ScrollGrid } from '@fullcalendar/scrollgrid';\n\n/*\nRenders the DOM responsible for the subrow expander area,\nas well as the space before it (used to align expanders of similar depths)\n*/\nfunction ExpanderIcon(_a) {\n    var depth = _a.depth, hasChildren = _a.hasChildren, isExpanded = _a.isExpanded, onExpanderClick = _a.onExpanderClick;\n    var nodes = [];\n    for (var i = 0; i < depth; i += 1) {\n        nodes.push(createElement(\"span\", { className: \"fc-icon\" }));\n    }\n    var iconClassNames = ['fc-icon'];\n    if (hasChildren) {\n        if (isExpanded) {\n            iconClassNames.push('fc-icon-minus-square');\n        }\n        else {\n            iconClassNames.push('fc-icon-plus-square');\n        }\n    }\n    nodes.push(createElement(\"span\", { className: 'fc-datagrid-expander' + (hasChildren ? '' : ' fc-datagrid-expander-placeholder'), onClick: onExpanderClick },\n        createElement(\"span\", { className: iconClassNames.join(' ') })));\n    return createElement.apply(void 0, __spreadArray([Fragment, {}], nodes));\n}\n\nfunction refineHookProps$1(raw) {\n    return {\n        resource: new ResourceApi(raw.context, raw.resource),\n        fieldValue: raw.fieldValue,\n        view: raw.context.viewApi,\n    };\n}\n\nvar SpreadsheetIndividualCellInner = /** @class */ (function (_super) {\n    __extends(SpreadsheetIndividualCellInner, _super);\n    function SpreadsheetIndividualCellInner() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SpreadsheetIndividualCellInner.prototype.render = function () {\n        var props = this.props;\n        return (createElement(ContentHook, { hookProps: props.hookProps, content: props.colSpec.cellContent, defaultContent: renderResourceInner }, function (innerElRef, innerContent) { return (createElement(\"span\", { className: \"fc-datagrid-cell-main\", ref: innerElRef }, innerContent)); }));\n    };\n    return SpreadsheetIndividualCellInner;\n}(BaseComponent));\nfunction renderResourceInner(hookProps) {\n    return hookProps.fieldValue || createElement(Fragment, null, \"\\u00A0\");\n}\n\n// worth making a PureComponent? (because of innerHeight)\nvar SpreadsheetIndividualCell = /** @class */ (function (_super) {\n    __extends(SpreadsheetIndividualCell, _super);\n    function SpreadsheetIndividualCell() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.refineHookProps = memoizeObjArg(refineHookProps$1);\n        _this.normalizeClassNames = buildClassNameNormalizer();\n        _this.onExpanderClick = function (ev) {\n            var props = _this.props;\n            if (props.hasChildren) {\n                _this.context.dispatch({\n                    type: 'SET_RESOURCE_ENTITY_EXPANDED',\n                    id: props.resource.id,\n                    isExpanded: !props.isExpanded,\n                });\n            }\n        };\n        return _this;\n    }\n    SpreadsheetIndividualCell.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var colSpec = props.colSpec;\n        var hookProps = this.refineHookProps({\n            resource: props.resource,\n            fieldValue: props.fieldValue,\n            context: context,\n        });\n        var customClassNames = this.normalizeClassNames(colSpec.cellClassNames, hookProps);\n        return (createElement(MountHook, { hookProps: hookProps, didMount: colSpec.cellDidMount, willUnmount: colSpec.cellWillUnmount }, function (rootElRef) { return (createElement(\"td\", { ref: rootElRef, role: \"gridcell\", \"data-resource-id\": props.resource.id, className: [\n                'fc-datagrid-cell',\n                'fc-resource',\n            ].concat(customClassNames).join(' ') },\n            createElement(\"div\", { className: \"fc-datagrid-cell-frame\", style: { height: props.innerHeight } },\n                createElement(\"div\", { className: \"fc-datagrid-cell-cushion fc-scrollgrid-sync-inner\" },\n                    colSpec.isMain && (createElement(ExpanderIcon, { depth: props.depth, hasChildren: props.hasChildren, isExpanded: props.isExpanded, onExpanderClick: _this.onExpanderClick })),\n                    createElement(SpreadsheetIndividualCellInner, { hookProps: hookProps, colSpec: colSpec }))))); }));\n    };\n    return SpreadsheetIndividualCell;\n}(BaseComponent));\n\n// for VERTICAL cell grouping, in spreadsheet area\nvar SpreadsheetGroupCell = /** @class */ (function (_super) {\n    __extends(SpreadsheetGroupCell, _super);\n    function SpreadsheetGroupCell() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SpreadsheetGroupCell.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        var colSpec = props.colSpec;\n        var hookProps = {\n            groupValue: props.fieldValue,\n            view: context.viewApi,\n        };\n        // a grouped cell. no data that is specific to this specific resource\n        // `colSpec` is for the group. a GroupSpec :(\n        return (createElement(RenderHook, { hookProps: hookProps, classNames: colSpec.cellClassNames, content: colSpec.cellContent, defaultContent: renderGroupInner, didMount: colSpec.cellDidMount, willUnmount: colSpec.cellWillUnmount }, function (rootElRef, classNames, innerElRef, innerContent) { return (\n        // TODO: make data-attr with group value?\n        createElement(\"td\", { ref: rootElRef, role: \"gridcell\", rowSpan: props.rowSpan, className: ['fc-datagrid-cell', 'fc-resource-group'].concat(classNames).join(' ') },\n            createElement(\"div\", { className: \"fc-datagrid-cell-frame fc-datagrid-cell-frame-liquid\" },\n                createElement(\"div\", { className: \"fc-datagrid-cell-cushion fc-sticky\", ref: innerElRef }, innerContent)))); }));\n    };\n    return SpreadsheetGroupCell;\n}(BaseComponent));\nfunction renderGroupInner(hookProps) {\n    return hookProps.groupValue || createElement(Fragment, null, \"\\u00A0\");\n}\n\nvar SpreadsheetRow = /** @class */ (function (_super) {\n    __extends(SpreadsheetRow, _super);\n    function SpreadsheetRow() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    SpreadsheetRow.prototype.render = function () {\n        var props = this.props;\n        var resource = props.resource, rowSpans = props.rowSpans, depth = props.depth;\n        var resourceFields = buildResourceFields(resource); // slightly inefficient. already done up the call stack\n        return (createElement(\"tr\", { role: \"row\" }, props.colSpecs.map(function (colSpec, i) {\n            var rowSpan = rowSpans[i];\n            if (rowSpan === 0) { // not responsible for group-based rows. VRowGroup is\n                return null;\n            }\n            if (rowSpan == null) {\n                rowSpan = 1;\n            }\n            var fieldValue = colSpec.field ? resourceFields[colSpec.field] :\n                (resource.title || getPublicId(resource.id));\n            if (rowSpan > 1) {\n                return (createElement(SpreadsheetGroupCell, { key: i, colSpec: colSpec, fieldValue: fieldValue, rowSpan: rowSpan }));\n            }\n            return (createElement(SpreadsheetIndividualCell, { key: i, colSpec: colSpec, resource: resource, fieldValue: fieldValue, depth: depth, hasChildren: props.hasChildren, isExpanded: props.isExpanded, innerHeight: props.innerHeight }));\n        })));\n    };\n    return SpreadsheetRow;\n}(BaseComponent));\nSpreadsheetRow.addPropsEquality({\n    rowSpans: isArraysEqual,\n});\n\n// for HORIZONTAL cell grouping, in spreadsheet area\nvar SpreadsheetGroupRow = /** @class */ (function (_super) {\n    __extends(SpreadsheetGroupRow, _super);\n    function SpreadsheetGroupRow() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.innerInnerRef = createRef();\n        _this.onExpanderClick = function () {\n            var props = _this.props;\n            _this.context.dispatch({\n                type: 'SET_RESOURCE_ENTITY_EXPANDED',\n                id: props.id,\n                isExpanded: !props.isExpanded,\n            });\n        };\n        return _this;\n    }\n    SpreadsheetGroupRow.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var hookProps = { groupValue: props.group.value, view: context.viewApi };\n        var spec = props.group.spec;\n        return (createElement(\"tr\", { role: \"row\" },\n            createElement(RenderHook, { hookProps: hookProps, classNames: spec.labelClassNames, content: spec.labelContent, defaultContent: renderCellInner, didMount: spec.labelDidMount, willUnmount: spec.labelWillUnmount }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"th\", { ref: rootElRef, \n                // ARIA TODO: not really a columnheader\n                // extremely tedious to make this aria-compliant,\n                // to assign multiple headers to each cell\n                // https://www.w3.org/WAI/tutorials/tables/multi-level/\n                role: \"columnheader\", scope: \"colgroup\", colSpan: props.spreadsheetColCnt, className: [\n                    'fc-datagrid-cell',\n                    'fc-resource-group',\n                    context.theme.getClass('tableCellShaded'),\n                ].concat(classNames).join(' ') },\n                createElement(\"div\", { className: \"fc-datagrid-cell-frame\", style: { height: props.innerHeight } },\n                    createElement(\"div\", { className: \"fc-datagrid-cell-cushion fc-scrollgrid-sync-inner\", ref: _this.innerInnerRef },\n                        createElement(ExpanderIcon, { depth: 0, hasChildren: true, isExpanded: props.isExpanded, onExpanderClick: _this.onExpanderClick }),\n                        createElement(\"span\", { className: \"fc-datagrid-cell-main\", ref: innerElRef }, innerContent))))); })));\n    };\n    return SpreadsheetGroupRow;\n}(BaseComponent));\nSpreadsheetGroupRow.addPropsEquality({\n    group: isGroupsEqual,\n});\nfunction renderCellInner(hookProps) {\n    return hookProps.groupValue || createElement(Fragment, null, \"\\u00A0\");\n}\n\nvar SPREADSHEET_COL_MIN_WIDTH = 20;\nvar SpreadsheetHeader = /** @class */ (function (_super) {\n    __extends(SpreadsheetHeader, _super);\n    function SpreadsheetHeader() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.resizerElRefs = new RefMap(_this._handleColResizerEl.bind(_this));\n        _this.colDraggings = {};\n        return _this;\n    }\n    SpreadsheetHeader.prototype.render = function () {\n        var _this = this;\n        var _a = this.props, colSpecs = _a.colSpecs, superHeaderRendering = _a.superHeaderRendering, rowInnerHeights = _a.rowInnerHeights;\n        var hookProps = { view: this.context.viewApi };\n        var rowNodes = [];\n        rowInnerHeights = rowInnerHeights.slice(); // copy, because we're gonna pop\n        if (superHeaderRendering) {\n            var rowInnerHeight_1 = rowInnerHeights.shift();\n            rowNodes.push(createElement(\"tr\", { key: \"row-super\", role: \"row\" },\n                createElement(RenderHook, { hookProps: hookProps, classNames: superHeaderRendering.headerClassNames, content: superHeaderRendering.headerContent, didMount: superHeaderRendering.headerDidMount, willUnmount: superHeaderRendering.headerWillUnmount }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"th\", { ref: rootElRef, role: \"columnheader\", scope: \"colgroup\", colSpan: colSpecs.length, className: [\n                        'fc-datagrid-cell',\n                        'fc-datagrid-cell-super',\n                    ].concat(classNames).join(' ') },\n                    createElement(\"div\", { className: \"fc-datagrid-cell-frame\", style: { height: rowInnerHeight_1 } },\n                        createElement(\"div\", { className: \"fc-datagrid-cell-cushion fc-scrollgrid-sync-inner\", ref: innerElRef }, innerContent)))); })));\n        }\n        var rowInnerHeight = rowInnerHeights.shift();\n        rowNodes.push(createElement(\"tr\", { key: \"row\", role: \"row\" }, colSpecs.map(function (colSpec, i) {\n            var isLastCol = i === (colSpecs.length - 1);\n            // need empty inner div for abs positioning for resizer\n            return (createElement(RenderHook, { key: i, hookProps: hookProps, classNames: colSpec.headerClassNames, content: colSpec.headerContent, didMount: colSpec.headerDidMount, willUnmount: colSpec.headerWillUnmount }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"th\", { ref: rootElRef, role: \"columnheader\", className: ['fc-datagrid-cell'].concat(classNames).join(' ') },\n                createElement(\"div\", { className: \"fc-datagrid-cell-frame\", style: { height: rowInnerHeight } },\n                    createElement(\"div\", { className: \"fc-datagrid-cell-cushion fc-scrollgrid-sync-inner\" },\n                        colSpec.isMain && (createElement(\"span\", { className: \"fc-datagrid-expander fc-datagrid-expander-placeholder\" },\n                            createElement(\"span\", { className: \"fc-icon\" }))),\n                        createElement(\"span\", { className: \"fc-datagrid-cell-main\", ref: innerElRef }, innerContent)),\n                    !isLastCol &&\n                        createElement(\"div\", { className: \"fc-datagrid-cell-resizer\", ref: _this.resizerElRefs.createRef(i) })))); }));\n        })));\n        return (createElement(Fragment, null, rowNodes));\n    };\n    SpreadsheetHeader.prototype._handleColResizerEl = function (resizerEl, index) {\n        var colDraggings = this.colDraggings;\n        if (!resizerEl) {\n            var dragging = colDraggings[index];\n            if (dragging) {\n                dragging.destroy();\n                delete colDraggings[index];\n            }\n        }\n        else {\n            var dragging = this.initColResizing(resizerEl, parseInt(index, 10));\n            if (dragging) {\n                colDraggings[index] = dragging;\n            }\n        }\n    };\n    SpreadsheetHeader.prototype.initColResizing = function (resizerEl, index) {\n        var _a = this.context, pluginHooks = _a.pluginHooks, isRtl = _a.isRtl;\n        var onColWidthChange = this.props.onColWidthChange;\n        var ElementDraggingImpl = pluginHooks.elementDraggingImpl;\n        if (ElementDraggingImpl) {\n            var dragging = new ElementDraggingImpl(resizerEl);\n            var startWidth_1; // of just the single column\n            var currentWidths_1; // of all columns\n            dragging.emitter.on('dragstart', function () {\n                var allCells = findElements(elementClosest(resizerEl, 'tr'), 'th');\n                currentWidths_1 = allCells.map(function (cellEl) { return (cellEl.getBoundingClientRect().width); });\n                startWidth_1 = currentWidths_1[index];\n            });\n            dragging.emitter.on('dragmove', function (pev) {\n                currentWidths_1[index] = Math.max(startWidth_1 + pev.deltaX * (isRtl ? -1 : 1), SPREADSHEET_COL_MIN_WIDTH);\n                if (onColWidthChange) {\n                    onColWidthChange(currentWidths_1.slice()); // send a copy since currentWidths continues to be mutated\n                }\n            });\n            dragging.setAutoScrollEnabled(false); // because gets weird with auto-scrolling time area\n            return dragging;\n        }\n        return null;\n    };\n    return SpreadsheetHeader;\n}(BaseComponent));\n\nvar ResourceTimelineLaneMisc = /** @class */ (function (_super) {\n    __extends(ResourceTimelineLaneMisc, _super);\n    function ResourceTimelineLaneMisc() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ResourceTimelineLaneMisc.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        var hookProps = { resource: new ResourceApi(context, props.resource) }; // just easier to make directly\n        return (createElement(ContentHook, { hookProps: hookProps, content: context.options.resourceLaneContent }, function (innerElRef, innerContent) { return (innerContent && // TODO: test how this would interfere with height\n            createElement(\"div\", { className: \"fc-timeline-lane-misc\", ref: innerElRef }, innerContent)); }));\n    };\n    return ResourceTimelineLaneMisc;\n}(BaseComponent));\n\nvar ResourceTimelineLane = /** @class */ (function (_super) {\n    __extends(ResourceTimelineLane, _super);\n    function ResourceTimelineLane() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.refineHookProps = memoizeObjArg(refineHookProps);\n        _this.normalizeClassNames = buildClassNameNormalizer();\n        _this.handleHeightChange = function (innerEl, isStable) {\n            if (_this.props.onHeightChange) {\n                _this.props.onHeightChange(\n                // would want to use own <tr> ref, but not guaranteed to be ready when this fires\n                elementClosest(innerEl, 'tr'), isStable);\n            }\n        };\n        return _this;\n    }\n    ResourceTimelineLane.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, context = _a.context;\n        var options = context.options;\n        var hookProps = this.refineHookProps({ resource: props.resource, context: context });\n        var customClassNames = this.normalizeClassNames(options.resourceLaneClassNames, hookProps);\n        return (createElement(\"tr\", { ref: props.elRef },\n            createElement(MountHook, { hookProps: hookProps, didMount: options.resourceLaneDidMount, willUnmount: options.resourceLaneWillUnmount }, function (rootElRef) { return (createElement(\"td\", { ref: rootElRef, className: ['fc-timeline-lane', 'fc-resource'].concat(customClassNames).join(' '), \"data-resource-id\": props.resource.id },\n                createElement(\"div\", { className: \"fc-timeline-lane-frame\", style: { height: props.innerHeight } },\n                    createElement(ResourceTimelineLaneMisc, { resource: props.resource }),\n                    createElement(TimelineLane, { dateProfile: props.dateProfile, tDateProfile: props.tDateProfile, nowDate: props.nowDate, todayRange: props.todayRange, nextDayThreshold: props.nextDayThreshold, businessHours: props.businessHours, eventStore: props.eventStore, eventUiBases: props.eventUiBases, dateSelection: props.dateSelection, eventSelection: props.eventSelection, eventDrag: props.eventDrag, eventResize: props.eventResize, timelineCoords: props.timelineCoords, onHeightChange: _this.handleHeightChange, resourceId: props.resource.id })))); }))); // important NOT to do liquid-height. dont want to shrink height smaller than content\n    };\n    return ResourceTimelineLane;\n}(BaseComponent));\nfunction refineHookProps(raw) {\n    return {\n        resource: new ResourceApi(raw.context, raw.resource),\n    };\n}\n\n/*\nparallels the SpreadsheetGroupRow\n*/\nvar DividerRow = /** @class */ (function (_super) {\n    __extends(DividerRow, _super);\n    function DividerRow() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DividerRow.prototype.render = function () {\n        var _this = this;\n        var props = this.props;\n        var renderingHooks = this.props.renderingHooks;\n        var hookProps = { groupValue: props.groupValue, view: this.context.viewApi };\n        return (createElement(\"tr\", { ref: props.elRef },\n            createElement(RenderHook, { hookProps: hookProps, classNames: renderingHooks.laneClassNames, content: renderingHooks.laneContent, didMount: renderingHooks.laneDidMount, willUnmount: renderingHooks.laneWillUnmount }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"td\", { ref: rootElRef, className: [\n                    'fc-timeline-lane',\n                    'fc-resource-group',\n                    _this.context.theme.getClass('tableCellShaded'),\n                ].concat(classNames).join(' ') },\n                createElement(\"div\", { style: { height: props.innerHeight }, ref: innerElRef }, innerContent))); })));\n    };\n    return DividerRow;\n}(BaseComponent));\n\nvar ResourceTimelineLanesBody = /** @class */ (function (_super) {\n    __extends(ResourceTimelineLanesBody, _super);\n    function ResourceTimelineLanesBody() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ResourceTimelineLanesBody.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        var rowElRefs = props.rowElRefs, innerHeights = props.innerHeights;\n        return (createElement(\"tbody\", null, props.rowNodes.map(function (node, index) {\n            if (node.group) {\n                return (createElement(DividerRow, { key: node.id, elRef: rowElRefs.createRef(node.id), groupValue: node.group.value, renderingHooks: node.group.spec, innerHeight: innerHeights[index] || '' }));\n            }\n            if (node.resource) {\n                var resource = node.resource;\n                return (createElement(ResourceTimelineLane, __assign({ key: node.id, elRef: rowElRefs.createRef(node.id) }, props.splitProps[resource.id], { resource: resource, dateProfile: props.dateProfile, tDateProfile: props.tDateProfile, nowDate: props.nowDate, todayRange: props.todayRange, nextDayThreshold: context.options.nextDayThreshold, businessHours: resource.businessHours || props.fallbackBusinessHours, innerHeight: innerHeights[index] || '', timelineCoords: props.slatCoords, onHeightChange: props.onRowHeightChange })));\n            }\n            return null;\n        })));\n    };\n    return ResourceTimelineLanesBody;\n}(BaseComponent));\n\nvar ResourceTimelineLanes = /** @class */ (function (_super) {\n    __extends(ResourceTimelineLanes, _super);\n    function ResourceTimelineLanes() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.rootElRef = createRef();\n        _this.rowElRefs = new RefMap();\n        return _this;\n    }\n    ResourceTimelineLanes.prototype.render = function () {\n        var _a = this, props = _a.props, context = _a.context;\n        return (createElement(\"table\", { ref: this.rootElRef, \"aria-hidden\": true, className: 'fc-scrollgrid-sync-table ' + context.theme.getClass('table'), style: {\n                minWidth: props.tableMinWidth,\n                width: props.clientWidth,\n                height: props.minHeight,\n            } },\n            createElement(ResourceTimelineLanesBody, { rowElRefs: this.rowElRefs, rowNodes: props.rowNodes, dateProfile: props.dateProfile, tDateProfile: props.tDateProfile, nowDate: props.nowDate, todayRange: props.todayRange, splitProps: props.splitProps, fallbackBusinessHours: props.fallbackBusinessHours, slatCoords: props.slatCoords, innerHeights: props.innerHeights, onRowHeightChange: props.onRowHeightChange })));\n    };\n    ResourceTimelineLanes.prototype.componentDidMount = function () {\n        this.updateCoords();\n    };\n    ResourceTimelineLanes.prototype.componentDidUpdate = function () {\n        this.updateCoords();\n    };\n    ResourceTimelineLanes.prototype.componentWillUnmount = function () {\n        if (this.props.onRowCoords) {\n            this.props.onRowCoords(null);\n        }\n    };\n    ResourceTimelineLanes.prototype.updateCoords = function () {\n        var props = this.props;\n        if (props.onRowCoords && props.clientWidth !== null) { // a populated clientWidth means sizing has stabilized\n            this.props.onRowCoords(new PositionCache(this.rootElRef.current, collectRowEls(this.rowElRefs.currentMap, props.rowNodes), false, true));\n        }\n    };\n    return ResourceTimelineLanes;\n}(BaseComponent));\nfunction collectRowEls(elMap, rowNodes) {\n    return rowNodes.map(function (rowNode) { return elMap[rowNode.id]; });\n}\n\nvar ResourceTimelineGrid = /** @class */ (function (_super) {\n    __extends(ResourceTimelineGrid, _super);\n    function ResourceTimelineGrid() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.computeHasResourceBusinessHours = memoize(computeHasResourceBusinessHours);\n        _this.resourceSplitter = new ResourceSplitter(); // doesn't let it do businessHours tho\n        _this.bgSlicer = new TimelineLaneSlicer();\n        _this.slatsRef = createRef(); // needed for Hit creation :(\n        _this.state = {\n            slatCoords: null,\n        };\n        _this.handleEl = function (el) {\n            if (el) {\n                _this.context.registerInteractiveComponent(_this, { el: el });\n            }\n            else {\n                _this.context.unregisterInteractiveComponent(_this);\n            }\n        };\n        _this.handleSlatCoords = function (slatCoords) {\n            _this.setState({ slatCoords: slatCoords });\n            if (_this.props.onSlatCoords) {\n                _this.props.onSlatCoords(slatCoords);\n            }\n        };\n        _this.handleRowCoords = function (rowCoords) {\n            _this.rowCoords = rowCoords;\n            if (_this.props.onRowCoords) {\n                _this.props.onRowCoords(rowCoords);\n            }\n        };\n        return _this;\n    }\n    ResourceTimelineGrid.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var dateProfile = props.dateProfile, tDateProfile = props.tDateProfile;\n        var timerUnit = greatestDurationDenominator(tDateProfile.slotDuration).unit;\n        var hasResourceBusinessHours = this.computeHasResourceBusinessHours(props.rowNodes);\n        var splitProps = this.resourceSplitter.splitProps(props);\n        var bgLaneProps = splitProps[''];\n        var bgSlicedProps = this.bgSlicer.sliceProps(bgLaneProps, dateProfile, tDateProfile.isTimeScale ? null : props.nextDayThreshold, context, // wish we didn't need to pass in the rest of these args...\n        dateProfile, context.dateProfileGenerator, tDateProfile, context.dateEnv);\n        // WORKAROUND: make ignore slatCoords when out of sync with dateProfile\n        var slatCoords = state.slatCoords && state.slatCoords.dateProfile === props.dateProfile ? state.slatCoords : null;\n        return (createElement(\"div\", { ref: this.handleEl, className: [\n                'fc-timeline-body',\n                props.expandRows ? 'fc-timeline-body-expandrows' : '',\n            ].join(' '), style: { minWidth: props.tableMinWidth } },\n            createElement(NowTimer, { unit: timerUnit }, function (nowDate, todayRange) { return (createElement(Fragment, null,\n                createElement(TimelineSlats, { ref: _this.slatsRef, dateProfile: dateProfile, tDateProfile: tDateProfile, nowDate: nowDate, todayRange: todayRange, clientWidth: props.clientWidth, tableColGroupNode: props.tableColGroupNode, tableMinWidth: props.tableMinWidth, onCoords: _this.handleSlatCoords, onScrollLeftRequest: props.onScrollLeftRequest }),\n                createElement(TimelineLaneBg, { businessHourSegs: hasResourceBusinessHours ? null : bgSlicedProps.businessHourSegs, bgEventSegs: bgSlicedProps.bgEventSegs, timelineCoords: slatCoords, \n                    // empty array will result in unnecessary rerenders?\n                    eventResizeSegs: (bgSlicedProps.eventResize ? bgSlicedProps.eventResize.segs : []), dateSelectionSegs: bgSlicedProps.dateSelectionSegs, nowDate: nowDate, todayRange: todayRange }),\n                createElement(ResourceTimelineLanes, { rowNodes: props.rowNodes, dateProfile: dateProfile, tDateProfile: props.tDateProfile, nowDate: nowDate, todayRange: todayRange, splitProps: splitProps, fallbackBusinessHours: hasResourceBusinessHours ? props.businessHours : null, clientWidth: props.clientWidth, minHeight: props.expandRows ? props.clientHeight : '', tableMinWidth: props.tableMinWidth, innerHeights: props.rowInnerHeights, slatCoords: slatCoords, onRowCoords: _this.handleRowCoords, onRowHeightChange: props.onRowHeightChange }),\n                (context.options.nowIndicator && slatCoords && slatCoords.isDateInRange(nowDate)) && (createElement(\"div\", { className: \"fc-timeline-now-indicator-container\" },\n                    createElement(NowIndicatorRoot, { isAxis: false, date: nowDate }, function (rootElRef, classNames, innerElRef, innerContent) { return (createElement(\"div\", { ref: rootElRef, className: ['fc-timeline-now-indicator-line'].concat(classNames).join(' '), style: coordToCss(slatCoords.dateToCoord(nowDate), context.isRtl) }, innerContent)); }))))); })));\n    };\n    // Hit System\n    // ------------------------------------------------------------------------------------------\n    ResourceTimelineGrid.prototype.queryHit = function (positionLeft, positionTop) {\n        var rowCoords = this.rowCoords;\n        var rowIndex = rowCoords.topToIndex(positionTop);\n        if (rowIndex != null) {\n            var resource = this.props.rowNodes[rowIndex].resource;\n            if (resource) { // not a group\n                var slatHit = this.slatsRef.current.positionToHit(positionLeft);\n                if (slatHit) {\n                    return {\n                        dateProfile: this.props.dateProfile,\n                        dateSpan: {\n                            range: slatHit.dateSpan.range,\n                            allDay: slatHit.dateSpan.allDay,\n                            resourceId: resource.id,\n                        },\n                        rect: {\n                            left: slatHit.left,\n                            right: slatHit.right,\n                            top: rowCoords.tops[rowIndex],\n                            bottom: rowCoords.bottoms[rowIndex],\n                        },\n                        dayEl: slatHit.dayEl,\n                        layer: 0,\n                    };\n                }\n            }\n        }\n        return null;\n    };\n    return ResourceTimelineGrid;\n}(DateComponent));\nfunction computeHasResourceBusinessHours(rowNodes) {\n    for (var _i = 0, rowNodes_1 = rowNodes; _i < rowNodes_1.length; _i++) {\n        var node = rowNodes_1[_i];\n        var resource = node.resource;\n        if (resource && resource.businessHours) {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar MIN_RESOURCE_AREA_WIDTH = 30; // definitely bigger than scrollbars\n// RENAME?\nvar ResourceTimelineViewLayout = /** @class */ (function (_super) {\n    __extends(ResourceTimelineViewLayout, _super);\n    function ResourceTimelineViewLayout() {\n        var _this = _super !== null && _super.apply(this, arguments) || this;\n        _this.scrollGridRef = createRef();\n        _this.timeBodyScrollerElRef = createRef();\n        _this.spreadsheetHeaderChunkElRef = createRef();\n        _this.rootElRef = createRef();\n        _this.ensureScrollGridResizeId = 0;\n        _this.state = {\n            resourceAreaWidthOverride: null,\n        };\n        /*\n        ghetto debounce. don't race with ScrollGrid's resizing delay. solves #6140\n        */\n        _this.ensureScrollGridResize = function () {\n            if (_this.ensureScrollGridResizeId) {\n                clearTimeout(_this.ensureScrollGridResizeId);\n            }\n            _this.ensureScrollGridResizeId = setTimeout(function () {\n                _this.scrollGridRef.current.handleSizing(false);\n            }, config.SCROLLGRID_RESIZE_INTERVAL + 1);\n        };\n        return _this;\n    }\n    ResourceTimelineViewLayout.prototype.render = function () {\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var options = context.options;\n        var stickyHeaderDates = !props.forPrint && getStickyHeaderDates(options);\n        var stickyFooterScrollbar = !props.forPrint && getStickyFooterScrollbar(options);\n        var sections = [\n            {\n                type: 'header',\n                key: 'header',\n                syncRowHeights: true,\n                isSticky: stickyHeaderDates,\n                chunks: [\n                    {\n                        key: 'datagrid',\n                        elRef: this.spreadsheetHeaderChunkElRef,\n                        // TODO: allow the content to specify this. have general-purpose 'content' with obj with keys\n                        tableClassName: 'fc-datagrid-header',\n                        rowContent: props.spreadsheetHeaderRows,\n                    },\n                    {\n                        key: 'divider',\n                        outerContent: (createElement(\"td\", { role: \"presentation\", className: 'fc-resource-timeline-divider ' + context.theme.getClass('tableCellShaded') })),\n                    },\n                    {\n                        key: 'timeline',\n                        content: props.timeHeaderContent,\n                    },\n                ],\n            },\n            {\n                type: 'body',\n                key: 'body',\n                syncRowHeights: true,\n                liquid: true,\n                expandRows: Boolean(options.expandRows),\n                chunks: [\n                    {\n                        key: 'datagrid',\n                        tableClassName: 'fc-datagrid-body',\n                        rowContent: props.spreadsheetBodyRows,\n                    },\n                    {\n                        key: 'divider',\n                        outerContent: (createElement(\"td\", { role: \"presentation\", className: 'fc-resource-timeline-divider ' + context.theme.getClass('tableCellShaded') })),\n                    },\n                    {\n                        key: 'timeline',\n                        scrollerElRef: this.timeBodyScrollerElRef,\n                        content: props.timeBodyContent,\n                    },\n                ],\n            },\n        ];\n        if (stickyFooterScrollbar) {\n            sections.push({\n                type: 'footer',\n                key: 'footer',\n                isSticky: true,\n                chunks: [\n                    {\n                        key: 'datagrid',\n                        content: renderScrollShim,\n                    },\n                    {\n                        key: 'divider',\n                        outerContent: (createElement(\"td\", { role: \"presentation\", className: 'fc-resource-timeline-divider ' + context.theme.getClass('tableCellShaded') })),\n                    },\n                    {\n                        key: 'timeline',\n                        content: renderScrollShim,\n                    },\n                ],\n            });\n        }\n        var resourceAreaWidth = state.resourceAreaWidthOverride != null\n            ? state.resourceAreaWidthOverride\n            : options.resourceAreaWidth;\n        return (createElement(ScrollGrid, { ref: this.scrollGridRef, elRef: this.rootElRef, liquid: !props.isHeightAuto && !props.forPrint, collapsibleWidth: false, colGroups: [\n                { cols: props.spreadsheetCols, width: resourceAreaWidth },\n                { cols: [] },\n                { cols: props.timeCols },\n            ], sections: sections }));\n    };\n    ResourceTimelineViewLayout.prototype.forceTimeScroll = function (left) {\n        var scrollGrid = this.scrollGridRef.current;\n        scrollGrid.forceScrollLeft(2, left); // 2 = the time area\n    };\n    ResourceTimelineViewLayout.prototype.forceResourceScroll = function (top) {\n        var scrollGrid = this.scrollGridRef.current;\n        scrollGrid.forceScrollTop(1, top); // 1 = the body\n    };\n    ResourceTimelineViewLayout.prototype.getResourceScroll = function () {\n        var timeBodyScrollerEl = this.timeBodyScrollerElRef.current;\n        return timeBodyScrollerEl.scrollTop;\n    };\n    // Resource Area Resizing\n    // ------------------------------------------------------------------------------------------\n    // NOTE: a callback Ref for the resizer was firing multiple times with same elements (Preact)\n    // that's why we use spreadsheetResizerElRef instead\n    ResourceTimelineViewLayout.prototype.componentDidMount = function () {\n        this.initSpreadsheetResizing();\n    };\n    ResourceTimelineViewLayout.prototype.componentWillUnmount = function () {\n        this.destroySpreadsheetResizing();\n    };\n    ResourceTimelineViewLayout.prototype.initSpreadsheetResizing = function () {\n        var _this = this;\n        var _a = this.context, isRtl = _a.isRtl, pluginHooks = _a.pluginHooks;\n        var ElementDraggingImpl = pluginHooks.elementDraggingImpl;\n        var spreadsheetHeadEl = this.spreadsheetHeaderChunkElRef.current;\n        if (ElementDraggingImpl) {\n            var rootEl_1 = this.rootElRef.current;\n            var dragging = this.spreadsheetResizerDragging = new ElementDraggingImpl(rootEl_1, '.fc-resource-timeline-divider');\n            var dragStartWidth_1;\n            var viewWidth_1;\n            dragging.emitter.on('dragstart', function () {\n                dragStartWidth_1 = spreadsheetHeadEl.getBoundingClientRect().width;\n                viewWidth_1 = rootEl_1.getBoundingClientRect().width;\n            });\n            dragging.emitter.on('dragmove', function (pev) {\n                var newWidth = dragStartWidth_1 + pev.deltaX * (isRtl ? -1 : 1);\n                newWidth = Math.max(newWidth, MIN_RESOURCE_AREA_WIDTH);\n                newWidth = Math.min(newWidth, viewWidth_1 - MIN_RESOURCE_AREA_WIDTH);\n                // scrollgrid will ignore resize requests if there are too many :|\n                _this.setState({\n                    resourceAreaWidthOverride: newWidth,\n                }, _this.ensureScrollGridResize);\n            });\n            dragging.setAutoScrollEnabled(false); // because gets weird with auto-scrolling time area\n        }\n    };\n    ResourceTimelineViewLayout.prototype.destroySpreadsheetResizing = function () {\n        if (this.spreadsheetResizerDragging) {\n            this.spreadsheetResizerDragging.destroy();\n        }\n    };\n    return ResourceTimelineViewLayout;\n}(BaseComponent));\n\nvar ResourceTimelineView = /** @class */ (function (_super) {\n    __extends(ResourceTimelineView, _super);\n    function ResourceTimelineView(props, context) {\n        var _this = _super.call(this, props, context) || this;\n        _this.processColOptions = memoize(processColOptions);\n        _this.buildTimelineDateProfile = memoize(buildTimelineDateProfile);\n        _this.hasNesting = memoize(hasNesting);\n        _this.buildRowNodes = memoize(buildRowNodes);\n        _this.layoutRef = createRef();\n        _this.rowNodes = [];\n        _this.renderedRowNodes = [];\n        _this.buildRowIndex = memoize(buildRowIndex);\n        _this.handleSlatCoords = function (slatCoords) {\n            _this.setState({ slatCoords: slatCoords });\n        };\n        _this.handleRowCoords = function (rowCoords) {\n            _this.rowCoords = rowCoords;\n            _this.scrollResponder.update(false); // TODO: could eliminate this if rowCoords lived in state\n        };\n        _this.handleMaxCushionWidth = function (slotCushionMaxWidth) {\n            _this.setState({\n                slotCushionMaxWidth: Math.ceil(slotCushionMaxWidth), // for less rerendering TODO: DRY\n            });\n        };\n        // Scrolling\n        // ------------------------------------------------------------------------------------------------------------------\n        // this is useful for scrolling prev/next dates while resource is scrolled down\n        _this.handleScrollLeftRequest = function (scrollLeft) {\n            var layout = _this.layoutRef.current;\n            layout.forceTimeScroll(scrollLeft);\n        };\n        _this.handleScrollRequest = function (request) {\n            var rowCoords = _this.rowCoords;\n            var layout = _this.layoutRef.current;\n            var rowId = request.rowId || request.resourceId;\n            if (rowCoords) {\n                if (rowId) {\n                    var rowIdToIndex = _this.buildRowIndex(_this.renderedRowNodes);\n                    var index = rowIdToIndex[rowId];\n                    if (index != null) {\n                        var scrollTop = (request.fromBottom != null ?\n                            rowCoords.bottoms[index] - request.fromBottom : // pixels from bottom edge\n                            rowCoords.tops[index] // just use top edge\n                        );\n                        layout.forceResourceScroll(scrollTop);\n                    }\n                }\n                return true;\n            }\n            return null;\n        };\n        // Resource INDIVIDUAL-Column Area Resizing\n        // ------------------------------------------------------------------------------------------\n        _this.handleColWidthChange = function (colWidths) {\n            _this.setState({\n                spreadsheetColWidths: colWidths,\n            });\n        };\n        _this.state = {\n            resourceAreaWidth: context.options.resourceAreaWidth,\n            spreadsheetColWidths: [],\n        };\n        return _this;\n    }\n    ResourceTimelineView.prototype.render = function () {\n        var _this = this;\n        var _a = this, props = _a.props, state = _a.state, context = _a.context;\n        var options = context.options, viewSpec = context.viewSpec;\n        var _b = this.processColOptions(context.options), superHeaderRendering = _b.superHeaderRendering, groupSpecs = _b.groupSpecs, orderSpecs = _b.orderSpecs, isVGrouping = _b.isVGrouping, colSpecs = _b.colSpecs;\n        var tDateProfile = this.buildTimelineDateProfile(props.dateProfile, context.dateEnv, options, context.dateProfileGenerator);\n        var rowNodes = this.rowNodes = this.buildRowNodes(props.resourceStore, groupSpecs, orderSpecs, isVGrouping, props.resourceEntityExpansions, options.resourcesInitiallyExpanded);\n        var extraClassNames = [\n            'fc-resource-timeline',\n            this.hasNesting(rowNodes) ? '' : 'fc-resource-timeline-flat',\n            'fc-timeline',\n            options.eventOverlap === false ? 'fc-timeline-overlap-disabled' : 'fc-timeline-overlap-enabled',\n        ];\n        var slotMinWidth = options.slotMinWidth;\n        var slatCols = buildSlatCols(tDateProfile, slotMinWidth || this.computeFallbackSlotMinWidth(tDateProfile));\n        return (createElement(ViewRoot, { viewSpec: viewSpec }, function (rootElRef, classNames) { return (createElement(\"div\", { ref: rootElRef, className: extraClassNames.concat(classNames).join(' ') },\n            createElement(ResourceTimelineViewLayout, { ref: _this.layoutRef, forPrint: props.forPrint, isHeightAuto: props.isHeightAuto, spreadsheetCols: buildSpreadsheetCols(colSpecs, state.spreadsheetColWidths, ''), spreadsheetHeaderRows: function (contentArg) { return (createElement(SpreadsheetHeader // TODO: rename to SpreadsheetHeaderRows\n                , { superHeaderRendering: superHeaderRendering, colSpecs: colSpecs, onColWidthChange: _this.handleColWidthChange, rowInnerHeights: contentArg.rowSyncHeights })); }, spreadsheetBodyRows: function (contentArg) { return (createElement(Fragment, null, _this.renderSpreadsheetRows(rowNodes, colSpecs, contentArg.rowSyncHeights))); }, timeCols: slatCols, timeHeaderContent: function (contentArg) { return (createElement(TimelineHeader, { clientWidth: contentArg.clientWidth, clientHeight: contentArg.clientHeight, tableMinWidth: contentArg.tableMinWidth, tableColGroupNode: contentArg.tableColGroupNode, dateProfile: props.dateProfile, tDateProfile: tDateProfile, slatCoords: state.slatCoords, rowInnerHeights: contentArg.rowSyncHeights, onMaxCushionWidth: slotMinWidth ? null : _this.handleMaxCushionWidth })); }, timeBodyContent: function (contentArg) { return (createElement(ResourceTimelineGrid, { dateProfile: props.dateProfile, clientWidth: contentArg.clientWidth, clientHeight: contentArg.clientHeight, tableMinWidth: contentArg.tableMinWidth, tableColGroupNode: contentArg.tableColGroupNode, expandRows: contentArg.expandRows, tDateProfile: tDateProfile, rowNodes: rowNodes, businessHours: props.businessHours, dateSelection: props.dateSelection, eventStore: props.eventStore, eventUiBases: props.eventUiBases, eventSelection: props.eventSelection, eventDrag: props.eventDrag, eventResize: props.eventResize, resourceStore: props.resourceStore, nextDayThreshold: context.options.nextDayThreshold, rowInnerHeights: contentArg.rowSyncHeights, onSlatCoords: _this.handleSlatCoords, onRowCoords: _this.handleRowCoords, onScrollLeftRequest: _this.handleScrollLeftRequest, onRowHeightChange: contentArg.reportRowHeightChange })); } }))); }));\n    };\n    ResourceTimelineView.prototype.renderSpreadsheetRows = function (nodes, colSpecs, rowSyncHeights) {\n        return nodes.map(function (node, index) {\n            if (node.group) {\n                return (createElement(SpreadsheetGroupRow, { key: node.id, id: node.id, spreadsheetColCnt: colSpecs.length, isExpanded: node.isExpanded, group: node.group, innerHeight: rowSyncHeights[index] || '' }));\n            }\n            if (node.resource) {\n                return (createElement(SpreadsheetRow, { key: node.id, colSpecs: colSpecs, rowSpans: node.rowSpans, depth: node.depth, isExpanded: node.isExpanded, hasChildren: node.hasChildren, resource: node.resource, innerHeight: rowSyncHeights[index] || '' }));\n            }\n            return null;\n        });\n    };\n    ResourceTimelineView.prototype.componentDidMount = function () {\n        this.renderedRowNodes = this.rowNodes;\n        this.scrollResponder = this.context.createScrollResponder(this.handleScrollRequest);\n    };\n    ResourceTimelineView.prototype.getSnapshotBeforeUpdate = function () {\n        if (!this.props.forPrint) { // because print-view is always zero?\n            return { resourceScroll: this.queryResourceScroll() };\n        }\n        return {};\n    };\n    ResourceTimelineView.prototype.componentDidUpdate = function (prevProps, prevState, snapshot) {\n        this.renderedRowNodes = this.rowNodes;\n        this.scrollResponder.update(prevProps.dateProfile !== this.props.dateProfile);\n        if (snapshot.resourceScroll) {\n            this.handleScrollRequest(snapshot.resourceScroll); // TODO: this gets triggered too often\n        }\n    };\n    ResourceTimelineView.prototype.componentWillUnmount = function () {\n        this.scrollResponder.detach();\n    };\n    ResourceTimelineView.prototype.computeFallbackSlotMinWidth = function (tDateProfile) {\n        return Math.max(30, ((this.state.slotCushionMaxWidth || 0) / tDateProfile.slotsPerLabel));\n    };\n    ResourceTimelineView.prototype.queryResourceScroll = function () {\n        var _a = this, rowCoords = _a.rowCoords, renderedRowNodes = _a.renderedRowNodes;\n        if (rowCoords) {\n            var layout = this.layoutRef.current;\n            var trBottoms = rowCoords.bottoms;\n            var scrollTop = layout.getResourceScroll();\n            var scroll_1 = {};\n            for (var i = 0; i < trBottoms.length; i += 1) {\n                var rowNode = renderedRowNodes[i];\n                var elBottom = trBottoms[i] - scrollTop; // from the top of the scroller\n                if (elBottom > 0) {\n                    scroll_1.rowId = rowNode.id;\n                    scroll_1.fromBottom = elBottom;\n                    break;\n                }\n            }\n            return scroll_1;\n        }\n        return null;\n    };\n    return ResourceTimelineView;\n}(BaseComponent));\nResourceTimelineView.addStateEquality({\n    spreadsheetColWidths: isArraysEqual,\n});\nfunction buildRowIndex(rowNodes) {\n    var rowIdToIndex = {};\n    for (var i = 0; i < rowNodes.length; i += 1) {\n        rowIdToIndex[rowNodes[i].id] = i;\n    }\n    return rowIdToIndex;\n}\nfunction buildSpreadsheetCols(colSpecs, forcedWidths, fallbackWidth) {\n    if (fallbackWidth === void 0) { fallbackWidth = ''; }\n    return colSpecs.map(function (colSpec, i) { return ({\n        className: colSpec.isMain ? 'fc-main-col' : '',\n        width: forcedWidths[i] || colSpec.width || fallbackWidth,\n    }); });\n}\nfunction hasNesting(nodes) {\n    for (var _i = 0, nodes_1 = nodes; _i < nodes_1.length; _i++) {\n        var node = nodes_1[_i];\n        if (node.group) {\n            return true;\n        }\n        if (node.resource) {\n            if (node.hasChildren) {\n                return true;\n            }\n        }\n    }\n    return false;\n}\nfunction processColOptions(options) {\n    var allColSpecs = options.resourceAreaColumns || [];\n    var superHeaderRendering = null;\n    if (!allColSpecs.length) {\n        allColSpecs.push({\n            headerClassNames: options.resourceAreaHeaderClassNames,\n            headerContent: options.resourceAreaHeaderContent || 'Resources',\n            headerDidMount: options.resourceAreaHeaderDidMount,\n            headerWillUnmount: options.resourceAreaHeaderWillUnmount,\n        });\n    }\n    else if (options.resourceAreaHeaderContent) { // weird way to determine if content\n        superHeaderRendering = {\n            headerClassNames: options.resourceAreaHeaderClassNames,\n            headerContent: options.resourceAreaHeaderContent,\n            headerDidMount: options.resourceAreaHeaderDidMount,\n            headerWillUnmount: options.resourceAreaHeaderWillUnmount,\n        };\n    }\n    var plainColSpecs = [];\n    var groupColSpecs = []; // part of the colSpecs, but filtered out in order to put first\n    var groupSpecs = [];\n    var isVGrouping = false;\n    for (var _i = 0, allColSpecs_1 = allColSpecs; _i < allColSpecs_1.length; _i++) {\n        var colSpec = allColSpecs_1[_i];\n        if (colSpec.group) {\n            groupColSpecs.push(__assign(__assign({}, colSpec), { cellClassNames: colSpec.cellClassNames || options.resourceGroupLabelClassNames, cellContent: colSpec.cellContent || options.resourceGroupLabelContent, cellDidMount: colSpec.cellDidMount || options.resourceGroupLabelDidMount, cellWillUnmount: colSpec.cellWillUnmount || options.resourceGroupLaneWillUnmount }));\n        }\n        else {\n            plainColSpecs.push(colSpec);\n        }\n    }\n    // BAD: mutates a user-supplied option\n    var mainColSpec = plainColSpecs[0];\n    mainColSpec.isMain = true;\n    mainColSpec.cellClassNames = mainColSpec.cellClassNames || options.resourceLabelClassNames;\n    mainColSpec.cellContent = mainColSpec.cellContent || options.resourceLabelContent;\n    mainColSpec.cellDidMount = mainColSpec.cellDidMount || options.resourceLabelDidMount;\n    mainColSpec.cellWillUnmount = mainColSpec.cellWillUnmount || options.resourceLabelWillUnmount;\n    if (groupColSpecs.length) {\n        groupSpecs = groupColSpecs;\n        isVGrouping = true;\n    }\n    else {\n        var hGroupField = options.resourceGroupField;\n        if (hGroupField) {\n            groupSpecs.push({\n                field: hGroupField,\n                labelClassNames: options.resourceGroupLabelClassNames,\n                labelContent: options.resourceGroupLabelContent,\n                labelDidMount: options.resourceGroupLabelDidMount,\n                labelWillUnmount: options.resourceGroupLabelWillUnmount,\n                laneClassNames: options.resourceGroupLaneClassNames,\n                laneContent: options.resourceGroupLaneContent,\n                laneDidMount: options.resourceGroupLaneDidMount,\n                laneWillUnmount: options.resourceGroupLaneWillUnmount,\n            });\n        }\n    }\n    var allOrderSpecs = options.resourceOrder || DEFAULT_RESOURCE_ORDER;\n    var plainOrderSpecs = [];\n    for (var _a = 0, allOrderSpecs_1 = allOrderSpecs; _a < allOrderSpecs_1.length; _a++) {\n        var orderSpec = allOrderSpecs_1[_a];\n        var isGroup = false;\n        for (var _b = 0, groupSpecs_1 = groupSpecs; _b < groupSpecs_1.length; _b++) {\n            var groupSpec = groupSpecs_1[_b];\n            if (groupSpec.field === orderSpec.field) {\n                groupSpec.order = orderSpec.order; // -1, 0, 1\n                isGroup = true;\n                break;\n            }\n        }\n        if (!isGroup) {\n            plainOrderSpecs.push(orderSpec);\n        }\n    }\n    return {\n        superHeaderRendering: superHeaderRendering,\n        isVGrouping: isVGrouping,\n        groupSpecs: groupSpecs,\n        colSpecs: groupColSpecs.concat(plainColSpecs),\n        orderSpecs: plainOrderSpecs,\n    };\n}\n\nvar main = createPlugin({\n    deps: [\n        premiumCommonPlugin,\n        resourceCommonPlugin,\n        timelinePlugin,\n    ],\n    initialView: 'resourceTimelineDay',\n    views: {\n        resourceTimeline: {\n            type: 'timeline',\n            component: ResourceTimelineView,\n            needsResourceData: true,\n            resourceAreaWidth: '30%',\n            resourcesInitiallyExpanded: true,\n            eventResizableFromStart: true, // TODO: not DRY with this same setting in the main timeline config\n        },\n        resourceTimelineDay: {\n            type: 'resourceTimeline',\n            duration: { days: 1 },\n        },\n        resourceTimelineWeek: {\n            type: 'resourceTimeline',\n            duration: { weeks: 1 },\n        },\n        resourceTimelineMonth: {\n            type: 'resourceTimeline',\n            duration: { months: 1 },\n        },\n        resourceTimelineYear: {\n            type: 'resourceTimeline',\n            duration: { years: 1 },\n        },\n    },\n});\n\nexport default main;\nexport { ResourceTimelineLane, ResourceTimelineView, SpreadsheetRow };\n","import {\n  EmbeddedViewRef,\n  Injectable,\n  OnDestroy,\n  TemplateRef,\n  ViewContainerRef,\n} from '@angular/core';\nimport { debugLog } from 'core-app/shared/helpers/debug_output';\n\n/**\n * View lookup service for injecting angular templates\n * as fullcalendar event content.\n *\n * Based on the suggestion from Daniel Goldsmith\n * in https://github.com/fullcalendar/fullcalendar-angular/issues/204\n *\n */\n@Injectable()\nexport class EventViewLookupService implements OnDestroy {\n  /** Active templates currently rendered */\n  private readonly activeViews = new Map<string, EmbeddedViewRef<unknown>>();\n\n  /** Remember detached views to be destroyed on destroyAll */\n  private readonly detachedViews:EmbeddedViewRef<unknown>[] = [];\n\n  constructor(private viewContainerRef:ViewContainerRef) {\n  }\n\n  /**\n   * Gets the view for the given ID, or creates one if there isn't one\n   * already. The template's context is set (or updated to, if the\n   * view has already been created) the given context values.\n   * @param template The template ref (get this from a @ViewChild of an\n   * <ng-template>)\n   * @param id The unique ID for this instance of the view. Use this so that\n   * you don't keep around views for the same event.\n   * @param context The available variables for the <ng-template>. For\n   * example, if it looks like this: <ng-template let-localVar=\"value\"> then\n   * your context should be an object with a `value` key.\n   */\n  getView(\n    template:TemplateRef<unknown>, id:string, context:unknown,\n  ):EmbeddedViewRef<unknown> {\n    let view = this.activeViews.get(id);\n    if (view) {\n      debugLog('Returning active view %O', id);\n      view.detectChanges();\n      return view;\n    }\n\n    // Create a new view and move to active\n    debugLog('CREATING new view %O', id);\n    view = this.viewContainerRef.createEmbeddedView(template, context);\n    this.activeViews.set(id, view);\n    view.detectChanges();\n\n    return view;\n  }\n\n  ngOnDestroy():void {\n    this.destroyAll();\n  }\n\n  /**\n   * Call this method if all views need to be cleaned up. This will happen\n   * when your parent component is destroyed (e.g., in ngOnDestroy),\n   * but it may also be needed if you  are clearing just the area where the\n   * views have been placed.\n   */\n  public destroyAll():void {\n    debugLog('Destroying all views');\n\n    Array\n      .from(this.activeViews.values())\n      .forEach(this.destroyView.bind(this));\n\n    debugLog('Destroying %O active views', this.activeViews.size);\n    this.activeViews.clear();\n\n    this.destroyDetached();\n  }\n\n  /**\n   * Call this method if you want to clean detached views.\n   * This is safe to call outside of drag & drop operations.\n   *\n   */\n  public destroyDetached():void {\n    debugLog('Destroying %O detached views', this.detachedViews.length);\n\n    while (this.detachedViews.length) {\n      this.destroyView(this.detachedViews.pop() as EmbeddedViewRef<unknown>);\n    }\n  }\n\n  /**\n   * Mark a view to be destroyed.\n   * It will only be destroyed once +destroyAll+ is called.\n   *\n   * Ensure that destroyAll is called when, e.g., refreshing the calendar.\n   *\n   * @param id View ID\n   */\n  public markForDestruction(id:string):void {\n    const view = this.activeViews.get(id);\n    if (!view) {\n      return;\n    }\n\n    debugLog('Marking view %O to be destroyed', id);\n    this.activeViews.delete(id);\n    this.detachedViews.push(view);\n  }\n\n  private destroyView(view:EmbeddedViewRef<unknown>) {\n    const index = this.viewContainerRef.indexOf(view);\n    if (index !== -1) {\n      this.viewContainerRef.remove(index);\n    }\n\n    view.destroy();\n  }\n}\n","export const skeletonResources = [\n  {\n    id: 'skeleton-resource-1',\n    title: '',\n    href: 'skeleton-resource-1',\n  },\n  {\n    id: 'skeleton-resource-2',\n    title: '',\n    href: 'skeleton-resource-2',\n  },\n  {\n    id: 'skeleton-resource-3',\n    title: '',\n    href: 'skeleton-resource-3',\n  },\n];\n\nconst baseSkeleton = {\n  editable: false,\n  eventStartEditable: false,\n  eventDurationEditable: false,\n  allDay: true,\n  backgroundColor: '#FFFFFF',\n  borderColor: '#FFFFFF',\n  title: '',\n};\n\nexport const skeletonEvents = [\n  {\n    ...baseSkeleton,\n    id: 'skeleton-1',\n    resourceId: skeletonResources[0].id,\n    start: moment().subtract(1, 'days').toDate(),\n    end: moment().add(1, 'day').toDate(),\n    viewBox: '0 0 800 80',\n  },\n  {\n    ...baseSkeleton,\n    id: 'skeleton-2',\n    resourceId: skeletonResources[1].id,\n    start: moment().subtract(3, 'days').toDate(),\n    end: moment().toDate(),\n    viewBox: '0 0 1200 80',\n  },\n  {\n    ...baseSkeleton,\n    id: 'skeleton-3',\n    resourceId: skeletonResources[2].id,\n    start: moment().toDate(),\n    end: moment().add(3, 'days').toDate(),\n    viewBox: '0 0 1200 80',\n  },\n];\n","<spot-text-field\n  [ngModel]=\"searchString$ | async\"\n  (ngModelChange)=\"searchString$.next($event)\"\n  data-qa-selector=\"op-add-existing-pane--search-input\"\n  [placeholder]=\"text.placeholder\"\n>\n  <span\n    slot=\"before\"\n    class=\"spot-icon spot-icon_search\"\n  ></span>\n</spot-text-field>\n\n<ng-container\n  *ngIf=\"(isLoading$ | async) === false; else loadingTemplate\"\n>\n  <ng-container\n    *ngIf=\"(isEmpty$ | async) === false; else emptyTemplate\"\n  >\n    <div\n      #container\n      class=\"op-add-existing-pane--results\"\n    >\n      <ng-container *ngFor=\"let wp of currentWorkPackages$ | async\">\n        <wp-single-card\n          [workPackage]=\"wp\"\n          [selectedWhenOpen]=\"true\"\n          [showInfoButton]=\"true\"\n          [disabledInfo]=\"showDisabledText(wp)\"\n          [attr.data-drag-helper-id]=\"wp.id\"\n          class=\"op-add-existing-pane--wp\"\n          [attr.data-qa-selector]=\"'op-add-existing-pane--wp-' + wp.id\"\n          (stateLinkClicked)=\"openStateLink($event)\"\n          (cardClicked)=\"calendar.onCardClicked($event)\"\n        ></wp-single-card>\n      </ng-container>\n    </div>\n  </ng-container>\n\n  <ng-template #emptyTemplate>\n    <div\n      class=\"op-add-existing-pane--empty-state\"\n      data-qa-selector=\"op-add-existing-pane--empty-state\"\n    >\n      <img\n        *ngIf=\"(noResultsFound$ | async)?.showImage\"\n        [src]=\"image.empty_state\" class=\"op-add-existing-pane--empty-state-image\"/>\n      <span\n        [innerHTML]=\"(noResultsFound$ | async)?.text\"\n        class=\"op-add-existing-pane--empty-state-text\"\n      ></span>\n    </div>\n  </ng-template>\n</ng-container>\n\n<ng-template #loadingTemplate>\n  <op-content-loader\n    class=\"op-add-existing-pane--loading\"\n    viewBox=\"0 0 200 44\"\n  >\n    <svg:rect x=\"0\" y=\"0\" width=\"50%\" height=\"12\" rx=\"1\" />\n    <svg:rect x=\"0\" y=\"16\" width=\"100%\" height=\"12\" rx=\"1\" />\n    <svg:rect x=\"0\" y=\"32\" width=\"100%\" height=\"12\" rx=\"1\" />\n  </op-content-loader>\n</ng-template>\n","import {\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  HostBinding,\n  OnDestroy,\n  OnInit,\n  ViewChild,\n} from '@angular/core';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { imagePath } from 'core-app/shared/helpers/images/path-helper';\nimport {\n  BehaviorSubject,\n  combineLatest,\n  Observable,\n  of,\n} from 'rxjs';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { ApiV3FilterBuilder } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\nimport {\n  catchError,\n  debounceTime,\n  distinctUntilChanged,\n  map,\n  startWith,\n  switchMap,\n} from 'rxjs/operators';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { WorkPackageNotificationService } from 'core-app/features/work-packages/services/notifications/work-package-notification.service';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { UrlParamsHelperService } from 'core-app/features/work-packages/components/wp-query/url-params-helper';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { CalendarDragDropService } from 'core-app/features/team-planner/team-planner/calendar-drag-drop.service';\nimport { splitViewRoute } from 'core-app/features/work-packages/routing/split-view-routes.helper';\nimport { StateService } from '@uirouter/core';\nimport { ActionsService } from 'core-app/core/state/actions/actions.service';\nimport { teamPlannerEventRemoved } from 'core-app/features/team-planner/team-planner/planner/team-planner.actions';\nimport { WorkPackageViewFiltersService } from 'core-app/features/work-packages/routing/wp-view-base/view-services/wp-view-filters.service';\nimport { OpCalendarService } from 'core-app/features/calendar/op-calendar.service';\n\n@Component({\n  selector: 'op-add-existing-pane',\n  templateUrl: './add-existing-pane.component.html',\n  styleUrls: ['./add-existing-pane.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AddExistingPaneComponent extends UntilDestroyedMixin implements OnInit, OnDestroy {\n  @HostBinding('class.op-add-existing-pane') className = true;\n\n  @ViewChild('container') container:ElementRef;\n\n  @ViewChild('container')\n  set dragContainer(v:ElementRef|undefined) {\n    // ViewChild reference may be undefined initially\n    // due to ngIf\n    if (v !== undefined) {\n      this.calendarDrag.destroyDrake();\n      this.calendarDrag.registerDrag(v, '.op-add-existing-pane--wp');\n    }\n  }\n\n  /** Input for search requests */\n  public searchString$ = new BehaviorSubject<string>('');\n\n  isEmpty$ = new BehaviorSubject<boolean>(true);\n\n  isLoading$ = new BehaviorSubject<boolean>(false);\n\n  noResultsFound$ = this.isEmpty$\n    .pipe(\n      map((resultEmpty) => {\n        if (this.searchString$.getValue().length === 0) {\n          return { showImage: true, text: this.text.empty_state };\n        }\n\n        if (resultEmpty) {\n          return { showImage: false, text: this.text.no_results };\n        }\n\n        return {};\n      }),\n    );\n\n  currentWorkPackages$ = combineLatest([\n    this.calendarDrag.draggableWorkPackages$,\n    this.querySpace.results.values$(),\n  ])\n    .pipe(\n      map(([draggable, rendered]) => {\n        const renderedIds = rendered.elements.map((el) => el.id as string);\n        return draggable.filter((wp) => !renderedIds.includes(wp.id as string));\n      }),\n    );\n\n  workPackageRemoved$:Observable<unknown> = this\n    .actions$\n    .ofType(teamPlannerEventRemoved)\n    .pipe(\n      startWith(null),\n    );\n\n  text = {\n    empty_state: this.I18n.t('js.team_planner.quick_add.empty_state'),\n    placeholder: this.I18n.t('js.team_planner.quick_add.search_placeholder'),\n    no_results: this.I18n.t('js.autocompleter.notFoundText'),\n  };\n\n  image = {\n    empty_state: imagePath('team-planner/add-existing-pane--empty-state.gif'),\n  };\n\n  constructor(\n    private readonly querySpace:IsolatedQuerySpace,\n    private I18n:I18nService,\n    private readonly apiV3Service:ApiV3Service,\n    private readonly notificationService:WorkPackageNotificationService,\n    private readonly currentProject:CurrentProjectService,\n    private readonly urlParamsHelper:UrlParamsHelperService,\n    private readonly calendar:OpCalendarService,\n    private readonly calendarDrag:CalendarDragDropService,\n    private readonly $state:StateService,\n    private readonly actions$:ActionsService,\n    private readonly wpFilters:WorkPackageViewFiltersService,\n  ) {\n    super();\n  }\n\n  ngOnInit():void {\n    combineLatest([\n      this\n        .searchString$\n        .pipe(\n          distinctUntilChanged(),\n          debounceTime(500),\n        ),\n      this\n        .wpFilters\n        .updates$()\n        .pipe(\n          startWith(null),\n        ),\n      this.workPackageRemoved$,\n    ])\n      .pipe(\n        this.untilDestroyed(),\n        map(([searchString]) => searchString),\n        switchMap((searchString:string) => this.searchWorkPackages(searchString)),\n      )\n      .subscribe((results) => {\n        this.calendarDrag.draggableWorkPackages$.next(results);\n\n        this.isEmpty$.next(results.length === 0);\n        this.isLoading$.next(false);\n      });\n  }\n\n  ngOnDestroy():void {\n    super.ngOnDestroy();\n    this.calendarDrag.destroyDrake();\n  }\n\n  searchWorkPackages(searchString:string):Observable<WorkPackageResource[]> {\n    this.isLoading$.next(true);\n\n    // Return when the search string is empty\n    if (searchString.length === 0) {\n      this.isLoading$.next(false);\n      this.isEmpty$.next(true);\n\n      return of([]);\n    }\n\n    // Add any visible global filters\n    const activeFilters = this.wpFilters.currentlyVisibleFilters;\n    const filters:ApiV3FilterBuilder = this.urlParamsHelper.filterBuilderFrom(activeFilters);\n\n    filters.add('typeahead', '**', [searchString]);\n\n    // Add the existing filter, if any\n    this.addExistingFilters(filters);\n\n    return this\n      .apiV3Service\n      .withOptionalProject(this.currentProject.id)\n      .work_packages\n      .filtered(filters, { pageSize: '-1' })\n      .get()\n      .pipe(\n        map((collection) => collection.elements),\n        catchError((error:unknown) => {\n          this.notificationService.handleRawError(error);\n          return of([]);\n        }),\n        this.untilDestroyed(),\n      );\n  }\n\n  clearInput():void {\n    this.searchString$.next('');\n  }\n\n  get isSearching():boolean {\n    return this.searchString$.value !== '';\n  }\n\n  showDisabledText(wp:WorkPackageResource):{ text:string, orientation:'left'|'right' } {\n    return {\n      text: this.calendarDrag.workPackageDisabledExplanation(wp),\n      orientation: 'left',\n    };\n  }\n\n  openStateLink(event:{ workPackageId:string; requestedState:string }):void {\n    void this.$state.go(\n      `${splitViewRoute(this.$state)}.tabs`,\n      { workPackageId: event.workPackageId, tabIdentifier: 'overview' },\n    );\n  }\n\n  private addExistingFilters(filters:ApiV3FilterBuilder) {\n    const query = this.querySpace.query.value;\n    if (query?.filters) {\n      const currentFilters = this.urlParamsHelper.buildV3GetFilters(query.filters);\n\n      currentFilters.forEach((filter) => {\n        Object.keys(filter).forEach((name) => {\n          if (name !== 'assignee' && name !== 'datesInterval') {\n            filters.add(name, filter[name].operator, filter[name].values);\n          }\n        });\n      });\n    }\n  }\n}\n","import {\n  ChangeDetectionStrategy,\n  Component,\n} from '@angular/core';\n\n@Component({\n  selector: 'op-principal-loading-skeleton',\n  templateUrl: './op-principal-loading-skeleton.component.html',\n  styleUrls: ['./op-principal-loading-skeleton.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class OpPrincipalLoadingComponent {\n\n}\n","<div class=\"op-principal-loading-skeleton\">\n  <op-content-loader\n    viewBox=\"0 0 180 80\"\n  >\n    <svg:rect height=\"30%\" rx=\"4\" ry=\"4\" width=\"117\" x=\"75\" y=\"30\"/>\n    <svg:circle cx=\"35\" cy=\"42\" r=\"35\"></circle>\n  </op-content-loader>\n</div>","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport {\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  EventEmitter,\n  Injector,\n  Input,\n  Output,\n} from '@angular/core';\nimport { HalResourceService } from 'core-app/features/hal/services/hal-resource.service';\nimport { PathHelperService } from 'core-app/core/path-helper/path-helper.service';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { Observable } from 'rxjs';\nimport { map } from 'rxjs/operators';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { HalResourceNotificationService } from 'core-app/features/hal/services/hal-resource-notification.service';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\nimport { ApiV3FilterBuilder } from 'core-app/shared/helpers/api-v3/api-v3-filter-builder';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { WorkPackageViewFiltersService } from 'core-app/features/work-packages/routing/wp-view-base/view-services/wp-view-filters.service';\n\n@Component({\n  templateUrl: './add-assignee.component.html',\n  selector: 'op-tp-add-assignee',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n})\nexport class AddAssigneeComponent {\n  @Output() public selectAssignee = new EventEmitter<HalResource>();\n\n  @Input() alreadySelected:string[] = [];\n\n  public getOptionsFn = (query:string):Observable<unknown[]> => this.autocomplete(query);\n\n  constructor(\n    protected elementRef:ElementRef,\n    protected halResourceService:HalResourceService,\n    protected I18n:I18nService,\n    protected halNotification:HalResourceNotificationService,\n    readonly pathHelper:PathHelperService,\n    readonly apiV3Service:ApiV3Service,\n    readonly injector:Injector,\n    readonly currentProjectService:CurrentProjectService,\n    readonly wpTableFilters:WorkPackageViewFiltersService,\n  ) { }\n\n  public autocomplete(term:string|null):Observable<HalResource[]> {\n    const filters = new ApiV3FilterBuilder();\n\n    const currentProjectId = this.currentProjectService.id;\n    filters.add('member', '=', [currentProjectId] as string[]);\n\n    if (term) {\n      filters.add('typeahead', '**', [term]);\n    }\n\n    return this\n      .apiV3Service\n      .principals\n      .filtered(filters)\n      .get()\n      .pipe(\n        map((collection) => collection.elements.filter(\n          (user) => !this.alreadySelected.find((selected) => selected === user.id),\n        )),\n      );\n  }\n\n  public selectUser(user:HalResource):void {\n    this.selectAssignee.emit(user);\n  }\n}\n","<op-autocompleter\n  data-qa-selector=\"tp-add-assignee\"\n  (change)=\"selectUser($event)\"\n  [fetchDataDirectly]=\"true\"\n  [getOptionsFn]=\"getOptionsFn\"\n  resource=\"user\"\n  appendTo=\"body\"\n></op-autocompleter>\n","import {\n  ChangeDetectionStrategy,\n  Component,\n  Input,\n} from '@angular/core';\n\n@Component({\n  selector: 'op-wp-loading-skeleton',\n  templateUrl: './op-wp-loading-skeleton.component.html',\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  styleUrls: ['./op-wp-loading-skeleton.component.sass'],\n})\nexport class OpWPLoadingComponent {\n  @Input() public viewBox?:string = '0 0 800 80';\n}\n","<div class=\"op-wp-loading-skeleton\">\n  <op-content-loader\n    [viewBox]=\"viewBox\"\n  >\n    <svg:rect x=\"0\" y=\"0\" rx=\"3\" ry=\"3\" width=\"20%\" height=\"35%\"/>\n    <svg:rect x=\"0\" y=\"40%\" rx=\"3\" ry=\"3\" width=\"100%\" height=\"35%\"/>\n  </op-content-loader>\n</div>","<div\n  class=\"op-team-planner\"\n  [ngClass]=\"{'op-team-planner_with_left_side_pane' : (showAddExistingPane | async)}\"\n>\n  <ng-container\n    *ngIf=\"(calendarOptions$ | async) as calendarOptions\"\n  >\n    <button\n      #addExistingToggle\n      class=\"button op-team-planner--add-existing-toggle\"\n      [ngClass]=\"{'-active': (showAddExistingPane | async)}\"\n      data-qa-selector=\"op-team-planner--add-existing-toggle\"\n      (click)=\"toggleAddExistingPane()\">\n      <op-icon icon-classes=\"icon-add button--icon\"></op-icon>\n      <span\n        class=\"button--text\"\n        [textContent]=\"text.add_existing\">\n      </span>\n    </button>\n\n    <op-add-existing-pane\n      *ngIf=\"(showAddExistingPane | async)\"\n      class=\"op-team-planner--add-existing-pane\"\n      data-qa-selector=\"add-existing-pane\"\n    >\n    </op-add-existing-pane>\n  </ng-container>\n\n  <div\n    class=\"op-team-planner--calendar-pane\"\n    data-qa-selector=\"op-team-planner--calendar-pane\"\n  >\n    <ng-container\n      *ngIf=\"(calendarOptions$ | async) as calendarOptions\"\n    >\n\n      <full-calendar\n        #ucCalendar\n        *ngIf=\"calendarOptions\"\n        [options]=\"calendarOptions\"\n        class=\"op-team-planner--calendar fc-scroller\"\n        [ngClass]=\"{'op-team-planner--calendar_empty': (isEmpty$ | async)}\"\n      ></full-calendar>\n\n      <div\n        [textContent]=\"calendar.tooManyResultsText\"\n        class=\"op-wp-calendar--notification\">\n      </div>\n\n      <div\n        *ngIf=\"isEmpty$ | async\"\n        class=\"op-team-planner--no-data\">\n        <img [src]=\"image.empty_state\" class=\"op-team-planner--empty-state-image\" />\n        <span [textContent]=\"text.noData\"></span>\n        <button\n          type=\"button\"\n          class=\"op-team-planner--empty-state-button button -highlight\"\n          data-qa-selector=\"op-team-planner--empty-state-button\"\n          (click)=\"showAssigneeAddRow()\"\n          [textContent]=\"text.add_assignee\"\n        >\n        </button>\n      </div>\n    </ng-container>\n\n    <ng-template #resourceContent let-resource=\"resource\">\n      <div\n        *ngIf=\"resource && resource.extendedProps.principal\"\n        class=\"tp-assignee\"\n      >\n        <op-principal\n          [principal]=\"resource.extendedProps.principal\"\n          class=\"tp-assignee--principal op-principal_wrapped\"\n        ></op-principal>\n        <button\n          type=\"button\"\n          class=\"tp-assignee--remove\"\n          (click)=\"removeAssignee(resource.id)\"\n          [attr.aria-label]=\"text.remove_assignee\"\n          [attr.data-qa-remove-assignee]=\"resource.extendedProps.principal.id\"\n        >\n          <op-icon icon-classes=\"icon-remove\"></op-icon>\n        </button>\n      </div>\n\n      <op-principal-loading-skeleton\n        *ngIf=\"resource && !resource.extendedProps.principal && resource.id.startsWith('skeleton')\"\n      ></op-principal-loading-skeleton>\n\n      <op-tp-add-assignee\n        *ngIf=\"resource && !resource.extendedProps.principal && !resource.id.startsWith('skeleton')\"\n        (selectAssignee)=\"addAssignee($event)\"\n        [alreadySelected]=\"principalIds$ | async\"\n      ></op-tp-add-assignee>\n    </ng-template>\n\n    <ng-template #eventContent let-event=\"event\">\n\n      <op-wp-loading-skeleton\n        [viewBox]=\"event.extendedProps.viewBox\"\n        class=\"op-team-planner--wp-loading-skeleton\"\n        *ngIf=\"event.source && event.source.id === 'skeleton'\"\n      ></op-wp-loading-skeleton>\n\n      <wp-single-card\n        *ngIf=\"(!event.source || event.source.id === 'work_packages') && event.extendedProps.workPackage as wp\"\n        [workPackage]=\"wp\"\n        [selectedWhenOpen]=\"true\"\n        [orientation]=\"'horizontal'\"\n        [highlightingMode]=\"'type'\"\n        [showInfoButton]=\"true\"\n        [disabledInfo]=\"showDisabledText(wp)\"\n        [isClosed]=\"isStatusClosed(wp)\"\n        [showAsGhost]=\"shouldShowAsGhost(wp.id, (globalDraggingItem$ | async))\"\n        [showAsInlineCard]=\"true\"\n        [showStartDate]=\"!isWpStartDateInCurrentView(wp)\"\n        [showEndDate]=\"!isWpEndDateInCurrentView(wp)\"\n        (stateLinkClicked)=\"openStateLink($event)\"\n        (cardClicked)=\"calendar.onCardClicked($event)\"\n        (cardContextMenu)=\"calendar.showEventContextMenu($event)\"\n      ></wp-single-card>\n    </ng-template>\n\n    <div class=\"op-team-planner--footer\" data-qa-selector=\"op-team-planner-footer\">\n      <div\n        class=\"op-team-planner--add-assignee\"\n        *ngIf=\"!(showAddAssignee$ | async) && !(dropzone$ | async)?.dragging\"\n      >\n        <button\n          type=\"button\"\n          class=\"spot-link\"\n          (click)=\"showAssigneeAddRow()\"\n          data-qa-selector=\"tp-assignee-add-button\"\n        >\n          <span class=\"spot-icon spot-icon_user-plus\"></span>\n          <span [textContent]=\"text.add_assignee\"></span>\n        </button>\n      </div>\n      <ng-container *ngIf=\"(dropzone$ | async) as dropzone\">\n        <div\n          *ngIf=\"dropzone.dragging\"\n          #removeDropzone\n          (mouseenter)=\"dropzoneHovered$.next(true)\"\n          (mouseleave)=\"dropzoneHovered$.next(false)\"\n          (mouseup)=\"dropzone.canDrop && removeEvent(dropzone.dragging)\"\n          class=\"op-team-planner--remove-dropzone\"\n          data-qa-selector=\"op-team-planner-dropzone\"\n          [class.op-team-planner--remove-dropzone_active]=\"dropzone.isHovering && dropzone.canDrop\"\n          [class.op-team-planner--remove-dropzone_forbidden]=\"!dropzone.canDrop\"\n        >\n          <span\n            *ngIf=\"dropzone.canDrop\"\n            class=\"op-team-planner--dropzone-label\"\n            [textContent]=\"text.drag_here_to_remove\"\n          ></span>\n          <span\n            *ngIf=\"!dropzone.canDrop\"\n            class=\"op-team-planner--dropzone-label\"\n            [textContent]=\"text.cannot_drag_here\"\n          ></span>\n        </div>\n      </ng-container>\n    </div>\n  </div>\n","import {\n  ChangeDetectionStrategy,\n  Component,\n  ElementRef,\n  HostListener,\n  Injector,\n  OnDestroy,\n  OnInit,\n  TemplateRef,\n  ViewChild,\n} from '@angular/core';\nimport {\n  CalendarOptions,\n  DateSelectArg,\n  EventApi,\n  EventContentArg,\n  EventDropArg,\n  EventInput,\n} from '@fullcalendar/core';\nimport {\n  BehaviorSubject,\n  combineLatest,\n  Subject,\n} from 'rxjs';\nimport {\n  debounceTime,\n  distinctUntilChanged,\n  filter,\n  finalize,\n  map,\n  mergeMap,\n  shareReplay,\n  startWith,\n  switchMap,\n  take,\n  withLatestFrom,\n} from 'rxjs/operators';\nimport { StateService } from '@uirouter/angular';\nimport resourceTimelinePlugin from '@fullcalendar/resource-timeline';\nimport interactionPlugin, {\n  EventDragStartArg,\n  EventDragStopArg,\n  EventReceiveArg,\n  EventResizeDoneArg,\n} from '@fullcalendar/interaction';\nimport { FullCalendarComponent } from '@fullcalendar/angular';\nimport { I18nService } from 'core-app/core/i18n/i18n.service';\nimport { ConfigurationService } from 'core-app/core/config/configuration.service';\nimport { EventViewLookupService } from 'core-app/features/team-planner/team-planner/planner/event-view-lookup.service';\nimport { WorkPackageViewFiltersService } from 'core-app/features/work-packages/routing/wp-view-base/view-services/wp-view-filters.service';\nimport { IsolatedQuerySpace } from 'core-app/features/work-packages/directives/query-space/isolated-query-space';\nimport { CurrentProjectService } from 'core-app/core/current-project/current-project.service';\nimport { splitViewRoute } from 'core-app/features/work-packages/routing/split-view-routes.helper';\nimport { QueryFilterInstanceResource } from 'core-app/features/hal/resources/query-filter-instance-resource';\nimport { PrincipalsResourceService } from 'core-app/core/state/principals/principals.service';\nimport {\n  ApiV3ListFilter,\n  ApiV3ListParameters,\n} from 'core-app/core/apiv3/paths/apiv3-list-resource.interface';\nimport { WorkPackageResource } from 'core-app/features/hal/resources/work-package-resource';\nimport { HalResource } from 'core-app/features/hal/resources/hal-resource';\nimport { UntilDestroyedMixin } from 'core-app/shared/helpers/angular/until-destroyed.mixin';\nimport { ResourceLabelContentArg } from '@fullcalendar/resource-common';\nimport { OpCalendarService } from 'core-app/features/calendar/op-calendar.service';\nimport { HalResourceEditingService } from 'core-app/shared/components/fields/edit/services/hal-resource-editing.service';\nimport { HalResourceNotificationService } from 'core-app/features/hal/services/hal-resource-notification.service';\nimport { SchemaCacheService } from 'core-app/core/schemas/schema-cache.service';\nimport { ApiV3Service } from 'core-app/core/apiv3/api-v3.service';\nimport { CalendarDragDropService } from 'core-app/features/team-planner/team-planner/calendar-drag-drop.service';\nimport { StatusResource } from 'core-app/features/hal/resources/status-resource';\nimport { ResourceChangeset } from 'core-app/shared/components/fields/changeset/resource-changeset';\nimport { KeepTabService } from 'core-app/features/work-packages/components/wp-single-view-tabs/keep-tab/keep-tab.service';\nimport { HalError } from 'core-app/features/hal/services/hal-error';\nimport { ActionsService } from 'core-app/core/state/actions/actions.service';\nimport {\n  teamPlannerEventAdded,\n  teamPlannerEventRemoved,\n} from 'core-app/features/team-planner/team-planner/planner/team-planner.actions';\nimport { imagePath } from 'core-app/shared/helpers/images/path-helper';\nimport {\n  skeletonEvents,\n  skeletonResources,\n} from './loading-skeleton-data';\nimport { CapabilitiesResourceService } from 'core-app/core/state/capabilities/capabilities.service';\nimport { ICapability } from 'core-app/core/state/capabilities/capability.model';\nimport { ToastService } from 'core-app/shared/components/toaster/toast.service';\nimport { LoadingIndicatorService } from 'core-app/core/loading-indicator/loading-indicator.service';\n\n@Component({\n  selector: 'op-team-planner',\n  templateUrl: './team-planner.component.html',\n  styleUrls: ['./team-planner.component.sass'],\n  changeDetection: ChangeDetectionStrategy.OnPush,\n  providers: [\n    EventViewLookupService,\n  ],\n})\nexport class TeamPlannerComponent extends UntilDestroyedMixin implements OnInit, OnDestroy {\n  @ViewChild(FullCalendarComponent) ucCalendar:FullCalendarComponent;\n\n  @ViewChild('ucCalendar', { read: ElementRef })\n  set ucCalendarElement(v:ElementRef|undefined) {\n    this.calendar.resizeObserver(v);\n  }\n\n  @ViewChild('eventContent') eventContent:TemplateRef<unknown>;\n\n  @ViewChild('resourceContent') resourceContent:TemplateRef<unknown>;\n\n  @ViewChild('assigneeAutocompleter') assigneeAutocompleter:TemplateRef<unknown>;\n\n  @ViewChild('removeDropzone', { read: ElementRef }) removeDropzone:ElementRef;\n\n  @ViewChild('addExistingToggle', { read: ElementRef }) addExistingToggle:ElementRef;\n\n  calendarOptions$ = new Subject<CalendarOptions>();\n\n  draggingItem$ = new BehaviorSubject<EventDragStartArg|undefined>(undefined);\n\n  globalDraggingItem$ = combineLatest([\n    this.draggingItem$,\n    this.calendarDrag.isDragging$,\n  ]).pipe(\n    map(([draggingItem, externalDrag]) => {\n      if (externalDrag !== undefined) {\n        return externalDrag;\n      }\n\n      if (draggingItem !== undefined) {\n        return (draggingItem.event.extendedProps.workPackage as WorkPackageResource).id as string;\n      }\n\n      return undefined;\n    }),\n  );\n\n  dropzoneHovered$ = new BehaviorSubject<boolean>(false);\n\n  dropzoneAllowed$ = this\n    .draggingItem$\n    .pipe(\n      filter((dragging) => !!dragging),\n      map((dragging) => {\n        const workPackage = (dragging as EventDragStartArg).event.extendedProps.workPackage as WorkPackageResource;\n        const dateEditable = this.calendar.dateEditable(workPackage);\n        const resourceEditable = this.eventResourceEditable(workPackage);\n        return dateEditable && resourceEditable;\n      }),\n    );\n\n  dropzone$ = combineLatest([\n    this.draggingItem$,\n    this.dropzoneHovered$,\n    this.dropzoneAllowed$,\n  ])\n    .pipe(\n      map(([dragging, isHovering, canDrop]) => ({ dragging, isHovering, canDrop })),\n    );\n\n  projectIdentifier:string|undefined = undefined;\n\n  showAddExistingPane = new BehaviorSubject<boolean>(false);\n\n  showAddAssignee$ = new BehaviorSubject<boolean>(false);\n\n  private principalIds$ = this.wpTableFilters\n    .live$()\n    .pipe(\n      this.untilDestroyed(),\n      map((queryFilters) => {\n        const assigneeFilter = queryFilters.find((queryFilter) => queryFilter.id === 'assignee');\n        return ((assigneeFilter?.values || []) as HalResource[]).map((p) => p.id);\n      }),\n    );\n\n  private assigneeCaps$ = this.wpTableFilters\n    .live$()\n    .pipe(\n      this.untilDestroyed(),\n      switchMap((queryFilters) => {\n        const filters:ApiV3ListFilter[] = [\n          ['action', '=', ['work_packages/assigned']],\n        ];\n        const assigneeFilter = queryFilters.find((queryFilter) => queryFilter.id === 'assignee');\n        if (assigneeFilter) {\n          const values = (assigneeFilter.values as HalResource[]).map((el:HalResource) => el.id as string);\n          filters.push(['principal', '=', values]);\n        }\n\n        const projectFilter = queryFilters.find((queryFilter) => queryFilter.id === 'project');\n        if (projectFilter) {\n          const values = (projectFilter.values as HalResource[]).map((el:HalResource) => `p${el.id as string}`);\n          filters.push(['context', '=', values]);\n        } else {\n          filters.push(['context', '=', [`p${this.currentProject.id as string}`]]);\n        }\n\n        return this\n          .capabilitiesResourceService\n          .fetchCapabilities({ pageSize: -1, filters });\n      }),\n      map((result) => result\n        ._embedded\n        .elements\n        .reduce(\n          (list:{ [projectId:string]:string[] }, cap:ICapability) => {\n            const project = cap._links.context.href;\n            const principal = cap._links.principal.href;\n            const cur = list[project] || [];\n            return {\n              ...list,\n              [project]: [...cur, principal],\n            };\n          },\n          {},\n        )),\n      startWith({} as { [projectId:string]:string[] }),\n      shareReplay(1),\n    );\n\n  private params$ = this.principalIds$\n    .pipe(\n      this.untilDestroyed(),\n      filter((ids) => ids.length > 0),\n      map((ids) => ({\n        filters: [['id', '=', ids]],\n      }) as ApiV3ListParameters),\n    );\n\n  isEmpty$ = combineLatest([\n    this.principalIds$,\n    this.showAddAssignee$,\n  ]).pipe(\n    debounceTime(250),\n    map(([principals, showAddAssignee]) => {\n      this.loadingIndicatorService.table.stop();\n      return !principals.length && !showAddAssignee;\n    }),\n  );\n\n  private loading$:Subject<unknown>|null = null;\n\n  assignees:HalResource[] = [];\n\n  statuses:StatusResource[] = [];\n\n  image = {\n    empty_state: imagePath('team-planner/empty-state.svg'),\n  };\n\n  text = {\n    add_existing: this.I18n.t('js.team_planner.add_existing'),\n    assignee: this.I18n.t('js.label_assignee'),\n    add_assignee: this.I18n.t('js.team_planner.add_assignee'),\n    remove_assignee: this.I18n.t('js.team_planner.remove_assignee'),\n    noData: this.I18n.t('js.team_planner.no_data'),\n    two_weeks: this.I18n.t('js.team_planner.two_weeks'),\n    one_week: this.I18n.t('js.team_planner.one_week'),\n    today: this.I18n.t('js.team_planner.today'),\n    drag_here_to_remove: this.I18n.t('js.team_planner.drag_here_to_remove'),\n    cannot_drag_here: this.I18n.t('js.team_planner.cannot_drag_here'),\n    updating: this.I18n.t('js.ajax.updating'),\n    successful_update: this.I18n.t('js.notice_successful_update'),\n  };\n\n  principals$ = this.principalIds$\n    .pipe(\n      this.untilDestroyed(),\n      mergeMap((ids:string[]) => this.principalsResourceService.query.byIds(ids)),\n      debounceTime(50),\n      distinctUntilChanged((prev, curr) => prev.length === curr.length && prev.length === 0),\n      shareReplay(1),\n    );\n\n  constructor(\n    private $state:StateService,\n    private configuration:ConfigurationService,\n    private principalsResourceService:PrincipalsResourceService,\n    private capabilitiesResourceService:CapabilitiesResourceService,\n    private wpTableFilters:WorkPackageViewFiltersService,\n    private querySpace:IsolatedQuerySpace,\n    private currentProject:CurrentProjectService,\n    private viewLookup:EventViewLookupService,\n    private I18n:I18nService,\n    readonly injector:Injector,\n    readonly calendar:OpCalendarService,\n    readonly halEditing:HalResourceEditingService,\n    readonly halNotification:HalResourceNotificationService,\n    readonly schemaCache:SchemaCacheService,\n    readonly apiV3Service:ApiV3Service,\n    readonly calendarDrag:CalendarDragDropService,\n    readonly keepTab:KeepTabService,\n    readonly actions$:ActionsService,\n    readonly toastService:ToastService,\n    readonly loadingIndicatorService:LoadingIndicatorService,\n  ) {\n    super();\n  }\n\n  ngOnInit():void {\n    this.initializeCalendar();\n    this.projectIdentifier = this.currentProject.identifier || undefined;\n\n    this\n      .querySpace\n      .results\n      .values$()\n      .pipe(this.untilDestroyed())\n      .subscribe(() => {\n        this.ucCalendar.getApi().refetchEvents();\n      });\n\n    this.calendar.resize$\n      .pipe(\n        this.untilDestroyed(),\n        debounceTime(50),\n      )\n      .subscribe(() => {\n        this.ucCalendar.getApi().updateSize();\n      });\n\n    this.params$\n      .pipe(this.untilDestroyed())\n      .subscribe((params) => {\n        this.principalsResourceService.fetchPrincipals(params).subscribe();\n      });\n\n    combineLatest([\n      this.principals$,\n      this.showAddAssignee$,\n    ])\n      .pipe(\n        this.untilDestroyed(),\n        debounceTime(0),\n      )\n      .subscribe(([principals, showAddAssignee]) => {\n        const api = this.ucCalendar.getApi();\n\n        // This also removes the skeleton resources that are rendered initially\n        api.getResources().forEach((resource) => resource.remove());\n\n        principals.forEach((principal) => {\n          const id = principal._links.self.href;\n          api.addResource({\n            principal,\n            id,\n            title: principal.name,\n          });\n        });\n\n        if (showAddAssignee) {\n          api.addResource({\n            principal: null,\n            id: 'NEW',\n            title: '',\n          });\n        }\n      });\n\n    // This needs to be done after all the subscribers are set up\n    this.showAddAssignee$.next(false);\n\n    this\n      .apiV3Service\n      .statuses\n      .get()\n      .pipe(\n        take(1),\n      )\n      .subscribe((collection) => {\n        this.statuses = collection.elements;\n      });\n  }\n\n  ngOnDestroy():void {\n    super.ngOnDestroy();\n    this.calendar.resizeObs?.disconnect();\n  }\n\n  private initializeCalendar() {\n    void this.configuration.initialized\n      .then(() => {\n        this.calendarOptions$.next(\n          this.calendar.calendarOptions({\n            schedulerLicenseKey: 'GPL-My-Project-Is-Open-Source',\n            selectable: true,\n            plugins: [resourceTimelinePlugin, interactionPlugin],\n            titleFormat: { year: 'numeric', month: 'long', day: 'numeric' },\n            buttonText: { today: this.text.today },\n            initialView: this.calendar.initialView || 'resourceTimelineWeek',\n            headerToolbar: {\n              left: '',\n              center: 'title',\n              right: 'prev,next today resourceTimelineWeek,resourceTimelineTwoWeeks',\n            },\n            views: {\n              resourceTimelineWeek: {\n                type: 'resourceTimeline',\n                buttonText: this.text.one_week,\n                duration: { weeks: 1 },\n                slotDuration: { days: 1 },\n                slotLabelFormat: [\n                  { weekday: 'long', day: '2-digit' },\n                ],\n                resourceAreaColumns: [\n                  {\n                    field: 'title',\n                    headerContent: {\n                      html: `<span class=\"spot-icon spot-icon_user\"></span> <span>${this.text.assignee}</span>`,\n                    },\n                  },\n                ],\n              },\n              resourceTimelineTwoWeeks: {\n                type: 'resourceTimeline',\n                buttonText: this.text.two_weeks,\n                slotDuration: { days: 1 },\n                duration: { weeks: 2 },\n                dateIncrement: { weeks: 1 },\n                slotLabelFormat: [\n                  { weekday: 'short', day: '2-digit' },\n                ],\n                resourceAreaColumns: [\n                  {\n                    field: 'title',\n                    headerContent: {\n                      html: `<span class=\"spot-icon spot-icon_user\"></span> <span>${this.text.assignee}</span>`,\n                    },\n                  },\n                ],\n              },\n            },\n            // Ensure we show the skeleton from the beginning\n            progressiveEventRendering: true,\n            eventSources: [\n              {\n                id: 'skeleton',\n                events: skeletonEvents,\n                editable: false,\n              },\n              {\n                id: 'work_packages',\n                events: this.calendarEventsFunction.bind(this) as unknown,\n              },\n              {\n                events: [],\n                id: 'background',\n                color: 'red',\n                textColor: 'white',\n                display: 'background',\n                editable: false,\n              },\n            ],\n            resources: skeletonResources,\n            resourceAreaWidth: '180px',\n            select: this.handleDateClicked.bind(this) as unknown,\n            resourceLabelContent: (data:ResourceLabelContentArg) => this.renderTemplate(this.resourceContent, data.resource.id, data),\n            resourceLabelWillUnmount: (data:ResourceLabelContentArg) => this.unrenderTemplate(data.resource.id),\n            // DnD configuration\n            editable: true,\n            droppable: true,\n            eventResize: (resizeInfo:EventResizeDoneArg) => this.updateEvent(resizeInfo),\n            eventDragStart: (dragInfo:EventDragStartArg) => {\n              if (dragInfo.event.source?.id === 'skeleton') {\n                return;\n              }\n\n              const { el } = dragInfo;\n              el.style.pointerEvents = 'none';\n              this.draggingItem$.next(dragInfo);\n              this.addBackgroundEvents(dragInfo.event);\n            },\n            eventDragStop: (dragInfo:EventDragStopArg) => {\n              const { el } = dragInfo;\n              el.style.removeProperty('pointer-events');\n              this.draggingItem$.next(undefined);\n              this.removeBackGroundEvents();\n            },\n            eventDrop: (dropInfo:EventDropArg) => this.updateEvent(dropInfo),\n            eventReceive: async (dropInfo:EventReceiveArg) => {\n              await this.updateEvent(dropInfo);\n              const wp = dropInfo.event.extendedProps.workPackage as WorkPackageResource;\n              this.actions$.dispatch(teamPlannerEventAdded({ workPackage: wp.id as string }));\n            },\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n            eventContent: (data:EventContentArg):{ domNodes:unknown[] }|undefined => {\n              // Let FC handle the background events\n              if (data.event.source?.id === 'background') {\n                return undefined;\n              }\n\n              return this.renderTemplate(this.eventContent, this.eventId(data), data);\n            },\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n            eventWillUnmount: (data:EventContentArg) => {\n              // Nothing to do for background events\n              if (data.event.source?.id === 'background') {\n                return;\n              }\n\n              this.unrenderTemplate(this.eventId(data));\n            },\n          } as CalendarOptions),\n        );\n      });\n  }\n\n  public calendarEventsFunction(\n    fetchInfo:{ start:Date, end:Date, timeZone:string },\n    successCallback:(events:EventInput[]) => void,\n    failureCallback:(error:unknown) => void,\n  ):void|PromiseLike<EventInput[]> {\n    this\n      .calendar\n      .currentWorkPackages$\n      .pipe(\n        withLatestFrom(this.assigneeCaps$),\n        take(1),\n        finalize(() => this.clearLoading()),\n      )\n      .subscribe(\n        ([workPackages, projectAssignables]) => {\n          const events = this.mapToCalendarEvents(workPackages.elements, projectAssignables);\n\n          this.viewLookup.destroyDetached();\n\n          this.removeExternalEvents();\n\n          successCallback(events);\n        },\n        failureCallback,\n      );\n\n    void this.calendar.updateTimeframe(fetchInfo, this.projectIdentifier);\n  }\n\n  /**\n   * Clear loading and show successful toast if we were reloading the page\n   * @private\n   */\n  private clearLoading():void {\n    const prevLoading = this.loading$;\n    if (!prevLoading) {\n      return;\n    }\n\n    this.loading$ = null;\n    setTimeout(() => {\n      prevLoading.complete();\n      this.toastService.addSuccess(this.text.successful_update);\n    }, 500);\n  }\n\n  renderTemplate(template:TemplateRef<unknown>, id:string, data:ResourceLabelContentArg|EventContentArg):{ domNodes:unknown[] } {\n    if (this.isDraggedEvent(id)) {\n      this.viewLookup.markForDestruction(id);\n    }\n\n    const ref = this.viewLookup.getView(template, id, data);\n    return { domNodes: ref.rootNodes };\n  }\n\n  unrenderTemplate(id:string):void {\n    this.viewLookup.markForDestruction(id);\n  }\n\n  isDraggedEvent(id:string):boolean {\n    const dragging = this.draggingItem$.getValue();\n    return !!dragging && (dragging.event.extendedProps?.workPackage as undefined|WorkPackageResource)?.href === id;\n  }\n\n  eventId(data:EventContentArg):string {\n    return [\n      data.event.id,\n      data.event.start?.toISOString(),\n      data.event.end?.toISOString(),\n      data.timeText,\n      `dragging=${data.isDragging.toString()}`,\n      `resizing=${data.isResizing.toString()}`,\n    ].join('-');\n  }\n\n  public showAssigneeAddRow():void {\n    this.showAddAssignee$.next(true);\n    this.ucCalendar.getApi().refetchEvents();\n  }\n\n  public addAssignee(principal:HalResource):void {\n    this.showAddAssignee$.next(false);\n\n    const modifyFilter = (assigneeFilter:QueryFilterInstanceResource) => {\n      // eslint-disable-next-line no-param-reassign\n      assigneeFilter.values = [\n        ...assigneeFilter.values as HalResource[],\n        principal,\n      ];\n    };\n\n    if (this.wpTableFilters.findIndex('assignee') === -1) {\n      // Replace actually also instantiates if it does not exist, which is handy here\n      this.wpTableFilters.replace('assignee', modifyFilter.bind(this));\n    } else {\n      this.wpTableFilters.modify('assignee', modifyFilter.bind(this));\n    }\n  }\n\n  public removeAssignee(href:string):void {\n    const numberOfAssignees = this.wpTableFilters.find('assignee')?.values?.length;\n    if (numberOfAssignees && numberOfAssignees <= 1) {\n      this.wpTableFilters.remove('assignee');\n    } else {\n      this.wpTableFilters.modify('assignee', (assigneeFilter:QueryFilterInstanceResource) => {\n        // eslint-disable-next-line no-param-reassign\n        assigneeFilter.values = (assigneeFilter.values as HalResource[])\n          .filter((filterValue) => filterValue.href !== href);\n      });\n    }\n  }\n\n  isWpEndDateInCurrentView(workPackage:WorkPackageResource):boolean {\n    const { dueDate } = workPackage;\n\n    if (!dueDate) {\n      return !!workPackage.date;\n    }\n\n    const viewEndDate = this.ucCalendar.getApi().view.currentEnd.setHours(0, 0, 0, 0);\n    const dateToCheck = new Date(dueDate).setHours(0, 0, 0, 0);\n\n    return dateToCheck < viewEndDate;\n  }\n\n  isWpStartDateInCurrentView(workPackage:WorkPackageResource):boolean {\n    const { startDate } = workPackage;\n\n    if (!startDate) {\n      return !!workPackage.date;\n    }\n\n    const viewStartDate = this.ucCalendar.getApi().view.currentStart.setHours(0, 0, 0, 0);\n    const dateToCheck = new Date(startDate).setHours(0, 0, 0, 0);\n\n    return dateToCheck >= viewStartDate;\n  }\n\n  showDisabledText(workPackage:WorkPackageResource):{ text:string, orientation:'left'|'right' } {\n    const dueDate = new Date(workPackage.dueDate).setHours(0, 0, 0, 0);\n    const firstCalendarDay = this.ucCalendar.getApi().view.currentStart.setHours(0, 0, 0, 0);\n    return {\n      text: this.calendarDrag.workPackageDisabledExplanation(workPackage),\n      orientation: dueDate === firstCalendarDay ? 'right' : 'left',\n    };\n  }\n\n  isStatusClosed(workPackage:WorkPackageResource):boolean {\n    const status = this.statuses.find((el) => el.id === (workPackage.status as StatusResource).id);\n\n    return status ? status.isClosed : false;\n  }\n\n  public async removeEvent(item:EventDragStartArg):Promise<void> {\n    // Remove item from view\n    item.el.remove();\n    item.event.remove();\n\n    const workPackage = item.event.extendedProps.workPackage as WorkPackageResource;\n    const changeset = this.halEditing.edit(workPackage);\n    changeset.setValue('assignee', { href: null });\n    changeset.setValue('startDate', null);\n    changeset.setValue('dueDate', null);\n\n    await this.saveChangeset(changeset);\n\n    this.actions$.dispatch(teamPlannerEventRemoved({ workPackage: workPackage.id as string }));\n  }\n\n  private mapToCalendarEvents(\n    workPackages:WorkPackageResource[],\n    projectAssignables:{ [projectId:string]:string[] },\n  ):EventInput[] {\n    return workPackages\n      .map((workPackage:WorkPackageResource):EventInput|undefined => {\n        if (!workPackage.assignee) {\n          return undefined;\n        }\n\n        const assignee = this.wpAssignee(workPackage);\n        const durationEditable = this.calendar.eventDurationEditable(workPackage);\n        const resourceEditable = this.eventResourceEditable(workPackage);\n\n        return {\n          id: `${workPackage.href as string}-${assignee}`,\n          resourceId: assignee,\n          editable: durationEditable || resourceEditable,\n          durationEditable,\n          resourceEditable,\n          constraint: this.eventConstraints(workPackage, projectAssignables),\n          title: workPackage.subject,\n          start: this.wpStartDate(workPackage),\n          end: this.wpEndDate(workPackage),\n          backgroundColor: '#FFFFFF',\n          borderColor: '#FFFFFF',\n          allDay: true,\n          workPackage,\n        };\n      })\n      .filter((event) => !!event) as EventInput[];\n  }\n\n  private handleDateClicked(info:DateSelectArg) {\n    this.openNewSplitCreate(\n      info.startStr,\n      // end date is exclusive\n      this.calendar.getEndDateFromTimestamp(info.end),\n      info.resource?.id || '',\n    );\n  }\n\n  // Allow triggering the select from a event, as\n  // this is otherwise not testable from selenium\n  @HostListener(\n    'document:teamPlannerSelectDate',\n    ['$event.detail.start', '$event.detail.end', '$event.detail.assignee'],\n  )\n  openNewSplitCreate(start:string, end:string, resourceHref:string):void {\n    const defaults = {\n      startDate: start,\n      dueDate: end,\n      _links: {\n        assignee: {\n          href: resourceHref,\n        },\n      },\n    };\n\n    void this.$state.go(\n      splitViewRoute(this.$state, 'new'),\n      {\n        defaults,\n        tabIdentifier: 'overview',\n      },\n    );\n  }\n\n  openStateLink(event:{ workPackageId:string; requestedState:string }):void {\n    const params = { workPackageId: event.workPackageId };\n\n    if (event.requestedState === 'split') {\n      this.keepTab.goCurrentDetailsState(params);\n    } else {\n      this.keepTab.goCurrentShowState(params);\n    }\n  }\n\n  shouldShowAsGhost(id:string, globalDraggingId:string|undefined):boolean {\n    if (globalDraggingId === undefined) {\n      return false;\n    }\n\n    // Everything else except the currently dragged element should be shown as ghost.\n    return id !== globalDraggingId;\n  }\n\n  private async updateEvent(info:EventResizeDoneArg|EventDropArg|EventReceiveArg):Promise<void> {\n    const changeset = this.calendar.updateDates(info);\n\n    const resource = info.event.getResources()[0];\n    if (resource) {\n      changeset.setValue('assignee', { href: resource.id });\n    }\n\n    this.calendarDrag.handleDrop(changeset.projectedResource);\n    await this.saveChangeset(changeset, info);\n  }\n\n  private async saveChangeset(changeset:ResourceChangeset<WorkPackageResource>, info?:EventResizeDoneArg|EventDropArg|EventReceiveArg) {\n    try {\n      this.loading$ = new Subject<unknown>();\n      this.toastService.addLoading(this.loading$);\n      await this.halEditing.save(changeset);\n    } catch (e:unknown) {\n      this.loading$?.complete();\n      this.halNotification.showError((e as HalError).resource, changeset.projectedResource);\n      this.calendarDrag.handleDropError(changeset.projectedResource);\n      info?.revert();\n    }\n  }\n\n  private eventResourceEditable(wp:WorkPackageResource):boolean {\n    const schema = this.schemaCache.of(wp);\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    return !!schema.assignee?.writable && schema.isAttributeEditable('assignee');\n  }\n\n  // Todo: Evaluate whether we really want to use that from a UI perspective \\_()_/\n  // When users have the right to change the assignee but cannot change the date (due to hierarchy for example),\n  // they are forced to drag the wp to the exact same date in the others assignee row. This might be confusing.\n  // Without these constraints however, users can drag the WP everywhere, thinking that they changed the date as well.\n  // The WP then moves back to the original date when the calendar re-draws again. Also not optimal..\n  private eventConstraints(\n    wp:WorkPackageResource,\n    projectAssignables:{ [projectId:string]:string[] },\n  ):{ [key:string]:string|string[] } {\n    const constraints:{ [key:string]:string|string[] } = {};\n\n    if (!this.calendar.eventDurationEditable(wp) && !wp.date) {\n      constraints.start = this.wpStartDate(wp);\n      constraints.end = this.wpEndDate(wp);\n    }\n\n    if (!this.eventResourceEditable(wp)) {\n      constraints.resourceIds = [this.wpAssignee(wp)];\n      return constraints;\n    }\n\n    const assignables = projectAssignables[(wp.project as HalResource).href as string];\n    if (assignables) {\n      constraints.resourceIds = [...assignables];\n    }\n\n    return constraints;\n  }\n\n  private wpStartDate(wp:WorkPackageResource):string {\n    return this.calendar.eventDate(wp, 'start');\n  }\n\n  private wpEndDate(wp:WorkPackageResource):string {\n    const endDate = this.calendar.eventDate(wp, 'due');\n    return moment(endDate).add(1, 'days').format('YYYY-MM-DD');\n  }\n\n  private wpAssignee(wp:WorkPackageResource):string {\n    return (wp.assignee as HalResource).href as string;\n  }\n\n  private toggleAddExistingPane():void {\n    this.showAddExistingPane.next(!this.showAddExistingPane.getValue());\n    (this.addExistingToggle.nativeElement as HTMLElement).blur();\n  }\n\n  private removeExternalEvents():void {\n    this\n      .ucCalendar\n      .getApi()\n      .getEvents()\n      .forEach((evt) => {\n        if (evt.id.includes('external')) {\n          evt.remove();\n        }\n      });\n  }\n\n  private addBackgroundEvents(event:EventApi) {\n    const wp = event.extendedProps.workPackage as WorkPackageResource;\n\n    this\n      .assigneeCaps$\n      .pipe(\n        filter((el) => Object.keys(el).length > 0),\n        take(1),\n        map((projectAssignables) => projectAssignables[(wp.project as HalResource).href as string]),\n        withLatestFrom(this.principals$),\n      )\n      .subscribe(([assignable, principals]) => {\n        const api = this.ucCalendar.getApi();\n\n        const eventBase = {\n          start: moment().subtract('1', 'month').toDate(),\n          end: moment().add('1', 'month').toDate(),\n        };\n\n        principals.forEach((principal) => {\n          const resourceId = principal._links.self.href;\n\n          if (!assignable || !assignable.includes(resourceId)) {\n            api.addEvent({ ...eventBase, resourceId }, 'background');\n          }\n        });\n      });\n  }\n\n  private removeBackGroundEvents() {\n    this\n      .ucCalendar\n      .getApi()\n      .getEvents()\n      .filter((el) => el.source?.id === 'background')\n      .forEach((el) => el.remove());\n  }\n}\n","// -- copyright\n// OpenProject is an open source project management software.\n// Copyright (C) 2012-2022 the OpenProject GmbH\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License version 3.\n//\n// OpenProject is a fork of ChiliProject, which is a fork of Redmine. The copyright follows:\n// Copyright (C) 2006-2013 Jean-Philippe Lang\n// Copyright (C) 2010-2013 the ChiliProject Team\n//\n// This program is free software; you can redistribute it and/or\n// modify it under the terms of the GNU General Public License\n// as published by the Free Software Foundation; either version 2\n// of the License, or (at your option) any later version.\n//\n// This program is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with this program; if not, write to the Free Software\n// Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n//\n// See COPYRIGHT and LICENSE files for more details.\n//++\n\nimport { Ng2StateDeclaration } from '@uirouter/angular';\nimport { makeSplitViewRoutes } from 'core-app/features/work-packages/routing/split-view-routes.template';\nimport { WorkPackageSplitViewComponent } from 'core-app/features/work-packages/routing/wp-split-view/wp-split-view.component';\nimport { WorkPackagesBaseComponent } from 'core-app/features/work-packages/routing/wp-base/wp--base.component';\nimport { TeamPlannerPageComponent } from 'core-app/features/team-planner/team-planner/page/team-planner-page.component';\nimport { TeamPlannerComponent } from 'core-app/features/team-planner/team-planner/planner/team-planner.component';\n\nexport const TEAM_PLANNER_ROUTES:Ng2StateDeclaration[] = [\n  {\n    name: 'team_planner',\n    parent: 'optional_project',\n    url: '/team_planners/:query_id?query_props&cdate&cview',\n    redirectTo: 'team_planner.page',\n    views: {\n      '!$default': { component: WorkPackagesBaseComponent },\n    },\n    params: {\n      query_id: { type: 'opQueryId', dynamic: true },\n      cdate: { type: 'string', dynamic: true },\n      cview: { type: 'string', dynamic: true },\n      // Use custom encoder/decoder that ensures validity of URL string\n      query_props: { type: 'opQueryString' },\n    },\n  },\n  {\n    name: 'team_planner.page',\n    component: TeamPlannerPageComponent,\n    redirectTo: 'team_planner.page.show',\n    data: {\n      bodyClasses: 'router--team-planner',\n    },\n  },\n  {\n    name: 'team_planner.page.show',\n    data: {\n      baseRoute: 'team_planner.page.show',\n    },\n    views: {\n      'content-left': { component: TeamPlannerComponent },\n    },\n  },\n  ...makeSplitViewRoutes(\n    'team_planner.page.show',\n    undefined,\n    WorkPackageSplitViewComponent,\n  ),\n];\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { UIRouterModule } from '@uirouter/angular';\nimport { DynamicModule } from 'ng-dynamic-component';\nimport { FullCalendarModule } from '@fullcalendar/angular';\nimport { IconModule } from 'core-app/shared/components/icon/icon.module';\nimport { OpenprojectAutocompleterModule } from 'core-app/shared/components/autocompleter/openproject-autocompleter.module';\nimport { OpenprojectPrincipalRenderingModule } from 'core-app/shared/components/principal/principal-rendering.module';\nimport { OpenprojectWorkPackagesModule } from 'core-app/features/work-packages/openproject-work-packages.module';\nimport { TEAM_PLANNER_ROUTES } from 'core-app/features/team-planner/team-planner/team-planner.routes';\nimport { TeamPlannerComponent } from 'core-app/features/team-planner/team-planner/planner/team-planner.component';\nimport { AddAssigneeComponent } from 'core-app/features/team-planner/team-planner/assignee/add-assignee.component';\nimport { TeamPlannerPageComponent } from 'core-app/features/team-planner/team-planner/page/team-planner-page.component';\nimport { OPSharedModule } from 'core-app/shared/shared.module';\nimport { AddExistingPaneComponent } from './add-work-packages/add-existing-pane.component';\nimport { OpenprojectContentLoaderModule } from 'core-app/shared/components/op-content-loader/openproject-content-loader.module';\nimport { TeamPlannerSidemenuComponent } from 'core-app/features/team-planner/team-planner/sidemenu/team-planner-sidemenu.component';\n\n@NgModule({\n  declarations: [\n    TeamPlannerComponent,\n    TeamPlannerPageComponent,\n    AddAssigneeComponent,\n    AddExistingPaneComponent,\n    TeamPlannerSidemenuComponent,\n  ],\n  imports: [\n    OPSharedModule,\n    // Routes for /team_planner\n    UIRouterModule.forChild({\n      states: TEAM_PLANNER_ROUTES,\n    }),\n    DynamicModule,\n    CommonModule,\n    IconModule,\n    OpenprojectPrincipalRenderingModule,\n    OpenprojectWorkPackagesModule,\n    FullCalendarModule,\n    // Autocompleters\n    OpenprojectAutocompleterModule,\n    OpenprojectContentLoaderModule,\n  ],\n})\nexport class TeamPlannerModule {}\n"],"sourceRoot":"webpack:///","file":"src_app_features_team-planner_team-planner_team-planner_module_ts.06d95f3425f551ab3397.js"}