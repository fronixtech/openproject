(self.webpackChunkopenproject_frontend=self.webpackChunkopenproject_frontend||[]).push([["main"],{98255:H=>{function D(t){return Promise.resolve().then(()=>{var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i})}D.keys=()=>[],D.resolve=D,D.id=98255,H.exports=D},32091:function(H,D,t){var i,e;e=this,void 0!==(i=function(){return function(e){"use strict";var c=e&&e.I18n||{},u=Array.prototype.slice,r=function(M){return("0"+M.toString()).substr(-2)},n=function(M,S){return y("round",M,-S).toFixed(S)},h=function(M){var S=typeof M;return"function"===S||"object"===S},a=function(M){return"function"==typeof M},p=function(M){return null!=M},l=function(M){return Array.isArray?Array.isArray(M):"[object Array]"===Object.prototype.toString.call(M)},d=function(M){return"string"==typeof value||"[object String]"===Object.prototype.toString.call(M)},g=function(M){return"number"==typeof M||"[object Number]"===Object.prototype.toString.call(M)},C=function(M){return!0===M||!1===M},y=function(M,S,O){return void 0===O||0==+O?Math[M](S):(S=+S,O=+O,isNaN(S)||"number"!=typeof O||O%1!=0?NaN:(S=S.toString().split("e"),+((S=(S=Math[M](+(S[0]+"e"+(S[1]?+S[1]-O:-O)))).toString().split("e"))[0]+"e"+(S[1]?+S[1]+O:O))))},m=function(M,S){return a(M)?M(S):M},E=function(M,S){var O,A;for(O in S)S.hasOwnProperty(O)&&(A=S[O],d(A)||g(A)||C(A)||l(A)?M[O]=A:(null==M[O]&&(M[O]={}),E(M[O],A)));return M},P={day_names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],abbr_day_names:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],month_names:[null,"January","February","March","April","May","June","July","August","September","October","November","December"],abbr_month_names:[null,"Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridian:["AM","PM"]},w={precision:3,separator:".",delimiter:",",strip_insignificant_zeros:!1},x={unit:"$",precision:2,format:"%u%n",sign_first:!0,delimiter:",",separator:"."},k={unit:"%",precision:3,format:"%n%u",separator:".",delimiter:""},b=[null,"kb","mb","gb","tb"],v={defaultLocale:"en",locale:"en",defaultSeparator:".",placeholder:/(?:\{\{|%\{)(.*?)(?:\}\}?)/gm,fallbacks:!1,translations:{},missingBehaviour:"message",missingTranslationPrefix:""};return c.reset=function(){var M;for(M in v)this[M]=v[M]},c.initializeOptions=function(){var M;for(M in v)p(this[M])||(this[M]=v[M])},c.initializeOptions(),c.locales={},c.locales.get=function(M){var S=this[M]||this[c.locale]||this.default;return a(S)&&(S=S(M)),!1===l(S)&&(S=[S]),S},c.locales.default=function(M){var S=[],O=[];return M&&S.push(M),!M&&c.locale&&S.push(c.locale),c.fallbacks&&c.defaultLocale&&S.push(c.defaultLocale),S.forEach(function(A){var F=A.split("-"),I=null,J=null;3===F.length?(I=[F[0],F[1]].join("-"),J=F[0]):2===F.length&&(I=F[0]),-1===O.indexOf(A)&&O.push(A),c.fallbacks&&[I,J].forEach(function(N){null!=N&&N!==A&&-1===O.indexOf(N)&&O.push(N)})}),S.length||S.push("en"),O},c.pluralization={},c.pluralization.get=function(M){return this[M]||this[c.locale]||this.default},c.pluralization.default=function(M){switch(M){case 0:return["zero","other"];case 1:return["one"];default:return["other"]}},c.currentLocale=function(){return this.locale||this.defaultLocale},c.isSet=p,c.lookup=function(M,S){S=S||{};var F,I,J,N,O=this.locales.get(S.locale).slice();for(O[0],J=this.getFullScope(M,S);O.length;)if(F=O.shift(),I=J.split(this.defaultSeparator),N=this.translations[F]){for(;I.length&&null!=(N=N[I.shift()]););if(null!=N)return N}if(p(S.defaultValue))return m(S.defaultValue,M)},c.pluralizationLookupWithoutFallback=function(M,S,O){var I,J,F=this.pluralization.get(S)(M);if(h(O))for(;F.length;)if(I=F.shift(),p(O[I])){J=O[I];break}return J},c.pluralizationLookup=function(M,S,O){O=O||{};var I,J,N,te,A=this.locales.get(O.locale).slice();for(A[0],S=this.getFullScope(S,O);A.length;)if(I=A.shift(),J=S.split(this.defaultSeparator),N=this.translations[I]){for(;J.length&&(N=N[J.shift()],h(N));)0==J.length&&(te=this.pluralizationLookupWithoutFallback(M,I,N));if(null!=te&&null!=te)break}return(null==te||null==te)&&p(O.defaultValue)&&(te=h(O.defaultValue)?this.pluralizationLookupWithoutFallback(M,O.locale,O.defaultValue):O.defaultValue,N=O.defaultValue),{message:te,translations:N}},c.meridian=function(){var M=this.lookup("time"),S=this.lookup("date");return M&&M.am&&M.pm?[M.am,M.pm]:S&&S.meridian?S.meridian:P.meridian},c.prepareOptions=function(){for(var O,M=u.call(arguments),S={};M.length;)if("object"==typeof(O=M.shift()))for(var A in O)!O.hasOwnProperty(A)||p(S[A])||(S[A]=O[A]);return S},c.createTranslationOptions=function(M,S){var O=[{scope:M}];return p(S.defaults)&&(O=O.concat(S.defaults)),p(S.defaultValue)&&O.push({message:S.defaultValue}),O},c.translate=function(M,S){S=S||{};var A,O=this.createTranslationOptions(M,S),F=this.prepareOptions(S);return delete F.defaultValue,O.some(function(J){if(p(J.scope)?A=this.lookup(J.scope,F):p(J.message)&&(A=m(J.message,M)),null!=A)return!0},this)?("string"==typeof A?A=this.interpolate(A,S):h(A)&&p(S.count)&&(A=this.pluralize(S.count,M,S)),A):this.missingTranslation(M,S)},c.interpolate=function(M,S){S=S||{};var A,I,J,F,O=M.match(this.placeholder);if(!O)return M;for(;O.length;)I=(A=O.shift()).replace(this.placeholder,"$1"),F=p(S[I])?S[I].toString().replace(/\$/gm,"_#$#_"):I in S?this.nullPlaceholder(A,M,S):this.missingPlaceholder(A,M,S),J=new RegExp(A.replace(/\{/gm,"\\{").replace(/\}/gm,"\\}")),M=M.replace(J,F);return M.replace(/_#\$#_/g,"$")},c.pluralize=function(M,S,O){var A,I;return O=this.prepareOptions({count:String(M)},O),null==(I=this.pluralizationLookup(M,S,O)).translations||null==I.translations?this.missingTranslation(S,O):null!=I.message&&null!=I.message?this.interpolate(I.message,O):(A=this.pluralization.get(O.locale),this.missingTranslation(S+"."+A(M)[0],O))},c.missingTranslation=function(M,S){if("guess"==this.missingBehaviour){var O=M.split(".").slice(-1)[0];return(this.missingTranslationPrefix.length>0?this.missingTranslationPrefix:"")+O.replace("_"," ").replace(/([a-z])([A-Z])/g,function(J,N,te){return N+" "+te.toLowerCase()})}return'[missing "'+[null!=S&&null!=S.locale?S.locale:this.currentLocale(),this.getFullScope(M,S)].join(this.defaultSeparator)+'" translation]'},c.missingPlaceholder=function(M,S,O){return"[missing "+M+" value]"},c.nullPlaceholder=function(){return c.missingPlaceholder.apply(c,arguments)},c.toNumber=function(M,S){S=this.prepareOptions(S,this.lookup("number.format"),w);var I,N,O=M<0,F=n(Math.abs(M),S.precision).toString().split("."),J=[],te=S.format||"%n",ee=O?"-":"";for(M=F[0],I=F[1];M.length>0;)J.unshift(M.substr(Math.max(0,M.length-3),3)),M=M.substr(0,M.length-3);return N=J.join(S.delimiter),S.strip_insignificant_zeros&&I&&(I=I.replace(/0+$/,"")),S.precision>0&&I&&(N+=S.separator+I),N=(te=S.sign_first?"%s"+te:te.replace("%n","%s%n")).replace("%u",S.unit).replace("%n",N).replace("%s",ee)},c.toCurrency=function(M,S){return S=this.prepareOptions(S,this.lookup("number.currency.format"),this.lookup("number.format"),x),this.toNumber(M,S)},c.localize=function(M,S,O){switch(O||(O={}),M){case"currency":return this.toCurrency(S);case"number":return M=this.lookup("number.format"),this.toNumber(S,M);case"percentage":return this.toPercentage(S);default:var A;return A=M.match(/^(date|time)/)?this.toTime(M,S):S.toString(),this.interpolate(A,O)}},c.parseDate=function(M){var S,O,A;if("object"==typeof M)return M;if(S=M.toString().match(/(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2}):(\d{2})([\.,]\d{1,3})?)?(Z|\+00:?00)?/)){for(var F=1;F<=6;F++)S[F]=parseInt(S[F],10)||0;S[2]-=1,A=S[7]?1e3*("0"+S[7]):null,O=S[8]?new Date(Date.UTC(S[1],S[2],S[3],S[4],S[5],S[6],A)):new Date(S[1],S[2],S[3],S[4],S[5],S[6],A)}else"number"==typeof M?(O=new Date).setTime(M):M.match(/([A-Z][a-z]{2}) ([A-Z][a-z]{2}) (\d+) (\d+:\d+:\d+) ([+-]\d+) (\d+)/)?(O=new Date).setTime(Date.parse([RegExp.$1,RegExp.$2,RegExp.$3,RegExp.$6,RegExp.$4,RegExp.$5].join(" "))):(M.match(/\d+ \d+:\d+:\d+ [+-]\d+ \d+/),(O=new Date).setTime(Date.parse(M)));return O},c.strftime=function(M,S){var O=this.lookup("date"),A=c.meridian();if(O||(O={}),O=this.prepareOptions(O,P),isNaN(M.getTime()))throw new Error("I18n.strftime() requires a valid date object, but received an invalid date.");var F=M.getDay(),I=M.getDate(),J=M.getFullYear(),N=M.getMonth()+1,te=M.getHours(),ee=te,G=te>11?1:0,se=M.getSeconds(),me=M.getMinutes(),_e=M.getTimezoneOffset(),he=Math.floor(Math.abs(_e/60)),ae=Math.abs(_e)-60*he,re=(_e>0?"-":"+")+(he.toString().length<2?"0"+he:he)+(ae.toString().length<2?"0"+ae:ae);return ee>12?ee-=12:0===ee&&(ee=12),S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=(S=S.replace("%a",O.abbr_day_names[F])).replace("%A",O.day_names[F])).replace("%b",O.abbr_month_names[N])).replace("%B",O.month_names[N])).replace("%d",r(I))).replace("%e",I)).replace("%-d",I)).replace("%H",r(te))).replace("%-H",te)).replace("%I",r(ee))).replace("%-I",ee)).replace("%m",r(N))).replace("%-m",N)).replace("%M",r(me))).replace("%-M",me)).replace("%p",A[G])).replace("%S",r(se))).replace("%-S",se)).replace("%w",F)).replace("%y",r(J))).replace("%-y",r(J).replace(/^0+/,""))).replace("%Y",J)).replace("%z",re)},c.toTime=function(M,S){var O=this.parseDate(S),A=this.lookup(M);return O.toString().match(/invalid/i)||!A?O.toString():this.strftime(O,A)},c.toPercentage=function(M,S){return S=this.prepareOptions(S,this.lookup("number.percentage.format"),this.lookup("number.format"),k),this.toNumber(M,S)},c.toHumanSize=function(M,S){for(var I,J,O=1024,A=M,F=0;A>=O&&F<4;)A/=O,F+=1;return 0===F?(I=this.t("number.human.storage_units.units.byte",{count:A}),J=0):(I=this.t("number.human.storage_units.units."+b[F]),J=A-Math.floor(A)==0?0:1),S=this.prepareOptions(S,{unit:I,precision:J,format:"%n%u",delimiter:""}),this.toNumber(A,S)},c.getFullScope=function(M,S){return S=S||{},l(M)&&(M=M.join(this.defaultSeparator)),S.scope&&(M=[S.scope,M].join(this.defaultSeparator)),M},c.extend=function(M,S){return void 0===M&&void 0===S?{}:E(M,S)},c.t=c.translate,c.l=c.localize,c.p=c.pluralize,c}(e)}.call(D,t,D,H))&&(H.exports=i)},86664:(H,D,t)=>{"use strict";t.d(D,{u:()=>r});var i=t(54364),e=t(76491),c=t(3352),u=t(2316);class r{constructor(h){this.activeState$=new e.X(!0),h.addEventListener("visibilitychange",()=>{h.visibilityState&&((0,c.qu)(`Browser window has visibility state changed to ${h.visibilityState}`),this.activeState$.next("visible"===h.visibilityState))})}get isActive(){return this.activeState$.value}get active$(){return this.activeState$.asObservable()}}r.\u0275fac=function(h){return new(h||r)(u.LFG(i.K0))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})},20979:(H,D,t)=>{"use strict";t.d(D,{T:()=>ve});var i=t(6976),e=t(70233),c=t(71909);class u extends i.f2{constructor(){super(...arguments),this.form=this.subResource("form",c.E)}patch(K,de=null){const He=this.form.extractPayload(K,de);return this.halResourceService.patch(this.path,He)}delete(){return this.halResourceService.delete(this.path)}}var r=t(73726);class n extends i.ZQ{constructor(K,de){super(K,de,"grids",u),this.apiRoot=K,this.basePath=de,this.form=this.subResource("form",c.E)}list(K){return this.halResourceService.get(this.path+(0,r.g)(K))}post(K,de=null){return this.halResourceService.post(this.path,this.form.extractPayload(K,de))}}var h=t(3786),a=t(29161),p=t(87853),l=t(83972),d=t(81134),g=t(53466),C=t(92597),y=t(79902),m=t(67202),E=t(98636),P=t(44022);class w extends i.f2{constructor(){super(...arguments),this.cache=this.createCache()}requireAndStream(K=!1){const de=this.id.toString();if(this.cache.stale(de)||K){const He=this.load().pipe((0,g.q)(1),(0,C.d)(1));return this.cache.clearAndLoad(de,He),(0,l.z)(He,this.cache.state(de).values$())}return this.cache.state(de).values$()}observe(){return this.cache.observe(this.id.toString())}get(){return this.requireAndStream(!1).pipe((0,g.q)(1))}refresh(){return this.requireAndStream(!0).pipe((0,g.q)(1)).toPromise()}load(){return this.halResourceService.get(this.path).pipe((0,y.w)(K=>K.$links.schema?this.schemaCache.requireAndStream(K.$links.schema.href).pipe((0,g.q)(1),(0,m.h)(K)):(0,d.of)(K)))}touch(K){this.cache.updateFor(K)}cacheResponse(){return K=>K.pipe((0,E.b)(de=>this.touch(de)))}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",p.G)],w.prototype,"states",void 0),(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",P.y)],w.prototype,"schemaCache",void 0);var x=t(83498),k=t(26784),b=t(80044);class v extends w{constructor(){super(...arguments),this.form=this.subResource("form",x.f)}patch(K,de=null){return this.halResourceService.patch(this.path,this.extractPayload(K,de)).pipe((0,E.b)(He=>this.touch(He)))}delete(){return this.halResourceService.delete(this.path).pipe((0,E.b)(()=>this.cache.clearSome(this.id.toString())))}createCache(){return this.parent.cache}extractPayload(K,de=null){return K instanceof b.X&&de?k.u.extractPayloadFromSchema(K,de):K instanceof b.X?{}:K}}var M=t(20501);class S extends i.ZQ{constructor(){super(...arguments),this.cache=this.createCache()}observeAll(){return this.cache.observeAll()}cacheResponse(){return K=>K.pipe((0,E.b)(de=>{var He;de instanceof M.Y?null===(He=de.elements)||void 0===He||He.forEach(this.touch.bind(this)):de instanceof b.X&&this.touch(de)}))}touch(K){this.cache.updateFor(K)}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",p.G)],S.prototype,"states",void 0);var O=t(79175);class A extends O.r{constructor(K,de){super(de),this.injector=K}updateValue(K,de){return this.schemaCache.ensureLoaded(de).then(()=>(this.putValue(K,de),de))}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",p.G)],A.prototype,"states",void 0),(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",P.y)],A.prototype,"schemaCache",void 0);class F extends S{constructor(K,de){super(K,de,"time_entries",v),this.apiRoot=K,this.basePath=de,this.form=this.subResource("form",x.f)}list(K){return this.halResourceService.get(this.path+(0,r.g)(K)).pipe(this.cacheResponse())}post(K){return this.halResourceService.post(this.path,K).pipe(this.cacheResponse())}createCache(){return new A(this.injector,this.states.timeEntries)}}class I extends w{createCache(){return this.parent.cache}}class J extends O.r{constructor(K,de){super(de),this.injector=K}updateValue(K,de){return this.putValue(K,de),Promise.resolve(de)}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",p.G)],J.prototype,"states",void 0);class N extends S{constructor(K,de){super(K,de,"capabilities",I),this.apiRoot=K,this.basePath=de}list(K){return this.halResourceService.get(this.path+(0,r.g)(K)).pipe(this.cacheResponse())}createCache(){return new J(this.injector,this.states.capabilities)}}var te=t(33927),ee=t(26269);class G extends i.f2{list(K){return this.halResourceService.get(this.path+(0,r.g)(K))}exists(K){return this.halResourceService.get(this.path,{filters:(0,ee.PQ)("id","=",[K]).toJson()}).pipe((0,te.U)(de=>de.count>0))}}class se extends x.f{static extractPayload(K){return{_links:{project:{href:K.project.href},principal:{href:K.principal.href},roles:K.roles.map(de=>({href:de.href}))},_meta:{notificationMessage:{raw:K.notificationMessage.raw}}}}extractPayload(K){return se.extractPayload(K)}}class me extends i.ZQ{constructor(K,de){super(K,de,"memberships"),this.apiRoot=K,this.basePath=de,this.form=this.subResource("form",se),this.available_projects=this.subResource("available_projects",G)}list(K){return this.halResourceService.get(this.path+(0,r.g)(K))}post(K){const de=this.form.extractPayload(K);return this.halResourceService.post(this.path,de)}}var _e=t(53882);class he extends i.G7{get(){return this.http.get(this.path)}patch(K){return this.http.patch(this.path,K,{withCredentials:!0,responseType:"json"})}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",_e.eN)],he.prototype,"http",void 0);class ae extends w{constructor(){super(...arguments),this.avatar=this.subResource("avatar"),this.preferences=this.subResource("preferences",he)}createCache(){return new O.r(this.states.users)}}class re extends i.ZQ{constructor(K,de){super(K,de,"users",ae),this.apiRoot=K,this.basePath=de,this.me=this.subResource("me",ae),this.form=this.subResource("form",x.f)}post(K){return this.halResourceService.post(this.path,K)}}class ye extends w{createCache(){return this.parent.cache}}class Ce extends S{constructor(K,de){super(K,de,"types",ye),this.apiRoot=K,this.basePath=de}createCache(){return new O.r(this.states.types)}}var ke=t(17577),Ae=t(49152);class Fe extends Ae.J{constructor(K,de,He){super(de,He),this.injector=K,this.basePath=de,this.id=He}get(){return this.http.get(this.path).toPromise().then(K=>K||{})}update(K){return this.http.patch(this.path,{delta:K},{withCredentials:!0}).toPromise().then(de=>de.t)}delete(K,...de){const He={};return de.forEach(ht=>He[ht]=-1),this.update(He)}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",_e.eN)],Fe.prototype,"http",void 0);var ot=t(97973),it=t(19866);class Ve extends x.f{load(K){const de={name:K.name||"!!!__O__o__O__!!!"};K.project&&(de._links={project:{href:K.project.href}});const{path:He}=this.apiRoot.queries.withOptionalId(K.id).form;return this.halResourceService.post(He,de).pipe((0,E.b)(ht=>this.queryFilters.setSchemas(ht.$embedded.schema.$embedded.filtersSchemas)),(0,te.U)(ht=>[ht,this.buildQueryResource(ht)]))}loadWithParams(K,de,He,ht={}){!de&&!ht.name&&(ht.name="!!!__O__o__O__!!!"),He&&(ht._links=ht._links||{},ht._links.project={href:this.apiRoot.projects.id(He).toString()});const{path:yt}=this.apiRoot.queries.withOptionalId(de).form,St=ot(yt).search(K).toString();return this.halResourceService.post(St,ht).pipe((0,E.b)(Et=>this.queryFilters.setSchemas(Et.$embedded.schema.$embedded.filtersSchemas)),(0,te.U)(Et=>[Et,this.buildQueryResource(Et)]))}buildQueryResource(K){return this.halResourceService.createHalResourceOfType("Query",K.payload)}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",it.r)],Ve.prototype,"queryFilters",void 0);class Ie extends i.f2{constructor(){super(...arguments),this.form=this.subResource("form",Ve),this.order=new Fe(this.injector,this.path,"order")}parameterised(K){return this.halResourceService.get(this.path,K)}patch(K,de){return K instanceof ke.P&&de&&(this.queryFilters.mapSchemasIntoFilters(K,de),K=k.u.extractPayloadFromSchema(K,de.schema)),this.halResourceService.patch(this.path,K)}delete(){return this.halResourceService.delete(this.path)}paginated(K){return this.parameterised(K)}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",it.r)],Ie.prototype,"queryFilters",void 0);class ue extends i.ZQ{constructor(K,de){super(K,de,"queries",Ie),this.apiRoot=K,this.basePath=de,this.form=this.subResource("form",Ve),this.default=this.subResource("default"),this.filter_instance_schemas=new i.ZQ(this.apiRoot,this.path,"filter_instance_schemas")}list(K){return this.halResourceService.get(this.path+(0,r.g)(K))}find(K,de,He){let ht;return ht=de?this.apiRoot.queries.id(de).toString():this.apiRoot.withOptionalProject(He).queries.default.toString(),this.halResourceService.get(ht,K)}parameterised(K){return this.halResourceService.get(this.default.path,K)}post(K,de){return K instanceof ke.P&&de&&(this.queryFilters.mapSchemasIntoFilters(K,de),K=k.u.extractPayloadFromSchema(K,de.schema)),this.halResourceService.post(this.apiRoot.queries.path,K)}toggleStarred(K){return K.starred?K.unstar():K.star()}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",it.r)],ue.prototype,"queryFilters",void 0);var ie=t(30400);class R extends i.ZQ{constructor(K,de){super(K,de,"relations"),this.apiRoot=K,this.basePath=de}get(){return this.halResourceService.get(this.path)}loadInvolved(K){const de=_.filter(K,He=>/\d+/.test(He));return 0===de.length?(0,ie.D)([]):this.filtered((0,ee.PQ)("involved","=",de),{pageSize:"-1"}).get().pipe((0,te.U)(He=>He.elements))}}class L extends w{constructor(){super(...arguments),this.relations=this.subResource("relations",R),this.revisions=this.subResource("revisions"),this.activities=this.subResource("activities"),this.available_watchers=this.subResource("available_watchers"),this.available_projects=this.subResource("available_projects"),this.github_pull_requests=this.subResource("github_pull_requests")}createCache(){return this.parent.cache}}class W extends x.f{forTypePayload(K){K._links.type&&K._links.type;return this.post(K)}forPayload(K){return this.post(K)}}var oe=t(14808),Oe=t(3352),$=t(84699),Xe=t(2316);class rt extends O.r{constructor(K,de){super(de),this.injector=K}updateValue(K,de){return this.schemaCacheService.ensureLoaded(de).then(()=>(this.putValue(K,de),de))}updateWorkPackage(K,de=!1){return de||(0,$.Z)(K)?super.updateValue(K.id,K):this.updateValue(K.id,K)}updateWorkPackageList(K,de=!0){K.forEach(He=>{const ht=He,yt=ht.id,St=this.multiState.get(yt);(0,$.Z)(ht)?St.putValue(ht):this.schemaCacheService.ensureLoaded(ht).then(()=>{de&&St.hasValue()&&_.isEqual(St.value.$source,ht.$source)?(0,Oe.qu)("Skipping identical work package from updating"):St.putValue(ht)})})}}rt.\u0275fac=function(K){return new(K||rt)(Xe.LFG(Xe.zs3),Xe.LFG(oe.J$))},rt.\u0275prov=Xe.Yz7({token:rt,factory:rt.\u0275fac}),(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",P.y)],rt.prototype,"schemaCacheService",void 0);class ge extends i.f2{get(){return this.halResourceService.get(this.path).pipe((0,E.b)(K=>K.schemas&&this.updateSchemas(K.schemas)),(0,E.b)(K=>this.cache.updateWorkPackageList(K.elements)),(0,g.q)(1))}get cache(){return this.parent.cache}updateSchemas(K){K.elements.forEach(de=>{this.states.schemas.get(de.href).putValue(de)})}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",p.G)],ge.prototype,"states",void 0);class be extends S{constructor(K,de){super(K,de,"work_packages",L),this.apiRoot=K,this.basePath=de,this.form=this.subResource("form",W),this.available_projects=this.subResource("available_projects")}requireAll(K){return 0===K.length?Promise.resolve():new Promise((de,He)=>{this.loadCollectionsFor(_.uniq(K)).then(ht=>{_.each(ht,yt=>{yt.schemas&&_.each(yt.schemas.elements,St=>{this.states.schemas.get(St.href).putValue(St)}),yt.elements&&this.cache.updateWorkPackageList(yt.elements)}),de(void 0)},He)})}post(K){return this.halResourceService.post(this.path,K).pipe(this.cacheResponse())}filtered(K,de={}){return super.filtered(K,de,ge)}filterByTypeaheadOrId(K,de=!1,He={}){const ht=new ee.qM;de?ht.add("id","=",[K]):ht.add("typeahead","**",[K]);const yt=Object.assign({sortBy:'[["updatedAt","desc"]]',offset:"1",pageSize:"10"},He);return this.filtered(ht,yt)}filterUpdatedSince(K,de){const He=(new ee.qM).add("id","=",K.filter(yt=>yt)).add("updatedAt","<>d",[de,""]);return this.filtered(He,{offset:"1",pageSize:"10"})}loadCollectionsFor(K){return this.halResourceService.getAllPaginated(this.path,{filters:(0,ee.PQ)("id","=",K).toJson()}).toPromise()}createCache(){return new rt(this.injector,this.states.workPackages)}}class Me extends w{patch(K){return this.halResourceService.patch(this.path,K).pipe((0,E.b)(de=>this.touch(de)))}createCache(){return new O.r(this.states.versions)}}class Re extends i.ZQ{constructor(K,de){super(K,de,"versions",Me),this.apiRoot=K,this.basePath=de,this.form=this.subResource("form",x.f),this.available_projects=this.subResource("available_projects",G)}get(){return this.halResourceService.get(this.path)}post(K){return this.halResourceService.post(this.path,K)}}class $e extends Ae.J{constructor(K,de){super(de,"copy"),this.apiRoot=K,this.basePath=de,this.form=new x.f(this.apiRoot,this.path,"form")}}class pt extends w{constructor(){super(...arguments),this.available_assignees=this.subResource("available_assignees"),this.queries=new ue(this.apiRoot,this.path),this.types=new Ce(this.apiRoot,this.path),this.work_packages=new be(this.apiRoot,this.path),this.versions=new Re(this.apiRoot,this.path),this.copy=new $e(this.apiRoot,this.path)}createCache(){return this.parent.cache}}class mt extends O.r{constructor(K,de){super(de),this.injector=K}updateValue(K,de){return this.schemaCacheService.ensureLoaded(de).then(()=>(this.putValue(K,de),de))}}mt.\u0275fac=function(K){return new(K||mt)(Xe.LFG(Xe.zs3),Xe.LFG(oe.J$))},mt.\u0275prov=Xe.Yz7({token:mt,factory:mt.\u0275fac}),(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",P.y)],mt.prototype,"schemaCacheService",void 0);class vt extends S{constructor(K,de){super(K,de,"projects",pt),this.apiRoot=K,this.basePath=de,this.schema=this.subResource("schema")}list(K){return this.halResourceService.get(this.path+(0,r.g)(K)).pipe(this.cacheResponse())}createCache(){return new mt(this.injector,this.states.projects)}}class Ue extends w{createCache(){return new O.r(this.states.statuses)}}class Le extends i.ZQ{constructor(K,de){super(K,de,"statuses",Ue),this.apiRoot=K,this.basePath=de}get(){return this.halResourceService.get(this.path).pipe((0,E.b)(K=>{K.elements.forEach((de,He)=>{this.id(de.id).cache.updateValue(de.id,de)})}))}}class Ee extends w{createCache(){return new O.r(this.states.roles)}}class st extends i.ZQ{constructor(K,de){super(K,de,"roles",Ee),this.apiRoot=K,this.basePath=de}get(){return this.halResourceService.get(this.path).pipe((0,E.b)(K=>{K.elements.forEach((de,He)=>{this.id(de.id).cache.updateValue(de.id,de)})}))}}class ut extends i.ZQ{constructor(K,de){super(K,de,"news"),this.apiRoot=K,this.basePath=de}list(K){return this.halResourceService.get(this.path+(0,r.g)(K))}}class It extends i.ZQ{constructor(K,de){super(K,de,"help_texts"),this.apiRoot=K,this.basePath=de}get(){return this.halResourceService.get(this.path)}}class Zt extends i.f2{constructor(K,de){super(K,de,"configuration"),this.apiRoot=K,this.basePath=de}get(){return this.$configuration?this.$configuration:this.$configuration=this.halResourceService.get(this.path).pipe((0,C.d)())}}class Ut{constructor(K){this.grid=K}get id(){return this.grid.id}get name(){return this.grid.name}get editable(){return!!this.grid.updateImmediately}get isFree(){return!this.isAction}get isAction(){return"action"===this.grid.options.type}get actionAttribute(){if(!this.isFree)return this.grid.options.attribute}set highlightingMode(K){this.grid.options.highlightingMode=K}get highlightingMode(){return this.grid.options.highlightingMode||"none"}set name(K){this.grid.name=K}addQuery(K){K.isNewWidget=!0,this.grid.widgets.push(K)}removeQuery(K){this.grid.widgets=this.grid.widgets.filter(de=>de.options.queryId!==K.options.queryId)}get queries(){return this.grid.widgets}get createdAt(){return this.grid.createdAt}get filters(){return this.grid.options.filters||[]}set filters(K){this.grid.options.filters=K}sortWidgets(){this.grid.widgets=this.grid.widgets.sort((K,de)=>K.startColumn-de.startColumn)}showStatusButton(){return"status"!==this.actionAttribute}}var jt=t(7493);class Dt extends w{load(){return this.apiRoot.grids.id(this.id).get().pipe((0,te.U)(K=>{const de=new Ut(K);return de.sortWidgets(),de}))}save(K){return this.fetchSchema(K).pipe((0,y.w)(de=>this.apiRoot.grids.id(K.grid).patch(K.grid,de)),(0,te.U)(de=>(K.grid=de,K.sortWidgets(),K)),this.cacheResponse())}delete(){return this.apiRoot.grids.id(this.id).delete().pipe((0,E.b)(()=>this.cache.clearSome(this.id.toString())))}fetchSchema(K){return this.apiRoot.grids.id(K.grid).form.post({}).pipe((0,te.U)(de=>de.schema))}createCache(){return this.parent.cache}}class bt extends S{constructor(K,de){super(K,de,"grids",Dt),this.apiRoot=K,this.basePath=de}list(K){return this.halResourceService.get(this.path+(0,r.g)(K)).pipe((0,E.b)(de=>this.authorisationService.initModelAuth("boards",de.$links)),(0,te.U)(de=>de.elements.map(He=>{const ht=new Ut(He);return ht.sortWidgets(),this.touch(ht),ht})))}allInScope(K){const de=this.boardPath(K);return this.list({filters:[["scope","=",[de]]]})}create(K,de,He,ht){const yt=this.boardPath(He);return this.createGrid(K,de,yt,ht).pipe((0,te.U)(St=>new Ut(St)))}boardPath(K){return this.PathHelper.projectBoardsPath(K)}createCache(){const K=this.states.forType("boards");return new O.r(K)}createGrid(K,de,He,ht){const yt=_.set({name:de},"_links.scope.href",He);return yt.options={type:K},ht&&(yt.options.attribute=ht),this.apiRoot.grids.form.post(yt).pipe((0,y.w)(St=>this.apiRoot.grids.post(St.payload.$source)))}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",jt.g)],bt.prototype,"authorisationService",void 0),(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",e.j)],bt.prototype,"PathHelper",void 0);class Lt extends i.f2{patch(K){return this.halResourceService.patch(this.path,{name:K.name})}delete(){return this.halResourceService.delete(this.path)}}class Wt extends i.ZQ{constructor(K,de){super(K,de,"placeholder_users",Lt),this.apiRoot=K,this.basePath=de}list(K){return this.halResourceService.get(this.path+(0,r.g)(K))}post(K){return this.halResourceService.post(this.path,K)}}class Rt extends i.f2{patch(K){return this.halResourceService.patch(this.path,{name:K.name})}delete(){return this.halResourceService.delete(this.path)}}class xt extends i.ZQ{constructor(K,de){super(K,de,"groups",Rt),this.apiRoot=K,this.basePath=de}list(K){return this.halResourceService.get(this.path+(0,r.g)(K))}post(K){return this.halResourceService.post(this.path,K)}}class Mt extends i.f2{markRead(){return this.http.post(`${this.path}/read_ian`,{},{withCredentials:!0,responseType:"json"})}markUnread(){return this.http.post(`${this.path}/unread_ian`,{},{withCredentials:!0,responseType:"json"})}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",_e.eN)],Mt.prototype,"http",void 0);class wt extends i.ZQ{constructor(K,de){super(K,de,"notifications",Mt),this.apiRoot=K,this.basePath=de}facet(K,de){return"unread"===K?this.unread(de):this.list(de)}list(K){return this.http.get(this.path+(0,r.g)(K))}listPath(K){return this.path+(0,r.g)(K)}unread(K){const He=[...(null==K?void 0:K.filters)?K.filters:[],["readIAN","=",!1]],ht=Object.assign(Object.assign({},K),{filters:He});return this.list(ht)}markRead(K){return this.http.post(`${this.path}/read_ian${(0,r.g)({filters:[["id","=",K.map(de=>de.toString())]]})}`,{},{withCredentials:!0,responseType:"json"})}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",_e.eN)],wt.prototype,"http",void 0);class Jt extends i.ZQ{constructor(K,de){super(K,de,"views"),this.apiRoot=K,this.basePath=de}post(K,de){return this.http.post(`${this.path}/${de}`,K,{withCredentials:!0,responseType:"json"}).pipe((0,te.U)(He=>He))}}(0,h.gn)([(0,a.W)(),(0,h.w6)("design:type",_e.eN)],Jt.prototype,"http",void 0);class Ze extends i.f2{constructor(K,de){super(K,de,"backups"),this.apiRoot=K,this.basePath=de}post(K,de){return this.halResourceService.post(this.path,{backupToken:K,attachments:de})}}class ve{constructor(K,de){this.injector=K,this.pathHelper=de,this.attachments=this.apiV3CollectionEndpoint("attachments"),this.backups=this.apiV3CustomEndpoint(Ze),this.configuration=this.apiV3CustomEndpoint(Zt),this.documents=this.apiV3CollectionEndpoint("documents"),this.notifications=this.apiV3CustomEndpoint(wt),this.grids=this.apiV3CustomEndpoint(n),this.principals=this.apiV3CollectionEndpoint("principals"),this.root=this.apiV3SingularEndpoint(""),this.statuses=this.apiV3CustomEndpoint(Le),this.relations=this.apiV3CustomEndpoint(R),this.priorities=this.apiV3CollectionEndpoint("priorities"),this.time_entries=this.apiV3CustomEndpoint(F),this.actions=this.apiV3CollectionEndpoint("actions"),this.capabilities=this.apiV3CustomEndpoint(N),this.memberships=this.apiV3CustomEndpoint(me),this.news=this.apiV3CustomEndpoint(ut),this.types=this.apiV3CustomEndpoint(Ce),this.versions=this.apiV3CustomEndpoint(Re),this.work_packages=this.apiV3CustomEndpoint(be),this.queries=this.apiV3CustomEndpoint(ue),this.projects=this.apiV3CustomEndpoint(vt),this.users=this.apiV3CustomEndpoint(re),this.placeholder_users=this.apiV3CustomEndpoint(Wt),this.groups=this.apiV3CustomEndpoint(xt),this.roles=this.apiV3CustomEndpoint(st),this.help_texts=this.apiV3CustomEndpoint(It),this.job_statuses=this.apiV3CollectionEndpoint("job_statuses"),this.views=this.apiV3CustomEndpoint(Jt),this.boards=this.apiV3CustomEndpoint(bt)}withOptionalProject(K){return _.isNil(K)?this:this.projects.id(K)}collectionFromString(K){const de=K.replace(`${this.pathHelper.api.v3.apiV3Base}/`,"");return this.apiV3CollectionEndpoint(de)}apiV3CollectionEndpoint(K,de){return new i.ZQ(this,this.pathHelper.api.v3.apiV3Base,K,de)}apiV3CustomEndpoint(K){return new K(this,this.pathHelper.api.v3.apiV3Base)}apiV3SingularEndpoint(K){return new i.f2(this,this.pathHelper.api.v3.apiV3Base,K)}}ve.\u0275fac=function(K){return new(K||ve)(Xe.LFG(Xe.zs3),Xe.LFG(e.j))},ve.\u0275prov=Xe.Yz7({token:ve,factory:ve.\u0275fac,providedIn:"root"})},79175:(H,D,t)=>{"use strict";t.d(D,{r:()=>n});var i=t(53466),e=t(91992),c=t(1143),u=t(77763),r=t(33927);class n{constructor(a,p=3600){this.multiState=a,this.cacheDurationInMs=1e3*p}state(a){return this.multiState.get(a)}touch(a){const p=this.multiState.get(a);p.putValue(p.value,"Touching the state")}current(a,p){return this.state(a).getValueOr(p)}clearAndLoad(a,p){const l=p.pipe((0,i.q)(1),(0,e.B)());return this.multiState.get(a).clearAndPutFromPromise(l.toPromise()),l}updateValue(a,p){return this.putValue(a,p),Promise.resolve(p)}updateFor(a){return this.updateValue(a.id,a)}observe(a){return this.state(a).values$()}changes$(a){return this.state(a).changes$()}observeAll(){return this.multiState.observeChange().pipe((0,c.O)([]),(0,u.e)(250),(0,r.U)(()=>{const a=[];return _.each(this.multiState.getValueOr({}),p=>{p.value&&a.push(p.value)}),a}))}clearSome(...a){a.forEach(p=>this.multiState.get(p).clear())}stale(a){const p=this.multiState.get(a);return!p.hasActivePromiseRequest()&&(p.isPristine()||p.isValueOlderThan(this.cacheDurationInMs))}putValue(a,p){this.multiState.get(a).putValue(p)}}},71909:(H,D,t)=>{"use strict";t.d(D,{E:()=>u});var i=t(83498),e=t(26784),c=t(80044);class u extends i.f{static extractPayload(n,h=null){if(n instanceof c.X&&h){const a=n,p=e.u.extractPayloadFromSchema(a,h);return p.widgets&&(p.widgets=a.widgets.map(l=>({id:l.id,startRow:l.startRow,endRow:l.endRow,startColumn:l.startColumn,endColumn:l.endColumn,identifier:l.identifier,options:l.options}))),p}return n||{}}extractPayload(n,h=null){return u.extractPayload(n,h)}}},83498:(H,D,t)=>{"use strict";t.d(D,{f:()=>c});var i=t(6976),e=t(26784);class c extends i.G7{post(r={},n=null){return this.halResourceService.post(this.path,this.extractPayload(r,n))}extractPayload(r,n=null){return e.u.extractPayload(r,n)}}},23237:(H,D,t)=>{"use strict";t.d(D,{JQ:()=>a,rP:()=>p});var i=t(85816),e=t(33927),c=t(42720),u=t(81134),r=t(80044);function a(l,d=-1){return l({pageSize:d,offset:1}).pipe((0,i.zg)(g=>{const C=g.pageSize;if(g.total>g.count){const y=g.total-g.count,m=Math.ceil(y/C),E=new Array(m).fill(null).map((P,w)=>l({pageSize:C,offset:w+2}));return(0,c.D)(...E).pipe((0,e.U)(P=>[g,...P]))}return(0,u.of)([g])}))}function p(l,d=-1){return a(l,d).pipe((0,e.U)(g=>g.reduce((C,y)=>C.concat(function(l){var d;return l instanceof r.X?l.elements||[]:(null===(d=l._embedded)||void 0===d?void 0:d.elements)||[]}(y)),[])))}},73726:(H,D,t)=>{"use strict";t.d(D,{g:()=>e});var i=t(26269);function e(c){const u=[];if(c&&c.sortBy&&u.push(`sortBy=${JSON.stringify(c.sortBy)}`),c&&c.groupBy&&u.push(`groupBy=${c.groupBy}`),c&&void 0!==c.pageSize&&u.push(`pageSize=${c.pageSize}`),c&&void 0!==c.offset&&u.push(`offset=${c.offset}`),c&&void 0!==c.select&&u.push(`select=${c.select.join(",")}`),c&&c.filters){const n=new i.qM;c.filters.forEach(h=>{n.add(...h)}),u.push(n.toParams())}let r="";return u.length&&(r=`?${u.join("&")}`),r}},6976:(H,D,t)=>{"use strict";t.d(D,{G7:()=>r,f2:()=>n,ZQ:()=>h});var i=t(3786),e=t(49152),c=t(29161),u=t(91923);class r extends e.J{constructor(p,l,d,g){super(l,d),this.apiRoot=p,this.basePath=l,this.id=d,this.parent=g,this.injector=this.apiRoot.injector}subResource(p,l=n){return new l(this.apiRoot,this.path,p,this)}}(0,i.gn)([(0,c.W)(),(0,i.w6)("design:type",u.u)],r.prototype,"halResourceService",void 0);class n extends r{get(){return this.halResourceService.get(this.path)}}class h extends e.D{constructor(p,l,d,g){super(l,d,g),this.apiRoot=p,this.basePath=l,this.resource=g,this.injector=this.apiRoot.injector}id(p){let l;return l="string"==typeof p||"number"==typeof p?p.toString():p.id,new(this.resource||n)(this.apiRoot,this.path,l,this)}withOptionalId(p){return _.isNil(p)?this:this.id(p)}toString(){return this.path}toPath(){return this.path}filtered(p,l={},d){const g=new URL(this.path,window.location.origin);if(g.searchParams.has("filters")){const y=JSON.parse(g.searchParams.get("filters"));g.searchParams.set("filters",JSON.stringify(y.concat(p.filters)))}else g.searchParams.set("filters",p.toJson());Object.keys(l).forEach(y=>{g.searchParams.set(y,l[y])});return new(d||n)(this.apiRoot,g.pathname,g.search,this)}subResource(p,l=n){return new l(this.apiRoot,this.path,p,this)}}(0,i.gn)([(0,c.W)(),(0,i.w6)("design:type",u.u)],h.prototype,"halResourceService",void 0)},49152:(H,D,t)=>{"use strict";t.d(D,{D:()=>i,J:()=>e});class i{constructor(u,r,n){this.basePath=u,this.segment=r,this.resource=n,this.path=`${this.basePath}/${r}`}id(u){return new(this.resource||e)(this.path,u)}withOptionalId(u){return _.isNil(u)?this:this.id(u)}toString(){return this.path}toPath(){return this.path}}class e{constructor(u,r){this.basePath=u,this.segment=r;const n=r.toString().startsWith("?")?"":"/";this.path=`${this.basePath}${n}${r}`}toString(){return this.path}toPath(){return this.path}}},1056:(H,D,t)=>{"use strict";t.d(D,{o:()=>c});var i=t(54364),e=t(2316);class c{constructor(r){this.documentElement=r}get isMobile(){return this.hasBodyClass("-browser-mobile")}get isEdge(){return this.hasBodyClass("-browser-edge")}hasBodyClass(r){return this.documentElement.body.classList.contains(r)}}c.\u0275fac=function(r){return new(r||c)(e.LFG(i.K0))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})},53916:(H,D,t)=>{"use strict";t.d(D,{U:()=>e});var i=t(2316);class e{constructor(){this.mobileWidthTreshold=680}get isMobile(){return window.innerWidth<this.mobileWidthTreshold}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})},12877:(H,D,t)=>{"use strict";t.d(D,{e:()=>n});var i=t(96617),e=t(2281),u=t(20979),r=t(2316);class n{constructor(a,p){this.I18n=a,this.apiV3Service=p,this.initialized=this.loadConfiguration().then(()=>!0).catch(()=>!1)}commentsSortedInDescendingOrder(){return this.userPreference("commentSortDescending")}warnOnLeavingUnsaved(){return this.userPreference("warnOnLeavingUnsaved")}autoHidePopups(){return this.userPreference("autoHidePopups")}isTimezoneSet(){return!!this.timezone()}timezone(){return this.userPreference("timeZone")}isDirectUploads(){return!!this.prepareAttachmentURL}get prepareAttachmentURL(){return _.get(this.configuration,["prepareAttachment","href"])}get maximumAttachmentFileSize(){return this.systemPreference("maximumAttachmentFileSize")}get perPageOptions(){return this.systemPreference("perPageOptions")}dateFormatPresent(){return!!this.systemPreference("dateFormat")}dateFormat(){return this.systemPreference("dateFormat")}timeFormatPresent(){return!!this.systemPreference("timeFormat")}timeFormat(){return this.systemPreference("timeFormat")}startOfWeekPresent(){return!!this.systemPreference("startOfWeek")}startOfWeek(){return this.startOfWeekPresent()?this.systemPreference("startOfWeek"):e.localeData(I18n.locale).firstDayOfWeek()}loadConfiguration(){return this.apiV3Service.configuration.get().toPromise().then(a=>{this.configuration=a})}userPreference(a){return _.get(this.configuration,["userPreferences",a])}systemPreference(a){return _.get(this.configuration,a)}}n.\u0275fac=function(a){return new(a||n)(r.LFG(i.D),r.LFG(u.T))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})},65146:(H,D,t)=>{"use strict";t.d(D,{R:()=>u});var i=t(70233),e=t(20979),c=t(2316);class u{constructor(n,h){this.PathHelper=n,this.apiV3Service=h,this.detect()}get inProjectContext(){return void 0!==this.current}get path(){return this.current?this.PathHelper.projectPath(this.current.identifier):null}get apiv3Path(){return this.current?this.apiV3Service.projects.id(this.current.id).toString():null}get id(){return this.getCurrent("id")}get name(){return this.getCurrent("name")}get identifier(){return this.getCurrent("identifier")}getCurrent(n){return this.current&&this.current[n]?this.current[n].toString():null}detect(){const n=document.querySelector("meta[name=current_project]");n&&(this.current={id:n.dataset.projectId,name:n.dataset.projectName,identifier:n.dataset.projectIdentifier})}}u.\u0275fac=function(n){return new(n||u)(c.LFG(i.j),c.LFG(e.T))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})},37991:(H,D,t)=>{"use strict";t.d(D,{H:()=>n});var i=t(96905),e=t(52657),c=t(4678),u=t(2316);class n{constructor(a){!function(h){const a=h.get(i.S);window.ErrorReporter.addContext(l=>{a.user$.subscribe(({id:d,name:g,mail:C})=>{l.setUser({name:g,mail:C,id:d||void 0})})});const p=document.querySelectorAll("meta[name=current_user]")[0];a.setUser({id:(null==p?void 0:p.dataset.id)||null,name:(null==p?void 0:p.dataset.name)||null,mail:(null==p?void 0:p.dataset.mail)||null})}(a)}}n.\u0275fac=function(a){return new(a||n)(u.LFG(u.zs3))},n.\u0275mod=u.oAB({type:n}),n.\u0275inj=u.cJS({providers:[i.S,e.D,c.b]})},4678:(H,D,t)=>{"use strict";t.d(D,{b:()=>u});var i=t(19100),e=t(52657),c=t(2316);class u extends i.AE{constructor(n){super(n),this.store=n,this.isLoggedIn$=this.select(h=>!!h.id),this.user$=this.select(({id:h,name:a,mail:p})=>({id:h,name:a,mail:p})),this.capabilities$=this.select("capabilities").pipe((0,i.Jt)())}}u.\u0275fac=function(n){return new(n||u)(c.LFG(e.D))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},96905:(H,D,t)=>{"use strict";t.d(D,{S:()=>p});var i=t(53466),e=t(33927),c=t(83720),u=t(20979),r=t(52657),n=t(4678),h=t(23237),a=t(2316);class p{constructor(d,g,C){this.apiV3Service=d,this.currentUserStore=g,this.currentUserQuery=C,this.capabilities$=this.currentUserQuery.capabilities$,this.isLoggedIn$=this.currentUserQuery.isLoggedIn$,this.user$=this.currentUserQuery.user$,this._isLoggedIn=!1,this._user={id:null,name:null,mail:null},this.setupLegacyDataListeners()}setUser(d){this.currentUserStore.update(g=>Object.assign(Object.assign({},g),d)),this.fetchCapabilities([])}fetchCapabilities(d=[]){return this.user$.pipe((0,i.q)(1)).subscribe(g=>{if(!g.id)return void this.currentUserStore.update(y=>Object.assign(Object.assign({},y),{capabilities:[]}));const C=[["principal","=",[g.id]]];d.length&&C.push(["context","=",d.map(y=>"global"===y?"g":`p${y}`)]),(0,h.rP)(y=>this.apiV3Service.capabilities.list(Object.assign(Object.assign({},y),{filters:C}))).subscribe(y=>{this.currentUserStore.update(m=>Object.assign(Object.assign({},m),{capabilities:[...y,...(m.capabilities||[]).filter(E=>!!y.find(P=>P.id===E.id))]}))})}),this.currentUserQuery.capabilities$}capabilitiesForContext$(d){return this.capabilities$.pipe((0,e.U)(g=>g.filter(C=>C.context.href.endsWith(`/${d}`))),(0,c.x)())}hasCapabilities$(d,g="global"){const C=_.castArray(d);return this.capabilitiesForContext$(g).pipe((0,e.U)(y=>C.reduce((m,E)=>m&&!!y.find(P=>P.action.href.endsWith(`/api/v3/actions/${E}`)),y.length>0)),(0,c.x)())}hasAnyCapabilityOf$(d,g="global"){const C=_.castArray(d);return this.capabilitiesForContext$(g).pipe((0,e.U)(y=>y.reduce((m,E)=>m||!!C.find(P=>E.action.href.endsWith(`/api/v3/actions/${P}`)),!1)),(0,c.x)())}setupLegacyDataListeners(){this.currentUserQuery.user$.subscribe(d=>this._user=d),this.currentUserQuery.isLoggedIn$.subscribe(d=>this._isLoggedIn=d)}get isLoggedIn(){return this._isLoggedIn}get userId(){return this._user.id||""}get name(){return this._user.name||""}get mail(){return this._user.mail||""}get href(){return`/api/v3/users/${this.userId}`}get language(){return I18n.locale||"en"}}p.\u0275fac=function(d){return new(d||p)(a.LFG(u.T),a.LFG(r.D),a.LFG(n.b))},p.\u0275prov=a.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})},52657:(H,D,t)=>{"use strict";t.d(D,{D:()=>r});var i=t(3786),e=t(19100),c=t(2316);let r=class extends e.yh{constructor(){super({id:null,name:null,mail:null,capabilities:null})}};r.\u0275fac=function(h){return new(h||r)},r.\u0275prov=c.Yz7({token:r,factory:r.\u0275fac}),r=(0,i.gn)([(0,e.yC)({name:"current-user"}),(0,i.w6)("design:paramtypes",[])],r)},70692:(H,D,t)=>{"use strict";t.d(D,{B:()=>n});var i=t(12877),e=t(96617),c=t(86035),r=t(2316);class n{constructor(a,p){this.configurationService=a,this.I18n=p,this.setupLocale()}setupLocale(){c.locale(I18n.locale)}parseDatetime(a,p){const l=c.utc(a,p);return this.configurationService.isTimezoneSet()&&(l.local(),l.tz(this.configurationService.timezone())),l}parseDate(a,p){return c(a,p)}parseISODatetime(a){return this.parseDatetime(a,"YYYY-MM-DDTHH:mm:ssZ")}parseISODate(a){return this.parseDate(a,"YYYY-MM-DD")}formattedDate(a){return this.parseDate(a).format(this.getDateFormat())}inThePast(a){return this.daysFromToday(a)<=-1}daysFromToday(a){const p=this.parseDate(a),l=c().startOf("day");return p.diff(l,"days")}formattedTime(a){return this.parseDatetime(a).format(this.getTimeFormat())}formattedDatetime(a){const p=this.formattedDatetimeComponents(a);return`${p[0]} ${p[1]}`}formattedRelativeDateTime(a){return this.parseDatetime(a).fromNow()}formattedDatetimeComponents(a){const p=this.parseDatetime(a);return[p.format(this.getDateFormat()),p.format(this.getTimeFormat())]}toHours(a){return Number(c.duration(a).asHours().toFixed(2))}formattedDuration(a){return this.I18n.t("js.units.hour",{count:this.toHours(a)})}formattedISODate(a){return this.parseDate(a).format("YYYY-MM-DD")}formattedISODateTime(a){return a.format()}isValidISODate(a){return this.isValid(a,"YYYY-MM-DD")}isValidISODateTime(a){return this.isValid(a,"YYYY-MM-DDTHH:mm:ssZ")}isValid(a,p){const l=p||this.getDateFormat();return c(a,[l],!0).isValid()}getDateFormat(){return this.configurationService.dateFormatPresent()?this.configurationService.dateFormat():"L"}getTimeFormat(){return this.configurationService.timeFormatPresent()?this.configurationService.timeFormat():"LT"}}n.\u0275fac=function(a){return new(a||n)(r.LFG(i.e),r.LFG(e.D))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})},24e3:(H,D,t)=>{"use strict";t.d(D,{j:()=>r});var i=t(54364);var u=t(2316);class r{constructor(h){this.documentElement=h,this._banners=!0,this._banners=h.body.classList.contains("ee-banners-visible")}get eeShowBanners(){return this._banners}getEnterPriseEditionUrl({referrer:h,hash:a}={}){const p=new URL("https://www.openproject.org/enterprise-edition/?op_edition=community-edition");return h&&p.searchParams.set("op_referrer",h),a&&(p.hash=a),p.toString()}conditional(h,a){this._banners?this.callMaybe(h):this.callMaybe(a)}callMaybe(h){h&&h()}}r.\u0275fac=function(h){return new(h||r)(u.LFG(i.K0))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})},48249:(H,D,t)=>{"use strict";t.d(D,{c:()=>d});var i=t(3786),e=t(53882),c=t(30400),u=t(81134),r=t(79902),n=t(91992),h=t(22464),p=t(76825),l=t(2316);class d extends p.r{uploadSingle(C,y,m="post",E="text"){return[y,(0,c.D)(this.getDirectUploadFormFrom(C,y)).pipe((0,r.w)(this.uploadToExternal(y,m,E)),(0,n.B)())]}uploadToExternal(C,y,m){return E=>(E.form.append("file",C,C.customName||C.name),this.http.request(y,E.url,{body:E.form,observe:"events",withCredentials:!1,responseType:m,reportProgress:!0}).pipe((0,r.w)(this.finishUpload(E))))}finishUpload(C){return y=>{var m,E,P;return y instanceof e.Zn?this.http.get(null===(P=null===(E=null===(m=C.response)||void 0===m?void 0:m._links)||void 0===E?void 0:E.completeUpload)||void 0===P?void 0:P.href,{observe:"response"}):(0,u.of)(y)}}getDirectUploadFormFrom(C,y){return(0,i.mG)(this,void 0,void 0,function*(){const m=y.customName||y.name,E=y.type||m&&(0,h.getType)(m)||"",P=new FormData,w={fileName:m,contentType:E,description:y.description,fileSize:y.size};P.append("metadata",JSON.stringify(w));const x=yield this.http.request("post",C,{body:P,withCredentials:!0,responseType:"json"}).toPromise(),k=new FormData;return _.each(x._links.addAttachment.form_fields,(b,v)=>{k.append(v,b)}),{form:k,url:x._links.addAttachment.href,response:x}})}}d.\u0275fac=function(){let g;return function(y){return(g||(g=l.n5z(d)))(y||d)}}(),d.\u0275prov=l.Yz7({token:d,factory:d.\u0275fac})},76825:(H,D,t)=>{"use strict";t.d(D,{r:()=>h});var i=t(53882),e=t(91992),c=t(9170),u=t(33927),r=t(91923),n=t(2316);class h{constructor(p,l){this.http=p,this.halResource=l}uploadAndMapResponse(p,l,d="post"){const{uploads:g,finished:C}=this.upload(p,l);return{uploads:g,finished:C.then(m=>m.map(E=>({response:E,uploadUrl:E.staticDownloadLocation.href})))}}upload(p,l,d="post"){l=_.filter(l,y=>"directory"!==y.type);const g=_.map(l,y=>this.uploadSingle(p,y,d));return{uploads:g,finished:this.whenFinished(g)}}uploadSingle(p,l,d="post",g="json"){const C=new FormData,y={description:l.description,fileName:l.customName||l.name};C.append("metadata",JSON.stringify(y)),C.append("file",l,y.fileName);return[l,this.http.request(d,p,{body:C,observe:"events",withCredentials:!0,responseType:g,reportProgress:!0}).pipe((0,e.B)())]}whenFinished(p){const l=p.map(([d,g])=>g.pipe((0,c.h)(C=>C.type===i.dt.Response),(0,u.U)(C=>this.halResource.createHalResource(C.body))).toPromise());return Promise.all(l)}}h.\u0275fac=function(p){return new(p||h)(n.LFG(i.eN),n.LFG(r.u))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac})},84032:(H,D,t)=>{"use strict";t.d(D,{U:()=>e});var i=t(2316);class e{get(...u){return _.get(window.gon,u,null)}get gon(){return window.gon}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})},57810:(H,D,t)=>{"use strict";t.d(D,{V:()=>u});var i=t(2316),e=t(71570);const c=" | ";class u{constructor(n){this.titleService=n}get current(){return this.titleService.getTitle()}get titleParts(){return this.current.split(c)}setFirstPart(n){const h=this.titleParts;h[0]=n,this.titleService.setTitle(h.join(c))}prependFirstPart(n){const h=this.titleParts;h.unshift(n),this.titleService.setTitle(h.join(c))}}u.\u0275fac=function(n){return new(n||u)(i.LFG(e.Dx))},u.\u0275prov=i.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})},96617:(H,D,t)=>{"use strict";t.d(D,{D:()=>e});var i=t(2316);class e{constructor(){this.i18n=window.I18n,this.t=this.i18n.t.bind(this.i18n),this.lookup=this.i18n.lookup.bind(this.i18n),this.toTime=this.i18n.toTime.bind(this.i18n),this.toNumber=this.i18n.toNumber.bind(this.i18n),this.toPercentage=this.i18n.toPercentage.bind(this.i18n),this.toCurrency=this.i18n.toCurrency.bind(this.i18n),this.strftime=this.i18n.strftime.bind(this.i18n),this.toHumanSize=this.i18n.toHumanSize.bind(this.i18n)}get locale(){return this.i18n.locale}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})},86469:(H,D,t)=>{"use strict";t.d(D,{xc:()=>r,RA:()=>n,vt:()=>a});var i=t(98636),e=t(2316);function r(p,l){return d=>(p.start(),d.pipe((0,i.b)(()=>p.delayedStop(l),()=>p.stop(),()=>p.stop())))}function n(p){return l=>(setTimeout(()=>p().start()),l.pipe((0,i.b)(()=>{},()=>p().stop(),()=>p().stop())))}class h{constructor(l){this.indicator=l,this.indicatorTemplate='<div class="loading-indicator--background">\n      <div class="loading-indicator">\n        <div class="block-1"></div>\n        <div class="block-2"></div>\n        <div class="block-3"></div>\n        <div class="block-4"></div>\n        <div class="block-5"></div>\n      </div>\n    </div>\n   '}set promise(l){this.start();const d=()=>this.delayedStop();l.then(d).catch(d)}start(){this.stop(),this.indicator.prepend(this.indicatorTemplate)}delayedStop(l=25){setTimeout(()=>this.stop(),l)}stop(){this.indicator.find(".loading-indicator--background").remove()}}class a{get table(){return this.indicator("table")}get wpDetails(){return this.indicator("wpDetails")}get modal(){return this.indicator("modal")}getter(l){return this.indicator.bind(this,l)}indicator(l){return"string"==typeof l&&(l=this.getIndicatorAt(l)),new h(l)}getIndicatorAt(l){return jQuery(".loading-indicator--location").filter(`[data-indicator-name="${l}"]`)}}a.\u0275fac=function(l){return new(l||a)},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})},83835:(H,D,t)=>{"use strict";t.d(D,{J:()=>a});var i=t(3786),e=t(76491),c=t(96617),u=t(65146),r=t(53916),n=t(29161),h=t(2316);class a{constructor(l,d,g){this.I18n=l,this.injector=d,this.deviceService=g,this.elementMinWidth=11,this.defaultWidth=230,this.localStorageKey="openProject-mainMenuWidth",this.localStorageStateKey="openProject-mainMenuCollapsed",this.global=window,this.htmlNode=document.getElementsByTagName("html")[0],this.mainMenu=jQuery("#main-menu")[0],this.hideElements=jQuery(".can-hide-navigation"),this.titleData=new e.X(""),this.titleData$=this.titleData.asObservable(),this.changeData=new e.X({}),this.changeData$=this.changeData.asObservable()}initializeMenu(){if(!this.mainMenu)return;this.elementWidth=parseInt(window.OpenProject.guardedLocalStorage(this.localStorageKey));const l=window.OpenProject.guardedLocalStorage(this.localStorageStateKey);this.elementWidth?l&&JSON.parse(l)?this.closeMenu():this.setWidth():this.saveWidth(this.mainMenu.offsetWidth);const d=this.injector.get(u.R);(jQuery(document.body).hasClass("controller-my")&&0===this.elementWidth||null===d.id)&&this.saveWidth(this.defaultWidth),this.closeWhenOnMobile()}toggleNavigation(l){if(l&&(l.stopPropagation(),l.preventDefault()),this.showNavigation)this.closeMenu();else if(this.deviceService.isMobile)this.setWidth(window.innerWidth);else{const d=parseInt(window.OpenProject.guardedLocalStorage(this.localStorageKey)),g=d>=this.elementMinWidth?d:this.defaultWidth;this.saveWidth(g)}setTimeout(()=>{jQuery('#main-menu [class*="-menu-item"]:visible').first().focus()},500)}closeMenu(){this.setWidth(0),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,"true"),jQuery(".searchable-menu--search-input").blur()}closeWhenOnMobile(){this.deviceService.isMobile&&(this.closeMenu(),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,"false"))}saveWidth(l){this.setWidth(l),window.OpenProject.guardedLocalStorage(this.localStorageKey,String(this.elementWidth)),window.OpenProject.guardedLocalStorage(this.localStorageStateKey,String(0===this.elementWidth))}setWidth(l){if(void 0!==l){const g=this.deviceService.isMobile?window.innerWidth-120:window.innerWidth-520;this.elementWidth=l>g?g:l}this.snapBack(),this.setToggleTitle(),this.toggleClassHidden(),this.global.showNavigation=this.showNavigation,this.htmlNode.style.setProperty("--main-menu-width",`${this.elementWidth}px`);const d=jQuery.Event("change");this.changeData.next(d)}get showNavigation(){return this.elementWidth>=this.elementMinWidth}snapBack(){this.elementWidth<this.elementMinWidth&&(this.elementWidth=0)}setToggleTitle(){this.showNavigation?this.toggleTitle=this.I18n.t("js.label_hide_project_menu"):this.toggleTitle=this.I18n.t("js.label_expand_project_menu"),this.titleData.next(this.toggleTitle)}toggleClassHidden(){this.hideElements.toggleClass("hidden-navigation",!this.showNavigation)}}a.\u0275fac=function(l){return new(l||a)(h.LFG(c.D),h.LFG(h.zs3),h.LFG(r.U))},a.\u0275prov=h.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),(0,i.gn)([(0,n.W)(),(0,i.w6)("design:type",u.R)],a.prototype,"currentProject",void 0)},7493:(H,D,t)=>{"use strict";t.d(D,{g:()=>u});var i=t(14808),e=t(22663),c=t(2316);class u{constructor(){this.links=(0,i.qH)({})}initModelAuth(n,h){this.links.doModify(a=>{const p=Object.assign({},a);return p[n]=h,p})}observeUntil(n){return this.links.values$().pipe((0,e.R)(n))}can(n,h){const a=this.links.getValueOr({});return a[n]&&h in a[n]}cannot(n,h){return!this.can(n,h)}}u.\u0275fac=function(n){return new(n||u)},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})},70233:(H,D,t)=>{"use strict";t.d(D,{j:()=>u});var i=t(26269);class e{constructor(n){this.apiV3Base=`${n}/api/v3`}get openApiSpecPath(){return`${this.apiV3Base}/spec.json`}previewMarkup(n){const h=`${this.apiV3Base}/render/markdown`;return n?`${h}?context=${n}`:h}principals(n,h){const a=new i.qM;return a.add("status","!",["3"]),a.add("member","=",[n.toString()]),a.add("type","=",["User","Group"]),a.add("id","!",["me"]),h&&h.length>0&&a.add("name","~",[h]),`${this.apiV3Base}/principals?${a.toParams({sortBy:'[["name","asc"]]',offset:"1",pageSize:"10"})}`}}var c=t(2316);class u{constructor(){this.appBasePath=window.appBasePath||"",this.api={v3:new e(this.appBasePath)}}get staticBase(){return this.appBasePath}attachmentDownloadPath(n,h){const a=`${this.staticBase}/attachments/${n}`;return h?`${a}/${h}`:a}attachmentContentPath(n){return`${this.staticBase}/attachments/${n}/content`}ifcModelsPath(n){return`${this.staticBase}/projects/${n}/ifc_models`}ifcModelsNewPath(n){return`${this.ifcModelsPath(n)}/new`}ifcModelsEditPath(n,h){return`${this.ifcModelsPath(n)}/${h}/edit`}ifcModelsDeletePath(n,h){return`${this.ifcModelsPath(n)}/${h}`}bimDetailsPath(n,h,a=null){let p=`${this.projectPath(n)}/bcf/details/${h}`;return null!==a&&(p+=`?query_props=%7B"t"%3A"id%3Adesc"%2C"dr"%3A"splitCards"%7D&viewpoint=${a}`),p}highlightingCssPath(){return`${this.staticBase}/highlighting/styles`}forumPath(n,h){return`${this.projectForumPath(n)}/${h}`}keyboardShortcutsHelpPath(){return`${this.staticBase}/help/keyboard_shortcuts`}messagePath(n){return`${this.staticBase}/topics/${n}`}myPagePath(){return`${this.staticBase}/my/page`}myNotificationsSettingsPath(){return`${this.staticBase}/my/notifications`}newsPath(n){return`${this.staticBase}/news/${n}`}notificationsPath(){return`${this.staticBase}/notifications`}loginPath(){return`${this.staticBase}/login`}projectsPath(){return`${this.staticBase}/projects`}projectPath(n){return`${this.projectsPath()}/${n}`}projectActivityPath(n){return`${this.projectPath(n)}/activity`}projectForumPath(n){return`${this.projectPath(n)}/forums`}projectCalendarPath(n){return`${this.projectPath(n)}/calendar`}projectMembershipsPath(n){return`${this.projectPath(n)}/members`}projectNewsPath(n){return`${this.projectPath(n)}/news`}projectTimeEntriesPath(n){return`${this.projectPath(n)}/cost_reports`}projectWikiPath(n){return`${this.projectPath(n)}/wiki`}projectWorkPackagePath(n,h){return`${this.projectWorkPackagesPath(n)}/${h}`}projectWorkPackagesPath(n){return`${this.projectPath(n)}/work_packages`}projectWorkPackageNewPath(n){return`${this.projectWorkPackagesPath(n)}/new`}projectBoardsPath(n){return n?`${this.projectPath(n)}/boards`:`${this.staticBase}/boards`}projectDashboardsPath(n){return`${this.projectPath(n)}/dashboards`}timeEntriesPath(n){const h="/time_entries";return n?this.workPackagePath(n)+h:this.staticBase+h}usersPath(){return`${this.staticBase}/users`}groupsPath(){return`${this.staticBase}/groups`}placeholderUsersPath(){return`${this.staticBase}/placeholder_users`}userPath(n){return`${this.usersPath()}/${n}`}placeholderUserPath(n){return`${this.placeholderUsersPath()}/${n}`}groupPath(n){return`${this.groupsPath()}/${n}`}rolesPath(){return`${this.staticBase}/roles`}rolePath(n){return`${this.rolesPath()}/${n}`}versionsPath(){return`${this.staticBase}/versions`}versionEditPath(n){return`${this.staticBase}/versions/${n}/edit`}versionShowPath(n){return`${this.staticBase}/versions/${n}`}workPackagesPath(){return`${this.staticBase}/work_packages`}workPackagePath(n){return`${this.staticBase}/work_packages/${n}`}workPackageCopyPath(n){return`${this.workPackagePath(n)}/copy`}workPackageDetailsCopyPath(n,h){return`${this.projectWorkPackagesPath(n)}/details/${h}/copy`}workPackagesBulkDeletePath(){return`${this.workPackagesPath()}/bulk`}projectLevelListPath(){return`${this.projectsPath()}/level_list.json`}textFormattingHelp(){return`${this.staticBase}/help/text_formatting`}}u.\u0275fac=function(n){return new(n||u)},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})},84732:(H,D,t)=>{"use strict";t.d(D,{p:()=>e});var i=t(2316);class e{constructor(){}get isEmpty(){return!this.name}setIfFirst(u,r){!this.isEmpty||!u||(this.name=u,this.params=r)}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac})},44022:(H,D,t)=>{"use strict";t.d(D,{y:()=>p});var i=t(79175),e=t(53466),c=t(87853),u=t(81531),r=t(91923),n=t(81923),h=t(80044),a=t(2316);class p extends i.r{constructor(d,g){super(d.schemas),this.states=d,this.halResourceService=g}state(d){return super.state(this.stateKey(d))}of(d){const g=this.state(d).value;if(!g)throw new Error(`Schema for resource ${d} was expected to be loaded but isn't.`);return"WorkPackage"===d._type?n.X.create(g,d):u.V.create(g,d)}getSchemaHref(d){var g;const C=null===(g=d.$links.schema)||void 0===g?void 0:g.href;if(!C)throw new Error(`Resource ${d} has no schema to load.`);return C}ensureLoaded(d){const g=d instanceof h.X?this.getSchemaHref(d):d;return this.requireAndStream(g).pipe((0,e.q)(1)).toPromise()}requireAndStream(d,g=!1){return(this.stale(d)||g)&&this.clearAndLoad(d,this.load(d)),this.state(d).values$()}load(d){return this.halResourceService.get(d).pipe((0,e.q)(1))}loadAll(d){return Promise.all(d.map(g=>this.load(g)))}update(d,g){this.multiState.get(this.stateKey(d)).putValue(g)}stateKey(d){return d instanceof h.X?this.getSchemaHref(d):d}}p.\u0275fac=function(d){return new(d||p)(a.LFG(c.G),a.LFG(r.u))},p.\u0275prov=a.Yz7({token:p,factory:p.\u0275fac})},80261:(H,D,t)=>{"use strict";t.d(D,{Z:()=>e});var i=t(3352);class e{static register(...u){this.optionalBoostrapComponents.push(...u)}static bootstrapOptionalDocument(u,r,n=this.optionalBoostrapComponents){this.performBootstrap(u,r,!1,n)}static bootstrapOptionalEmbeddable(u,r,n=this.optionalBoostrapComponents){Promise.resolve().then(()=>this.performBootstrap(u,r,!0,n))}static getEmbeddable(){return this.optionalBoostrapComponents.filter(u=>u.embeddable)}static performBootstrap(u,r,n,h){h.forEach(a=>{if(n&&!a.embeddable)return;const p=r.querySelectorAll(a.selector);for(let l=0;l<p.length;l++){const d=p[l];if(!n&&d.closest("[op-dynamic-bootstrap]"))return void(0,i.qu)(`Skipping nested bootstrap ${a.selector} in %O`,d);u.bootstrap(a.cls,d),d.setAttribute("op-dynamic-bootstrap","true")}})}}e.optionalBoostrapComponents=[]},57597:(H,D,t)=>{"use strict";t.d(D,{o:()=>u});var i=t(93993);function e(r){const n=jQuery(r.data.menu);r.target!==n.find(" > li.drop-down.open > ul").get(0)&&(n.find(" > li.drop-down.open").removeClass("open").find("> ul").slideUp(i.f),jQuery("html").off("click",e))}function u(r){r.find(" > li.drop-down").on("click",n=>{!function(r){const n=r.find(" > li.drop-down");n.hasClass("open")||(n.find("> ul").slideDown(i.f,()=>{n.find("li > a:first").focus(),jQuery("html").on("click",{menu:r.get(0)},e)}),n.addClass("open"))}(r);const h=jQuery(n.target);(h.is(".drop-down")||h.closest("li, ul").is(".drop-down"))&&n.preventDefault()})}},93993:(H,D,t)=>{"use strict";t.d(D,{f:()=>i,F:()=>e});const i=100;class e{constructor(u){this.menuContainer=u,this.hover=!1,this.menuIsOpen=!1,this.withHeadingFoldOutAtBorder(),this.setupDropdownClick(),this.registerEventHandlers(),this.closeOnBodyClick(),this.accessibility(),this.skipContentClickListener()}skipContentClickListener(){jQuery("#skip-navigation--content").on("click",()=>{const r=jQuery(".first-breadcrumb-element a, .toolbar-container a:first-of-type, #content a:first-of-type").not(":hidden").first();r.length&&r.trigger("focus")})}accessibility(){jQuery(".op-app-menu--dropdown").attr("aria-expanded","false")}toggleClick(u){this.menuIsOpen?this.isOpen(u)?this.closing():this.open(u):(this.opening(),this.open(u))}opening(){this.startHover(),this.menuIsOpen=!0,this.menuContainer.trigger("openedMenu",this.menuContainer)}closing(){this.stopHover(),this.closeAllItems(),this.menuIsOpen=!1,this.menuContainer.trigger("closedMenu",this.menuContainer)}stopHover(){this.hover=!1,this.menuContainer.removeClass("hover")}startHover(){this.hover=!0,this.menuContainer.addClass("hover")}closeAllItems(){this.openDropdowns().each((u,r)=>{this.close(jQuery(r))})}closeOnBodyClick(){const u=document.getElementById("wrapper");!u||u.addEventListener("click",r=>{this.menuIsOpen&&!this.openDropdowns()[0].contains(r.target)&&this.closing()},!0)}openDropdowns(){return this.menuContainer.find(".op-app-menu--item_dropdown-open")}dropdowns(){return this.menuContainer.find(".op-app-menu--item_has-dropdown")}withHeadingFoldOutAtBorder(){var u,r;let n;const h=this.menuContainer.next(),a=this.menuContainer.next().children().next().first();"H2"===(null===(u=h.get(0))||void 0===u?void 0:u.tagName)?(n=this.menuContainer.next().innerHeight()+this.menuContainer.next().position().top,this.menuContainer.find(".op-app-menu--body").css({top:n})):this.menuContainer.next().hasClass("wiki-content")&&"H1"===(null===(r=a.get(0))||void 0===r?void 0:r.tagName)&&(n=a.innerHeight()+a.position().top,this.menuContainer.find(".op-app-menu--body").css({top:n}))}setupDropdownClick(){this.dropdowns().each((u,r)=>{jQuery(r).find(".op-app-menu--item-action").click(()=>(this.toggleClick(jQuery(r)),!1)),jQuery(r).find("op-app-menu--item-action").on("touchstart",n=>!!jQuery(n.target).closest(".op-app-menu--body").length||(n.preventDefault(),jQuery(r).click(),!1))})}isOpen(u){return 1===u.filter(".op-app-menu--item_dropdown-open").length}isClosed(u){return!this.isOpen(u)}open(u){this.dontCloseWhenUsing(u),this.closeOtherItems(u),this.slideAndFocus(u,()=>{u.trigger("opened",u)})}close(u,r){this.slideUp(u,r),u.trigger("closed",u)}closeOtherItems(u){this.openDropdowns().each((r,n)=>{jQuery(n)!==jQuery(u)&&this.close(jQuery(n),!0)})}dontCloseWhenUsing(u){jQuery(u).find("li").click(r=>{r.stopPropagation()}),jQuery(u).bind("mousedown mouseup click",r=>{r.stopPropagation()})}slideAndFocus(u,r){this.slideDown(u,r),setTimeout(()=>this.focusFirstInputOrLink(u),i)}slideDown(u,r){const n=u.find(".op-app-menu--dropdown");u.addClass("op-app-menu--item_dropdown-open"),n.slideDown(i,r).attr("aria-expanded","true")}slideUp(u,r){const n=jQuery(u).find(".op-app-menu--dropdown");u.removeClass("op-app-menu--item_dropdown-open"),r?n.hide():n.slideUp(i),n.attr("aria-expanded","false")}focusFirstInputOrLink(u){const n=u.find(".op-app-menu--dropdown").find('input:not([disabled]):not([type="hidden"]), a[href], area[href], select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]')[0];!n||(n.blur(),setTimeout(()=>{n.focus()},10))}registerEventHandlers(){const u=jQuery("#main-menu-toggle");this.menuContainer.on("closeDropDown",r=>{this.close(jQuery(r.target))}).on("openDropDown",r=>{this.open(jQuery(r.target))}).on("closeMenu",()=>{this.closing()}).on("openMenu",()=>{this.open(this.dropdowns().first()),this.opening()}),u.on("click",()=>{this.closing()})}}},12630:(H,D,t)=>{"use strict";t.d(D,{RO:()=>i,wh:()=>e,PI:()=>c,vV:()=>u,br:()=>r,Lt:()=>n,vx:()=>h});const i="Demo project",e="Scrum project",c="openProject-onboardingTour";var u,a;function r(a,p,l){new MutationObserver((g,C)=>{jQuery(a).length&&(C.disconnect(),l())}).observe(jQuery(p)[0],{childList:!0,subtree:!0})}function n(){const a=[],p=jQuery(`.widget-box.welcome a:contains(${i})`),l=jQuery(`.widget-box.welcome a:contains(${e})`);return p.length&&a.push(p),l.length&&a.push(l),a}function h(a){a.preventDefault(),a.stopPropagation()}(a=u||(u={})).demo="demo",a.scrum="scrum"},83531:()=>{var H;(H=jQuery)(()=>{H("[data-selected-page]").closest(".tree-menu--container").each((t,i)=>{const e=H(i).data("selected-page");if(e){const c=H(`[slug="${e}"]`,i);c.toggleClass("-selected",!0),c.length>0&&c[0].scrollIntoView()}}),H(".pages-hierarchy.-with-hierarchy .tree-menu--hierarchy-span").on("click keypress",function(t){return"keypress"===t.type&&13!==t.which||H(t.target).closest("ul.-with-hierarchy > li").toggleClass("-hierarchy-collapsed -hierarchy-expanded"),!1})})},47281:(H,D,t)=>{"use strict";t.r(D);t(58256),t(80261);function r(ye){window.OpenProject.getPluginContext().then(Ce=>{const{opModalService:ke}=Ce.services,Ae=Ce.classes.modals.passwordConfirmation;ye(document).on("submit","form[data-request-for-confirmation]",function(Fe){const ot=jQuery(this);return!!ot.find('input[name="_password_confirmation"]').length||function(ye,Ce,ke,Ae){return ye.find("_password_confirmation").length>0||(Ce.preventDefault(),ke.show(Ae,"global").closingEvent.subscribe(it=>{it.confirmed&&(jQuery("<input>").attr({type:"hidden",name:"_password_confirmation",value:it.password_confirmation}).appendTo(ye),ye.trigger("submit"))}),!1)}(ot,Fe,ke,Ae)})}).catch(()=>{})}var n=t(53916);function a(ye,Ce){const ke="fieldset-toggle-state-label";let Ae=ye.find(`a span.${ke}`);const Fe=ye.children("a");0===Ae.length&&(Ae=jQuery("<span />").addClass(ke).addClass("hidden-for-sighted"),Fe.append(Ae)),Ae.text(` ${Ce}`)}function p(ye){const Ce=ye.children("legend");ye.hasClass("collapsed")?a(Ce,I18n.t("js.label_collapsed")):a(Ce,I18n.t("js.label_expanded"))}function l(ye){const Ce=jQuery(ye);if(Ce.is("legend"))return jQuery(ye).parent();if(Ce.is("fieldset"))return Ce;throw new Error("Cannot derive fieldset from element!")}function g(){const ye=jQuery("fieldset.form--fieldset.-collapsible");ye.on("click",".form--fieldset-legend",function(Ce){return function(ye){const Ce=l(ye);Ce.attr("data-touched","true");const ke=Ce.find("> div").not(".form--toolbar");Ce.toggleClass("collapsed"),ke.slideToggle("fast"),p(Ce)}(this),Ce.preventDefault(),Ce.stopPropagation(),!1}),ye.each(function(){const Ce=l(this),ke=Ce.find("> div");Ce.hasClass("collapsed")&&ke.hide(),p(Ce)})}var C=t(93993),y=t(57597);function P(){(function(){const ye=jQuery("#wrapper"),Ce=jQuery("ul.menu_root.closed li.open a.arrow-left-to-project");1===Ce.length&&ye.hasClass("hidden-navigation")&&Ce.trigger("click")})(),jQuery("span.errorSpan").first().find("*").filter(":input").trigger("focus"),M(),S(),setTimeout(()=>{jQuery(".flash.autohide-toaster").remove()},5e3),jQuery("body").on("click keydown touchend",".close-handler,.op-toast--close",function(ye){("click"===ye.type||13===ye.which)&&jQuery(this).parent(".flash, .errorExplanation, .op-toast").not(".persistent-toggle--notification").remove()}),jQuery(document).ajaxComplete(M),jQuery(document).ajaxComplete(S),jQuery(document).ajaxSend((Ae,Fe)=>{jQuery(Ae.target.activeElement).closest("[ajax-indicated]").length&&jQuery("ajax-indicator")&&jQuery("#ajax-indicator").show();const ot=jQuery("meta[name=csrf-token]");if(ot){const it="X-CSRF-Token",Ve=ot.attr("content");Fe.setRequestHeader(it,Ve)}Fe.setRequestHeader("X-Authentication-Scheme","Session")}),jQuery(document).ajaxStop(()=>{jQuery("#ajax-indicator")&&jQuery("#ajax-indicator").hide(),k()}),jQuery(".attachments h4").click(function(){jQuery(this).toggleClass("closed").next().slideToggle(100)});let ye=null;jQuery(window).on("resize",()=>{ye&&clearTimeout(ye),ye=setTimeout(()=>{jQuery(window).trigger("resizeEnd")},200)}),jQuery("#nav-login-content").click(Ae=>{Ae.stopPropagation()});const Ce=jQuery("a.afocus").first(),ke=jQuery(".autofocus").first();void 0!==Ce?Ce.focus():void 0!==ke&&(ke.focus(),"INPUT"===ke[0].tagName&&ke.select()),k(),jQuery(document.body).on("click",".formatting-help-link-button",()=>(window.open(`${window.appBasePath}/help/wiki_syntax`,"","resizable=yes, location=no, width=600, height=640, menubar=no, status=no, scrollbars=yes"),!1))}function k(){jQuery("a.afocus").each(function(){const ye=jQuery(this);ye.click(Ce=>{let ke=jQuery(`#${ye.attr("href").substr(1)}`);return null===ke&&(ke=jQuery(`#${ye.attr("href").substr(1).concat("_id")}`)),ye.unbind(Ce),!1})})}function v(ye){jQuery(ye).each((ke,Ae)=>{jQuery(Ae).show()})}function M(){v(".flash")}function S(){v('.errorExplanation[role="alert"]')}var F=t(3786),I=t(12630),J=t(3352);function N(ye,Ce){return(0,F.mG)(this,void 0,void 0,function*(){(0,J.qu)(`Loading and triggering onboarding tour ${ye}`),yield t.e("src_app_core_setup_globals_onboarding_onboarding_tour_ts").then(t.bind(t,36243)).then(ke=>{ke.start(ye,Ce)})})}var ye,ee=t(14882);(ye=jQuery)(()=>{ye(document.documentElement).on("click",Ae=>{const Fe=jQuery(Ae.target);return function(ye,Ce){Ce.hasClass("-augmented-datepicker")&&(Ce.attr("autocomplete","off"),window.OpenProject.getPluginContext().then(ke=>{new ee.M(".-augmented-datepicker",Ce.val(),{weekNumbers:!0,allowInput:!0},Ce[0],ke.services.configurationService).show()}).catch(()=>{}))}(0,Fe),function(ye,Ce){document.contains(ye.target)||ye.preventDefault();const ke=Ce.closest("a");if(0===ke.length)return;const Ae=ke.attr("href")||"",Fe=Ae.indexOf("#");""!==Ae&&0!==Fe||(-1!==Fe&&"#"!==Ae&&(window.location.hash=Ae),ye.preventDefault())}(Ae,Fe),!0});const{hash:Ce}=window.location;if(Ce&&Ce.startsWith("#"))try{const Ae=document.querySelector(Ce);Ae&&Ae.scrollIntoView()}catch(Ae){console.log(`Could not scroll to given location hash: ${Ce} ( ${Ae.message})`)}if(ye(document).on("submit","form",()=>{window.OpenProject.pageIsSubmitted=!0}),document.querySelector(".warning-bar--item")){const Ae=document.querySelector("#content");Ae&&(Ae.style.marginBottom="100px")}ye(window).on("beforeunload",Ae=>{const Fe=Ae.originalEvent;window.OpenProject.pageWasEdited&&!window.OpenProject.pageIsSubmitted&&(Fe.preventDefault(),Fe.returnValue=I18n.t("js.work_packages.confirm_edit_cancel"))}),ye(document.documentElement).on("dragover drop",Ae=>(Ae.preventDefault(),!1)),function(){const ye=document.querySelectorAll(".augment--refresh-on-form-changes");for(let Ce=0;Ce<ye.length;Ce++){const ke=ye[Ce],Ae=jQuery(ke),Fe=Ae.data("refreshUrl"),ot=Ae.data("inputSelector");Ae.find(ot).on("change",()=>{window.location.href=`${Fe}?${Ae.serialize()}`})}}(),r(ye),(new n.U).isMobile&&function(){let Ce=window.scrollY;window.addEventListener("scroll",()=>{const ke=window.scrollY<0?0:window.scrollY;!jQuery("#main").hasClass("hidden-navigation")||jQuery(".op-app-header").hasClass("op-app-header_search-open")||Math.abs(ke-Ce)<=55||(void 0!==Ce&&void 0!==ke&&Ce>ke?jQuery("#wrapper").removeClass("_header-scrolled"):jQuery("#wrapper").addClass("_header-scrolled"),Ce=ke)})}(),function(){const ye=new URL(window.location.href),Ce=document.body.classList.contains("-browser-mobile"),ke="true"===jQuery("meta[name=demo_projects_available]").attr("content");let Ae=sessionStorage.getItem(I.PI),Fe=!1;!Ce&&ke&&(ye.searchParams.get("first_time_user")&&2===(0,I.Lt)().length&&(Ae="",sessionStorage.setItem(I.PI,"readyToStart"),(0,I.br)(".onboarding-modal .op-modal--close-button","body",()=>{jQuery(".op-modal--close-button").click(()=>{Fe=!0,N("homescreen")})}),document.addEventListener("keydown",ot=>{"Escape"===ot.key&&!Fe&&(Fe=!0,N("homescreen"))},{once:!0})),"readyToStart"===Ae&&N("homescreen"),("startMainTourFromBacklogs"===Ae||ye.searchParams.get("start_onboarding_tour"))&&N("main","startMainTourFromBacklogs"===Ae?I.vV.scrum:I.vV.demo),ye.searchParams.get("start_scrum_onboarding_tour")&&(jQuery(".backlogs-menu-item").length>0?N("prepareBacklogs",I.vV.scrum):N("taskboard",I.vV.scrum)),"prepareTaskBoardTour"===Ae&&N("backlogs",I.vV.scrum),"startTaskBoardTour"===Ae&&N("taskboard",I.vV.scrum))}(),g(),new C.F(jQuery(".op-app-header")),jQuery(".project-actions, .toolbar-items").each((Ae,Fe)=>{(0,y.o)(jQuery(Fe))}),function(){jQuery("#settings_session_ttl_enabled").on("change",function(){jQuery("#settings_session_ttl_container").toggle(jQuery(this).is(":checked"))}).trigger("change"),jQuery('[name="settings[enabled_scm][]"]').change(function(){const Ce=!this.checked,ke=this.value,Ae=jQuery("#settings_repositories_automatic_managed_vendor"),Fe=Ae.find(`option[value="${ke}"]`);0!==Fe.length&&(Fe.prop("disabled",Ce),Ce&&Fe.prop("selected")&&Ae.val(""))});const ye=function(Ce){const ke=jQuery(Ce),Ae=ke.attr("id")||"",Fe=Ae.replace("lang-for-",""),ot=ke.val(),it=jQuery(`#settings-${Fe}`),Ve=it.siblings("ckeditor-augmented-textarea").data("editor");return{id:Ae,settingName:Fe,newLang:ot,textArea:it,editor:Ve}};jQuery(".lang-select-switch").focus(function(){const Ce=ye(this);jQuery(`#${Ce.id}-${Ce.newLang}`).val(Ce.editor.getData())}).change(function(){const Ce=ye(this),ke=jQuery(`#${Ce.id}-${Ce.newLang}`).val();Ce.editor.setData(ke),Ce.textArea.attr("name",`settings[${Ce.settingName}][${Ce.newLang}]`)}),jQuery(".admin-settings--form").submit(()=>(jQuery("#settings_consent_required").is(":checked")&&jQuery("#toggle_consent_time").is(":checked")&&jQuery("#settings_consent_time").val((new Date).toISOString()).prop("disabled",!1),!0)),jQuery("#email_delivery_method_switch").on("change",function(){const Ce=jQuery(this).val();jQuery(".email_delivery_method_settings").hide(),jQuery(`#email_delivery_method_${Ce}`).show()}).trigger("change"),jQuery("#settings_smtp_authentication").on("change",function(){const Ce="none"===jQuery(this).val();jQuery("#settings_smtp_user_name,#settings_smtp_password").closest(".form--field").toggle(!Ce)}),jQuery(".settings-repositories--checkout-toggle").change(function(){const Ce=this.checked;jQuery(this).closest("fieldset").find("input,select").filter(":not([type=checkbox])").filter(":not([type=hidden])").removeAttr("required").prop("required",Ce)}),jQuery(".settings--highlighting-mode select").change(function(){const Ce=jQuery(this).val();jQuery(".settings--highlighted-attributes").toggle("inline"===Ce)}),0===jQuery(".settings--highlighted-attributes input[type='checkbox']:checked").length&&jQuery(".settings--highlighted-attributes input[type='checkbox']").prop("checked",!0),jQuery("#tab-content-work_packages form").submit(()=>{const Ce=jQuery(".settings--highlighted-attributes input[type='checkbox']");jQuery(".settings--highlighted-attributes input[type='checkbox']:checked").length===Ce.length&&Ce.prop("checked",!1)})}(),jQuery(".color--preview").each(function(){const ye=jQuery(this);let Ce;const ke=ye.data("target");if(Ce=ke?jQuery(ke):ye.next("input"),0===Ce.length)return;const Ae=function(){let Fe="";Ce.val()&&Ce.val().length>0?Fe=Ce.val():Ce.attr("placeholder")&&Ce.attr("placeholder").length>0&&(Fe=Ce.attr("placeholder")),ye.css("background-color",Fe)};Ce.keyup(Ae).change(Ae).focus(Ae),Ae()}),function(){const ye=jQuery(".danger-zone--verification"),Ce=jQuery(".danger-zone--expected-value").text();ye.find("input").on("input",()=>{const ke=ye.find("input").val();Ce.toLowerCase()===ke.toLowerCase()?ye.find("button").prop("disabled",!1):ye.find("button").prop("disabled",!0)})}(),P()});var me=t(14808),_e=t(53466);class he{checkAll(Ce,ke){document.querySelectorAll(`#${Ce} input[type="checkbox"]:not([disabled])`).forEach(Ae=>Ae.checked=ke)}toggleCheckboxesBySelector(Ce){const ke=jQuery(Ce);let Ae=!0;for(let Fe=0;Fe<ke.length;Fe++)!1===ke[Fe].checked&&(Ae=!1);for(let Fe=0;Fe<ke.length;Fe++)ke[Fe].checked=!Ae}}window.OpenProject=new class{constructor(){this.pluginContext=(0,me.qH)(),this.helpers=new he,this.pageWasEdited=!1,this.pageIsSubmitted=!1}getPluginContext(){return this.pluginContext.values$().pipe((0,_e.q)(1)).toPromise()}get urlRoot(){return jQuery("meta[name=app_base_path]").attr("content")||""}get environment(){return jQuery("meta[name=openproject_initializer]").data("environment")}get edition(){return jQuery("meta[name=openproject_initializer]").data("edition")}get isStandardEdition(){return"standard"===this.edition}get isBimEdition(){return"bim"===this.edition}guardedLocalStorage(Ce,ke){try{if(void 0===ke){const Ae=window.localStorage.getItem(Ce);return null===Ae?void 0:Ae}window.localStorage.setItem(Ce,ke)}catch(Ae){console.error("Failed to access your browsers local storage. Is your local database corrupted?")}}};t(83531)},50725:(H,D,t)=>{t(30121),t(67285),t(5222),t(47939),t(20302),t(84906),t(84236),t(76213),t(89265),t(80146),t(25978),t(78915),t(96024),t(84818),t(83305),t(14540),t(66732),t(56192),t(77729),t(39541),t(41250),t(12305),t(32198),t(95321)},60419:(H,D,t)=>{"use strict";t.d(D,{b:()=>u});var i=t(79441),e=t(43155),c=t(2316);class u{constructor(){this.actions=new i.xQ,this.actions$=this.actions.asObservable()}ofType(n){return this.actions$.pipe((0,e.l)(n))}dispatch(n){this.actions.next(n)}}u.\u0275fac=function(n){return new(n||u)},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"})},29351:(H,D,t)=>{"use strict";t.d(D,{v:()=>w});var i=t(53882),e=t(19100),c=t(30400),u=t(98636),r=t(18293),n=t(33927),h=t(3786),a=t(96725);let p=class extends e.cf{constructor(){super((0,a.cq)())}};p=(0,h.gn)([(0,e.yC)({name:"attachments"}),(0,h.w6)("design:paramtypes",[])],p);var l=t(36293),d=t(76825),g=t(48249),C=t(96617),y=t(20979),m=t(84699),E=t(12877),P=t(2316);class w{constructor(k,b,v,M,S,O,A){this.I18n=k,this.http=b,this.apiV3Service=v,this.fileUploadService=M,this.directFileUploadService=S,this.configurationService=O,this.toastService=A,this.store=new p,this.query=new e.Gv(this.store)}requireCollection(k){this.store.getValue().collections[k]||this.fetchAttachments(k).subscribe()}fetchAttachments(k){return this.http.get(k).pipe((0,u.b)(b=>(0,a.V7)(this.store,b,k)),(0,r.K)(b=>{throw this.toastService.addError(b),b}))}removeAttachment(k,b){const v=new i.WM({"Content-Type":"application/json"});return this.http.delete(b._links.delete.href,{withCredentials:!0,headers:v}).pipe((0,u.b)(()=>{(0,e.Y0)(()=>{this.store.remove(b.id),this.store.update(({collections:M})=>{var S;return{collections:Object.assign(Object.assign({},M),{[k]:Object.assign(Object.assign({},M[k]),{ids:((null===(S=M[k])||void 0===S?void 0:S.ids)||[]).filter(O=>O!==b.id)})})}})})}),(0,r.K)(M=>{throw this.toastService.addError(M),M}))}attachFiles(k,b){const v=this.getAttachmentsSelfLink(k)||m.m,M=this.getUploadTarget(k),S=!!this.getDirectUploadLink(k);return this.addAttachments(v,M,b,S)}addAttachments(k,b,v,M=!1){return this.uploadAttachments(b,v,M).pipe((0,u.b)(S=>{(0,e.Y0)(()=>{this.store.add(S),this.store.update(({collections:O})=>{var A;return{collections:Object.assign(Object.assign({},O),{[k]:Object.assign(Object.assign({},O[k]),{ids:((null===(A=O[k])||void 0===A?void 0:A.ids)||[]).concat(S.map(F=>F.id))})})}})})}))}uploadAttachments(k,b,v){const{uploads:M,finished:S}=v?this.directFileUploadService.uploadAndMapResponse(k,b):this.fileUploadService.uploadAndMapResponse(k,b),O=this.I18n.t("js.label_upload_notification"),A=this.toastService.addAttachmentUpload(O,M);return(0,c.D)(S).pipe((0,u.b)(()=>{setTimeout(()=>this.toastService.remove(A),700)}),(0,n.U)(F=>F.map(({response:I})=>I.$source)),(0,r.K)(F=>{throw this.toastService.addError(F),F}))}getUploadTarget(k){return this.getDirectUploadLink(k)||this.getAttachmentsSelfLink(k)||this.apiV3Service.attachments.path}getDirectUploadLink(k){const b=k.$links;return b.prepareAttachment?b.prepareAttachment.href:(0,m.Z)(k)?this.configurationService.prepareAttachmentURL:null}getAttachmentsSelfLink(k){const b=k.attachments;return(null==b?void 0:b.href)||null}}w.\u0275fac=function(k){return new(k||w)(P.LFG(C.D),P.LFG(i.eN),P.LFG(y.T),P.LFG(d.r),P.LFG(g.c),P.LFG(E.e),P.LFG(l.kl))},w.\u0275prov=P.Yz7({token:w,factory:w.\u0275fac})},92054:(H,D,t)=>{"use strict";t.d(D,{a:()=>g});var i=t(98636),e=t(18293),c=t(20979),u=t(36293),r=t(96725),n=t(3786),h=t(19100);let a=class extends h.cf{constructor(){super((0,r.cq)())}};a=(0,n.gn)([(0,h.yC)({name:"capabilities"}),(0,n.w6)("design:paramtypes",[])],a);class p extends h.Gv{}var l=t(2316),d=t(53882);class g{constructor(y,m,E){this.http=y,this.apiV3Service=m,this.toastService=E,this.store=new a,this.query=new p(this.store)}get capabilitiesPath(){return this.apiV3Service.capabilities.path}fetchCapabilities(y){const m=(0,r.ZU)(y);return this.http.get(this.capabilitiesPath+m).pipe((0,i.b)(E=>(0,r.V7)(this.store,E,m)),(0,e.K)(E=>{throw this.toastService.addError(E),E}))}update(y,m){this.store.update(y,m)}}g.\u0275fac=function(y){return new(y||g)(l.LFG(d.eN),l.LFG(c.T),l.LFG(u.kl))},g.\u0275prov=l.Yz7({token:g,factory:g.\u0275fac})},96725:(H,D,t)=>{"use strict";t.d(D,{n:()=>u,cq:()=>r,ZU:()=>n,mw:()=>h,tD:()=>a,wH:()=>p,V7:()=>l});var i=t(19100),e=t(73726),c=t(9170);function u(d){return{ids:d._embedded.elements.map(g=>g.id)}}function r(){return{collections:{}}}function n(d){return(0,e.g)(d)}function h(d,g){return d.query.select(C=>{const y=n(g);return null==C?void 0:C.collections[y]}).pipe((0,c.h)(C=>!!C))}function a(d,g){return((null==g?void 0:g.ids)||[]).map(y=>d.query.getEntity(y)).filter(y=>!!y)}function p(d,g){const C=d.query.getValue(),y=n(g);return a(d,C.collections[y])}function l(d,g,C){const{elements:y}=g._embedded,m=(null==y?void 0:y.map(E=>E.id))||[];(0,i.Y0)(()=>{y&&y.length>0&&d.upsertMany(g._embedded.elements),d.update(({collections:E})=>({collections:Object.assign(Object.assign({},E),{[C]:{ids:m}})}))})}},44838:(H,D,t)=>{"use strict";t.d(D,{b:()=>n,B:()=>h});t(43887);var c=t(3352),u=t(18511);const r=Symbol("EffectHandlers");function n(a){return class extends a{constructor(...p){super(...p),this.serviceDestroyed=!1;const l=a.prototype[r];l&&l.forEach((d,g)=>{(0,c.qu)(`[${a.name}] Subscribing to effect ${g}`),this.actions$.ofType(d.action).pipe((0,u.o)(()=>!this.serviceDestroyed)).subscribe(C=>{try{d.callback.call(this,C)}catch(y){console.error(`Error thrown in effect callback ${g}: ${y}`)}})})}ngOnDestroy(){this.serviceDestroyed=!0,super.ngOnDestroy&&super.ngOnDestroy()}}}function h(a){return(p,l,d)=>{const g=p;g[r]||(g[r]=new Map),g[r].set(l,{action:a,callback:d.value})}}},24782:(H,D,t)=>{"use strict";t.d(D,{Z:()=>i});const i=100},78509:(H,D,t)=>{"use strict";t.d(D,{L5:()=>e,A6:()=>c,vw:()=>u,$v:()=>r});var i=t(87916);const e=(0,i.aD)("[IAN] Mark notifications as read",(0,i.NQ)()),c=(0,i.aD)("[IAN] Notifications were marked as read",(0,i.NQ)()),u=(0,i.aD)("[IAN] The backend sent a notification count that was higher than the last known",(0,i.NQ)()),r=(0,i.aD)("[IAN] The notification center updated the notification list without a full page refresh",(0,i.NQ)())},97542:(H,D,t)=>{"use strict";t.d(D,{W:()=>m});var i=t(3786),e=t(98636),c=t(18293),u=t(20979),r=t(36293),n=t(53882),h=t(19100);class a extends h.Gv{}var p=t(96725),l=t(78509),d=t(44838),g=t(60419);let C=class extends h.cf{constructor(){super((0,p.cq)())}};C=(0,i.gn)([(0,h.yC)({name:"in-app-notifications"}),(0,i.w6)("design:paramtypes",[])],C);var y=t(2316);let m=class{constructor(P,w,x,k){this.actions$=P,this.http=w,this.apiV3Service=x,this.toastService=k,this.store=new C,this.query=new a(this.store)}get notificationsPath(){return this.apiV3Service.notifications.path}fetchNotifications(P){const w=(0,p.ZU)(P);return this.http.get(this.notificationsPath+w).pipe((0,e.b)(x=>(0,p.V7)(this.store,x,w)),(0,c.K)(x=>{throw this.toastService.addError(x),x}))}update(P,w){this.store.update(P,w)}modifyCollection(P,w){const x=(0,p.ZU)(P);this.store.update(({collections:k})=>{var b;return{collections:Object.assign(Object.assign({},k),{[x]:Object.assign(Object.assign({},k[x]),{ids:[...w((null===(b=k[x])||void 0===b?void 0:b.ids)||[])]})})}})}removeFromCollection(P,w){const x=(0,p.ZU)(P);this.store.update(({collections:k})=>{var b;return{collections:Object.assign(Object.assign({},k),{[x]:Object.assign(Object.assign({},k[x]),{ids:((null===(b=k[x])||void 0===b?void 0:b.ids)||[]).filter(v=>!w.includes(v))})})}})}markAsRead(P){return this.apiV3Service.notifications.markRead(P).pipe((0,e.b)(()=>{this.store.update(P,{readIAN:!0})}))}markNotificationsAsRead(P){this.markAsRead(P.notifications).subscribe(()=>this.actions$.dispatch((0,l.A6)(P)))}};m.\u0275fac=function(P){return new(P||m)(y.LFG(g.b),y.LFG(n.eN),y.LFG(u.T),y.LFG(r.kl))},m.\u0275prov=y.Yz7({token:m,factory:m.\u0275fac}),(0,i.gn)([(0,d.B)(l.L5),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0]),(0,i.w6)("design:returntype",void 0)],m.prototype,"markNotificationsAsRead",null),m=(0,i.gn)([d.b,(0,i.w6)("design:paramtypes",[g.b,n.eN,u.T,r.kl])],m)},32042:(H,D,t)=>{"use strict";t.d(D,{P:()=>y});var i=t(3786),e=t(98636),c=t(18293),u=t(19100),r=t(20979),n=t(36293),h=t(53882);class a extends u.Gv{byIds(E){return this.selectMany(E)}}var p=t(96725),l=t(44838),d=t(60419);let g=class extends u.cf{constructor(){super((0,p.cq)())}};g=(0,i.gn)([(0,u.yC)({name:"principals"}),(0,i.w6)("design:paramtypes",[])],g);var C=t(2316);let y=class{constructor(E,P,w,x){this.actions$=E,this.http=P,this.apiV3Service=w,this.toastService=x,this.store=new g,this.query=new a(this.store)}get principalsPath(){return this.apiV3Service.principals.path}fetchUser(E){return this.http.get(this.apiV3Service.users.id(E).path).pipe((0,e.b)(P=>{(0,u.Y0)(()=>{this.store.upsertMany([P])})}),(0,c.K)(P=>{throw this.toastService.addError(P),P}))}fetchPrincipals(E){const P=(0,p.ZU)(E);return this.http.get(this.principalsPath+P).pipe((0,e.b)(w=>(0,p.V7)(this.store,w,P)),(0,c.K)(w=>{throw this.toastService.addError(w),w}))}update(E,P){this.store.update(E,P)}modifyCollection(E,P){const w=(0,p.ZU)(E);this.store.update(({collections:x})=>{var k;return{collections:Object.assign(Object.assign({},x),{[w]:Object.assign(Object.assign({},x[w]),{ids:[...P((null===(k=x[w])||void 0===k?void 0:k.ids)||[])]})})}})}removeFromCollection(E,P){const w=(0,p.ZU)(E);this.store.update(({collections:x})=>{var k;return{collections:Object.assign(Object.assign({},x),{[w]:Object.assign(Object.assign({},x[w]),{ids:((null===(k=x[w])||void 0===k?void 0:k.ids)||[]).filter(b=>!P.includes(b))})})}})}};y.\u0275fac=function(E){return new(E||y)(C.LFG(d.b),C.LFG(h.eN),C.LFG(r.T),C.LFG(n.kl))},y.\u0275prov=C.Yz7({token:y,factory:y.\u0275fac}),y=(0,i.gn)([l.b,(0,i.w6)("design:paramtypes",[d.b,h.eN,r.T,n.kl])],y)},84272:(H,D,t)=>{"use strict";t.d(D,{s:()=>m});var i=t(3786),e=t(98636),c=t(18293),u=t(19100),r=t(36293),n=t(53882),h=t(96725),a=t(44838),p=t(60419);let l=class extends u.cf{constructor(){super((0,h.cq)())}};l=(0,i.gn)([(0,u.yC)({name:"views"}),(0,i.w6)("design:paramtypes",[])],l);class d extends u.Gv{}var g=t(20979),C=t(18217),y=t(2316);let m=class{constructor(P,w,x,k){this.actions$=P,this.http=w,this.apiV3Service=x,this.toastService=k,this.store=new l,this.query=new d(this.store)}get viewsPath(){return this.apiV3Service.views.path}fetchViews(P){const w=(0,h.ZU)(P);return this.http.get((0,C.Y)(this.viewsPath+w,{pageSize:"-1"})).pipe((0,e.b)(x=>{(0,u.Y0)(()=>{this.store.upsertMany(x._embedded.elements),this.store.update(({collections:k})=>({collections:Object.assign(Object.assign({},k),{[w]:Object.assign(Object.assign({},k[w]),{ids:x._embedded.elements.map(b=>b.id)})})}))})}),(0,c.K)(x=>{throw this.toastService.addError(x),x}))}update(P,w){this.store.update(P,w)}modifyCollection(P,w){const x=(0,h.ZU)(P);this.store.update(({collections:k})=>{var b;return{collections:Object.assign(Object.assign({},k),{[x]:Object.assign(Object.assign({},k[x]),{ids:[...w((null===(b=k[x])||void 0===b?void 0:b.ids)||[])]})})}})}removeFromCollection(P,w){const x=(0,h.ZU)(P);this.store.update(({collections:k})=>{var b;return{collections:Object.assign(Object.assign({},k),{[x]:Object.assign(Object.assign({},k[x]),{ids:((null===(b=k[x])||void 0===b?void 0:b.ids)||[]).filter(v=>!w.includes(v))})})}})}};m.\u0275fac=function(P){return new(P||m)(y.LFG(p.b),y.LFG(n.eN),y.LFG(g.T),y.LFG(r.kl))},m.\u0275prov=y.Yz7({token:m,factory:m.\u0275fac}),m=(0,i.gn)([a.b,(0,i.w6)("design:paramtypes",[p.b,n.eN,g.T,r.kl])],m)},87853:(H,D,t)=>{"use strict";t.d(D,{G:()=>c});var i=t(14808),e=t(79441);class c extends i.Ui{constructor(){super(...arguments),this.name="MainStore",this.projects=(0,i.r9)(),this.workPackages=(0,i.r9)(),this.posts=(0,i.r9)(),this.schemas=(0,i.r9)(),this.types=(0,i.r9)(),this.statuses=(0,i.r9)(),this.timeEntries=(0,i.r9)(),this.capabilities=(0,i.r9)(),this.versions=(0,i.r9)(),this.users=(0,i.r9)(),this.placeholderUsers=(0,i.r9)(),this.roles=(0,i.r9)(),this.changes={queries:new e.xQ},this.additional={}}forType(r){let n=this[r]||this.additional[r];return n||(n=this.additional[r]=(0,i.r9)()),n}forResource(r){const n=`${_.camelCase(r._type)}s`,h=this.forType(n);return h&&h.get(r.id)}add(r,n){this.additional[r]=n}}},67731:(H,D,t)=>{"use strict";t.d(D,{m:()=>e,V:()=>c});var i=t(2316);const e="op-backlogs-page";class c{ngOnInit(){document.getElementById("projected-content").hidden=!1}}c.\u0275fac=function(r){return new(r||c)},c.\u0275cmp=i.Xpm({type:c,selectors:[["op-backlogs-page"]],decls:0,vars:0,template:function(r,n){},styles:['@charset "UTF-8";#rb .meta{display:none}#rb #helpers{display:none}#rb .editors{display:none}#rb .ui-dialog .editor{display:block}.ui-dialog .ui-dialog-title{float:left;margin-right:0}.ui-dialog.ui-widget-content{border:none}.ui-dialog .ui-dialog-buttonpane.ui-widget-content{border:none}.subject-input{width:99%}th{font-weight:bold}#toolbar .links{display:none!important}.jqplot-target{position:relative;color:#666;font-family:"Trebuchet MS",Arial,Helvetica,sans-serif;font-size:1em}.jqplot-axis{font-size:.75em}.jqplot-xaxis{margin-top:10px}.jqplot-x2axis{margin-bottom:10px}.jqplot-yaxis{margin-right:10px}.jqplot-y2axis,.jqplot-y3axis,.jqplot-y4axis,.jqplot-y5axis,.jqplot-y6axis,.jqplot-y7axis,.jqplot-y8axis,.jqplot-y9axis{margin-left:10px;margin-right:10px}.jqplot-axis-tick,.jqplot-xaxis-tick,.jqplot-yaxis-tick,.jqplot-x2axis-tick,.jqplot-y2axis-tick,.jqplot-y3axis-tick,.jqplot-y4axis-tick,.jqplot-y5axis-tick,.jqplot-y6axis-tick,.jqplot-y7axis-tick,.jqplot-y8axis-tick,.jqplot-y9axis-tick{position:absolute}.jqplot-xaxis-tick{top:0;left:15px;vertical-align:top}.jqplot-x2axis-tick{bottom:0;left:15px;vertical-align:bottom}.jqplot-yaxis-tick{right:0;top:15px;text-align:right}.jqplot-y2axis-tick,.jqplot-y3axis-tick,.jqplot-y4axis-tick,.jqplot-y5axis-tick,.jqplot-y6axis-tick,.jqplot-y7axis-tick,.jqplot-y8axis-tick,.jqplot-y9axis-tick{left:0;top:15px;text-align:left}.jqplot-xaxis-label{margin-top:10px;font-size:11pt;position:absolute}.jqplot-x2axis-label{margin-bottom:10px;font-size:11pt;position:absolute}.jqplot-yaxis-label{margin-right:10px;font-size:11pt;position:absolute}.jqplot-y2axis-label,.jqplot-y3axis-label,.jqplot-y4axis-label,.jqplot-y5axis-label,.jqplot-y6axis-label,.jqplot-y7axis-label,.jqplot-y8axis-label,.jqplot-y9axis-label{font-size:11pt;position:absolute}table.jqplot-table-legend,table.jqplot-cursor-legend{background-color:#fff9;border:1px solid #ccc;position:absolute;font-size:.75em}td.jqplot-table-legend{vertical-align:middle}td.jqplot-table-legend>div{border:1px solid #ccc;padding:.2em}div.jqplot-table-legend-swatch{width:0;height:0;border-top-width:.35em;border-bottom-width:.35em;border-left-width:.6em;border-right-width:.6em;border-top-style:solid;border-bottom-style:solid;border-left-style:solid;border-right-style:solid}.jqplot-title{top:0;left:0;padding-bottom:.5em;font-size:1.2em}table.jqplot-cursor-tooltip{border:1px solid #ccc;font-size:.75em}.jqplot-cursor-tooltip{border:1px solid #ccc;font-size:.75em;white-space:nowrap;background:rgba(208,208,208,.5);padding:1px}.jqplot-highlighter-tooltip{border:1px solid #ccc;font-size:.75em;white-space:nowrap;background:rgba(208,208,208,.5);padding:1px}.jqplot-point-label{font-size:.75em}td.jqplot-cursor-legend-swatch{vertical-align:middle;text-align:center}div.jqplot-cursor-legend-swatch{width:1.2em;height:.7em}.score{text-align:center;width:1.5em;font-size:large;display:inline-block}.score_0{background-color:red}.score_1{background-color:#ff5300}.score_2{background-color:#ff8100}.score_3{background-color:#ffa100}.score_4{background-color:#fb0}.score_5{background-color:#ffd300}.score_6{background-color:#ffec00}.score_7{background-color:#e9fb00}.score_8{background-color:#b1f100}.score_9{background-color:#74e600}.score_10{background-color:#0c0}#rb #backlogs_container{width:100%;display:flex;flex-wrap:wrap;justify-content:space-between}#rb #owner_backlogs_container{min-width:420px;order:2;width:49%;flex:0 0 49%}#rb #sprint_backlogs_container{min-width:420px;width:49%;flex:0 0 49%;min-height:230px}#rb #owner_backlogs_container .backlog .header>.add_new_story{height:28px;line-height:31px;padding:0;position:absolute;right:10px;text-align:right;top:1px;width:100px}#rb #backlogs_container .backlog{border:1px solid #E4E4E4;display:block;margin:0 0 10px;width:100%}.controller-rb_master_backlogs .action-index #content{padding-bottom:180px}#rb #backlogs_container .backlog .header{background-color:#eee;height:30px;position:relative;width:100%}#rb .backlog .header .menu{border-right:1px solid #E4E4E4;cursor:pointer;height:30px;overflow:visible;position:absolute;top:0;right:0;width:30px}#rb .backlog .header .menu .icon-context{position:absolute;top:7px;left:12px}#rb .backlog .header .menu .icon-context:before{padding:0}#rb .backlog .header .menu .icon-context.open+.items{display:block}#rb .backlog .header .menu .items{display:none;background-color:#eee;border:1px solid #E4E4E4;position:absolute;top:30px;right:-2px;list-style:none;margin:0;padding:0;z-index:1000}#rb .backlog .header .menu .item{display:block;width:160px;height:2rem;font-size:.9rem;text-align:left;text-decoration:none;vertical-align:middle;overflow:hidden;white-space:nowrap}#rb .backlog .header .menu .item.hover,#rb .backlog .header .menu .item:hover{background-color:#999}#rb .backlog .header .menu .item a{display:block;height:100%;padding:6px;width:100%}#rb .backlog .header .menu .item.hover a,#rb .backlog .header .menu .item:hover a{color:#fff;text-decoration:none}#rb #backlogs_container .backlog .header .velocity{height:28px;line-height:31px;padding:0 3px 0 9px;position:absolute;right:25px;text-align:right;top:0px;width:32px}#rb #backlogs_container .backlog .header .toggler{font-family:"openproject-icon-font";height:30px;line-height:31px;padding:0;position:absolute;left:0;top:0;width:23px;cursor:pointer}#rb #backlogs_container .backlog .header .toggler:before{position:absolute;left:6px;top:10px}#rb #backlogs_container .backlog .header .toggler.closed:before{position:absolute;left:6px;top:10px}#rb #backlogs_container .backlog .header .toggler:hover{cursor:pointer;background-color:#d8d8d8}#rb #backlogs_container .backlog .sprint{background-color:transparent;cursor:pointer;display:block;height:29px;width:auto;margin-left:30px;margin-right:50px}#rb #backlogs_container .backlog .sprint.error.icon-bug{background:none;text-align:center}#rb #backlogs_container .backlog .sprint.error.icon-bug:before{position:absolute;color:red}#rb #backlogs_container .backlog .sprint .id,#rb #backlogs_container .backlog .sprint .status{display:none}#rb #backlogs_container .backlog .sprint .name{line-height:2rem;font-weight:bold;overflow:hidden;white-space:nowrap;margin-left:.5em}#rb #backlogs_container .backlog .sprint .start_date,#rb #backlogs_container .backlog .sprint .effective_date{float:right;height:28px;line-height:2rem;width:6.5em;margin-left:.5em}#rb #backlogs_container .backlog .stories{list-style:none;min-height:2rem;margin:0;padding:0;z-index:500;overflow-y:auto;overflow-x:hidden}#rb #backlogs_container .backlog .stories.closed{display:none}#rb #backlogs_container .backlog .stories .error.icon.icon-bug{text-align:left}#rb #backlogs_container .stories .story{cursor:move;display:block;font-size:.9rem;margin:0;overflow:hidden;position:relative;width:100%}#rb #backlogs_container .stories .story.odd{background-color:#f6f7f8}#rb #backlogs_container .stories .story.even{background-color:#fff}#rb #backlogs_container .stories .story.error.icon-bug{background:none;text-align:center}#rb #backlogs_container .stories .story.error.icon-bug:before{position:absolute;color:red;pointer-events:none}#rb #backlogs_container .stories .story.hover,#rb #backlogs_container .stories .story:hover{background-color:#fef8a8}#rb #backlogs_container .stories .story.closed{text-decoration:line-through}#rb #backlogs_container .stories .story .id{float:left;margin-left:1em;margin-right:1em;padding:5px 2px 4px;width:4em;text-align:right;white-space:nowrap}#rb #backlogs_container .stories .story .type_id .t{float:left;padding:5px 2px 4px;text-align:right;white-space:nowrap}#rb #backlogs_container .stories .story .subject{overflow:hidden;margin-left:4em;padding:5px 2px 4px;white-space:nowrap;min-height:1em}#rb #backlogs_container .stories .story .status_id{float:right;padding:5px 2px 4px;margin-left:1em;width:68px}#rb #backlogs_container .stories .story .story_points{float:right;padding:5px 1rem 4px 2px;width:3.5rem;min-height:14px;height:2rem;text-align:center}#rb #backlogs_container .stories .story .type_id .v,#rb #backlogs_container .stories .story .id .v,#rb #backlogs_container .stories .story .status_id .v,#rb #backlogs_container .stories .story .version_id,#rb #backlogs_container .stories .story .higher_item_id{display:none}.rb_dialog .burndown_chart{margin-top:20px;margin-bottom:20px;margin-left:20px}.rb_dialog #charts{overflow:hidden}.rb_dialog #charts h3{border:0px}.rb_dialog #charts fieldset.burndown_control{padding-left:10px;border:none}.rb_dialog #charts .axislabel{font-weight:bold}#rb #backlogs_container .sprint.editing .editors,#rb #backlogs_container .sprint.editing>.editor{display:block}#rb #backlogs_container .sprint.editing label,#rb #backlogs_container .sprint.editing>*{display:none}#rb #backlogs_container .sprint.editing+.velocity,#rb #backlogs_container .sprint.editing+.add_new_story{display:none}#rb #backlogs_container .backlog .sprint.editing .editor{font-size:.9rem;line-height:1.5rem;height:30px;margin:0;padding:0}#rb #backlogs_container .backlog .sprint.editing .editor.name{min-width:15em;width:calc(100% - 2 * 85px - 10px)}#rb #backlogs_container .backlog .sprint.editing .editor.start_date,#rb #backlogs_container .backlog .sprint.editing .editor.effective_date{width:85px}#rb #backlogs_container .stories .story.editing>*,#rb #backlogs_container .stories .story.editing>.editors label{display:none}#rb #backlogs_container .stories .story.editing .editors{display:block}#rb #backlogs_container .stories .story.editing select,#rb #backlogs_container .stories .story.editing input{display:inline-block;float:none;margin:5px 3px 4px 2px;font-size:.8rem;line-height:inherit}#rb #backlogs_container .stories .story.editing .type_id.editor{width:15%;max-width:140px}#rb #backlogs_container .stories .story.editing .subject.editor{width:55%}#rb #backlogs_container .stories .story.editing .status_id.editor{width:15%;float:right}#rb #backlogs_container .stories .story.editing .story_points.editor{float:right;width:10%}.controller-rb_master_backlogs.action-show #main,.controller-rb_master_backlogs.action-show #content,.controller-rb_master_backlogs.action-show #rb #backlogs_container .backlog .stories{overflow:visible}.controller-rb_master_backlogs.action-show div.calendar{z-index:10000}.backlog{font-size:.9rem}.controller-rb_taskboards.action-show #main{overflow:visible}#rb .task{color:#484848;line-height:inherit;white-space:inherit}#rb #taskboard{overflow-x:auto}#rb #taskboard #assigned_to_id_options{display:none}#rb #taskboard .swimlane{min-width:107px;padding:5px;width:107px}#rb #taskboard #board_header{background-color:#ebebeb;border:1px solid #CCCCCC;margin-bottom:0;margin-right:10px}#rb #taskboard #board_header td{background-color:#ebebeb;border-right:1px dotted #CFCFCF;color:#000;font-weight:bold;text-align:center;vertical-align:middle;padding-top:0;padding-bottom:0;line-height:30px}#rb #taskboard #board_header td:first-child{min-width:241px;width:241px}#rb #taskboard .board{background-color:#fcfcfc;border:1px solid #CCCCCC;border-top:none;margin-right:10px;table-layout:fixed;border-collapse:collapse;empty-cells:show}#rb #taskboard .board tr:hover{background-color:#fff}#rb #taskboard .board td{border-right:1px dotted #CFCFCF;border-bottom:1px dotted #CFCFCF;vertical-align:top}#rb #taskboard .board td:first-child{min-width:210px;padding:5px;width:210px}#rb #taskboard .board tr:last-child td{border-bottom:none}#rb #taskboard .board .add_new{margin:0;min-width:30px;padding:0;text-align:center;vertical-align:middle;width:30px}#rb #taskboard .board .add_new.clickable:hover{cursor:pointer;background-color:#ffc}#rb #taskboard .story,#rb #taskboard .label_sprint_impediments{background-color:#f8f6a5;border:none;display:block;float:left;min-height:84px;margin:5px;padding:5px;position:relative;width:190px}#rb #taskboard .story .subject{height:42px;line-height:13px;margin-top:0;overflow:hidden;padding:2px;width:180px}#rb #taskboard .story.closed .subject{text-decoration:line-through}#rb #taskboard .work_package,#rb #taskboard .placeholder{background-color:#afafaf;border:none;cursor:move;display:block;float:left;font-size:10px;height:80px;padding:5px;margin:5px 0;position:relative;width:85px}#rb #taskboard .work_package.prevent_edit{cursor:default}#rb #taskboard .placeholder{background-color:#ff0;border:1px dashed #333300;height:78px;width:83px}#rb #taskboard .work_package.closed .subject.editable{text-decoration:line-through}#rb #taskboard .work_package .v{display:none}#rb #taskboard .work_package .remaining_hours.editable{border:2px solid #FFFFFF;background-color:#e00;bottom:-5px;color:#fff;font-size:9px;height:13px;padding-left:5px;padding-right:5px;position:absolute;right:-5px}#rb #taskboard .work_package .blocks,#rb #taskboard .work_package .remaining_hours.editable.empty{display:none}#rb #taskboard .work_package .indicator{display:none}#rb #taskboard .work_package.error .indicator{background:none;border:none}#rb #taskboard .work_package.error.icon-bug:before{position:absolute;top:30px;left:28px;color:red}#rb #taskboard .work_package .editors{display:none}.task_editor_dialog.ui-dialog .ui-widget-header{background:none;background-color:#fff;opacity:.5;filter:alpha(opacity=50)}.task_editor_dialog.ui-dialog .ui-dialog-title{float:right;margin-right:0;color:var(--body-font-color)}.task_editor_dialog.ui-dialog.ui-widget-content{background:none;border:none}.task_editor_dialog.ui-dialog.ui-widget-content .editor{color:var(--body-font-color)}.task_editor_dialog.ui-dialog .ui-dialog-buttonpane.ui-widget-content{background:none;background-color:none;border:none}.ui-dialog-titlebar-close{overflow:hidden}.dark #task_editor label{color:#fff}.light #task_editor label{color:#000}.dark div{color:#fff}.light div{color:#000}#task_editor label{display:block;font-size:11px;text-transform:capitalize;width:100%}#task_editor .editor{font-size:11px;margin-bottom:10px;width:100%}#task_editor .subject{height:65px;width:272px}#task_editor .remaining_hours,#task_editor .blocks{width:268px}#rb .compact .story,#rb .compact .label_sprint_impediments{height:15px}#rb .compact .story .subject{display:none}#rb .compact .work_package{height:21px;padding:0;width:21px}#rb .compact .work_package *{display:none}#rb .compact .placeholder{background-color:#ff0;border:1px dashed #333300;height:19px;width:19px}#rb #impediment_template,#rb #task_template{display:none}.story .story-bar{background-color:#fff;font-size:1rem-rem-calc(5px);opacity:.8;filter:alpha(opacity=80);overflow:hidden;padding-bottom:1px;padding-right:3px;text-align:right;width:180px;clear:both}.story .story-bar .id{float:right}.story .story-bar .status{float:left}.story,.label_sprint_impediments{font-size:1rem-rem-calc(3px)}.work_package .id{background-color:#fff;font-size:1rem-rem-calc(5px);opacity:.8;filter:alpha(opacity=80);overflow:hidden;padding-bottom:1px;padding-right:3px;text-align:right;width:75px}.work_package .id a{opacity:1;filter:alpha(opacity=100)}.work_package .editable:hover{background-color:transparent}.work_package .subject.editable{font-size:1rem-rem-calc(3px);height:42px;line-height:13px;margin-top:0;overflow:hidden;padding:2px;width:81px}.story .story-footer .assigned_to_id{float:left;font-size:1rem-rem-calc(5px);width:85%;margin-top:4px;padding:0 2px 2px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.story .story-footer .story-points{margin-top:2px;float:right}.work_package .assigned_to_id.editable{float:left;font-size:1rem-rem-calc(5px);width:85%;margin-top:4px;padding:0 2px 2px}.work_package .assigned_to_id.editable .t{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}#toolbar label[for=col_width_input]{padding-top:rem-calc(20px)}#toolbar #col_width_input{max-width:60px}.controller-rb_master_backlogs .ui-dialog-titlebar-close,.controller-rb_taskboards .ui-dialog-titlebar-close{display:none}.controller-rb_master_backlogs .ui-dialog,.controller-rb_taskboards .ui-dialog{background:#FFFFFF;border:1px solid #E4E4E4}\n'],encapsulation:2})},12084:(H,D,t)=>{"use strict";t.d(D,{y:()=>N});var i=t(49152);class e extends i.J{constructor(ee,G,se){super(G,se),this.injector=ee,this.id=se}}class c extends i.D{constructor(ee,G,se,me){super(G,se,me),this.injector=ee,this.basePath=G,this.resource=me}id(ee){return new(this.resource||e)(this.injector,this.path,ee)}}var u=t(3786),r=t(53882),n=t(88361),h=t(45871),a=t(33927),p=t(18293),l=t(29161),d=t(51784);class g{constructor(ee,G){this.injector=ee,this.resourceClass=G}get(ee,G,se={}){const me={headers:se,params:new r.LE({encoder:new d.c,fromObject:G}),withCredentials:!0,responseType:"json"};return this._request("get",ee,me)}request(ee,G,se={},me={}){if("get"===ee)return this.get(G,se,me);const _e={body:se||{},headers:me,withCredentials:!0,responseType:"json"};return this._request(ee,G,_e)}_request(ee,G,se){return this.http.request(ee,G,se).pipe((0,a.U)(me=>this.deserialize(me)),(0,p.K)(me=>(console.error(`Failed to ${ee} ${G}: ${me.name}`),(0,h._)(me))))}deserialize(ee){return this.resourceClass?new n.r5(this.resourceClass).parse(ee):ee}}(0,u.gn)([(0,l.W)(),(0,u.w6)("design:type",r.eN)],g.prototype,"http",void 0);var C=t(63628),y=t(95571);let m=class{};(0,u.gn)([C.R,(0,u.w6)("design:type",Number)],m.prototype,"project_id",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",String)],m.prototype,"name",void 0),m=(0,u.gn)([y.O],m);var E=t(68118),P=t(2281);let w=class{};(0,u.gn)([(0,E.g)(String),(0,u.w6)("design:type",Array)],w.prototype,"topic_actions",void 0),(0,u.gn)([(0,E.g)(String),(0,u.w6)("design:type",Array)],w.prototype,"topic_status",void 0),w=(0,u.gn)([y.O],w);let x=class{};(0,u.gn)([C.R,(0,u.w6)("design:type",String)],x.prototype,"guid",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",String)],x.prototype,"topic_type",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",String)],x.prototype,"topic_status",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",String)],x.prototype,"priority",void 0),(0,u.gn)([(0,E.g)(String),(0,u.w6)("design:type",Array)],x.prototype,"reference_links",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",String)],x.prototype,"title",void 0),(0,u.gn)([(0,C.R)({preserveNull:!0}),(0,u.w6)("design:type",Object)],x.prototype,"index",void 0),(0,u.gn)([(0,E.g)(String),(0,u.w6)("design:type",Array)],x.prototype,"labels",void 0),(0,u.gn)([(0,C.R)({deserializer:te=>P(te),serializer:te=>te.toISOString()}),(0,u.w6)("design:type",Object)],x.prototype,"creation_date",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",String)],x.prototype,"creation_author",void 0),(0,u.gn)([(0,C.R)({deserializer:te=>P(te),serializer:te=>te.toISOString()}),(0,u.w6)("design:type",Object)],x.prototype,"modified_date",void 0),(0,u.gn)([(0,C.R)({preserveNull:!0}),(0,u.w6)("design:type",Object)],x.prototype,"modified_author",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",String)],x.prototype,"assigned_to",void 0),(0,u.gn)([(0,C.R)({preserveNull:!0}),(0,u.w6)("design:type",Object)],x.prototype,"stage",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",String)],x.prototype,"description",void 0),(0,u.gn)([(0,C.R)({deserializer:te=>P(te),serializer:te=>te.format("YYYY-MM-DD")}),(0,u.w6)("design:type",Object)],x.prototype,"due_date",void 0),(0,u.gn)([C.R,(0,u.w6)("design:type",w)],x.prototype,"authorization",void 0),x=(0,u.gn)([y.O],x);class k extends e{constructor(){super(...arguments),this.bcfViewpointsService=new g(this.injector)}get(ee={},G={}){return this.bcfViewpointsService.get(this.toPath(),ee,G)}}class b extends e{constructor(){super(...arguments),this.bcfViewpointsService=new g(this.injector)}get(ee={},G={}){return this.bcfViewpointsService.get(this.toPath(),ee,G)}}class v extends e{constructor(){super(...arguments),this.bcfViewpointsService=new g(this.injector),this.selection=new k(this.injector,this.path,"selection"),this.visibility=new b(this.injector,this.path,"visibility")}get(ee={},G={}){return this.bcfViewpointsService.get(this.toPath(),ee,G)}delete(ee={}){return this.bcfViewpointsService.request("delete",this.toPath(),{},ee).pipe((0,a.U)(()=>{}))}}class M extends c{constructor(){super(...arguments),this.bcfViewpointService=new g(this.injector)}post(ee){return this.bcfViewpointService.request("post",this.toPath(),ee)}}class S extends e{constructor(){super(...arguments),this.bcfTopicService=new g(this.injector,x),this.comments=new c(this.injector,this.path,"comments"),this.viewpoints=new M(this.injector,this.path,"viewpoints",v)}get(ee={},G={}){return this.bcfTopicService.get(this.toPath(),ee,G)}}class O extends c{constructor(ee,G,se){super(ee,G,se,S),this.injector=ee,this.basePath=G,this.bcfTopicService=new g(this.injector,x)}get(ee={},G={}){throw new Error("Not implemented")}post(ee){return this.bcfTopicService.request("post",this.toPath(),ee)}}let A=class{};(0,u.gn)([(0,E.g)(String),(0,u.w6)("design:type",Array)],A.prototype,"topic_actions",void 0),(0,u.gn)([(0,E.g)(String),(0,u.w6)("design:type",Array)],A.prototype,"project_actions",void 0),(0,u.gn)([(0,E.g)(String),(0,u.w6)("design:type",Array)],A.prototype,"comment_actions",void 0),A=(0,u.gn)([y.O],A);class F extends e{constructor(){super(...arguments),this.bcfExtensionService=new g(this.injector,A)}get(ee={},G={}){return this.bcfExtensionService.get(this.toPath(),ee,G)}}class I extends e{constructor(){super(...arguments),this.bcfProjectService=new g(this.injector,m),this.topics=new O(this.injector,this.path,"topics"),this.extensions=new F(this.injector,this.path,"extensions")}get(ee={},G={}){return this.bcfProjectService.get(this.toPath(),ee,G)}}var J=t(2316);class N{constructor(ee){this.injector=ee,this.bcfApiVersion="2.1",this.appBasePath=window.appBasePath||"",this.bcfApiBase=`${this.appBasePath}/api/bcf/${this.bcfApiVersion}`,this.projects=new c(this.injector,this.bcfApiBase,"projects",I)}parse(ee){if(!ee.startsWith(this.bcfApiBase))throw new Error(`Cannot parse ${ee} into BCF resource.`);const G=ee.replace(`${this.bcfApiBase}/`,"").split("/");let se=this;for(let me=0;me<G.length;me++){const _e=G[me];if(_e in se)se=se[_e];else{if(!(se instanceof c))break;se=se.id(_e)}}return se===this?void 0:se}}N.\u0275fac=function(ee){return new(ee||N)(J.LFG(J.zs3))},N.\u0275prov=J.Yz7({token:N,factory:N.\u0275fac,providedIn:"root"})},38998:(H,D,t)=>{"use strict";t.d(D,{L:()=>r});var i=t(3786),e=t(29161),c=t(47775),u=t(2316);class r{constructor(h){this.injector=h}}r.\u0275fac=function(h){return new(h||r)(u.LFG(u.zs3))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac}),(0,i.gn)([(0,e.W)(),(0,i.w6)("design:type",c.StateService)],r.prototype,"state",void 0)},51566:(H,D,t)=>{"use strict";t.d(D,{b:()=>c});var i=t(70233),e=t(2316);class c{constructor(r){this.pathHelper=r}projectImportIssuePath(r){return`${this.pathHelper.projectPath(r)}/issues/upload`}projectExportIssuesPath(r,n){return n?`${this.pathHelper.projectPath(r)}/work_packages.bcf?filters=${n}`:`${this.pathHelper.projectPath(r)}/work_packages.bcf`}snapshotPath(r){return`${r.href}/snapshot`}}c.\u0275fac=function(r){return new(r||c)(e.LFG(i.j))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac})},3412:(H,D,t)=>{"use strict";t.d(D,{V:()=>C});var i=t(3786),e=t(29161),c=t(12084),u=t(38998),r=t(33927),n=t(98636),h=t(79902),a=t(42720),p=t(81134),l=t(20979),d=t(10190),g=t(2316);class C{constructor(m){this.injector=m}getViewPointResource(m,E){const P=m.bcfViewpoints[E].href;return this.bcfApi.parse(P)}getViewPoint$(m,E){const P=this.getViewPointResource(m,E);return(0,a.D)({viewpoint:P.get(),selection:P.selection.get(),visibility:P.visibility.get()}).pipe((0,r.U)(({viewpoint:w,selection:x,visibility:k})=>{const b=w;return b.components={selection:x.selection,visibility:k.visibility},b}))}deleteViewPoint$(m,E){return this.getViewPointResource(m,E).delete().pipe((0,n.b)(()=>this.apiV3Service.work_packages.id(m).requireAndStream(!0)))}saveViewpoint$(m,E){const P=m.project.href,w=(0,d.Z)(P),x=this.setBcfTopic$(m),k=E?(0,p.of)(E):this.viewerBridge.getViewpoint$();return(0,a.D)({topicUUID:x,viewpoint:k}).pipe((0,h.w)(b=>this.bcfApi.projects.id(w).topics.id(b.topicUUID).viewpoints.post(b.viewpoint)),(0,n.b)(()=>this.apiV3Service.work_packages.id(m).requireAndStream(!0)))}setBcfTopic$(m){var E;if(this.topicUUID)return(0,p.of)(this.topicUUID);const P=null===(E=m.bcfTopic)||void 0===E?void 0:E.href;return(P?(0,p.of)(this.bcfApi.parse(P).id):this.createBcfTopic$(m)).pipe((0,r.U)(x=>(this.topicUUID=x,this.topicUUID)))}createBcfTopic$(m){const E=(0,d.Z)(m.project.href),P=m.convertBCF.payload;return this.bcfApi.projects.id(E).topics.post(P).pipe((0,r.U)(w=>(this.topicUUID=w.guid,this.topicUUID)))}}C.\u0275fac=function(m){return new(m||C)(g.LFG(g.zs3))},C.\u0275prov=g.Yz7({token:C,factory:C.\u0275fac}),(0,i.gn)([(0,e.W)(),(0,i.w6)("design:type",c.y)],C.prototype,"bcfApi",void 0),(0,i.gn)([(0,e.W)(),(0,i.w6)("design:type",u.L)],C.prototype,"viewerBridge",void 0),(0,i.gn)([(0,e.W)(),(0,i.w6)("design:type",l.T)],C.prototype,"apiV3Service",void 0)},70795:(H,D,t)=>{"use strict";t.d(D,{w:()=>R});var i=t(2316),e=t(21757),c=t(60169),u=t(60874),r=t(3786),n=t(55741),h=t(29161),a=t(51566);class p extends n.C{render(W,oe){const Oe=this.resource.bcfViewpoints;if(Oe&&Oe.length>0){const $=Oe[0];W.innerHTML=`\n        <img src="${this.bcfPathHelper.snapshotPath($)}" class="thumbnail">\n      `}else W.innerHTML=""}}(0,r.gn)([(0,h.W)(),(0,r.w6)("design:type",a.b)],p.prototype,"bcfPathHelper",void 0);var l=t(53882),d=t(54364);class g{constructor(W){this.documentElement=W}get isBcfActivated(){return this.hasBodyClass("bcf-activated")}hasBodyClass(W){return this.documentElement.body.classList.contains(W)}}g.\u0275fac=function(W){return new(W||g)(i.LFG(d.K0))},g.\u0275prov=i.Yz7({token:g,factory:g.\u0275fac});var C=t(3412),y=t(64533),m=t(38998),E=t(53448),P=t(47775),x=(t(24897),t(10190)),k=t(96617),b=t(26942),v=t(36293),M=t(63829),S=t(14808),O=t(12084),A=t(33927),F=t(53466);class I{constructor(W){this.bcfApi=W,this.authorizationMap=(0,S.r9)()}authorized$(W,oe,Oe){const $=this.authorizationMap.get(W);return $.putFromPromiseIfPristine(()=>this.bcfApi.projects.id(W).extensions.get().toPromise()),$.values$().pipe((0,A.U)(Xe=>Xe[oe]&&Xe[oe].includes(Oe)))}isAllowedTo(W,oe,Oe){return this.authorized$(W,oe,Oe).pipe((0,F.q)(1)).toPromise().catch(()=>!1)}}I.\u0275fac=function(W){return new(W||I)(i.LFG(O.y))},I.\u0275prov=i.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"});var J=t(20979),N=t(8368),te=t(9170),ee=t(2775);function G(L,W){if(1&L){const oe=i.EpF();i.TgZ(0,"div",7),i.TgZ(1,"ngx-gallery",8),i.NdJ("change",function($){return i.CHM(oe),i.oxw(2).onGalleryChanged($)})("imagesReady",function(){return i.CHM(oe),i.oxw(2).selectViewpointInGallery()})("previewOpen",function(){return i.CHM(oe),i.oxw(2).galleryPreviewOpen()})("previewClose",function(){return i.CHM(oe),i.oxw(2).galleryPreviewClose()}),i.qZA(),i.qZA()}if(2&L){const oe=i.oxw(2);i.xp6(1),i.Q6J("options",oe.galleryOptions)("images",oe.galleryImages)}}function se(L,W){if(1&L){const oe=i.EpF();i.TgZ(0,"a",9),i.NdJ("click",function(){i.CHM(oe);const $=i.oxw(2);return $.saveViewpoint($.workPackage)}),i._UZ(1,"op-icon",10),i.TgZ(2,"span",11),i._uU(3),i.qZA(),i.qZA()}if(2&L){const oe=i.oxw(2);i.Q6J("title",oe.text.add_viewpoint),i.xp6(3),i.hij(" ",oe.text.viewpoint," ")}}function me(L,W){if(1&L&&(i.ynx(0),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"div",3),i._UZ(4,"h3",4),i.qZA(),i.qZA(),i.YNc(5,G,2,2,"div",5),i.YNc(6,se,4,2,"a",6),i.qZA(),i.BQk()),2&L){const oe=i.oxw();i.xp6(4),i.Q6J("textContent",oe.text.bcf),i.xp6(1),i.Q6J("ngIf",oe.galleryImages.length>0),i.xp6(1),i.Q6J("ngIf",oe.viewerVisible&&oe.createAllowed)}}class _e extends b.N{constructor(W,oe,Oe,$,Xe,rt,ge,be,Me,Re){super(),this.state=W,this.bcfAuthorization=oe,this.viewerBridge=Oe,this.apiV3Service=$,this.wpCreate=Xe,this.toastService=rt,this.bcfViewer=ge,this.cdRef=be,this.I18n=Me,this.viewpointsService=Re,this.text={bcf:this.I18n.t("js.bcf.label_bcf"),viewpoint:this.I18n.t("js.bcf.viewpoint"),add_viewpoint:this.I18n.t("js.bcf.add_viewpoint"),show_viewpoint:this.I18n.t("js.bcf.show_viewpoint"),delete_viewpoint:this.I18n.t("js.bcf.delete_viewpoint"),text_are_you_sure:this.I18n.t("js.text_are_you_sure"),notice_successful_create:this.I18n.t("js.notice_successful_create"),notice_successful_delete:this.I18n.t("js.notice_successful_delete")},this.galleryOptions=[{width:"100%",height:"400px",startIndex:0,image:!1,thumbnailsColumns:1,thumbnailsAutoHide:!1,thumbnailSize:"contain",imageAnimation:"",previewAnimation:!1,previewCloseOnEsc:!0,previewKeyboardNavigation:!0,imageSize:"contain",imageArrowsAutoHide:!0,thumbnailsMargin:5,thumbnailMargin:5,previewDownload:!0,previewCloseOnClick:!0,arrowPrevIcon:"icon-arrow-left2",arrowNextIcon:"icon-arrow-right2",closeIcon:"icon-close",downloadIcon:"icon-download",thumbnailActions:this.actions(),actions:this.actions()},{breakpoint:800,width:"100%",height:"400px",imagePercent:80,thumbnailsPercent:20,thumbnailsMargin:5,thumbnailMargin:5},{breakpoint:680,height:"200px",thumbnailsColumns:3,thumbnailsMargin:5,thumbnailMargin:5}],this.viewpoints=[],this.galleryImages=[],this.viewAllowed=!1,this.createAllowed=!1,this.viewerVisible=!1}ngAfterViewInit(){this.observeChanges()}ngOnInit(){this.viewerBridge.viewerVisible$.subscribe(W=>{this.viewerVisible=!!W,this.cdRef.detectChanges()})}observeChanges(){this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(W=>(0,r.mG)(this,void 0,void 0,function*(){this.workPackage=W,this.projectId||(yield this.initialize(this.workPackage)),W.bcfViewpoints&&this.refreshViewpoints(W.bcfViewpoints)}))}initialize(W){return(0,r.mG)(this,void 0,void 0,function*(){this.projectId=(0,x.Z)(W.project.href),this.viewAllowed=yield this.bcfAuthorization.isAllowedTo(this.projectId,"project_actions","viewTopic"),this.createAllowed=yield this.bcfAuthorization.isAllowedTo(this.projectId,"topic_actions","createViewpoint"),this.loadViewpointFromRoute(W),this.cdRef.detectChanges()})}refreshViewpoints(W){this.viewpoints=W.map(oe=>({href:oe.href,snapshotURL:`${oe.href}/snapshot`})),this.setViewpointsOnGallery(this.viewpoints)}showViewpoint(W,oe){if(this.bcfViewer&&this.viewerBridge.shouldShowViewer){switch(this.bcfViewer.currentViewerState()){case"table":this.bcfViewer.update("splitTable");break;case"cards":this.bcfViewer.update("splitCards")}this.viewerBridge.viewerVisible$.pipe((0,te.h)(Oe=>Oe),(0,F.q)(1)).subscribe(()=>this.viewerBridge.showViewpoint(W,oe))}else this.viewerBridge.showViewpoint(W,oe)}deleteViewpoint(W,oe){!window.confirm(this.text.text_are_you_sure)||this.viewpointsService.deleteViewPoint$(W,oe).subscribe(()=>{this.toastService.addSuccess(this.text.notice_successful_delete),this.gallery.preview.close()})}saveViewpoint(W){this.viewpointsService.saveViewpoint$(W).subscribe(()=>{this.toastService.addSuccess(this.text.notice_successful_create),this.showIndex=this.viewpoints.length})}loadViewpointFromRoute(W){if("number"==typeof this.state.params.viewpoint){const oe=this.state.params.viewpoint;this.showViewpoint(W,oe),this.showIndex=oe,this.selectViewpointInGallery(),this.state.go(".",Object.assign(Object.assign({},this.state.params),{viewpoint:void 0}),{reload:!1})}}shouldShowGroup(){return this.viewAllowed&&(this.viewpoints.length>0||this.createAllowed&&this.viewerVisible)}actions(){return[{icon:"icon-view-model",onClick:(W,oe)=>{this.showViewpoint(this.workPackage,oe),this.gallery.preview.close()},titleText:this.text.show_viewpoint},{icon:"icon-delete",onClick:(W,oe)=>this.deleteViewpoint(this.workPackage,oe),titleText:this.text.delete_viewpoint}]}galleryPreviewOpen(){jQuery(".op-app-header").addClass("-no-z-index")}galleryPreviewClose(){jQuery(".op-app-header").removeClass("-no-z-index")}selectViewpointInGallery(){setTimeout(()=>{var W;return null===(W=this.gallery)||void 0===W?void 0:W.show(this.showIndex)},250)}onGalleryChanged(W){this.showIndex=W.index}set showIndex(W){const oe=[...this.galleryOptions];oe[0].startIndex=W,this.galleryOptions=oe}get showIndex(){return this.galleryOptions[0].startIndex}setViewpointsOnGallery(W){const{length:oe}=W;this.setThumbnailProperties(oe),this.showIndex<0||oe<1?this.showIndex=0:this.showIndex>=oe&&(this.showIndex=oe-1),this.galleryImages=W.map(Oe=>({small:Oe.snapshotURL,medium:Oe.snapshotURL,big:Oe.snapshotURL})),this.cdRef.detectChanges()}setThumbnailProperties(W){const oe=[...this.galleryOptions];oe[0].thumbnailsColumns=W<5?W:4,oe[1].thumbnailsColumns=W<5?W:4,oe[2].thumbnailsColumns=W<4?W:3,oe[0].height=`${this.dynamicThumbnailHeight(W)}px`,oe[1].height=`${this.dynamicThumbnailHeight(W)}px`,oe[2].height=`${this.dynamicThumbnailHeight(W)}px`,this.galleryOptions=oe}dynamicThumbnailHeight(W){return Math.max(Math.round(300/W),120)}}_e.\u0275fac=function(W){return new(W||_e)(i.Y36(P.StateService),i.Y36(I),i.Y36(m.L),i.Y36(J.T),i.Y36(M.P),i.Y36(v.kl),i.Y36(N.zJ,8),i.Y36(i.sBO),i.Y36(k.D),i.Y36(C.V))},_e.\u0275cmp=i.Xpm({type:_e,selectors:[["ng-component"]],viewQuery:function(W,oe){if(1&W&&i.Gf(c.g$,5),2&W){let Oe;i.iGM(Oe=i.CRH())&&(oe.gallery=Oe.first)}},inputs:{workPackage:"workPackage"},features:[i._Bn([C.V]),i.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[1,"attributes-group","description-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["class","bcf--viewpoints",4,"ngIf"],["class","button",3,"title","click",4,"ngIf"],[1,"bcf--viewpoints"],[3,"options","images","change","imagesReady","previewOpen","previewClose"],[1,"button",3,"title","click"],["icon-classes","button--icon icon-add"],[1,"button--text"]],template:function(W,oe){1&W&&i.YNc(0,me,7,3,"ng-container",0),2&W&&i.Q6J("ngIf",oe.shouldShowGroup())},directives:[d.O5,c.g$,ee.o],styles:[".bcf--viewpoints[_ngcontent-%COMP%]{clear:both}ngx-gallery[_ngcontent-%COMP%]{display:inline-block}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-thumbnails .ngx-gallery-arrow{color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-arrow.ngx-gallery-disabled{display:none}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper{background:rgba(255,255,255,.5);padding:5px}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper .ngx-gallery-icon{margin-top:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper ngx-gallery-action:last-of-type .ngx-gallery-icon{margin-right:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail.ngx-gallery-clickable .ngx-gallery-icon{font-size:1.25rem;color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-active, ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{border:1px solid #E7E7E7!important}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-preview-img{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview{background:rgba(0,0,0,.8)!important}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview a:hover{color:#fff}"],changeDetection:0});var he=t(79902),ae=t(42720),re=t(84699);function ye(L,W){if(1&L){const oe=i.EpF();i.TgZ(0,"div",7),i.TgZ(1,"ngx-gallery",8),i.NdJ("change",function($){return i.CHM(oe),i.oxw(2).onGalleryChanged($)})("imagesReady",function(){return i.CHM(oe),i.oxw(2).selectViewpointInGallery()})("previewOpen",function(){return i.CHM(oe),i.oxw(2).galleryPreviewOpen()})("previewClose",function(){return i.CHM(oe),i.oxw(2).galleryPreviewClose()}),i.qZA(),i.qZA()}if(2&L){const oe=i.oxw(2);i.xp6(1),i.Q6J("options",oe.galleryOptions)("images",oe.galleryImages)}}function Ce(L,W){if(1&L){const oe=i.EpF();i.TgZ(0,"a",9),i.NdJ("click",function(){i.CHM(oe);const $=i.oxw(2);return $.saveViewpoint($.workPackage)}),i._UZ(1,"op-icon",10),i.TgZ(2,"span",11),i._uU(3),i.qZA(),i.qZA()}if(2&L){const oe=i.oxw(2);i.Q6J("title",oe.text.add_viewpoint),i.xp6(3),i.hij(" ",oe.text.viewpoint," ")}}function ke(L,W){if(1&L&&(i.ynx(0),i.TgZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"div",3),i._UZ(4,"h3",4),i.qZA(),i.qZA(),i.YNc(5,ye,2,2,"div",5),i.YNc(6,Ce,4,2,"a",6),i.qZA(),i.BQk()),2&L){const oe=i.oxw();i.xp6(4),i.Q6J("textContent",oe.text.bcf),i.xp6(1),i.Q6J("ngIf",oe.galleryImages.length>0),i.xp6(1),i.Q6J("ngIf",oe.viewerVisible&&oe.createAllowed)}}class Ae extends _e{constructor(){super(...arguments),this.galleryViewpoints=[]}ngAfterViewInit(){this.viewerVisible&&(super.ngAfterViewInit(),(0,re.Z)(this.workPackage)&&this.observeCreation())}observeCreation(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed(),(0,F.q)(1),(0,he.w)(W=>this.viewpointsService.setBcfTopic$(W),W=>W),(0,he.w)(W=>{this.workPackage=W;const oe=this.galleryViewpoints.filter(Oe=>!Oe.href&&Oe.viewpoint).map(Oe=>this.viewpointsService.saveViewpoint$(this.workPackage,Oe.viewpoint));return(0,ae.D)(oe)})).subscribe(()=>{this.showIndex=this.galleryViewpoints.length-1})}showViewpoint(W,oe){}deleteViewpoint(W,oe){this.galleryViewpoints=this.galleryViewpoints.filter((Oe,$)=>$!==oe),this.setViewpointsOnGallery(this.galleryViewpoints)}saveViewpoint(){this.viewerBridge.getViewpoint$().subscribe(W=>{const oe={snapshotURL:W.snapshot.snapshot_data,viewpoint:W};this.galleryViewpoints=[...this.galleryViewpoints,oe],this.setViewpointsOnGallery(this.galleryViewpoints),this.showIndex=this.galleryViewpoints.length-1,this.selectViewpointInGallery()})}shouldShowGroup(){return this.createAllowed&&this.viewerVisible}actions(){return super.actions().filter(W=>"icon-delete"===W.icon)}}Ae.\u0275fac=function(){let L;return function(oe){return(L||(L=i.n5z(Ae)))(oe||Ae)}}(),Ae.\u0275cmp=i.Xpm({type:Ae,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:1,consts:[[4,"ngIf"],[1,"attributes-group","description-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["class","bcf--viewpoints",4,"ngIf"],["class","button",3,"title","click",4,"ngIf"],[1,"bcf--viewpoints"],[3,"options","images","change","imagesReady","previewOpen","previewClose"],[1,"button",3,"title","click"],["icon-classes","button--icon icon-add"],[1,"button--text"]],template:function(W,oe){1&W&&i.YNc(0,ke,7,3,"ng-container",0),2&W&&i.Q6J("ngIf",oe.shouldShowGroup())},directives:[d.O5,c.g$,ee.o],styles:[".bcf--viewpoints[_ngcontent-%COMP%]{clear:both}ngx-gallery[_ngcontent-%COMP%]{display:inline-block}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-thumbnails .ngx-gallery-arrow{color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-arrow.ngx-gallery-disabled{display:none}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper{background:rgba(255,255,255,.5);padding:5px}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper .ngx-gallery-icon{margin-top:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-icons-wrapper ngx-gallery-action:last-of-type .ngx-gallery-icon{margin-right:0}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail.ngx-gallery-clickable .ngx-gallery-icon{font-size:1.25rem;color:var(--content-link-color)}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-active, ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-thumbnail{border:1px solid #E7E7E7!important}ngx-gallery[_ngcontent-%COMP%]     .ngx-gallery-preview-img{background-color:#fff}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview{background:rgba(0,0,0,.8)!important}ngx-gallery[_ngcontent-%COMP%]     ngx-gallery-preview a:hover{color:#fff}"],changeDetection:0});var Fe=t(76491),ot=t(79441),it=t(83720),Ve=t(20088);class Ie extends m.L{constructor(W){super(W),this.injector=W,this.shouldShowViewer=!1,this.viewerVisible$=new Fe.X(!1),this.revitMessageReceivedSource=new ot.xQ,this.trackingIdNumber=0,this.revitMessageReceived$=this.revitMessageReceivedSource.asObservable(),window.RevitBridge?this.hookUpRevitListener():window.addEventListener("revit.plugin.ready",()=>{this.hookUpRevitListener()},{once:!0})}viewerVisible(){return this.viewerVisible$.getValue()}getViewpoint$(){const W=this.newTrackingId();return this.sendMessageToRevit("ViewpointGenerationRequest",W,""),this.revitMessageReceived$.pipe((0,it.x)(),(0,te.h)(oe=>"ViewpointData"===oe.messageType&&oe.trackingId===W),(0,Ve.P)(),(0,A.U)(oe=>{const Oe=oe.messagePayload;return Oe.snapshot.hasOwnProperty("snapshot_type")&&Oe.snapshot.hasOwnProperty("snapshot_data")||(Oe.snapshot={snapshot_type:"png",snapshot_data:Oe.snapshot}),Oe}))}showViewpoint(W,oe){this.viewpointsService.getViewPoint$(W,oe).subscribe(Oe=>this.sendMessageToRevit("ShowViewpoint",this.newTrackingId(),JSON.stringify(Oe)))}sendMessageToRevit(W,oe,Oe){!this.viewerVisible()||window.RevitBridge.sendMessageToRevit(W,oe,Oe)}hookUpRevitListener(){window.RevitBridge.sendMessageToOpenProject=W=>{const{messageType:oe,trackingId:Oe,messagePayload:$}=JSON.parse(W);this.revitMessageReceivedSource.next({messageType:oe,trackingId:Oe,messagePayload:JSON.parse($)})},this.viewerVisible$.next(!0)}newTrackingId(){return this.trackingIdNumber+=1,String(this.trackingIdNumber)}}Ie.\u0275fac=function(W){return new(W||Ie)(i.LFG(i.zs3))},Ie.\u0275prov=i.Yz7({token:Ie,factory:Ie.\u0275fac}),(0,r.gn)([(0,h.W)(),(0,r.w6)("design:type",C.V)],Ie.prototype,"viewpointsService",void 0);var ue=t(18869);class R{constructor(W){R.bootstrap(W)}static bootstrap(W){this.bootstrapCalled||(this.bootstrapCalled=!0,W.get(u.i).addFieldType(p,"bcfThumbnail",["BCF Thumbnail"]),W.get(E.$).register("prependedAttributeGroups",$=>{if(window.OpenProject.isBimEdition)return(0,re.Z)($)?Ae:_e}))}}R.bootstrapCalled=!1,R.\u0275fac=function(W){return new(W||R)(i.LFG(i.zs3))},R.\u0275mod=i.oAB({type:R}),R.\u0275inj=i.cJS({providers:[{provide:l.TP,useClass:ue.s,multi:!0},{provide:m.L,useFactory:L=>window.navigator.userAgent.search("Revit")>-1?new Ie(L):L.get(y.T,new y.T(L)),deps:[i.zs3]},g,a.b,C.V],imports:[[e.H,c.ji]]})},64533:(H,D,t)=>{"use strict";t.d(D,{T:()=>E});var i=t(3786),e=t(62967);class c{constructor(w){this.pathHelper=w,this.ifcModels=window.gon.ifc_models}getProjects(w,x){w({projects:this.ifcModels.projects})}getProject(w,x,k){x({id:w[0].id,name:w[0].name,models:this.ifcModels.models,viewerContent:{modelsLoaded:this.ifcModels.shown_models},viewerConfigs:{}})}getGeometry(w,x,k,b){const v=this.ifcModels.xkt_attachment_ids[x];console.log(`Loading model geometry for: ${v}`),e.P6.loadArraybuffer(this.pathHelper.attachmentContentPath(v),k,b)}}var u=t(38998),r=t(76491),n=t(81134),h=t(70233),a=t(12084),p=t(29161),l=t(3412),d=t(65146),g=t(53882),C=t(31760),y=t(10190),m=t(2316);class E extends u.L{constructor(w){super(w),this.injector=w,this.shouldShowViewer=!0,this.viewerVisible$=new r.X(!1),this.inspectorVisible$=new r.X(!1)}newViewer(w,x){const k=new c(this.pathHelper),b=new C.po(k,w);b.on("modelLoaded",()=>this.viewerVisible$.next(!0)),b.loadProject(x[0].id),b.on("addModel",()=>{window.location.href=this.pathHelper.ifcModelsNewPath(this.currentProjectService.identifier)}),b.on("openInspector",()=>{this.inspectorVisible$.next(!0)}),b.on("editModel",v=>{window.location.href=this.pathHelper.ifcModelsEditPath(this.currentProjectService.identifier,v.modelId)}),b.on("deleteModel",v=>{const M=new FormData;M.append("authenticity_token",jQuery("meta[name=csrf-token]").attr("content")),M.append("_method","delete"),this.httpClient.post(this.pathHelper.ifcModelsDeletePath(this.currentProjectService.identifier,v.modelId),M).subscribe().add(()=>{window.location.reload()})}),this.viewer=b}destroy(){this.viewerVisible$.next(!1),this.viewer&&(this.viewer.destroy(),this.viewer=void 0)}get viewer(){return this.xeokitViewer}set viewer(w){this.xeokitViewer=w}setKeyboardEnabled(w){var x;null===(x=this.viewer)||void 0===x||x.setKeyboardEnabled(w)}getViewpoint$(){if(!this.viewer)return(0,n.of)();const x=this.viewer.saveBCFViewpoint({spacesVisible:!0,reverseClippingPlanes:!0});return x.bitmaps=null,(0,n.of)(x)}showViewpoint(w,x){if(this.viewerVisible()){const k={updateCompositeObjects:!0,reverseClippingPlanes:!0};this.viewpointsService.getViewPoint$(w,x).subscribe(b=>{var v;null===(v=this.viewer)||void 0===v||v.loadBCFViewpoint(b,k)})}else window.location.href=this.pathHelper.bimDetailsPath((0,y.Z)(w.project.href),w.id||"",x)}viewerVisible(){return!!this.viewer}}E.\u0275fac=function(w){return new(w||E)(m.LFG(m.zs3))},E.\u0275prov=m.Yz7({token:E,factory:E.\u0275fac}),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",h.j)],E.prototype,"pathHelper",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",a.y)],E.prototype,"bcfApi",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",l.V)],E.prototype,"viewpointsService",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",d.R)],E.prototype,"currentProjectService",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",g.eN)],E.prototype,"httpClient",void 0)},8368:(H,D,t)=>{"use strict";t.d(D,{jN:()=>n,iV:()=>h,IY:()=>a,JY:()=>p,sw:()=>l,zJ:()=>d});var i=t(96617),e=t(54592),c=t(43440),u=t(38998),r=t(2316);const n="cards",h="viewer",a="splitTable",p="splitCards",l="table";class d extends e.q{constructor(C,y,m){super(m),this.I18n=C,this.viewerBridgeService=y,this.querySpace=m,this.text={cards:this.I18n.t("js.views.card"),viewer:this.I18n.t("js.ifc_models.views.viewer"),splitTable:this.I18n.t("js.ifc_models.views.split"),splitCards:this.I18n.t("js.ifc_models.views.split_cards"),table:this.I18n.t("js.views.list")},this.icon={cards:"icon-view-card",viewer:"icon-view-model",splitTable:"icon-view-split-viewer-table",splitCards:"icon-view-split2",table:"icon-view-list"}}hasChanged(C){return this.current!==C.displayRepresentation}applyToQuery(C){return C.displayRepresentation=this.current,!0}valueFromQuery(C){const y=C.displayRepresentation;switch(y){case"splitCards":case"splitTable":case"cards":case"table":case"viewer":return y;default:return this.viewerBridgeService.shouldShowViewer?"splitCards":"cards"}}currentViewerState(){return this.current}}d.\u0275fac=function(C){return new(C||d)(r.LFG(i.D),r.LFG(u.L),r.LFG(c.q))},d.\u0275prov=r.Yz7({token:d,factory:d.\u0275fac})},84308:(H,D,t)=>{"use strict";t.d(D,{X:()=>c});var i=t(24e3),e=t(2316);class c{constructor(r){this.bannersService=r,this.mapping={}}add(r,n){this.mapping[r]=n}available(){return _.map(this.mapping,(r,n)=>({attribute:n,text:r.localizedName,icon:"",description:"",image:"",disabled:this.bannersService.eeShowBanners}))}get(r){if(this.mapping[r])return this.mapping[r];throw new Error(`No action service exists for ${r}`)}}c.\u0275fac=function(r){return new(r||c)(e.LFG(i.j))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})},24335:(H,D,t)=>{"use strict";t.d(D,{s:()=>l});var i=t(3786),e=t(65146),c=t(70233),u=t(91923),r=t(96617),n=t(36293),h=t(20979),a=t(75421),p=t(2316);class l{constructor(g,C,y,m,E,P){this.CurrentProject=g,this.pathHelper=C,this.apiV3Service=y,this.halResourceService=m,this.toastService=E,this.I18n=P,this.v3=this.pathHelper.api.v3}create(g,C){const y=JSON.stringify(C);return this.apiV3Service.queries.form.loadWithParams({pageSize:0,filters:y},void 0,this.CurrentProject.identifier,this.buildQueryRequest(g)).toPromise().then(([m,E])=>{if(m.schema.public.writable)return this.apiV3Service.queries.post(E,m).toPromise();throw new Error(this.I18n.t("js.boards.error_permission_missing"))})}addFreeQuery(g,C){const y=this.freeBoardQueryFilter();return this.addQuery(g,C,[y])}addQuery(g,C,y){return(0,i.mG)(this,void 0,void 0,function*(){const m=g.queries.length;try{const P={_type:"GridWidget",identifier:"work_package_query",startRow:1,endRow:2,startColumn:m+1,endColumn:m+2,options:{queryId:(yield this.create(C,y)).id,filters:y}},w=this.halResourceService.createHalResourceOfClass(a.z,P);g.addQuery(w)}catch(E){this.toastService.addError(E),console.error(E)}return g})}buildQueryRequest(g){return Object.assign({public:!0,_links:{sortBy:[{href:`${this.v3.apiV3Base}/queries/sort_bys/manualSorting-asc`},{href:`${this.v3.apiV3Base}/queries/sort_bys/id-asc`}]}},g)}freeBoardQueryFilter(){return{manualSort:{operator:"ow",values:[]}}}}l.\u0275fac=function(g){return new(g||l)(p.LFG(e.R),p.LFG(c.j),p.LFG(h.T),p.LFG(u.u),p.LFG(n.kl),p.LFG(r.D))},l.\u0275prov=p.Yz7({token:l,factory:l.\u0275fac,providedIn:"root"})},3216:(H,D,t)=>{"use strict";t.d(D,{$:()=>d});var i=t(3786),e=t(24335),c=t(91923),u=t(70233),r=t(65146),n=t(96617),h=t(84308),a=t(76491),p=t(20979),l=t(2316);class d{constructor(C,y,m,E,P,w,x){this.apiV3Service=C,this.PathHelper=y,this.CurrentProject=m,this.halResourceService=E,this.boardActions=P,this.I18n=w,this.boardsList=x,this.currentBoard$=new a.X(null),this.text={unnamed_board:this.I18n.t("js.boards.label_unnamed_board"),action_board:k=>this.I18n.t("js.boards.board_type.action_by_attribute",{attribute:this.I18n.t(`js.boards.board_type.action_type.${k}`)}),unnamed_list:this.I18n.t("js.boards.label_unnamed_list")}}loadAllBoards(C=this.CurrentProject.identifier,y=!1){return y||void 0===this.loadAllPromise?this.loadAllPromise=this.apiV3Service.boards.allInScope(C).toPromise():this.loadAllPromise}canManage(C){return!!C.grid.$links.delete}save(C){return this.reorderWidgets(C),this.apiV3Service.boards.id(C).save(C)}create(C){return(0,i.mG)(this,void 0,void 0,function*(){const y=yield this.apiV3Service.boards.create(C.type,this.boardName(C),this.CurrentProject.identifier,C.attribute).toPromise();return"free"===C.type?yield this.boardsList.addFreeQuery(y,{name:this.text.unnamed_list}):yield this.boardActions.get(C.attribute).addInitialColumnsForAction(y),yield this.save(y).toPromise(),y})}delete(C){return this.apiV3Service.boards.id(C).delete().toPromise()}boardName(C){return C.boardName?C.boardName:"action"===C.type?this.text.action_board(C.attribute):this.text.unnamed_board}reorderWidgets(C){C.grid.columnCount=Math.max(C.grid.widgets.length,1),C.grid.widgets.map((y,m)=>(y.startColumn=m+1,y.endColumn=m+2,y))}}d.\u0275fac=function(C){return new(C||d)(l.LFG(p.T),l.LFG(u.j),l.LFG(r.R),l.LFG(c.u),l.LFG(h.X),l.LFG(n.D),l.LFG(e.s))},d.\u0275prov=l.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})},64538:(H,D,t)=>{"use strict";t.d(D,{h:()=>e});var i=t(2316);class e{constructor(){this.causedUpdates=[]}includes(u){return this.causedUpdates.includes(this.cacheValue(u))}add(u){this.causedUpdates.length>100&&this.causedUpdates.splice(0,90),this.causedUpdates.push(this.cacheValue(u))}cacheValue(u){return u.updatedAt+u.href}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac})},56945:(H,D,t)=>{"use strict";t.d(D,{r:()=>b});var i=t(60312),e=t(77355),c=t(96617),u=t(47775),r=t(3216),n=t(84308),h=t(86469),a=t(67727),p=t(97656),l=t(24e3),d=t(36293),g=t(2316),C=t(52932),y=t(54364);function m(v,M){if(1&v){const S=g.EpF();g.TgZ(0,"button",2),g.NdJ("click",function(){const F=g.CHM(S).$implicit;return g.oxw().created(F.attribute)}),g._UZ(1,"img",3),g.TgZ(2,"div"),g.TgZ(3,"span",4),g._uU(4),g.qZA(),g._UZ(5,"p",5),g.qZA(),g.qZA()}if(2&v){const S=M.$implicit,O=g.oxw();g.Q6J("disabled",S.disabled||O.disable),g.xp6(1),g.Q6J("src",S.image,g.LSH),g.xp6(3),g.Oqu(S.text),g.xp6(1),g.Q6J("textContent",S.description)}}class E{constructor(){this.disable=!1,this.create=new g.vpe}created(M){this.create.emit(M)}}E.\u0275fac=function(M){return new(M||E)},E.\u0275cmp=g.Xpm({type:E,selectors:[["tile-view"]],inputs:{tiles:"tiles",disable:"disable"},outputs:{create:"create"},decls:2,vars:1,consts:[[1,"op-tile-block"],["class","op-tile-block--tile button","data-qa-selector","op-tile-block","type","button",3,"disabled","click",4,"ngFor","ngForOf"],["data-qa-selector","op-tile-block","type","button",1,"op-tile-block--tile","button",3,"disabled","click"],[1,"op-tile-block--image",3,"src"],["data-qa-selector","op-tile-block-title",1,"op-tile-block--title"],[1,"op-tile-block--description",3,"textContent"]],template:function(M,S){1&M&&(g.TgZ(0,"div",0),g.YNc(1,m,6,4,"button",1),g.qZA()),2&M&&(g.xp6(1),g.Q6J("ngForOf",S.tiles))},directives:[y.sg],styles:[".op-tile-block[_ngcontent-%COMP%]{display:grid;grid-template-rows:repeat(minmax(200px,auto));grid-template-columns:auto auto;grid-column-gap:10px;grid-row-gap:10px}.op-tile-block--tile[_ngcontent-%COMP%]{border-radius:10px;display:grid;grid-template:95px 1fr/1fr;grid-template-columns:auto 1fr auto;grid-template-rows:auto;grid-row-gap:5px;justify-items:left;background:#f7fafc;min-height:150px}.op-tile-block--tile[_ngcontent-%COMP%]:disabled{background:#fafafa}.op-tile-block--tile[_ngcontent-%COMP%]:hover{text-decoration:none;border:1px solid grey;border-radius:10px!important;cursor:pointer}.op-tile-block--image[_ngcontent-%COMP%]{display:block;margin-top:auto;margin-bottom:auto}.op-tile-block--title[_ngcontent-%COMP%]{padding-top:30px;padding-bottom:5px;color:var(--primary-color-dark);display:block;text-align:left;font-weight:bolder;font-size:large}.op-tile-block--description[_ngcontent-%COMP%]{text-align:left;width:90%}"],changeDetection:0});var P=t(8158);const w=["actionAttributeSelect"];function x(v,M){if(1&v&&g._UZ(0,"enterprise-banner",7),2&v){const S=g.oxw();g.Q6J("linkMessage",S.text.upgrade_to_ee_text)("textMessage",S.text.teaser_text)}}function k(v,M){if(1&v&&g._UZ(0,"p",8),2&v){const S=g.oxw();g.Q6J("textContent",S.text.select_board_type)}}class b extends i.T{constructor(M,S,O,A,F,I,J,N,te,ee,G,se){super(M,O,S),this.locals=M,this.elementRef=S,this.cdRef=O,this.state=A,this.boardService=F,this.boardActions=I,this.halNotification=J,this.loadingIndicatorService=N,this.I18n=te,this.boardActionRegistry=ee,this.bannersService=G,this.toastService=se,this.showClose=!0,this.confirmed=!1,this.available=this.boardActions.available(),this.inFlight=!1,this.eeShowBanners=!1,this.text={close_popup:this.I18n.t("js.close_popup_title"),free_board:this.I18n.t("js.boards.board_type.free"),free_board_text:this.I18n.t("js.boards.board_type.free_text"),free_board_title:this.I18n.t("js.boards.board_type.board_type_title.basic"),board_type:this.I18n.t("js.boards.board_type.text"),action_board:this.I18n.t("js.boards.board_type.action"),action_board_text:this.I18n.t("js.boards.board_type.action_text"),select_attribute:this.I18n.t("js.boards.board_type.select_attribute"),select_board_type:this.I18n.t("js.boards.board_type.select_board_type"),placeholder:this.I18n.t("js.placeholders.selection"),teaser_text:this.I18n.t("js.boards.upsale.teaser_text"),upgrade_to_ee_text:this.I18n.t("js.boards.upsale.upgrade")},this.initiateTiles()}ngOnInit(){super.ngOnInit(),this.eeShowBanners=this.bannersService.eeShowBanners}createBoard(M){"basic"===M?this.createFree():this.createAction(M)}initiateTiles(){this.available.unshift({attribute:"basic",text:this.text.free_board_title,icon:"icon-boards",description:this.text.free_board_text,image:(0,p.h)("board_creation_modal/lists.svg")}),this.addIcon(this.available),this.addDescription(this.available),this.addText(this.available),this.addImage(this.available)}createFree(){this.create({type:"free"})}createAction(M){this.eeShowBanners?this.toastService.addError(this.I18n.t("js.upsale.ee_only")):this.create({type:"action",attribute:M})}create(M){this.inFlight=!0,this.loadingIndicatorService.modal.promise=this.boardService.create(M).then(S=>{this.inFlight=!1,this.closeMe(),this.state.go("boards.partitioned.show",{board_id:S.id,isNew:!0})}).catch(S=>{this.inFlight=!1,this.halNotification.handleRawError(S)})}addDescription(M){M.forEach(S=>{if("basic"!==S.attribute){const O=this.boardActionRegistry.get(S.attribute);S.description=O.description}})}addIcon(M){M.forEach(S=>{if("basic"!==S.attribute){const O=this.boardActionRegistry.get(S.attribute);S.icon=O.icon}})}addText(M){M.forEach(S=>{if("basic"!==S.attribute){const O=this.boardActionRegistry.get(S.attribute);S.text=O.text}})}addImage(M){M.forEach(S=>{if("basic"!==S.attribute){const O=this.boardActionRegistry.get(S.attribute);S.image=O.image}})}}b.\u0275fac=function(M){return new(M||b)(g.Y36(e.E),g.Y36(g.SBq),g.Y36(g.sBO),g.Y36(u.StateService),g.Y36(r.$),g.Y36(n.X),g.Y36(a.W),g.Y36(h.vt),g.Y36(c.D),g.Y36(n.X),g.Y36(l.j),g.Y36(d.kl))},b.\u0275cmp=g.Xpm({type:b,selectors:[["ng-component"]],viewQuery:function(M,S){if(1&M&&g.Gf(w,7),2&M){let O;g.iGM(O=g.CRH())&&(S.actionAttributeSelect=O.first)}},features:[g.qOj],decls:8,vars:5,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_wide","confirm-form-submit--modal","loading-indicator--location"],[3,"close"],[1,"op-modal--body"],["opReferrer","boards",3,"linkMessage","textMessage",4,"ngIf"],[3,"textContent",4,"ngIf"],[1,"new-board--section"],[3,"tiles","disable","create"],["opReferrer","boards",3,"linkMessage","textMessage"],[3,"textContent"]],template:function(M,S){1&M&&(g.TgZ(0,"div",0),g.TgZ(1,"op-modal-header",1),g.NdJ("close",function(A){return S.closeMe(A)}),g._uU(2),g.qZA(),g.TgZ(3,"div",2),g.YNc(4,x,1,2,"enterprise-banner",3),g.YNc(5,k,1,1,"p",4),g.TgZ(6,"section",5),g.TgZ(7,"tile-view",6),g.NdJ("create",function(A){return S.createBoard(A)}),g.qZA(),g.qZA(),g.qZA(),g.qZA()),2&M&&(g.xp6(2),g.Oqu(S.text.board_type),g.xp6(2),g.Q6J("ngIf",S.eeShowBanners),g.xp6(1),g.Q6J("ngIf",!S.eeShowBanners),g.xp6(2),g.Q6J("tiles",S.available)("disable",S.inFlight))},directives:[C.g,y.O5,E,P.P],encapsulation:2})},18640:(H,D,t)=>{"use strict";t.d(D,{j:()=>N});var i=t(3786),e=t(96617),c=t(12877),u=t(44022),r=t(70482),n=t(36293),h=t(79441),a=t(74647),p=t(61043),l=t(43440),d=t(26942),g=t(53466),C=t(91923),y=t(55977),m=t(20979),E=t(47775),P=t(70692),w=t(81539),x=t(12703),k=t(2281),v=t(60914),M=t(67325),S=t(20506),O=t(3352),A=t(99794),F=t(20342),I=t(2316),J=t(71570);class N extends d.N{constructor(ee,G,se,me,_e,he,ae,re,ye,Ce,ke,Ae,Fe,ot,it,Ve,Ie,ue,ie){super(),this.I18n=ee,this.configuration=G,this.sanitizer=se,this.$state=me,this.injector=_e,this.schemaCache=he,this.toastService=ae,this.wpTableFilters=re,this.wpListService=ye,this.wpListChecksumService=Ce,this.urlParamsHelper=ke,this.querySpace=Ae,this.apiV3Service=Fe,this.halResourceService=ot,this.uiRouterGlobals=it,this.timezoneService=Ve,this.halEditing=Ie,this.wpTableSelection=ue,this.contextMenuService=ie,this.resize$=new h.xQ,this.currentWorkPackages$=this.querySpace.results.values$().pipe((0,g.q)(1))}workPackagesListener$(ee){this.querySpace.results.values$().pipe(this.untilDestroyed()).subscribe(()=>{ee()})}calendarOptions(ee){return Object.assign(Object.assign({},this.defaultOptions()),ee)}eventDate(ee,G){return this.isMilestone(ee)?ee.date:ee[`${G}Date`]}isMilestone(ee){return this.schemaCache.of(ee).isMilestone}warnOnTooManyResults(ee,G=!1){ee.count<ee.total?this.tooManyResultsText=this.I18n.t("js.calendar.too_many",{count:ee.total,max:N.MAX_DISPLAYED}):this.tooManyResultsText=null,this.tooManyResultsText&&!G&&this.toastService.addNotice(this.tooManyResultsText)}resizeObserver(ee){!ee||(this.resizeObs||(this.resizeObs=new ResizeObserver(()=>this.resize$.next())),this.resizeObs.observe(ee.nativeElement))}updateTimeframe(ee,G){return(0,i.mG)(this,void 0,void 0,function*(){if(this.areFiltersEmpty&&this.querySpace.query.value)return Promise.resolve();const se=k(ee.start).format("YYYY-MM-DD"),me=k(ee.end).format("YYYY-MM-DD");let he,_e=null;if(this.urlParams.query_id&&(_e=this.urlParams.query_id),this.initializingWithQuery){const ae=yield this.apiV3Service.queries.find({pageSize:0},_e).toPromise();he=this.generateQueryProps(ae,se,me)}else if(this.initializingWithQueryProps)if(this.urlParams.query_props){const ae=JSON.parse(this.urlParams.query_props),re=Object.assign(Object.assign({},ae),{f:[...ae.f.filter(ye=>"datesInterval"!==ye.n),N.dateFilter(se,me)]});he=JSON.stringify(re)}else he=N.defaultQueryProps(se,me);else he=this.generateQueryProps(this.querySpace.query.value,se,me),this.wpListChecksumService.set(_e,he);return this.wpListService.fromQueryParams({query_id:_e,query_props:he},G||void 0).toPromise()})}generateQueryProps(ee,G,se){return this.urlParamsHelper.encodeQueryJsonParams(ee,me=>Object.assign(Object.assign({},me),{pp:N.MAX_DISPLAYED,pa:1,f:[...me.f.filter(_e=>"datesInterval"!==_e.n),N.dateFilter(G,se)]}))}get initialView(){return this.urlParams.cview}dateEditable(ee){const G=this.schemaCache.of(ee),se=G.isAttributeEditable("startDate")&&G.isAttributeEditable("dueDate");return(ee.isLeaf||ee.scheduleManually)&&se}eventDurationEditable(ee){return this.dateEditable(ee)&&!this.isMilestone(ee)}getEndDateFromTimestamp(ee){return k(ee).subtract(1,"d").format("YYYY-MM-DD")}openSplitView(ee,G=!1){this.wpTableSelection.setSelection(ee,-1),(!G||this.$state.includes("**.details.*"))&&this.$state.go(`${(0,r.W)(this.$state)}.tabs`,{workPackageId:ee,tabIdentifier:"overview"})}onCardClicked({workPackageId:ee,event:G}){(0,M.F)(G)||this.openSplitView(ee,!0)}showEventContextMenu({workPackageId:ee,event:G}){if((0,M.F)(G))return;if(G.target.closest(`.${S.yF}`))return void(0,O.qu)("Allowing original context menu on state link");this.wpTableSelection.setSelection(ee,-1),G.preventDefault();const se=new A.X(this.injector,ee,jQuery(G.target));this.contextMenuService.show(se,G)}defaultOptions(){return{editable:!1,locale:this.I18n.locale,fixedWeekCount:!1,firstDay:this.configuration.startOfWeek(),timeZone:this.configuration.isTimezoneSet()?this.configuration.timezone():"local",height:"auto",headerToolbar:{left:"prev,next today",center:"title",right:""},initialDate:this.initialDate,initialView:this.initialView,datesSet:ee=>this.updateDateParam(ee)}}static defaultQueryProps(ee,G){const se={c:["id"],t:"id:asc",f:[{n:"status",o:"*",v:[]},this.dateFilter(ee,G)],dr:"cards",hi:!1,pp:N.MAX_DISPLAYED,pa:1};return JSON.stringify(se)}static dateFilter(ee,G){return{n:"datesInterval",o:"<>d",v:[ee,G]}}get initializingWithQueryProps(){return this.areFiltersEmpty||this.urlParams.query_props}get initializingWithQuery(){return this.areFiltersEmpty&&!!this.urlParams.query_id&&!this.urlParams.query_props}get urlParams(){return this.uiRouterGlobals.params}get areFiltersEmpty(){return this.wpTableFilters.isEmpty}get initialDate(){const ee=this.urlParams.cdate;if(ee)return this.timezoneService.formattedISODate(ee)}updateDateParam(ee){this.$state.go(".",{cdate:this.timezoneService.formattedISODate(ee.view.currentStart),cview:ee.view.type},{custom:{notify:!1}})}updateDates(ee){const G=ee.event.extendedProps.workPackage,se=this.halEditing.edit(G);se.setValue("startDate",ee.event.startStr);const me=k(ee.event.endStr).subtract(1,"day").format("YYYY-MM-DD");return se.setValue("dueDate",me),se}}N.MAX_DISPLAYED=100,N.\u0275fac=function(ee){return new(ee||N)(I.LFG(e.D),I.LFG(c.e),I.LFG(J.H7),I.LFG(E.StateService),I.LFG(I.zs3),I.LFG(u.y),I.LFG(n.kl),I.LFG(a.Z),I.LFG(p.Z),I.LFG(w.Y),I.LFG(y.Z),I.LFG(l.q),I.LFG(m.T),I.LFG(C.u),I.LFG(E.UIRouterGlobals),I.LFG(P.B),I.LFG(x.l),I.LFG(v.J),I.LFG(F.$))},N.\u0275prov=I.Yz7({token:N,factory:N.\u0275fac})},51303:(H,D,t)=>{"use strict";t.r(D),t.d(D,{OpenprojectCalendarModule:()=>N});var i=t(21757),e=t(76910),c=t(99250),u=t(84906),r=t(65084),n=t(54349),h=t(46430),a=t(85603),p=t(1813),l=t(15334),d=t(57973),g=t(77434),C=t(22956),y=t(11266),m=t(52025),E=t(91654),P=t(35561),w=t(2316),x=t(54364),k=t(77616),b=t(81628),v=t(32853);function M(te,ee){if(1&te&&w._UZ(0,"op-back-button",11),2&te){const G=w.oxw();w.Q6J("customBackMethod",G.backButtonCallback)}}function S(te,ee){if(1&te&&(w.TgZ(0,"li",15),w._UZ(1,"ndc-dynamic",16),w.qZA()),2&te){const G=w.oxw().$implicit,se=w.oxw(2);w.Q6J("ngClass",G.containerClasses),w.xp6(1),w.Q6J("ndcDynamicComponent",G.component)("ndcDynamicInputs",G.inputs)("ndcDynamicInjector",se.injector)("ndcDynamicOutputs",G.outputs)}}function O(te,ee){if(1&te&&(w.ynx(0),w.YNc(1,S,2,5,"li",14),w.BQk()),2&te){const G=ee.$implicit;w.xp6(1),w.Q6J("ngIf",!G.show||G.show())}}function A(te,ee){if(1&te&&(w.TgZ(0,"ul",12),w.YNc(1,O,2,1,"ng-container",13),w.qZA()),2&te){const G=w.oxw();w.xp6(1),w.Q6J("ngForOf",G.toolbarButtonComponents)}}function F(te,ee){if(1&te&&w._UZ(0,"ndc-dynamic",17),2&te){const G=w.oxw();w.Q6J("ndcDynamicComponent",G.filterContainerDefinition.component)("ndcDynamicInputs",G.filterContainerDefinition.inputs)("ndcDynamicOutputs",G.filterContainerDefinition.outputs)("ndcDynamicInjector",G.injector)}}class I extends d.r{constructor(){super(...arguments),this.text={title:this.I18n.t("js.calendar.title"),unsaved_title:this.I18n.t("js.calendar.unsaved_title")},this.selectedTitle=this.text.unsaved_title,this.filterContainerDefinition={component:g.J},this.currentPartition="-split",this.showToolbar=!0,this.titleEditingEnabled=!1,this.showToolbarSaveButton=!0,this.toolbarDisabled=!1,this.toolbarButtonComponents=[{component:P.P},{component:C.U},{component:y.a},{component:m.b,containerClasses:"hidden-for-mobile",show:()=>this.authorisationService.can("query","updateImmediately"),inputs:{hideTableOptions:!0}}]}setPartition(ee){var G;this.currentPartition=(null===(G=ee.data)||void 0===G?void 0:G.partition)||"-split"}staticQueryName(ee){return this.text.unsaved_title}loadInitialQuery(){}}I.\u0275fac=function(){let te;return function(G){return(te||(te=w.n5z(I)))(G||I)}}(),I.\u0275cmp=w.Xpm({type:I,selectors:[["ng-component"]],viewQuery:function(ee,G){if(1&ee&&w.Gf(l.X,7),2&ee){let se;w.iGM(se=w.CRH())&&(G.calendarElement=se.first)}},features:[w._Bn([E.E]),w.qOj],decls:11,vars:8,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["class","op-back-button","linkClass","op-back-button_mobile-full-width",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector",4,"ngIf"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","op-back-button_mobile-full-width",1,"op-back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"]],template:function(ee,G){1&ee&&(w.TgZ(0,"div",0),w.TgZ(1,"div",1),w.TgZ(2,"div",2),w.YNc(3,M,1,1,"op-back-button",3),w.TgZ(4,"editable-toolbar-title",4),w.NdJ("onSave",function(me){return G.changeChangesFromTitle(me)})("onEmptySubmit",function(){return G.updateTitleName("")}),w.qZA(),w.YNc(5,A,2,1,"ul",5),w.qZA(),w.qZA(),w.TgZ(6,"div",6),w.YNc(7,F,1,4,"ndc-dynamic",7),w.qZA(),w.TgZ(8,"div",8),w._UZ(9,"div",9),w._UZ(10,"div",10),w.qZA(),w.qZA()),2&ee&&(w.Q6J("ngClass",G.currentPartition),w.xp6(3),w.Q6J("ngIf",G.backButtonCallback),w.xp6(1),w.Q6J("title",G.selectedTitle)("inFlight",G.toolbarDisabled)("showSaveCondition",G.showToolbarSaveButton)("editable",G.titleEditingEnabled),w.xp6(1),w.Q6J("ngIf",G.showToolbar),w.xp6(2),w.Q6J("ngIf",G.filterContainerDefinition))},directives:[x.mk,x.O5,k.s5,u.UIView,b.W,x.sg,v.B5,v.oc],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr);margin-left:-10px;padding-left:10px;width:calc(100% + 10px)}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{flex-grow:1}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .title-container_editable[_ngcontent-%COMP%]{margin-left:-7px}@media only screen and (max-width: 679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:initial;max-width:100vw;max-height:100%}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;justify-items:start}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .op-back-button[_ngcontent-%COMP%]{grid-column:1/3;grid-row:1/2}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{grid-column:1/2;grid-row:2/3;overflow:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-items[_ngcontent-%COMP%]{grid-column:2/3;grid-row:2/3}}"],changeDetection:0});const J=[{name:"calendar",parent:"optional_project",url:"/calendars/:query_id?&query_props&cdate&cview",redirectTo:"calendar.page",views:{"!$default":{component:p.p}},params:{query_id:{type:"opQueryId",dynamic:!0},cdate:{type:"string",dynamic:!0},cview:{type:"string",dynamic:!0},query_props:{type:"opQueryString"}}},{name:"calendar.page",component:I,redirectTo:"calendar.page.show",data:{bodyClasses:"router--calendar"}},{name:"calendar.page.show",data:{baseRoute:"calendar.page.show"},views:{"content-left":{component:l.X}}},...(0,h.Z)("calendar.page.show",void 0,a.o)];class N{}N.\u0275fac=function(ee){return new(ee||N)},N.\u0275mod=w.oAB({type:N}),N.\u0275inj=w.cJS({imports:[[i.H,u.UIRouterModule.forChild({states:J}),c.H,n.I,r.E,e.z1U]]})},15334:(H,D,t)=>{"use strict";t.d(D,{X:()=>ee});var i=t(3786),e=t(2316),c=t(76910),u=t(87853),r=t(43440),n=t(74647),h=t(2281),p=t(61043),l=t(47775),d=t(96617),g=t(36293),C=t(57810),y=t(94891),m=t(80639),E=t(12877),P=t(26942),w=t(44022),x=t(18640),k=t(79441),b=t(65146),v=t(17281),M=t(12703),S=t(67727),O=t(70482),A=t(71570),F=t(54364);const I=["ucCalendar"];function J(G,se){if(1&G&&e._UZ(0,"full-calendar",4,5),2&G){const me=e.oxw().ngIf;e.Q6J("options",me)}}function N(G,se){if(1&G&&(e.ynx(0),e.YNc(1,J,2,1,"full-calendar",3),e.BQk()),2&G){const me=se.ngIf;e.xp6(1),e.Q6J("ngIf",me)}}function te(G,se){if(1&G&&e._UZ(0,"div",6),2&G){const me=e.oxw();e.Q6J("textContent",me.calendar.tooManyResultsText)}}class ee extends P.N{constructor(se,me,_e,he,ae,re,ye,Ce,ke,Ae,Fe,ot,it,Ve,Ie,ue){super(),this.states=se,this.$state=me,this.wpTableFilters=_e,this.wpListService=he,this.querySpace=ae,this.schemaCache=re,this.titleService=ye,this.element=Ce,this.i18n=ke,this.toastService=Ae,this.sanitizer=Fe,this.configuration=ot,this.calendar=it,this.currentProject=Ve,this.halEditing=Ie,this.halNotification=ue,this.static=!1,this.calendarOptions$=new k.xQ,this.alreadyLoaded=!1}set ucCalendarElement(se){this.calendar.resizeObserver(se)}ngOnInit(){this.wpTableFilters.hidden.push("project"),this.calendar.resize$.pipe(this.untilDestroyed(),(0,m.b)(50)).subscribe(()=>{this.ucCalendar.getApi().updateSize()}),this.querySpace.stopAllSubscriptions.next(),this.setupWorkPackagesListener(),this.initializeCalendar()}calendarEventsFunction(se,me){if(this.alreadyLoaded){this.alreadyLoaded=!1;const _e=this.updateResults(this.querySpace.results.value);me(_e)}else this.calendar.currentWorkPackages$.subscribe(_e=>{const he=this.updateResults(_e);me(he)});this.calendar.updateTimeframe(se,this.currentProject.identifier||void 0)}ngOnDestroy(){var se;super.ngOnDestroy(),null===(se=this.calendar.resizeObs)||void 0===se||se.disconnect()}initializeCalendar(){const se={height:"100%",headerToolbar:this.buildHeader(),events:this.calendarEventsFunction.bind(this),plugins:[y.ZP,v.ZP],selectable:!0,select:this.handleDateClicked.bind(this),eventResizableFromStart:!0,editable:!0,eventDidMount:me=>{const{el:_e,event:he}=me,ae=he.extendedProps.workPackage;_e.dataset.workPackageId=ae.id},eventResize:me=>this.updateEvent(me),eventDrop:me=>this.updateEvent(me),eventClick:me=>{const _e=me.event.extendedProps.workPackage.id;this.$state.includes("calendar")?this.calendar.openSplitView(_e):this.$state.go("work-packages.show",{workPackageId:_e})}};this.static&&(se.initialView="dayGridWeek"),this.configuration.initialized.then(()=>{this.calendarOptions$.next(this.calendar.calendarOptions(se))})}buildHeader(){return!this.static&&{right:"dayGridMonth,dayGridWeek",center:"title",left:"prev,next today"}}openContextMenu(se){const me=se.target.closest(".fc-event");if(!me)return;const _e=me.dataset.workPackageId;this.calendar.showEventContextMenu({workPackageId:_e,event:se})}setupWorkPackagesListener(){this.calendar.workPackagesListener$(()=>{this.alreadyLoaded=!0,this.ucCalendar.getApi().refetchEvents()})}updateResults(se){return this.calendar.warnOnTooManyResults(se,this.static),this.mapToCalendarEvents(se.elements)}mapToCalendarEvents(se){return se.map(_e=>{const he=this.calendar.eventDate(_e,"start"),ae=this.calendar.eventDate(_e,"due"),re=h(ae).add(1,"days").format("YYYY-MM-DD");return{title:_e.subject,start:he,editable:this.calendar.eventDurationEditable(_e),end:re,allDay:!0,className:`__hl_background_type_${_e.type.id}`,workPackage:_e}})}get initialView(){return this.static?"dayGridWeek":void 0}updateEvent(se){return(0,i.mG)(this,void 0,void 0,function*(){const me=this.calendar.updateDates(se);try{const _e=yield this.halEditing.save(me);this.halNotification.showSave(_e.resource,_e.wasNew)}catch(_e){this.halNotification.handleRawError(_e,me.projectedResource),se.revert()}})}handleDateClicked(se){const me={startDate:se.startStr,dueDate:this.calendar.getEndDateFromTimestamp(se.end)};this.$state.go((0,O.W)(this.$state,"new"),{defaults:me,tabIdentifier:"overview"})}}ee.\u0275fac=function(se){return new(se||ee)(e.Y36(u.G),e.Y36(l.StateService),e.Y36(n.Z),e.Y36(p.Z),e.Y36(r.q),e.Y36(w.y),e.Y36(C.V),e.Y36(e.SBq),e.Y36(d.D),e.Y36(g.kl),e.Y36(A.H7),e.Y36(E.e),e.Y36(x.j),e.Y36(b.R),e.Y36(M.l),e.Y36(S.W))},ee.\u0275cmp=e.Xpm({type:ee,selectors:[["op-wp-calendar"]],viewQuery:function(se,me){if(1&se&&(e.Gf(c.woE,5),e.Gf(I,5,e.SBq)),2&se){let _e;e.iGM(_e=e.CRH())&&(me.ucCalendar=_e.first),e.iGM(_e=e.CRH())&&(me.ucCalendarElement=_e.first)}},inputs:{static:"static"},features:[e._Bn([x.j]),e.qOj],decls:4,vars:5,consts:[["data-qa-selector","op-wp-calendar",1,"op-wp-calendar",3,"contextmenu"],[4,"ngIf"],["class","op-wp-calendar--notification",3,"textContent",4,"ngIf"],[3,"options",4,"ngIf"],[3,"options"],["ucCalendar",""],[1,"op-wp-calendar--notification",3,"textContent"]],template:function(se,me){1&se&&(e.TgZ(0,"div",0),e.NdJ("contextmenu",function(he){return me.openContextMenu(he)}),e.YNc(1,N,2,1,"ng-container",1),e.ALo(2,"async"),e.YNc(3,te,1,1,"div",2),e.qZA()),2&se&&(e.uIk("data-indicator-name","table"),e.xp6(1),e.Q6J("ngIf",e.lcZ(2,3,me.calendarOptions$)),e.xp6(2),e.Q6J("ngIf",me.static))},directives:[F.O5,c.woE],pipes:[F.Ov],styles:[".op-wp-calendar[_ngcontent-%COMP%]{--fc-border-color: #cccccc;min-height:200px;height:100%}.op-wp-calendar--notification[_ngcontent-%COMP%]{font-style:italic;margin-top:.5rem}"]})},95060:(H,D,t)=>{"use strict";t.d(D,{d:()=>i});class i{constructor(c,u=null,r="",n="get",h=!1,a,p="application/json",l){this.requestMethod=c,this.href=u,this.title=r,this.method=n,this.templated=h,this.payload=a,this.type=p,this.identifier=l}static fromObject(c,u){return new i((r,n,h,a)=>c.request(r,n,h,a).toPromise(),u.href,u.title,u.method,u.templated,u.payload,u.type,u.identifier)}$fetch(...c){const[u,r]=c;return this.requestMethod(this.method,this.href,u,r)}$prepare(c){if(!this.templated)throw new Error(`The link ${this.href} is not templated.`);let u=_.clone(this.href)||"";return _.each(c,(r,n)=>{const h=new RegExp(`{${n}}`);u=u.replace(h,r)}),new i(this.requestMethod,u,this.title,this.method,!1,this.payload,this.type,this.identifier).$callable()}$callable(){const c=(...u)=>this.$fetch(...u);return _.extend(c,{$link:this,href:this.href,title:this.title,method:this.method,templated:this.templated,payload:this.payload,type:this.type,identifier:this.identifier}),c}}},91720:(H,D,t)=>{"use strict";t.d(D,{FQ:()=>u,EZ:()=>n});var c,i=t(43348),e=t(95060);function u(h){return _.isNil(h)?[]:h.map(a=>a.$copy())}function n(h,a){function l(w,x=!0){return _.isNil(w)?w:w._links||w._embedded||w._type?h.createHalResource(w,x):w}function y(w,x){const k=`$${w}`,b=`_${w}`,v=a.$source[b];_.isObject(v)&&Object.keys(v).forEach(M=>{c.lazy(a[k],M,()=>x(v[M]))})}function P(w,x){const k=Array.isArray(w);if(w)if(k)a.$source._links[x]=w.map(b=>({href:b.href}));else if(w.hasOwnProperty("$link")){const b=w.$link;b.href&&(a.$source._links[x]=b)}else"href"in w&&(a.$source._links[x]={href:w.href});else a.$source._links[x]={href:null};return a.$embedded&&a.$embedded[x]&&(a.$embedded[x]=w,a.$source._embedded[x]=k?w.map(b=>b.$source):_.get(w,"$source",w)),w}a.$source._links||(a.$source._links={}),a.$source._links.self||(a.$source._links.self={href:null}),y("links",w=>Array.isArray(w)?w.map(x=>e.d.fromObject(h,x).$callable()):e.d.fromObject(h,w).$callable()),y("embedded",w=>Array.isArray(w)?w.map(x=>l(x,!0)):(_.isObject(w)&&_.each(w,(x,k)=>{x&&(x._embedded||x._links)&&c.lazy(w,k,()=>l(x,!0))}),l(w,!0))),a.$embeddableKeys().forEach(w=>{Object.defineProperty(a,w,{get:()=>l(a.$source[w],!0),set(x){a.$source[w]=x},enumerable:!0,configurable:!0})}),a.$linkableKeys().forEach(w=>{c.lazy(a,w,()=>{const x=a.$links[w].$link||a.$links[w];if(Array.isArray(x)){const b=x.map(v=>h.createLinkedResource(a,w,v.$link));var k=new i(...b).on("change",()=>{k.forEach(v=>{v.$link||k.splice(k.indexOf(v),1)}),a.$source._links[w]=k.map(v=>v.$link)});return k}return x.href?"get"!==x.method?e.d.fromObject(h,x).$callable():h.createLinkedResource(a,w,x):null},x=>P(x,w))}),!a.$source._embedded||Object.keys(a.$source._embedded).forEach(w=>{c.lazy(a,w,()=>a.$embedded[w],x=>P(x,w))})}(c||(c={})).lazy=function(p,l,d,g){if(_.isObject(p)){let y,C=!1;const m={get:()=>(C||(y=d(),C=!0),y),set:()=>{},configurable:!0,enumerable:!0};g&&(m.set=E=>{y=g(E),C=!0}),Object.defineProperty(p,l,m)}}},10190:(H,D,t)=>{"use strict";function i(e){const c=(e||"").split("/").pop();return decodeURIComponent(c)}t.d(D,{Z:()=>i})},84699:(H,D,t)=>{"use strict";t.d(D,{m:()=>i,Z:()=>e});const i="new";function e(c){return!c.id||c.id===i}},48934:(H,D,t)=>{"use strict";function i(e){return!(!e.id||"new"===e.id)}t.d(D,{Z:()=>i})},18869:(H,D,t)=>{"use strict";t.d(D,{s:()=>e});var i=t(2316);class e{intercept(u,r){const n=jQuery("meta[name=csrf-token]").attr("content");if(!1!==u.withCredentials){let h=u.headers.set("X-Authentication-Scheme","Session").set("X-Requested-With","XMLHttpRequest");n&&(h=h.set("X-CSRF-TOKEN",n));const a=u.clone({withCredentials:!0,headers:h});return r.handle(a)}return r.handle(u)}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac})},6496:(H,D,t)=>{"use strict";t.d(D,{f:()=>L});var i=t(2316),e=t(53882),c=t(54364),u=t(18869),r=t(96617),n=t(80044),h=t(85758),a=t(8849);class p extends i.qLn{constructor(oe){super(),this.I18n=oe,this.text={internal_error:this.I18n.t("js.error.internal")}}handleError(oe){var Oe,$;let Xe=this.text.internal_error;(null===(Oe=oe)||void 0===Oe?void 0:Oe.rejection)instanceof a.o?this.handleError(oe.rejection):(oe instanceof a.o?(console.error("Returned HTTP HAL error resource %O",oe.message),Xe=(null===($=oe.httpError)||void 0===$?void 0:$.status)>=500?`${Xe} ${oe.message}`:oe.message,p.captureError(oe.httpError)):oe instanceof h.Xf?(console.error("Returned error resource %O",oe),Xe+=` ${oe.errorMessages.join("\n")}`):oe instanceof n.X?(console.error("Returned hal resource %O",oe),Xe+=`Resource returned ${oe.name}`):oe instanceof Error?window.ErrorReporter.captureException(oe):oe instanceof e.UA?(p.captureError(oe),Xe=oe.message):"string"==typeof oe&&(window.ErrorReporter.captureMessage(oe),Xe=oe),super.handleError(Xe))}static captureError(oe){window.ErrorReporter.captureException(oe)}}p.\u0275fac=function(oe){return new(oe||p)(i.LFG(r.D))},p.\u0275prov=i.Yz7({token:p,factory:p.\u0275fac});var l=t(24897),d=t(84481),g=t(20501),C=t(17577),y=t(53407),m=t(67248);class E extends n.X{constructor(){super(...arguments),this.attachmentsBackend=!1}}const P=(0,m.n)(E);class w extends n.X{constructor(){super(...arguments),this.attachmentsBackend=!1}}const x=(0,m.n)(w);class k extends n.X{constructor(){super(...arguments),this.attachmentsBackend=!1}}const b=(0,m.n)(k);var v=t(34863),M=t(54475),S=t(75421),O=t(46384);class A extends n.X{get state(){return this.states.timeEntries.get(this.id)}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}}class F extends n.X{}var I=t(92814);class J extends n.X{}var N=t(4816),te=t(9214);class ee extends n.X{}class G extends n.X{}class se extends n.X{get state(){return this.states.types.get(this.href)}}var me=t(10190);class _e extends n.X{get id(){return this.$source.id||(0,me.Z)(this.href)}set id(oe){this.$source.id=oe}}var he=t(63085);class ae extends n.X{getErrors(){const oe=_.values(this.validationErrors),Oe=oe.length;if(0===Oe)return null;let $;return 1===Oe?$=new h.Xf(this.injector,oe[0],!0,this.halInitializer,"Error"):($=new h.Xf(this.injector,{},!0,this.halInitializer,"Error"),$.errorIdentifier=h.$5,$.errors=oe),$.isValidationError=!0,$}}class re extends n.X{}const ye=(0,m.n)(re);class Ce extends n.X{get state(){return this.states.schemas.get(this.href)}get availableAttributes(){return _.keys(this.$source).filter(oe=>0!==oe.indexOf("_"))}attributeFromLocalizedName(oe){let Oe=null;for(const $ of this.availableAttributes){const Xe=this[$];if((null==Xe?void 0:Xe.name)===oe){Oe=$;break}}return Oe}}class Ae extends n.X{forValue(oe){return this.dependencies[oe]}}class Fe extends Ce{constructor(){super(...arguments),this.type="QueryFilterInstanceSchema"}get availableOperators(){return this.operator.allowedValues}get allowedFilterValue(){return this.filter.allowedValues instanceof g.Y?this.filter.allowedValues.elements[0]:this.filter.allowedValues[0]}$initialize(oe){super.$initialize(oe),oe._dependencies&&(this.dependency=new Ae(this.injector,oe._dependencies[0],!0,this.halInitializer,"SchemaDependency"))}getFilter(){const oe=this.operator.allowedValues[0],Oe=this.filter.allowedValues[0],$={name:Oe.name,_links:{filter:Oe.$source._links.self,schema:this.$source._links.self,operator:oe.$source._links.self}};return this.definesAllowedValues()?$._links.values=[]:$.values=[],new he.L(this.injector,$,!0,this.halInitializer,"QueryFilterInstance")}isValueRequired(){return!!this.values}isResourceValue(){return!(!this.values||!this.values.allowedValues)}loadedAllowedValues(){var oe;return Array.isArray(null===(oe=this.values)||void 0===oe?void 0:oe.allowedValues)}resultingSchema(oe){const Oe=this.$source,$=this.dependency.forValue(oe.href.toString()),Xe={};return _.merge(Xe,Oe,$),new Fe(this.injector,Xe,!0,this.halInitializer,"QueryFilterInstanceSchema")}definesAllowedValues(){return _.some(this._dependencies[0].dependencies,oe=>oe.values&&oe.values._links&&oe.values._links.allowedValues)}}class ot extends g.Y{}var it=t(69057),Ve=t(63588);const Ie={WorkPackage:{cls:l.X,attrTypes:{parent:"WorkPackage",ancestors:"WorkPackage",children:"WorkPackage",relations:"Relation",schema:"Schema",status:"Status",type:"Type"}},Activity:{cls:n.X,attrTypes:{user:"User"}},"Activity::Comment":{cls:n.X,attrTypes:{user:"User"}},"Activity::Revision":{cls:n.X,attrTypes:{user:"User"}},Relation:{cls:it.d,attrTypes:{from:"WorkPackage",to:"WorkPackage"}},Schema:{cls:Ce},Type:{cls:se},Status:{cls:v.F},SchemaDependency:{cls:Ae},Error:{cls:h.Xf},User:{cls:d.q},Group:{cls:ee},Collection:{cls:g.Y},WorkPackageCollection:{cls:ot},AttachmentCollection:{cls:M.e},Query:{cls:C.P,attrTypes:{filters:"QueryFilterInstance"}},Form:{cls:ae,attrTypes:{payload:"FormPayload"}},FormPayload:{cls:n.X,attrTypes:{attachments:"AttachmentsCollection"}},QueryFilterInstance:{cls:he.L,attrTypes:{schema:"QueryFilterInstanceSchema",filter:"QueryFilter",operator:"QueryOperator"}},QueryFilterInstanceSchema:{cls:Fe},QueryFilter:{cls:Ve.e},Root:{cls:G},QueryOperator:{cls:_e},HelpText:{cls:ye},CustomAction:{cls:y.M},WikiPage:{cls:P},MeetingContent:{cls:x},Post:{cls:b},Project:{cls:te.c},Role:{cls:N.q},Grid:{cls:O.H},GridWidget:{cls:S.z},TimeEntry:{cls:A},Membership:{cls:J},News:{cls:F},Version:{cls:I.g}};var ie=t(91923),R=t(67727);class L{}L.\u0275fac=function(oe){return new(oe||L)},L.\u0275mod=i.oAB({type:L}),L.\u0275inj=i.cJS({providers:[{provide:i.qLn,useClass:p},{provide:e.TP,useClass:u.s,multi:!0},{provide:i.ip1,useFactory:function(W){return()=>{_.each(Ie,(oe,Oe)=>W.registerResource(Oe,oe))}},deps:[ie.u],multi:!0},R.W],imports:[[c.ez,e.JF]]})},54475:(H,D,t)=>{"use strict";t.d(D,{e:()=>e});var i=t(20501);class e extends i.Y{$initialize(u){super.$initialize(u),this.elements=this.elements||[]}}},20501:(H,D,t)=>{"use strict";t.d(D,{Y:()=>e});var i=t(80044);class e extends i.X{updateElements(){return this.href?this.$load().then(u=>this.elements=u.elements):Promise.resolve()}}},53407:(H,D,t)=>{"use strict";t.d(D,{M:()=>e});var i=t(80044);class e extends i.X{}},85758:(H,D,t)=>{"use strict";t.d(D,{$5:()=>c,G$:()=>u,Xf:()=>r});var i=t(80044);const c="urn:openproject-org:api:v3:errors:MultipleErrors";function u(n){return"_type"in n&&"message"in n&&"errorIdentifier"in n}class r extends i.X{constructor(){super(...arguments),this.isValidationError=!1}toString(){return`[ErrorResource ${this.message}]`}get errorMessages(){return this.isMultiErrorMessage()?this.errors.map(h=>h.message):[this.message]}isMultiErrorMessage(){return this.errorIdentifier===c}getInvolvedAttributes(){let h=[];return this.details?h=[{details:this.details}]:this.errors&&(h=this.errors),_.flatten(h.map(a=>a.errorIdentifier===c?this.extractMultiError(a)[0]:a.details.attribute))}getMessagesPerAttribute(){const h={};return this.details?h[this.details.attribute]=[this.message]:_.forEach(this.errors,a=>{if(a.errorIdentifier===c){const[p,l]=this.extractMultiError(a),d=h[p]||[];h[p]=d.concat(l)}else h[a.details.attribute]?h[a.details.attribute].push(a.message):h[a.details.attribute]=[a.message]}),h}extractMultiError(h){const{attribute:a}=h.errors[0].details;return[a,h.errors.map(l=>l.message)]}}},46384:(H,D,t)=>{"use strict";t.d(D,{H:()=>n});var i=t(3786),e=t(80044),c=t(75421),u=t(67248);class r extends e.X{constructor(){super(...arguments),this.attachmentsBackend=!0}$initialize(a){super.$initialize(a),this.widgets=this.widgets.map(p=>{const l=new c.z(this.injector,p,!0,this.halInitializer,"GridWidget");return l.grid=this,l})}updateAttachments(){return(0,i.mG)(this,void 0,void 0,function*(){return this.attachments.$update().then(()=>(this.states.forResource(this).putValue(this),this.attachments))})}}const n=(0,u.n)(r)},75421:(H,D,t)=>{"use strict";t.d(D,{z:()=>r});var i=t(3786),e=t(80044),c=t(29161),u=t(91923);class r extends e.X{get height(){return this.endRow-this.startRow}get width(){return this.endColumn-this.startColumn}get schema(){return this.halResource.createHalResource({_type:"Schema"},!0)}}(0,i.gn)([(0,c.W)(),(0,i.w6)("design:type",u.u)],r.prototype,"halResource",void 0)},80044:(H,D,t)=>{"use strict";t.d(D,{X:()=>h});var i=t(3786),e=t(87853),c=t(96617),u=t(29161),r=t(10190),n=t(84699);class h{constructor(p,l,d,g,C){this.injector=p,this.$source=l,this.$loaded=d,this.halInitializer=g,this.$links={},this.$embedded={},this.$halType=C,this.$initialize(l)}static getEmptyResource(p={href:null}){return{_links:{self:p}}}static matchFromLink(p,l){const d=new RegExp(`/api/v3/${l}/(\\d+)`).exec(p);return d&&d[1]}$initialize(p){this.$source=p.$source||p,this.halInitializer(this)}toString(){return this.href?`[HalResource href=${this.href}]`:`[HalResource id=${this.id}]`}get id(){if(this.$source.id)return this.$source.id.toString();const p=(0,r.Z)(this.href);return/^\d+$/.exec(p)?p:null}set id(p){this.$source.id=p}retainFrom(p){this.__initialized_at=p.__initialized_at}$copy(p={}){return new(0,this.constructor)(this.injector,_.merge(this.$plain(),p),this.$loaded,this.halInitializer,this.$halType)}$plain(){return _.cloneDeep(this.$source)}get $isHal(){return!0}get $link(){return this.$links.self.$link}get name(){return this._name||this.$link.title||""}set name(p){this._name=p}get href(){return this.$link.href}get state(){return null}push(p){return this.state&&this.state.putValue(p),Promise.resolve()}previewPath(){if((0,n.Z)(this)&&this.project)return this.project.href}getEditorContext(p){return{type:"constrained"}}$load(p=!1){if(!this.state)return this.$loadResource(p);const{state:l}=this;return p&&l.clear(),l.putFromPromiseIfPristine(()=>this.$loadResource(p)),l.valuesPromise().then(d=>(this.$initialize(d),this.$loaded=!0,this))}$loadResource(p=!1){if(!p){if(this.$loaded)return Promise.resolve(this);if(!this.$loaded&&this.$self)return this.$self}return this.$loaded=!1,this.$self=this.$links.self({}).then(l=>(this.$loaded=!0,this.$initialize(l.$source),this)),this.$self}$update(){return this.$load(!0)}$embeddableKeys(){const p=Object.keys(this.$source);return _.without(p,"_links","_embedded","id")}$linkableKeys(){const p=Object.keys(this.$links);return _.without(p,"self")}}(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",e.G)],h.prototype,"states",void 0),(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",c.D)],h.prototype,"I18n",void 0)},67248:(H,D,t)=>{"use strict";t.d(D,{n:()=>l});var i=t(67727),e=t(70233),c=t(36293),u=t(12877),r=t(20979),n=t(48249),h=t(76825),a=t(54475),p=t(84699);function l(d){return class extends d{get canAddAttachments(){return!!this.$links.addAttachment||(0,p.Z)(this)}get hasAttachments(){return _.get(this.attachments,"elements.length",0)>0}lookupDownloadLocationByName(g){if(!this.attachments||!this.attachments.elements)return null;const C=_.find(this.attachments.elements,y=>y.name===g);return _.get(C,"staticDownloadLocation.href",null)}removeAttachment(g){return _.pull(this.attachments.elements,g),g.$isHal?g.delete().then(()=>{this.attachmentsBackend?this.updateAttachments():this.attachments.count=Math.max(this.attachments.count-1,0)}).catch(C=>{this.halNotification.handleRawError(C,this),this.attachments.elements.push(g)}):Promise.resolve()}updateAttachments(){return this.attachments.updateElements().then(()=>(this.updateState(),this.attachments))}uploadAttachments(g){const{uploads:C,finished:y}=this.performUpload(g),m=I18n.t("js.label_upload_notification"),E=this.ToastService.addAttachmentUpload(m,C);return y.then(P=>(setTimeout(()=>this.ToastService.remove(E),700),this.attachments.count+=P.length,P.forEach(w=>{this.attachments.elements.push(w.response)}),this.updateState(),P)).catch(P=>{let w;return console.error("Error while uploading: %O",P),w=P.error instanceof ErrorEvent?this.I18n.t("js.error_attachment_upload",{error:P}):"Error"===_.get(P,"error._type")?P.error.message:P.error,this.halNotification.handleRawError(w),w||I18n.t("js.error.internal")})}performUpload(g){let C=this.directUploadURL||"";return C?this.opDirectFileUpload.uploadAndMapResponse(C,g):(C=!(0,p.Z)(this)&&this.id&&this.attachmentsBackend?this.addAttachment.$link.href:this.apiV3Service.attachments.path,this.opFileUpload.uploadAndMapResponse(C,g))}get directUploadURL(){return this.$links.prepareAttachment?this.$links.prepareAttachment.href:(0,p.Z)(this)?this.config.prepareAttachmentURL:null}updateState(){this.state&&this.state.putValue(this)}$initialize(g){this.ToastService||(this.ToastService=this.injector.get(c.kl)),this.halNotification||(this.halNotification=this.injector.get(i.W)),this.opFileUpload||(this.opFileUpload=this.injector.get(h.r)),this.opDirectFileUpload||(this.opDirectFileUpload=this.injector.get(n.c)),this.config||(this.config=this.injector.get(u.e)),this.pathHelper||(this.pathHelper=this.injector.get(e.j)),this.apiV3Service||(this.apiV3Service=this.injector.get(r.T)),super.$initialize(g);const C=this.attachments||{$source:{},elements:[]};this.attachments=new a.e(this.injector,C,!1,this.halInitializer,"HalResource")}}}},9214:(H,D,t)=>{"use strict";t.d(D,{c:()=>e});var i=t(80044);class e extends i.X{get state(){return this.states.projects.get(this.id)}getEditorContext(u){return-1!==["statusExplanation","description"].indexOf(u)?{type:"full",macros:"resource"}:{type:"constrained"}}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}}},63085:(H,D,t)=>{"use strict";t.d(D,{L:()=>h});var i=t(3786),e=t(29161),c=t(44022),u=t(70233),r=t(80044),n=t(10190);class h extends r.X{constructor(){super(...arguments),this.memoizedCurrentSchemas={}}$initialize(p){super.$initialize(p),this.$links.schema={href:`${this.pathHelper.api.v3.apiV3Base}/queries/filter_instance_schemas/${(0,n.Z)(this.filter.href)}`}}get id(){return this.filter.id}get name(){return this.filter.name}get currentSchema(){if(!this.operator)return null;const p=this.operator.href.toString();if(void 0===this.memoizedCurrentSchemas[p])try{this.memoizedCurrentSchemas[p]=this.schemaCache.of(this).resultingSchema(this.operator)}catch(l){console.error(`Failed to access filter schema${l}`)}return this.memoizedCurrentSchemas[p]}isCompletelyDefined(){return this.values.length||this.currentSchema&&!this.currentSchema.isValueRequired()}findOperator(p){return _.find(this.schemaCache.of(this).availableOperators,l=>l.id===p)}isTemplated(){let p=!1;return this.values.find(l=>{p=((null==l?void 0:l.href)||l.toString()||"").includes("{id}")}),p}}(0,i.gn)([(0,e.W)(c.y),(0,i.w6)("design:type",c.y)],h.prototype,"schemaCache",void 0),(0,i.gn)([(0,e.W)(u.j),(0,i.w6)("design:type",u.j)],h.prototype,"pathHelper",void 0)},63588:(H,D,t)=>{"use strict";t.d(D,{e:()=>c});var i=t(80044),e=t(10190);class c extends i.X{get id(){return this.$source.id||(0,e.Z)(this.href)}set id(r){this.$source.id=r}}},17577:(H,D,t)=>{"use strict";t.d(D,{P:()=>c});var i=t(80044),e=t(63085);class c extends i.X{$initialize(r){super.$initialize(r),this.filters=this.filters.map(n=>new e.L(this.injector,n,!0,this.halInitializer,"QueryFilterInstance"))}}},15893:(H,D,t)=>{"use strict";t.d(D,{S9:()=>e,iV:()=>c});t(80044);const e="urn:openproject-org:api:v3:queries:directions:asc",c="urn:openproject-org:api:v3:queries:directions:desc"},69057:(H,D,t)=>{"use strict";t.d(D,{d:()=>c});var i=t(80044),e=t(10190);class c extends i.X{static RELATION_TYPES(r=!0){const n=["relates","duplicates","duplicated","blocks","blocked","precedes","follows","includes","partof","requires","required"];return r&&n.push("parent","children"),n}static LOCALIZED_RELATION_TYPES(r=!0){return c.RELATION_TYPES(r).map(h=>({name:h,label:I18n.t(`js.relation_labels.${h}`)}))}static DEFAULT(){return"relates"}normalizedType(r){return this.denormalized(r).relationType}denormalized(r){const n=this.to.href===r.href?"from":"to";return{target:this[n],targetId:this[n].id,relationType:"from"===n?this.reverseType:this.type,reverseRelationType:"from"===n?this.type:this.reverseType}}isInvolved(r){return _.values(this.ids).indexOf(r.toString())>=0}get ids(){return{from:(0,e.Z)(this.from.href),to:(0,e.Z)(this.to.href)}}updateDescription(r){return this.$links.updateImmediately({description:r})}updateType(r){return this.$links.updateImmediately({type:r})}}},4816:(H,D,t)=>{"use strict";t.d(D,{q:()=>e});var i=t(80044);class e extends i.X{}},34863:(H,D,t)=>{"use strict";t.d(D,{F:()=>e});var i=t(80044);class e extends i.X{get state(){return this.states.statuses.get(this.href)}}},84481:(H,D,t)=>{"use strict";t.d(D,{q:()=>e});var i=t(80044);class e extends i.X{static get active_user_statuses(){return["active","registered"]}get state(){return this.states.users.get(this.href)}get showUserPath(){return this.showUser?this.showUser.$link.href:null}get isActive(){return e.active_user_statuses.indexOf(this.status)>=0}}},92814:(H,D,t)=>{"use strict";t.d(D,{g:()=>e});var i=t(80044);class e extends i.X{isLocked(){return"locked"===this.status}isOpen(){return"open"===this.status}isClosed(){return"closed"===this.status}}},24897:(H,D,t)=>{"use strict";t.d(D,{X:()=>E});var i=t(3786),e=t(96617),c=t(87853),u=t(70233),r=t(36293),n=t(54892),h=t(62964),a=t(29161),p=t(20979),l=t(76825),d=t(54475),g=t(80044),C=t(67248),y=t(84699);class m extends g.X{constructor(){super(...arguments),this.attachmentsBackend=!0}get ancestorIds(){const{ancestors:w}=this;return w.map(x=>x.id)}subjectWithType(w=40){return`${this.type?`${this.type.name}: `:""}${this.subjectWithId(w)}`}subjectWithId(w=40){const x=(0,y.Z)(this)?"":` (#${this.id})`;return`${_.truncate(this.subject,{length:w})}${x}`}get isLeaf(){const{children:w}=this.$links;return!(w&&w.length>0)}previewPath(){return(0,y.Z)(this)?super.previewPath():this.apiV3Service.work_packages.id(this.id).path}getEditorContext(w){return{type:"description"===w?"full":"constrained",macros:!1}}isParentOf(w){var x;return(null===(x=w.parent)||void 0===x?void 0:x.$links.self.$link.href)===this.$links.self.$link.href}updateLinkedResources(...w){const x={};w.forEach(b=>{const v=this[b];x[b]=v?v.$update():Promise.reject(void 0)});const k=Promise.all(_.values(x));return k.then(()=>{this.wpCacheService.touch(this.id)}),k}$initialize(w){super.$initialize(w);const x=this.attachments||{$source:{},elements:[]};this.attachments=new d.e(this.injector,_.get(x,"$source",x),!1,this.halInitializer,"HalResource")}$linkableKeys(){return _.without(super.$linkableKeys(),"schema")}get state(){return this.states.workPackages.get(this.id)}push(w){return this.wpActivity.clear(w.id),w.parent&&this.apiV3Service.work_packages.id(w.parent).refresh(),this.apiV3Service.work_packages.cache.updateWorkPackage(w)}}(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",e.D)],m.prototype,"I18n",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",c.G)],m.prototype,"states",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",n.a)],m.prototype,"wpActivity",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",p.T)],m.prototype,"apiV3Service",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",r.kl)],m.prototype,"ToastService",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",h.q)],m.prototype,"workPackageNotificationService",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",u.j)],m.prototype,"pathHelper",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",l.r)],m.prototype,"opFileUpload",void 0);const E=(0,C.n)(m)},26784:(H,D,t)=>{"use strict";t.d(D,{u:()=>e});var i=t(80044);class e{static extractPayload(u,r=null){return u instanceof i.X&&r?this.extractPayloadFromSchema(u,r):!u||u instanceof i.X?{}:u}static extractPayloadFromSchema(u,r){const n={_links:{}},h=[];for(const a in r)r.hasOwnProperty(a)&&r[a]&&r[a].writable&&(u.$links[a]?Array.isArray(u[a])?n._links[a]=_.map(u[a],p=>({href:p.href})):n._links[a]={href:u[a]&&u[a].href}:h.push(a));return _.each(h,a=>{(u.hasOwnProperty(a)||u[a])&&(Array.isArray(u[a])?n[a]=_.map(u[a],p=>p instanceof i.X?this.extractPayloadFromSchema(p,p.currentSchema||p.schema):p):n[a]=u[a])}),n}}},81531:(H,D,t)=>{"use strict";t.d(D,{V:()=>e});var i=t(84699);class e{constructor(u,r){this.schema=u,this.resource=r}static create(u,r){return new Proxy(u,new this(u,r))}get(u,r,n){switch(r){case"ofProperty":return this.proxyMethod(this.ofProperty);case"isAttributeEditable":return this.proxyMethod(this.isAttributeEditable);case"mappedName":return this.proxyMethod(this.mappedName);case"isEditable":return this.isEditable;default:return Reflect.get(u,r,n)}}ofProperty(u){const r=this.schema[this.mappedName(u)];return r?Object.assign(Object.assign({},r),{writable:this.isEditable&&r&&r.writable}):null}isAttributeEditable(u){const r=this.ofProperty(u);return!!r&&r.writable}get isEditable(){return(0,i.Z)(this.resource)||!!this.resource.$links.update}mappedName(u){return u}proxyMethod(u){const r=this;return new Proxy(u,{apply:(n,h,a)=>u.apply(r,[a[0]])})}}},81923:(H,D,t)=>{"use strict";t.d(D,{X:()=>e});var i=t(81531);class e extends i.V{get(u,r,n){switch(r){case"isMilestone":return this.isMilestone;case"isReadonly":return this.isReadonly;default:return super.get(u,r,n)}}ofProperty(u){if("combinedDate"===u){const r=super.ofProperty("startDate");return r?(r.writable=r.writable||this.isAttributeEditable("dueDate")||this.isAttributeEditable("scheduleManually"),r):null}return super.ofProperty(u)}get isReadonly(){var u;return null===(u=this.resource.status)||void 0===u?void 0:u.isReadonly}isAttributeEditable(u){return(!this.isReadonly||"status"===u)&&(["startDate","dueDate","date"].includes(u)&&this.resource.scheduleManually?super.isAttributeEditable("scheduleManually"):super.isAttributeEditable(u))}get isMilestone(){return this.schema.hasOwnProperty("date")}mappedName(u){return!this.isMilestone||"startDate"!==u&&"dueDate"!==u?u:"date"}}},8849:(H,D,t)=>{"use strict";t.d(D,{o:()=>i});class i extends Error{constructor(c,u){super(),this.httpError=c,this.resource=u,this.name="HALError",Object.setPrototypeOf(this,i.prototype)}get message(){var c,u;return(null===(c=this.resource)||void 0===c?void 0:c.message)||(null===(u=this.httpError)||void 0===u?void 0:u.message)||"Unknown error"}get errorIdentifier(){var c;return(null===(c=this.resource)||void 0===c?void 0:c.errorIdentifier)||"unknown"}}},1403:(H,D,t)=>{"use strict";t.d(D,{J:()=>n});var i=t(79441),e=t(9170),c=t(96330),u=t(80639),r=t(2316);class n{constructor(){this._events=new i.xQ,this.events$=this._events.asObservable()}aggregated$(a,p=500){return this.events$.pipe((0,e.h)(l=>l.resourceType===a),(0,c.f)(this.events$.pipe((0,u.b)(p))))}push(a,p){p.id=a.id,p.resourceType=a._type,this._events.next(p)}}n.\u0275fac=function(a){return new(a||n)},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})},67727:(H,D,t)=>{"use strict";t.d(D,{W:()=>y});var i=t(3786),e=t(47775),c=t(91923),u=t(86469),r=t(36293),n=t(96617),h=t(53882),a=t(80044),p=t(29161),l=t(44022),d=t(85758),g=t(8849),C=t(2316);class y{constructor(E){this.injector=E}showSave(E,P=!1){const w={message:this.I18n.t("js.notice_successful_"+(P?"create":"update"))};this.ToastService.addSuccess(w)}handleRawError(E,P){if(console.error("Handling error message %O for work package %O",E,P),E instanceof g.o&&P)return this.handleErrorResponse(E.resource,P);const w=this.retrieveError(E);if(w instanceof a.X)return this.handleErrorResponse(w,P);"string"!=typeof E?E instanceof Error?this.ToastService.addError(E.message):this.showGeneralError(w||E):this.ToastService.addError(E)}retrieveErrorMessage(E){const P=this.retrieveError(E);return P instanceof d.Xf||P instanceof g.o?P.message:"string"==typeof P?P:this.I18n.t("js.error.internal")}retrieveError(E){let P=E;return E instanceof h.UA&&(P=E.message||E.error),"Error"===_.get(E,"data._type")&&(P=E.data),P&&"Error"===P._type?this.halResourceService.createHalResourceOfClass(d.Xf,P):P}handleErrorResponse(E,P){return E instanceof g.o&&P?this.showError(E.resource,P):E instanceof d.Xf?P?this.showError(E,P):this.showApiErrorMessages(E):this.showGeneralError(E)}showError(E,P){this.showCustomError(E,P)||this.showApiErrorMessages(E)}showGeneralError(E){let P=this.I18n.t("js.error.internal");("string"==typeof E||_.has(E,"toString"))&&(P+=` ${E.toString()}`),this.ToastService.addError(P)}showEditingBlockedError(E){this.ToastService.addError(this.I18n.t("js.hal.error.edit_prohibited",{attribute:E}))}showCustomError(E,P){if("urn:openproject-org:api:v3:errors:PropertyFormatError"===E.errorIdentifier){const w=this.schemaCache.of(P).ofProperty(E.details.attribute),x=w.name,b=`js.hal.error.format.${w.type.toLowerCase()}`;return void 0!==this.I18n.lookup(b)&&(this.ToastService.addError(this.I18n.t(b,{attribute:x})),!0)}return!1}showApiErrorMessages(E){const P=E.errorMessages;return P.length>1?this.ToastService.addError("",P):this.ToastService.addError(P[0]),!0}}y.\u0275fac=function(E){return new(E||y)(C.LFG(C.zs3))},y.\u0275prov=C.Yz7({token:y,factory:y.\u0275fac}),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",n.D)],y.prototype,"I18n",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",e.StateService)],y.prototype,"$state",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",c.u)],y.prototype,"halResourceService",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",r.kl)],y.prototype,"ToastService",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",u.vt)],y.prototype,"loadingIndicator",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",l.y)],y.prototype,"schemaCache",void 0)},29092:(H,D,t)=>{"use strict";t.d(D,{h:()=>e});var i=t(2316);class e{constructor(){this.config={user:"name",project:"name"}}sort(u,r){if(0===u.length)return u;const n=r||u[0]._type;if(!n)return u;const h=this.sortingProperty(n);return h?_.sortBy(u,a=>a[h].toLowerCase()):u}sortingProperty(u){return u=u.toLowerCase().replace(/^\[\]/,""),this.config[u]}hasSortingProperty(u){return void 0!==this.sortingProperty(u)}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})},91923:(H,D,t)=>{"use strict";t.d(D,{u:()=>m});var i=t(53882),e=t(33927),c=t(18293),u=t(45871),r=t(23376),n=t(47174),h=t(3352),a=t(95060),p=t(51784),l=t(80044),d=t(91720),g=t(8849),C=t(23237),y=t(2316);class m{constructor(P,w){this.injector=P,this.http=w,this.config={}}request(P,w,x,k={}){if("get"===P)return this.get(w,x,k);const b={body:x||{},headers:k,withCredentials:!0,responseType:"json"};return this.performRequest(P,w,b)}performRequest(P,w,x){return this.http.request(P,w,x).pipe((0,e.U)(k=>this.createHalResource(k)),(0,c.K)(k=>((0,h.SC)(()=>console.error(`Failed to ${P} ${w}: ${k.name}`)),this.createErrorObservable(k))))}get(P,w,x){const k={headers:x,params:new i.LE({encoder:new p.c,fromObject:w}),withCredentials:!0,responseType:"json"};return this.performRequest("get",P,k)}getAllPaginated(P,w={},x={}){return(0,C.JQ)(k=>{const b=Object.assign(Object.assign({},w),k);return this.request("get",P,this.toEprops(b),x)},w.pageSize||-1)}put(P,w,x){return this.request("put",P,w,x)}post(P,w,x){return this.request("post",P,w,x)}patch(P,w,x){return this.request("patch",P,w,x)}delete(P,w,x){return this.request("delete",P,w,x)}registerResource(P,w){this.config[P]=w}get defaultClass(){return l.X}createHalResource(P,w=!0){_.isNil(P)&&(P=l.X.getEmptyResource());const x=P._type||"HalResource";return this.createHalResourceOfType(x,P,w)}createHalResourceOfType(P,w,x=!1){return new(this.getResourceClassOfType(P))(this.injector,w,x,M=>(0,d.EZ)(this,M),P)}createHalResourceOfClass(P,w,x=!1){const b=w._type||"HalResource";return new P(this.injector,w,x,M=>(0,d.EZ)(this,M),b)}fromLink(P){const w=l.X.getEmptyResource(a.d.fromObject(this,P));return this.createHalResource(w,!1)}fromSelfLink(P){const w={_links:{self:{href:P}}};return this.createHalResource(w)}createLinkedResource(P,w,x){const k=l.X.getEmptyResource(),b=P.$halType,v=this.getResourceClassOfAttribute(b,w)||"HalResource";return k._links.self=x,this.createHalResourceOfType(v,k,!1)}getResourceClassOfType(P){const w=this.config[P];return w&&w.cls?w.cls:this.defaultClass}getResourceClassOfAttribute(P,w){const x=this.config[P];return(x&&x.attrTypes||{})[w]}toEprops(P){const w=r.Wt(JSON.stringify(P));return{eprops:n.J2(w)}}createErrorObservable(P){var w;let x=null;const k=P.error;return"object"==typeof k&&(null===(w=k)||void 0===w?void 0:w._type)&&(x=this.createHalResource(P.error)),(0,u._)(new g.o(P,x))}}m.\u0275fac=function(P){return new(P||m)(y.LFG(y.zs3),y.LFG(i.eN))},m.\u0275prov=y.Yz7({token:m,factory:m.\u0275fac,providedIn:"root"})},51784:(H,D,t)=>{"use strict";t.d(D,{c:()=>i});class i{encodeKey(c){return encodeURIComponent(c)}encodeValue(c){return encodeURIComponent(c)}decodeKey(c){return decodeURIComponent(c)}decodeValue(c){return decodeURIComponent(c)}}},13623:(H,D,t)=>{"use strict";t.d(D,{L:()=>P});var i=t(3786),e=t(19100);let u=class extends e.yh{constructor(){super({totalUnread:0})}};u=(0,i.gn)([(0,e.yC)({name:"ian-bell"}),(0,i.w6)("design:paramtypes",[])],u);var r=t(97542),n=t(33905),h=t(84515),a=t(33927),p=t(98636),l=t(15347),d=t(9170);class g extends e.AE{constructor(x){super(x),this.store=x,this.unread$=this.select("totalUnread"),this.unreadCountIncreased$=this.unread$.pipe((0,l.G)(),(0,d.h)(([k,b])=>b>k),(0,a.U)(([,k])=>k))}}var C=t(44838),y=t(78509),m=t(60419),E=t(2316);let P=class{constructor(x,k){this.actions$=x,this.resourceService=k,this.id="ian-bell",this.store=new u,this.query=new g(this.store),this.unread$=this.query.unread$,this.query.unreadCountIncreased$.pipe((0,h.T)(1)).subscribe(b=>{this.actions$.dispatch((0,y.vw)({origin:this.id,count:b}))})}fetchUnread(){return this.resourceService.fetchNotifications({filters:n.yz.unread,pageSize:0}).pipe((0,a.U)(x=>x.total),(0,p.b)(x=>{this.store.update({totalUnread:x})}))}reloadOnNotificationRead(x){this.store.update(({totalUnread:k})=>({totalUnread:k-x.notifications.length}))}};P.\u0275fac=function(x){return new(x||P)(E.LFG(m.b),E.LFG(r.W))},P.\u0275prov=E.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),(0,i.gn)([(0,C.B)(y.A6),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[void 0]),(0,i.w6)("design:returntype",void 0)],P.prototype,"reloadOnNotificationRead",null),P=(0,i.gn)([C.b,(0,i.w6)("design:paramtypes",[m.b,r.W])],P)},33905:(H,D,t)=>{"use strict";t.d(D,{yz:()=>u,m8:()=>n});var i=t(3786),e=t(19100),c=t(24782);const u={unread:[["readIAN","=",!1]],all:[]};let n=class extends e.yh{constructor(){super({params:{pageSize:c.Z,page:1},filters:{},activeCollection:{ids:[]},activeFacet:"unread",notLoaded:0})}};n=(0,i.gn)([(0,e.yC)({name:"ian-center"}),(0,i.w6)("design:paramtypes",[])],n)},99197:(H,D,t)=>{"use strict";t.r(D),t.d(D,{OpenProjectInAppNotificationsModule:()=>je});var i=t(21757),e=t(54364),c=t(53875),u=t(12702),r=t(20979),n=t(10190),h=t(96617),a=t(70692),p=t(33927),l=t(83720),d=t(70233),g=t(23896),C=t(80044),y=t(3786),m=t(2316),E=t(80639),P=t(98636),w=t(79902),x=t(67202),k=t(94236),b=t(92597),v=t(53466),M=t(79441),S=t(30400),O=t(36293),A=t(78509),F=t(19100),I=t(33905),J=t(96725);class N extends F.AE{constructor(B,pe){super(B),this.store=B,this.resourceService=pe,this.activeFacet$=this.select("activeFacet"),this.notLoaded$=this.select("notLoaded"),this.paramsChanges$=this.select(["params","activeFacet"]),this.activeCollection$=this.select("activeCollection"),this.selectNotifications$=this.activeCollection$.pipe((0,p.U)(De=>(0,J.tD)(this.resourceService,De)),(0,l.x)()),this.aggregatedCenterNotifications$=this.selectNotifications$.pipe((0,p.U)(De=>_.groupBy(De,qe=>{var ct;return(null===(ct=qe._links.resource)||void 0===ct?void 0:ct.href)||"none"})),(0,l.x)()),this.notifications$=this.aggregatedCenterNotifications$.pipe((0,p.U)(De=>Object.values(De)),(0,l.x)()),this.hasNotifications$=this.notifications$.pipe((0,l.x)(),(0,p.U)(De=>De.length>0),(0,l.x)()),this.hasMoreThanPageSize$=this.notLoaded$.pipe((0,p.U)(De=>De>0),(0,l.x)())}get params(){const B=this.store.getValue(),pe=B.filters.name&&B.filters.filter;return Object.assign(Object.assign({},B.params),{filters:[...I.yz[B.activeFacet],...pe?[[B.filters.filter,"=",[B.filters.name]]]:[]]})}}var te=t(44838),ee=t(60419),G=t(97542),se=t(26942),me=t(47775),_e=t(53916);let he=class extends se.N{constructor(B,pe,De,qe,ct,Tt,Pt,nt,Se){var Pe;super(),this.I18n=B,this.injector=pe,this.resourceService=De,this.actions$=qe,this.apiV3Service=ct,this.toastService=Tt,this.uiRouterGlobals=Pt,this.state=nt,this.deviceService=Se,this.id="ian-center",this.store=new I.m8,this.query=new N(this.store,this.resourceService),this.activeReloadToast=null,this.reload=new M.xQ,this.onReload=this.reload.pipe((0,E.b)(0),(0,P.b)(We=>{We&&this.store.setLoading(!0)}),(0,w.w)(()=>this.resourceService.fetchNotifications(this.query.params).pipe((0,w.w)(We=>(0,S.D)(this.sideLoadInvolvedWorkPackages(We._embedded.elements)).pipe((0,x.h)((0,J.n)(We)))))),(0,P.b)(()=>setTimeout(()=>this.store.setLoading(!1)))),this.selectedNotificationIndex=0,this.stateChanged$=null===(Pe=this.uiRouterGlobals.params$)||void 0===Pe?void 0:Pe.pipe(this.untilDestroyed(),(0,k.j)("workPackageId"),(0,l.x)(),(0,p.U)(We=>We?this.apiV3Service.work_packages.id(We).path:void 0),(0,b.d)()),this.reload.subscribe(),this.stateChanged$&&this.stateChanged$.subscribe(()=>{this.updateSelectedNotificationIndex()})}setFilters(B){this.store.update({filters:B}),this.onReload.pipe((0,v.q)(1)).subscribe(pe=>{this.store.update({activeCollection:pe})}),this.reload.next(!0)}setFacet(B){this.store.update({activeFacet:B}),this.onReload.pipe((0,v.q)(1)).subscribe(pe=>{this.store.update({activeCollection:pe})}),this.reload.next(!0)}markAsRead(B){this.actions$.dispatch((0,A.L5)({origin:this.id,notifications:B}))}markAllAsRead(){const B=(0,J.wH)(this.resourceService,this.query.params).filter(pe=>!1===pe.readIAN).map(pe=>pe.id);B.length>0&&this.markAsRead(B)}openSplitScreen(B){this.state.go(`${this.state.current.data.baseRoute}.details.tabs`,{workPackageId:B,tabIdentifier:"activity"})}showNextNotification(){this.query.notifications$.pipe((0,v.q)(1)).subscribe(B=>{if(B.length<=0)this.state.go(`${this.state.current.data.baseRoute}`);else if(B[0][0]._links.resource||B[this.selectedNotificationIndex][0]._links.resource){const pe=(0,n.Z)(B[this.selectedNotificationIndex>=B.length?0:this.selectedNotificationIndex][0]._links.resource.href);this.openSplitScreen(pe)}})}checkForNewNotifications(){this.onReload.pipe((0,v.q)(1)).subscribe(B=>{const{activeCollection:pe}=this.query.getValue();B.ids.reduce((qe,ct)=>qe&&pe.ids.includes(ct),!0)||(this.activeReloadToast&&(this.toastService.remove(this.activeReloadToast),this.activeReloadToast=null),this.activeReloadToast=this.toastService.add({type:"info",message:this.I18n.t("js.notifications.center.new_notifications.message"),link:{text:this.I18n.t("js.notifications.center.new_notifications.link_text"),target:()=>{this.store.update({activeCollection:B}),this.actions$.dispatch((0,A.$v)({origin:this.id})),this.activeReloadToast=null}}}))}),this.reload.next(!1)}reloadOnNotificationRead(B){const{activeCollection:pe}=this.query.getValue();this.store.update({activeCollection:{ids:pe.ids.filter(De=>!B.notifications.includes(De))}}),!this.deviceService.isMobile&&this.state.includes("**.details.*")&&this.showNextNotification()}sideLoadInvolvedWorkPackages(B){const{cache:pe}=this.apiV3Service.work_packages,De=B.map(ct=>{var Tt;const Pt=null===(Tt=ct._links.resource)||void 0===Tt?void 0:Tt.href;return Pt&&C.X.matchFromLink(Pt,"work_packages")}).filter(ct=>ct&&pe.stale(ct)),qe=this.apiV3Service.work_packages.requireAll(_.compact(De));return De.forEach(ct=>{pe.clearAndLoad(ct,(0,S.D)(qe).pipe((0,p.U)(()=>pe.current(ct))))}),qe}updateSelectedNotificationIndex(){this.query.notifications$.pipe((0,v.q)(1)).subscribe(B=>{for(let pe=0;pe<B.length;++pe)if(B[pe][0]._links.resource&&(0,n.Z)(B[pe][0]._links.resource.href)===this.uiRouterGlobals.params.workPackageId)return void(this.selectedNotificationIndex=pe)})}};he.\u0275fac=function(B){return new(B||he)(m.LFG(h.D),m.LFG(m.zs3),m.LFG(G.W),m.LFG(ee.b),m.LFG(r.T),m.LFG(O.kl),m.LFG(me.UIRouterGlobals),m.LFG(me.StateService),m.LFG(_e.U))},he.\u0275prov=m.Yz7({token:he,factory:he.\u0275fac}),(0,y.gn)([(0,te.B)(A.vw),(0,y.w6)("design:type",Function),(0,y.w6)("design:paramtypes",[]),(0,y.w6)("design:returntype",void 0)],he.prototype,"checkForNewNotifications",null),(0,y.gn)([(0,te.B)(A.A6),(0,y.w6)("design:type",Function),(0,y.w6)("design:paramtypes",[void 0]),(0,y.w6)("design:returntype",void 0)],he.prototype,"reloadOnNotificationRead",null),he=(0,y.gn)([te.b,(0,y.w6)("design:paramtypes",[h.D,m.zs3,G.W,ee.b,r.T,O.kl,me.UIRouterGlobals,me.StateService,_e.U])],he);var ae=t(84906),re=t(50076);t(34863);class Ce{ngOnChanges(B){if(B.status){const pe=B.status;this.highlightClass=re.Z.backgroundClass("status",pe.currentValue.id||"")}}}Ce.\u0275fac=function(B){return new(B||Ce)},Ce.\u0275cmp=m.Xpm({type:Ce,selectors:[["op-in-app-notification-status"]],inputs:{status:"status"},features:[m.TTD],decls:2,vars:2,consts:[[1,"op-ian-wp-status",3,"ngClass"],[1,"op-ian-wp-status--text",3,"textContent"]],template:function(B,pe){1&B&&(m.TgZ(0,"span",0),m._UZ(1,"span",1),m.qZA()),2&B&&(m.Q6J("ngClass",pe.highlightClass),m.xp6(1),m.Q6J("textContent",pe.status.name))},directives:[e.mk],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-wp-status[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;background-color:var(--status-selector-bg-color);color:#fff;margin-bottom:0;padding:1px 8px;border:none;border-radius:2px;max-width:100%;font-size:12px;display:inline-block;min-height:16px;line-height:16px}.op-ian-wp-status--text[_ngcontent-%COMP%]{margin:0 5px}"],changeDetection:0});var ke=t(3742),Ae=t(70099);function Fe(le,B){if(1&le){const pe=m.EpF();m.TgZ(0,"div",21),m._uU(1," - "),m.TgZ(2,"a",22),m.NdJ("click",function(qe){return m.CHM(pe),m.oxw(2).projectClicked(qe)}),m.qZA(),m._uU(3," - "),m.qZA()}if(2&le){const pe=m.oxw(2);m.xp6(2),m.ekj("spot-link_inactive",pe.isMobile()),m.Q6J("href",pe.project.showUrl,m.LSH)("textContent",pe.project.title)}}function ot(le,B){1&le&&(m.ynx(0),m._uU(1,", "),m.BQk())}function it(le,B){if(1&le&&(m.TgZ(0,"span",23),m._uU(1),m.YNc(2,ot,2,0,"ng-container",20),m.qZA()),2&le){const pe=B.$implicit,De=B.first,qe=B.last;m.xp6(1),m.hij(" ",pe.key,""),m.xp6(1),m.Q6J("ngIf",!qe&&De!==qe)}}function Ve(le,B){if(1&le&&m._UZ(0,"span",24),2&le){const pe=m.oxw(2);m.Q6J("textContent",pe.aggregatedNotifications.length)}}function Ie(le,B){if(1&le){const pe=m.EpF();m.TgZ(0,"i",25),m.NdJ("click",function(qe){m.CHM(pe);const ct=m.oxw(2);return ct.markAsRead(qe,ct.aggregatedNotifications)}),m.qZA()}}function ue(le,B){if(1&le&&(m.TgZ(0,"span"),m._uU(1),m.qZA()),2&le){const pe=m.oxw(2);m.xp6(1),m.hij(" ",pe.text_for_additional_authors(pe.actors.length-1)," ")}}const ie=function(le){return{workPackageId:le}};function R(le,B){if(1&le){const pe=m.EpF();m.ynx(0),m.TgZ(1,"div",3),m.TgZ(2,"div",4),m._UZ(3,"op-in-app-notification-status",5),m.qZA(),m._UZ(4,"a",6),m.YNc(5,Fe,4,4,"div",7),m.TgZ(6,"div",8),m.YNc(7,it,3,2,"span",9),m.ALo(8,"keyvalue"),m.qZA(),m.YNc(9,Ve,1,1,"span",10),m.TgZ(10,"div",11),m.YNc(11,Ie,1,0,"i",12),m.TgZ(12,"i",13),m.NdJ("keydown.enter",function(){return m.CHM(pe),m.oxw().showDetails()}),m.qZA(),m.qZA(),m.qZA(),m.TgZ(13,"div",14),m._UZ(14,"span",15),m._UZ(15,"span",16),m.qZA(),m.TgZ(16,"div",17),m._UZ(17,"div",18),m.ALo(18,"async"),m.TgZ(19,"div"),m._UZ(20,"op-principal",19),m.YNc(21,ue,2,1,"span",20),m.qZA(),m.qZA(),m.BQk()}if(2&le){const pe=B.ngIf,De=m.oxw();m.xp6(3),m.Q6J("status",pe.status),m.xp6(1),m.ekj("spot-link_inactive",De.isMobile()),m.Q6J("uiParams",m.VKq(26,ie,pe.id))("textContent","#"+pe.id),m.uIk("title",pe.subject),m.xp6(1),m.Q6J("ngIf",De.project),m.xp6(2),m.Q6J("ngForOf",m.lcZ(8,22,De.translatedReasons)),m.xp6(2),m.Q6J("ngIf",!De.notification.readIAN),m.xp6(2),m.Q6J("ngIf",!De.notification.readIAN),m.xp6(3),m.Q6J("ngClass","op-ian-item--work-package-type __hl_inline_type_"+pe.type.id)("textContent",pe.type.name),m.xp6(1),m.ekj("-read",De.notification.readIAN),m.Q6J("textContent",pe.subject),m.xp6(2),m.Q6J("title",De.fixedTime)("textContent",m.lcZ(18,24,De.relativeTime$)),m.xp6(3),m.Q6J("principal",De.actors[0])("hideName",!1)("hideAvatar",!0)("link",!De.isMobile()),m.xp6(1),m.Q6J("ngIf",De.actors.length>1)}}function L(le,B){1&le&&(m.TgZ(0,"op-content-loader",30),m.O4$(),m._UZ(1,"rect",31),m._UZ(2,"rect",32),m._UZ(3,"rect",33),m.qZA())}function W(le,B){if(1&le&&(m.TgZ(0,"div",26),m.YNc(1,L,4,0,"op-content-loader",27),m._UZ(2,"span",28),m.TgZ(3,"div",11),m._UZ(4,"i",29),m.qZA(),m.qZA()),2&le){const pe=m.oxw();m.xp6(1),m.Q6J("ngIf",pe.workPackage$)}}class oe{constructor(B,pe,De,qe,ct,Tt,Pt){this.apiV3Service=B,this.I18n=pe,this.storeService=De,this.timezoneService=qe,this.pathHelper=ct,this.state=Tt,this.deviceService=Pt,this.className=!0,this.workPackage$=null,this.loading$=this.storeService.query.selectLoading(),this.stateChanged$=this.storeService.stateChanged$,this.actors=[],this.text={and_other_singular:this.I18n.t("js.notifications.center.and_more_users.one"),and_other_plural:nt=>this.I18n.t("js.notifications.center.and_more_users.other",{count:nt}),loading:this.I18n.t("js.ajax.loading"),placeholder:this.I18n.t("js.placeholders.default"),updated_by_at:nt=>this.I18n.t("js.notifications.center.text_update_date",{date:nt})}}ngOnInit(){this.buildTranslatedReason(),this.buildActors(),this.buildTime(),this.buildProject(),this.loadWorkPackage()}loadWorkPackage(){var B;const pe=null===(B=this.notification._links.resource)||void 0===B?void 0:B.href,De=pe&&C.X.matchFromLink(pe,"work_packages");De&&(this.workPackage$=this.apiV3Service.work_packages.id(De).requireAndStream())}buildTime(){this.fixedTime=this.timezoneService.formattedDatetime(this.notification.createdAt),this.relativeTime$=(0,u.H)(0,1e4).pipe((0,p.U)(()=>this.text.updated_by_at(this.timezoneService.formattedRelativeDateTime(this.notification.createdAt))),(0,l.x)())}showDetails(){!this.workPackage$||this.workPackage$.pipe((0,g.take)(1)).subscribe(B=>{this.storeService.openSplitScreen(B.id)})}projectClicked(B){B.stopPropagation()}markAsRead(B,pe){B.stopPropagation(),this.storeService.markAsRead(pe.map(De=>De.id))}text_for_additional_authors(B){let pe;return pe=1===B?this.text.and_other_singular:this.text.and_other_plural(B),pe}isMobile(){return this.deviceService.isMobile}buildActors(){const B=this.aggregatedNotifications.map(pe=>{const{actor:De}=pe._links;return De?{href:De.href,name:De.title}:null}).filter(pe=>null!==pe);this.actors=_.uniqBy(B,pe=>pe.href)}buildTranslatedReason(){const B={};this.aggregatedNotifications.forEach(pe=>{const De=this.I18n.t(`js.notifications.reasons.${pe.reason}`,{defaultValue:pe.reason||this.text.placeholder});B[De]=B[De]||0,B[De]+=1}),this.translatedReasons=B}buildProject(){const{project:B}=this.notification._links;B&&(this.project=Object.assign(Object.assign({},B),{showUrl:this.pathHelper.projectPath((0,n.Z)(B.href))}))}}oe.\u0275fac=function(B){return new(B||oe)(m.Y36(r.T),m.Y36(h.D),m.Y36(he),m.Y36(a.B),m.Y36(d.j),m.Y36(me.StateService),m.Y36(_e.U))},oe.\u0275cmp=m.Xpm({type:oe,selectors:[["op-in-app-notification-entry"]],hostVars:2,hostBindings:function(B,pe){2&B&&m.ekj("op-ian-item",pe.className)},inputs:{notification:"notification",aggregatedNotifications:"aggregatedNotifications"},decls:5,vars:4,consts:[[1,"op-ian-item--row",3,"click"],[4,"ngIf","ngIfElse"],["workPackageLoading",""],[1,"op-ian-item--top-line"],[1,"op-ian-item--status"],[3,"status"],["uiSref","work-packages.show",1,"op-ian-item--work-package-id-link","spot-link",3,"uiParams","textContent"],["class","op-ian-item--project",4,"ngIf"],[1,"op-ian-item--reason-wrapper"],["class","op-ian-item--reason",4,"ngFor","ngForOf"],["class","op-ian-item--reason-count",3,"textContent",4,"ngIf"],[1,"op-ian-item--buttons"],["data-qa-selector","mark-as-read-button","class","op-ian-item--button icon-mark-read","tabindex","0",3,"click",4,"ngIf"],["tabindex","0",1,"op-ian-item--button","op-ian-item--button_shown-on-focus","icon-info1",3,"keydown.enter"],[1,"op-ian-item--middle-line"],[3,"ngClass","textContent"],[1,"op-ian-item--work-package-subject",3,"textContent"],[1,"op-ian-item--bottom-line"],[1,"op-ian-item--date",3,"title","textContent"],[1,"op-ian-item--actors",3,"principal","hideName","hideAvatar","link"],[4,"ngIf"],[1,"op-ian-item--project"],["target","_blank",1,"op-ian-item--project-link",3,"href","textContent","click"],[1,"op-ian-item--reason"],[1,"op-ian-item--reason-count",3,"textContent"],["data-qa-selector","mark-as-read-button","tabindex","0",1,"op-ian-item--button","icon-mark-read",3,"click"],[1,"op-ian-item--loading"],["class","op-ian-item--loading-indicator","viewBox","0 0 200 20",4,"ngIf"],[1,"op-ian-item--reason-count"],[1,"op-ian-item--button","icon-mark-read"],["viewBox","0 0 200 20",1,"op-ian-item--loading-indicator"],["x","0","y","0","width","100%","height","5","rx","1"],["x","0","y","7","width","100%","height","5","rx","1"],["x","0","y","14","width","80%","height","5","rx","1"]],template:function(B,pe){if(1&B&&(m.TgZ(0,"div",0),m.NdJ("click",function(){return pe.showDetails()}),m.YNc(1,R,22,28,"ng-container",1),m.ALo(2,"async"),m.YNc(3,W,5,1,"ng-template",null,2,m.W1O),m.qZA()),2&B){const De=m.MAs(4);m.xp6(1),m.Q6J("ngIf",pe.workPackage$&&m.lcZ(2,2,pe.workPackage$))("ngIfElse",De)}},directives:[e.O5,Ce,ae.AnchorUISref,ae.UISref,e.sg,e.mk,ke.N,Ae.V],pipes:[e.Ov,e.Nd],styles:['.cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-item{display:block;background:#FFFFFF;margin:0;padding:15px 10px;font-size:.9rem;border-top:1px solid var(--content-default-border-color);border-radius:2px;height:100px}.op-ian-item:hover{background:var(--gray-light)}.op-ian-item:last-of-type{border-bottom:1px solid var(--content-default-border-color)}.op-ian-item_selected{background:#D1E5F5}.op-ian-item_selected:hover{background:#c9e0f3}.op-ian-item_read{background:#F3F3F3}.op-ian-item_read:hover{background:#eeeeee}.op-ian-item--row{padding:0;margin:0;background:transparent;border:0;font:inherit;text-align:inherit;width:100%;height:100%;display:grid;grid-template-rows:auto 14px auto;grid-template-areas:"header" "body" "footer";grid-gap:10px;align-items:center;cursor:pointer}.op-ian-item--top-line{grid-area:header;display:grid;grid-template-columns:max-content max-content minmax(0,max-content) max-content auto minmax(20px,max-content);grid-template-areas:"status wpIdLink project reason count buttons";grid-column-gap:5px;font-size:14px;align-items:center}.op-ian-item--middle-line{grid-area:body;display:grid;grid-template-columns:auto 1fr;grid-column-gap:5px}.op-ian-item--bottom-line{grid-area:footer;display:grid;grid-template-columns:auto 1fr;grid-column-gap:5px;align-items:center;color:var(--gray-dark)}.op-ian-item--work-package-subject{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;font-weight:bold}.op-ian-item--work-package-subject.-read{font-weight:normal}.op-ian-item--work-package-id-link{grid-area:wpIdLink}.op-ian-item--project{grid-area:project;color:var(--gray-dark);overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-ian-item--project-link,.op-ian-item--work-package-id-link{color:var(--gray-dark);font-weight:bold}.op-ian-item--reason-count{grid-area:count;display:inline-flex;justify-content:center;align-items:center;box-sizing:content-box;height:16px;line-height:16px;width:16px;border-radius:.5rem;padding:0 .15rem;font-size:.7rem;font-weight:bold;background:#00A3FF;color:#fff;flex-shrink:0;justify-self:flex-end;margin-right:5px}.op-ian-item--reason{grid-area:reason;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;color:var(--gray-dark);max-width:100%}.op-ian-item--date{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;max-width:100%;line-height:16px}.op-ian-item--status{grid-area:status;margin-right:5px}.op-ian-item--buttons{grid-area:buttons;font-size:16px}.op-ian-item--button:hover{color:var(--content-link-hover-active-color)}.op-ian-item--button_shown-on-focus{position:absolute;right:-10000px}.op-ian-item--button_shown-on-focus:focus{right:0}.op-ian-item--loading-indicator{height:100%;display:block;grid-area:loadingIndicator}.op-ian-item--loading-indicator svg{height:calc(100px - 30px)}.op-ian-item--loading{display:grid;grid-template-columns:max-content auto minmax(20px,max-content);grid-template-areas:"loadingIndicator count buttons";grid-column-gap:5px}\n'],encapsulation:2,changeDetection:0});var Oe=t(32824),$=t(90922),Xe=t(46430),rt=t(85603),ge=t(9170),be=t(24782),Me=t(13623);function Re(le,B){if(1&le&&(m._UZ(0,"op-in-app-notification-entry",8),m.ALo(1,"async"),m.ALo(2,"async")),2&le){const pe=B.$implicit,De=m.oxw(2);m.ekj("op-ian-item_expanded",pe[0].expanded)("op-ian-item_read",!0===pe[0].readIAN)("op-ian-item_selected",m.lcZ(1,11,De.stateChanged$)===pe[0]._links.resource.href),m.Q2q("data-qa-selector","op-ian-notification-item-",pe[0].id,""),m.Q6J("notification",pe[0])("aggregatedNotifications",pe),m.uIk("data-qa-ian-read",!0===pe[0].readIAN||void 0)("data-qa-ian-selected",m.lcZ(2,13,De.stateChanged$)===pe[0]._links.resource.href)}}function $e(le,B){if(1&le&&(m.ynx(0),m.TgZ(1,"cdk-virtual-scroll-viewport",6),m.YNc(2,Re,3,15,"op-in-app-notification-entry",7),m.ALo(3,"async"),m.qZA(),m.BQk()),2&le){const pe=m.oxw();m.xp6(2),m.Q6J("cdkVirtualForOf",m.lcZ(3,3,pe.notifications$))("cdkVirtualForTrackBy",pe.trackNotificationGroups)("cdkVirtualForTemplateCacheSize",0)}}function pt(le,B){if(1&le&&(m._UZ(0,"no-results",10),m.ALo(1,"async")),2&le){const pe=m.oxw(2);m.Q6J("title",m.lcZ(1,3,pe.noResultText$))("description",pe.text.change_notification_settings)("showIcon",!1)}}function mt(le,B){if(1&le&&(m.YNc(0,pt,2,5,"no-results",9),m.ALo(1,"async")),2&le){const pe=m.oxw();m.Q6J("ngIf",!1===m.lcZ(1,1,pe.loading$))}}function vt(le,B){if(1&le&&(m._UZ(0,"p",11),m.ALo(1,"async")),2&le){const pe=m.oxw();m.Q6J("textContent",m.lcZ(1,1,pe.totalCountWarning$))}}class Ue{constructor(B,pe,De,qe,ct,Tt,Pt,nt,Se){this.cdRef=B,this.elementRef=pe,this.I18n=De,this.storeService=qe,this.bellService=ct,this.uiRouterGlobals=Tt,this.state=Pt,this.apiV3=nt,this.pathService=Se,this.maxSize=be.Z,this.hasMoreThanPageSize$=this.storeService.query.hasMoreThanPageSize$,this.hasNotifications$=this.storeService.query.hasNotifications$,this.notifications$=this.storeService.query.notifications$,this.loading$=this.storeService.query.selectLoading(),this.totalCount$=this.bellService.unread$,this.noResultText$=this.totalCount$.pipe((0,p.U)(Pe=>Pe>0?this.text.no_results.with_current_filter:this.text.no_results.at_all)),this.totalCountWarning$=this.storeService.query.notLoaded$.pipe((0,ge.h)(Pe=>Pe>0),(0,p.U)(Pe=>this.I18n.t("js.notifications.center.total_count_warning",{newest_count:this.maxSize,more_count:Pe}))),this.stateChanged$=this.storeService.stateChanged$,this.originalOrder=()=>0,this.trackNotificationGroups=(Pe,We)=>We.map(et=>`${et.id}@${et.updatedAt}`).join(","),this.text={change_notification_settings:this.I18n.t("js.notifications.settings.change_notification_settings",{url:this.pathService.myNotificationsSettingsPath()}),title:this.I18n.t("js.notifications.title"),button_close:this.I18n.t("js.button_close"),no_results:{at_all:this.I18n.t("js.notifications.center.no_results.at_all"),with_current_filter:this.I18n.t("js.notifications.center.no_results.with_current_filter")}}}ngOnInit(){this.storeService.setFacet("unread"),this.storeService.setFilters({filter:this.uiRouterGlobals.params.filter,name:this.uiRouterGlobals.params.name})}}Ue.\u0275fac=function(B){return new(B||Ue)(m.Y36(m.sBO),m.Y36(m.SBq),m.Y36(h.D),m.Y36(he),m.Y36(Me.L),m.Y36(me.UIRouterGlobals),m.Y36(me.StateService),m.Y36(r.T),m.Y36(d.j))},Ue.\u0275cmp=m.Xpm({type:Ue,selectors:[["op-in-app-notification-center"]],decls:9,vars:7,consts:[[1,"op-ian-center"],[1,"op-ian-center--content"],[4,"ngIf","ngIfElse"],["noResults",""],[1,"op-ian-center--footer"],["class","op-ian-center--max-warning",3,"textContent",4,"ngIf"],["itemSize","100",1,"op-ian-center--viewport"],["class","op-ian-item",3,"op-ian-item_expanded","op-ian-item_read","op-ian-item_selected","notification","aggregatedNotifications",4,"cdkVirtualFor","cdkVirtualForOf","cdkVirtualForTrackBy","cdkVirtualForTemplateCacheSize"],[1,"op-ian-item",3,"notification","aggregatedNotifications"],[3,"title","description","showIcon",4,"ngIf"],[3,"title","description","showIcon"],[1,"op-ian-center--max-warning",3,"textContent"]],template:function(B,pe){if(1&B&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.YNc(2,$e,4,5,"ng-container",2),m.ALo(3,"async"),m.YNc(4,mt,2,3,"ng-template",null,3,m.W1O),m.qZA(),m.TgZ(6,"div",4),m.YNc(7,vt,2,3,"p",5),m.ALo(8,"async"),m.qZA(),m.qZA()),2&B){const De=m.MAs(5);m.xp6(2),m.Q6J("ngIf",m.lcZ(3,3,pe.hasNotifications$))("ngIfElse",De),m.xp6(5),m.Q6J("ngIf",m.lcZ(8,5,pe.hasMoreThanPageSize$))}},styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-center[_ngcontent-%COMP%]{display:grid;grid-template-rows:1fr auto;height:100%}.op-ian-center--content[_ngcontent-%COMP%]{height:100%}.op-ian-center--viewport[_ngcontent-%COMP%]{height:100%;overflow-x:hidden;scrollbar-color:transparent transparent;scrollbar-width:thin}.op-ian-center--viewport[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.op-ian-center--viewport[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.op-ian-center--viewport[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.op-ian-center--viewport[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.op-ian-center--viewport[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.op-ian-center--max-warning[_ngcontent-%COMP%]{margin-bottom:0;text-align:center;font-style:italic}.op-ian-center--loading-indicator[_ngcontent-%COMP%]{height:100px;overflow:hidden}.-browser-safari   .op-ian-center   [_nghost-%COMP%]{height:100%}"],changeDetection:0});var Le=t(2775);class Ee{constructor(B,pe){this.I18n=B,this.pathHelper=pe,this.myNotificationSettingsLink=this.pathHelper.myNotificationsSettingsPath(),this.text={mySettings:this.I18n.t("js.notifications.settings.title")}}}function st(le,B){if(1&le){const pe=m.EpF();m.ynx(0),m.TgZ(1,"button",1),m.NdJ("click",function(){const ct=m.CHM(pe).$implicit;return m.oxw().activateFacet(ct)}),m.ALo(2,"async"),m._UZ(3,"span",2),m.qZA(),m.BQk()}if(2&le){const pe=B.$implicit,De=m.oxw();m.xp6(1),m.ekj("-active",pe===m.lcZ(2,3,De.activeFacet$)),m.xp6(2),m.Q6J("textContent",De.text.facets[pe])}}Ee.\u0275fac=function(B){return new(B||Ee)(m.Y36(h.D),m.Y36(d.j))},Ee.\u0275cmp=m.Xpm({type:Ee,selectors:[["op-notification-settings-button"]],decls:3,vars:2,consts:[["target","_blank",1,"button",3,"href"],["icon-classes","button--icon icon-settings"],[1,"button--text",3,"textContent"]],template:function(B,pe){1&B&&(m.TgZ(0,"a",0),m._UZ(1,"op-icon",1),m._UZ(2,"span",2),m.qZA()),2&B&&(m.Q6J("href",pe.myNotificationSettingsLink,m.LSH),m.xp6(2),m.Q6J("textContent",pe.text.mySettings))},directives:[Le.o],encapsulation:2,changeDetection:0});class ut{constructor(B,pe){this.I18n=B,this.storeService=pe,this.text={facets:{unread:this.I18n.t("js.notifications.facets.unread"),all:this.I18n.t("js.notifications.facets.all")}},this.availableFacets=Object.keys(I.yz),this.activeFacet$=this.storeService.query.activeFacet$}activateFacet(B){this.storeService.setFacet(B)}}ut.\u0275fac=function(B){return new(B||ut)(m.Y36(h.D),m.Y36(he))},ut.\u0275cmp=m.Xpm({type:ut,selectors:[["op-activate-facet"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],["type","button",1,"button","form--field-inline-button",3,"click"],[1,"button--text","button--text_without_icon",3,"textContent"]],template:function(B,pe){1&B&&m.YNc(0,st,4,5,"ng-container",0),2&B&&m.Q6J("ngForOf",pe.availableFacets)},directives:[e.sg],pipes:[e.Ov],encapsulation:2,changeDetection:0});class It{constructor(B,pe){this.I18n=B,this.storeService=pe,this.text={mark_all_read:this.I18n.t("js.notifications.center.mark_all_read")}}markAllRead(){this.storeService.markAllAsRead()}}It.\u0275fac=function(B){return new(B||It)(m.Y36(h.D),m.Y36(he))},It.\u0275cmp=m.Xpm({type:It,selectors:[["op-mark-all-as-read-button"]],decls:3,vars:1,consts:[["type","button",1,"button",3,"click"],["icon-classes","button--icon icon-mark-all-read"],[1,"button--text",3,"textContent"]],template:function(B,pe){1&B&&(m.TgZ(0,"button",0),m.NdJ("click",function(){return pe.markAllRead()}),m._UZ(1,"op-icon",1),m._UZ(2,"span",2),m.qZA()),2&B&&(m.xp6(2),m.Q6J("textContent",pe.text.mark_all_read))},directives:[Le.o],encapsulation:2,changeDetection:0});var Zt=t(57014),Ut=t(57810),jt=t(77616),Dt=t(81628),bt=t(32853);function Lt(le,B){if(1&le&&m._UZ(0,"op-back-button",11),2&le){const pe=m.oxw();m.Q6J("customBackMethod",pe.backButtonCallback)}}function Wt(le,B){if(1&le&&(m.TgZ(0,"li",15),m._UZ(1,"ndc-dynamic",16),m.qZA()),2&le){const pe=m.oxw().$implicit,De=m.oxw(2);m.Q6J("ngClass",pe.containerClasses),m.xp6(1),m.Q6J("ndcDynamicComponent",pe.component)("ndcDynamicInputs",pe.inputs)("ndcDynamicInjector",De.injector)("ndcDynamicOutputs",pe.outputs)}}function Rt(le,B){if(1&le&&(m.ynx(0),m.YNc(1,Wt,2,5,"li",14),m.BQk()),2&le){const pe=B.$implicit;m.xp6(1),m.Q6J("ngIf",!pe.show||pe.show())}}function xt(le,B){if(1&le&&(m.TgZ(0,"ul",12),m.YNc(1,Rt,2,1,"ng-container",13),m.qZA()),2&le){const pe=m.oxw();m.xp6(1),m.Q6J("ngForOf",pe.toolbarButtonComponents)}}function Mt(le,B){if(1&le&&m._UZ(0,"ndc-dynamic",17),2&le){const pe=m.oxw();m.Q6J("ndcDynamicComponent",pe.filterContainerDefinition.component)("ndcDynamicInputs",pe.filterContainerDefinition.inputs)("ndcDynamicOutputs",pe.filterContainerDefinition.outputs)("ndcDynamicInjector",pe.injector)}}class wt extends se.N{constructor(B,pe,De,qe,ct,Tt,Pt,nt){super(),this.I18n=B,this.cdRef=pe,this.$transitions=De,this.state=qe,this.injector=ct,this.apiV3Service=Tt,this.backRoutingService=Pt,this.titleService=nt,this.text={title:this.I18n.t("js.notifications.title")},this.backButtonCallback=void 0,this.selectedTitle=this.text.title,this.filterContainerDefinition=null,this.currentPartition="-split",this.showToolbar=!0,this.titleEditingEnabled=!1,this.showToolbarSaveButton=!1,this.toolbarDisabled=!1,this.toolbarButtonComponents=[{component:ut,containerClasses:"form--field-inline-buttons-container"},{component:It},{component:Ee,containerClasses:"hidden-for-mobile"}]}ngOnInit(){this.documentReferer=document.referrer,this.titleService.prependFirstPart(this.text.title),this.removeTransitionSubscription=this.$transitions.onSuccess({},()=>{this.titleService.setFirstPart(this.text.title)})}ngOnDestroy(){super.ngOnDestroy(),this.removeTransitionSubscription()}setPartition(B){var pe;this.currentPartition=(null===(pe=B.data)||void 0===pe?void 0:pe.partition)||"-split"}updateTitleName(B){}changeChangesFromTitle(B){}}wt.\u0275fac=function(B){return new(B||wt)(m.Y36(h.D),m.Y36(m.sBO),m.Y36(me.TransitionService),m.Y36(me.StateService),m.Y36(m.zs3),m.Y36(r.T),m.Y36(Zt.Y),m.Y36(Ut.V))},wt.\u0275cmp=m.Xpm({type:wt,selectors:[["ng-component"]],features:[m._Bn([he]),m.qOj],decls:11,vars:8,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["class","op-back-button","linkClass","op-back-button_mobile-full-width",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector",4,"ngIf"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","op-back-button_mobile-full-width",1,"op-back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"]],template:function(B,pe){1&B&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.YNc(3,Lt,1,1,"op-back-button",3),m.TgZ(4,"editable-toolbar-title",4),m.NdJ("onSave",function(qe){return pe.changeChangesFromTitle(qe)})("onEmptySubmit",function(){return pe.updateTitleName("")}),m.qZA(),m.YNc(5,xt,2,1,"ul",5),m.qZA(),m.qZA(),m.TgZ(6,"div",6),m.YNc(7,Mt,1,4,"ndc-dynamic",7),m.qZA(),m.TgZ(8,"div",8),m._UZ(9,"div",9),m._UZ(10,"div",10),m.qZA(),m.qZA()),2&B&&(m.Q6J("ngClass",pe.currentPartition),m.xp6(3),m.Q6J("ngIf",pe.backButtonCallback),m.xp6(1),m.Q6J("title",pe.selectedTitle)("inFlight",pe.toolbarDisabled)("showSaveCondition",pe.showToolbarSaveButton)("editable",pe.titleEditingEnabled),m.xp6(1),m.Q6J("ngIf",pe.showToolbar),m.xp6(2),m.Q6J("ngIf",pe.filterContainerDefinition))},directives:[e.mk,e.O5,jt.s5,ae.UIView,Dt.W,e.sg,bt.B5,bt.oc],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr);margin-left:-10px;padding-left:10px;width:calc(100% + 10px)}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{flex-grow:1}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .title-container_editable[_ngcontent-%COMP%]{margin-left:-7px}@media only screen and (max-width: 679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:initial;max-width:100vw;max-height:100%}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;justify-items:start}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .op-back-button[_ngcontent-%COMP%]{grid-column:1/3;grid-row:1/2}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{grid-column:1/2;grid-row:2/3;overflow:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-items[_ngcontent-%COMP%]{grid-column:2/3;grid-row:2/3}}"],changeDetection:0});var Jt=t(1813),Ze=t(97656);function ve(le,B){if(1&le&&(m.ynx(0),m._UZ(1,"img",5),m.TgZ(2,"p",6),m.TgZ(3,"span"),m._uU(4),m.qZA(),m.qZA(),m.BQk()),2&le){const pe=m.oxw(2);m.xp6(1),m.Q6J("src",pe.image.no_selection,m.LSH),m.xp6(3),m.Oqu(pe.text.no_selection)}}function ne(le,B){if(1&le&&(m._UZ(0,"img",5),m.TgZ(1,"p",6),m._UZ(2,"span",7),m.ALo(3,"async"),m.qZA()),2&le){const pe=m.oxw(2);m.Q6J("src",pe.image.no_notification,m.LSH),m.xp6(2),m.Q6J("textContent",pe.noNotificationText(pe.hasNotifications,m.lcZ(3,2,pe.totalCount$)))}}function K(le,B){if(1&le&&(m.ynx(0),m.YNc(1,ve,5,2,"ng-container",2),m.ALo(2,"async"),m.YNc(3,ne,4,4,"ng-template",null,4,m.W1O),m.BQk()),2&le){const pe=m.MAs(4),De=m.oxw();m.xp6(1),m.Q6J("ngIf",m.lcZ(2,2,De.hasNotifications$))("ngIfElse",pe)}}function de(le,B){if(1&le&&m._UZ(0,"img",5),2&le){const pe=m.oxw();m.Q6J("src",pe.image.loading,m.LSH)}}class He{constructor(B,pe,De){this.I18n=B,this.storeService=pe,this.bellService=De,this.image={no_notification:(0,Ze.h)("notification-center/empty-state-no-notification.svg"),no_selection:(0,Ze.h)("notification-center/empty-state-no-selection.svg"),loading:(0,Ze.h)("notification-center/notification_loading.gif")},this.text={no_notification:this.I18n.t("js.notifications.center.empty_state.no_notification"),no_notification_with_current_filter:this.I18n.t("js.notifications.center.empty_state.no_notification_with_current_filter"),no_selection:this.I18n.t("js.notifications.center.empty_state.no_selection")},this.hasNotifications$=this.storeService.query.hasNotifications$,this.totalCount$=this.bellService.unread$,this.loading$=this.storeService.query.selectLoading()}noNotificationText(B,pe){return!B&&pe>0?this.text.no_notification_with_current_filter:this.text.no_notification}}He.\u0275fac=function(B){return new(B||He)(m.Y36(h.D),m.Y36(he),m.Y36(Me.L))},He.\u0275cmp=m.Xpm({type:He,selectors:[["op-empty-state"]],decls:6,vars:4,consts:[["data-qa-selector","op-empty-state",1,"work-packages--details","op-empty-state","hidden-for-mobile"],[1,"work-packages-tab-view--overflow","op-empty-state--content"],[4,"ngIf","ngIfElse"],["loading",""],["noNotification",""],[1,"op-empty-state--content-image",3,"src"],[1,"op-empty-state--content-text"],[3,"textContent"]],template:function(B,pe){if(1&B&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.YNc(2,K,5,4,"ng-container",2),m.ALo(3,"async"),m.YNc(4,de,1,1,"ng-template",null,3,m.W1O),m.qZA(),m.qZA()),2&B){const De=m.MAs(5);m.xp6(2),m.Q6J("ngIf",!1===m.lcZ(3,2,pe.loading$))("ngIfElse",De)}},directives:[e.O5],pipes:[e.Ov],styles:[".op-empty-state[_ngcontent-%COMP%]{overflow:auto;position:relative;border-left:2px solid #eee;border-top:2px solid #eee;padding:0}.op-empty-state--content[_ngcontent-%COMP%]{text-align:center;width:100%;top:35%;position:absolute}.op-empty-state--content-text[_ngcontent-%COMP%]{color:var(--gray-dark);font-size:18px}.op-empty-state--content-image[_ngcontent-%COMP%]{max-height:130px;min-height:130px;margin-bottom:15px}"],changeDetection:0});const ht=[{name:"notifications",parent:"root",url:"/notifications?{filter:string}&{name:string}",data:{bodyClasses:"router--work-packages-base"},redirectTo:"notifications.center.show",views:{"!$default":{component:Jt.p}}},{name:"notifications.center",component:wt,redirectTo:"notifications.center.show"},{name:"notifications.center.show",data:{baseRoute:"notifications.center.show"},views:{"content-left":{component:Ue},"content-right":{component:He}}},...(0,Xe.Z)("notifications.center.show",void 0,rt.o)];var yt=t(99250),St=t(87523),Et=t(55216);class je{}je.\u0275fac=function(B){return new(B||je)},je.\u0275mod=m.oAB({type:je}),je.\u0275inj=m.cJS({providers:[Me.L],imports:[[i.H,ae.UIRouterModule.forChild({states:ht}),bt.wA,e.ez,c.Q,Oe.j,yt.H,St.a,$.Cl]]}),m.B6R(Ue,[e.O5,$.N7,$.xd,$.x0,oe,Et.S],[e.Ov])},28470:(H,D,t)=>{"use strict";t.d(D,{R:()=>l});var i=t(96905),e=t(96617),c=t(65146),u=t(2308),r=t(2316),n=t(36868),h=t(54364),a=t(2775);function p(d,g){if(1&d){const C=r.EpF();r.TgZ(0,"button",1),r.NdJ("click",function(m){return r.CHM(C),r.oxw().onAddNewClick(m)}),r.TgZ(1,"span",2),r._UZ(2,"op-icon",3),r._uU(3),r.qZA(),r.qZA()}if(2&d){const C=r.oxw();r.xp6(3),r.hij(" ",C.text.button," ")}}class l{constructor(g,C,y,m,E){this.I18n=g,this.opInviteUserModalService=C,this.currentProjectService=y,this.currentUserService=m,this.ngSelectComponent=E,this.text={button:this.I18n.t("js.invite_user_modal.invite")}}ngOnInit(){this.projectId=this.projectId||this.currentProjectService.id,this.canInviteUsersToProject$=this.currentUserService.hasCapabilities$("memberships/create",this.projectId||void 0)}onAddNewClick(g){g.stopPropagation(),this.opInviteUserModalService.open(this.projectId),this.ngSelectComponent.close()}}l.\u0275fac=function(g){return new(g||l)(r.Y36(e.D),r.Y36(u.j),r.Y36(c.R),r.Y36(i.S),r.Y36(n.w9))},l.\u0275cmp=r.Xpm({type:l,selectors:[["op-invite-user-button"]],inputs:{projectId:"projectId"},decls:2,vars:3,consts:[["class","op-select-footer--label","type","button",3,"click",4,"ngIf"],["type","button",1,"op-select-footer--label",3,"click"],[1,"icon-context"],["icon-classes","icon-user-plus icon-context"]],template:function(g,C){1&g&&(r.YNc(0,p,4,1,"button",0),r.ALo(1,"async")),2&g&&r.Q6J("ngIf",r.lcZ(1,1,C.canInviteUsersToProject$))},directives:[h.O5,a.o],pipes:[h.Ov],styles:[""]})},6894:(H,D,t)=>{"use strict";t.d(D,{Y:()=>u});var i=t(54364),e=t(53875),c=t(2316);class u{}u.\u0275fac=function(n){return new(n||u)},u.\u0275mod=c.oAB({type:u}),u.\u0275inj=c.cJS({imports:[[i.ez,e.Q]]})},32775:(H,D,t)=>{"use strict";t.d(D,{N:()=>Et});var i=t(2316),e=t(1707),c=t(54364),u=t(7085),r=t(36868),n=t(37991),h=t(55811),a=t(6894),p=t(31256),l=t(77355),d=t(65146),g=t(83635);class y{constructor(le,B,pe){this.documentElement=le,this.opModalService=B,this.currentProjectService=pe}setupListener(){const le=this.documentElement.querySelectorAll("[invite-user-modal-augment]");for(let B=0;B<le.length;++B)le[B].addEventListener("click",this.spawnModal.bind(this))}spawnModal(le){le.preventDefault(),this.opModalService.show(g.E,"global",{projectId:this.currentProjectService.id}).closingEvent.subscribe(pe=>{pe.data&&window.location.reload()})}}y.\u0275fac=function(le){return new(le||y)(i.LFG(c.K0),i.LFG(l.S),i.LFG(d.R))},y.\u0275prov=i.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"});var m=t(21757),E=t(2308),P=t(96617),w=t(24e3),x=t(96905),k=t(81134),b=t(53466),v=t(33927),M=t(18293),S=t(10190);var A=t(52932),F=t(18252),I=t(76491),J=t(61486),N=t(80639),te=t(79902),ee=t(20979),G=t(26942),se=t(26269),me=t(3353);function _e(je,le){if(1&je&&i._uU(0),2&je){const B=le.item;i.hij(" ",(null==B.project?null:B.project.name)||B.name," ")}}function he(je,le){if(1&je&&(i.TgZ(0,"div",9),i._uU(1),i.qZA()),2&je){const B=i.oxw(3);i.xp6(1),i.Oqu(B.text.noInviteRights)}}function ae(je,le){if(1&je&&(i.TgZ(0,"div",6),i.TgZ(1,"div",7),i._uU(2),i.qZA(),i.YNc(3,he,2,1,"div",8),i.qZA()),2&je){const B=i.oxw(),pe=B.searchTerm,De=B.item;i.xp6(1),i.Q6J("ngOptionHighlight",pe),i.xp6(1),i.Oqu(De.project.name),i.xp6(1),i.Q6J("ngIf",De.disabled)}}function re(je,le){if(1&je&&i.YNc(0,ae,4,3,"div",5),2&je){const B=le.item;i.Q6J("ngIf",B)}}function ye(je,le){if(1&je&&(i.TgZ(0,"div",10),i._uU(1),i.qZA()),2&je){const B=i.oxw();i.xp6(1),i.hij(" ",B.text.noResultsFound," ")}}class Ce extends G.N{constructor(le,B,pe,De){super(),this.I18n=le,this.elementRef=B,this.apiV3Service=pe,this.currentUserService=De,this.text={noResultsFound:this.I18n.t("js.invite_user_modal.project.no_results"),noInviteRights:this.I18n.t("js.invite_user_modal.project.no_invite_rights")},this.input$=new I.X(""),this.items$=(0,J.aj)([this.input$.pipe((0,N.b)(100),(0,te.w)(qe=>{const ct=new se.qM;return ct.add("active","=",!0),qe&&ct.add("name_and_identifier","~",[qe]),this.apiV3Service.projects.filtered(ct).get().pipe((0,v.U)(Tt=>Tt.elements))})),this.currentUserService.capabilities$.pipe((0,v.U)(qe=>qe.filter(ct=>ct.action.href.endsWith("/memberships/create"))))]).pipe(this.untilDestroyed(),(0,v.U)(([qe,ct])=>{const Tt=qe.map(Pt=>({project:Pt,disabled:!ct.find(nt=>nt.context.id===Pt.id)}));return Tt.sort((Pt,nt)=>(Pt.disabled?1:0)-(nt.disabled?1:0)),Tt})),this.compareWith=(qe,ct)=>qe.project.id===ct.id}ngOnInit(){setTimeout(()=>this.input$.next(""))}}Ce.\u0275fac=function(le){return new(le||Ce)(i.Y36(P.D),i.Y36(i.SBq),i.Y36(ee.T),i.Y36(x.S))},Ce.\u0275cmp=i.Xpm({type:Ce,selectors:[["op-ium-project-search"]],inputs:{projectFormControl:["opFormBinding","projectFormControl"]},features:[i.qOj],decls:6,vars:9,consts:[["appendTo",".op-modal-overlay","bindValue","project","autofocus","",3,"formControl","typeahead","items","clearable","clearOnBackspace","clearSearchOnAdd","compareWith"],["ngselect",""],["ng-label-tmp",""],["ng-option-tmp",""],["ng-notfound-tmp",""],["class","ng-option-label",4,"ngIf"],[1,"ng-option-label"],[3,"ngOptionHighlight"],["class","ellipsis",4,"ngIf"],[1,"ellipsis"],[1,"ng-option","disabled"]],template:function(le,B){1&le&&(i.TgZ(0,"ng-select",0,1),i.ALo(2,"async"),i.YNc(3,_e,1,1,"ng-template",2),i.YNc(4,re,1,1,"ng-template",3),i.YNc(5,ye,2,1,"ng-template",4),i.qZA()),2&le&&i.Q6J("formControl",B.projectFormControl)("typeahead",B.input$)("items",i.lcZ(2,7,B.items$))("clearable",!0)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("compareWith",B.compareWith)},directives:[r.w9,e.JJ,e.oH,r.bb,r.Z2,r.vM,c.O5,me.s],pipes:[c.Ov],encapsulation:2});const ke={provide:e.a5,useExisting:(0,i.Gpc)(()=>Ae)};class Ae extends e.a5{get control(){return this.form}viewToModelUpdate(){}}function Fe(je,le){if(1&je&&i._UZ(0,"p",4),2&je){const B=i.oxw().$implicit;i.Q6J("innerHTML",B.description,i.oJD)}}function ot(je,le){if(1&je){const B=i.EpF();i.TgZ(0,"label"),i.TgZ(1,"input",1),i.NdJ("ngModelChange",function(De){i.CHM(B);return i.oxw().selected=De}),i.qZA(),i.TgZ(2,"div"),i.TgZ(3,"p",2),i._uU(4),i.qZA(),i.YNc(5,Fe,1,1,"p",3),i.qZA(),i.qZA()}if(2&je){const B=le.$implicit,pe=i.oxw();i.Tol(pe.getClassListForItem(B)),i.xp6(1),i.Q6J("value",B.value)("ngModel",pe.selected)("disabled",B.disabled),i.uIk("name",pe.name),i.xp6(3),i.Oqu(B.title),i.xp6(1),i.Q6J("ngIf",B.description)}}Ae.\u0275fac=function(){let je;return function(B){return(je||(je=i.n5z(Ae)))(B||Ae)}}(),Ae.\u0275dir=i.lG2({type:Ae,selectors:[["","opFormBinding",""]],inputs:{form:["opFormBinding","form"]},exportAs:["ngForm"],features:[i._Bn([ke]),i.qOj]});class it{constructor(){this.className=!0,this.options=[],this.name="op-option-list-"+ +new Date,this.selectedChange=new i.vpe,this._selected=null,this.onChange=le=>{},this.onTouched=le=>{}}get selected(){return this._selected}set selected(le){this._selected=le,this.onChange(le)}getClassListForItem(le){return{"op-option-list--item":!0,"op-option-list--item_selected":this.selected===le.value,"op-option-list--item_disabled":!!le.disabled}}writeValue(le){this._selected=le}registerOnChange(le){this.onChange=le}registerOnTouched(le){this.onTouched=le}}function Ve(je,le){if(1&je&&(i.TgZ(0,"div",11),i._uU(1),i.qZA()),2&je){const B=i.oxw();i.xp6(1),i.hij(" ",B.text.project.lackingPermissionInfo," ")}}function Ie(je,le){if(1&je&&(i.TgZ(0,"div",12),i._uU(1),i.qZA()),2&je){const B=i.oxw();i.xp6(1),i.hij(" ",B.text.project.required," ")}}function ue(je,le){if(1&je&&(i.TgZ(0,"div",12),i._uU(1),i.qZA()),2&je){const B=i.oxw();i.xp6(1),i.hij(" ",B.text.project.lackingPermission," ")}}function ie(je,le){if(1&je&&(i.TgZ(0,"div",13),i.TgZ(1,"div",14),i._uU(2),i.qZA(),i.qZA()),2&je){const B=i.oxw();i.xp6(2),i.hij(" ",B.text.type.required," ")}}it.\u0275fac=function(le){return new(le||it)},it.\u0275cmp=i.Xpm({type:it,selectors:[["op-option-list"]],hostVars:2,hostBindings:function(le,B){2&le&&i.ekj("op-option-list",B.className)},inputs:{options:"options",name:"name"},outputs:{selectedChange:"selectedChange"},features:[i._Bn([{provide:e.JU,useExisting:(0,i.Gpc)(()=>it),multi:!0}])],decls:1,vars:1,consts:[[3,"class",4,"ngFor","ngForOf"],["type","radio",1,"op-option-list--input",3,"value","ngModel","disabled","ngModelChange"],[1,"op-option-list--item-title"],["class","op-option-list--item-description",3,"innerHTML",4,"ngIf"],[1,"op-option-list--item-description",3,"innerHTML"]],template:function(le,B){1&le&&i.YNc(0,ot,6,8,"label",0),2&le&&i.Q6J("ngForOf",B.options)},directives:[c.sg,e._,e.Fj,e.JJ,e.On,c.O5],encapsulation:2});class R{constructor(le,B,pe,De){var je;this.I18n=le,this.elementRef=B,this.bannersService=pe,this.currentUserService=De,this.close=new i.vpe,this.save=new i.vpe,this.text={title:this.I18n.t("js.invite_user_modal.title.invite"),project:{required:this.I18n.t("js.invite_user_modal.project.required"),lackingPermission:this.I18n.t("js.invite_user_modal.project.lacking_permission"),lackingPermissionInfo:this.I18n.t("js.invite_user_modal.project.lacking_permission_info")},type:{required:this.I18n.t("js.invite_user_modal.type.required")},nextButton:this.I18n.t("js.invite_user_modal.project.next_button")},this.typeOptions=[{value:g.e.User,title:this.I18n.t("js.invite_user_modal.type.user.title"),description:this.I18n.t("js.invite_user_modal.type.user.description")},{value:g.e.Group,title:this.I18n.t("js.invite_user_modal.type.group.title"),description:this.I18n.t("js.invite_user_modal.type.group.description")}],this.projectAndTypeForm=new e.cw({type:new e.NI(g.e.User,[e.kI.required]),project:new e.NI(null,[e.kI.required],(je=this.currentUserService,le=>je.hasCapabilities$("memberships/create",(0,S.Z)(le.value.href)).pipe((0,b.q)(1),(0,v.U)(B=>B?null:{lackingPermission:!0}),(0,M.K)(()=>(0,k.of)(null)))))})}get typeControl(){return this.projectAndTypeForm.get("type")}get projectControl(){return this.projectAndTypeForm.get("project")}ngOnInit(){var le,B;null===(le=this.typeControl)||void 0===le||le.setValue(this.type),null===(B=this.projectControl)||void 0===B||B.setValue(this.project),this.setPlaceholderOption()}setPlaceholderOption(){this.bannersService.eeShowBanners?this.typeOptions.push({value:g.e.Placeholder,title:this.I18n.t("js.invite_user_modal.type.placeholder.title_no_ee"),description:this.I18n.t("js.invite_user_modal.type.placeholder.description_no_ee",{eeHref:this.bannersService.getEnterPriseEditionUrl({referrer:"placeholder-users",hash:"placeholder-users"})}),disabled:!0}):this.typeOptions.push({value:g.e.Placeholder,title:this.I18n.t("js.invite_user_modal.type.placeholder.title"),description:this.I18n.t("js.invite_user_modal.type.placeholder.description"),disabled:!1})}onSubmit(le){var B,pe;le.preventDefault(),this.projectAndTypeForm.invalid?this.projectAndTypeForm.markAsDirty():this.save.emit({project:null===(B=this.projectControl)||void 0===B?void 0:B.value,type:null===(pe=this.typeControl)||void 0===pe?void 0:pe.value})}}R.\u0275fac=function(le){return new(le||R)(i.Y36(P.D),i.Y36(i.SBq),i.Y36(w.j),i.Y36(x.S))},R.\u0275cmp=i.Xpm({type:R,selectors:[["op-ium-project-selection"]],inputs:{type:"type",project:"project"},outputs:{close:"close",save:"save"},decls:15,vars:9,consts:[[3,"formGroup","ngSubmit"],[3,"close"],[1,"op-modal--body","op-form"],["label","Project","required",""],["slot","input",3,"opFormBinding"],["slot","help-text",4,"ngIf"],["slot","errors","class","op-form-field--error",4,"ngIf"],["formControlName","type","slot","input",3,"options"],["class","op-form-field--errors","slot","errors",4,"ngIf"],[1,"op-modal--footer"],[1,"button","-highlight"],["slot","help-text"],["slot","errors",1,"op-form-field--error"],["slot","errors",1,"op-form-field--errors"],[1,"op-form-field--error"]],template:function(le,B){1&le&&(i.TgZ(0,"form",0),i.NdJ("ngSubmit",function(De){return B.onSubmit(De)}),i.TgZ(1,"op-modal-header",1),i.NdJ("close",function(){return B.close.emit()}),i._uU(2),i.qZA(),i.TgZ(3,"div",2),i.TgZ(4,"op-form-field",3),i._UZ(5,"op-ium-project-search",4),i.YNc(6,Ve,2,1,"div",5),i.YNc(7,Ie,2,1,"div",6),i.YNc(8,ue,2,1,"div",6),i.qZA(),i.TgZ(9,"op-form-field"),i._UZ(10,"op-option-list",7),i.YNc(11,ie,3,1,"div",8),i.qZA(),i.qZA(),i.TgZ(12,"div",9),i.TgZ(13,"button",10),i._uU(14),i.qZA(),i.qZA(),i.qZA()),2&le&&(i.Q6J("formGroup",B.projectAndTypeForm),i.xp6(2),i.Oqu(B.text.title),i.xp6(3),i.Q6J("opFormBinding",B.projectControl),i.xp6(1),i.Q6J("ngIf",null==B.projectControl.errors?null:B.projectControl.errors.lackingPermission),i.xp6(1),i.Q6J("ngIf",null==B.projectControl.errors?null:B.projectControl.errors.required),i.xp6(1),i.Q6J("ngIf",null==B.projectControl.errors?null:B.projectControl.errors.lackingPermission),i.xp6(2),i.Q6J("options",B.typeOptions),i.xp6(1),i.Q6J("ngIf",(null==B.projectAndTypeForm?null:B.projectAndTypeForm.dirty)&&(null==B.typeControl?null:B.typeControl.invalid)),i.xp6(3),i.Oqu(B.text.nextButton))},directives:[e._Y,e.JL,e.sg,A.g,F.V,Ce,Ae,c.O5,it,e.JJ,e.u],styles:[""]});var L=t(23896),W=t(57958),Oe=(t(9214),t(80044)),$=t(53882),Xe=t(42720),rt=t(83720),ge=t(91992),be=t(92597),Me=t(2775);function Re(je,le){if(1&je&&i._uU(0),2&je){const B=le.item;i.hij(" ",(null==B.principal?null:B.principal.name)||B.name," ")}}function $e(je,le){if(1&je&&(i.TgZ(0,"div",10),i._uU(1),i.qZA()),2&je){const B=i.oxw(3);i.xp6(1),i.Oqu(B.text.alreadyAMember())}}function pt(je,le){if(1&je&&(i.TgZ(0,"div",7),i.TgZ(1,"div",8),i._uU(2),i.qZA(),i.YNc(3,$e,2,1,"div",9),i.qZA()),2&je){const B=i.oxw(),pe=B.searchTerm,De=B.item;i.xp6(1),i.Q6J("ngOptionHighlight",pe),i.xp6(1),i.Oqu(De.principal.name),i.xp6(1),i.Q6J("ngIf",De.disabled)}}function mt(je,le){if(1&je&&i.YNc(0,pt,4,3,"div",6),2&je){const B=le.item;i.Q6J("ngIf",B)}}function vt(je,le){if(1&je&&(i.TgZ(0,"div",11),i._uU(1),i.qZA()),2&je){const B=i.oxw();i.xp6(1),i.hij(" ",B.text.noResults[B.type]," ")}}function Ue(je,le){if(1&je&&(i.TgZ(0,"div"),i._UZ(1,"op-icon",13),i.TgZ(2,"b"),i._uU(3),i.qZA(),i._uU(4),i.qZA()),2&je){const B=i.oxw(2);i.xp6(3),i.Oqu(B.text.inviteNewUser),i.xp6(1),i.hij(" ",B.input," ")}}function Le(je,le){if(1&je&&(i.TgZ(0,"div"),i._UZ(1,"op-icon",14),i.TgZ(2,"b"),i._uU(3),i.qZA(),i._uU(4),i.qZA()),2&je){const B=i.oxw(2);i.xp6(3),i.Oqu(B.text.createNewPlaceholder),i.xp6(1),i.hij(" ",B.input," ")}}function Ee(je,le){if(1&je&&(i.YNc(0,Ue,5,2,"div",12),i.ALo(1,"async"),i.YNc(2,Le,5,2,"div",12),i.ALo(3,"async")),2&je){const B=i.oxw();i.Q6J("ngIf",i.lcZ(1,2,B.canInviteByEmail$)),i.xp6(2),i.Q6J("ngIf",i.lcZ(3,4,B.canCreateNewPlaceholder$))}}class st extends G.N{constructor(le,B,pe,De){super(),this.I18n=le,this.elementRef=B,this.apiV3Service=pe,this.currentUserService=De,this.createNew=new i.vpe,this.input$=new I.X(""),this.input="",this.items$=this.input$.pipe(this.untilDestroyed(),(0,N.b)(200),(0,rt.x)(),(0,te.w)(this.loadPrincipalData.bind(this)),(0,ge.B)()),this.emailRegExp=/^\S+@\S+\.\S+$/,this.canInviteByEmail$=(0,J.aj)(this.items$,this.input$,this.currentUserService.hasCapabilities$("users/create")).pipe((0,v.U)(([qe,ct,Tt])=>Tt&&this.type===g.e.User&&!!ct&&this.emailRegExp.test(ct)&&!qe.find(Pt=>Pt.principal.email===ct))),this.canCreateNewPlaceholder$=(0,J.aj)(this.items$,this.input$,this.currentUserService.hasCapabilities$("placeholder_users/create")).pipe((0,v.U)(([qe,ct,Tt])=>!(!Tt||this.type!==g.e.Placeholder)&&(!!ct&&!qe.find(Pt=>Pt.name===ct)))),this.showAddTag=!1,this.text={alreadyAMember:()=>{var qe;return this.I18n.t("js.invite_user_modal.principal.already_member_message",{project:null===(qe=this.project)||void 0===qe?void 0:qe.name})},inviteNewUser:this.I18n.t("js.invite_user_modal.principal.invite_user"),createNewPlaceholder:this.I18n.t("js.invite_user_modal.principal.create_new_placeholder"),noResults:{User:this.I18n.t("js.invite_user_modal.principal.no_results_user"),PlaceholderUser:this.I18n.t("js.invite_user_modal.principal.no_results_placeholder"),Group:this.I18n.t("js.invite_user_modal.principal.no_results_group")}},this.compareWith=(qe,ct)=>qe.principal.id===ct.id,this.input$.subscribe(qe=>{this.input=qe}),(0,J.aj)(this.canInviteByEmail$,this.canCreateNewPlaceholder$).pipe((0,v.U)(([qe,ct])=>qe||ct)).subscribe(qe=>{this.showAddTag=qe})}ngOnInit(){setTimeout(()=>this.input$.next(""))}createNewFromInput(){this.createNew.emit({name:this.input})}loadPrincipalData(le){var B,pe;const De=new se.qM;le&&De.add("any_name_attribute","~",[le]),De.add("status","!",[3]),De.add("type","=",[this.type]),De.add("member","!",[(null===(B=this.project)||void 0===B?void 0:B.id)||""]);const qe=this.apiV3Service.principals.filtered(De).get(),ct=new se.qM;le&&ct.add("any_name_attribute","~",[le]),ct.add("status","!",[3]),ct.add("type","=",[this.type]),ct.add("member","=",[(null===(pe=this.project)||void 0===pe?void 0:pe.id)||""]);const Tt=this.apiV3Service.principals.filtered(ct).get();return(0,Xe.D)({members:Tt,nonMembers:qe}).pipe((0,v.U)(({members:Pt,nonMembers:nt})=>[...nt.elements.map(Se=>({principal:Se,disabled:!1})),...Pt.elements.map(Se=>({principal:Se,disabled:!0}))].slice(0,5)),(0,be.d)(1))}}function ut(je,le){if(1&je){const B=i.EpF();i.TgZ(0,"op-ium-principal-search",11),i.NdJ("createNew",function(De){return i.CHM(B),i.oxw().createNewFromInput(De)}),i.qZA()}if(2&je){const B=i.oxw();i.Q6J("opFormBinding",B.principalControl)("type",B.type)("project",B.project)}}function It(je,le){if(1&je){const B=i.EpF();i.TgZ(0,"p",12),i.TgZ(1,"b"),i._uU(2),i.qZA(),i._uU(3),i.TgZ(4,"button",13),i.NdJ("click",function(){i.CHM(B);const De=i.oxw();return null==De.principalControl?null:De.principalControl.setValue(null)}),i._uU(5),i.qZA(),i.qZA()}if(2&je){const B=i.oxw();i.xp6(2),i.Oqu(B.text.inviteUser),i.xp6(1),i.hij(" ",B.principal.name," "),i.xp6(2),i.Oqu(B.text.change)}}function Zt(je,le){if(1&je){const B=i.EpF();i.TgZ(0,"p",12),i.TgZ(1,"b"),i._uU(2),i.qZA(),i._uU(3),i.TgZ(4,"button",13),i.NdJ("click",function(){i.CHM(B);const De=i.oxw();return null==De.principalControl?null:De.principalControl.setValue(null)}),i._uU(5),i.qZA(),i.qZA()}if(2&je){const B=i.oxw();i.xp6(2),i.Oqu(B.text.createNewPlaceholder),i.xp6(1),i.hij(" ",B.principal.name," "),i.xp6(2),i.Oqu(B.text.change)}}function Ut(je,le){if(1&je&&(i.TgZ(0,"div",14),i._uU(1),i.qZA()),2&je){const B=i.oxw();i.xp6(1),i.hij(" ",B.text.required[B.type]," ")}}function jt(je,le){if(1&je&&i._UZ(0,"op-dynamic-form",15),2&je){const B=i.oxw();i.Q6J("dynamicFormGroup",B.dynamicFieldsControl)("settings",B.userDynamicFieldConfig)("formUrl",B.apiV3Service.users.form.path)("handleSubmit",!1)}}st.\u0275fac=function(le){return new(le||st)(i.Y36(P.D),i.Y36(i.SBq),i.Y36(ee.T),i.Y36(x.S))},st.\u0275cmp=i.Xpm({type:st,selectors:[["op-ium-principal-search"]],inputs:{principalControl:["opFormBinding","principalControl"],type:"type",project:"project"},outputs:{createNew:"createNew"},features:[i.qOj],decls:7,vars:10,consts:[["appendTo",".op-modal-overlay","bindValue","principal","autofocus","",3,"formControl","addTag","typeahead","items","clearable","clearOnBackspace","clearSearchOnAdd","compareWith"],["ngselect",""],["ng-label-tmp",""],["ng-option-tmp",""],["ng-notfound-tmp",""],["ng-tag-tmp",""],["class","ng-option-label",4,"ngIf"],[1,"ng-option-label"],[3,"ngOptionHighlight"],["class","ellipsis",4,"ngIf"],[1,"ellipsis"],[1,"ng-option","disabled"],[4,"ngIf"],["icon-classes","icon-mail1 icon-context"],["icon-classes","icon-add icon-context"]],template:function(le,B){1&le&&(i.TgZ(0,"ng-select",0,1),i.ALo(2,"async"),i.YNc(3,Re,1,1,"ng-template",2),i.YNc(4,mt,1,1,"ng-template",3),i.YNc(5,vt,2,1,"ng-template",4),i.YNc(6,Ee,4,6,"ng-template",5),i.qZA()),2&le&&i.Q6J("formControl",B.principalControl)("addTag",!!B.showAddTag&&B.createNewFromInput.bind(B))("typeahead",B.input$)("items",i.lcZ(2,8,B.items$))("clearable",!0)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("compareWith",B.compareWith)},directives:[r.w9,e.JJ,e.oH,r.bb,r.Z2,r.vM,r.N6,c.O5,me.s,Me.o],pipes:[c.Ov],encapsulation:2});class bt{constructor(le,B,pe,De){this.I18n=le,this.httpClient=B,this.apiV3Service=pe,this.cdRef=De,this.close=new i.vpe,this.save=new i.vpe,this.back=new i.vpe,this.PrincipalType=g.e,this.text={title:()=>this.I18n.t("js.invite_user_modal.title.invite_to_project",{type:this.I18n.t(`js.invite_user_modal.title.${this.type}`),project:this.project.name}),label:{User:this.I18n.t("js.invite_user_modal.principal.label.name_or_email"),PlaceholderUser:this.I18n.t("js.invite_user_modal.principal.label.name"),Group:this.I18n.t("js.invite_user_modal.principal.label.name"),Email:this.I18n.t("js.label_email")},change:this.I18n.t("js.label_change"),inviteUser:this.I18n.t("js.invite_user_modal.principal.invite_user"),createNewPlaceholder:this.I18n.t("js.invite_user_modal.principal.create_new_placeholder"),required:{User:this.I18n.t("js.invite_user_modal.principal.required.user"),PlaceholderUser:this.I18n.t("js.invite_user_modal.principal.required.placeholder"),Group:this.I18n.t("js.invite_user_modal.principal.required.group")},backButton:this.I18n.t("js.invite_user_modal.back"),nextButton:this.I18n.t("js.invite_user_modal.principal.next_button")},this.principalForm=new e.cw({principal:new e.NI(null,[e.kI.required]),userDynamicFields:new e.cw({})}),this.userDynamicFieldConfig={payload:null,schema:null}}get principalControl(){return this.principalForm.get("principal")}get principal(){var le;return null===(le=this.principalControl)||void 0===le?void 0:le.value}get dynamicFieldsControl(){return this.principalForm.get("userDynamicFields")}get customFields(){var le;return null===(le=this.dynamicFieldsControl)||void 0===le?void 0:le.value}get hasPrincipalSelected(){return!!this.principal}get textLabel(){return this.type===g.e.User&&this.isNewPrincipal?this.text.label.Email:this.text.label[this.type]}get isNewPrincipal(){return this.hasPrincipalSelected&&!(this.principal instanceof Oe.X)}get isMemberOfCurrentProject(){var le,B,pe,De;return!!(null===(De=null===(pe=null===(B=null===(le=this.principalControl)||void 0===le?void 0:le.value)||void 0===B?void 0:B.memberships)||void 0===pe?void 0:pe.elements)||void 0===De?void 0:De.find(qe=>qe.project.id===this.project.id))}ngOnInit(){var le;if(null===(le=this.principalControl)||void 0===le||le.setValue(this.principalData.principal),this.type===g.e.User){const B=this.isNewPrincipal?this.principalData.customFields:{};this.apiV3Service.users.form.post(B).pipe((0,L.take)(1),(0,v.U)(pe=>pe.$source)).subscribe(pe=>{var De,qe,je;this.userDynamicFieldConfig.schema=(je=null===(De=pe._embedded)||void 0===De?void 0:De.schema,Object.keys(je).reduce((le,B)=>B.startsWith("customField")&&je[B].required?Object.assign(Object.assign({},le),{[B]:je[B]}):le,{})),this.userDynamicFieldConfig.payload=null===(qe=pe._embedded)||void 0===qe?void 0:qe.payload,this.cdRef.detectChanges()})}}createNewFromInput(le){var B;null===(B=this.principalControl)||void 0===B||B.setValue(le)}onSubmit(le){le.preventDefault(),this.dynamicForm?this.dynamicForm.validateForm().subscribe(()=>{this.onValidatedSubmit()}):this.onValidatedSubmit()}onValidatedSubmit(){if(this.principalForm.invalid)return;const le=this.userDynamicFieldConfig.schema||{},B=Object.keys(le).reduce((pe,De)=>{const qe=le[De];let ct=this.customFields[De];return"_links"===qe.location&&(ct=Array.isArray(ct)?ct.map(Tt=>Tt._links?Tt._links.self:Tt):ct._links?ct._links.self:ct),pe=Object.assign(Object.assign({},pe),{[De]:ct})},{});this.save.emit({principalData:{customFields:B,principal:this.principal},isAlreadyMember:this.isMemberOfCurrentProject})}}bt.\u0275fac=function(le){return new(le||bt)(i.Y36(P.D),i.Y36($.eN),i.Y36(ee.T),i.Y36(i.sBO))},bt.\u0275cmp=i.Xpm({type:bt,selectors:[["op-ium-principal"]],viewQuery:function(le,B){if(1&le&&i.Gf(W.r,5),2&le){let pe;i.iGM(pe=i.CRH())&&(B.dynamicForm=pe.first)}},inputs:{principalData:"principalData",project:"project",type:"type"},outputs:{close:"close",save:"save",back:"back"},decls:15,vars:10,consts:[[3,"formGroup","ngSubmit"],[3,"close"],[1,"op-modal--body","op-form"],["required","",3,"label"],["slot","input",3,"opFormBinding","type","project","createNew",4,"ngIf"],["slot","input",4,"ngIf"],["slot","errors","class","op-form-field--error",4,"ngIf"],[3,"dynamicFormGroup","settings","formUrl","handleSubmit",4,"ngIf"],[1,"op-modal--footer"],["type","button",1,"button",3,"click"],[1,"button","-highlight"],["slot","input",3,"opFormBinding","type","project","createNew"],["slot","input"],["type","button",1,"spot-link",3,"click"],["slot","errors",1,"op-form-field--error"],[3,"dynamicFormGroup","settings","formUrl","handleSubmit"]],template:function(le,B){1&le&&(i.TgZ(0,"form",0),i.NdJ("ngSubmit",function(De){return B.onSubmit(De)}),i.TgZ(1,"op-modal-header",1),i.NdJ("close",function(){return B.close.emit()}),i._uU(2),i.qZA(),i.TgZ(3,"div",2),i.TgZ(4,"op-form-field",3),i.YNc(5,ut,1,3,"op-ium-principal-search",4),i.YNc(6,It,6,3,"p",5),i.YNc(7,Zt,6,3,"p",5),i.YNc(8,Ut,2,1,"div",6),i.qZA(),i.YNc(9,jt,1,4,"op-dynamic-form",7),i.qZA(),i.TgZ(10,"div",8),i.TgZ(11,"button",9),i.NdJ("click",function(){return B.back.emit()}),i._uU(12),i.qZA(),i.TgZ(13,"button",10),i._uU(14),i.qZA(),i.qZA(),i.qZA()),2&le&&(i.Q6J("formGroup",B.principalForm),i.xp6(2),i.Oqu(B.text.title()),i.xp6(2),i.Q6J("label",B.textLabel),i.xp6(1),i.Q6J("ngIf",!(B.hasPrincipalSelected&&B.isNewPrincipal)),i.xp6(1),i.Q6J("ngIf",B.isNewPrincipal&&B.type===B.PrincipalType.User),i.xp6(1),i.Q6J("ngIf",B.isNewPrincipal&&B.type===B.PrincipalType.Placeholder),i.xp6(1),i.Q6J("ngIf",(null==B.principalControl?null:B.principalControl.touched)&&(null==B.principalControl?null:B.principalControl.invalid)),i.xp6(1),i.Q6J("ngIf",B.isNewPrincipal&&B.type===B.PrincipalType.User&&B.userDynamicFieldConfig.schema),i.xp6(3),i.Oqu(B.text.backButton),i.xp6(2),i.Oqu(B.text.nextButton))},directives:[e._Y,e.JL,e.sg,A.g,F.V,c.O5,st,Ae,W.r],styles:[""]});t(4816);var Wt=t(79441),Rt=t(9170);function xt(je,le){if(1&je&&(i.TgZ(0,"div",4),i._uU(1),i.qZA()),2&je){const B=le.item,pe=le.searchTerm;i.Q6J("ngOptionHighlight",pe),i.xp6(1),i.Oqu(B.name)}}function Mt(je,le){if(1&je&&(i.TgZ(0,"div",5),i._uU(1),i.qZA()),2&je){const B=i.oxw();i.xp6(1),i.hij(" ",B.text.noRolesFound," ")}}class wt extends G.N{constructor(le,B,pe){super(),this.I18n=le,this.elementRef=B,this.apiV3Service=pe,this.input$=new Wt.xQ,this.roles$=new Wt.xQ,this.text={noRolesFound:this.I18n.t("js.invite_user_modal.role.no_roles_found")},this.items$=(0,J.aj)(this.input$.pipe(this.untilDestroyed(),(0,N.b)(200),(0,Rt.h)(De=>"string"==typeof De),(0,v.U)(De=>De.toLowerCase()),(0,rt.x)()),this.roles$).pipe((0,v.U)(([De,qe])=>qe.filter(ct=>!De||-1!==ct.name.toLowerCase().indexOf(De))))}ngOnInit(){const le=new se.qM;le.add("grantable","=",!0),le.add("unit","=",["project"]),this.apiV3Service.roles.filtered(le).get().subscribe(({elements:B})=>this.roles$.next(B)),setTimeout(()=>this.input$.next(""))}}function Jt(je,le){if(1&je&&(i.TgZ(0,"div",10),i._uU(1),i.qZA()),2&je){const B=i.oxw();i.xp6(1),i.hij(" ",B.text.required," ")}}wt.\u0275fac=function(le){return new(le||wt)(i.Y36(P.D),i.Y36(i.SBq),i.Y36(ee.T))},wt.\u0275cmp=i.Xpm({type:wt,selectors:[["op-ium-role-search"]],inputs:{roleControl:["opFormBinding","roleControl"]},features:[i.qOj],decls:5,vars:9,consts:[["appendTo",".op-modal-overlay","bindLabel","name","autofocus","",3,"formControl","typeahead","items","virtualScroll","clearable","clearOnBackspace","clearSearchOnAdd"],["ngselect",""],["ng-option-tmp",""],["ng-notfound-tmp",""],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"],[1,"ng-option","disabled"]],template:function(le,B){1&le&&(i.TgZ(0,"ng-select",0,1),i.ALo(2,"async"),i.YNc(3,xt,2,2,"ng-template",2),i.YNc(4,Mt,2,1,"ng-template",3),i.qZA()),2&le&&i.Q6J("formControl",B.roleControl)("typeahead",B.input$)("items",i.lcZ(2,7,B.items$))("virtualScroll",!0)("clearable",!0)("clearOnBackspace",!1)("clearSearchOnAdd",!1)},directives:[r.w9,e.JJ,e.oH,r.Z2,r.vM,me.s],pipes:[c.Ov],encapsulation:2});class Ze{constructor(le){this.I18n=le,this.close=new i.vpe,this.back=new i.vpe,this.save=new i.vpe,this.text={title:()=>{var B,pe;return this.I18n.t("js.invite_user_modal.title.invite_principal_to_project",{principal:null===(B=this.principal)||void 0===B?void 0:B.name,project:null===(pe=this.project)||void 0===pe?void 0:pe.name})},label:()=>{var B;return this.I18n.t("js.invite_user_modal.role.label",{project:null===(B=this.project)||void 0===B?void 0:B.name})},description:()=>{var B;return this.I18n.t("js.invite_user_modal.role.description",{principal:null===(B=this.principal)||void 0===B?void 0:B.name})},required:this.I18n.t("js.invite_user_modal.role.required"),backButton:this.I18n.t("js.invite_user_modal.back"),nextButton:this.I18n.t("js.invite_user_modal.role.next_button")},this.roleForm=new e.cw({role:new e.NI(null,[e.kI.required])})}get roleControl(){return this.roleForm.get("role")}ngOnInit(){var le;null===(le=this.roleControl)||void 0===le||le.setValue(this.role)}onSubmit(le){var B;le.preventDefault(),this.roleForm.invalid?this.roleForm.markAsDirty():this.save.emit(null===(B=this.roleForm)||void 0===B?void 0:B.value.role)}}Ze.\u0275fac=function(le){return new(le||Ze)(i.Y36(P.D))},Ze.\u0275cmp=i.Xpm({type:Ze,selectors:[["op-ium-role"]],inputs:{type:"type",project:"project",principal:"principal",role:"role"},outputs:{close:"close",back:"back",save:"save"},decls:13,vars:8,consts:[[3,"formGroup","ngSubmit"],[3,"close"],[1,"op-modal--body","op-form"],["required","",3,"label"],["slot","description",1,"op-form-field--description",3,"innerHtml"],["slot","input",3,"opFormBinding"],["slot","errors","class","op-form-field--error",4,"ngIf"],[1,"op-modal--footer"],["type","button",1,"button",3,"click"],[1,"button","-highlight"],["slot","errors",1,"op-form-field--error"]],template:function(le,B){1&le&&(i.TgZ(0,"form",0),i.NdJ("ngSubmit",function(De){return B.onSubmit(De)}),i.TgZ(1,"op-modal-header",1),i.NdJ("close",function(){return B.close.emit()}),i._uU(2),i.qZA(),i.TgZ(3,"div",2),i.TgZ(4,"op-form-field",3),i._UZ(5,"p",4),i._UZ(6,"op-ium-role-search",5),i.YNc(7,Jt,2,1,"div",6),i.qZA(),i.qZA(),i.TgZ(8,"div",7),i.TgZ(9,"button",8),i.NdJ("click",function(){return B.back.emit()}),i._uU(10),i.qZA(),i.TgZ(11,"button",9),i._uU(12),i.qZA(),i.qZA(),i.qZA()),2&le&&(i.Q6J("formGroup",B.roleForm),i.xp6(2),i.Oqu(B.text.title()),i.xp6(2),i.Q6J("label",B.text.label()),i.xp6(1),i.Q6J("innerHtml",B.text.description(),i.oJD),i.xp6(1),i.Q6J("opFormBinding",B.roleControl),i.xp6(1),i.Q6J("ngIf",(null==B.roleControl?null:B.roleControl.touched)&&(null==B.roleControl?null:B.roleControl.invalid)),i.xp6(3),i.Oqu(B.text.backButton),i.xp6(2),i.Oqu(B.text.nextButton))},directives:[e._Y,e.JL,e.sg,A.g,F.V,wt,Ae,c.O5],styles:[""]});const ve=["input"];class ne{constructor(le,B){this.I18n=le,this.elementRef=B,this.message="",this.close=new i.vpe,this.back=new i.vpe,this.save=new i.vpe,this.text={title:()=>{var pe,De;return this.I18n.t("js.invite_user_modal.title.invite_principal_to_project",{principal:null===(pe=this.principal)||void 0===pe?void 0:pe.name,project:null===(De=this.project)||void 0===De?void 0:De.name})},label:this.I18n.t("js.invite_user_modal.message.label"),description:()=>{var pe;return this.I18n.t("js.invite_user_modal.message.description",{principal:null===(pe=this.principal)||void 0===pe?void 0:pe.name})},backButton:this.I18n.t("js.invite_user_modal.back"),nextButton:this.I18n.t("js.invite_user_modal.message.next_button")},this.messageForm=new e.cw({message:new e.NI("")})}get messageControl(){return this.messageForm.get("message")}ngOnInit(){var le;null===(le=this.messageControl)||void 0===le||le.setValue(this.message)}ngAfterViewInit(){this.input.nativeElement.focus()}onSubmit(le){var B;le.preventDefault(),this.messageForm.invalid?this.messageForm.markAsDirty():this.save.emit({message:null===(B=this.messageControl)||void 0===B?void 0:B.value})}}ne.\u0275fac=function(le){return new(le||ne)(i.Y36(P.D),i.Y36(i.SBq))},ne.\u0275cmp=i.Xpm({type:ne,selectors:[["op-ium-message"]],viewQuery:function(le,B){if(1&le&&i.Gf(ve,5),2&le){let pe;i.iGM(pe=i.CRH())&&(B.input=pe.first)}},inputs:{type:"type",project:"project",principal:"principal",message:"message"},outputs:{close:"close",back:"back",save:"save"},decls:15,vars:7,consts:[[3,"formGroup","ngSubmit"],[3,"close"],[1,"op-modal--body","op-form"],[3,"label"],["slot","description",1,"op-form-field--description"],["slot","input","autofocus","",1,"op-input","op-ium-invite-message-field",3,"formControl"],["input",""],[1,"op-modal--footer"],["type","button",1,"button",3,"click"],[1,"button","-highlight"]],template:function(le,B){1&le&&(i.TgZ(0,"form",0),i.NdJ("ngSubmit",function(De){return B.onSubmit(De)}),i.TgZ(1,"op-modal-header",1),i.NdJ("close",function(){return B.close.emit()}),i._uU(2),i.qZA(),i.TgZ(3,"div",2),i.TgZ(4,"op-form-field",3),i.TgZ(5,"p",4),i._uU(6),i.qZA(),i.TgZ(7,"textarea",5,6),i._uU(9,"      "),i.qZA(),i.qZA(),i.qZA(),i.TgZ(10,"div",7),i.TgZ(11,"button",8),i.NdJ("click",function(){return B.back.emit()}),i._uU(12),i.qZA(),i.TgZ(13,"button",9),i._uU(14),i.qZA(),i.qZA(),i.qZA()),2&le&&(i.Q6J("formGroup",B.messageForm),i.xp6(2),i.Oqu(B.text.title()),i.xp6(2),i.Q6J("label",B.text.label),i.xp6(2),i.hij(" ",B.text.description()," "),i.xp6(1),i.Q6J("formControl",B.messageControl),i.xp6(5),i.Oqu(B.text.backButton),i.xp6(2),i.Oqu(B.text.nextButton))},directives:[e._Y,e.JL,e.sg,A.g,F.V,e.Fj,e.JJ,e.oH],styles:[".op-ium-invite-message-field[_ngcontent-%COMP%]{height:8em}"]});var K=t(67202);function de(je,le){if(1&je&&(i.TgZ(0,"op-form-field",3),i.TgZ(1,"p",10),i._uU(2),i.qZA(),i.qZA()),2&je){const B=i.oxw();i.Q6J("label",B.text.messageLabel),i.xp6(2),i.Oqu(B.message)}}class He{constructor(le,B,pe){this.I18n=le,this.elementRef=B,this.api=pe,this.message="",this.close=new i.vpe,this.back=new i.vpe,this.save=new i.vpe,this.PrincipalType=g.e,this.text={title:()=>{var De,qe;return this.I18n.t("js.invite_user_modal.title.invite_principal_to_project",{principal:null===(De=this.principal)||void 0===De?void 0:De.name,project:null===(qe=this.project)||void 0===qe?void 0:qe.name})},projectLabel:this.I18n.t("js.invite_user_modal.project.label"),principalLabel:{User:this.I18n.t("js.invite_user_modal.principal.label.name_or_email"),PlaceholderUser:this.I18n.t("js.invite_user_modal.principal.label.name"),Group:this.I18n.t("js.invite_user_modal.principal.label.name")},roleLabel:()=>{var De;return this.I18n.t("js.invite_user_modal.role.label",{project:null===(De=this.project)||void 0===De?void 0:De.name})},messageLabel:this.I18n.t("js.invite_user_modal.message.label"),backButton:this.I18n.t("js.invite_user_modal.back"),nextButton:()=>this.I18n.t("js.invite_user_modal.summary.next_button",{type:this.type,principal:this.principal})}}get principal(){return this.principalData.principal}invite(){return(0,k.of)(this.principalData).pipe((0,te.w)(le=>this.createPrincipal(le)),(0,te.w)(le=>this.api.memberships.post({principal:le,project:this.project,roles:[this.role],notificationMessage:{raw:this.message}}).pipe((0,K.h)(le))))}createPrincipal(le){const{principal:B,customFields:pe}=le;if(B instanceof Oe.X)return(0,k.of)(B);switch(this.type){case g.e.User:return this.api.users.post(Object.assign({email:B.name,status:"invited"},pe));case g.e.Placeholder:return this.api.placeholder_users.post({name:B.name});default:throw new Error("Unsupported PrincipalType given")}}onSubmit(le){le.preventDefault(),this.invite().subscribe(B=>this.save.emit({principal:B}))}}He.\u0275fac=function(le){return new(le||He)(i.Y36(P.D),i.Y36(i.SBq),i.Y36(ee.T))},He.\u0275cmp=i.Xpm({type:He,selectors:[["op-ium-summary"]],inputs:{type:"type",project:"project",role:"role",principalData:"principalData",message:"message"},outputs:{close:"close",back:"back",save:"save"},decls:20,vars:10,consts:[["name","sendUserInviteForm",1,"op-ium-summary",3,"submit"],[3,"close"],[1,"op-modal--body","op-form"],[3,"label"],["slot","input"],[1,"op-ium-summary__row"],[3,"label",4,"ngIf"],[1,"op-modal--footer"],["type","button",1,"button",3,"click"],[1,"button","-highlight"],["slot","input",1,"op-ium-summary-message"]],template:function(le,B){1&le&&(i.TgZ(0,"form",0),i.NdJ("submit",function(De){return B.onSubmit(De)}),i.TgZ(1,"op-modal-header",1),i.NdJ("close",function(){return B.close.emit()}),i._uU(2),i.qZA(),i.TgZ(3,"div",2),i.TgZ(4,"op-form-field",3),i.TgZ(5,"p",4),i._uU(6),i.qZA(),i.qZA(),i.TgZ(7,"div",5),i.TgZ(8,"op-form-field",3),i.TgZ(9,"p",4),i._uU(10),i.qZA(),i.qZA(),i.TgZ(11,"op-form-field",3),i.TgZ(12,"p",4),i._uU(13),i.qZA(),i.qZA(),i.qZA(),i.YNc(14,de,3,2,"op-form-field",6),i.qZA(),i.TgZ(15,"div",7),i.TgZ(16,"button",8),i.NdJ("click",function(){return B.back.emit()}),i._uU(17),i.qZA(),i.TgZ(18,"button",9),i._uU(19),i.qZA(),i.qZA(),i.qZA()),2&le&&(i.xp6(2),i.Oqu(B.text.title()),i.xp6(2),i.Q6J("label",B.text.projectLabel),i.xp6(2),i.Oqu(B.project.name),i.xp6(2),i.Q6J("label",B.text.principalLabel[B.type]),i.xp6(2),i.Oqu(null==B.principal?null:B.principal.name),i.xp6(1),i.Q6J("label",B.text.roleLabel()),i.xp6(2),i.Oqu(B.role.name),i.xp6(1),i.Q6J("ngIf",B.type!==B.PrincipalType.Placeholder&&B.message),i.xp6(3),i.Oqu(B.text.backButton),i.xp6(2),i.Oqu(B.text.nextButton()))},directives:[e._Y,e.JL,e.F,A.g,F.V,c.O5],styles:[".op-ium-summary-message[_ngcontent-%COMP%]{white-space:pre-wrap}"]});var ht=t(97656);class yt{constructor(le,B){this.I18n=le,this.elementRef=B,this.close=new i.vpe,this.PrincipalType=g.e,this.user_image=(0,ht.h)("invite-user-modal/successful-invite.svg"),this.placeholder_image=(0,ht.h)("invite-user-modal/placeholder-added.svg"),this.text={title:()=>this.I18n.t("js.invite_user_modal.success.title",{principal:this.createdNewPrincipal?this.principal.email:this.principal.name}),description:{User:()=>{var pe;return this.I18n.t("js.invite_user_modal.success.description.user",{project:null===(pe=this.project)||void 0===pe?void 0:pe.name})},PlaceholderUser:()=>{var pe;return this.I18n.t("js.invite_user_modal.success.description.placeholder",{project:null===(pe=this.project)||void 0===pe?void 0:pe.name})},Group:()=>{var pe;return this.I18n.t("js.invite_user_modal.success.description.group",{project:null===(pe=this.project)||void 0===pe?void 0:pe.name})}},nextButton:this.I18n.t("js.invite_user_modal.success.next_button")}}}yt.\u0275fac=function(le){return new(le||yt)(i.Y36(P.D),i.Y36(i.SBq))},yt.\u0275cmp=i.Xpm({type:yt,selectors:[["op-ium-success"]],inputs:{principal:"principal",project:"project",type:"type",createdNewPrincipal:"createdNewPrincipal"},outputs:{close:"close"},decls:8,vars:4,consts:[[1,"op-ium-success"],[1,"op-modal--body","op-modal--body_center"],[3,"src"],[3,"textContent"],["type","button",1,"button","-highlight",3,"click"]],template:function(le,B){1&le&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i._UZ(2,"img",2),i._UZ(3,"h1",3),i._UZ(4,"p",3),i.TgZ(5,"p"),i.TgZ(6,"button",4),i.NdJ("click",function(){return B.close.emit()}),i._uU(7),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&le&&(i.xp6(2),i.Q6J("src",B.type===B.PrincipalType.Placeholder?B.placeholder_image:B.user_image,i.LSH),i.xp6(1),i.Q6J("textContent",B.text.title()),i.xp6(1),i.Q6J("textContent",B.text.description[B.type]()),i.xp6(3),i.Oqu(B.text.nextButton))},styles:[".op-ium-success[_ngcontent-%COMP%]{flex-grow:1;display:flex;flex-direction:column}"]});class Et{}Et.\u0275fac=function(le){return new(le||Et)},Et.\u0275mod=i.oAB({type:Et}),Et.\u0275inj=i.cJS({providers:[E.j,{provide:i.ip1,useFactory:function(je){return function(){je.get(y).setupListener()}},deps:[i.zs3],multi:!0}],imports:[[c.ez,m.H,h.K,r.A0,e.UX,u.Ky,p.r,a.Y,n.H],a.Y]}),i.B6R(g.E,[c.O5,R,bt,Ze,ne,He,yt],[])},2308:(H,D,t)=>{"use strict";t.d(D,{j:()=>r});var i=t(2316),e=t(65146),c=t(77355),u=t(83635);class r{constructor(h,a){this.opModalService=h,this.currentProjectService=a,this.close=new i.vpe}open(h=this.currentProjectService.id){this.opModalService.show(u.E,"global",{projectId:h}).closingEvent.subscribe(p=>{this.close.emit(p.data)})}}r.\u0275fac=function(h){return new(h||r)(i.LFG(c.S),i.LFG(e.R))},r.\u0275prov=i.Yz7({token:r,factory:r.\u0275fac})},83635:(H,D,t)=>{"use strict";t.d(D,{e:()=>C,E:()=>y});var g,m,C,i=t(60312),e=t(77355),c=t(20979),u=t(2316);function r(m,E){1&m&&u._UZ(0,"div",7)}function n(m,E){if(1&m){const P=u.EpF();u.TgZ(0,"op-ium-project-selection",8),u.NdJ("save",function(x){return u.CHM(P),u.oxw().onProjectSelectionSave(x)})("close",function(){return u.CHM(P),u.oxw().closeMe()}),u.qZA()}if(2&m){const P=u.oxw();u.Q6J("project",P.project)("type",P.type)}}function h(m,E){if(1&m){const P=u.EpF();u.TgZ(0,"op-ium-principal",9),u.NdJ("save",function(x){return u.CHM(P),u.oxw().onPrincipalSave(x)})("back",function(){u.CHM(P);const x=u.oxw();return x.goTo(x.Steps.ProjectSelection)})("close",function(){return u.CHM(P),u.oxw().closeMe()}),u.qZA()}if(2&m){const P=u.oxw();u.Q6J("project",P.project)("principalData",P.principalData)("type",P.type)}}function a(m,E){if(1&m){const P=u.EpF();u.TgZ(0,"op-ium-role",10),u.NdJ("save",function(x){return u.CHM(P),u.oxw().onRoleSave(x)})("back",function(){u.CHM(P);const x=u.oxw();return x.goTo(x.Steps.Principal)})("close",function(){return u.CHM(P),u.oxw().closeMe()}),u.qZA()}if(2&m){const P=u.oxw();u.Q6J("role",P.role)("principal",P.principalData.principal)("project",P.project)("type",P.type)}}function p(m,E){if(1&m){const P=u.EpF();u.TgZ(0,"op-ium-message",11),u.NdJ("save",function(x){return u.CHM(P),u.oxw().onMessageSave(x)})("back",function(){u.CHM(P);const x=u.oxw();return x.goTo(x.Steps.Role)})("close",function(){return u.CHM(P),u.oxw().closeMe()}),u.qZA()}if(2&m){const P=u.oxw();u.Q6J("message",P.message)("principal",P.principalData.principal)("project",P.project)}}function l(m,E){if(1&m){const P=u.EpF();u.TgZ(0,"op-ium-summary",12),u.NdJ("save",function(x){return u.CHM(P),u.oxw().onSuccessfulSubmission(x)})("back",function(){u.CHM(P);const x=u.oxw();return x.goTo("placeholder"===x.type?x.Steps.Role:x.Steps.Message)})("close",function(){return u.CHM(P),u.oxw().closeMe()}),u.qZA()}if(2&m){const P=u.oxw();u.Q6J("project",P.project)("principalData",P.principalData)("type",P.type)("role",P.role)("message",P.message)}}function d(m,E){if(1&m){const P=u.EpF();u.TgZ(0,"op-ium-success",13),u.NdJ("close",function(){return u.CHM(P),u.oxw().closeWithPrincipal()}),u.qZA()}if(2&m){const P=u.oxw();u.Q6J("principal",P.principalData.principal)("project",P.project)("type",P.type)("createdNewPrincipal",P.createdNewPrincipal)}}(m=g||(g={}))[m.ProjectSelection=0]="ProjectSelection",m[m.Principal=1]="Principal",m[m.Role=2]="Role",m[m.Message=3]="Message",m[m.Summary=4]="Summary",m[m.Success=5]="Success",function(m){m.User="User",m.Placeholder="PlaceholderUser",m.Group="Group"}(C||(C={}));class y extends i.T{constructor(E,P,w,x){super(E,P,w),this.locals=E,this.cdRef=P,this.elementRef=w,this.apiV3Service=x,this.Steps=g,this.step=g.ProjectSelection,this.closeOnOutsideClick=!0,this.data=null,this.type=null,this.project=null,this.principalData={principal:null,customFields:{}},this.role=null,this.message="",this.createdNewPrincipal=!1}get loading(){return this.locals.projectId&&!this.project}ngOnInit(){super.ngOnInit(),this.locals.projectId&&this.apiV3Service.projects.id(this.locals.projectId).get().subscribe(E=>{this.project=E,this.cdRef.markForCheck()},()=>{this.locals.projectId=null,this.cdRef.markForCheck()})}onProjectSelectionSave({type:E,project:P}){this.type=E,this.project=P,this.goTo(g.Principal)}onPrincipalSave({principalData:E,isAlreadyMember:P}){if(this.principalData=E,P)return this.closeWithPrincipal();this.goTo(g.Role)}onRoleSave(E){this.role=E,this.type===C.Placeholder?this.goTo(g.Summary):this.goTo(g.Message)}onMessageSave({message:E}){this.message=E,this.goTo(g.Summary)}onSuccessfulSubmission(E){this.principalData.principal!==E.principal&&this.type===C.User&&(this.createdNewPrincipal=!0),this.principalData.principal=E.principal,this.goTo(g.Success)}goTo(E){this.step=E}closeWithPrincipal(){this.data=this.principalData.principal,this.closeMe()}}y.\u0275fac=function(E){return new(E||y)(u.Y36(e.E),u.Y36(u.sBO),u.Y36(u.SBq),u.Y36(c.T))},y.\u0275cmp=u.Xpm({type:y,selectors:[["ng-component"]],features:[u.qOj],decls:7,vars:7,consts:[["class","op-modal",4,"ngIf"],["class","op-modal",3,"project","type","save","close",4,"ngIf"],["class","op-modal",3,"project","principalData","type","save","back","close",4,"ngIf"],["class","op-modal",3,"role","principal","project","type","save","back","close",4,"ngIf"],["class","op-modal",3,"message","principal","project","save","back","close",4,"ngIf"],["class","op-modal",3,"project","principalData","type","role","message","save","back","close",4,"ngIf"],["class","op-modal",3,"principal","project","type","createdNewPrincipal","close",4,"ngIf"],[1,"op-modal"],[1,"op-modal",3,"project","type","save","close"],[1,"op-modal",3,"project","principalData","type","save","back","close"],[1,"op-modal",3,"role","principal","project","type","save","back","close"],[1,"op-modal",3,"message","principal","project","save","back","close"],[1,"op-modal",3,"project","principalData","type","role","message","save","back","close"],[1,"op-modal",3,"principal","project","type","createdNewPrincipal","close"]],template:function(E,P){1&E&&(u.YNc(0,r,1,0,"div",0),u.YNc(1,n,1,2,"op-ium-project-selection",1),u.YNc(2,h,1,3,"op-ium-principal",2),u.YNc(3,a,1,4,"op-ium-role",3),u.YNc(4,p,1,3,"op-ium-message",4),u.YNc(5,l,1,5,"op-ium-summary",5),u.YNc(6,d,1,4,"op-ium-success",6)),2&E&&(u.Q6J("ngIf",P.loading),u.xp6(1),u.Q6J("ngIf",!P.loading&&P.step===P.Steps.ProjectSelection),u.xp6(1),u.Q6J("ngIf",!P.loading&&P.step===P.Steps.Principal),u.xp6(1),u.Q6J("ngIf",!P.loading&&P.step===P.Steps.Role),u.xp6(1),u.Q6J("ngIf",!P.loading&&P.step===P.Steps.Message),u.xp6(1),u.Q6J("ngIf",!P.loading&&P.step===P.Steps.Summary),u.xp6(1),u.Q6J("ngIf",!P.loading&&P.step===P.Steps.Success))},styles:[".op-modal form{display:flex;flex-direction:column;height:100%;flex-grow:1}.op-modal .op-form-field+.op-form-field{margin-top:1rem}\n"],encapsulation:2,changeDetection:0})},18137:(H,D,t)=>{"use strict";t.d(D,{L:()=>k});var i=t(60312),e=t(77355),c=t(96617),u=t(12702),r=t(79902),n=t(18511),h=t(86469),a=t(70233),p=t(36293),l=t(20979),d=t(2316),g=t(53882),C=t(52932),y=t(54364);const m=["downloadLink"];function E(b,v){if(1&b&&(d.TgZ(0,"div",10),d._UZ(1,"span",11),d.qZA()),2&b){const M=d.oxw();d.xp6(1),d.Q6J("ngClass",M.statusIcon)}}function P(b,v){if(1&b&&(d.TgZ(0,"ul"),d._UZ(1,"li",14),d.qZA()),2&b){const M=v.$implicit;d.xp6(1),d.Q6J("textContent",M)}}function w(b,v){if(1&b&&(d.TgZ(0,"p"),d._UZ(1,"span",14),d._UZ(2,"a",14),d.qZA()),2&b){const M=d.oxw(2);d.xp6(1),d.Q6J("textContent",M.text.redirect_errors),d.xp6(1),d.Q6J("textContent",M.text.redirect_link),d.uIk("href",M.payload.redirect,d.LSH)}}function x(b,v){if(1&b&&(d.ynx(0),d._UZ(1,"h3",12),d.YNc(2,P,2,1,"ul",13),d.YNc(3,w,3,3,"p",9),d.BQk()),2&b){const M=d.oxw();d.xp6(1),d.Q6J("textContent",M.text.errors),d.xp6(1),d.Q6J("ngForOf",M.payload.errors),d.xp6(1),d.Q6J("ngIf",null==M.payload?null:M.payload.redirect)}}class k extends i.T{constructor(v,M,S,O,A,F,I,J,N){super(v,M,O),this.locals=v,this.cdRef=M,this.I18n=S,this.elementRef=O,this.pathHelper=A,this.apiV3Service=F,this.loadingIndicator=I,this.toastService=J,this.httpClient=N,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.job_status.title"),closePopup:this.I18n.t("js.close_popup_title"),redirect:this.I18n.t("js.job_status.redirect"),redirect_errors:`${this.I18n.t("js.job_status.redirect_errors")} `,redirect_link:this.I18n.t("js.job_status.redirect_link"),errors:this.I18n.t("js.job_status.errors"),download_starts:this.I18n.t("js.job_status.download_starts"),click_to_download:this.I18n.t("js.job_status.click_to_download")},this.isLoading=!1,this.title=this.text.title,this.downloadHref=null,this.jobId=v.jobId}ngOnInit(){super.ngOnInit(),this.listenOnJobStatus()}listenOnJobStatus(){(0,u.H)(0,2e3).pipe((0,r.w)(()=>this.performRequest()),(0,n.o)(v=>!!v.body&&this.continuedStatus(v.body),!0),this.untilDestroyed(),(0,h.RA)(this.loadingIndicator.getter("modal"))).subscribe(v=>this.onResponse(v),v=>this.handleError(v),()=>this.isLoading=!1)}iconForStatus(){switch(this.status){case"cancelled":case"failure":case"error":return"icon-error";case"success":return"icon-checkmark";default:return null}}continuedStatus(v){return["in_queue","in_process"].includes(v.status)}onResponse(v){var M;const{body:S}=v;if(!S)throw new Error(v);const O=this.status=S.status;this.message=S.message||this.I18n.t(`js.job_status.generic_messages.${O}`,{defaultValue:O}),this.payload=S.payload,S.payload&&(this.title=S.payload.title||this.text.title,this.handleRedirect(S.payload),this.handleDownload(null===(M=S.payload)||void 0===M?void 0:M.download)),this.statusIcon=this.iconForStatus(),this.cdRef.detectChanges()}handleRedirect(v){(null==v?void 0:v.redirect)&&!(null==v?void 0:v.errors)&&(setTimeout(()=>window.location.href=v.redirect,2e3),this.message+=`. ${this.text.redirect}`)}handleDownload(v){void 0!==v&&this.httpClient.get(v,{observe:"response",responseType:"text"}).subscribe(M=>{this.downloadHref=M.url,this.cdRef.detectChanges(),this.downloadLink.nativeElement.click()})}performRequest(){return this.httpClient.get(this.jobUrl,{observe:"response",responseType:"json"})}handleError(v){if(404===(null==v?void 0:v.status))return this.statusIcon="icon-help",void(this.message=this.I18n.t("js.job_status.generic_messages.not_found"));this.statusIcon="icon-error",this.message=(null==v?void 0:v.message)||this.I18n.t("js.error.internal"),this.toastService.addError(this.message)}get jobUrl(){return this.apiV3Service.job_statuses.id(this.jobId).toString()}}k.\u0275fac=function(v){return new(v||k)(d.Y36(e.E),d.Y36(d.sBO),d.Y36(c.D),d.Y36(d.SBq),d.Y36(a.j),d.Y36(l.T),d.Y36(h.vt),d.Y36(p.kl),d.Y36(g.eN))},k.\u0275cmp=d.Xpm({type:k,selectors:[["ng-component"]],viewQuery:function(v,M){if(1&v&&d.Gf(m,5),2&v){let S;d.iGM(S=d.CRH())&&(M.downloadLink=S.first)}},features:[d.qOj],decls:13,vars:8,consts:[[1,"op-modal","op-modal_wide-fixed","job-status--modal"],[3,"close"],[1,"op-modal--body"],["data-indicator-name","modal",1,"loading-indicator--location"],["class","status-icon-wrapper",4,"ngIf"],[1,"job-status--modal-main-message",3,"textContent"],[3,"hidden"],["download","","target","_blank",3,"textContent"],["downloadLink",""],[4,"ngIf"],[1,"status-icon-wrapper"],[1,"icon-big",3,"ngClass"],[1,"job-status--modal-additional-errors",3,"textContent"],[4,"ngFor","ngForOf"],[3,"textContent"]],template:function(v,M){1&v&&(d.TgZ(0,"div",0),d.TgZ(1,"op-modal-header",1),d.NdJ("close",function(O){return M.closeMe(O)}),d._uU(2),d.qZA(),d.TgZ(3,"div",2),d.TgZ(4,"div",3),d.YNc(5,E,2,1,"div",4),d.qZA(),d.TgZ(6,"div"),d._UZ(7,"span",5),d.TgZ(8,"span",6),d._uU(9),d._UZ(10,"a",7,8),d.qZA(),d.YNc(12,x,4,3,"ng-container",9),d.qZA(),d.qZA(),d.qZA()),2&v&&(d.xp6(2),d.Oqu(M.title),d.xp6(3),d.Q6J("ngIf",!M.isLoading&&M.statusIcon),d.xp6(2),d.Q6J("textContent",M.message),d.xp6(1),d.Q6J("hidden",!M.downloadHref),d.xp6(1),d.hij(" ",M.text.download_starts," "),d.xp6(1),d.Q6J("textContent",M.text.click_to_download),d.uIk("href",M.downloadHref,d.LSH),d.xp6(2),d.Q6J("ngIf",null==M.payload?null:M.payload.errors))},directives:[C.g,y.O5,y.mk,y.sg],styles:[".job-status--modal[_ngcontent-%COMP%]{min-height:350px;min-width:450px;overflow-y:scroll}@media screen and (max-width: 679px){.job-status--modal[_ngcontent-%COMP%]{min-width:200px}}.loading-indicator--location[_ngcontent-%COMP%]{height:220px}.status-icon-wrapper[_ngcontent-%COMP%]{display:flex;height:100%;align-items:center;justify-content:center}.job-status--modal-main-message[_ngcontent-%COMP%]{font-weight:bold;display:flex;justify-content:center}.job-status--modal-additional-errors[_ngcontent-%COMP%]{margin-top:2rem}"]})},53448:(H,D,t)=>{"use strict";t.d(D,{$:()=>e});var i=t(2316);class e{constructor(){this.hooks={}}register(u,r){!r||(this.hooks[u]||(this.hooks[u]=[]),this.hooks[u].push(r))}call(u,...r){const n=[];if(this.hooks[u])for(let h=0;h<this.hooks[u].length;h++){const a=this.hooks[u][h](...r);a&&n.push(a)}return n}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})},71718:(H,D,t)=>{"use strict";t.r(D),t.d(D,{OpenprojectProjectsModule:()=>I});var i=t(6496),e=t(84906),c=t(65084),u=t(47775),r=t(26942),n=t(65146),h=t(70233),a=t(2316),p=t(57958);class l extends r.N{constructor(N,te,ee){super(),this._pathHelperService=N,this._$state=te,this._currentProjectService=ee,this.formMethod="patch",this.hiddenFields=["identifier","active"]}ngOnInit(){this.projectsPath=this._currentProjectService.apiv3Path,this.dynamicFieldsSettingsPipe=N=>N.reduce((te,ee)=>(this.isFieldHidden(ee.key)&&(ee=Object.assign(Object.assign({},ee),{hide:!0})),[...te,ee]),[])}isFieldHidden(N){return this.hiddenFields.includes(N||"")}}l.\u0275fac=function(N){return new(N||l)(a.Y36(h.j),a.Y36(u.StateService),a.Y36(n.R))},l.\u0275cmp=a.Xpm({type:l,selectors:[["app-projects"]],features:[a.qOj],decls:1,vars:3,consts:[["helpTextAttributeScope","Project",3,"resourcePath","formHttpMethod","fieldsSettingsPipe"]],template:function(N,te){1&N&&a._UZ(0,"op-dynamic-form",0),2&N&&a.Q6J("resourcePath",te.projectsPath)("formHttpMethod",te.formMethod)("fieldsSettingsPipe",te.dynamicFieldsSettingsPipe)},directives:[p.r],styles:[""]});var d=t(96617),g=t(1707),C=t(20979),y=t(33927),m=t(18137),E=t(77355),P=t(26269),w=t(54364),x=t(18252),k=t(36868);const b=function(J){return{"op-highlighted-input":!0,"op-highlighted-input_active":J}};class v extends r.N{constructor(N,te,ee,G,se,me){super(),this.apiV3Service=N,this.uIRouterGlobals=te,this.pathHelperService=ee,this.modalService=G,this.$state=se,this.I18n=me,this.dynamicFieldsSettingsPipe=this.fieldSettingsPipe.bind(this),this.initialPayload={},this.text={use_template:this.I18n.t("js.project.use_template"),no_template_selected:this.I18n.t("js.project.no_template_selected"),advancedSettingsLabel:this.I18n.t("js.forms.advanced_settings"),copySettingsLabel:this.I18n.t("js.project.copy.copy_options")},this.hiddenFields=["identifier","active"],this.copyableTemplateFilter=(new P.qM).add("user_action","=",["projects/copy"]).add("templated","=",!0),this.templateOptions$=this.apiV3Service.projects.filtered(this.copyableTemplateFilter,{pageSize:"-1"}).get().pipe((0,y.U)(_e=>_e.elements.map(he=>({href:he.href,name:he.name})))),this.templateForm=new g.cw({template:new g.NI})}get templateControl(){return this.templateForm.get("template")}ngOnInit(){this.resourcePath=this.apiV3Service.projects.path,this.fieldGroups=[{name:this.text.advancedSettingsLabel,fieldsFilter:N=>{var te,ee,G;return!(["name","parent"].includes(null===(te=N.templateOptions)||void 0===te?void 0:te.property)||this.isMeta(null===(ee=N.templateOptions)||void 0===ee?void 0:ee.property)||(null===(G=N.templateOptions)||void 0===G?void 0:G.required)&&!N.templateOptions.hasDefault&&null==N.templateOptions.payloadValue)}},{name:this.text.copySettingsLabel,fieldsFilter:N=>{var te;return this.isMeta(null===(te=N.templateOptions)||void 0===te?void 0:te.property)}}],this.uIRouterGlobals.params.parent_id&&this.setParentAsPayload(this.uIRouterGlobals.params.parent_id)}onSubmitted(N){"JobStatus"===N._type?this.modalService.show(m.L,"global",{jobId:N.jobId}):window.location.href=this.pathHelperService.projectPath(N.identifier)}onTemplateSelected(N){var te;this.initialPayload=Object.assign(Object.assign({},this.initialPayload),{name:this.dynamicForm.model.name,_meta:Object.assign(Object.assign({},null===(te=this.initialPayload)||void 0===te?void 0:te._meta),{sendNotifications:!1})}),this.formUrl=(null==N?void 0:N.href)?`${N.href}/copy`:null}isHiddenField(N){return"_meta.sendNotifications"!==N&&(!!N&&(this.hiddenFields.includes(N)||this.isMeta(N)))}isMeta(N){return!!N&&(N.startsWith("copy")||"sendNotifications"===N)}setParentAsPayload(N){const te=this.apiV3Service.projects.id(N).path;this.initialPayload={_links:{parent:{href:te}}}}fieldSettingsPipe(N){return N.map(te=>Object.assign(Object.assign({},te),{hide:this.isHiddenField(te.key)}))}}v.\u0275fac=function(N){return new(N||v)(a.Y36(C.T),a.Y36(u.UIRouterGlobals),a.Y36(h.j),a.Y36(E.S),a.Y36(u.StateService),a.Y36(d.D))},v.\u0275cmp=a.Xpm({type:v,selectors:[["op-new-project"]],viewQuery:function(N,te){if(1&N&&a.Gf(p.r,5),2&N){let ee;a.iGM(ee=a.CRH())&&(te.dynamicForm=ee.first)}},features:[a.qOj],decls:6,vars:15,consts:[[1,"op-form",3,"formGroup"],[3,"ngClass"],["data-qa-field-name","use_template",3,"label"],["bindLabel","name","slot","input",3,"formControl","items","placeholder","ngModelChange"],["helpTextAttributeScope","Project",3,"formUrl","resourcePath","initialPayload","fieldsSettingsPipe","fieldGroups","submitted"]],template:function(N,te){1&N&&(a.TgZ(0,"form",0),a.TgZ(1,"div",1),a.TgZ(2,"op-form-field",2),a.TgZ(3,"ng-select",3),a.NdJ("ngModelChange",function(G){return te.onTemplateSelected(G)}),a.ALo(4,"async"),a.qZA(),a.qZA(),a.qZA(),a.qZA(),a.TgZ(5,"op-dynamic-form",4),a.NdJ("submitted",function(G){return te.onSubmitted(G)}),a.qZA()),2&N&&(a.Q6J("formGroup",te.templateForm),a.xp6(1),a.Q6J("ngClass",a.VKq(13,b,!(null==te.templateControl||!te.templateControl.value))),a.xp6(1),a.Q6J("label",te.text.use_template),a.xp6(1),a.Q6J("formControl",te.templateControl)("items",a.lcZ(4,11,te.templateOptions$))("placeholder",te.text.no_template_selected),a.xp6(2),a.Q6J("formUrl",te.formUrl)("resourcePath",te.resourcePath)("initialPayload",te.initialPayload)("fieldsSettingsPipe",te.dynamicFieldsSettingsPipe)("fieldGroups",te.fieldGroups))},directives:[g._Y,g.JL,g.sg,w.mk,x.V,k.w9,g.JJ,g.oH,p.r],pipes:[w.Ov],styles:[".op-form[_ngcontent-%COMP%]{margin-bottom:1rem}"]});class M extends r.N{constructor(N,te,ee,G,se,me){super(),this.apiV3Service=N,this.currentProjectService=te,this.pathHelperService=ee,this.modalService=G,this.$state=se,this.I18n=me,this.dynamicFieldsSettingsPipe=this.fieldSettingsPipe.bind(this),this.hiddenFields=["identifier","active"],this.text={advancedSettingsLabel:this.I18n.t("js.forms.advanced_settings"),copySettingsLabel:this.I18n.t("js.project.copy.copy_options")}}ngOnInit(){this.formUrl=this.apiV3Service.projects.id(this.currentProjectService.id).copy.form.path,this.fieldGroups=[{name:this.text.advancedSettingsLabel,fieldsFilter:N=>{var te;return!this.isMeta(null===(te=N.templateOptions)||void 0===te?void 0:te.property)&&!this.isPrimaryAttribute(N.templateOptions)}},{name:this.text.copySettingsLabel,fieldsFilter:N=>{var te;return this.isMeta(null===(te=N.templateOptions)||void 0===te?void 0:te.property)}}]}onSubmitted(N){this.modalService.show(m.L,"global",{jobId:N.jobId})}isHiddenField(N){return!!N&&this.hiddenFields.includes(N)}fieldSettingsPipe(N){return N.map(te=>Object.assign(Object.assign({},te),{hide:this.isHiddenField(te.key)}))}isPrimaryAttribute(N){return!!N&&(N.required&&!N.hasDefault&&null==N.payloadValue||"name"===N.property||"parent"===N.property)}isMeta(N){return!!N&&(N.startsWith("copy")||"sendNotifications"===N)}}M.\u0275fac=function(N){return new(N||M)(a.Y36(C.T),a.Y36(n.R),a.Y36(h.j),a.Y36(E.S),a.Y36(u.StateService),a.Y36(d.D))},M.\u0275cmp=a.Xpm({type:M,selectors:[["op-copy-project"]],features:[a.qOj],decls:1,vars:3,consts:[["helpTextAttributeScope","Project",3,"formUrl","fieldsSettingsPipe","fieldGroups","submitted"]],template:function(N,te){1&N&&(a.TgZ(0,"op-dynamic-form",0),a.NdJ("submitted",function(G){return te.onSubmitted(G)}),a.qZA()),2&N&&a.Q6J("formUrl",te.formUrl)("fieldsSettingsPipe",te.dynamicFieldsSettingsPipe)("fieldGroups",te.fieldGroups)},directives:[p.r],encapsulation:2});const S=[{name:"project_settings",parent:"optional_project",url:"/settings/general/",component:l},{name:"project_copy",parent:"optional_project",url:"/copy",component:M},{name:"new_project",url:"/projects/new?parent_id",component:v}];var A=t(31256),F=t(21757);class I{}I.\u0275fac=function(N){return new(N||I)},I.\u0275mod=a.oAB({type:I}),I.\u0275inj=a.cJS({imports:[[F.H,g.UX,i.f,c.E,e.UIRouterModule.forChild({states:S,config:function(J){J.urlService.rules.when(new RegExp("^/projects/(.*)/settings/general$"),N=>`/projects/${N[1]}/settings/general/`)}}),A.r]]})},81628:(H,D,t)=>{"use strict";t.d(D,{W:()=>n});var i=t(57014),e=t(96617),c=t(2316),u=t(54364),r=t(2775);class n{constructor(a,p){this.backRoutingService=a,this.I18n=p,this.text={goBack:this.I18n.t("js.button_back")}}goBack(){this.customBackMethod?this.customBackMethod():this.backRoutingService.goBack()}}n.\u0275fac=function(a){return new(a||n)(c.Y36(i.Y),c.Y36(e.D))},n.\u0275cmp=c.Xpm({type:n,selectors:[["op-back-button"]],inputs:{linkClass:"linkClass",customBackMethod:"customBackMethod"},decls:2,vars:2,consts:[["data-qa-selector","op-back-button",1,"op-back-button","button","hide-when-print",3,"ngClass","title","click"],["icon-classes","op-back-button--icon button--icon icon-back-up"]],template:function(a,p){1&a&&(c.TgZ(0,"button",0),c.NdJ("click",function(){return p.goBack()}),c._UZ(1,"op-icon",1),c.qZA()),2&a&&c.Q6J("ngClass",p.linkClass)("title",p.text.goBack)},directives:[u.mk,r.o],styles:[".op-back-button[_ngcontent-%COMP%]{padding:0;line-height:32px;margin:0 1rem 0 0;width:75px;height:34px}.op-back-button--icon[_ngcontent-%COMP%]{font-size:1rem;line-height:22px}@media only screen and (max-width: 679px){.op-back-button_mobile-full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:20px}}"],changeDetection:0})},57014:(H,D,t)=>{"use strict";t.d(D,{Y:()=>n});var i=t(3786),e=t(47775),c=t(84109),u=t(29161),r=t(2316);class n{constructor(a){this.injector=a}goToOtherState(a,p){return this.$state.go(a,p)}goBackToDetailsState(a,p){if(a)this.goToOtherState(p,this.backRoute.params);else{const l=`${p}.details.tabs`,d=Object.assign(Object.assign({},this.backRoute.params),{tabIdentifier:this.keepTab.currentDetailsTab});this.goToOtherState(l,d)}}goBackNotToDetailsState(){this.backRoute.parent?this.goToOtherState(this.backRoute.name,this.backRoute.params).then(()=>{this.$state.reload()}):this.goToOtherState(this.backRoute.name,this.backRoute.params)}goBackToPreviousState(a,p){this.keepTab.isDetailsState(this.backRoute.parent)?this.goBackToDetailsState(a,p):this.goBackNotToDetailsState()}goBack(a=!1){var p;const l=(null===(p=this.backRoute)||void 0===p?void 0:p.baseRoute)||this.$state.current.data.baseRoute||"work-packages.partitioned.list";!this.backRoute&&l.includes("show")?this.$state.reload():!this.backRoute||this.backRoute.name.includes("new")?this.$state.go(l,this.$state.params):this.goBackToPreviousState(a,l)}goToBaseState(){const a=this.$state.current.data.baseRoute||"work-packages.partitioned.list";this.$state.go(a,this.$state.params)}sync(a){const p=a.from(),l=a.to();if(p.name&&p.data&&l.data&&p.data.parent!==l.data.parent){const d=Object.assign({},a.params("from"));this.backRoute={name:p.name,params:d,parent:p.data.parent,baseRoute:p.data.baseRoute}}}set backRoute(a){this._backRoute=a}get backRoute(){return this._backRoute}}n.\u0275fac=function(a){return new(a||n)(r.LFG(r.zs3))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",e.StateService)],n.prototype,"$state",void 0),(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",c.p)],n.prototype,"keepTab",void 0)},66979:(H,D,t)=>{"use strict";t.d(D,{Y:()=>r});var i=t(2316),e=t(96617),c=t(61342),u=t(2775);class r{constructor(h,a,p){this.I18n=h,this.editForm=a,this.cdRef=p,this.onSave=new i.vpe,this.onCancel=new i.vpe,this._saving=!1,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel")}}set saving(h){this._saving=h,this.cdRef.detectChanges()}get saving(){return this._saving}save(){this.saving||(this.saving=!0,this.editForm.submit().then(()=>{this.saving=!1,this.onSave.emit()}).catch(()=>{this.saving=!1}))}cancel(){this.editForm.cancel(),this.onCancel.emit()}}r.\u0275fac=function(h){return new(h||r)(i.Y36(e.D),i.Y36(c.n),i.Y36(i.sBO))},r.\u0275cmp=i.Xpm({type:r,selectors:[["wp-edit-actions-bar"]],outputs:{onSave:"onSave",onCancel:"onCancel"},decls:7,vars:3,consts:[[1,"work-packages--edit-actions"],["id","work-packages--edit-actions-save","accesskey","3",1,"button","-highlight",3,"disabled","click"],["icon-classes","button--icon icon-checkmark"],[1,"button--text",3,"textContent"],["id","work-packages--edit-actions-cancel","accesskey","7",1,"button",3,"click"],["icon-classes","button--icon icon-close"]],template:function(h,a){1&h&&(i.TgZ(0,"div",0),i.TgZ(1,"button",1),i.NdJ("click",function(){return a.save()}),i._UZ(2,"op-icon",2),i._UZ(3,"span",3),i.qZA(),i.TgZ(4,"button",4),i.NdJ("click",function(){return a.cancel()}),i._UZ(5,"op-icon",5),i._UZ(6,"span",3),i.qZA(),i.qZA()),2&h&&(i.xp6(1),i.Q6J("disabled",a.saving),i.xp6(2),i.Q6J("textContent",a.text.save),i.xp6(3),i.Q6J("textContent",a.text.cancel))},directives:[u.o],encapsulation:2,changeDetection:0})},77434:(H,D,t)=>{"use strict";t.d(D,{J:()=>C});var i=t(74647),e=t(93175),c=t(26942),u=t(38519),r=t(78434),n=t(2316),h=t(54364),a=t(51522);function p(y,m){if(1&y){const E=n.EpF();n.TgZ(0,"button",3),n.NdJ("click",function(){return n.CHM(E),n.oxw().wpFiltersService.toggleVisibility()}),n.ALo(1,"async"),n._UZ(2,"i",4),n._UZ(3,"span",5),n.qZA()}if(2&y){const E=n.oxw();n.ekj("-active",n.lcZ(1,3,E.visible$)),n.xp6(3),n.Q6J("textContent",E.filterButtonText)}}function l(y,m){if(1&y){const E=n.EpF();n.TgZ(0,"query-filters",8),n.NdJ("filtersChanged",function(w){return n.CHM(E),n.oxw(2).replaceIfComplete(w)}),n.qZA()}if(2&y){const E=n.oxw(2);n.Q6J("filters",E.filters)("showCloseFilter",!0)}}function d(y,m){if(1&y&&(n.TgZ(0,"div",6),n.YNc(1,l,1,2,"query-filters",7),n.qZA()),2&y){const E=n.oxw();n.xp6(1),n.Q6J("ngIf",!!E.filters)}}const g=function(y){return{"-loaded":y}};class C extends c.N{constructor(m,E,P){super(),this.wpTableFilters=m,this.cdRef=E,this.wpFiltersService=P,this.showFilterButton=!1,this.filterButtonText=I18n.t("js.button_filter"),this.filtersChanged=new e.R((0,u.J6)(this)),this.filters=this.wpTableFilters.current,this.loaded=!1,this.visible$=this.wpFiltersService.observeUntil((0,u.J6)(this))}ngOnInit(){this.wpTableFilters.pristine$().pipe(this.untilDestroyed()).subscribe(()=>{this.filters=this.wpTableFilters.current,this.loaded=!0,this.cdRef.detectChanges()})}replaceIfComplete(m){const E=m.filter(P=>this.wpTableFilters.isAvailable(P));this.wpTableFilters.replaceIfComplete(E),this.filtersChanged.emit(E)}}C.\u0275fac=function(m){return new(m||C)(n.Y36(i.Z),n.Y36(n.sBO),n.Y36(r.U))},C.\u0275cmp=n.Xpm({type:C,selectors:[["op-filter-container"]],inputs:{showFilterButton:"showFilterButton",filterButtonText:"filterButtonText"},outputs:{filtersChanged:"filtersChanged"},features:[n.qOj],decls:4,vars:7,consts:[["class","button -small advanced-filters--toggle",3,"-active","click",4,"ngIf"],[1,"work-packages--filters-optional-container",3,"ngClass"],["id","query_form_content","class","hide-when-print",4,"ngIf"],[1,"button","-small","advanced-filters--toggle",3,"click"],[1,"button--icon","icon-filter"],[1,"button--text",3,"textContent"],["id","query_form_content",1,"hide-when-print"],[3,"filters","showCloseFilter","filtersChanged",4,"ngIf"],[3,"filters","showCloseFilter","filtersChanged"]],template:function(m,E){1&m&&(n.YNc(0,p,4,5,"button",0),n.TgZ(1,"div",1),n.YNc(2,d,2,1,"div",2),n.ALo(3,"async"),n.qZA()),2&m&&(n.Q6J("ngIf",E.showFilterButton),n.xp6(1),n.Q6J("ngClass",n.VKq(5,g,E.loaded)),n.xp6(1),n.Q6J("ngIf",n.lcZ(3,3,E.visible$)))},directives:[h.O5,h.mk,a.H],pipes:[h.Ov],encapsulation:2,changeDetection:0})},51522:(H,D,t)=>{"use strict";t.d(D,{H:()=>Jt});var i=t(96617),e=t(93175),c=t(43682),u=t(24e3),r=t(36868),n=t(74647),h=t(78434),a=t(26942),p=t(38519),l=t(2316),d=t(54364),g=t(79441),C=t(33927),y=t(83720),m=t(98636),E=t(80639),P=t(43440),w=t(14808),x=t(1707);class k extends a.N{constructor(ve,ne,K){super(),this.I18n=ve,this.querySpace=ne,this.wpTableFilters=K,this.deactivateFilter=new l.vpe,this.text={createWithDropdown:this.I18n.t("js.work_packages.create.button"),createButton:this.I18n.t("js.label_work_package"),explanation:this.I18n.t("js.label_create_work_package"),placeholder:this.I18n.t("js.work_packages.placeholder_filter_by_text")},this.searchTerm=(0,w.qH)(""),this.searchTermChanged=new g.xQ,this.wpTableFilters.pristine$().pipe(this.untilDestroyed(),(0,C.U)(()=>{const de=this.wpTableFilters.find("search");return de?de.values[0]:""})).subscribe(de=>{console.log(`upstream ${de} ${this.searchTerm.timestampOfLastValue}`),(!this.searchTerm.value||this.searchTerm.isValueOlderThan(500))&&(console.log(`Upstream value setting to ${de}`),this.searchTerm.putValue(de))}),this.searchTermChanged.pipe(this.untilDestroyed(),(0,y.x)(),(0,m.b)(de=>this.searchTerm.putValue(de)),(0,E.b)(500)).subscribe(de=>{if(de.length>0)this.wpTableFilters.replace("search",He=>{He.operator=He.findOperator("**"),He.values=[de]});else{const He=this.wpTableFilters.find("search");this.wpTableFilters.remove(He),this.deactivateFilter.emit(He)}})}}k.\u0275fac=function(ve){return new(ve||k)(l.Y36(i.D),l.Y36(P.q),l.Y36(n.Z))},k.\u0275cmp=l.Xpm({type:k,selectors:[["wp-filter-by-text-input"]],outputs:{deactivateFilter:"deactivateFilter"},features:[l.qOj],decls:2,vars:4,consts:[["id","filter-by-text-input","type","text",3,"placeholder","ngModel","ngModelChange"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"input",0),l.NdJ("ngModelChange",function(de){return ne.searchTermChanged.next(de)}),l.ALo(1,"async"),l.qZA()),2&ve&&(l.s9C("placeholder",ne.text.placeholder),l.Q6J("ngModel",l.lcZ(1,2,ne.searchTerm.values$())))},directives:[x.Fj,x.JJ,x.On],pipes:[d.Ov],encapsulation:2});var b=t(2775),v=t(44022),M=t(65146),O=(t(63085),t(47124));class A{constructor(ve){this.I18n=ve,this.shouldFocus=!1,this.filterChanged=new l.vpe}get value(){return this.filter.values[0]}onFilterUpdated(ve){this.filter.values[0]=ve,this.filterChanged.emit(this.filter)}}A.\u0275fac=function(ve){return new(ve||A)(l.Y36(i.D))},A.\u0275cmp=l.Xpm({type:A,selectors:[["op-filter-boolean-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},decls:1,vars:4,consts:[[3,"active","containerId","inputId","inputName","valueChanged"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"slide-toggle",0),l.NdJ("valueChanged",function(de){return ne.onFilterUpdated(de)}),l.qZA()),2&ve&&(l.MGl("containerId","div-values-",ne.filter.id,""),l.MGl("inputId","values-",ne.filter.name,""),l.MGl("inputName","v[",ne.filter.name,"]"),l.Q6J("active",ne.value))},directives:[O.w],encapsulation:2});var F=t(84312);class I extends a.N{constructor(ve,ne){super(),this.I18n=ve,this.schemaCache=ne,this.shouldFocus=!1,this.filterChanged=new e.R((0,p.J6)(this))}get value(){return parseInt(this.filter.values[0])}set value(ve){this.filter.values="number"==typeof ve?[ve.toString()]:[],this.filterChanged.emit(this.filter)}get unit(){switch(this.schema.filter.allowedValues[0].id){case"startDate":case"dueDate":case"updatedAt":case"createdAt":return this.I18n.t("js.work_packages.time_relative.days");default:return""}}get schema(){return this.schemaCache.of(this.filter)}}I.\u0275fac=function(ve){return new(ve||I)(l.Y36(i.D),l.Y36(v.y))},I.\u0275cmp=l.Xpm({type:I,selectors:[["op-filter-integer-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.qOj],decls:3,vars:7,consts:[[1,"inline-label",3,"id"],["required","","type","number",1,"advanced-filters--number-field",3,"ngModel","opAutofocus","id","name","ngModelChange"],[1,"advanced-filters--affix",3,"for","textContent"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"div",0),l.TgZ(1,"input",1),l.NdJ("ngModelChange",function(de){return ne.value=de}),l.qZA(),l._UZ(2,"label",2),l.qZA()),2&ve&&(l.MGl("id","div-values-",ne.filter.id,""),l.xp6(1),l.MGl("id","values-",ne.filter.id,""),l.MGl("name","v[",ne.filter.id,"]"),l.Q6J("ngModel",ne.value)("opAutofocus",ne.shouldFocus),l.xp6(1),l.MGl("for","values-",ne.filter.id,""),l.Q6J("textContent",ne.unit))},directives:[x.wV,x.Fj,x.Q7,x.JJ,x.On,F.U],encapsulation:2});var J=t(70692),N=t(90547);class te extends a.N{constructor(ve,ne){super(),this.timezoneService=ve,this.I18n=ne,this.shouldFocus=!1,this.filterChanged=new e.R((0,p.J6)(this))}get value(){return this.filter.values[0]}set value(ve){this.filter.values=[ve],this.filterChanged.emit(this.filter)}parser(ve){return moment(ve,"YYYY-MM-DD",!0).isValid()?ve:null}formatter(ve){if(moment(ve,"YYYY-MM-DD",!0).isValid()){const ne=this.timezoneService.parseDate(ve);return this.timezoneService.formattedISODate(ne)}return null}}te.\u0275fac=function(ve){return new(ve||te)(l.Y36(J.B),l.Y36(i.D))},te.\u0275cmp=l.Xpm({type:te,selectors:[["op-filter-date-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.qOj],decls:2,vars:5,consts:[[3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","opAutofocus","id","name","changed"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"div",0),l.TgZ(1,"op-single-date-picker",1),l.NdJ("changed",function(de){return ne.value=ne.parser(de)}),l.qZA(),l.qZA()),2&ve&&(l.MGl("id","div-values-",ne.filter.id,""),l.xp6(1),l.Q6J("initialDate",ne.formatter(ne.value))("opAutofocus",ne.shouldFocus)("id","values-"+ne.filter.id)("name","v["+ne.filter.id+"]"))},directives:[N.S,F.U],encapsulation:2});var ee=t(2281);class G extends a.N{constructor(ve,ne){super(),this.timezoneService=ve,this.I18n=ne,this.shouldFocus=!1,this.filterChanged=new e.R((0,p.J6)(this)),this.text={spacer:this.I18n.t("js.filter.value_spacer")}}get begin(){return this.filter.values[0]}set begin(ve){this.filter.values[0]=ve||"",this.filterChanged.emit(this.filter)}get end(){return this.filter.values[1]}set end(ve){this.filter.values[1]=ve||"",this.filterChanged.emit(this.filter)}parser(ve){return ee(ve,"YYYY-MM-DD",!0).isValid()?ve:null}formatter(ve){if(ee(ve,"YYYY-MM-DD",!0).isValid()){const ne=this.timezoneService.parseDate(ve);return this.timezoneService.formattedISODate(ne)}return null}}G.\u0275fac=function(ve){return new(ve||G)(l.Y36(J.B),l.Y36(i.D))},G.\u0275cmp=l.Xpm({type:G,selectors:[["op-filter-dates-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.qOj],decls:4,vars:9,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","opAutofocus","id","name","changed"],[1,"advanced-filters--affix",3,"textContent"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","id","name","changed"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"div",0),l.TgZ(1,"op-single-date-picker",1),l.NdJ("changed",function(de){return ne.begin=ne.parser(de)}),l.qZA(),l._UZ(2,"span",2),l.TgZ(3,"op-single-date-picker",3),l.NdJ("changed",function(de){return ne.end=ne.parser(de)}),l.qZA(),l.qZA()),2&ve&&(l.MGl("id","div-values-",ne.filter.id,""),l.xp6(1),l.Q6J("initialDate",ne.formatter(ne.begin))("opAutofocus",ne.shouldFocus)("id","values-"+ne.filter.id+"-begin")("name","v["+ne.filter.id+"]-begin"),l.xp6(1),l.Q6J("textContent",ne.text.spacer),l.xp6(1),l.Q6J("initialDate",ne.formatter(ne.end))("id","values-"+ne.filter.id+"-end")("name","v["+ne.filter.id+"]-end"))},directives:[N.S,F.U],encapsulation:2});class se extends a.N{constructor(ve,ne){super(),this.I18n=ve,this.timezoneService=ne}ngOnInit(){_.remove(this.filter.values,ve=>!this.timezoneService.isValidISODateTime(ve))}isoDateParser(ve){if(!this.timezoneService.isValidISODate(ve))return"";const ne=this.timezoneService.parseISODatetime(ve);return this.timezoneService.formattedISODateTime(ne)}isoDateFormatter(ve){if(!this.timezoneService.isValidISODateTime(ve))return"";const ne=this.timezoneService.parseISODatetime(ve);return this.timezoneService.formattedISODate(ne)}get isTimeZoneDifferent(){const ve=this.lowerBoundary||this.upperBoundary;return!!ve&&(0!==ve.hours()||0!==ve.minutes())}get timeZoneText(){return this.lowerBoundary&&this.upperBoundary?this.I18n.t("js.filter.time_zone_converted.two_values",{from:this.lowerBoundary.format("YYYY-MM-DD HH:mm"),to:this.upperBoundary.format("YYYY-MM-DD HH:mm")}):this.upperBoundary?this.I18n.t("js.filter.time_zone_converted.only_end",{to:this.upperBoundary.format("YYYY-MM-DD HH:mm")}):this.lowerBoundary?this.I18n.t("js.filter.time_zone_converted.only_start",{from:this.lowerBoundary.format("YYYY-MM-DD HH:mm")}):""}}function me(Ze,ve){if(1&Ze&&(l.TgZ(0,"span",3),l._UZ(1,"op-icon",4),l.qZA()),2&Ze){const ne=l.oxw();l.uIk("data-tooltip",ne.timeZoneText)}}se.\u0275fac=function(ve){return new(ve||se)(l.Y36(i.D),l.Y36(J.B))},se.\u0275dir=l.lG2({type:se,features:[l.qOj]});class _e extends se{constructor(ve,ne){super(ve,ne),this.I18n=ve,this.timezoneService=ne,this.shouldFocus=!1,this.filterChanged=new e.R((0,p.J6)(this))}get value(){return this.filter.values[0]}get valueString(){return this.filter.values[0].toString()}set value(ve){this.filter.values=[ve],this.filterChanged.emit(this.filter)}get lowerBoundary(){return this.value&&this.timezoneService.isValidISODateTime(this.valueString)?this.timezoneService.parseDatetime(this.valueString):null}get upperBoundary(){return this.value&&this.timezoneService.isValidISODateTime(this.valueString)?this.timezoneService.parseDatetime(this.valueString).add(24,"hours"):null}}function he(Ze,ve){if(1&Ze&&(l.TgZ(0,"span",5),l._UZ(1,"op-icon",6),l.qZA()),2&Ze){const ne=l.oxw();l.uIk("data-tooltip",ne.timeZoneText)}}_e.\u0275fac=function(ve){return new(ve||_e)(l.Y36(i.D),l.Y36(J.B))},_e.\u0275cmp=l.Xpm({type:_e,selectors:[["op-filter-date-time-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.qOj],decls:3,vars:6,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","opAutofocus","id","name","changed"],["class","advanced-filters--tooltip-trigger -multiline",4,"ngIf"],[1,"advanced-filters--tooltip-trigger","-multiline"],["icon-classes","icon icon-warning"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"div",0),l.TgZ(1,"op-single-date-picker",1),l.NdJ("changed",function(de){return ne.value=ne.isoDateParser(de)}),l.qZA(),l.YNc(2,me,2,1,"span",2),l.qZA()),2&ve&&(l.MGl("id","div-values-",ne.filter.id,""),l.xp6(1),l.Q6J("initialDate",ne.isoDateFormatter(ne.value))("opAutofocus",ne.shouldFocus)("id","values-"+ne.filter.id)("name","v["+ne.filter.id+"]"),l.xp6(1),l.Q6J("ngIf",ne.isTimeZoneDifferent))},directives:[N.S,F.U,d.O5,b.o],encapsulation:2});class ae extends se{constructor(ve,ne){super(ve,ne),this.I18n=ve,this.timezoneService=ne,this.shouldFocus=!1,this.filterChanged=new e.R((0,p.J6)(this)),this.text={spacer:this.I18n.t("js.filter.value_spacer")}}get begin(){return this.filter.values[0]}set begin(ve){this.filter.values[0]=ve||"",this.filterChanged.emit(this.filter)}get end(){return this.filter.values[1]}set end(ve){this.filter.values[1]=ve||"",this.filterChanged.emit(this.filter)}get lowerBoundary(){return this.begin&&this.timezoneService.isValidISODateTime(this.begin.toString())?this.timezoneService.parseDatetime(this.begin.toString()):null}get upperBoundary(){return this.end&&this.timezoneService.isValidISODateTime(this.end.toString())?this.timezoneService.parseDatetime(this.end.toString()):null}}ae.\u0275fac=function(ve){return new(ve||ae)(l.Y36(i.D),l.Y36(J.B))},ae.\u0275cmp=l.Xpm({type:ae,selectors:[["op-filter-date-times-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.qOj],decls:5,vars:10,consts:[[1,"inline-label",3,"id"],["required","true","classes","advanced-filters--date-field","size","10",3,"initialDate","opAutofocus","id","name","changed"],[1,"advanced-filters--affix",3,"textContent"],["classes","advanced-filters--date-field","size","10",3,"initialDate","id","name","changed"],["class","advanced-filters--tooltip-trigger -multiline",4,"ngIf"],[1,"advanced-filters--tooltip-trigger","-multiline"],["icon-classes","icon icon-warning"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"div",0),l.TgZ(1,"op-single-date-picker",1),l.NdJ("changed",function(de){return ne.begin=ne.isoDateParser(de)}),l.qZA(),l._UZ(2,"span",2),l.TgZ(3,"op-single-date-picker",3),l.NdJ("changed",function(de){return ne.end=ne.isoDateParser(de)}),l.qZA(),l.YNc(4,he,2,1,"span",4),l.qZA()),2&ve&&(l.MGl("id","div-values-",ne.filter.id,""),l.xp6(1),l.Q6J("initialDate",ne.isoDateFormatter(ne.begin))("opAutofocus",ne.shouldFocus)("id","values-"+ne.filter.id+"-begin")("name","v["+ne.filter.id+"]-begin"),l.xp6(1),l.Q6J("textContent",ne.text.spacer),l.xp6(1),l.Q6J("initialDate",ne.isoDateFormatter(ne.end))("id","values-"+ne.filter.id+"-end")("name","v["+ne.filter.id+"]-end"),l.xp6(1),l.Q6J("ngIf",ne.isTimeZoneDifferent))},directives:[N.S,F.U,d.O5,b.o],encapsulation:2});class re extends a.N{constructor(ve){super(),this.I18n=ve,this.shouldFocus=!1,this.filterChanged=new e.R((0,p.J6)(this)),this.text={enter_text:this.I18n.t("js.work_packages.description_enter_text")}}get value(){return this.filter.values[0]}set value(ve){ve.length?this.filter.values[0]=ve:this.filter.values.length=0,this.filterChanged.emit(this.filter)}}re.\u0275fac=function(ve){return new(ve||re)(l.Y36(i.D))},re.\u0275cmp=l.Xpm({type:re,selectors:[["op-filter-string-value"]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},features:[l.qOj],decls:3,vars:7,consts:[[3,"id"],["required","true","type","text",1,"advanced-filters--text-field",3,"ngModel","opAutofocus","id","name","ngModelChange"],[1,"hidden-for-sighted",3,"for","textContent"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"div",0),l.TgZ(1,"input",1),l.NdJ("ngModelChange",function(de){return ne.value=de}),l.qZA(),l._UZ(2,"label",2),l.qZA()),2&ve&&(l.MGl("id","div-values-",ne.filter.name,""),l.xp6(1),l.MGl("id","values-",ne.filter.name,""),l.MGl("name","v[",ne.filter.name,"]"),l.Q6J("ngModel",ne.value)("opAutofocus",ne.shouldFocus),l.xp6(1),l.MGl("for","values-",ne.filter.name,""),l.Q6J("textContent",ne.text.enter_text))},directives:[x.Fj,x.Q7,x.JJ,x.On,F.U],encapsulation:2});var ye=t(29092),Ce=t(70233),ke=t(20979),Ae=t(96905),Fe=t(91923),ot=t(91593);const it=["ngSelectInstance"],Ve=function(Ze){return{"-required-highlighting":Ze}};class Ie{constructor(ve,ne,K,de,He,ht,yt){this.halResourceService=ve,this.halSorting=ne,this.PathHelper=K,this.apiV3Service=de,this.currentUser=He,this.cdRef=ht,this.I18n=yt,this.shouldFocus=!1,this.filterChanged=new l.vpe,this.availableOptions=[],this.text={placeholder:this.I18n.t("js.placeholders.selection")}}ngOnInit(){const ve=this.filter.currentSchema.values.allowedValues;this.availableOptions=this.halSorting.sort(ve)}ngAfterViewInit(){this.ngSelectInstance&&this.shouldFocus&&this.ngSelectInstance.focus()}get value(){return this.filter.values}setValues(ve){this.filter.values=_.castArray(ve),this.filterChanged.emit(this.filter),this.cdRef.detectChanges()}}Ie.\u0275fac=function(ve){return new(ve||Ie)(l.Y36(Fe.u),l.Y36(ye.h),l.Y36(Ce.j),l.Y36(ke.T),l.Y36(Ae.S),l.Y36(l.sBO),l.Y36(i.D))},Ie.\u0275cmp=l.Xpm({type:Ie,selectors:[["op-filter-toggled-multiselect-value"]],viewQuery:function(ve,ne){if(1&ve&&l.Gf(it,7),2&ve){let K;l.iGM(K=l.CRH())&&(ne.ngSelectInstance=K.first)}},inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged"},decls:2,vars:11,consts:[[1,"inline-label","ng-select-container",3,"id"],["appendTo","body",1,"advanced-filters--ng-select","-multi-select",3,"id","items","classes","virtualScroll","closeOnSelect","placeholder","hideSelected","multiple","model","change"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"div",0),l.TgZ(1,"op-autocompleter",1),l.NdJ("change",function(de){return ne.setValues(de)}),l.qZA(),l.qZA()),2&ve&&(l.MGl("id","div-values-",ne.filter.id,""),l.xp6(1),l.Q6J("id","values-"+ne.filter.id)("items",ne.availableOptions)("classes",l.VKq(9,Ve,0===ne.value.length))("closeOnSelect",!1)("placeholder",ne.text.placeholder)("hideSelected",!0)("multiple",!0)("model",ne.value))},directives:[ot.s],encapsulation:2,changeDetection:0});var ue=t(81134),ie=t(26269),R=t(92597),L=t(79902),W=t(17163),oe=t(67727),Oe=t(23896);const $=["ngSelectInstance"],Xe=function(Ze){return{"-required-highlighting":Ze}};class rt extends a.N{constructor(ve,ne,K,de,He,ht,yt,St){super(),this.halResourceService=ve,this.apiV3Service=ne,this.cdRef=K,this.I18n=de,this.currentProject=He,this.currentUser=ht,this.halNotification=yt,this.ngZone=St,this.shouldFocus=!1,this.filterChanged=new l.vpe,this.meValue=this.halResourceService.createHalResource({_links:{self:{href:this.apiV3Service.users.me.path,title:this.I18n.t("js.label_me")}}},!0),this.autocompleterFn=Et=>this.autocomplete(Et),this.text={placeholder:this.I18n.t("js.placeholders.selection")}}get value(){return this.filter.values}ngOnInit(){this.initialRequest$=this.loadCollection("").pipe((0,R.d)(1))}autocomplete(ve){return this.initialRequest$.pipe((0,L.w)(ne=>ne.count===ne.total?this.matchingItems(ne.elements,ve):this.loadCollection(ve).pipe((0,L.w)(K=>this.withMeValue(ve,K.elements)))))}matchingItems(ve,ne){let K;if(""===ne)K=ve;else{const de=ne.toLowerCase();K=ve.filter(He=>He.name.toLowerCase().includes(de))}return this.withMeValue(ne,K)}loadCollection(ve){const ne=this.createFilters(ve);return this.apiV3Service.collectionFromString(this.allowedValuesLink).filtered(ne,{pageSize:"-1"}).get()}createFilters(ve){const ne=new ie.qM;return ve&&ne.add("typeahead","**",[ve]),ne}setValues(ve){this.filter.values=ve.length>0?Array.isArray(ve)?ve:[ve]:[],this.filterChanged.emit(this.filter),this.cdRef.detectChanges()}get allowedValuesLink(){const{href:ve}=this.filter.currentSchema.values.allowedValues;return ve}withMeValue(ve,ne){return!this.isUserResource||ve&&"me"!==ve?(0,ue.of)(ne):this.currentUser.isLoggedIn$.pipe((0,Oe.take)(1),(0,W.M)(this.currentUser.user$),(0,C.U)(([K,de])=>K&&de?[this.meValue].concat(ne):ne))}get isUserResource(){const ve=_.get(this.filter.currentSchema,"values.type",null);return ve&&ve.indexOf("User")>0}}rt.\u0275fac=function(ve){return new(ve||rt)(l.Y36(Fe.u),l.Y36(ke.T),l.Y36(l.sBO),l.Y36(i.D),l.Y36(M.R),l.Y36(Ae.S),l.Y36(oe.W),l.Y36(l.R0b))},rt.\u0275cmp=l.Xpm({type:rt,selectors:[["op-filter-searchable-multiselect-value"]],viewQuery:function(ve,ne){if(1&ve&&l.Gf($,7),2&ve){let K;l.iGM(K=l.CRH())&&(ne.ngSelectInstance=K.first)}},inputs:{filter:"filter",shouldFocus:"shouldFocus"},outputs:{filterChanged:"filterChanged"},features:[l.qOj],decls:2,vars:13,consts:[[1,"inline-label","ng-select-container",3,"id"],["appendTo","body",1,"advanced-filters--ng-select","-multi-select",3,"id","getOptionsFn","classes","virtualScroll","closeOnSelect","placeholder","hideSelected","multiple","fetchDataDirectly","focusDirectly","model","change"]],template:function(ve,ne){1&ve&&(l.TgZ(0,"div",0),l.TgZ(1,"op-autocompleter",1),l.NdJ("change",function(de){return ne.setValues(de)}),l.qZA(),l.qZA()),2&ve&&(l.MGl("id","div-values-",ne.filter.id,""),l.xp6(1),l.Q6J("id","values-"+ne.filter.id)("getOptionsFn",ne.autocompleterFn)("classes",l.VKq(11,Xe,0===ne.value.length))("closeOnSelect",!1)("placeholder",ne.text.placeholder)("hideSelected",!0)("multiple",!0)("fetchDataDirectly",!0)("focusDirectly",ne.shouldFocus)("model",ne.value))},directives:[ot.s],encapsulation:2,changeDetection:0});function be(Ze,ve){if(1&Ze&&l._UZ(0,"option",12),2&Ze){const ne=ve.$implicit;l.Q6J("textContent",ne.name)("ngValue",ne)}}function Me(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"select",10),l.NdJ("ngModelChange",function(de){l.CHM(ne);return l.oxw().filter.operator=de})("ngModelChange",function(){l.CHM(ne);const de=l.oxw();return de.onFilterUpdated(de.filter)}),l.YNc(1,be,1,2,"option",11),l.qZA()}if(2&Ze){const ne=l.oxw();l.MGl("id","operators-",ne.filter.id,""),l.MGl("name","op[",ne.filter.id,"]"),l.Q6J("ngModel",ne.filter.operator)("compareWith",ne.compareByHref),l.xp6(1),l.Q6J("ngForOf",ne.availableOperators)}}function Re(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-boolean-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw().onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw();l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function $e(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-integer-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(2).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(2);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function pt(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-date-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(2).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(2);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function mt(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-dates-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(2).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(2);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function vt(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-date-time-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(2).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(2);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function Ue(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-date-times-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(2).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(2);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function Le(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-string-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(2).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(2);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function Ee(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-string-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(2).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(2);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function st(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-toggled-multiselect-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(3).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(3);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function ut(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"op-filter-searchable-multiselect-value",13),l.NdJ("filterChanged",function(de){return l.CHM(ne),l.oxw(3).onFilterUpdated(de)}),l.qZA()}if(2&Ze){const ne=l.oxw(3);l.Q6J("shouldFocus",ne.shouldFocus)("filter",ne.filter)}}function It(Ze,ve){if(1&Ze&&(l.ynx(0),l.YNc(1,st,1,2,"op-filter-toggled-multiselect-value",4),l.YNc(2,ut,1,2,"op-filter-searchable-multiselect-value",4),l.BQk()),2&Ze){const ne=l.oxw(2);l.xp6(1),l.Q6J("ngIf",ne.filter.currentSchema.loadedAllowedValues()),l.xp6(1),l.Q6J("ngIf",!ne.filter.currentSchema.loadedAllowedValues())}}function Zt(Ze,ve){if(1&Ze&&(l.ynx(0),l.TgZ(1,"div",14),l.YNc(2,$e,1,2,"op-filter-integer-value",15),l.YNc(3,pt,1,2,"op-filter-date-value",15),l.YNc(4,mt,1,2,"op-filter-dates-value",15),l.YNc(5,vt,1,2,"op-filter-date-time-value",15),l.YNc(6,Ue,1,2,"op-filter-date-times-value",15),l.YNc(7,Le,1,2,"op-filter-string-value",15),l.YNc(8,Ee,1,2,"op-filter-string-value",15),l.YNc(9,It,3,2,"ng-container",16),l.qZA(),l.BQk()),2&Ze){const ne=l.oxw();l.xp6(1),l.Q6J("ngSwitch",ne.valueType),l.xp6(1),l.Q6J("ngSwitchCase","[1]Integer"),l.xp6(1),l.Q6J("ngSwitchCase","[1]Date"),l.xp6(1),l.Q6J("ngSwitchCase","[2]Date"),l.xp6(1),l.Q6J("ngSwitchCase","[1]DateTime"),l.xp6(1),l.Q6J("ngSwitchCase","[2]DateTime"),l.xp6(1),l.Q6J("ngSwitchCase","[1]String"),l.xp6(1),l.Q6J("ngSwitchCase","[1]Float")}}function Ut(Ze,ve){1&Ze&&l._UZ(0,"div",17)}class jt{constructor(ve,ne,K,de,He){this.wpTableFilters=ve,this.schemaCache=ne,this.I18n=K,this.currentProject=de,this.bannerService=He,this.shouldFocus=!1,this.filterChanged=new l.vpe,this.deactivateFilter=new l.vpe,this.showValuesInput=!1,this.eeShowBanners=!1,this.trackByHref=c.tL,this.compareByHref=c.U5,this.text={open_filter:this.I18n.t("js.filter.description.text_open_filter"),close_filter:this.I18n.t("js.filter.description.text_close_filter"),label_filter_add:this.I18n.t("js.work_packages.label_filter_add"),upsale_for_more:this.I18n.t("js.filter.upsale_for_more"),upsale_link:this.I18n.t("js.filter.upsale_link"),button_delete:this.I18n.t("js.button_delete")}}onFilterUpdated(ve){this.filter=ve,this.showValuesInput=this.showValues(),this.filterChanged.emit()}removeThisFilter(){this.deactivateFilter.emit(this.filter)}get valueType(){if(this.filter.currentSchema&&this.filter.currentSchema.values)return this.filter.currentSchema.values.type}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.availableOperators=this.schemaCache.of(this.filter).availableOperators,this.showValuesInput=this.showValues()}showValues(){return this.filter.currentSchema.isValueRequired()&&"[1]Boolean"!==this.filter.currentSchema.values.type}}jt.\u0275fac=function(ve){return new(ve||jt)(l.Y36(n.Z),l.Y36(v.y),l.Y36(i.D),l.Y36(M.R),l.Y36(u.j))},jt.\u0275cmp=l.Xpm({type:jt,selectors:[["","query-filter",""]],inputs:{shouldFocus:"shouldFocus",filter:"filter"},outputs:{filterChanged:"filterChanged",deactivateFilter:"deactivateFilter"},attrs:["query-filter",""],decls:12,vars:11,consts:[[1,"advanced-filters--filter-name",3,"for","textContent"],[1,"advanced-filters--filter-operator"],[1,"hidden-for-sighted",3,"for"],["required","","class","advanced-filters--select","style","vertical-align: top;",3,"id","name","ngModel","compareWith","ngModelChange",4,"ngIf"],[3,"shouldFocus","filter","filterChanged",4,"ngIf"],[4,"ngIf"],["class","advanced-filters--filter-value",4,"ngIf"],[1,"advanced-filters--remove-filter"],["type","button",1,"spot-link",3,"title","click"],["icon-classes","icon-close advanced-filters--remove-filter-icon"],["required","",1,"advanced-filters--select",2,"vertical-align","top",3,"id","name","ngModel","compareWith","ngModelChange"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"],[3,"shouldFocus","filter","filterChanged"],[1,"advanced-filters--filter-value",3,"ngSwitch"],[3,"shouldFocus","filter","filterChanged",4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"advanced-filters--filter-value"]],template:function(ve,ne){1&ve&&(l.ynx(0),l._UZ(1,"label",0),l.TgZ(2,"div",1),l.TgZ(3,"label",2),l._uU(4),l.qZA(),l.YNc(5,Me,2,5,"select",3),l.YNc(6,Re,1,2,"op-filter-boolean-value",4),l.qZA(),l.YNc(7,Zt,10,8,"ng-container",5),l.YNc(8,Ut,1,0,"div",6),l.TgZ(9,"div",7),l.TgZ(10,"button",8),l.NdJ("click",function(){return ne.removeThisFilter()}),l._UZ(11,"op-icon",9),l.qZA(),l.qZA(),l.BQk()),2&ve&&(l.xp6(1),l.MGl("for","operators-",ne.filter.id,""),l.Q6J("textContent",ne.filter.name),l.uIk("title",ne.filter.name),l.xp6(2),l.MGl("for","operators-",ne.filter.id,""),l.xp6(1),l.AsE(" ",ne.filter.name," ",ne.text.open_filter," "),l.xp6(1),l.Q6J("ngIf","[1]Boolean"!==ne.valueType),l.xp6(1),l.Q6J("ngIf","[1]Boolean"==ne.valueType),l.xp6(1),l.Q6J("ngIf",ne.showValuesInput&&ne.valueType),l.xp6(1),l.Q6J("ngIf",!ne.showValuesInput),l.xp6(2),l.Q6J("title",ne.text.button_delete))},directives:[d.O5,b.o,x.EJ,x.Q7,x.JJ,x.On,d.sg,x.YN,x.Kr,A,d.RF,d.n9,d.ED,I,te,G,_e,ae,re,Ie,rt],encapsulation:2});var Dt=t(8158);function bt(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"a",20),l.NdJ("click",function(){return l.CHM(ne),l.oxw(2).closeFilter()}),l.qZA()}if(2&Ze){const ne=l.oxw(2);l.uIk("title",ne.text.close_form)}}function Lt(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"li",22),l.NdJ("deactivateFilter",function(de){return l.CHM(ne),l.oxw(3).deactivateFilter(de)})("filterChanged",function(){l.CHM(ne);const de=l.oxw(3);return de.filtersChanged.emit(de.filters)}),l.qZA()}if(2&Ze){const ne=l.oxw(),K=ne.$implicit,de=ne.index,He=l.oxw(2);l.MGl("id","filter_",K.id,""),l.Q6J("shouldFocus",de==He.focusElementIndex)("filter",K)}}function Wt(Ze,ve){if(1&Ze&&(l.ynx(0),l.YNc(1,Lt,1,3,"li",21),l.BQk()),2&Ze){const ne=ve.$implicit,K=l.oxw(2);l.xp6(1),l.Q6J("ngIf",K.isFilterAvailable(ne))}}function Rt(Ze,ve){1&Ze&&l._UZ(0,"li",9)}function xt(Ze,ve){if(1&Ze&&l._UZ(0,"enterprise-banner",23),2&Ze){const ne=l.oxw(2);l.Q6J("linkMessage",ne.text.upsale_link)("textMessage",ne.text.upsale_for_more)}}function Mt(Ze,ve){if(1&Ze){const ne=l.EpF();l.TgZ(0,"fieldset",1),l._UZ(1,"legend",2),l.YNc(2,bt,1,1,"a",3),l.TgZ(3,"ul",4),l.TgZ(4,"li",5),l._UZ(5,"label",6),l.TgZ(6,"div",7),l.TgZ(7,"wp-filter-by-text-input",8),l.NdJ("deactivateFilter",function(de){return l.CHM(ne),l.oxw().deactivateFilter(de)}),l.qZA(),l.qZA(),l.qZA(),l._UZ(8,"li",9),l.YNc(9,Wt,2,1,"ng-container",10),l.YNc(10,Rt,1,0,"li",11),l.TgZ(11,"li",12),l.TgZ(12,"label",13),l._UZ(13,"op-icon",14),l._uU(14),l.qZA(),l.TgZ(15,"label",15),l._uU(16),l.qZA(),l.TgZ(17,"div",16),l.TgZ(18,"ng-select",17,18),l.NdJ("open",function(){return l.CHM(ne),l.oxw().onOpen()})("change",function(de){return l.CHM(ne),l.oxw().onFilterAdded(de)}),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.YNc(20,xt,1,2,"enterprise-banner",19),l.qZA()}if(2&Ze){const ne=l.oxw();l.xp6(1),l.Q6J("textContent",ne.text.selected_filter_list),l.xp6(1),l.Q6J("ngIf",ne.showCloseFilter),l.xp6(3),l.Q6J("textContent",ne.text.filter_by_text),l.uIk("title",ne.text.filter_by_text),l.xp6(4),l.Q6J("ngForOf",ne.filters)("ngForTrackBy",ne.trackByName),l.xp6(1),l.Q6J("ngIf",ne.isSecondSpacerVisible),l.xp6(4),l.hij(" ",ne.text.label_filter_add,": "),l.xp6(2),l.lnq(" ",ne.text.label_filter_add," ",ne.text.open_filter," ",ne.text.close_filter," "),l.xp6(2),l.Q6J("items",ne.remainingFilters)("clearSearchOnAdd",!0)("multiple",!1)("clearable",!0)("clearOnBackspace",!0)("closeOnSelect",!0)("virtualScroll",!0)("placeholder",ne.text.please_select),l.xp6(2),l.Q6J("ngIf",ne.eeShowBanners)}}class Jt extends a.N{constructor(ve,ne,K,de){super(),this.wpTableFilters=ve,this.wpFiltersService=ne,this.I18n=K,this.bannerService=de,this.showCloseFilter=!1,this.filtersChanged=new e.R((0,p.J6)(this)),this.remainingFilters=[],this.eeShowBanners=!1,this.focusElementIndex=0,this.trackByName=c.As,this.text={open_filter:this.I18n.t("js.filter.description.text_open_filter"),label_filter_add:this.I18n.t("js.work_packages.label_filter_add"),close_filter:this.I18n.t("js.filter.description.text_close_filter"),upsale_for_more:this.I18n.t("js.filter.upsale_for_more"),upsale_link:this.I18n.t("js.filter.upsale_link"),close_form:this.I18n.t("js.close_form_title"),selected_filter_list:this.I18n.t("js.label_selected_filter_list"),button_delete:this.I18n.t("js.button_delete"),please_select:this.I18n.t("js.placeholders.selection"),filter_by_text:this.I18n.t("js.work_packages.label_filter_by_text")}}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners}ngOnChanges(){this.updateRemainingFilters()}onFilterAdded(ve){if(ve){const ne=this.wpTableFilters.instantiate(ve);this.filters.push(ne);const K=this.currentFilterLength();this.updateFilterFocus(K),this.updateRemainingFilters(),this.filtersChanged.emit(this.filters),this.ngSelectComponent.clearItem(ve)}}closeFilter(){this.wpFiltersService.toggleVisibility()}deactivateFilter(ve){const ne=this.filters.indexOf(ve);_.remove(this.filters,K=>K.id===ve.id),this.filtersChanged.emit(this.filters),this.updateFilterFocus(ne),this.updateRemainingFilters()}get isSecondSpacerVisible(){const ve=!!_.find(this.filters,K=>"search"===K.id),ne=!!this.filters.find(K=>"search"!==K.id&&this.isFilterAvailable(K));return ve&&ne}updateRemainingFilters(){this.remainingFilters=_.sortBy(this.wpTableFilters.remainingVisibleFilters(this.filters),"name")}updateFilterFocus(ve){const ne=this.currentFilterLength();if(0===ne)this.focusElementIndex=-1;else{const K=ve<ne?ve:ne-1,de=this.currentFilterAt(K);this.focusElementIndex=this.filters.indexOf(de)}}currentFilterLength(){return this.filters.length}currentFilterAt(ve){return this.filters[ve]}isFilterAvailable(ve){return this.wpTableFilters.availableFilters.some(ne=>ne.id===ve.id)&&!(this.wpTableFilters.hidden.includes(ve.id)||ve.isTemplated())}onOpen(){setTimeout(()=>{const ve=this.ngSelectComponent;ve&&ve.dropdownPanel&&ve.dropdownPanel._updatePosition()},25)}}Jt.\u0275fac=function(ve){return new(ve||Jt)(l.Y36(n.Z),l.Y36(h.U),l.Y36(i.D),l.Y36(u.j))},Jt.\u0275cmp=l.Xpm({type:Jt,selectors:[["query-filters"]],viewQuery:function(ve,ne){if(1&ve&&l.Gf(r.w9,5),2&ve){let K;l.iGM(K=l.CRH())&&(ne.ngSelectComponent=K.first)}},inputs:{filters:"filters",showCloseFilter:"showCloseFilter"},outputs:{filtersChanged:"filtersChanged"},features:[l.qOj,l.TTD],decls:1,vars:1,consts:[["id","filters","class","advanced-filters--container",4,"ngIf"],["id","filters",1,"advanced-filters--container"],[3,"textContent"],["class","advanced-filters--close icon-context icon-close",3,"click",4,"ngIf"],[1,"advanced-filters--filters"],["id","filter_search",1,"advanced-filters--filter","--without-operator"],["for","filter-by-text-input",1,"advanced-filters--filter-name",3,"textContent"],[1,"advanced-filters--filter-value"],[3,"deactivateFilter"],[1,"advanced-filters--spacer"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","advanced-filters--spacer",4,"ngIf"],[1,"advanced-filters--add-filter"],["for","add_filter_select","aria-hidden","true",1,"advanced-filters--add-filter-label"],["icon-classes","icon-add icon4"],["for","add_filter_select",1,"hidden-for-sighted"],[1,"advanced-filters--add-filter-value"],["id","add_filter_select","bindLabel","name","appendTo","body",3,"items","clearSearchOnAdd","multiple","clearable","clearOnBackspace","closeOnSelect","virtualScroll","placeholder","open","change"],["ngSelectComponent",""],["class","advanced-filters--add-filter-info","opReferrer","wp-filter#filters",3,"linkMessage","textMessage",4,"ngIf"],[1,"advanced-filters--close","icon-context","icon-close",3,"click"],["query-filter","","class","advanced-filters--filter",3,"id","shouldFocus","filter","deactivateFilter","filterChanged",4,"ngIf"],["query-filter","",1,"advanced-filters--filter",3,"id","shouldFocus","filter","deactivateFilter","filterChanged"],["opReferrer","wp-filter#filters",1,"advanced-filters--add-filter-info",3,"linkMessage","textMessage"]],template:function(ve,ne){1&ve&&l.YNc(0,Mt,21,20,"fieldset",0),2&ve&&l.Q6J("ngIf",ne.filters)},directives:[d.O5,k,d.sg,b.o,r.w9,jt,Dt.P],encapsulation:2,changeDetection:0})},78434:(H,D,t)=>{"use strict";t.d(D,{U:()=>u});var i=t(14808),e=t(22663),c=t(2316);class u{constructor(){this.state=(0,i.qH)(!1)}get visible(){return this.state.getValueOr(!1)}set visible(n){this.state.putValue(n)}observeUntil(n){return this.state.values$().pipe((0,e.R)(n))}toggleVisibility(){this.state.doModify(n=>!n)}}u.\u0275fac=function(n){return new(n||u)},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},82267:(H,D,t)=>{"use strict";t.d(D,{O:()=>n});var i=t(96617),e=t(36293),c=t(79441),u=t(62964),r=t(2316);class n{constructor(a,p,l){this.I18n=a,this.workPackageNotificationService=p,this.toastService=l,this.quoteEvents=new c.xQ}createComment(a,p){return a.addComment({comment:p},{"Content-Type":"application/json; charset=UTF-8"}).catch(l=>this.errorAndReject(l,a))}updateComment(a,p){JSON.stringify({comment:p});return a.update({comment:p},{"Content-Type":"application/json; charset=UTF-8"}).then(d=>(this.toastService.addSuccess(this.I18n.t("js.work_packages.comment_updated")),d)).catch(d=>this.errorAndReject(d))}errorAndReject(a,p){return this.workPackageNotificationService.handleRawError(a,p),Promise.reject(a)}}n.\u0275fac=function(a){return new(a||n)(r.LFG(i.D),r.LFG(u.q),r.LFG(e.kl))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac})},5262:(H,D,t)=>{"use strict";t.d(D,{f:()=>O});var i=t(96617),c=(t(24897),t(2316)),u=t(54364),r=t(41945),n=t(62964),h=t(84906),a=t(2775),p=t(11950);const l=function(A){return{workPackageId:A}};function d(A,F){if(1&A&&(c.TgZ(0,"a",5),c._UZ(1,"span",6),c.qZA()),2&A){const I=c.oxw(2);c.Q6J("uiParams",c.VKq(3,l,I.parent.id)),c.uIk("title",I.parent.name),c.xp6(1),c.Q6J("textContent",I.parent.name)}}function g(A,F){if(1&A&&c._UZ(0,"span",6),2&A){const I=c.oxw(3);c.Q6J("textContent",I.text.set_parent)}}function C(A,F){if(1&A){const I=c.EpF();c.TgZ(0,"button",7),c.NdJ("click",function(){return c.CHM(I),c.oxw(2).open()}),c.YNc(1,g,1,1,"span",8),c._UZ(2,"op-icon",9),c.qZA()}if(2&A){const I=c.oxw(2);c.Q6J("title",I.parent?I.text.edit_parent:I.text.set_parent),c.xp6(1),c.Q6J("ngIf",!I.parent),c.xp6(1),c.MGl("icon-classes","icon-small ",I.parent?"icon-edit icon5 icon-no-color":"icon-add icon4","")}}function y(A,F){if(1&A){const I=c.EpF();c.TgZ(0,"button",10),c.NdJ("click",function(){return c.CHM(I),c.oxw(2).updateParent(null)}),c._UZ(1,"op-icon",11),c.qZA()}if(2&A){const I=c.oxw(2);c.Q6J("title",I.text.remove_parent)}}function m(A,F){if(1&A&&(c.ynx(0),c.YNc(1,d,2,5,"a",2),c.YNc(2,C,3,3,"button",3),c.YNc(3,y,2,1,"button",4),c.BQk()),2&A){const I=c.oxw();c.xp6(1),c.Q6J("ngIf",I.parent),c.xp6(1),c.Q6J("ngIf",I.canModifyParent()),c.xp6(1),c.Q6J("ngIf",I.canModifyParent()&&I.parent)}}function E(A,F){if(1&A){const I=c.EpF();c.TgZ(0,"wp-relations-autocomplete",12),c.NdJ("onCancel",function(){return c.CHM(I),c.oxw().close()})("onSelected",function(N){return c.CHM(I),c.oxw().updateParent(N)}),c.qZA()}if(2&A){const I=c.oxw();c.Q6J("inputPlaceholder",I.text.set_or_remove_parent)("workPackage",I.workPackage)}}class P{constructor(F,I,J){this.I18n=F,this.wpRelationsHierarchy=I,this.notificationService=J,this.onSwitch=new c.vpe,this.isSaving=!1,this.text={edit_parent:this.I18n.t("js.relation_buttons.change_parent"),set_or_remove_parent:this.I18n.t("js.relations_autocomplete.parent_placeholder"),remove_parent:this.I18n.t("js.relation_buttons.remove_parent"),set_parent:this.I18n.t("js.relation_buttons.set_parent")}}canModifyParent(){return!!this.workPackage.changeParent}get parent(){return this.workPackage&&this.workPackage.parent}get active(){return this.editing}close(){this.toggle(!1)}open(){this.toggle(!0)}updateParent(F){this.close();const I=F?F.id:null;_.get(this.parent,"id",null)!==I&&(this.isSaving=!0,this.wpRelationsHierarchy.changeParent(this.workPackage,I).catch(J=>{this.notificationService.handleRawError(J,this.workPackage)}).then(()=>this.isSaving=!1))}toggle(F){this.editing!==F&&(this.editing=F,this.onSwitch.emit(this.editing))}}P.\u0275fac=function(F){return new(F||P)(c.Y36(i.D),c.Y36(r.O),c.Y36(n.q))},P.\u0275cmp=c.Xpm({type:P,selectors:[["wp-breadcrumb-parent"]],inputs:{workPackage:"workPackage"},outputs:{onSwitch:"onSwitch"},decls:2,vars:2,consts:[[4,"ngIf"],["filterCandidatesFor","parent",3,"inputPlaceholder","workPackage","onCancel","onSelected",4,"ngIf"],["uiSref","work-packages.show.tabs","class","op-wp-breadcrumb-parent nocut","data-qa-selector","op-wp-breadcrumb-parent",3,"uiParams",4,"ngIf"],["type","button","class","spot-link wp-relation--parent-change -no-decoration hide-when-print",3,"title","click",4,"ngIf"],["type","button","class","spot-link wp-relation--parent-remove hide-when-print -no-decoration",3,"title","click",4,"ngIf"],["uiSref","work-packages.show.tabs","data-qa-selector","op-wp-breadcrumb-parent",1,"op-wp-breadcrumb-parent","nocut",3,"uiParams"],[3,"textContent"],["type","button",1,"spot-link","wp-relation--parent-change","-no-decoration","hide-when-print",3,"title","click"],[3,"textContent",4,"ngIf"],[3,"icon-classes"],["type","button",1,"spot-link","wp-relation--parent-remove","hide-when-print","-no-decoration",3,"title","click"],["icon-classes","icon-small icon-no-color icon-remove icon4"],["filterCandidatesFor","parent",3,"inputPlaceholder","workPackage","onCancel","onSelected"]],template:function(F,I){1&F&&(c.YNc(0,m,4,3,"ng-container",0),c.YNc(1,E,1,2,"wp-relations-autocomplete",1)),2&F&&(c.Q6J("ngIf",!I.active),c.xp6(1),c.Q6J("ngIf",I.active))},directives:[u.O5,h.AnchorUISref,h.UISref,a.o,p.t],encapsulation:2});const w=function(A){return{"icon4 icon-small icon-arrow-right5":A}},x=function(A){return{workPackageId:A}};function k(A,F){if(1&A&&(c.TgZ(0,"li",8),c._UZ(1,"a",9),c.qZA()),2&A){const I=c.oxw(),J=I.first,N=I.$implicit;c.Q6J("ngClass",c.VKq(4,w,!J)),c.xp6(1),c.Q6J("textContent",N.name)("uiParams",c.VKq(6,x,N.id)),c.uIk("title",N.name)}}function b(A,F){if(1&A&&(c.ynx(0),c.YNc(1,k,2,8,"li",7),c.BQk()),2&A){const I=F.last;c.xp6(1),c.Q6J("ngIf",!I)}}function v(A,F){if(1&A&&(c.ynx(0),c.TgZ(1,"li"),c.TgZ(2,"span"),c._uU(3),c.qZA(),c.qZA(),c.YNc(4,b,2,1,"ng-container",6),c.BQk()),2&A){const I=c.oxw(2);c.xp6(3),c.hij("",I.hierarchyLabel,": "),c.xp6(1),c.Q6J("ngForOf",I.workPackage.ancestors)}}const M=function(A,F){return{"op-wp-breadcrumb--active-parent-select":A,"icon4 icon-small icon-arrow-right5":F}};function S(A,F){if(1&A){const I=c.EpF();c.TgZ(0,"div",1),c.TgZ(1,"ul",2),c.YNc(2,v,5,2,"ng-container",3),c.TgZ(3,"li",4),c.TgZ(4,"wp-breadcrumb-parent",5),c.NdJ("onSwitch",function(N){return c.CHM(I),c.oxw().updateActiveInput(N)}),c.qZA(),c.qZA(),c.qZA(),c.qZA()}if(2&A){const I=c.oxw();c.xp6(2),c.Q6J("ngIf",!I.inputActive&&I.hierarchyCount>0),c.xp6(1),c.Q6J("ngClass",c.WLB(3,M,I.inputActive,!I.inputActive&&I.hierarchyCount>1)),c.xp6(1),c.Q6J("workPackage",I.workPackage)}}class O{constructor(F){this.I18n=F,this.text={parent:this.I18n.t("js.relations_hierarchy.parent_headline"),hierarchy:this.I18n.t("js.relations_hierarchy.hierarchy_headline")},this.inputActive=!1}get hierarchyCount(){return this.workPackage.ancestors.length}get hierarchyLabel(){return 1===this.hierarchyCount?this.text.parent:this.text.hierarchy}updateActiveInput(F){this.inputActive=F}}O.\u0275fac=function(F){return new(F||O)(c.Y36(i.D))},O.\u0275cmp=c.Xpm({type:O,selectors:[["wp-breadcrumb"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","op-wp-breadcrumb -show","data-qa-selector","op-wp-breadcrumb",4,"ngIf"],["data-qa-selector","op-wp-breadcrumb",1,"op-wp-breadcrumb","-show"],["data-qa-selector","op-breadcrumb",1,"op-breadcrumb"],[4,"ngIf"],[3,"ngClass"],[3,"workPackage","onSwitch"],[4,"ngFor","ngForOf"],["class","op-wp-breadcrumb--ellipsed",3,"ngClass",4,"ngIf"],[1,"op-wp-breadcrumb--ellipsed",3,"ngClass"],["uiSref","work-packages.show",1,"nocut",3,"textContent","uiParams"]],template:function(F,I){1&F&&c.YNc(0,S,5,6,"div",0),2&F&&c.Q6J("ngIf",I.workPackage)},directives:[u.O5,u.mk,P,u.sg,h.AnchorUISref,h.UISref],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-breadcrumb[_ngcontent-%COMP%]{margin-top:10px;display:none;transition:all .1s ease-in-out 0s;overflow:hidden;width:auto;height:initial}.op-wp-breadcrumb[_ngcontent-%COMP%]   ul.op-breadcrumb[_ngcontent-%COMP%]{height:initial;margin:0;padding:0}.op-wp-breadcrumb[_ngcontent-%COMP%]   ul.op-breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:var(--breadcrumb-font-color);font-family:var(--body-font-family);font-size:var(--breadcrumb-font-size);font-weight:normal;list-style-type:none;float:left;margin:0 5px 0 0;padding:0;line-height:20px;max-width:100%;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-wp-breadcrumb.-show[_ngcontent-%COMP%]{display:block}.op-wp-breadcrumb--ellipsed[_ngcontent-%COMP%]{max-width:600px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-wp-breadcrumb--active-parent-select[_ngcontent-%COMP%]{width:500px}@media screen and (max-width: 1248px){.op-wp-breadcrumb[_ngcontent-%COMP%]{margin-top:0}}.op-wp-breadcrumb[_ngcontent-%COMP%]   ul.op-breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   wp-breadcrumb-parent[_ngcontent-%COMP%]{white-space:initial}.op-wp-breadcrumb[_ngcontent-%COMP%]   .ng-placeholder[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}"]})},44210:(H,D,t)=>{"use strict";t.d(D,{S:()=>e});var i=t(26942);class e extends i.N{constructor(u){super(),this.I18n=u,this.isActive=!1,this.text={activate:this.I18n.t("js.label_activate"),deactivate:this.I18n.t("js.label_deactivate"),label:this.labelKey?this.I18n.t(this.labelKey):"",buttonText:this.textKey?this.I18n.t(this.textKey):""}}get label(){return this.text.label}get buttonText(){return this.text.buttonText}get labelKey(){return""}get textKey(){return""}get activationPrefix(){return this.isActive?"":`${this.text.activate} `}get deactivationPrefix(){return this.isActive?`${this.text.deactivate} `:""}get prefix(){return this.activationPrefix||this.deactivationPrefix}isToggle(){return!1}}},25351:(H,D,t)=>{"use strict";t.d(D,{z:()=>P});var i=t(47775),e=t(96617),c=t(7493),u=t(26942),r=t(38519),n=t(65146),h=t(2316),a=t(20342),p=t(67325),l=t(55548),d=t(1056),g=t(63829),C=t(50076);class y extends l.n{constructor(x,k,b,v,M){super(x,k),this.elementRef=x,this.opContextMenu=k,this.browserDetector=b,this.wpCreate=v,this.$state=M}ngAfterViewInit(){super.ngAfterViewInit(),this.active&&this.browserDetector.isMobile&&(this.stateName="work-packages.new")}open(x){this.wpCreate.getEmptyForm(this.projectIdentifier).then(k=>{this.buildItems(k.schema.type.allowedValues),this.opContextMenu.show(this,x)})}get locals(){return{items:this.items,contextMenuId:"types-context-menu"}}buildItems(x){this.items=x.map(k=>({disabled:!1,linkText:k.name,href:this.$state.href(this.stateName,{type:k.id}),ariaLabel:k.name,class:C.Z.inlineClass("type",k.id),onClick:b=>!(0,p.F)(b)&&(this.$state.go(this.stateName,{type:k.id}),!0)}))}}y.\u0275fac=function(x){return new(x||y)(h.Y36(h.SBq),h.Y36(a.$),h.Y36(d.o),h.Y36(g.P),h.Y36(i.StateService))},y.\u0275dir=h.lG2({type:y,selectors:[["","opTypesCreateDropdown",""]],inputs:{projectIdentifier:"projectIdentifier",stateName:"stateName",active:["dropdownActive","active"]},features:[h.qOj]});var m=t(2775),E=t(54364);class P extends u.N{constructor(x,k,b,v,M,S){super(),this.$state=x,this.currentProject=k,this.authorisationService=b,this.transition=v,this.I18n=M,this.cdRef=S,this.text={createWithDropdown:this.I18n.t("js.work_packages.create.button"),createButton:this.I18n.t("js.label_work_package"),explanation:this.I18n.t("js.label_create_work_package")}}ngOnInit(){this.projectIdentifier=this.currentProject.identifier,this.authorisationService.observeUntil((0,r.J6)(this)).subscribe(()=>{this.allowed=!!this.allowedWhen.find(x=>{const[k,b]=x.split(".");return this.authorisationService.can(k,b)}),this.updateDisabledState()}),this.transitionUnregisterFn=this.transition.onSuccess({},this.updateDisabledState.bind(this))}ngOnDestroy(){super.ngOnDestroy(),this.transitionUnregisterFn()}updateDisabledState(){this.disabled=!this.allowed||this.$state.includes("**.new"),this.cdRef.detectChanges()}}P.\u0275fac=function(x){return new(x||P)(h.Y36(i.StateService),h.Y36(n.R),h.Y36(c.g),h.Y36(i.TransitionService),h.Y36(e.D),h.Y36(h.sBO))},P.\u0275cmp=h.Xpm({type:P,selectors:[["wp-create-button"]],inputs:{allowedWhen:["allowed","allowedWhen"],stateName$:"stateName$"},features:[h.qOj],decls:6,vars:8,consts:[[1,"wp-create-button"],["opTypesCreateDropdown","",1,"button","-alt-highlight","add-work-package",3,"disabled","projectIdentifier","stateName","dropdownActive"],["icon-classes","button--icon icon-add"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown hidden-for-mobile"]],template:function(x,k){1&x&&(h.TgZ(0,"div",0),h.TgZ(1,"button",1),h.ALo(2,"async"),h._UZ(3,"op-icon",2),h._UZ(4,"span",3),h._UZ(5,"op-icon",4),h.qZA(),h.qZA()),2&x&&(h.xp6(1),h.Q6J("disabled",k.disabled)("projectIdentifier",k.projectIdentifier)("stateName",h.lcZ(2,6,k.stateName$))("dropdownActive",k.allowed),h.uIk("aria-label",k.text.explanation),h.xp6(3),h.Q6J("textContent",k.text.createWithDropdown))},directives:[y,m.o],pipes:[E.Ov],encapsulation:2,changeDetection:0})},22956:(H,D,t)=>{"use strict";t.d(D,{U:()=>d});var i=t(44210),e=t(96617),c=t(74647),u=t(38519),r=t(78434),n=t(2316),h=t(54364),a=t(2775);function p(g,C){if(1&g&&n._UZ(0,"span",4),2&g){const y=n.oxw();n.Q6J("textContent",y.filterCount)}}const l=function(g){return{"-active":g}};class d extends i.S{constructor(C,y,m,E){super(C),this.I18n=C,this.cdRef=y,this.wpFiltersService=m,this.wpTableFilters=E,this.initialized=!1,this.buttonId="work-packages-filter-toggle-button",this.iconClass="icon-filter"}ngOnInit(){this.setupObserver()}get labelKey(){return"js.button_filter"}get textKey(){return"js.toolbar.filter"}get label(){return this.prefix+this.text.label}get filterCount(){return this.count}performAction(C){this.toggleVisibility()}toggleVisibility(){this.wpFiltersService.toggleVisibility()}setupObserver(){this.wpTableFilters.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.count=this.wpTableFilters.currentlyVisibleFilters.length,this.initialized=!0,this.cdRef.detectChanges()}),this.wpFiltersService.observeUntil((0,u.J6)(this)).subscribe(()=>{this.isActive=this.wpFiltersService.visible,this.cdRef.detectChanges()})}}d.\u0275fac=function(C){return new(C||d)(n.Y36(e.D),n.Y36(n.sBO),n.Y36(r.U),n.Y36(c.Z))},d.\u0275cmp=n.Xpm({type:d,selectors:[["wp-filter-button"]],features:[n.qOj],decls:5,vars:11,consts:[["data-qa-selector","wp-filter-button",1,"button",3,"disabled","ngClass","click"],[3,"icon-classes"],[1,"button--text"],["class","badge -secondary",3,"textContent",4,"ngIf"],[1,"badge","-secondary",3,"textContent"]],template:function(C,y){1&C&&(n.TgZ(0,"button",0),n.NdJ("click",function(E){return y.performAction(E)}),n._UZ(1,"op-icon",1),n.TgZ(2,"span",2),n._uU(3),n.YNc(4,p,1,1,"span",3),n.qZA(),n.qZA()),2&C&&(n.Q6J("disabled",y.disabled)("ngClass",n.VKq(9,l,y.isActive)),n.uIk("id",y.buttonId)("accesskey",y.accessKey)("title",y.label)("aria-label",y.label),n.xp6(1),n.MGl("icon-classes","",y.iconClass," button--icon"),n.xp6(2),n.hij(" ",y.buttonText," "),n.xp6(1),n.Q6J("ngIf",y.initialized))},directives:[h.mk,a.o,h.O5],encapsulation:2,changeDetection:0})},31021:(H,D,t)=>{"use strict";t.d(D,{q:()=>h});var i=t(96617),c=(t(24897),t(50937)),u=t(2316),r=t(54364),n=t(2775);class h{constructor(p,l){this.I18n=p,this.storeService=l,this.text={mark_as_read:this.I18n.t("js.notifications.center.mark_as_read")}}markAllBelongingNotificationsAsRead(){this.storeService.markAllAsRead()}}h.\u0275fac=function(p){return new(p||h)(u.Y36(i.D),u.Y36(c.O))},h.\u0275cmp=u.Xpm({type:h,selectors:[["op-work-package-mark-notification-button"]],inputs:{workPackage:"workPackage",buttonClasses:"buttonClasses"},decls:2,vars:2,consts:[[1,"button",3,"ngClass","click"],["icon-classes","button--icon icon-mark-read"]],template:function(p,l){1&p&&(u.TgZ(0,"button",0),u.NdJ("click",function(){return l.markAllBelongingNotificationsAsRead()}),u._UZ(1,"op-icon",1),u.qZA()),2&p&&(u.Q6J("ngClass",l.buttonClasses),u.uIk("title",l.text.mark_as_read))},directives:[r.mk,n.o],encapsulation:2,changeDetection:0})},52025:(H,D,t)=>{"use strict";t.d(D,{b:()=>A});var i=t(96617),e=t(2316),c=t(7493),u=t(55548),r=t(20342),n=t(87853),h=t(61043),p=(t(17577),t(77355)),l=t(57119),d=t(43440),g=t(77616),C=t(67727),y=t(36293),m=t(60312),E=t(52932),P=t(1707);class w{constructor(I,J,N,te){this.states=I,this.querySpace=J,this.authorisationService=N,this.I18n=te,this.onChange=new e.vpe,this.text={showInMenu:this.I18n.t("js.label_star_query"),visibleForOthers:this.I18n.t("js.label_public_query"),showInMenuText:this.I18n.t("js.work_packages.query.star_text"),visibleForOthersText:this.I18n.t("js.work_packages.query.public_text")}}get canStar(){return this.isSave||this.authorisationService.can("query","star")||this.authorisationService.can("query","unstar")}get canPublish(){const I=this.querySpace.queryForm.value;return this.authorisationService.can("query","updateImmediately")&&I.schema.public.writable}updateStarred(I){this.isStarred=I,this.changed()}updatePublic(I){this.isPublic=I,this.changed()}changed(){this.onChange.emit({isStarred:!!this.isStarred,isPublic:!!this.isPublic})}}w.\u0275fac=function(I){return new(I||w)(e.Y36(n.G),e.Y36(d.q),e.Y36(c.g),e.Y36(i.D))},w.\u0275cmp=e.Xpm({type:w,selectors:[["query-sharing-form"]],inputs:{isSave:"isSave",isStarred:"isStarred",isPublic:"isPublic"},outputs:{onChange:"onChange"},decls:14,vars:8,consts:[[1,"form--field"],[1,"form--field-container","-vertical"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","is_public","id","show-public",1,"form--check-box",3,"ngModel","disabled","ngModelChange"],[1,"form--field-instructions","-no-margin",3,"textContent"],["type","checkbox","name","show_in_menu","id","show-in-menu",1,"form--check-box",3,"ngModel","disabled","ngModelChange"]],template:function(I,J){1&I&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"label",2),e.TgZ(3,"div",3),e.TgZ(4,"input",4),e.NdJ("ngModelChange",function(te){return J.updatePublic(te)}),e.qZA(),e.qZA(),e._uU(5),e.qZA(),e._UZ(6,"div",5),e.qZA(),e.qZA(),e.TgZ(7,"div",0),e.TgZ(8,"div",1),e.TgZ(9,"label",2),e.TgZ(10,"div",3),e.TgZ(11,"input",6),e.NdJ("ngModelChange",function(te){return J.updateStarred(te)}),e.qZA(),e.qZA(),e._uU(12),e.qZA(),e._UZ(13,"div",5),e.qZA(),e.qZA()),2&I&&(e.xp6(4),e.Q6J("ngModel",J.isPublic)("disabled",!J.canPublish),e.xp6(1),e.hij(" ",J.text.visibleForOthers," "),e.xp6(1),e.Q6J("textContent",J.text.visibleForOthersText),e.xp6(5),e.Q6J("ngModel",J.isStarred)("disabled",!J.canStar),e.xp6(1),e.hij(" ",J.text.showInMenu," "),e.xp6(1),e.Q6J("textContent",J.text.showInMenuText))},directives:[P.Wl,P.JJ,P.On],encapsulation:2});class x extends m.T{constructor(I,J,N,te,ee,G,se,me,_e){super(J,G,I),this.elementRef=I,this.locals=J,this.I18n=N,this.states=te,this.querySpace=ee,this.cdRef=G,this.wpListService=se,this.halNotification=me,this.toastService=_e,this.isStarred=!1,this.isPublic=!1,this.isBusy=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),save_as:this.I18n.t("js.label_save_as"),label_name:this.I18n.t("js.modals.label_name"),label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")}}ngOnInit(){super.ngOnInit(),this.query=this.querySpace.query.value,this.isStarred=this.query.starred,this.isPublic=this.query.public}setValues(I){this.isStarred=I.isStarred,this.isPublic=I.isPublic}get afterFocusOn(){return jQuery("#work-packages-settings-button")}saveQuery(I){if(this.isBusy)return;this.isBusy=!0;const J=[];this.query.public!==this.isPublic&&(this.query.public=this.isPublic,J.push(this.wpListService.save(this.query))),this.query.starred!==this.isStarred&&J.push(this.wpListService.toggleStarred(this.query)),Promise.all(J).then(()=>{this.closeMe(I),this.isBusy=!1}).catch(()=>{this.toastService.addError(this.I18n.t("js.error.query_saving")),this.isBusy=!1})}}x.\u0275fac=function(I){return new(I||x)(e.Y36(e.SBq),e.Y36(p.E),e.Y36(i.D),e.Y36(n.G),e.Y36(d.q),e.Y36(e.sBO),e.Y36(h.Z),e.Y36(C.W),e.Y36(y.kl))},x.\u0275cmp=e.Xpm({type:x,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[["data-indicator-name","modal",1,"op-modal","wp-table--configuration-modal","loading-indicator--location"],[3,"close"],[1,"op-modal--body",3,"isSave","isStarred","isPublic","onChange"],[1,"op-modal--footer"],[1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","click"],[1,"button","-with-icon","icon-cancel",3,"textContent","disabled","click"]],template:function(I,J){1&I&&(e.TgZ(0,"div",0),e.TgZ(1,"op-modal-header",1),e.NdJ("close",function(te){return J.closeMe(te)}),e._uU(2),e.qZA(),e.TgZ(3,"query-sharing-form",2),e.NdJ("onChange",function(te){return J.setValues(te)}),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"button",4),e.NdJ("click",function(te){return J.saveQuery(te)}),e.qZA(),e.TgZ(6,"button",5),e.NdJ("click",function(te){return J.closeMe(te)}),e.qZA(),e.qZA(),e.qZA()),2&I&&(e.xp6(2),e.Oqu(J.text.label_visibility_settings),e.xp6(1),e.Q6J("isSave",!1)("isStarred",J.isStarred)("isPublic",J.isPublic),e.xp6(2),e.Q6J("textContent",J.text.button_save),e.xp6(1),e.Q6J("textContent",J.text.button_cancel)("disabled",J.isBusy))},directives:[E.g,w],encapsulation:2});var k=t(39656);const b=["queryNameField"];class v extends m.T{constructor(I,J,N,te,ee,G,se,me,_e){super(J,me,I),this.elementRef=I,this.locals=J,this.I18n=N,this.states=te,this.querySpace=ee,this.wpListService=G,this.halNotification=se,this.cdRef=me,this.toastService=_e,this.queryName="",this.isStarred=!1,this.isPublic=!1,this.isBusy=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),save_as:this.I18n.t("js.label_save_as"),label_name:this.I18n.t("js.modals.label_name"),label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")}}setValues(I){this.isStarred=I.isStarred,this.isPublic=I.isPublic}onOpen(){this.queryNameField.nativeElement.focus()}get afterFocusOn(){return jQuery("#work-packages-settings-button")}saveQueryAs(I){if(I.preventDefault(),this.isBusy||!this.queryName)return;this.isBusy=!0;const J=this.querySpace.query.value;J.public=this.isPublic,this.wpListService.create(J,this.queryName).then(N=>this.isStarred&&!N.starred?this.wpListService.toggleStarred(N).then(()=>this.closeMe(I)):(this.closeMe(I),Promise.resolve(!0))).catch(N=>this.halNotification.handleRawError(N)).then(()=>this.isBusy=!1)}}v.\u0275fac=function(I){return new(I||v)(e.Y36(e.SBq),e.Y36(p.E),e.Y36(i.D),e.Y36(n.G),e.Y36(d.q),e.Y36(h.Z),e.Y36(C.W),e.Y36(e.sBO),e.Y36(y.kl))},v.\u0275cmp=e.Xpm({type:v,selectors:[["ng-component"]],viewQuery:function(I,J){if(1&I&&e.Gf(b,7),2&I){let N;e.iGM(N=e.CRH())&&(J.queryNameField=N.first)}},features:[e.qOj],decls:16,vars:10,consts:[["data-indicator-name","modal","name","modalSaveForm",1,"op-modal","wp-table--configuration-modal","loading-indicator--location",3,"submit"],[3,"close"],["name","modalSaveForm",1,"op-modal--body","form"],[1,"form--field","-required"],["for","save-query-name",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container"],["type","text","name","save-query-name","id","save-query-name","required","",1,"form--text-field",3,"ngModel","ngModelChange"],["queryNameField",""],[1,"form--section"],[3,"textContent"],[3,"isSave","isStarred","isPublic","onChange"],[1,"op-modal--footer"],["type","button",1,"button","-with-icon","icon-cancel",3,"textContent","click"],[1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","disabled"]],template:function(I,J){1&I&&(e.TgZ(0,"form",0),e.NdJ("submit",function(te){return J.saveQueryAs(te)}),e.TgZ(1,"op-modal-header",1),e.NdJ("close",function(te){return J.closeMe(te)}),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e._UZ(5,"label",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"input",7,8),e.NdJ("ngModelChange",function(te){return J.queryName=te}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(10,"section",9),e._UZ(11,"h3",10),e.TgZ(12,"query-sharing-form",11),e.NdJ("onChange",function(te){return J.setValues(te)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",12),e.TgZ(14,"button",13),e.NdJ("click",function(te){return J.closeMe(te)}),e.qZA(),e._UZ(15,"button",14),e.qZA(),e.qZA()),2&I&&(e.xp6(2),e.Oqu(J.text.save_as),e.xp6(3),e.Q6J("textContent",J.text.label_name),e.xp6(3),e.Q6J("ngModel",J.queryName),e.xp6(3),e.Q6J("textContent",J.text.label_visibility_settings),e.xp6(1),e.Q6J("isSave",!0)("isStarred",J.isStarred)("isPublic",J.isPublic),e.xp6(2),e.Q6J("textContent",J.text.button_cancel),e.xp6(1),e.Q6J("textContent",J.text.button_save)("disabled",J.isBusy||!J.queryName))},directives:[P._Y,P.JL,P.F,E.g,P.Fj,P.Q7,P.JJ,P.On,w],encapsulation:2});var M=t(48934);class S extends u.n{constructor(I,J,N,te,ee,G,se,me,_e){super(I,J),this.elementRef=I,this.opContextMenu=J,this.opModalService=N,this.wpListService=te,this.authorisationService=ee,this.states=G,this.injector=se,this.querySpace=me,this.I18n=_e,this.focusAfterClose=!0}ngAfterViewInit(){super.ngAfterViewInit(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(I=>{this.query=I}),this.loadingPromise=this.querySpace.queryForm.valuesPromise(),this.querySpace.queryForm.values$().pipe(this.untilDestroyed()).subscribe(I=>{this.form=I})}open(I){this.loadingPromise.then(()=>{this.buildItems(),this.opContextMenu.show(this,I)})}get locals(){return{contextMenuId:"settingsDropdown",items:this.items}}positionArgs(I){const N=super.positionArgs(I);return _.assign(N,{my:"right top",at:"right bottom"}),N}onClose(){this.focusAfterClose&&this.afterFocusOn.focus()}allowQueryAction(I,J){return this.allowAction(I,"query",J)}allowWorkPackageAction(I,J){return this.allowAction(I,"work_packages",J)}allowFormAction(I,J){return!!this.form.$links[J]||(I.stopPropagation(),!1)}allowAction(I,J,N){return!!this.authorisationService.can(J,N)||(I.stopPropagation(),!1)}buildItems(){this.items=[{disabled:!1,linkText:this.I18n.t("js.toolbar.settings.configure_view"),hidden:this.hideTableOptions,icon:"icon-settings",onClick:I=>(this.opContextMenu.close(),this.opModalService.show(l.Q,this.injector),!0)},{linkText:this.I18n.t("js.work_packages.query.insert_columns"),hidden:this.hideTableOptions,icon:"icon-columns",class:"hidden-for-mobile",onClick:()=>(this.opModalService.show(l.Q,this.injector,{initialTab:"columns"}),!0)},{linkText:this.I18n.t("js.toolbar.settings.sort_by"),hidden:this.hideTableOptions,icon:"icon-sort-by",onClick:()=>(this.opModalService.show(l.Q,this.injector,{initialTab:"sort-by"}),!0)},{linkText:this.I18n.t("js.toolbar.settings.group_by"),hidden:this.hideTableOptions,icon:"icon-group-by",class:"hidden-for-mobile",onClick:()=>(this.opModalService.show(l.Q,this.injector,{initialTab:"display-settings"}),!0)},{disabled:!this.query.id||this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.page_settings"),icon:"icon-edit",onClick:I=>(this.allowQueryAction(I,"update")&&(this.focusAfterClose=!1,jQuery(`${g.U$}`).trigger(g.mE)),!0)},{disabled:this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.save"),icon:"icon-save",onClick:I=>{const{query:J}=this;return!(0,M.Z)(J)&&this.allowQueryAction(I,"updateImmediately")?this.opModalService.show(v,this.injector):J.id&&this.allowQueryAction(I,"updateImmediately")&&this.wpListService.save(J),!0}},{disabled:this.form?!this.form.$links.create_new:this.authorisationService.cannot("query","updateImmediately"),linkText:this.I18n.t("js.toolbar.settings.save_as"),icon:"icon-save",onClick:I=>(this.allowFormAction(I,"create_new")&&this.opModalService.show(v,this.injector),!0)},{disabled:this.authorisationService.cannot("query","delete"),linkText:this.I18n.t("js.toolbar.settings.delete"),icon:"icon-delete",onClick:I=>(this.allowQueryAction(I,"delete")&&window.confirm(this.I18n.t("js.text_query_destroy_confirmation"))&&this.wpListService.delete(),!0)},{disabled:this.authorisationService.cannot("work_packages","representations"),linkText:this.I18n.t("js.toolbar.settings.export"),hidden:this.hideTableOptions,icon:"icon-export",onClick:I=>(this.allowWorkPackageAction(I,"representations")&&this.opModalService.show(k.x,this.injector),!0)},{disabled:this.authorisationService.cannot("query","unstar")&&this.authorisationService.cannot("query","star"),linkText:this.I18n.t("js.toolbar.settings.visibility_settings"),icon:"icon-watched",onClick:I=>((this.allowQueryAction(I,"unstar")||this.allowQueryAction(I,"star"))&&this.opModalService.show(x,this.injector),!0)},{divider:!0,hidden:!(this.query.results.customFields&&this.form.configureForm)},{hidden:!this.query.results.customFields||this.hideTableOptions,href:this.query.results.customFields&&this.query.results.customFields.href,linkText:this.query.results.customFields&&this.query.results.customFields.name,icon:"icon-custom-fields",onClick:()=>!1}]}}S.\u0275fac=function(I){return new(I||S)(e.Y36(e.SBq),e.Y36(r.$),e.Y36(p.S),e.Y36(h.Z),e.Y36(c.g),e.Y36(n.G),e.Y36(e.zs3),e.Y36(d.q),e.Y36(i.D))},S.\u0275dir=e.lG2({type:S,selectors:[["","opSettingsContextMenu",""]],inputs:{query:["opSettingsContextMenu-query","query"],hideTableOptions:"hideTableOptions"},features:[e.qOj]});var O=t(2775);class A{constructor(I){this.I18n=I,this.hideTableOptions=!1,this.text={button_settings:this.I18n.t("js.button_settings")}}}A.\u0275fac=function(I){return new(I||A)(e.Y36(i.D))},A.\u0275cmp=e.Xpm({type:A,selectors:[["ng-component"]],inputs:{hideTableOptions:"hideTableOptions"},decls:2,vars:2,consts:[["id","work-packages-settings-button","opSettingsContextMenu","","opSettingsContextMenu-query","query",1,"button","last","work-packages-settings-button","toolbar-icon",3,"title","hideTableOptions"],["icon-classes","button--icon icon-show-more"]],template:function(I,J){1&I&&(e.TgZ(0,"button",0),e._UZ(1,"op-icon",1),e.qZA()),2&I&&(e.s9C("title",J.text.button_settings),e.Q6J("hideTableOptions",J.hideTableOptions))},directives:[S,O.o],encapsulation:2,changeDetection:0})},96418:(H,D,t)=>{"use strict";t.d(D,{f:()=>b});t(24897);var e=t(12703),c=t(96617),u=t(50076),r=t(26942),n=t(44022),h=t(2316),a=t(54364),p=t(47775),l=t(20342),d=t(55548),g=t(36293),C=t(1403),y=t(62964),m=t(84699);class E extends d.n{constructor(M,S,O,A,F,I,J,N){super(M,S),this.elementRef=M,this.opContextMenu=S,this.$state=O,this.workPackageNotificationService=A,this.halEditing=F,this.toastService=I,this.I18n=J,this.halEvents=N}open(M){const S=this.halEditing.changeFor(this.workPackage);S.getForm().then(O=>{const A=O.schema.status.allowedValues;this.buildItems(A);const{writable:F}=S.schema.status;F?this.opContextMenu.show(this,M):this.toastService.addError(this.I18n.t("js.work_packages.message_work_package_status_blocked"))})}get locals(){return{items:this.items,contextMenuId:"wp-status-context-menu"}}updateStatus(M){const S=this.halEditing.changeFor(this.workPackage);S.projectedResource.status=M,(0,m.Z)(this.workPackage)||this.halEditing.save(S).then(()=>{this.workPackageNotificationService.showSave(this.workPackage)})}buildItems(M){this.items=M.map(S=>({disabled:!1,linkText:S.name,postIcon:S.isReadonly?"icon-locked":null,postIconTitle:this.I18n.t("js.work_packages.message_work_package_read_only"),class:u.Z.inlineClass("status",S.id),onClick:()=>(this.updateStatus(S),!0)}))}}E.\u0275fac=function(M){return new(M||E)(h.Y36(h.SBq),h.Y36(l.$),h.Y36(p.StateService),h.Y36(y.q),h.Y36(e.l),h.Y36(g.kl),h.Y36(c.D),h.Y36(C.J))},E.\u0275dir=h.lG2({type:E,selectors:[["","wpStatusDropdown",""]],inputs:{workPackage:["wpStatusDropdown-workPackage","workPackage"]},features:[h.qOj]});var P=t(2775);function w(v,M){1&v&&(h.TgZ(0,"span",6),h._UZ(1,"op-icon",7),h.qZA())}const x=function(v){return{"op-wp-status-button_small":v}};function k(v,M){if(1&v&&(h.TgZ(0,"div",1),h.TgZ(1,"button",2),h.YNc(2,w,2,0,"span",3),h._UZ(3,"span",4),h._UZ(4,"op-icon",5),h.qZA(),h.qZA()),2&v){const S=h.oxw();h.Q6J("ngClass",h.VKq(9,x,S.small)),h.uIk("title",S.buttonTitle),h.xp6(1),h.Q6J("ngClass",S.statusHighlightClass)("disabled",!S.allowed)("title",S.status.name)("wpStatusDropdown-workPackage",S.workPackage),h.uIk("aria-label",S.text.explanation),h.xp6(1),h.Q6J("ngIf",S.isReadonly),h.xp6(1),h.Q6J("textContent",S.status.name)}}class b extends r.N{constructor(M,S,O,A){super(),this.I18n=M,this.cdRef=S,this.schemaCache=O,this.halEditing=A,this.small=!1,this.text={explanation:this.I18n.t("js.label_edit_status"),workPackageReadOnly:this.I18n.t("js.work_packages.message_work_package_read_only"),workPackageStatusBlocked:this.I18n.t("js.work_packages.message_work_package_status_blocked")}}ngOnInit(){this.halEditing.temporaryEditResource(this.workPackage).values$().pipe(this.untilDestroyed()).subscribe(M=>{this.workPackage=M,this.workPackage.status&&this.workPackage.status.$load(),this.cdRef.detectChanges()})}get buttonTitle(){return this.schema.isReadonly?this.text.workPackageReadOnly:this.schema.isEditable&&!this.allowed?this.text.workPackageStatusBlocked:""}get statusHighlightClass(){const{status:M}=this;if(M)return u.Z.backgroundClass("status",M.id)}get status(){return this.workPackage.status}get isReadonly(){return this.schema.isReadonly}get allowed(){return this.schema.isAttributeEditable("status")}get schema(){return this.halEditing.typedState(this.workPackage).hasValue()?this.halEditing.typedState(this.workPackage).value.schema:this.schemaCache.of(this.workPackage)}}b.\u0275fac=function(M){return new(M||b)(h.Y36(c.D),h.Y36(h.sBO),h.Y36(n.y),h.Y36(e.l))},b.\u0275cmp=h.Xpm({type:b,selectors:[["wp-status-button"]],inputs:{workPackage:"workPackage",small:"small"},features:[h.qOj],decls:1,vars:1,consts:[["class","op-wp-status-button","data-qa-selector","op-wp-status-button",3,"ngClass",4,"ngIf"],["data-qa-selector","op-wp-status-button",1,"op-wp-status-button",3,"ngClass"],["wpStatusDropdown","",1,"op-wp-status-button--button","button",3,"ngClass","disabled","title","wpStatusDropdown-workPackage"],["class","op-wp-status-button--text button--text",4,"ngIf"],["aria-hidden","true",1,"op-wp-status-button--text","button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown"],[1,"op-wp-status-button--text","button--text"],["icon-classes","button--icon icon-locked"]],template:function(M,S){1&M&&h.YNc(0,k,5,11,"div",0),2&M&&h.Q6J("ngIf",S.status)},directives:[a.O5,a.mk,E,P.o],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-status-button--button[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;padding:5px;margin-bottom:0;background-color:var(--status-selector-bg-color);border:none;color:#fff;max-width:100%;display:flex}.op-wp-status-button--text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-wp-status-button_small[_ngcontent-%COMP%]   .op-wp-status-button--button[_ngcontent-%COMP%]{line-height:16px;font-size:12px;height:16px;padding:0 5px;margin-right:0}"]})},11266:(H,D,t)=>{"use strict";t.d(D,{h:()=>a,a:()=>p});var i=t(96617),e=t(15950),u=t(44210),r=t(2316),n=t(2775);const h=e,a="zen-mode-toggle-button";class p extends u.S{constructor(d,g){super(d),this.I18n=d,this.cdRef=g,this.buttonId="work-packages-zen-mode-toggle-button",this.buttonClass="toolbar-icon",this.iconClass="icon-zen-mode",this.activateLabel=d.t("js.zen_mode.button_activate"),this.deactivateLabel=d.t("js.zen_mode.button_deactivate");const C=this;h.enabled&&h.onchange(()=>{h.isFullscreen||C.deactivateZenMode()})}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}deactivateZenMode(){this.isActive=p.inZenMode=!1,jQuery("body").removeClass("zen-mode"),this.disabled=!1,h.enabled&&h.isFullscreen&&h.exit(),this.cdRef.detectChanges()}activateZenMode(){this.isActive=p.inZenMode=!0,jQuery("body").addClass("zen-mode"),h.enabled&&h.request(),this.cdRef.detectChanges()}performAction(d){return p.inZenMode?this.deactivateZenMode():this.activateZenMode(),d.preventDefault(),!1}}p.inZenMode=!1,p.\u0275fac=function(d){return new(d||p)(r.Y36(i.D),r.Y36(r.sBO))},p.\u0275cmp=r.Xpm({type:p,selectors:[["zen-mode-toggle-button"]],features:[r.qOj],decls:2,vars:10,consts:[["type","button",3,"disabled","click"],[3,"icon-classes"]],template:function(d,g){1&d&&(r.TgZ(0,"button",0),r.NdJ("click",function(y){return g.performAction(y)}),r._UZ(1,"op-icon",1),r.qZA()),2&d&&(r.Gre("button ",g.buttonClass,""),r.ekj("-active",g.isActive),r.Q6J("disabled",g.disabled||!g.isToggle()&&g.isActive),r.uIk("id",g.buttonId)("title",g.label)("accesskey",g.accessKey),r.xp6(1),r.MGl("icon-classes","",g.iconClass," button--icon"))},directives:[n.o],encapsulation:2,changeDetection:0})},31744:(H,D,t)=>{"use strict";t.d(D,{T:()=>E});var i=t(3786),e=t(60914),c=t(48451),u=t(11337),r=t(47775),n=t(53916),h=t(29161);class a{constructor(w,x){this.injector=w}get EVENT(){return"click.cardView.card"}get SELECTOR(){return'[data-qa-selector="op-wp-single-card"]'}eventScope(w){return jQuery(w.container.nativeElement)}handleEvent(w,x){const k=jQuery(x.target);if(k.is("a")||k.parent().is("a"))return!0;const b=k.closest("wp-single-card"),v=b.data("workPackageId");return!v||(this.handleWorkPackage(w,v,b,x),!1)}handleWorkPackage(w,x,k,b){this.setSelection(w,x,k,b),w.itemClicked.emit({workPackageId:x,double:!1})}setSelection(w,x,k,b){const v=k.data("classIdentifier"),M=this.wpCardView.findRenderedCard(v);b.ctrlKey||b.metaKey||b.shiftKey||this.wpTableSelection.setSelection(x,M),b.shiftKey&&this.wpTableSelection.setMultiSelectionFrom(this.wpCardView.renderedCards,x,M),(b.ctrlKey||b.metaKey)&&this.wpTableSelection.toggleRow(x),w.selectionChanged.emit(this.wpTableSelection.getSelectedWorkPackageIds()),this.wpTableFocus.updateFocus(x)}}(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",n.U)],a.prototype,"deviceService",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",r.StateService)],a.prototype,"$state",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",e.J)],a.prototype,"wpTableSelection",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",c.o)],a.prototype,"wpTableFocus",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",u.c)],a.prototype,"wpCardView",void 0);class p{constructor(w,x){this.injector=w}get EVENT(){return"dblclick.cardView.card"}get SELECTOR(){return'[data-qa-selector="op-wp-single-card"]'}eventScope(w){return jQuery(w.container.nativeElement)}handleEvent(w,x){const k=jQuery(x.target);if(k.is("a")||k.parent().is("a"))return!0;const v=k.closest("wp-single-card").data("workPackageId");return!v||(w.itemClicked.emit({workPackageId:v,double:!0}),!1)}}(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",r.StateService)],p.prototype,"$state",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",e.J)],p.prototype,"wpTableSelection",void 0);var l=t(20506),d=t(3352),g=t(20342),C=t(99794);class y{constructor(w,x){this.injector=w}get EVENT(){return"contextmenu.cardView.rightclick"}get SELECTOR(){return'[data-qa-selector="op-wp-single-card"]'}eventScope(w){return jQuery(w.container.nativeElement)}handleEvent(w,x){const k=jQuery(x.target);if(k.closest(`.${l.yF}`).length)return(0,d.qu)("Allowing original context menu on state link"),!0;x.preventDefault(),x.stopPropagation();const b=k.closest("wp-single-card"),v=b.data("workPackageId");if(!v)return!0;const M=b.data("classIdentifier"),S=this.wpCardView.findRenderedCard(M);this.wpTableSelection.isSelected(v)||this.wpTableSelection.setSelection(v,S);const O=new C.X(this.injector,v,jQuery(x.target),{},w.showInfoButton);return this.opContextMenu.show(O,x),!1}}(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",e.J)],y.prototype,"wpTableSelection",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",u.c)],y.prototype,"wpCardView",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",g.$)],y.prototype,"opContextMenu",void 0);var m=t(55236);class E extends m.A{constructor(){super(...arguments),this.eventHandlers=[w=>new a(this.injector,w),w=>new p(this.injector,w),w=>new y(this.injector,w)]}}},79460:(H,D,t)=>{"use strict";t.d(D,{q:()=>C});var i=t(3786),e=t(95846),c=t(87853),u=t(63829),r=t(8403),n=t(45237),h=t(68354),a=t(20979),p=t(65146),l=t(62964),d=t(84699),g=t(2316);class C{constructor(m,E,P,w,x,k,b,v,M){this.states=m,this.injector=E,this.reorderService=P,this.wpCreate=w,this.notificationService=x,this.apiV3Service=k,this.currentProject=b,this.dragService=v,this.wpInlineCreate=M}init(m){this.cardView=m}destroy(){null!==this.dragService&&this.dragService.remove(this.cardView.container.nativeElement)}registerDragAndDrop(){null!==this.dragService&&this.dragService.register({dragContainer:this.cardView.container.nativeElement,scrollContainers:[this.cardView.container.nativeElement],moves:m=>{const E=m.dataset.workPackageId,P=this.states.workPackages.get(E).value;return!!P&&this.cardView.canDragOutOf(P)&&!m.dataset.isNew},accepts:()=>this.cardView.dragInto,onMoved:m=>(0,i.mG)(this,void 0,void 0,function*(){const E=m.dataset.workPackageId,P=(0,h.c)(m),w=yield this.reorderService.move(this.currentOrder,E,P);this.updateOrder(w),this.cardView.onMoved.emit()}),onRemoved:m=>{const E=m.dataset.workPackageId,P=this.reorderService.remove(this.currentOrder,E);this.updateOrder(P)},onAdded:m=>(0,i.mG)(this,void 0,void 0,function*(){const E=m.dataset.workPackageId,P=(0,h.c)(m),w=yield this.apiV3Service.work_packages.id(E).get().toPromise(),x=yield this.addWorkPackageToQuery(w,P);return m.parentElement&&m.parentElement.removeChild(m),x})})}get workPackages(){return this._workPackages}set workPackages(m){if(this.activeInlineCreateWp){const E=this._workPackages.find(P=>(0,d.Z)(P));if(E){const P=this._workPackages.indexOf(E);this._workPackages[P]=this.activeInlineCreateWp}else this._workPackages=[this.activeInlineCreateWp,...m]}else this._workPackages=[...m]}get currentOrder(){return this.workPackages.filter(m=>m&&!(0,d.Z)(m)).map(m=>m.id)}updateOrder(m){m=_.uniq(m),Promise.all(m.map(E=>this.apiV3Service.work_packages.id(E).get().toPromise())).then(E=>{this.workPackages=E,this.cardView.cdRef.detectChanges()})}addNewCard(){this.wpCreate.createOrContinueWorkPackage(this.currentProject.identifier).then(m=>{this.activeInlineCreateWp=m.projectedResource,this.workPackages=this.workPackages,this.cardView.cdRef.detectChanges()})}addWorkPackageToQuery(m,E=-1){return(0,i.mG)(this,void 0,void 0,function*(){try{yield this.cardView.workPackageAddedHandler(m);const P=yield this.reorderService.add(this.currentOrder,m.id,E);return this.updateOrder(P),!0}catch(P){this.notificationService.handleRawError(P,m)}return!1})}removeReferenceWorkPackageForm(){this.activeInlineCreateWp&&this.removeCard(this.activeInlineCreateWp)}removeCard(m){const E=this.workPackages.indexOf(m);if(this.workPackages.splice(E,1),this.activeInlineCreateWp=void 0,!(0,d.Z)(m)){const P=this.reorderService.remove(this.currentOrder,m.id);this.updateOrder(P)}}onCardSaved(m){return(0,i.mG)(this,void 0,void 0,function*(){const E=this.workPackages.findIndex(P=>"new"===P.id);if(-1!==E){this.activeInlineCreateWp=void 0;const P=yield this.reorderService.add(this.currentOrder,m.id,E);this.updateOrder(P),this.wpInlineCreate.newInlineWorkPackageCreated.next(m.id)}})}}C.\u0275fac=function(m){return new(m||C)(g.LFG(c.G),g.LFG(g.zs3),g.LFG(e.M),g.LFG(u.P),g.LFG(l.q),g.LFG(a.T),g.LFG(p.R),g.LFG(n.j,8),g.LFG(r.m))},C.\u0275prov=g.Yz7({token:C,factory:C.\u0275fac})},11337:(H,D,t)=>{"use strict";t.d(D,{c:()=>c});var i=t(43440),e=t(2316);class c{constructor(r){this.querySpace=r}classIdentifier(r){return`wp-row-${r.id}`}get renderedCards(){return this.querySpace.tableRendered.getValueOr([])}findRenderedCard(r){return _.findIndex(this.renderedCards,h=>h.classIdentifier===r)}updateRenderedCardsValues(r){this.querySpace.tableRendered.putValue(r.map(n=>({classIdentifier:this.classIdentifier(n),workPackageId:n.id,hidden:!1})))}}c.\u0275fac=function(r){return new(r||c)(e.LFG(i.q))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac})},91488:(H,D,t)=>{"use strict";t.d(D,{x:()=>G});var i=t(3786),e=t(2316),c=t(43440),u=t(96617),r=t(8403),n=t(63829),h=t(43682),a=t(7493),p=t(47775),l=t(87853),d=t(95846),g=t(70233),C=t(33927),y=t(9170),m=t(17163),E=t(64538),P=t(60914),w=t(31744),x=t(11337),k=t(79460),b=t(62964),v=t(53916),M=t(55236),S=t(26942),O=t(38519),A=t(1403),F=t(84699);const I=["container"];function J(se,me){if(1&se&&(e.TgZ(0,"div",5),e._UZ(1,"ndc-dynamic",6),e.qZA()),2&se){const _e=e.oxw();e.xp6(1),e.Q6J("ndcDynamicComponent",_e.referenceClass)("ndcDynamicInjector",_e.injector)("ndcDynamicOutputs",_e.referenceOutputs)}}function N(se,me){1&se&&e._UZ(0,"hr",9)}function te(se,me){if(1&se){const _e=e.EpF();e.ynx(0),e.TgZ(1,"wp-single-card",7),e.NdJ("onRemove",function(){const re=e.CHM(_e).$implicit;return e.oxw().removeCard(re)})("stateLinkClicked",function(ae){return e.CHM(_e),e.oxw().stateLinkClicked.emit(ae)}),e.qZA(),e.YNc(2,N,1,0,"hr",8),e.BQk()}if(2&se){const _e=me.$implicit,he=e.oxw();e.xp6(1),e.Q6J("workPackage",_e)("showInfoButton",he.showInfoButton)("showStatusButton",he.showStatusButton)("showRemoveButton",he.cardsRemovable)("highlightingMode",he.highlightingMode)("draggable",he.canDragOutOf(_e))("orientation",he.orientation)("shrinkOnMobile",he.shrinkOnMobile),e.uIk("data-is-new",he.isNewResource(_e)||void 0)("data-work-package-id",_e.id)("data-class-identifier",he.cardView.classIdentifier(_e)),e.xp6(1),e.Q6J("ngIf",he.shrinkOnMobile)}}function ee(se,me){if(1&se&&(e.TgZ(0,"div"),e._UZ(1,"no-results",10),e.qZA()),2&se){const _e=e.oxw();e.xp6(1),e.Q6J("title",_e.text.noResults.title)("description",_e.text.noResults.description)}}class G extends S.N{constructor(me,_e,he,ae,re,ye,Ce,ke,Ae,Fe,ot,it,Ve,Ie,ue,ie,R,L){super(),this.querySpace=me,this.states=_e,this.injector=he,this.$state=ae,this.I18n=re,this.wpCreate=ye,this.wpInlineCreate=Ce,this.notificationService=ke,this.halEvents=Ae,this.authorisationService=Fe,this.causedUpdates=ot,this.cdRef=it,this.pathHelper=Ve,this.wpTableSelection=Ie,this.wpViewOrder=ue,this.cardView=ie,this.cardDragDrop=R,this.deviceService=L,this.showStatusButton=!0,this.showInfoButton=!1,this.orientation="vertical",this.cardsRemovable=!1,this.showEmptyResultsBox=!1,this.shrinkOnMobile=!1,this.onMoved=new e.vpe,this.selectionChanged=new e.vpe,this.itemClicked=new e.vpe,this.stateLinkClicked=new e.vpe,this.trackByHref=(0,h.WJ)("lockVersion"),this.isResultEmpty=!1,this.text={removeCard:this.I18n.t("js.card.remove_from_list"),addNewCard:this.I18n.t("js.card.add_new"),noResults:{title:this.I18n.t("js.work_packages.no_results.title"),description:this.I18n.t("js.work_packages.no_results.description")}},this.canAdd=!1,this.canReference=!1,this.inReference=!1,this.referenceClass=this.wpInlineCreate.referenceComponentClass,this.referenceOutputs={onCancel:()=>this.setReferenceMode(!1),onReferenced:W=>this.cardDragDrop.addWorkPackageToQuery(W,0)},this.isNewResource=F.Z}ngOnInit(){this.registerCreationCallback(),this.authorisationService.observeUntil((0,O.J6)(this)).subscribe(()=>{this.canAdd=this.wpInlineCreate.canAdd,this.canReference=this.wpInlineCreate.canReference,this.cdRef.detectChanges()}),this.halEvents.aggregated$("WorkPackage").pipe((0,C.U)(me=>me.filter(_e=>"updated"===_e.eventType)),(0,y.h)(me=>{const _e=this.workPackages.map(he=>he.id.toString());return!!me.find(he=>-1!==_e.indexOf(he.id))})).subscribe(()=>{this.workPackages=this.workPackages.map(me=>this.states.workPackages.get(me.id).getValueOr(me)),this.cdRef.detectChanges()}),this.querySpace.results.values$().pipe((0,m.M)(this.querySpace.query.values$()),this.untilDestroyed()).subscribe(([me,_e])=>{this.query=_e,this.workPackages=this.wpViewOrder.orderedWorkPackages(),this.cardView.updateRenderedCardsValues(this.workPackages),this.isResultEmpty=0===this.workPackages.length,this.cdRef.detectChanges()})}ngAfterViewInit(){this.cardDragDrop.init(this),this.deviceService.isMobile||this.cardDragDrop.registerDragAndDrop();const me=this.injector.get(M.m,w.T);me instanceof w.T?me.attachTo(this):new me(this.injector).attachTo(this),this.wpTableSelection.registerSelectAllListener(()=>this.cardView.renderedCards),this.wpTableSelection.registerDeselectAllListener()}ngOnDestroy(){super.ngOnDestroy(),this.cardDragDrop.destroy()}get workPackages(){return this.cardDragDrop.workPackages}set workPackages(me){this.cardDragDrop.workPackages=me}setReferenceMode(me){this.inReference=me,this.cdRef.detectChanges()}addNewCard(){this.cardDragDrop.addNewCard()}removeCard(me){this.cardDragDrop.removeCard(me)}onCardSaved(me){return(0,i.mG)(this,void 0,void 0,function*(){yield this.cardDragDrop.onCardSaved(me)})}classes(){let me="wp-cards-container ";return me+=`-${this.orientation}`,me+=this.shrinkOnMobile?" -shrink":"",me}registerCreationCallback(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(me=>(0,i.mG)(this,void 0,void 0,function*(){this.onCardSaved(me)}))}}G.\u0275fac=function(me){return new(me||G)(e.Y36(c.q),e.Y36(l.G),e.Y36(e.zs3),e.Y36(p.StateService),e.Y36(u.D),e.Y36(n.P),e.Y36(r.m),e.Y36(b.q),e.Y36(A.J),e.Y36(a.g),e.Y36(E.h),e.Y36(e.sBO),e.Y36(g.j),e.Y36(P.J),e.Y36(d.M),e.Y36(x.c),e.Y36(k.q),e.Y36(v.U))},G.\u0275cmp=e.Xpm({type:G,selectors:[["wp-card-view"]],viewQuery:function(me,_e){if(1&me&&e.Gf(I,7),2&me){let he;e.iGM(he=e.CRH())&&(_e.container=he.first)}},inputs:{canDragOutOf:["dragOutOfHandler","canDragOutOf"],dragInto:"dragInto",highlightingMode:"highlightingMode",workPackageAddedHandler:"workPackageAddedHandler",showStatusButton:"showStatusButton",showInfoButton:"showInfoButton",orientation:"orientation",cardsRemovable:"cardsRemovable",showEmptyResultsBox:"showEmptyResultsBox",shrinkOnMobile:"shrinkOnMobile"},outputs:{onMoved:"onMoved",selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[e.qOj],decls:5,vars:5,consts:[["data-qa-selector","op-wp-card-view",3,"ngClass"],["container",""],["class","wp-inline-create--reference-container",4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"wp-inline-create--reference-container"],[3,"ndcDynamicComponent","ndcDynamicInjector","ndcDynamicOutputs"],[3,"workPackage","showInfoButton","showStatusButton","showRemoveButton","highlightingMode","draggable","orientation","shrinkOnMobile","onRemove","stateLinkClicked"],["class","form--separator hidden-for-desktop",4,"ngIf"],[1,"form--separator","hidden-for-desktop"],[3,"title","description"]],template:function(me,_e){1&me&&(e.TgZ(0,"div",0,1),e.YNc(2,J,2,3,"div",2),e.YNc(3,te,3,12,"ng-container",3),e.qZA(),e.YNc(4,ee,2,2,"div",4)),2&me&&(e.Q6J("ngClass",_e.classes()),e.xp6(2),e.Q6J("ngIf",_e.inReference),e.xp6(1),e.Q6J("ngForOf",_e.workPackages)("ngForTrackBy",_e.trackByHref),e.xp6(1),e.Q6J("ngIf",_e.showEmptyResultsBox&&_e.isResultEmpty))},styles:[".wp-inline-create-button[_ngcontent-%COMP%]{font-size:.9rem;padding-top:1rem;text-align:center}.wp-inline-create--reference-container[_ngcontent-%COMP%]{margin-bottom:3rem;margin-top:10px}",".wp-cards-container.-horizontal[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));grid-column-gap:10px;grid-row-gap:10px;margin-right:5px}@media only screen and (max-width: 679px){.wp-cards-container.-horizontal.-shrink[_ngcontent-%COMP%]{grid-template-columns:1fr;grid-row-gap:0;margin-right:0}.wp-cards-container.-horizontal.-shrink[_ngcontent-%COMP%]   .form--separator[_ngcontent-%COMP%]{margin-bottom:0}}",".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.wp-cards-container.-vertical[_ngcontent-%COMP%]{height:100%;padding:0 15px;border-radius:2px;overflow-y:scroll;scrollbar-color:transparent transparent;scrollbar-width:thin}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.wp-cards-container.-vertical[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.wp-cards-container.-vertical[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.wp-cards-container.-vertical[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}"],changeDetection:0})},37409:(H,D,t)=>{"use strict";t.d(D,{P:()=>_e});var i=t(2316),e=t(20506),c=t(70233),u=t(50076),r=t(47775),n=t(60914),h=t(11337),a=t(96617),p=t(26942),l=t(48451),g=(t(24897),t(67325)),C=t(84699),y=t(70692),m=t(61486),E=t(33927),P=t(54364),w=t(2775),x=t(61342),k=t(54262),b=t(96418),v=t(3742);function M(he,ae){if(1&he){const re=i.EpF();i.TgZ(0,"button",9),i.NdJ("click",function(Ce){i.CHM(re);const ke=i.oxw();return ke.emitStateLinkClicked(Ce,ke.workPackage,!0)}),i._UZ(1,"op-icon",10),i.qZA()}if(2&he){const re=i.oxw();i.Q6J("title",re.text.detailsView)}}function S(he,ae){if(1&he){const re=i.EpF();i.TgZ(0,"button",11),i.NdJ("click",function(){i.CHM(re);const Ce=i.oxw();return Ce.onRemoved(Ce.workPackage)}),i._UZ(1,"op-icon",12),i.qZA()}if(2&he){const re=i.oxw();i.ekj("-show",re.isNewResource(re.workPackage)),i.Q6J("title",re.text.removeCard)}}function O(he,ae){if(1&he&&i._UZ(0,"op-icon",13),2&he){const re=i.oxw();i.Q6J("ngClass","tooltip--"+re.disabledInfo.orientation),i.uIk("data-tooltip",re.disabledInfo.text)}}function A(he,ae){if(1&he&&(i.TgZ(0,"edit-form",14),i.TgZ(1,"div",15),i._UZ(2,"editable-attribute-field",16),i._UZ(3,"editable-attribute-field",17),i.qZA(),i.qZA()),2&he){const re=i.oxw();i.Q6J("resource",re.workPackage)("inEditMode",re.isNewResource(re.workPackage)),i.xp6(2),i.Q6J("resource",re.workPackage)("wrapperClasses","work-packages--type-selector")("fieldName","type"),i.xp6(1),i.Q6J("resource",re.workPackage)}}function F(he,ae){if(1&he&&(i.TgZ(0,"span",29),i._uU(1),i.qZA()),2&he){const re=i.oxw(2);i.xp6(1),i.hij(" ",re.startDate(re.workPackage)," - ")}}function I(he,ae){if(1&he&&i._UZ(0,"span",30),2&he){const re=i.oxw(2);i.Q6J("textContent",re.wpTypeAttribute(re.workPackage))("ngClass",re.typeHighlightingClass(re.workPackage))}}function J(he,ae){if(1&he&&(i.TgZ(0,"span",29),i._uU(1),i.qZA()),2&he){const re=i.oxw(2);i.xp6(1),i.hij(" - ",re.endDate(re.workPackage)," ")}}function N(he,ae){if(1&he&&i._UZ(0,"img",31),2&he){const re=i.oxw(2);i.Q6J("src",re.bcfSnapshotPath(re.workPackage),i.LSH)}}function te(he,ae){if(1&he&&i._UZ(0,"wp-status-button",32),2&he){const re=i.oxw(2);i.Q6J("workPackage",re.workPackage)("small",!0)}}function ee(he,ae){if(1&he&&i._UZ(0,"op-principal",33),2&he){const re=i.oxw(2);i.Q6J("principal",re.workPackage.assignee)("hideName",!0)("link",!1)}}function G(he,ae){if(1&he&&i._UZ(0,"span",34),2&he){const re=i.oxw(2);i.Q6J("textContent",re.wpDates(re.workPackage))("ngClass",re.wpOverDueHighlighting(re.workPackage))}}const se=function(he){return{"op-wp-single-card--content-project-name_hideable":he}};function me(he,ae){if(1&he){const re=i.EpF();i.TgZ(0,"div",18),i.TgZ(1,"span",19),i._uU(2),i.qZA(),i.TgZ(3,"a",20),i.NdJ("click",function(Ce){i.CHM(re);const ke=i.oxw();return ke.emitStateLinkClicked(Ce,ke.workPackage)}),i._uU(4),i.qZA(),i.TgZ(5,"span",21),i.YNc(6,F,2,1,"span",22),i.YNc(7,I,1,2,"span",23),i._UZ(8,"span",24),i.YNc(9,J,2,1,"span",22),i.qZA(),i.YNc(10,N,1,1,"img",25),i.YNc(11,te,1,2,"wp-status-button",26),i.YNc(12,ee,1,3,"op-principal",27),i.YNc(13,G,1,2,"span",28),i.qZA()}if(2&he){const re=i.oxw();i.xp6(1),i.Q6J("ngClass",i.VKq(13,se,re.showInfoButton||re.showRemoveButton)),i.xp6(1),i.hij(" - ",re.wpProjectName(re.workPackage)," "),i.xp6(1),i.Q6J("href",re.fullWorkPackageLink(re.workPackage),i.LSH)("ngClass",re.uiStateLinkClass),i.xp6(1),i.hij(" #",re.workPackage.id," "),i.xp6(2),i.Q6J("ngIf",re.showAsInlineCard&&re.showStartDate),i.xp6(1),i.Q6J("ngIf",!re.showAsInlineCard&&"type"!==re.highlightingMode),i.xp6(1),i.Q6J("textContent",re.wpSubject(re.workPackage)),i.xp6(1),i.Q6J("ngIf",re.showAsInlineCard&&re.showEndDate),i.xp6(1),i.Q6J("ngIf",re.cardCoverImageShown(re.workPackage)&&!re.showAsInlineCard),i.xp6(1),i.Q6J("ngIf",re.showStatusButton),i.xp6(1),i.Q6J("ngIf",re.workPackage.assignee),i.xp6(1),i.Q6J("ngIf",!re.showAsInlineCard)}}class _e extends p.N{constructor(ae,re,ye,Ce,ke,Ae,Fe,ot,it){super(),this.pathHelper=ae,this.I18n=re,this.$state=ye,this.uiRouterGlobals=Ce,this.wpTableSelection=ke,this.wpTableFocus=Ae,this.cardView=Fe,this.cdRef=ot,this.timezoneService=it,this.selectedWhenOpen=!1,this.showInfoButton=!1,this.showStatusButton=!0,this.showRemoveButton=!1,this.highlightingMode="inline",this.draggable=!1,this.orientation="vertical",this.shrinkOnMobile=!1,this.showAsInlineCard=!1,this.showStartDate=!0,this.showEndDate=!0,this.isClosed=!1,this.showAsGhost=!1,this.onRemove=new i.vpe,this.stateLinkClicked=new i.vpe,this.cardClicked=new i.vpe,this.cardContextMenu=new i.vpe,this.uiStateLinkClass=e.yF,this.selected=!1,this.text={removeCard:this.I18n.t("js.card.remove_from_list"),detailsView:this.I18n.t("js.button_open_details")},this.isNewResource=C.Z,this.dateTimeFormatYear=new Intl.DateTimeFormat(this.I18n.locale,{year:"numeric",month:"short",day:"numeric"}),this.dateTimeFormat=new Intl.DateTimeFormat(this.I18n.locale,{month:"short",day:"numeric"})}ngOnInit(){(0,m.aj)([this.wpTableSelection.live$(),this.uiRouterGlobals.params$]).pipe(this.untilDestroyed(),(0,E.U)(()=>this.selectedWhenOpen?this.uiRouterGlobals.params.workPackageId===this.workPackage.id:this.wpTableSelection.isSelected(this.workPackage.id))).subscribe(ae=>{this.selected=ae,this.cdRef.detectChanges()})}classIdentifier(ae){return this.cardView.classIdentifier(ae)}emitStateLinkClicked(ae,re,ye){if((0,g.F)(ae))return;const Ce=this.classIdentifier(re),ke=ye?"split":"show";this.wpTableSelection.setSelection(re.id,this.cardView.findRenderedCard(Ce)),this.wpTableFocus.updateFocus(re.id),this.stateLinkClicked.emit({workPackageId:re.id,requestedState:ke}),ae.preventDefault()}cardClasses(){const ae="op-wp-single-card";return{[`${ae}_selected`]:this.selected,[`${ae}_draggable`]:this.draggable,[`${ae}_new`]:(0,C.Z)(this.workPackage),[`${ae}_shrink`]:this.shrinkOnMobile,[`${ae}_inline`]:this.showAsInlineCard,[`${ae}_closed`]:this.isClosed,[`${ae}_ghosted`]:this.showAsGhost,[`${ae}-${this.workPackage.id}`]:!!this.workPackage.id,[`${ae}_${this.orientation}`]:!0}}cardTitle(){return`${this.workPackage.subject} (${this.workPackage.status.name})`}wpTypeAttribute(ae){return ae.type.name}wpSubject(ae){return ae.subject}wpProjectName(ae){var re;return null===(re=ae.project)||void 0===re?void 0:re.name}wpDates(ae){const{startDate:re,dueDate:ye}=ae;return re&&ye?String(this.dateTimeFormatYear.formatRange(new Date(re),new Date(ye))):!re&&ye?`\u2013 ${this.dateTimeFormatYear.format(new Date(ye))}`:re&&!ye?`${this.dateTimeFormatYear.format(new Date(re))} \u2013`:""}startDate(ae){const{startDate:re}=ae;return re?this.dateTimeFormat.format(new Date(re)):""}endDate(ae){const{dueDate:re}=ae;return re?this.dateTimeFormat.format(new Date(re)):""}wpOverDueHighlighting(ae){const re=this.timezoneService.daysFromToday(ae.dueDate);return u.Z.overdueDate(re)}fullWorkPackageLink(ae){return this.$state.href("work-packages.show",{workPackageId:ae.id})}cardHighlightingClass(ae){return this.cardHighlighting(ae)}typeHighlightingClass(ae){return this.attributeHighlighting("type",ae)}onRemoved(ae){this.onRemove.emit(ae)}cardCoverImageShown(ae){return null!==this.bcfSnapshotPath(ae)}bcfSnapshotPath(ae){return ae.bcfViewpoints&&ae.bcfViewpoints.length>0?`${ae.bcfViewpoints[0].href}/snapshot`:null}cardHighlighting(ae){return["status","priority","type"].includes(this.highlightingMode)?u.Z.backgroundClass(this.highlightingMode,ae[this.highlightingMode].id):""}attributeHighlighting(ae,re){return u.Z.inlineClass(ae,re.type.id)}}_e.\u0275fac=function(ae){return new(ae||_e)(i.Y36(c.j),i.Y36(a.D),i.Y36(r.StateService),i.Y36(r.UIRouterGlobals),i.Y36(n.J),i.Y36(l.o),i.Y36(h.c),i.Y36(i.sBO),i.Y36(y.B))},_e.\u0275cmp=i.Xpm({type:_e,selectors:[["wp-single-card"]],inputs:{workPackage:"workPackage",selectedWhenOpen:"selectedWhenOpen",showInfoButton:"showInfoButton",showStatusButton:"showStatusButton",showRemoveButton:"showRemoveButton",highlightingMode:"highlightingMode",draggable:"draggable",orientation:"orientation",shrinkOnMobile:"shrinkOnMobile",disabledInfo:"disabledInfo",showAsInlineCard:"showAsInlineCard",showStartDate:"showStartDate",showEndDate:"showEndDate",isClosed:"isClosed",showAsGhost:"showAsGhost"},outputs:{onRemove:"onRemove",stateLinkClicked:"stateLinkClicked",cardClicked:"cardClicked",cardContextMenu:"cardContextMenu"},features:[i.qOj],decls:9,vars:10,consts:[["data-qa-selector","op-wp-single-card",1,"op-wp-single-card",3,"ngClass","title","click","contextmenu"],[1,"op-wp-single-card--highlighting",3,"ngClass"],[1,"op-wp-single-card--card-actions"],["data-qa-selector","op-wp-single-card--inline-buttons",1,"op-wp-single-card--inline-buttons","hidden-for-mobile"],["type","button","class","spot-link op-wp-single-card--details-button op-wp-single-card--card-action","data-qa-selector","op-wp-single-card--details-button",3,"title","click",4,"ngIf"],["class","spot-link op-wp-single-card--inline-cancel-button op-wp-single-card--card-action","data-qa-selector","op-wp-single-card--inline-cancel-button",3,"-show","title","click",4,"ngIf"],["class","-multiline op-wp-single-card--card-action op-wp-single-card--card-action_closed","icon-classes","icon-context icon-not-supported",3,"ngClass",4,"ngIf"],[3,"resource","inEditMode",4,"ngIf"],["class","op-wp-single-card--content",4,"ngIf"],["type","button","data-qa-selector","op-wp-single-card--details-button",1,"spot-link","op-wp-single-card--details-button","op-wp-single-card--card-action",3,"title","click"],["icon-classes","icon3 icon-info2"],["data-qa-selector","op-wp-single-card--inline-cancel-button",1,"spot-link","op-wp-single-card--inline-cancel-button","op-wp-single-card--card-action",3,"title","click"],["icon-classes","icon-context icon-close"],["icon-classes","icon-context icon-not-supported",1,"-multiline","op-wp-single-card--card-action","op-wp-single-card--card-action_closed",3,"ngClass"],[3,"resource","inEditMode"],[1,"op-wp-single-card-content","-new"],[1,"op-wp-single-card-content--type",3,"resource","wrapperClasses","fieldName"],["fieldName","subject",1,"op-wp-single-card-content--subject","-bold",3,"resource"],[1,"op-wp-single-card--content"],[1,"op-wp-single-card--content-project-name",3,"ngClass"],[1,"op-wp-single-card--content-id",3,"href","ngClass","click"],[1,"op-wp-single-card--content-subject-line"],["class","op-wp-single-card--content-inline-date",4,"ngIf"],["class","op-wp-single-card--content-type","data-qa-selector","op-wp-single-card--content-type",3,"textContent","ngClass",4,"ngIf"],["data-qa-selector","op-wp-single-card--content-subject",1,"op-wp-single-card--content-subject",3,"textContent"],["class","op-wp-single-card--content-cover-image",3,"src",4,"ngIf"],["class","op-wp-single-card--content-status",3,"workPackage","small",4,"ngIf"],["size","mini","class","op-wp-single-card--content-assignee","data-qa-selector","op-wp-single-card--content-assignee",3,"principal","hideName","link",4,"ngIf"],["class","op-wp-single-card--content-dates",3,"textContent","ngClass",4,"ngIf"],[1,"op-wp-single-card--content-inline-date"],["data-qa-selector","op-wp-single-card--content-type",1,"op-wp-single-card--content-type",3,"textContent","ngClass"],[1,"op-wp-single-card--content-cover-image",3,"src"],[1,"op-wp-single-card--content-status",3,"workPackage","small"],["size","mini","data-qa-selector","op-wp-single-card--content-assignee",1,"op-wp-single-card--content-assignee",3,"principal","hideName","link"],[1,"op-wp-single-card--content-dates",3,"textContent","ngClass"]],template:function(ae,re){1&ae&&(i.TgZ(0,"div",0),i.NdJ("click",function(Ce){return re.cardClicked.emit({workPackageId:re.workPackage.id,event:Ce})})("contextmenu",function(Ce){return re.cardContextMenu.emit({workPackageId:re.workPackage.id,event:Ce})}),i._UZ(1,"div",1),i.TgZ(2,"div",2),i.TgZ(3,"div",3),i.YNc(4,M,2,1,"button",4),i.YNc(5,S,2,3,"button",5),i.YNc(6,O,1,2,"op-icon",6),i.qZA(),i.qZA(),i.YNc(7,A,4,6,"edit-form",7),i.YNc(8,me,14,15,"div",8),i.qZA()),2&ae&&(i.Q6J("ngClass",re.cardClasses())("title",re.cardTitle()),i.uIk("data-qa-draggable",re.draggable||void 0)("data-qa-selected",re.selected||void 0),i.xp6(1),i.Q6J("ngClass",re.cardHighlightingClass(re.workPackage)),i.xp6(3),i.Q6J("ngIf",!re.isNewResource(re.workPackage)&&re.showInfoButton),i.xp6(1),i.Q6J("ngIf",re.isNewResource(re.workPackage)||re.showRemoveButton),i.xp6(1),i.Q6J("ngIf",re.disabledInfo&&re.disabledInfo.text.length>0),i.xp6(1),i.Q6J("ngIf",re.isNewResource(re.workPackage)),i.xp6(1),i.Q6J("ngIf",!re.isNewResource(re.workPackage)))},directives:[P.mk,P.O5,w.o,x.n,k.k,b.f,v.N],styles:['.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-single-card[_ngcontent-%COMP%]{display:flex;-webkit-user-select:none;user-select:none;width:calc(100% - 2px);border:1px solid var(--widget-box-block-border-color);border-radius:2px;padding:10px;position:relative;box-shadow:1px 1px 3px #d3d3d3;background:var(--body-background);font-size:var(--card-font-size)}.op-wp-single-card[_ngcontent-%COMP%]:hover   .op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{opacity:1;z-index:2;background-image:linear-gradient(to left,white,rgba(255,255,255,0))}.op-wp-single-card_new[_ngcontent-%COMP%]{padding-right:25px}.op-wp-single-card_ghosted[_ngcontent-%COMP%]{opacity:.5}.op-wp-single-card_selected[_ngcontent-%COMP%]{background-color:#d1e5f5}.op-wp-single-card_selected[_ngcontent-%COMP%]   .op-icon--wrapper[_ngcontent-%COMP%]{background:#d1e5f5}.op-wp-single-card_selected[_ngcontent-%COMP%]:hover   .op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{background-image:linear-gradient(to left,#d1e5f5,rgba(209,229,245,0))}.op-wp-single-card_closed[_ngcontent-%COMP%]:not(.op-wp-single-card_selected){background-color:#f3f3f3}.op-wp-single-card_closed[_ngcontent-%COMP%]:not(.op-wp-single-card_selected)   .op-icon--wrapper[_ngcontent-%COMP%]{background:#f3f3f3}.op-wp-single-card_closed[_ngcontent-%COMP%]:not(.op-wp-single-card_selected):hover   .op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{background-image:linear-gradient(to left,#f3f3f3,rgba(243,243,243,0))}.op-wp-single-card_horizontal[_ngcontent-%COMP%]{height:100%}.op-wp-single-card_vertical[_ngcontent-%COMP%]{margin-top:10px}.op-wp-single-card_vertical[_ngcontent-%COMP%]:last-of-type{margin-bottom:5px}.op-wp-single-card_inline[_ngcontent-%COMP%]   .op-wp-single-card--content[_ngcontent-%COMP%]{grid-template-columns:max-content max-content auto auto 1fr;grid-template-rows:auto max-content;grid-template-areas:"status id project project project" "subject subject subject subject subject"}.op-wp-single-card_inline[_ngcontent-%COMP%]   .op-wp-single-card--content-assignee[_ngcontent-%COMP%]{display:none}.op-wp-single-card_inline[_ngcontent-%COMP%]   .op-wp-single-card--content-subject-line[_ngcontent-%COMP%]{display:flex}.op-wp-single-card_inline[_ngcontent-%COMP%]   .op-wp-single-card--content-subject[_ngcontent-%COMP%]{flex-grow:1;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}wp-single-card.gu-transit[_nghost-%COMP%]   .op-wp-single-card[_ngcontent-%COMP%]{border:1px dashed var(--primary-color);pointer-events:none}wp-single-card.gu-transit[_nghost-%COMP%]   .op-wp-single-card[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{visibility:hidden}.op-wp-single-card--content[_ngcontent-%COMP%]:not(.-new){display:grid;grid-template-columns:max-content max-content auto auto 1fr;grid-template-rows:auto max-content max-content 1fr;grid-row-gap:5px;grid-column-gap:5px;grid-template-areas:"status id project project project" "subject subject subject subject subject" "image image image image image" "avatar avatar avatar dates dates";overflow:hidden;flex-grow:1;font-size:14px;line-height:16px}.op-wp-single-card--content-project-name[_ngcontent-%COMP%]{grid-area:project;font-style:italic;color:#878787;font-size:12px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.op-wp-single-card--content-type[_ngcontent-%COMP%]{grid-area:type;margin-right:4px}.op-wp-single-card--content-subject-line[_ngcontent-%COMP%]{grid-area:subject;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis}.op-wp-single-card--content-assignee[_ngcontent-%COMP%]{grid-area:avatar;max-width:140px;color:#878787;font-size:12px}.op-wp-single-card--content-id[_ngcontent-%COMP%]{grid-area:id;color:#878787;font-size:12px}.op-wp-single-card--content-status[_ngcontent-%COMP%]{grid-area:status;margin-right:5px;max-width:92px;overflow:hidden}.op-wp-single-card--content-cover-image[_ngcontent-%COMP%]{grid-area:image;max-height:350px}@media screen and (max-width: 679px){.op-wp-single-card--content-cover-image[_ngcontent-%COMP%]{max-height:250px}}.op-wp-single-card--content-dates[_ngcontent-%COMP%]{grid-area:dates;place-self:center end;white-space:nowrap;color:#878787;font-size:12px}.op-wp-single-card--content-inline-date[_ngcontent-%COMP%]{font-size:12px;color:#878787;margin:0 8px;white-space:nowrap}.op-wp-single-card--highlighting[_ngcontent-%COMP%]{width:100%;height:2px;position:absolute;top:0;left:0;border-radius:2px 2px 0 0}.op-wp-single-card--card-actions[_ngcontent-%COMP%]{display:flex;position:absolute;top:9px;right:0}.op-wp-single-card--card-action[_ngcontent-%COMP%]{z-index:2}.op-wp-single-card--card-action_closed[_ngcontent-%COMP%]{color:#555}.op-wp-single-card_selected[_ngcontent-%COMP%]   .op-wp-single-card--card-action[_ngcontent-%COMP%]{background-color:#d1e5f5}.op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{opacity:0;padding-left:40px;padding-right:4px}.op-icon--wrapper[_ngcontent-%COMP%]:not(.op-wp-single-card--inline-buttons_selected){background:white}.op-wp-single-card--inline-buttons.-show[_ngcontent-%COMP%]{opacity:1}.op-wp-single-card_selected[_ngcontent-%COMP%]   .op-wp-single-card--inline-buttons[_ngcontent-%COMP%]{background-color:#d1e5f5}.op-wp-single-card--inline-cancel-button[_ngcontent-%COMP%]{color:var(--warn)}@media only screen and (max-width: 679px){.op-wp-single-card_shrink[_ngcontent-%COMP%]{border:none;box-shadow:none;padding:15px}}'],changeDetection:0})},98722:(H,D,t)=>{"use strict";t.d(D,{H:()=>a});var i=t(3786),e=t(53466),c=t(39410),u=t(53457),r=t(12703),n=t(29161),h=t(2316);class a extends c.I{constructor(){super(...arguments),this.copying=!0}ngOnInit(){super.ngOnInit(),this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(l=>{l.__initialized_at===this.__initialized_at&&this.wpRelations.addCommonRelation(l.id,"relates",this.copiedWorkPackageId)})}createdWorkPackage(){return this.copiedWorkPackageId=this.stateParams.copiedFromWorkPackageId,new Promise((l,d)=>{this.apiV3Service.work_packages.id(this.copiedWorkPackageId).get().pipe((0,e.q)(1)).subscribe(g=>{this.createCopyFrom(g).then(l,d)})})}setTitle(){this.titleService.setFirstPart(this.I18n.t("js.work_packages.copy.title"))}createCopyFrom(l){const d=this.halEditing.changeFor(l);return this.wpCreate.copyWorkPackage(d).then(g=>(this.__initialized_at=g.pristineResource.__initialized_at,this.apiV3Service.work_packages.cache.updateWorkPackage(g.pristineResource,!0),this.halEditing.updateValue("new",g),g))}}a.\u0275fac=function(){let p;return function(d){return(p||(p=h.n5z(a)))(d||a)}}(),a.\u0275dir=h.lG2({type:a,features:[h.qOj]}),(0,i.gn)([(0,n.W)(),(0,i.w6)("design:type",u.V)],a.prototype,"wpRelations",void 0),(0,i.gn)([(0,n.W)(),(0,i.w6)("design:type",r.l)],a.prototype,"halEditing",void 0)},97979:(H,D,t)=>{"use strict";t.d(D,{R:()=>p});var i=t(3786),e=t(80044),c=t(96905),u=t(91923),r=t(43682),n=t(55749),h=t(29161),a=t(65146);class p{constructor(d,g,C=[]){this.injector=d,this.filters=g,this.excluded=C,this.handlers={"=":this.applyFirstValue.bind(this),"!*":this.setToNull.bind(this)}}applyDefaultsFromFilters(d){_.each(this.filters,g=>{if(-1!==this.excluded.indexOf(g.id))return;if("project"===g.id){const m=_.find(g.values,E=>(E instanceof e.X?E.href:E)===this.currentProject.apiv3Path);return void this.setValue(d,"project",m||g.values[0])}const C=g.operator.id,y=this.handlers[C];null==y||y.call(this,d,g)})}applyFirstValue(d,g){if(this.filterAlreadyApplied(d,g))return;const C=g.values[0];if(C){const y=this.mapFilterToAttribute(g);this.setValueFor(d,y,C)}}setToNull(d,g){const C=this.mapFilterToAttribute(g);this.setValue(d,C,{href:null})}setValueFor(d,g,C){const y=this.findSpecialValue(C,g)||C;y&&this.setValue(d,g,y)}setValue(d,g,C){d instanceof n.G?d.setValue(g,C):d[g]=C}findSpecialValue(d,g){return"parent"===g?d:d instanceof e.X&&"/api/v3/users/me"===d.href&&this.currentUser.isLoggedIn?this.halResourceService.fromSelfLink(`/api/v3/users/${this.currentUser.userId}`):void 0}filterAlreadyApplied(d,g){let C=d instanceof n.G?d.projectedResource[g.id]:d[g.id];C=_.castArray(C);for(let y=0;y<g.values.length;y++)for(let m=0;m<C.length;m++)if((0,r.q9)(C[m],g.values[y]))return!0;return!1}mapFilterToAttribute(d){return"onlySubproject"===d.id?"project":d.id}}(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",c.S)],p.prototype,"currentUser",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",u.u)],p.prototype,"halResourceService",void 0),(0,i.gn)([(0,h.W)(),(0,i.w6)("design:type",a.R)],p.prototype,"currentProject",void 0)},55749:(H,D,t)=>{"use strict";t.d(D,{G:()=>u});var i=t(94232),e=t(81923),c=t(84699);class u extends i.W{setValue(n,h){super.setValue(n,h),("project"===n||"type"===n)&&this.updateForm()}applyChanges(n){return delete n.description,super.applyChanges(n)}setNewDefaultFor(n,h){"description"===n&&(0,c.Z)(this.pristineResource)?this.pristineResource.description=h:super.setNewDefaultFor(n,h)}get schema(){return this.form$.hasValue()?e.X.create(super.schema,this.projectedResource):super.schema}}},35403:(H,D,t)=>{"use strict";t.d(D,{L:()=>u});var i=t(61342),e=t(2316);class u{constructor(n,h){this.wpeditForm=n,this.elementRef=h}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}activate(n){if(jQuery(n.target).closest(".help-text--entry").length)return!0;const a=this.wpeditForm.fields[this.fieldName];return a&&a.handleUserActivate(null),!1}}u.\u0275fac=function(n){return new(n||u)(e.Y36(i.n),e.Y36(e.SBq))},u.\u0275cmp=e.Xpm({type:u,selectors:[["wp-replacement-label"]],inputs:{fieldName:"fieldName"},ngContentSelectors:["*"],decls:2,vars:0,consts:[["tabindex","-1",1,"wp-replacement-label",3,"click"]],template:function(n,h){1&n&&(e.F$t(),e.TgZ(0,"span",0),e.NdJ("click",function(p){return h.activate(p)}),e.Hsn(1),e.qZA())},encapsulation:2})},88156:(H,D,t)=>{"use strict";t.d(D,{Nm:()=>r,ag:()=>n,r1:()=>h});var i=t(3786),e=t(7812),c=t(44022),u=t(29161);const r="wp-table--cell-td",n="wp-table--cell-container";class h{constructor(p){this.injector=p,this.fieldRenderer=new e.uA(this.injector,"table")}build(p,l){const d=document.createElement("td"),g=l.id;d.classList.add(r,g),"subject"===g&&d.classList.add("-max");const C=this.schemaCache.of(p).ofProperty(g);C&&"User"===C.type&&d.classList.add("-contains-avatar");const y=document.createElement("span");y.classList.add(n,e.zZ,g);const m=this.fieldRenderer.render(p,g,null);return y.appendChild(m),d.appendChild(y),d}refresh(p,l,d){const g=this.fieldRenderer.render(l,d,null);p.innerHTML="",p.appendChild(g)}}(0,i.gn)([(0,u.W)(c.y),(0,i.w6)("design:type",c.y)],h.prototype,"schemaCache",void 0)},50076:(H,D,t)=>{"use strict";var i,e;t.d(D,{Z:()=>i}),(e=i||(i={})).backgroundClass=function(a,p){return`__hl_background_${a}_${p}`},e.inlineClass=function(a,p){return`__hl_inline_${a}_${p}`},e.colorClass=function(a,p){return a?`__hl_inline_color_${p}_text`:`__hl_inline_color_${p}_dot`},e.overdueDate=function(a){return 0===a?"__hl_date_due_today":a<=-1?"__hl_date_overdue":"__hl_date_not_overdue"},e.isBright=function(a,p,l){const d=`--hl-${p}-${l}-dark`;return""!==a.getPropertyValue(d)}},72875:(H,D,t)=>{"use strict";t.d(D,{t:()=>i,X:()=>e});const i={id:"__internal-sorthandle"},e={id:"__internal-contextMenu"}},72184:(H,D,t)=>{"use strict";t.d(D,{L:()=>a});var i=t(3786),e=t(29161),c=t(21680),u=t(43440),r=t(44022),n=t(60874),h=t(67749);class a extends c.i9{constructor(){super(...arguments),this.text={sum:this.I18n.t("js.label_sum")}}buildSumsRow(l){const d=document.createElement("tr");return d.classList.add("wp-table--sums-row","wp-table--row",(0,h.yZ)(l.index)),this.renderColumns(l.sums,d),d}renderColumns(l,d){this.augmentedColumns.forEach((g,C)=>{const y=document.createElement("td"),m=this.renderContent(l,g.id,this.sumsSchema[g.id]);0===C&&this.appendFirstLabel(m),y.appendChild(m),d.append(y)})}appendFirstLabel(l){const d=document.createElement("span");d.textContent=`${this.text.sum}`,d.title=`${this.text.sum}`,l.prepend(d)}get sumsSchema(){const d=this.querySpace.results.value.sumsSchema.href;return this.schemaCache.state(d).value}renderContent(l,d,g){const C=document.createElement("div");if(C.classList.add("wp-table--sum-container",d),!g)return C;const y=this.displayFieldService.getField(l,d,g,{injector:this.injector,container:"table",options:{}});return y.isEmpty()||y.render(C,y.valueString),C}}(0,i.gn)([(0,e.W)(),(0,i.w6)("design:type",u.q)],a.prototype,"querySpace",void 0),(0,i.gn)([(0,e.W)(),(0,i.w6)("design:type",r.y)],a.prototype,"schemaCache",void 0),(0,i.gn)([(0,e.W)(),(0,i.w6)("design:type",n.i)],a.prototype,"displayFieldService",void 0)},68130:(H,D,t)=>{"use strict";t.d(D,{u:()=>i,k:()=>e});const i="wp-table--group-header",e="-collapsed"},67749:(H,D,t)=>{"use strict";function i(h){let a=h.value||"nullValue";if(h.href)try{a+=h.href.map(p=>p.href).join("-")}catch(p){console.error(`Failed to extract group identifier for ${h.value}`)}return a=a.toLowerCase().replace(/[^a-z0-9]+/g,"-"),`${c(h)}-${a}`}function e(h){const{value:a}=h;return null===a?"-":a}function c(h){return h._links.groupBy.href.split("/").pop()}function u(h){return`__row-group-${h}`}function r(h){return h.split("-")[0]}function n(h){return h.split("-").pop()}t.d(D,{M4:()=>i,_n:()=>e,Ph:()=>c,yZ:()=>u,dF:()=>r,yD:()=>n})},67362:(H,D,t)=>{"use strict";t.d(D,{YZ:()=>h,On:()=>p,UT:()=>g});var i=t(3786),e=t(21680),c=t(87853),u=t(32030),r=t(99676),n=t(29161);const h="-hierarchy-collapsed",p="wp-table--hierarchy-aditional-row";class g extends e.i9{constructor(y,m){super(y,m),this.injector=y,this.workPackageTable=m,this.text={leaf:E=>this.I18n.t("js.work_packages.hierarchy.leaf",{level:E}),expanded:E=>this.I18n.t("js.work_packages.hierarchy.children_expanded",{level:E}),collapsed:E=>this.I18n.t("js.work_packages.hierarchy.children_collapsed",{level:E})}}refreshRow(y,m){const E=super.refreshRow(y,m);return E.find(".wp-table--hierarchy-span").remove(),this.appendHierarchyIndicator(y,E),E}buildEmpty(y){const[m,E]=super.buildEmpty(y),[P,w]=this.ancestorRowData(y);return m.classList.add(...P),this.appendHierarchyIndicator(y,jQuery(m)),[m,w]}ancestorRowData(y){const m=this.wpTableHierarchies.current,E=[];let P=!1;return this.parentsWithVisibleChildren[y.id]&&E.push((0,u.MO)(y.id)),_.isArray(y.ancestors)&&y.ancestors.forEach(w=>{E.push((0,u.oQ)(w.id)),m.collapsed[w.id]&&(P=!0,E.push((0,u.xU)(w.id)))}),[E,P]}buildAncestorRow(y,m,E){const P=this.states.workPackages.get(y.id).value,[w,x]=this.buildEmpty(P);return w.classList.add(p),[w,x]}appendHierarchyIndicator(y,m,E){const P=void 0===E?y.ancestors.length:E,w=this.buildHierarchyIndicator(y,m,P);m.find("td.subject").addClass("-with-hierarchy").prepend(w),m.find("td.subject").css("minWidth",125+20*P+"px"),m.find("td.subject .wp-table--cell-container").css("width",`calc(100% - 25px - ${20*P}px)`)}buildHierarchyIndicator(y,m,E){const P=document.createElement("span"),w=this.wpTableHierarchies.collapsed(y.id),x=25+20*E+"px";if(P.classList.add("wp-table--hierarchy-span"),P.style.width=x,P.dataset.indentation=x,this.parentsWithVisibleChildren[y.id]){const k=w?h:"";P.innerHTML=`\n            <a href tabindex="0" role="button" class="wp-table--hierarchy-indicator ${k}">\n              <span class="wp-table--hierarchy-indicator-icon" aria-hidden="true"></span>\n              <span class="wp-table--hierarchy-indicator-expanded hidden-for-sighted">${this.text.expanded(E)}</span>\n              <span class="wp-table--hierarchy-indicator-collapsed hidden-for-sighted">${this.text.collapsed(E)}</span>\n            </a>\n        `}else P.innerHTML=`\n            <span tabindex="0" class="wp-table--leaf-indicator">\n              <span class="hidden-for-sighted">${this.text.leaf(E)}</span>\n            </span>\n        `;return P}}(0,i.gn)([(0,n.W)(),(0,i.w6)("design:type",r.Y)],g.prototype,"wpTableHierarchies",void 0),(0,i.gn)([(0,n.W)(),(0,i.w6)("design:type",c.G)],g.prototype,"states",void 0)},33791:(H,D,t)=>{"use strict";t.d(D,{OR:()=>h,_M:()=>a,Lp:()=>p});var i=t(3786),e=t(41195),c=t(29161),u=t(87853),r=t(53457),n=t(88156);const h="wp-table--relation-cell-td",a="wp-table--relation-indicator";class p{constructor(d){this.injector=d}build(d,g){const C=document.createElement("td");C.classList.add(n.Nm,h,g.id),C.dataset.columnId=g.id;const y=this.wpTableRelationColumns.getExpandFor(d.id)===g.id,m=this.wpRelations.state(d.id).value,E=this.wpTableRelationColumns.relationsForColumn(d,m,g),P=this.renderIndicator(),w=this.renderBadge(E);return y&&C.classList.add("-expanded"),E.length>0&&(C.appendChild(w),C.appendChild(P)),C}renderIndicator(){const d=document.createElement("span");return d.classList.add(a),d.setAttribute("aria-hidden","true"),d.setAttribute("tabindex","0"),d}renderBadge(d){const g=document.createElement("span");return g.classList.add("wp-table--relation-count"),g.textContent=`${d.length}`,g.classList.add("badge","-border-only"),g}}(0,i.gn)([(0,c.W)(),(0,i.w6)("design:type",u.G)],p.prototype,"states",void 0),(0,i.gn)([(0,c.W)(),(0,i.w6)("design:type",r.V)],p.prototype,"wpRelations",void 0),(0,i.gn)([(0,c.W)(),(0,i.w6)("design:type",e.a)],p.prototype,"wpTableRelationColumns",void 0)},21680:(H,D,t)=>{"use strict";t.d(D,{i9:()=>w,HE:()=>P,S:()=>E});var i=t(3786),e=t(96617),c=t(99919),u=t(71562),r=t(93903),n=t(85003),h=t(72875),a=t(29161),p=t(88156);class l{constructor(k){this.injector=k}build(k){const b=document.createElement("td");b.classList.add(p.Nm,n.oE,h.X.id,"hide-when-print");const v=document.createElement("span");return v.classList.add(n.K$),this.tableActionsService.render(k).forEach(M=>{v.appendChild(M)}),b.appendChild(v),b}}(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",r.j)],l.prototype,"tableActionsService",void 0);var d=t(60914),g=t(3352),C=t(20506),y=t(33791),m=t(70319);const E="wp-table--row",P="wp--row";class w{constructor(k,b){this.injector=k,this.workPackageTable=b,this.cellBuilder=new p.r1(this.injector),this.relationCellBuilder=new y.Lp(this.injector),this.contextLinkBuilder=new l(this.injector),this.augmentedColumns=this.buildAugmentedColumns()}get columns(){return this.wpTableColumns.getColumns()}buildAugmentedColumns(){const k=[...this.columns,h.X];return this.workPackageTable.configuration.dragAndDropEnabled&&k.unshift(h.t),k}buildCell(k,b){if((0,m.q)(b))return this.relationCellBuilder.build(k,b);switch(b.id){case h.X.id:if(this.workPackageTable.configuration.actionsColumnEnabled)return this.contextLinkBuilder.build(k);if(this.workPackageTable.configuration.columnMenuEnabled){const v=document.createElement("td");return v.classList.add("hide-when-print"),v}return null;default:return this.cellBuilder.build(k,b)}}buildEmpty(k){const b=this.createEmptyRow(k);return this.buildEmptyRow(k,b)}createEmptyRow(k){const b=this.classIdentifier(k),v=document.createElement("tr");return v.setAttribute("tabindex","0"),v.dataset.workPackageId=k.id,v.dataset.classIdentifier=b,v.classList.add(E,P,b,`${b}-table`,"issue"),v}get placeholderRow(){const k=document.createElement("tr"),b=document.createElement("td");return k.classList.add("wp--placeholder-row"),b.colSpan=this.augmentedColumns.length,k.appendChild(b),k}classIdentifier(k){return`wp-row-${k.id}`}refreshRow(k,b){const v=b.find(`.${p.Nm}`).detach(),M=[];return this.augmentedColumns.forEach(S=>{const O=v.filter(`td.${S.id}`);if((S.id.startsWith("__internal")||this.isColumnBeingEdited(k,S))&&O.length)return void M.push(O[0]);const A=this.buildCell(k,S);A&&M.push(A)}),b.prepend(M),b}isColumnBeingEdited(k,b){const v=this.workPackageTable.editing.forms[k.id];return v&&v.activeFields[b.id]}buildEmptyRow(k,b){const v=this.workPackageTable.editing.change(k),M={};if(v&&!v.isEmpty()){const S=(0,c.ay)(this.classIdentifier(k));v.changedAttributes.forEach(O=>{M[O]=S.find(`.${p.Nm}.${O}`)})}return this.augmentedColumns.forEach(S=>{let O;const A=M[S.id];A&&A.length?((0,g.qu)(`Rendering previous open column ${S.id} on ${k.id}`),jQuery(b).append(A)):(O=this.buildCell(k,S),O&&b.appendChild(O))}),this.wpTableSelection.isSelected(k.id)&&b.classList.add(C.HZ),[b,!1]}}(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",d.J)],w.prototype,"wpTableSelection",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",u.i)],w.prototype,"wpTableColumns",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",e.D)],w.prototype,"I18n",void 0)},77850:(H,D,t)=>{"use strict";t.d(D,{j:()=>n,v:()=>h});var i=t(3786),e=t(87853),c=t(73165),u=t(29161),r=t(21680);const n="wp-timeline-cell";class h{constructor(p,l){this.injector=p,this.workPackageTable=l}build(p){const l=document.createElement("div");return l.classList.add(n,r.HE),p&&(l.dataset.workPackageId=p),l}insert(p,l,d=[]){const g=this.build(p);g.classList.add(...d),l.appendChild(g)}}(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",e.G)],h.prototype,"states",void 0),(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",c.W)],h.prototype,"wpTableTimeline",void 0)},20506:(H,D,t)=>{"use strict";t.d(D,{yF:()=>i,HZ:()=>e,mE:()=>c});const i="__ui-state-link",e="-checked";class c{constructor(r,n){this.$state=r,this.keepTab=n}linkToDetails(r,n,h){return this.build(r,"split",n,h)}linkToShow(r,n,h){return this.build(r,"show",n,h)}build(r,n,h,a){const p=document.createElement("a");let l,d;return"show"===n?(l="work-packages.show.tabs",d=this.keepTab.currentShowTab):(l="work-packages.partitioned.list.details.tabs",d=this.keepTab.currentDetailsTab),p.href=this.$state.href(l,{workPackageId:r,tabIdentifier:d}),p.classList.add(i),p.dataset.workPackageId=r,p.dataset.wpState=n,p.setAttribute("title",h),p.textContent=a,p}}},52787:(H,D,t)=>{"use strict";t.d(D,{S:()=>e,X:()=>c});var i=t(33406);function e(u,r){return"click"!==u.type&&("keydown"!==u.type||u.which!==i.m.ENTER)||(r(),!1)}class c{handleEvent(r,n){e(n,()=>this.processEvent(r.workPackageTable,n))}}},32030:(H,D,t)=>{"use strict";function i(r=""){return`__collapsed-group-${r}`}function e(r){return`__hierarchy-group-${r}`}function c(r){return`__hierarchy-root-${r}`}function u(r){return`wp-ancestor-row-${r}`}t.d(D,{xU:()=>i,oQ:()=>e,MO:()=>c,Mh:()=>u})},99919:(H,D,t)=>{"use strict";t.d(D,{is:()=>e,gx:()=>c,Fb:()=>u,ay:()=>r,_D:()=>n,hK:()=>h,Ui:()=>a});var i=t(32030);function e(p){return`wp-row-${p}-table`}function c(){return"wp-table--relations-aditional-row"}function u(p){return jQuery(`.${e(p)}`)}function r(p){return jQuery(`.${p}-table`)}function n(p){return!!p&&null!=Array.from(p.classList).find(l=>l.includes((0,i.xU)()))}function h(p,l){let d=p.previousElementSibling;for(;d;){if(d.matches(l))return d;d=d.previousElementSibling}return null}function a(p){try{const l=u(p),d=l.scrollParent(),g=d.scrollTop(),C=g+d.height(),y=l[0].offsetTop,m=y+l.height();y<g?d[0].scrollTop=y:m>C&&(d[0].scrollTop=m-d.height())}catch(l){console.warn(`Can't scroll row element into view: ${l}`)}}},55054:(H,D,t)=>{"use strict";t.d(D,{t:()=>Xe});var i=t(3786),e=t(96617),c=t(43440),u=t(87853),r=t(29161),n=t(20979),h=t(79174),a=t(3352),p=t(68130),l=t(71562),d=t(21680);class g{constructor(ge,be){this.injector=ge,this.workPackageTable=be}isApplicable(ge){return!0}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.G)],g.prototype,"states",void 0);var C=t(67749);function y(rt){return`group-${rt.identifier}`}class m{constructor(ge){this.injector=ge,this.text={collapse:this.I18n.t("js.label_collapse"),expand:this.I18n.t("js.label_expand")}}buildGroupRow(ge,be){const Me=document.createElement("tr");let Re,$e;return ge.collapsed?($e=this.text.expand,Re="icon-plus"):($e=this.text.collapse,Re="icon-minus2"),Me.classList.add(p.u,y(ge)),Me.id=`wp-table-rowgroup-${ge.index}`,Me.dataset.groupIndex=ge.index.toString(),Me.dataset.groupIdentifier=ge.identifier,Me.innerHTML=`\n      <td colspan="${be}" class="-no-highlighting">\n        <div class="expander icon-context ${Re}">\n          <span class="hidden-for-sighted">${_.escape($e)}</span>\n        </div>\n        <div class="group--value" data-qa-selector="op-group--value">\n          ${_.escape((0,C._n)(ge))}\n          <span class="count">\n            (${ge.count})\n          </span>\n        </div>\n      </td>\n    `,Me}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",e.D)],m.prototype,"I18n",void 0);var E=t(72184),P=t(12703),w=t(84897),x=t(50076);class k{constructor(ge,be,Me){this.injector=ge,this.table=be,this.tablePass=Me}render(){if(!this.isApplicable)return;const ge=this.wpTableHighlighting.current.mode;window.getComputedStyle(document.body);this.tablePass.renderedOrder.forEach((Me,Re)=>{if(!Me.workPackage)return;const $e=Me.workPackage[ge];if(!$e)return;const pt=$e.id;this.tablePass.tableBody.children[Re].classList.add(x.Z.backgroundClass(ge,pt))})}get isApplicable(){return!(this.wpTableHighlighting.isInline||this.wpTableHighlighting.isDisabled)}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",w.B)],k.prototype,"wpTableHighlighting",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",c.q)],k.prototype,"querySpace",void 0);var b=t(88156),v=t(16451),M=t(72875);class O{constructor(ge){this.injector=ge;const be=this.injector.get(v.B);this.actionService=be.get(ge)}build(ge,be){const Me=document.createElement("td");if(Me.classList.add(b.Nm,M.t.id),!this.actionService.canPickup(ge))return Me;Me.classList.add("wp-table--sort-td",M.t.id,"hide-when-print");const Re=document.createElement("span");return Re.classList.add("wp-table--drag-and-drop-handle","icon-drag-handle"),Me.appendChild(Re),Me}}var A=t(95846);class F{constructor(ge,be,Me){this.injector=ge,this.table=be,this.tablePass=Me,this.dragDropHandleBuilder=new O(this.injector)}render(){!this.table.configuration.dragAndDropEnabled||this.wpTableOrder.withLoadedPositions().then(ge=>{this.tablePass.renderedOrder.forEach((be,Me)=>{if(!be.workPackage||"relations"===be.renderType)return;const Re=this.dragDropHandleBuilder.build(be.workPackage,ge[be.workPackage.id]);Re&&be.element.replaceChild(Re,be.element.firstElementChild)})})}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",l.i)],F.prototype,"wpTableColumns",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",A.M)],F.prototype,"wpTableOrder",void 0);var I=t(77850);class J{constructor(ge,be,Me){this.injector=ge,this.table=be,this.tablePass=Me}render(){this.timelineBody=document.createDocumentFragment(),this.timelineBuilder=new I.v(this.injector,this.table),this.tablePass.renderedOrder.forEach(ge=>{const be=ge.workPackage?ge.workPackage.id:null,Me=this.timelineBuilder.build(be);Me.classList.add(ge.classIdentifier,`${ge.classIdentifier}-timeline`,...ge.additionalClasses),this.timelineBody.appendChild(Me)})}}var N=t(53457),te=t(41195),ee=t(70319);function G(rt){return`__relations-expanded-from-${rt}`}const me="wp-table--relation-cell-td";class _e extends d.i9{constructor(ge,be){super(ge,be),this.injector=ge,this.workPackageTable=be}buildCell(ge,be){return(0,ee.q)(be)?this.emptyRelationCell(be):super.buildCell(ge,be)}buildEmptyRelationRow(ge,be,Me){const Re=be.denormalized(ge),$e=this.states.workPackages.get(Re.targetId).value,pt=this.createEmptyRelationRow(ge,$e),[mt,vt]=super.buildEmptyRow($e,pt);return[mt,$e]}createEmptyRelationRow(ge,be){const Me=this.relationClassIdentifier(ge,be),Re=document.createElement("tr");return Re.dataset.workPackageId=be.id,Re.dataset.classIdentifier=Me,Re.classList.add(d.HE,d.S,"issue","wp-table--relations-aditional-row",Me,`${Me}-table`,G(ge.id)),Re}relationClassIdentifier(ge,be){return function(rt,ge){return`wp-relation-row-${ge}-to-${rt}`}(be.id,ge.id)}appendRelationLabel(ge,be,Me,Re,$e){const pt=Me.denormalized(be);let mt="";"toType"===$e&&(mt=this.I18n.t(`js.relation_labels.${pt.reverseRelationType}`)),"ofType"===$e&&(mt=this.states.workPackages.get(pt.target.id).value.type.name);const vt=document.createElement("span");vt.classList.add("relation-row--type-label"),vt.textContent=mt;document.createTextNode(pt.target.name);ge.find(`.${me}`).empty(),ge.find(`.${me}.${Re}`).append(vt)}emptyRelationCell(ge){const be=document.createElement("td");return be.classList.add(me,b.Nm,ge.id),be}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.G)],_e.prototype,"states",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",e.D)],_e.prototype,"I18n",void 0);class he{constructor(ge,be,Me){this.injector=ge,this.table=be,this.tablePass=Me,this.relationRowBuilder=new _e(ge,be)}render(){this.isApplicable&&_.clone(this.tablePass.renderedOrder).forEach((be,Me)=>{if(!be.workPackage)return;const{workPackage:Re}=be,$e=Re.id,pt=this.wpRelations.state($e);!pt.hasValue()||0===_.size(pt.value)||this.wpTableRelationColumns.relationsToExtendFor(Re,pt.value,(mt,vt,Ue)=>{const[Le,Ee]=this.relationRowBuilder.buildEmptyRelationRow(Re,mt,Ue);Le.classList.add(...be.additionalClasses),this.relationRowBuilder.appendRelationLabel(jQuery(Le),Re,mt,vt.id,Ue),this.tablePass.spliceRow(Le,`.${this.relationRowBuilder.classIdentifier(Re)},.${G($e)}`,{classIdentifier:this.relationRowBuilder.relationClassIdentifier(Re,Ee),additionalClasses:be.additionalClasses.concat(["wp-table--relations-aditional-row"]),workPackage:Ee,belongsTo:Re,renderType:"relations",hidden:be.hidden,data:{relation:mt,columnId:vt.id,relationType:Ue}})})})}refreshRelationRow(ge,be,Me){const Re=this.relationRowBuilder.refreshRow(be,Me);return this.relationRowBuilder.appendRelationLabel(Re,ge.belongsTo,ge.data.relation,ge.data.columnId,ge.data.relationType),Re}get isApplicable(){return this.wpTableColumns.hasRelationColumns()}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",N.V)],he.prototype,"wpRelations",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",l.i)],he.prototype,"wpTableColumns",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",te.a)],he.prototype,"wpTableRelationColumns",void 0);class ae{constructor(ge,be,Me){this.injector=ge,this.workPackageTable=be,this.rowBuilder=Me}render(){return(0,a.IN)("Primary render pass",()=>{this.prepare(),this.doRender(),this.postRender()}),this.highlighting.render(),(0,a.IN)("Relations render pass",()=>{this.relations.render()}),(0,a.IN)("Drag handle render pass",()=>{this.dragDropHandle.render()}),(0,a.IN)("Timelines render pass",()=>{this.timeline.render()}),this}refresh(ge,be,Me){const Re=jQuery(Me).find(`.${ge.classIdentifier}`);let $e=null;switch(ge.renderType){case"primary":$e=this.rowBuilder.refreshRow(be,Re);break;case"relations":$e=this.relations.refreshRelationRow(ge,be,Re)}null!==$e&&Re.length&&Re.replaceWith($e)}get result(){return this.renderedOrder.map(ge=>({classIdentifier:ge.classIdentifier,workPackageId:ge.workPackage?ge.workPackage.id:null,hidden:ge.hidden}))}spliceRow(ge,be,Me){const Re=jQuery(this.tableBody).find(be).last();Re.after(ge);const $e=Re.index();this.renderedOrder.splice($e+1,0,Me)}prepare(){this.timeline=new J(this.injector,this.workPackageTable,this),this.relations=new he(this.injector,this.workPackageTable,this),this.dragDropHandle=new F(this.injector,this.workPackageTable,this),this.highlighting=new k(this.injector,this.workPackageTable,this),this.tableBody=document.createDocumentFragment(),this.renderedOrder=[]}postRender(){0===this.renderedOrder.length&&this.workPackageTable.renderPlaceholderRow&&this.tableBody.appendChild(this.rowBuilder.placeholderRow)}appendRow(ge,be,Me=[],Re=!1){this.tableBody.appendChild(be),this.renderedOrder.push({classIdentifier:this.rowBuilder.classIdentifier(ge),additionalClasses:Me,workPackage:ge,renderType:"primary",element:be,hidden:Re})}appendNonWorkPackageRow(ge,be,Me=[],Re=!1){ge.classList.add(be),this.tableBody.appendChild(ge),this.renderedOrder.push({element:ge,classIdentifier:be,additionalClasses:Me,workPackage:null,renderType:"primary",hidden:Re})}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",P.l)],ae.prototype,"halEditing",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.G)],ae.prototype,"states",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",e.D)],ae.prototype,"I18n",void 0);class re extends ae{constructor(ge,be,Me){super(ge,be,Me),this.injector=ge,this.workPackageTable=be,this.rowBuilder=Me}doRender(){this.workPackageTable.originalRows.forEach(ge=>{const be=this.workPackageTable.originalRowIndex[ge],[Me]=this.rowBuilder.buildEmpty(be.object);be.element=Me,this.appendRow(be.object,Me),this.tableBody.appendChild(Me)})}}class Ce extends re{constructor(ge,be,Me,Re,$e){super(ge,be,new d.i9(ge,be)),this.injector=ge,this.workPackageTable=be,this.groups=Me,this.headerBuilder=Re,this.colspan=$e,this.sumsBuilder=new E.L(this.injector,this.workPackageTable)}doRender(){let ge=null;const{length:be}=this.workPackageTable.originalRows;this.workPackageTable.originalRows.forEach((Me,Re)=>{const $e=this.workPackageTable.originalRowIndex[Me],pt=this.matchingGroup($e.object),mt=ge!==pt;if(ge&&mt&&this.renderSumsRow(ge),pt&&mt){const vt=y(pt),Ue=this.headerBuilder.buildGroupRow(pt,this.colspan);this.appendNonWorkPackageRow(Ue,vt,["-group-row"]),ge=pt}$e.group=ge,this.buildSingleRow($e)}),ge&&this.renderSumsRow(ge)}matchingGroup(ge){return _.find(this.groups,be=>{let Me=ge[(0,C.Ph)(be)];if(void 0===Me&&(Me=null),_.isArray(Me))return this.matchesMultiValue(Me,be);if(Me&&Me.href)return!!_.find(be._links.valueLink,$e=>Me.href===$e.href);let Re=""===be.value?null:be.value;return Re&&"string"==typeof Re&&(Re=Re.replace("%","")),Re==Me})}matchesMultiValue(ge,be){if(ge.length!==be.href.length)return!1;const Me=Re=>_.map(Re,$e=>$e.href).sort().join(", ");return _.isEqualWith(ge,be.href,(Re,$e)=>Me(Re)===Me($e))}buildSingleRow(ge){const{group:be}=ge;be||console.warn("All rows should have a group, but this one doesn't %O",ge);let Me=!1;const Re=[],[$e,pt]=this.rowBuilder.buildEmpty(ge.object);be&&(Re.push((0,C.yZ)(be.index)),Me=!!be.collapsed,Me&&Re.push(p.k)),ge.element=$e,$e.classList.add(...Re),this.appendRow(ge.object,$e,Re,Me)}renderSumsRow(ge){if(!ge.sums)return;const be=y(ge),Me=this.sumsBuilder.buildSumsRow(ge);this.appendNonWorkPackageRow(Me,be)}}class ke extends g{constructor(ge,be){super(ge,be),this.injector=ge}isApplicable(ge){return!_.isEmpty(this.groups)}get groups(){return this.querySpace.groups.value||[]}get collapsedGroups(){return this.querySpace.collapsedGroups.value||{}}get colspan(){return this.wpTableColumns.columnCount+2}buildRows(){const ge=new m(this.injector);return new Ce(this.injector,this.workPackageTable,this.getGroupData(),ge,this.colspan).render()}refreshExpansionState(){const ge=this.getGroupData(),be=this.querySpace.tableRendered.value,Me=new m(this.injector);jQuery(this.workPackageTable.tableAndTimelineContainer).find(`.${p.u}`).each((Re,$e)=>{const pt=jQuery($e).data("groupIndex"),mt=ge[pt],vt=Me.buildGroupRow(mt,this.colspan);$e.parentNode&&$e.parentNode.replaceChild(vt,$e);const Ue=jQuery(this.workPackageTable.tableAndTimelineContainer).find(`.${(0,C.yZ)(pt)}`);Ue.toggleClass(p.k,!!mt.collapsed),Ue.filter(`.${d.S}`).each((Le,Ee)=>{const st=jQuery(Ee).index();be[st].hidden=!!mt.collapsed})}),this.querySpace.tableRendered.putValue(be,"Updated hidden state of rows after group change.")}getGroupData(){return this.groups.map((ge,be)=>(ge.index=be,ge._links&&ge._links.valueLink&&(ge.href=ge._links.valueLink),ge.identifier=(0,C.M4)(ge),ge.collapsed=this.collapsedGroups[ge.identifier],ge))}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",c.q)],ke.prototype,"querySpace",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.G)],ke.prototype,"states",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",l.i)],ke.prototype,"wpTableColumns",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",e.D)],ke.prototype,"I18n",void 0);var Ae=t(99676),Fe=t(32030),ot=t(67362);class it extends ae{constructor(ge,be,Me){super(ge,be,Me),this.injector=ge,this.workPackageTable=be,this.rowBuilder=Me,this.rendered={},this.additionalParents={},this.deferred={},this.parentsWithVisibleChildren={}}prepare(){super.prepare(),this.hierarchies=this.wpTableHierarchies.current,_.each(this.workPackageTable.originalRowIndex,ge=>{ge.object.ancestors.forEach(be=>{this.parentsWithVisibleChildren[be.id]=!0})}),this.rowBuilder.parentsWithVisibleChildren=this.parentsWithVisibleChildren}doRender(){this.workPackageTable.originalRows.forEach(ge=>{const be=this.workPackageTable.originalRowIndex[ge],Me=be.object;if(!this.deferInsertion(Me)){if(Me.ancestors.length)this.buildWithHierarchy(be);else{const[Re,$e]=this.rowBuilder.buildEmpty(Me);be.element=Re,this.tableBody.appendChild(Re),this.markRendered(Re,Me,$e)}this.renderAllDeferredChildren(Me)}})}deferInsertion(ge){const{ancestors:be}=ge;if(0===be.length)return!1;const Me=be.concat([ge]);for(let Re=Me.length-2;Re>=0;--Re){const $e=Me[Re],pt=this.workPackageTable.originalRowIndex[$e.id];if(this.rendered[$e.id])return!1;if(pt){let vt=this.deferred[$e.id]||[],Ue=Me.slice(Re+1,Me.length);return Ue=Ue.map(Le=>this.apiV3Service.work_packages.cache.state(Le.id).value),vt=vt.concat(Ue),this.deferred[$e.id]=_.uniqBy(vt,Le=>Le.id),!0}}return!1}renderAllDeferredChildren(ge){const be=ge.id;(this.deferred[be]||[]).forEach(Re=>{this.insertUnderParent(this.getOrBuildRow(Re),Re.parent||ge),this.renderAllDeferredChildren(Re)})}getOrBuildRow(ge){let be=this.workPackageTable.originalRowIndex[ge.id];return be||(be={object:ge}),be}buildWithHierarchy(ge){const{ancestors:be}=ge.object,Me=[];be.forEach(($e,pt)=>{const mt=this.states.workPackages.get($e.id).getValueOr($e);if(!this.rendered[mt.id]){const[vt,Ue]=this.rowBuilder.buildAncestorRow(mt,Me,pt);if(0===pt)this.tableBody.appendChild(vt),this.markRendered(vt,mt,Ue,!0);else{const Le=be[pt-1];this.insertAtExistingHierarchy(mt,vt,Le,Ue,!0)}this.additionalParents[mt.id]=mt}Me.push((0,Fe.oQ)(mt.id)),be.slice(0,pt).forEach(vt=>{Me.push((0,Fe.oQ)(vt.id))})});const Re=_.last(be);this.insertUnderParent(ge,Re)}insertUnderParent(ge,be){const[Me,Re]=this.rowBuilder.buildEmpty(ge.object);ge.element=Me,this.insertAtExistingHierarchy(ge.object,Me,be,Re,!1)}markRendered(ge,be,Me=!1,Re=!1){this.rendered[be.id]=!0,this.renderedOrder.push(this.buildRenderInfo(ge,be,Me,Re))}insertAtExistingHierarchy(ge,be,Me,Re,$e){const pt=`.__hierarchy-root-${Me.id}`,mt=`.__hierarchy-group-${Me.id}`;this.spliceRow(be,`${pt},${mt}`,this.buildRenderInfo(be,ge,Re,$e)),this.rendered[ge.id]=!0}buildRenderInfo(ge,be,Me,Re){const $e={element:ge,classIdentifier:"",additionalClasses:[],workPackage:be,renderType:"primary",hidden:Me},[pt,mt]=this.rowBuilder.ancestorRowData(be);return Re?($e.additionalClasses=[ot.On].concat(pt),$e.classIdentifier=(0,Fe.Mh)(be.id)):($e.additionalClasses=pt,$e.classIdentifier=this.rowBuilder.classIdentifier(be)),$e}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",c.q)],it.prototype,"querySpace",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.G)],it.prototype,"states",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",n.T)],it.prototype,"apiV3Service",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",Ae.Y)],it.prototype,"wpTableHierarchies",void 0);class Ve extends g{constructor(ge,be){super(ge,be),this.injector=ge,this.workPackageTable=be}isApplicable(ge){return this.wpTableHierarchies.isEnabled}buildRows(){const ge=new ot.UT(this.injector,this.workPackageTable);return new it(this.injector,this.workPackageTable,ge).render()}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.G)],Ve.prototype,"states",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",l.i)],Ve.prototype,"wpTableColumns",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",Ae.Y)],Ve.prototype,"wpTableHierarchies",void 0);class Ie extends g{constructor(ge,be){super(ge,be),this.injector=ge}buildRows(){const ge=new d.i9(this.injector,this.workPackageTable);return new re(this.injector,this.workPackageTable,ge).render()}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",e.D)],Ie.prototype,"I18n",void 0);var ue=t(7101),ie=t(37048),R=t(91260),L=t(18322);class Oe extends R.Py{constructor(ge,be,Me,Re){super(ge),this.injector=ge,this.table=be,this.workPackageId=Me,this.classIdentifier=Re,this.cellBuilder=new b.r1(this.injector),this.resourceSubscription=this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().subscribe($e=>this.resource=$e)}destroy(){this.resourceSubscription.unsubscribe()}findContainer(ge){return this.rowContainer.find(`.${b.Nm}.${ge} .${b.ag}`).first()}findCell(ge){return this.rowContainer.find(`.${b.Nm}.${ge}`).first()}activateField(ge,be,Me,Re){return this.waitForContainer(Me).then($e=>{const pt=this.findCell(Me);pt.addClass(L.sS);let mt=parseInt(pt.css("width"));return mt=mt>150?mt-10:150,pt.css("max-width",`${mt}px`),pt.css("width",`${mt}px`),this.editingPortalService.create($e,this.injector,ge,be,Me,Re)})}reset(ge,be){const Me=this.findContainer(ge),Re=this.findCell(ge);Me.length&&(this.findCell(ge).css("width",""),this.findCell(ge).css("max-width",""),this.cellBuilder.refresh(Me[0],this.resource,ge),Re.removeClass(L.sS),be&&this.FocusHelper.focusElement(Me))}requireVisible(ge){return this.wpTableColumns.addColumn(ge),this.waitForContainer(ge)}focusOnFirstError(){jQuery(this.table.tableAndTimelineContainer).find(".inline-edit--active-field.-error .inline-edit--field").first().trigger("focus")}loadFieldSchema(ge,be=!1){return["startDate","dueDate","date"].includes(ge)&&(ge="combinedDate"),super.loadFieldSchema(ge,be)}waitForContainer(ge){return new Promise((be,Me)=>{const Re=setInterval(()=>{const $e=this.findContainer(ge);$e.length>0&&(clearInterval(Re),be($e[0]))},100)})}get rowContainer(){return jQuery(this.table.tableAndTimelineContainer).find(`.${this.classIdentifier}-table`)}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",l.i)],Oe.prototype,"wpTableColumns",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",n.T)],Oe.prototype,"apiV3Service",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.G)],Oe.prototype,"states",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",ue.i)],Oe.prototype,"FocusHelper",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",ie.b)],Oe.prototype,"editingPortalService",void 0);class ${constructor(ge,be){this.table=ge,this.injector=be,this.forms={}}reset(){_.each(this.forms,ge=>ge.destroy()),this.forms={}}change(ge){return this.halEditing.typedState(ge).value}stopEditing(ge){this.halEditing.stopEditing(ge);const be=this.forms[ge.id];be&&(be.destroy(),delete this.forms[ge.id])}startEditing(ge,be){const Me=ge.id;return this.forms[Me]||(this.forms[Me]=new Oe(this.injector,this.table,Me,be))}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",P.l)],$.prototype,"halEditing",void 0);class Xe{constructor(ge,be,Me,Re,$e,pt,mt){this.injector=ge,this.tableAndTimelineContainer=be,this.scrollContainer=Me,this.tbody=Re,this.timelineBody=$e,this.timelineController=pt,this.configuration=mt,this.originalRows=[],this.originalRowIndex={},this.hierarchyRowsBuilder=new Ve(this.injector,this),this.groupedRowsBuilder=new ke(this.injector,this),this.plainRowsBuilder=new Ie(this.injector,this),this.builders=[this.hierarchyRowsBuilder,this.groupedRowsBuilder,this.plainRowsBuilder],this.lastRenderPass=null,this.editing=new $(this,this.injector)}get renderedRows(){return this.querySpace.tableRendered.getValueOr([])}findRenderedRow(ge){const be=_.findIndex(this.renderedRows,Me=>Me.classIdentifier===ge);return[be,this.renderedRows[be]]}get rowBuilder(){return _.find(this.builders,ge=>ge.isApplicable(this))}buildIndex(ge){this.originalRowIndex={},this.originalRows=ge.map((be,Me)=>{const Re=be.id;return be=this.apiV3Service.work_packages.cache.current(Re,be),this.originalRowIndex[Re]={object:be,workPackageId:Re,position:Me},Re})}initialSetup(ge){this.buildIndex(ge),this.redrawTableAndTimeline()}redrawTableAndTimeline(){const ge=this.performRenderPass(!1);requestAnimationFrame(()=>{this.tbody.innerHTML="",this.timelineBody.innerHTML="",this.tbody.appendChild(ge.tableBody),this.timelineBody.appendChild(ge.timeline.timelineBody),setTimeout(()=>this.querySpace.tableRendered.putValue(ge.result))})}redrawTable(){const ge=this.performRenderPass();this.querySpace.tableRendered.putValue(ge.result)}refreshRows(ge){const be=this.lastRenderPass;be?_.each(be.renderedOrder,Me=>{Me.workPackage&&Me.workPackage.id===ge.id&&((0,a.qu)(`Refreshing rendered row ${Me.classIdentifier}`),Me.workPackage=ge,be.refresh(Me,ge,this.tbody))}):(0,a.qu)("Trying to refresh a singular row without a previous render pass.")}get renderPlaceholderRow(){return this.configuration.dragAndDropEnabled}performRenderPass(ge=!0){this.editing.reset();const be=this.lastRenderPass=this.rowBuilder.buildRows();return ge&&requestAnimationFrame(()=>{this.tbody.innerHTML="",this.tbody.appendChild(be.tableBody)}),be}setGroupsCollapseState(ge){this.querySpace.collapsedGroups.putValue(ge);const be=performance.now();this.groupedRowsBuilder.refreshExpansionState();const Me=performance.now();(0,a.qu)(`Group redraw took ${Me-be} milliseconds.`)}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",c.q)],Xe.prototype,"querySpace",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",n.T)],Xe.prototype,"apiV3Service",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.G)],Xe.prototype,"states",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",e.D)],Xe.prototype,"I18n",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",h.q)],Xe.prototype,"workPackageViewCollapsedGroupsService",void 0)},88923:(H,D,t)=>{"use strict";t.d(D,{b:()=>y});var i=t(2316),e=t(84897),c=t(82763),u=t(22663),r=t(83720),n=t(43440),h=t(45237),a=t(79460),p=t(61043),l=t(91488),d=t(54364),g=t(87947);function C(m,E){if(1&m&&(i.TgZ(0,"div",2),i._UZ(1,"wp-resizer",3),i.qZA()),2&m){const P=i.oxw();i.xp6(1),i.Q6J("elementClass",P.resizerClass)("localStorageKey",P.resizerStorageKey)}}class y{constructor(E,P,w,x,k){this.wpTableHighlight=E,this.wpTableSortBy=P,this.wpList=w,this.querySpace=x,this.cdRef=k,this.showResizer=!1,this.resizerClass="",this.resizerStorageKey="",this.selectionChanged=new i.vpe,this.itemClicked=new i.vpe,this.stateLinkClicked=new i.vpe,this.gridOrientation="horizontal",this.highlightingMode="none"}ngOnInit(){this.dragInto=this.configuration.dragAndDropEnabled,this.canDragOutOf=()=>this.configuration.dragAndDropEnabled,this.wpTableHighlight.updates$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions),(0,r.x)()).subscribe(()=>{this.highlightingMode=this.wpTableHighlight.current.mode,this.cdRef.detectChanges()})}switchToManualSorting(){const E=this.querySpace.query.value;E&&this.wpTableSortBy.switchToManualSorting(E)&&this.wpList.save(E)}}y.\u0275fac=function(E){return new(E||y)(i.Y36(e.B),i.Y36(c.q),i.Y36(p.Z),i.Y36(n.q),i.Y36(i.sBO))},y.\u0275cmp=i.Xpm({type:y,selectors:[["wp-grid"]],inputs:{configuration:"configuration",showResizer:"showResizer",resizerClass:"resizerClass",resizerStorageKey:"resizerStorageKey"},outputs:{selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[i._Bn([h.j,a.q])],decls:2,vars:10,consts:[[3,"dragOutOfHandler","dragInto","cardsRemovable","highlightingMode","showStatusButton","orientation","showEmptyResultsBox","showInfoButton","shrinkOnMobile","onMoved","selectionChanged","itemClicked","stateLinkClicked"],["class","hidden-for-mobile hide-when-print",4,"ngIf"],[1,"hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(E,P){1&E&&(i.TgZ(0,"wp-card-view",0),i.NdJ("onMoved",function(){return P.switchToManualSorting()})("selectionChanged",function(x){return P.selectionChanged.emit(x)})("itemClicked",function(x){return P.itemClicked.emit(x)})("stateLinkClicked",function(x){return P.stateLinkClicked.emit(x)}),i.qZA(),i.YNc(1,C,2,2,"div",1)),2&E&&(i.Q6J("dragOutOfHandler",P.canDragOutOf)("dragInto",P.dragInto)("cardsRemovable",!1)("highlightingMode",P.highlightingMode)("showStatusButton",!0)("orientation",P.gridOrientation)("showEmptyResultsBox",!0)("showInfoButton",!0)("shrinkOnMobile",!0),i.xp6(1),i.Q6J("ngIf",P.showResizer))},directives:[l.x,d.O5,g.H],encapsulation:2,changeDetection:0})},84366:(H,D,t)=>{"use strict";t.d(D,{I:()=>_e});var i=t(2316),e=t(7493),c=t(48451),u=t(9170),r=t(43440),n=t(96617),h=t(8403),a=t(71562),p=t(26942),l=t(38519),d=t(44022),g=t(3786),C=t(87853),y=t(60914),m=t(88156),E=t(72875),P=t(29161),w=t(99919),x=t(21680);const k="wp-inline-create-row",b="wp-table--cancel-create-link";class v extends x.i9{constructor(ae,re){super(ae,re),this.injector=ae,this.text={cancelButton:this.I18n.t("js.button_cancel")}}buildCell(ae,re){switch(re.id){case E.X.id:return this.buildCancelButton();default:return super.buildCell(ae,re)}}buildNew(ae,re){const[ye,Ce]=this.buildEmpty(ae);return[ye,Ce]}createEmptyRow(ae){const re=this.classIdentifier(ae),ye=document.createElement("tr");return ye.id=(0,w.is)(ae.id),ye.dataset.workPackageId=ae.id,ye.dataset.classIdentifier=re,ye.classList.add(k,x.HE,x.S,"issue",re,`${re}-table`),ye}buildCancelButton(){const ae=document.createElement("td");return ae.classList.add(m.Nm,"wp-table--cancel-create-td"),ae.innerHTML=`\n    <a\n       href="#"\n       class="${b} icon icon-cancel"\n       aria-label="${this.text.cancelButton}">\n    </a>\n   `,ae}}(0,g.gn)([(0,P.W)(),(0,g.w6)("design:type",C.G)],v.prototype,"states",void 0),(0,g.gn)([(0,P.W)(),(0,g.w6)("design:type",y.J)],v.prototype,"wpTableSelection",void 0),(0,g.gn)([(0,P.W)(),(0,g.w6)("design:type",a.i)],v.prototype,"wpTableColumns",void 0),(0,g.gn)([(0,P.W)(),(0,g.w6)("design:type",n.D)],v.prototype,"I18n",void 0);var M=t(63829),O=(t(55054),t(52787)),A=t(54364),F=t(84312),I=t(32853);function N(he,ae){if(1&he){const re=i.EpF();i.TgZ(0,"button",6),i.NdJ("click",function(){return i.CHM(re),i.oxw(3).handleAddRowClick()}),i._UZ(1,"span",7),i._UZ(2,"span",8),i.qZA()}if(2&he){const re=i.oxw(3);i.ekj("wp-inline-create--split-link",re.hasReferenceClass),i.Q6J("opAutofocus",re.focus),i.uIk("aria-label",re.text.create),i.xp6(2),i.Q6J("textContent",re.text.create)}}function te(he,ae){if(1&he){const re=i.EpF();i.TgZ(0,"button",9),i.NdJ("click",function(){return i.CHM(re),i.oxw(3).handleReferenceClick()}),i._UZ(1,"span",10),i._UZ(2,"span",8),i.qZA()}if(2&he){const re=i.oxw(3);i.uIk("aria-label",re.text.create),i.xp6(2),i.Q6J("textContent",re.text.reference)}}function ee(he,ae){if(1&he&&(i.TgZ(0,"tr",2),i.TgZ(1,"td",3),i.YNc(2,N,3,5,"button",4),i.YNc(3,te,3,2,"button",5),i.qZA(),i.qZA()),2&he){const re=i.oxw(2);i.xp6(1),i.uIk("colspan",re.colspan),i.xp6(1),i.Q6J("ngIf",re.canAdd),i.xp6(1),i.Q6J("ngIf",re.canReference)}}function G(he,ae){1&he&&i.GkF(0)}function se(he,ae){if(1&he&&(i.TgZ(0,"tr",2),i.TgZ(1,"td",11),i.YNc(2,G,1,0,"ng-container",12),i.qZA(),i.qZA()),2&he){const re=i.oxw(2);i.xp6(1),i.uIk("colspan",re.colspan),i.xp6(1),i.Q6J("ngComponentOutlet",re.referenceClass)("ngComponentOutletInjector",re.injector)}}function me(he,ae){if(1&he&&(i.ynx(0),i.YNc(1,ee,4,3,"tr",1),i.YNc(2,se,3,3,"tr",1),i.BQk()),2&he){const re=i.oxw();i.xp6(1),i.Q6J("ngIf","inactive"===re.mode),i.xp6(1),i.Q6J("ngIf",re.hasReferenceClass&&"reference"===re.mode)}}class _e extends p.N{constructor(ae,re,ye,Ce,ke,Ae,Fe,ot,it,Ve,Ie){super(),this.injector=ae,this.elementRef=re,this.schemaCache=ye,this.I18n=Ce,this.querySpace=ke,this.cdRef=Ae,this.wpCreate=Fe,this.wpInlineCreate=ot,this.wpTableColumns=it,this.wpTableFocus=Ve,this.authorisationService=Ie,this.showing=new i.vpe,this.canAdd=!1,this.canReference=!1,this.mode="inactive",this.focus=!1,this.text=this.wpInlineCreate.buttonTexts}get isActive(){return"inactive"!==this.mode}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}ngAfterViewInit(){this.authorisationService.observeUntil((0,l.J6)(this)).subscribe(()=>{this.canReference=this.hasReferenceClass&&this.wpInlineCreate.canReference,this.canAdd=this.wpInlineCreate.canAdd,this.cdRef.detectChanges(),this.showing.emit(this.canAdd||this.canReference)}),this.registerCreationCallback(),this.refreshOnColumnChanges(),this.registerCancelHandler()}registerCancelHandler(){this.$element.on("click keydown",`.${b}`,ae=>((0,O.S)(ae,()=>{this.resetRow()}),ae.stopImmediatePropagation(),!1))}refreshOnColumnChanges(){this.wpTableColumns.updates$().pipe((0,u.h)(()=>this.isActive),this.untilDestroyed()).subscribe(()=>this.refreshRow())}registerCreationCallback(){this.wpCreate.onNewWorkPackage().pipe(this.untilDestroyed()).subscribe(ae=>{this.currentWorkPackage&&this.currentWorkPackage.__initialized_at===ae.__initialized_at?(this.resetRow(),this.table.configuration.isEmbedded||this.wpTableFocus.updateFocus(ae.id),this.wpInlineCreate.newInlineWorkPackageCreated.next(ae.id)):(this.wpCreate.cancelCreation(),this.removeWorkPackageRow(),this.showRow()),this.cdRef.detectChanges()})}handleAddRowClick(){return this.addWorkPackageRow(),!1}handleReferenceClick(){return this.mode="reference",!1}get referenceClass(){return this.wpInlineCreate.referenceComponentClass}get hasReferenceClass(){return!!this.referenceClass}addWorkPackageRow(){this.wpCreate.createOrContinueWorkPackage(this.projectIdentifier).then(ae=>{const re=this.currentWorkPackage=ae.projectedResource;this.editingSubscription=this.wpCreate.changesetUpdates$().pipe((0,u.h)(()=>!!this.currentWorkPackage)).subscribe(ye=>{this.isActive?(this.schemaCache.update(this.currentWorkPackage,ye.schema),this.refreshRow()):this.insertRow(re)})})}insertRow(ae){const re=this.workPackageEditForm=this.renderInlineCreateRow(ae);setTimeout(()=>{re.activateMissingFields(),this.hideRow()})}refreshRow(){const ae=new v(this.injector,this.table),re=this.$element.find(`.${k}`);re.length&&this.currentWorkPackage&&ae.refreshRow(this.currentWorkPackage,re)}renderInlineCreateRow(ae){const re=new v(this.injector,this.table),ye=this.table.editing.startEditing(ae,re.classIdentifier(ae)),[Ce]=re.buildNew(ae,ye);return this.$element.append(Ce),ye}resetRow(){this.focus=!0,this.removeWorkPackageRow(),setTimeout(()=>{this.showRow(),this.cdRef.detectChanges()},50)}removeWorkPackageRow(){this.wpCreate.cancelCreation(),this.currentWorkPackage=null,this.$element.find(".wp-row-new").remove(),this.editingSubscription&&this.editingSubscription.unsubscribe()}showRow(){this.mode="inactive",this.cdRef.detectChanges()}hideRow(){this.mode="create",this.cdRef.detectChanges()}get colspan(){return this.wpTableColumns.columnCount+1}}_e.\u0275fac=function(ae){return new(ae||_e)(i.Y36(i.zs3),i.Y36(i.SBq),i.Y36(d.y),i.Y36(n.D),i.Y36(r.q),i.Y36(i.sBO),i.Y36(M.P),i.Y36(h.m),i.Y36(a.i),i.Y36(c.o),i.Y36(e.g))},_e.\u0275cmp=i.Xpm({type:_e,selectors:[["","wpInlineCreate",""]],hostBindings:function(ae,re){1&ae&&i.NdJ("keydown.escape",function(){return re.resetRow()})},inputs:{table:["wp-inline-create--table","table"],projectIdentifier:["wp-inline-create--project-identifier","projectIdentifier"]},outputs:{showing:"wp-inline-create--showing"},features:[i.qOj],attrs:["wpInlineCreate",""],decls:1,vars:1,consts:[[4,"ngIf"],["class","wp-inline-create-button-row hide-when-print",4,"ngIf"],[1,"wp-inline-create-button-row","hide-when-print"],[1,"wp-inline-create-button-td"],["type","button","class","spot-link","aria-haspopup","true","data-qa-selector","op-wp-inline-create",3,"wp-inline-create--split-link","opAutofocus","click",4,"ngIf"],["type","button","class","spot-link wp-inline-create--split-link","aria-haspopup","true","data-qa-selector","op-wp-inline-create-reference",3,"click",4,"ngIf"],["type","button","aria-haspopup","true","data-qa-selector","op-wp-inline-create",1,"spot-link",3,"opAutofocus","click"],[1,"spot-icon","spot-icon_add"],[3,"textContent"],["type","button","aria-haspopup","true","data-qa-selector","op-wp-inline-create-reference",1,"spot-link","wp-inline-create--split-link",3,"click"],[1,"spot-icon","spot-icon_link"],[1,"wp-inline-reference-row-td","-no-highlighting"],[4,"ngComponentOutlet","ngComponentOutletInjector"]],template:function(ae,re){1&ae&&i.YNc(0,me,3,2,"ng-container",0),2&ae&&i.Q6J("ngIf",re.canAdd||re.canReference)},directives:[A.O5,F.U,A.$G,I.dw],encapsulation:2})},8403:(H,D,t)=>{"use strict";t.d(D,{m:()=>h});var i=t(3786),e=t(79441),c=t(96617),u=t(7493),r=t(29161),n=t(2316);class h{constructor(p){this.injector=p,this.referenceComponentClass=null,this.referenceTarget=null,this.buttonTexts={reference:"",create:this.I18n.t("js.label_create_work_package")},this.newInlineWorkPackageCreated=new e.xQ,this.newInlineWorkPackageReferenced=new e.xQ}get canAdd(){return this.canCreateWorkPackages||this.authorisationService.can("work_package","addChild")}get canReference(){return!1}get canCreateWorkPackages(){return this.authorisationService.can("work_packages","createWorkPackage")&&this.authorisationService.can("work_packages","editWorkPackage")}ngOnDestroy(){this.newInlineWorkPackageCreated.complete(),this.newInlineWorkPackageReferenced.complete()}}h.\u0275fac=function(p){return new(p||h)(n.LFG(n.zs3))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac}),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",c.D)],h.prototype,"I18n",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.g)],h.prototype,"authorisationService",void 0)},81539:(H,D,t)=>{"use strict";t.d(D,{Y:()=>u});var i=t(47775),e=t(55977),c=t(2316);class u{constructor(n,h){this.UrlParamsHelper=n,this.$state=h}updateIfDifferent(n,h){const a=this.getNewChecksum(n,h);let p=Promise.resolve();return this.isUninitialized()||(this.isIdDifferent(n.id)?(p=this.maintainUrlQueryState(n.id,null),this.clear()):this.isChecksumDifferent(a)&&(p=this.maintainUrlQueryState(n.id,a))),this.set(n.id,a),p}update(n,h){const a=this.getNewChecksum(n,h);this.set(n.id,a),this.maintainUrlQueryState(n.id,a)}setToQuery(n,h){const a=this.getNewChecksum(n,h);return this.set(n.id,a),this.maintainUrlQueryState(n.id,null)}isQueryOutdated(n,h){const a=this.getNewChecksum(n,h);return this.isOutdated(n.id,a)}executeIfOutdated(n,h,a){(this.isUninitialized()||this.isOutdated(n,h))&&(this.set(n,h),a())}set(n,h){this.id=n,this.checksum=h}clear(){this.id=null,this.checksum=null,this.visibleChecksum=null}isUninitialized(){return!this.id&&!this.checksum}isIdDifferent(n){return this.id!==n}isChecksumDifferent(n){return this.checksum&&n!==this.checksum}isOutdated(n,h){const a=!!this.id,p=!!this.checksum,l=this.id!==n,d=h!==this.checksum,g=this.checksum&&!h&&this.visibleChecksum;return(a||p)&&(l||!l&&d&&(h||this.visibleChecksum)||!a&&g)}getNewChecksum(n,h){return this.UrlParamsHelper.encodeQueryJsonParams(n,{pp:h.perPage,pa:h.page})}maintainUrlQueryState(n,h){return this.visibleChecksum=h,this.$state.go(".",{query_props:h,query_id:n},{custom:{notify:!1}})}}u.\u0275fac=function(n){return new(n||u)(c.LFG(e.Z),c.LFG(i.StateService))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},97354:(H,D,t)=>{"use strict";t.d(D,{R:()=>c});var i=t(91923),e=t(2316);class c{constructor(r){this.halResourceService=r}restoreQuery(r,n){this.restoreFilters(r,n.payload,n.schema),this.restoreColumns(r,n.payload,n.schema),this.restoreSortBy(r,n.payload,n.schema),this.restoreGroupBy(r,n.payload,n.schema),this.restoreOtherProperties(r,n.payload)}restoreFilters(r,n,h){let a=_.map(n.filters,p=>{const l=_.find(h.filtersSchemas.elements,C=>C.filter.allowedValues[0].href===p.filter.href);if(!l)return null;const d=l.getFilter(),g=_.find(l.operator.allowedValues,C=>C.href===p.operator.href);return g&&(d.operator=g),d.values.length=0,_.each(p.values,C=>d.values.push(C)),d});a=_.compact(a),r.filters.length=0,_.each(a,p=>r.filters.push(p))}restoreColumns(r,n,h){let a=_.map(n.columns,p=>_.find(h.columns.allowedValues,l=>l.href===p.href));a=_.compact(a),r.columns.length=0,_.each(a,p=>r.columns.push(p))}restoreSortBy(r,n,h){let a=_.map(n.sortBy,p=>_.find(h.sortBy.allowedValues,l=>l.href===p.href));a=_.compact(a),r.sortBy.length=0,_.each(a,p=>r.sortBy.push(p))}restoreGroupBy(r,n,h){const a=_.find(h.groupBy.allowedValues,p=>n.groupBy&&n.groupBy.href===p.href);r.groupBy=a}restoreOtherProperties(r,n){_.without(Object.keys(n.$source),"_links","filters").forEach(h=>{r[h]=n[h]}),_.without(Object.keys(n.$source._links),"columns","groupBy","sortBy").forEach(h=>{r[h]=n[h]})}}c.\u0275fac=function(r){return new(r||c)(e.LFG(i.u))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac})},61043:(H,D,t)=>{"use strict";t.d(D,{Z:()=>A});var i=t(3786),e=t(87853),c=t(7493),u=t(47775),r=t(43440),n=t(55977),h=t(36293),a=t(96617),p=t(30400),l=t(81134),d=t(14808),g=t(79902),C=t(85816),y=t(91992),m=t(18293),E=t(53466),P=t(67202),w=t(40533),x=t(12877),k=t(20979),b=t(68853),v=t(74478),M=t(97354),S=t(76869),O=t(2316);class A{constructor(I,J,N,te,ee,G,se,me,_e,he,ae,re,ye,Ce){this.toastService=I,this.I18n=J,this.UrlParamsHelper=N,this.authorisationService=te,this.$state=ee,this.apiV3Service=G,this.states=se,this.querySpace=me,this.pagination=_e,this.configuration=he,this.wpTablePagination=ae,this.wpStatesInitialization=re,this.wpListInvalidQueryService=ye,this.wpQueryView=Ce,this.queryRequests=(0,d.qH)(),this.queryLoading=this.queryRequests.values$().pipe((0,g.w)(ke=>(0,p.D)(this.ensurePerPageKnown().then(()=>ke))),(0,g.w)(ke=>this.streamQueryRequest(ke.queryParams,ke.projectIdentifier)),(0,C.zg)(ke=>(this.conditionallyLoadForm(ke),this.wpStatesInitialization.initialize(ke,ke.results),(0,l.of)(ke))),(0,y.B)())}streamQueryRequest(I,J){const N=this.getCurrentQueryProps(I),te=this.UrlParamsHelper.buildV3GetQueryFromJsonParams(N);return this.apiV3Service.queries.find(te,I.query_id,J).pipe((0,m.K)(G=>{const se=this.UrlParamsHelper.buildV3GetQueryFromJsonParams(N);return(0,p.D)(this.handleQueryLoadingError(G,se,I.query_id,J))}))}fromQueryParams(I,J){return this.queryRequests.clear(),this.queryRequests.putValue({queryParams:I,projectIdentifier:J}),this.queryLoading.pipe((0,E.q)(1))}getCurrentQueryProps(I){return I.query_props?decodeURIComponent(I.query_props):null}loadDefaultQuery(I){return this.fromQueryParams({},I).toPromise()}reloadQuery(I,J){const N=this.extractParamsFromQuery(I,{pa:1});return this.queryRequests.clear(),this.queryRequests.putValue({queryParams:{query_id:I.id||void 0,query_props:N},projectIdentifier:J}),this.queryLoading.pipe((0,E.q)(1))}extractParamsFromQuery(I,J={}){return this.UrlParamsHelper.encodeQueryJsonParams(I,Object.assign({pa:this.wpTablePagination.current.page,pp:this.wpTablePagination.current.perPage},J))}loadQueryFromExisting(I,J,N){const te=this.UrlParamsHelper.buildV3GetQueryFromQueryResource(I,J);let ee;return ee=I.id?this.apiV3Service.queries.id(I.id):this.apiV3Service.withOptionalProject(N).queries,ee.parameterised(te)}loadCurrentQueryFromParams(I){return this.fromQueryParams(this.$state.params,I).toPromise()}loadForm(I){return this.apiV3Service.queries.form.load(I).toPromise().then(([J,N])=>(this.wpStatesInitialization.updateStatesFromForm(I,J),J))}create(I,J){const N=this.querySpace.queryForm.value;return I.name=J,this.createQueryAndView(I,N).toPromise().then(ee=>(this.toastService.addSuccess(this.I18n.t("js.notice_successful_create")),this.reloadQuery(ee).subscribe(()=>{this.states.changes.queries.next(ee.id)}),ee))}delete(){const I=this.currentQuery,J=this.apiV3Service.queries.id(I).delete().toPromise();return J.then(()=>{let N;this.toastService.addSuccess(this.I18n.t("js.notice_successful_delete")),I.project&&(N=I.project.href.split("/").pop()),this.loadDefaultQuery(N),this.states.changes.queries.next(I.id)}),J}save(I){return(0,i.mG)(this,void 0,void 0,function*(){const J=I||this.currentQuery,N=yield this.querySpace.queryForm.valuesPromise(),te=this.apiV3Service.queries.id(J).patch(J,N).toPromise();return te.then(()=>{this.toastService.addSuccess(this.I18n.t("js.notice_successful_update")),this.$state.go(".",{query_id:J.id,query_props:null},{reload:!0}),this.states.changes.queries.next(J.id)}).catch(ee=>{this.toastService.addError(ee.message)}),te})}toggleStarred(I){const J=this.apiV3Service.queries.toggleStarred(I);return J.then(N=>{this.querySpace.query.putValue(N),this.toastService.addSuccess(this.I18n.t("js.notice_successful_update")),this.states.changes.queries.next(N.id)}),J}getPaginationInfo(){return this.wpTablePagination.paginationObject}conditionallyLoadForm(I){const J=this.querySpace.queryForm.value;(!J||I.$links.update.href!==J.href)&&setTimeout(()=>this.loadForm(I),0)}get currentQuery(){return this.querySpace.query.value}handleQueryLoadingError(I,J,N,te){return this.toastService.addError(this.I18n.t("js.work_packages.faulty_query.description"),I.message),new Promise((ee,G)=>{this.apiV3Service.queries.form.loadWithParams(J,N,te).toPromise().then(([se,me])=>{this.apiV3Service.queries.find({pageSize:0},void 0,te).toPromise().then(_e=>{this.wpListInvalidQueryService.restoreQuery(_e,se),_e.results.pageSize=J.pageSize,_e.results.total=0,N&&(_e.id=N),this.wpStatesInitialization.initialize(_e,_e.results),this.wpStatesInitialization.updateStatesFromForm(_e,se),ee(_e)}).catch(G)}).catch(G)})}ensurePerPageKnown(){return(0,i.mG)(this,void 0,void 0,function*(){return!!this.pagination.isPerPageKnown||this.configuration.initialized})}createQueryAndView(I,J){return this.apiV3Service.queries.post(I,J).pipe((0,g.w)(N=>this.wpQueryView.create(N).pipe((0,P.h)(N))))}}A.\u0275fac=function(I){return new(I||A)(O.LFG(h.kl),O.LFG(a.D),O.LFG(n.Z),O.LFG(c.g),O.LFG(u.StateService),O.LFG(k.T),O.LFG(e.G),O.LFG(r.q),O.LFG(b.N),O.LFG(x.e),O.LFG(w.S),O.LFG(v.f),O.LFG(M.R),O.LFG(S.$))},A.\u0275prov=O.Yz7({token:A,factory:A.\u0275fac})},76869:(H,D,t)=>{"use strict";t.d(D,{$:()=>u});var i=t(47775),e=t(20979),c=t(2316);class u{constructor(n,h){this.$state=n,this.apiV3Service=h}create(n){if(!n.href)throw new Error("Expected only queries that are created since an href is required");return this.apiV3Service.views.post({_links:{query:{href:n.href}}},this.viewType)}get viewType(){if(this.$state.includes("work-packages"))return"work_packages_table";if(this.$state.includes("team_planner"))return"team_planner";if(this.$state.includes("bim"))return"bim";if(this.$state.includes("calendar"))return"work_packages_calendar";throw new Error("Not on a path defined for query views")}}u.\u0275fac=function(n){return new(n||u)(c.LFG(i.StateService),c.LFG(e.T))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},74478:(H,D,t)=>{"use strict";t.d(D,{f:()=>M});var i=t(87853),e=t(7493),c=t(43440),u=t(84897),r=t(53466),n=t(95846),h=t(2888),a=t(20066),p=t(82271),l=t(71562),d=t(82763),g=t(81691),C=t(99676),y=t(40533),m=t(73165),E=t(61083),P=t(74647),w=t(41195),x=t(20979),k=t(79174),b=t(81539),v=t(2316);class M{constructor(O,A,F,I,J,N,te,ee,G,se,me,_e,he,ae,re,ye,Ce,ke,Ae,Fe){this.states=O,this.querySpace=A,this.wpTableColumns=F,this.wpTableGroupBy=I,this.wpTableGroupFold=J,this.wpTableSortBy=N,this.wpTableFilters=te,this.wpTableSum=ee,this.wpTableTimeline=G,this.wpTableHierarchies=se,this.wpTableHighlighting=me,this.wpTableRelationColumns=_e,this.wpTablePagination=he,this.wpTableOrder=ae,this.wpTableAdditionalElements=re,this.apiV3Service=ye,this.wpListChecksumService=Ce,this.authorisationService=ke,this.wpDisplayRepresentation=Ae,this.wpIncludeSubprojects=Fe}initialize(O,A){this.clearStates(),this.querySpace.query.putValue(O),this.initializeFromQuery(O,A);const F=this.querySpace.queryForm.value;F&&this.updateStatesFromForm(O,F),this.updateQuerySpace(O,A),this.updateChecksum(O,A)}updateStatesFromForm(O,A){const F=A.schema;_.each(F.filtersSchemas.elements,I=>{this.states.schemas.get(I.href).putValue(I)}),this.wpTableFilters.initializeFilters(O,F),this.querySpace.queryForm.putValue(A),this.querySpace.available.columns.putValue(F.columns.allowedValues),this.querySpace.available.sortBy.putValue(F.sortBy.allowedValues),this.querySpace.available.groupBy.putValue(F.groupBy.allowedValues),this.querySpace.available.displayRepresentation.putValue(F.displayRepresentation.allowedValues)}updateQuerySpace(O,A){this.querySpace.additionalRequiredWorkPackages.clear("Clearing additional WPs before updating rows"),this.querySpace.tableRendered.clear("Clearing rendered data before upgrading query space"),A.schemas&&_.each(A.schemas.elements,F=>{this.states.schemas.get(F.href).putValue(F)}),this.querySpace.query.putValue(O),this.authorisationService.initModelAuth("work_packages",A.$links),A.elements.forEach(F=>this.apiV3Service.work_packages.cache.updateWorkPackage(F,!0)),this.querySpace.results.putValue(A),this.querySpace.groups.putValue(A.groups),this.wpTablePagination.initialize(O,A),this.wpTableRelationColumns.initialize(O,A),this.wpTableAdditionalElements.initialize(O,A),this.wpTableOrder.initialize(O,A),this.wpDisplayRepresentation.initialize(O,A),this.wpIncludeSubprojects.initialize(O,A),this.querySpace.additionalRequiredWorkPackages.values$().pipe((0,r.q)(1)).subscribe(()=>this.querySpace.initialized.putValue(null))}updateChecksum(O,A){this.wpListChecksumService.updateIfDifferent(this.querySpace.query.value,this.wpTablePagination.current),this.authorisationService.initModelAuth("work_packages",A.$links)}initializeFromQuery(O,A){this.querySpace.query.putValue(O),this.wpTableSum.initialize(O),this.wpTableColumns.initialize(O,A),this.wpTableSortBy.initialize(O,A),this.wpTableGroupBy.initialize(O,A),this.wpTableGroupFold.initialize(O,A),this.wpTableTimeline.initialize(O,A),this.wpTableHierarchies.initialize(O,A),this.wpTableHighlighting.initialize(O,A),this.wpDisplayRepresentation.initialize(O,A),this.wpIncludeSubprojects.initialize(O,A),this.authorisationService.initModelAuth("query",O.$links),this.authorisationService.initModelAuth("work_packages",A.$links)}applyToQuery(O){this.wpTableFilters.applyToQuery(O),this.wpTableSum.applyToQuery(O),this.wpTableColumns.applyToQuery(O),this.wpTableSortBy.applyToQuery(O),this.wpTableGroupBy.applyToQuery(O),this.wpTableGroupFold.applyToQuery(O),this.wpTableTimeline.applyToQuery(O),this.wpTableHighlighting.applyToQuery(O),this.wpTableHierarchies.applyToQuery(O),this.wpTableOrder.applyToQuery(O),this.wpDisplayRepresentation.applyToQuery(O),this.wpIncludeSubprojects.applyToQuery(O)}clearStates(){const O="Clearing states before re-initialization.";this.querySpace.initialized.clear(O),this.querySpace.query.clear(O),this.querySpace.results.clear(O),this.querySpace.groups.clear(O),this.querySpace.additionalRequiredWorkPackages.clear(O),this.wpTableFilters.clear(O),this.wpTableColumns.clear(O),this.wpTableSortBy.clear(O),this.wpTableGroupBy.clear(O),this.wpTableGroupFold.clear(O),this.wpDisplayRepresentation.clear(O),this.wpIncludeSubprojects.clear(O),this.wpTableSum.clear(O),this.querySpace.tableRendered.clear(O)}}M.\u0275fac=function(O){return new(O||M)(v.LFG(i.G),v.LFG(c.q),v.LFG(l.i),v.LFG(E.w),v.LFG(k.q),v.LFG(d.q),v.LFG(P.Z),v.LFG(p.X),v.LFG(m.W),v.LFG(C.Y),v.LFG(u.B),v.LFG(w.a),v.LFG(y.S),v.LFG(n.M),v.LFG(g.G),v.LFG(x.T),v.LFG(b.Y),v.LFG(e.g),v.LFG(h.ld),v.LFG(a.F))},M.\u0275prov=v.Yz7({token:M,factory:M.\u0275fac})},39410:(H,D,t)=>{"use strict";t.d(D,{I:()=>x});var i=t(47775),e=t(70233),c=t(87853),u=t(18511),r=t(96617),n=t(74647),h=t(48451),a=t(61342),p=t(62964),l=t(97973),g=t(26942),C=t(70482),y=t(20979),m=t(57810),E=t(63829),P=t(8849),w=t(2316);class x extends g.N{constructor(b,v,M,S,O,A,F,I,J,N,te,ee,G){super(),this.injector=b,this.$transition=v,this.$state=M,this.I18n=S,this.titleService=O,this.notificationService=A,this.states=F,this.wpCreate=I,this.wpViewFocus=J,this.wpTableFilters=N,this.pathHelper=te,this.apiV3Service=ee,this.cdRef=G,this.successState=(0,C.W)(this.$state),this.cancelState=this.$state.current.data.baseRoute,this.copying=!1,this.stateParams=this.$transition.params("to"),this.text={button_settings:this.I18n.t("js.button_settings")},this.destroyed=!1}ngOnInit(){this.closeEditFormWhenNewWorkPackageSaved(),this.showForm()}ngOnDestroy(){super.ngOnDestroy()}switchToFullscreen(){this.$state.go("work-packages.new",this.$state.params)}onSaved(b){var v;const{savedResource:M,isInitial:S}=b;null===(v=this.editForm)||void 0===v||v.cancel(!1),this.successState&&this.$state.go(this.successState,{workPackageId:M.id}).then(()=>{this.wpViewFocus.updateFocus(M.id),this.notificationService.showSave(M,S)})}showForm(){this.createdWorkPackage().then(b=>{this.change=b,this.newWorkPackage=b.pristineResource,this.cdRef.detectChanges(),this.setTitle(),this.stateParams.parent_id&&b.setValue("parent",{href:this.apiV3Service.work_packages.id(this.stateParams.parent_id).path}),this.stateParams.parent_id&&this.apiV3Service.work_packages.id(this.stateParams.parent_id).get().pipe(this.untilDestroyed()).subscribe(v=>{this.parentWorkPackage=v,this.cdRef.detectChanges()})}).catch(b=>{b instanceof P.o&&"urn:openproject-org:api:v3:errors:MissingPermission"===b.errorIdentifier&&(this.apiV3Service.root.get().subscribe(v=>{if(!v.user){const M=l(this.pathHelper.loginPath());M.search({back_url:M}),window.location.href=M.toString()}}),this.notificationService.handleRawError(b))})}setTitle(){this.titleService.setFirstPart(this.I18n.t("js.work_packages.create.title"))}cancelAndBackToList(){this.wpCreate.cancelCreation(),this.$state.go(this.cancelState,this.$state.params)}createdWorkPackage(){const b=this.stateParams.defaults||{};b._links=b._links||{};const v=this.stateParams.type?parseInt(this.stateParams.type):void 0,M=this.stateParams.parent_id?parseInt(this.stateParams.parent_id):void 0,S=this.stateParams.projectPath;return v&&(b._links.type={href:this.apiV3Service.types.id(v).path}),M&&(b._links.parent={href:this.apiV3Service.work_packages.id(M).path}),this.wpCreate.createOrContinueWorkPackage(S,v,b)}closeEditFormWhenNewWorkPackageSaved(){this.wpCreate.onNewWorkPackage().pipe((0,u.o)(()=>!this.componentDestroyed)).subscribe(b=>{this.onSaved({savedResource:b,isInitial:!0})})}}x.\u0275fac=function(b){return new(b||x)(w.Y36(w.zs3),w.Y36(i.Transition),w.Y36(i.StateService),w.Y36(r.D),w.Y36(m.V),w.Y36(p.q),w.Y36(c.G),w.Y36(E.P),w.Y36(h.o),w.Y36(n.Z),w.Y36(e.j),w.Y36(y.T),w.Y36(w.sBO))},x.\u0275dir=w.lG2({type:x,viewQuery:function(b,v){if(1&b&&w.Gf(a.n,5),2&b){let M;w.iGM(M=w.CRH())&&(v.editForm=M.first)}},features:[w.qOj]})},63829:(H,D,t)=>{"use strict";t.d(D,{P:()=>P});var i=t(79441),e=t(53448),c=t(97979),u=t(12703),r=t(9170),n=t(43440),h=t(1403),a=t(7493),p=t(26942),l=t(20979),d=t(80044),g=t(10190),C=t(44022),y=t(91923),m=t(2316);const E="/api/v3/work_packages/new";class P extends p.N{constructor(x,k,b,v,M,S,O,A,F){super(),this.injector=x,this.hooks=k,this.apiV3Service=b,this.halResourceService=v,this.querySpace=M,this.authorisationService=S,this.halEditing=O,this.schemaCache=A,this.halEvents=F,this.newWorkPackageCreatedSubject=new i.xQ,this.halEditing.committedChanges.pipe(this.untilDestroyed(),(0,r.h)(I=>"WorkPackage"===I.resource._type&&I.wasNew)).subscribe(I=>{this.newWorkPackageCreated(I.resource)}),this.halEditing.changes$(E).pipe(this.untilDestroyed(),(0,r.h)(I=>!I)).subscribe(()=>{this.reset()})}newWorkPackageCreated(x){this.reset(),this.newWorkPackageCreatedSubject.next(x)}onNewWorkPackage(){return this.newWorkPackageCreatedSubject.asObservable()}createNewWorkPackage(x,k){return this.apiV3Service.withOptionalProject(x).work_packages.form.forPayload(k).toPromise().then(b=>this.fromCreateForm(b))}fromCreateForm(x){const k=this.initializeNewResource(x),b=this.halEditing.edit(k,x);return this.hooks.call("workPackageNewInitialization",b),b}copyWorkPackage(x){const k=x.pristineResource.$source;return this.apiV3Service.work_packages.form.post(k).toPromise().then(b=>this.fromCreateForm(b))}copyFrom(x){const k=this.initializeNewResource(x);return this.halEditing.edit(k,x)}getEmptyForm(x){return this.form||(this.form=this.apiV3Service.withOptionalProject(x).work_packages.form.post({}).toPromise()),this.form}cancelCreation(){this.halEditing.stopEditing({href:E}),this.reset()}changesetUpdates$(){return this.halEditing.state(E).values$()}createOrContinueWorkPackage(x,k,b){let v=this.continueExistingEdit(k);return v||(v=this.createNewWithDefaults(x,b)),v.then(M=>(this.authorisationService.initModelAuth("work_package",M.pristineResource),this.halEditing.updateValue(E,M),this.apiV3Service.work_packages.cache.updateWorkPackage(M.pristineResource,!0),M))}reset(){this.apiV3Service.work_packages.cache.clearSome("new"),this.form=void 0}continueExistingEdit(x){const k=this.halEditing.state(E).value;if(void 0!==k){const b=k.projectedResource.type,v=!k.isEmpty(),M=!b&&!x,S=x&&b&&(0,g.Z)(b.href)===x.toString();if(v&&(M||S))return Promise.resolve(k)}return null}createNewWithDefaults(x,k){return this.withFiltersPayload(x,k).then(b=>{const v=_.merge({_links:{}},b,k);return this.createNewWorkPackage(x,v).then(M=>{if(!M)throw new Error("No new work package was created");return this.defaultsFromFilters(M,k),M})})}defaultsFromFilters(x,k){const b=this.querySpace.query.value;if(b){const v=(null==k?void 0:k._links)?Object.keys(k._links):[];new c.R(this.injector,b.filters,v).applyDefaultsFromFilters(x)}}withFiltersPayload(x,k){const b={_links:{}};return this.defaultsFromFilters(b,k),Object.keys(b).length>1||Object.keys(b._links).length>0?this.apiV3Service.withOptionalProject(x).work_packages.form.forTypePayload(k||{_links:{}}).toPromise().then(M=>(this.toApiPayload(b,M.schema),b)):Promise.resolve(b)}toApiPayload(x,k){const b=[];Object.keys(k.$source).forEach(v=>{["Integer","Float","Date","DateTime","Duration","Formattable","Boolean","String","Text",void 0].includes(k.$source[v].type)||b.push(v)}),b.forEach(v=>{const M=x[v];void 0===M||(M instanceof d.X?x._links[v]={href:M.$links.self.href}:x._links[v]=M||{href:null}),delete x[v]})}initializeNewResource(x){const k=x.payload.$plain();k._links.schema={href:"new"};const b=this.halResourceService.createHalResourceOfType("WorkPackage",k);return b.$source.id="new",b._type="WorkPackage",b.__initialized_at=Date.now(),b.update=b.$links.update=x.$links.self,b.updateImmediately=b.$links.updateImmediately=v=>this.apiV3Service.work_packages.post(v).toPromise(),this.schemaCache.update(b,x.schema),b}}P.\u0275fac=function(x){return new(x||P)(m.LFG(m.zs3),m.LFG(e.$),m.LFG(l.T),m.LFG(y.u),m.LFG(n.q),m.LFG(a.g),m.LFG(u.l),m.LFG(C.y),m.LFG(h.J))},P.\u0275prov=m.Yz7({token:P,factory:P.\u0275fac})},19496:(H,D,t)=>{"use strict";t.d(D,{v:()=>g});var i=t(39410),e=t(2316),c=t(54364),u=t(61342),r=t(92092),n=t(11266),h=t(8643),a=t(77180),p=t(66979);const l=function(){return["status","type"]};function d(C,y){if(1&C){const m=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"edit-form",2),e.NdJ("onSaved",function(P){return e.CHM(m),e.oxw().onSaved(P)}),e.TgZ(2,"div",3),e.TgZ(3,"div",4),e._UZ(4,"wp-type-status",5),e.qZA(),e.TgZ(5,"ul",6),e.TgZ(6,"li",7),e._UZ(7,"zen-mode-toggle-button"),e.qZA(),e.TgZ(8,"li",7),e.TgZ(9,"button",8),e._UZ(10,"i",9),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(11,"wp-single-view",10),e.TgZ(12,"wp-edit-actions-bar",11),e.NdJ("onCancel",function(){return e.CHM(m),e.oxw().cancelAndBackToList()}),e.qZA(),e.qZA(),e.qZA()}if(2&C){const m=e.oxw();e.xp6(1),e.Q6J("resource",m.newWorkPackage)("skippedFields",e.DdM(7,l))("inEditMode",!0),e.xp6(3),e.Q6J("workPackage",m.newWorkPackage),e.xp6(5),e.uIk("title",m.text.button_settings),e.xp6(2),e.Q6J("workPackage",m.newWorkPackage)("showProject",m.copying)}}class g extends i.I{constructor(){super(...arguments),this.successState=this.$state.current.data.successState}}g.\u0275fac=function(){let C;return function(m){return(C||(C=e.n5z(g)))(m||g)}}(),g.\u0275cmp=e.Xpm({type:g,selectors:[["wp-new-full-view"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[e.qOj],decls:1,vars:1,consts:[["class","work-package--new-state work-packages--new work-packages--show-view toolbar-container",4,"ngIf"],[1,"work-package--new-state","work-packages--new","work-packages--show-view","toolbar-container"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"toolbar"],[1,"title-container"],[3,"workPackage"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],["id","create-wp-menu-button","wpCreateSettingsMenu","",1,"button","last","work-packages-settings-button","toolbar-icon"],[1,"button--icon","icon-show-more"],[3,"workPackage","showProject"],[3,"onCancel"]],template:function(y,m){1&y&&e.YNc(0,d,13,8,"div",0),2&y&&e.Q6J("ngIf",m.newWorkPackage)},directives:[c.O5,u.n,r.E,n.a,h.Y,a.G,p.Y],encapsulation:2,changeDetection:0})},70319:(H,D,t)=>{"use strict";t.d(D,{L:()=>i,q:()=>e});const i={PROPERTY:"QueryColumn::Property",RELATION_OF_TYPE:"QueryColumn::RelationOfType",RELATION_TO_TYPE:"QueryColumn::RelationToType"};function e(c){return[i.RELATION_TO_TYPE,i.RELATION_OF_TYPE].indexOf(c._type)>=0}},19866:(H,D,t)=>{"use strict";t.d(D,{r:()=>c});var i=t(44022),e=t(2316);class c{constructor(r){this.schemaCache=r}getFilterSchema(r,n){const h=n.$embedded.schema.filtersSchemas.elements;return _.find(h,a=>a.allowedFilterValue.href===r.filter.href)}mapSchemasIntoFilters(r,n){r.filters.forEach(h=>{const a=this.getFilterSchema(h,n);h.$links.schema=a.$links.self,this.schemaCache.update(h,a)})}setSchemas(r){r.elements.forEach(n=>{this.schemaCache.updateValue(n.$links.self.href,n)})}}c.\u0275fac=function(r){return new(r||c)(e.LFG(i.y))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac})},91654:(H,D,t)=>{"use strict";t.d(D,{E:()=>n});var i=t(81539),e=t(61043),c=t(47775),u=t(79441),r=t(2316);class n{constructor(a){this.injector=a,this.wpListChecksumService=this.injector.get(i.Y),this.wpListService=this.injector.get(e.Z),this.$transitions=this.injector.get(c.TransitionService),this.observe$=new u.xQ,this.listenForQueryParamsChanged()}listenForQueryParamsChanged(){return this.queryChangeListener=this.$transitions.onSuccess({},a=>{const p=a.options(),l=a.params("to"),d=this.wpListService.getCurrentQueryProps(l),g=l.query_id?l.query_id.toString():null;return!!(p.reload||p.custom&&!1===p.custom.notify)||this.wpListChecksumService.executeIfOutdated(g,d,()=>{this.observe$.next(d)})})}removeQueryChangeListener(){this.queryChangeListener()}}n.\u0275fac=function(a){return new(a||n)(r.LFG(r.zs3))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac})},55977:(H,D,t)=>{"use strict";t.d(D,{Z:()=>n});var i=t(10190),e=t(48934),c=t(26269),u=t(68853),r=t(2316);class n{constructor(a){this.paginationService=a}buildQueryString(a){if(!a)return;const p=[];return _.each(a,(l,d)=>{!l||(Array.isArray(l)||(l=[l]),_.each(l,g=>{null!==g&&"object"==typeof g&&(g=JSON.stringify(g)),p.push(`${encodeURIComponent(d)}=${encodeURIComponent(g)}`)}))}),p.join("&")}encodeQueryJsonParams(a,p){const l=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({c:a.columns.map(d=>d.id),hi:!!a.showHierarchies,g:_.get(a.groupBy,"id",""),dr:a.displayRepresentation,is:a.includeSubprojects},this.encodeSums(a)),this.encodeTimelineVisible(a)),this.encodeHighlightingMode(a)),this.encodeHighlightedAttributes(a)),this.encodeSortBy(a)),this.encodeFilters(a.filters));return"function"==typeof p?JSON.stringify(p(l)):"object"==typeof p?JSON.stringify(_.merge(l,p)):JSON.stringify(l)}encodeSums(a){return a.sums?{s:a.sums}:{}}encodeHighlightingMode(a){return a.highlightingMode&&((0,e.Z)(a)||"inline"!==a.highlightingMode)?{hl:a.highlightingMode}:{}}encodeHighlightedAttributes(a){return"inline"===a.highlightingMode&&Array.isArray(a.highlightedAttributes)&&a.highlightedAttributes.length>0?{hla:a.highlightedAttributes.map(p=>p.id)}:{}}encodeSortBy(a){return a.sortBy?{t:a.sortBy.map(p=>p.id.replace("-",":")).join()}:{}}encodeFilters(a){return a&&a.length>0?{f:a.map(l=>({n:l.id,o:l.operator.id,v:l.values.map(d=>this.queryFilterValueToParam(d))}))}:{f:[]}}encodeTimelineVisible(a){const p={};return a.timelineVisible?(p.tv=a.timelineVisible,_.isEmpty(a.timelineLabels)||(p.tll=JSON.stringify(a.timelineLabels)),p.tzl=a.timelineZoomLevel):p.tv=!1,p}buildV3GetQueryFromJsonParams(a){const p={pageSize:this.paginationService.getPerPage()};if(!a)return p;const l=JSON.parse(a);if(l.c&&(p["columns[]"]=l.c.map(d=>d)),l.s&&(p.showSums=l.s),p.timelineVisible=l.tv,l.tv&&(l.tll&&(p.timelineLabels=l.tll),l.tzl&&(p.timelineZoomLevel=l.tzl)),l.dr&&(p.displayRepresentation=l.dr),void 0!==l.is&&(p.includeSubprojects=l.is),l.hl&&(p.highlightingMode=l.hl),l.hla&&(p["highlightedAttributes[]"]=l.hla.map(d=>d)),void 0!==l.hi&&(p.showHierarchies=l.hi),p.groupBy=_.get(l,"g",""),l.f){const d=l.f.map(g=>{const C={operator:decodeURIComponent(g.o)};if(g.v){const m=Array.isArray(g.v)?g.v:[g.v];_.extend(C,{values:m})}const y={};return y[g.n]=C,y});p.filters=JSON.stringify(d)}return l.t&&(p.sortBy=JSON.stringify(l.t.split(",").map(d=>d.split(":")))),l.pa&&(p.offset=l.pa),l.pp&&(p.pageSize=l.pp),p}buildV3GetQueryFromQueryResource(a,p={},l={}){const d={};return d["columns[]"]=this.buildV3GetColumnsFromQueryResource(a),d.showSums=a.sums,d.timelineVisible=!!a.timelineVisible,a.timelineVisible&&(d.timelineZoomLevel=a.timelineZoomLevel,d.timelineLabels=JSON.stringify(a.timelineLabels)),a.highlightingMode&&(d.highlightingMode=a.highlightingMode),a.highlightedAttributes&&"inline"===a.highlightingMode&&(d["highlightedAttributes[]"]=a.highlightedAttributes.map(g=>g.href)),a.displayRepresentation&&(d.displayRepresentation=a.displayRepresentation),d.includeSubprojects=!!a.includeSubprojects,d.showHierarchies=!!a.showHierarchies,d.groupBy=_.get(a.groupBy,"id",""),d.filters=this.buildV3GetFiltersAsJson(a.filters,l),d.sortBy=this.buildV3GetSortByFromQuery(a),_.extend(p,d)}queryFilterValueToParam(a){if("boolean"==typeof a)return a?"t":"f";if(!a)return"";const p=a;return p.id?p.id.toString():p.href?p.href.split("/").pop():a.toString()}buildV3GetColumnsFromQueryResource(a){return a.columns?a.columns.map(p=>p.id||(0,i.Z)(p.href)):a._links.columns?a._links.columns.map(p=>{const l=p.href;return this.idFromHref(l)}):void 0}buildV3GetFilters(a,p={}){return a.map(d=>{const g=this.buildV3GetFilterIdFromFilter(d),C=this.buildV3GetOperatorIdFromFilter(d),y=this.buildV3GetValuesFromFilter(d).map(E=>(_.each(p,(P,w)=>{E=E.replace(`{${w}}`,P)}),E)),m={};return m[g]={operator:C,values:y},m})}filterBuilderFrom(a){const p=new c.qM;return a.forEach(l=>{const d=this.buildV3GetFilterIdFromFilter(l),g=this.buildV3GetOperatorIdFromFilter(l),C=this.buildV3GetValuesFromFilter(l);p.add(d,g,C)}),p}buildV3GetFiltersAsJson(a,p={}){return JSON.stringify(this.buildV3GetFilters(a,p))}buildV3GetFilterIdFromFilter(a){const p=a.filter?a.filter.href:a._links.filter.href;return this.idFromHref(p)}buildV3GetValuesFromFilter(a){return a.values?_.map(a.values,p=>this.queryFilterValueToParam(p)):_.map(a._links.values,p=>this.idFromHref(p.href))}buildV3GetOperatorIdFromFilter(a){if(a.operator)return a.operator.id||(0,i.Z)(a.operator.href);const{href:p}=a._links.operator;return this.idFromHref(p)}buildV3GetSortByFromQuery(a){const l=(a.sortBy?a.sortBy:a._links.sortBy).map(d=>{if(d.id)return d.id;const g=d.href;return this.idFromHref(g)});return JSON.stringify(l.map(d=>d.split("-")))}idFromHref(a){const p=a.substring(a.lastIndexOf("/")+1,a.length);return decodeURIComponent(p)}}n.\u0275fac=function(a){return new(a||n)(r.LFG(u.N))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})},85388:(H,D,t)=>{"use strict";t.d(D,{j:()=>n});var i=t(41945),e=t(8403),c=t(5602),u=t(44022),r=t(2316);class n extends e.m{constructor(a,p,l){super(a),this.injector=a,this.wpRelationsHierarchyService=p,this.schemaCache=l,this.referenceComponentClass=c.A,this.relationType="children",this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing_child"),create:this.I18n.t("js.relation_buttons.add_new_child")}}add(a,p){return this.wpRelationsHierarchyService.addExistingChildWp(a,p)}remove(a,p){return this.wpRelationsHierarchyService.removeChild(p)}get canAdd(){return!!(this.referenceTarget&&this.canCreateWorkPackages&&this.canAddChild)}get canReference(){return!(!this.referenceTarget||!this.canAddChild)}get canAddChild(){return this.schema&&!this.schema.isMilestone&&this.referenceTarget.changeParent}get schema(){return this.referenceTarget&&this.schemaCache.of(this.referenceTarget)}}n.\u0275fac=function(a){return new(a||n)(r.LFG(r.zs3),r.LFG(i.O),r.LFG(u.y))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac})},74012:(H,D,t)=>{"use strict";t.d(D,{u:()=>b});var i=t(96617),e=t(70233),u=(t(24897),t(55977)),r=t(41945),n=t(23893),h=t(8403),a=t(97248),p=t(85388),l=t(9170),g=(t(17577),t(1403)),C=t(20979),y=t(10190),m=t(2316),E=t(54364),P=t(166);function w(v,M){if(1&v&&(m.TgZ(0,"div",4),m.TgZ(1,"div",5),m._UZ(2,"h3",6),m.qZA(),m.qZA()),2&v){const S=m.oxw(2);m.xp6(2),m.Q6J("textContent",S.group.name)}}const x=function(v){return{actionsColumnEnabled:!0,hierarchyToggleEnabled:!1,inlineCreateEnabled:!0,compactTableStyle:!0,columnMenuEnabled:!1,contextMenuEnabled:!1,projectIdentifier:v,projectContext:!1}};function k(v,M){if(1&v){const S=m.EpF();m.ynx(0),m.YNc(1,w,3,1,"div",1),m.TgZ(2,"wp-embedded-table",2,3),m.NdJ("onQueryLoaded",function(A){return m.CHM(S),m.oxw().handleQueryLoaded(A)}),m.qZA(),m.BQk()}if(2&v){const S=m.oxw();m.xp6(1),m.Q6J("ngIf",S.group),m.xp6(1),m.Q6J("initialLoadingIndicator",!1)("queryProps",S.queryProps)("tableActions",S.tableActions)("configuration",m.VKq(5,x,S.idFromLink(S.workPackage.project.href)))}}class b extends a.y{constructor(M,S,O,A,F,I,J){super(I),this.wpRelationsHierarchyService=M,this.PathHelper=S,this.wpInlineCreate=O,this.halEvents=A,this.apiV3Service=F,this.queryUrlParamsHelper=I,this.I18n=J,this.addExistingChildEnabled=!1,this.idFromLink=y.Z,this.tableActions=[n.g.factoryFor("remove-child-action",this.I18n.t("js.relation_buttons.remove_child"),N=>{this.embeddedTable&&(this.embeddedTable.loadingIndicator=this.wpRelationsHierarchyService.removeChild(N))},N=>!!N.changeParent)]}ngOnInit(){this.wpInlineCreate.referenceTarget=this.workPackage,this.queryProps=this.buildQueryProps(),this.wpInlineCreate.newInlineWorkPackageCreated.pipe(this.untilDestroyed()).subscribe(M=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:M,relationType:"child"})}),this.apiV3Service.work_packages.id(this.workPackage).observe().pipe((0,l.h)(()=>{var M;return!!(null===(M=this.embeddedTable)||void 0===M?void 0:M.isInitialized)}),this.untilDestroyed()).subscribe(()=>this.refreshTable())}}b.\u0275fac=function(M){return new(M||b)(m.Y36(r.O),m.Y36(e.j),m.Y36(h.m),m.Y36(g.J),m.Y36(C.T),m.Y36(u.Z),m.Y36(i.D))},b.\u0275cmp=m.Xpm({type:b,selectors:[["wp-children-query"]],inputs:{workPackage:"workPackage",query:"query",group:"group",addExistingChildEnabled:"addExistingChildEnabled"},features:[m._Bn([{provide:h.m,useClass:p.j}]),m.qOj],decls:1,vars:1,consts:[[4,"ngIf"],["class","attributes-group--header",4,"ngIf"],[3,"initialLoadingIndicator","queryProps","tableActions","configuration","onQueryLoaded"],["embeddedTable",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(M,S){1&M&&m.YNc(0,k,4,7,"ng-container",0),2&M&&m.Q6J("ngIf",!S.hidden)},directives:[E.O5,P.Z],encapsulation:2})},5602:(H,D,t)=>{"use strict";t.d(D,{A:()=>y});var i=t(96617),e=t(8403),c=t(84366),u=t(53457),r=t(55977),n=t(69057),h=t(1403),a=t(20979),p=t(62964),l=t(43440),d=t(2316),g=t(11950),C=t(2775);class y{constructor(E,P,w,x,k,b,v,M,S){this.parent=E,this.wpInlineCreate=P,this.apiV3Service=w,this.wpRelations=x,this.notificationService=k,this.halEvents=b,this.urlParamsHelper=v,this.querySpace=M,this.I18n=S,this.isDisabled=!1,this.queryFilters=this.buildQueryFilters(),this.text={abort:this.I18n.t("js.relation_buttons.abort")}}addExisting(){if(_.isNil(this.selectedWpId))return;const E=this.selectedWpId;this.isDisabled=!0,this.wpInlineCreate.add(this.workPackage,E).then(()=>{this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:E,relationType:this.relationType}),this.isDisabled=!1,this.wpInlineCreate.newInlineWorkPackageReferenced.next(E),this.cancel()}).catch(P=>{this.notificationService.handleRawError(P,this.workPackage),this.isDisabled=!1,this.cancel()})}onSelected(E){E&&(this.selectedWpId=E.id,this.addExisting())}get relationType(){return this.wpInlineCreate.relationType}get workPackage(){return this.wpInlineCreate.referenceTarget}cancel(){this.parent.resetRow()}buildQueryFilters(){const E=this.querySpace.query.value;if(!E)return[];const P=n.d.RELATION_TYPES(!0),w=E.filters.filter(x=>{const k=this.urlParamsHelper.buildV3GetFilterIdFromFilter(x);return-1===P.indexOf(k)});return this.urlParamsHelper.buildV3GetFilters(w)}}y.\u0275fac=function(E){return new(E||y)(d.Y36(c.I),d.Y36(e.m),d.Y36(a.T),d.Y36(u.V),d.Y36(p.q),d.Y36(h.J),d.Y36(r.Z),d.Y36(l.q),d.Y36(i.D))},y.\u0275cmp=d.Xpm({type:y,selectors:[["ng-component"]],decls:7,vars:4,consts:[["data-indicator-name","relationAddChild",1,"loading-indicator--location"],[1,"wp-relations-create--form","wp-relations--add-form"],[1,"wp-relations-input-section"],["hiddenOverflowContainer",".work-packages-full-view--split-left",3,"workPackage","additionalFilters","filterCandidatesFor","onSelected"],[1,"wp-relations-controls-section","relation-row"],["type","button",1,"spot-link","wp-create-relation--cancel",3,"click"],["icon-classes","icon-remove icon-no-color",3,"icon-title"]],template:function(E,P){1&E&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"div",2),d.TgZ(3,"wp-relations-autocomplete",3),d.NdJ("onSelected",function(x){return P.onSelected(x)}),d.qZA(),d.qZA(),d.TgZ(4,"div",4),d.TgZ(5,"button",5),d.NdJ("click",function(){return P.cancel()}),d._UZ(6,"op-icon",6),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&E&&(d.xp6(3),d.Q6J("workPackage",P.workPackage)("additionalFilters",P.queryFilters)("filterCandidatesFor",P.relationType),d.xp6(3),d.Q6J("icon-title",P.text.abort))},directives:[g.t,C.o],encapsulation:2})},32869:(H,D,t)=>{"use strict";t.d(D,{x:()=>h});var i=t(3786),e=t(8403),c=t(5602),u=t(53457),r=t(29161),n=t(2316);class h extends e.m{constructor(p){super(p),this.injector=p,this.referenceComponentClass=c.A,this.relationType="",this.referenceTarget=null,this.buttonTexts={reference:this.I18n.t("js.relation_buttons.add_existing"),create:this.I18n.t("js.relation_buttons.create_new")}}add(p,l){return this.wpRelations.addCommonRelation(l,this.relationType,p.id)}remove(p,l){const d=this.wpRelations.find(l,p,this.relationType);return void 0!==d?this.wpRelations.removeRelation(d):Promise.reject()}get canAdd(){return!!(this.referenceTarget&&this.canCreateWorkPackages&&this.referenceTarget.addRelation)}get canReference(){return!!this.canAdd}}h.\u0275fac=function(p){return new(p||h)(n.LFG(n.zs3))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac}),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.V)],h.prototype,"wpRelations",void 0)},97248:(H,D,t)=>{"use strict";t.d(D,{y:()=>h});t(166);var e=t(17577),c=t(55977),u=t(26942),r=t(2316);const n=["embeddedTable"];class h extends u.N{constructor(p){super(),this.queryUrlParamsHelper=p,this.hidden=!1}refreshTable(){var p;(null===(p=this.embeddedTable)||void 0===p?void 0:p.isInitialized)&&this.embeddedTable.loadQuery(!0,!1)}handleQueryLoaded(p){if(!(this.query instanceof e.P))return;const l=this.projectValuesCount(this.query),d=this.projectValuesCount(p);null!==l&&null===d&&(this.hidden=!0),l&&d&&l>0&&0===d&&(this.hidden=!0)}projectValuesCount(p){const l=p.filters.find(d=>"project"===d.id);return l?l.values.length:null}buildQueryProps(){return this.query instanceof e.P?this.queryUrlParamsHelper.buildV3GetQueryFromQueryResource(this.query,{valid_subset:!0},{id:this.workPackage.id}):this.query}}h.\u0275fac=function(p){return new(p||h)(r.Y36(c.Z))},h.\u0275dir=r.lG2({type:h,viewQuery:function(p,l){if(1&p&&r.Gf(n,5),2&p){let d;r.iGM(d=r.CRH())&&(l.embeddedTable=d.first)}},features:[r.qOj]})},11950:(H,D,t)=>{"use strict";t.d(D,{t:()=>m});var i=t(2316),e=t(96617),u=(t(24897),t(81134)),r=t(30400),n=t(33927),h=t(18293),a=t(43440),p=t(70233),l=t(65146),d=t(91923),g=t(44022),C=t(62964),y=t(91593);class m{constructor(P,w,x,k,b,v,M,S,O){this.querySpace=P,this.pathHelper=w,this.notificationService=x,this.CurrentProject=k,this.halResourceService=b,this.schemaCacheService=v,this.cdRef=M,this.ngZone=S,this.I18n=O,this.text={placeholder:this.I18n.t("js.relations_autocomplete.placeholder")},this.inputPlaceholder=this.text.placeholder,this.additionalFilters=[],this.hiddenOverflowContainer="body",this.onCancel=new i.vpe,this.onSelected=new i.vpe,this.onEmptySelected=new i.vpe,this.getAutocompleterData=A=>null===A||0===A.length?(0,u.of)([]):(0,r.D)(this.workPackage.availableRelationCandidates.$link.$fetch({query:A,filters:JSON.stringify(this.additionalFilters),type:this.filterCandidatesFor||this.selectedRelationType})).pipe((0,n.U)(F=>F.elements),(0,h.K)(F=>(this.notificationService.handleRawError(F),(0,u.of)([])))),this.autocompleterOptions={resource:"work_packages",getOptionsFn:this.getAutocompleterData},this.appendToContainer="body"}reset(){this.cancel()}cancel(){this.onCancel.emit()}onWorkPackageSelected(P){P&&this.schemaCacheService.ensureLoaded(P).then(()=>{this.onSelected.emit(P),this.ngSelectComponent.ngSelectInstance.close()})}onOpen(){this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.ngSelectComponent.repositionDropdown(),jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this.ngSelectComponent.closeSelect()})},25)})}}m.\u0275fac=function(P){return new(P||m)(i.Y36(a.q),i.Y36(p.j),i.Y36(C.q),i.Y36(l.R),i.Y36(d.u),i.Y36(g.y),i.Y36(i.sBO),i.Y36(i.R0b),i.Y36(e.D))},m.\u0275cmp=i.Xpm({type:m,selectors:[["wp-relations-autocomplete"]],viewQuery:function(P,w){if(1&P&&i.Gf(y.s,7),2&P){let x;i.iGM(x=i.CRH())&&(w.ngSelectComponent=x.first)}},hostBindings:function(P,w){1&P&&i.NdJ("keydown.escape",function(){return w.reset()})},inputs:{inputPlaceholder:"inputPlaceholder",workPackage:"workPackage",selectedRelationType:"selectedRelationType",filterCandidatesFor:"filterCandidatesFor",additionalFilters:"additionalFilters",hiddenOverflowContainer:"hiddenOverflowContainer"},outputs:{onCancel:"onCancel",onSelected:"onSelected",onEmptySelected:"onEmptySelected"},decls:1,vars:6,consts:[["classes","wp-relations-autocomplete","data-qa-selector","wp-relations-autocomplete",3,"appendTo","placeholder","typeToSearchText","resource","defaultData","getOptionsFn","open","change"]],template:function(P,w){1&P&&(i.TgZ(0,"op-autocompleter",0),i.NdJ("open",function(){return w.onOpen()})("change",function(k){return w.onWorkPackageSelected(k)}),i.qZA()),2&P&&i.Q6J("appendTo",w.appendToContainer)("placeholder",w.inputPlaceholder)("typeToSearchText",w.inputPlaceholder)("resource",w.autocompleterOptions.resource)("defaultData",!1)("getOptionsFn",w.autocompleterOptions.getOptionsFn)},directives:[y.s],styles:[".wp-relations-autocomplete{border:none}.wp-relations-autocomplete .ng-clear-wrapper{display:none}\n"],encapsulation:2})},41945:(H,D,t)=>{"use strict";t.d(D,{O:()=>a});var i=t(87853),e=t(47775),c=t(70233),u=t(62964),r=t(20979),n=t(1403),h=t(2316);class a{constructor(l,d,g,C,y,m){this.$state=l,this.states=d,this.halEvents=g,this.notificationService=C,this.pathHelper=y,this.apiV3Service=m}changeParent(l,d){const g={lockVersion:l.lockVersion};return g._links=d?{parent:{href:this.apiV3Service.work_packages.id(d).path}}:{parent:{href:null}},l.changeParent(g).then(C=>(this.apiV3Service.work_packages.cache.updateWorkPackage(C),this.notificationService.showSave(C),this.halEvents.push(l,{eventType:"association",relatedWorkPackage:d,relationType:"parent"}),C)).catch(C=>(this.notificationService.handleRawError(C,l),Promise.reject(C)))}removeParent(l){return this.changeParent(l,null)}addExistingChildWp(l,d){return this.apiV3Service.work_packages.id(d).get().toPromise().then(g=>this.changeParent(g,l.id).then(C=>(this.apiV3Service.work_packages.id(l).refresh(),this.halEvents.push(l,{eventType:"association",relatedWorkPackage:g.id,relationType:"child"}),C)))}addNewChildWp(l,d){d.project.$load().then(()=>{const g=[`${l}.new`,{parent_id:d.id}];this.$state.includes("work-packages.show")&&(g[0]="work-packages.new"),this.$state.go(...g)})}removeChild(l){return l.$load().then(()=>{const d=l.parent;return l.changeParent({_links:{parent:{href:null}},lockVersion:l.lockVersion}).then(g=>{d&&this.apiV3Service.work_packages.id(d).refresh().then(C=>{this.halEvents.push(C,{eventType:"association",relatedWorkPackage:null,relationType:"child"})}),this.apiV3Service.work_packages.cache.updateWorkPackage(g)}).catch(g=>(this.notificationService.handleRawError(g,l),Promise.reject(g)))})}}a.\u0275fac=function(l){return new(l||a)(h.LFG(e.StateService),h.LFG(i.G),h.LFG(n.J),h.LFG(u.q),h.LFG(c.j),h.LFG(r.T))},a.\u0275prov=h.Yz7({token:a,factory:a.\u0275fac})},53457:(H,D,t)=>{"use strict";t.d(D,{V:()=>l});var i=t(70233),e=t(14808),c=t(91923),u=t(20979),r=t(79175),n=t(53466),h=t(33927),a=t(2316);class p extends e.Ui{constructor(){super(),this.name="WP-Relations",this.relations=(0,e.r9)(),this.initializeMembers()}}class l extends r.r{constructor(g,C,y){super((new p).relations),this.PathHelper=g,this.apiV3Service=C,this.halResource=y}require(g,C=!1){return this.requireAndStream(g,C).pipe((0,n.q)(1)).toPromise()}requireAndStream(g,C=!1){return(this.stale(g)||C)&&this.clearAndLoad(g,this.load(g)),this.state(g).values$()}load(g){return this.apiV3Service.work_packages.id(g).relations.get().pipe((0,h.U)(C=>this.relationsStateValue(g,C.elements)))}requireAll(g){return new Promise((C,y)=>{this.apiV3Service.relations.loadInvolved(g).toPromise().then(m=>{this.clearSome(...g),this.accumulateRelationsFromInvolved(g,m),C(void 0)}).catch(y)})}find(g,C,y){const m=this.state(g.id).value;if(m)return _.find(m,E=>{const P=E.denormalized(g);return P.target.id===C.id&&P.relationType===y})}removeRelation(g){return g.delete().then(()=>{this.removeFromStates(g)})}updateRelationType(g,C,y,m){const E={_links:{from:{href:g.href},to:{href:C.href}},type:m};return this.updateRelation(y,E)}updateRelation(g,C){return g.updateImmediately(C).then(y=>(this.insertIntoStates(y),y))}addCommonRelation(g,C,y){const m={_links:{from:{href:this.apiV3Service.work_packages.id(g).toString()},to:{href:this.apiV3Service.work_packages.id(y).toString()}},type:C},E=this.apiV3Service.work_packages.id(g).relations.toString();return this.halResource.post(E,m).toPromise().then(P=>(this.insertIntoStates(P),P))}insertIntoStates(g){_.values(g.ids).forEach(C=>{this.multiState.get(C).doModify(y=>(y[g.id]=g,y),()=>{const y={};return y[g.id]=g,y})})}removeFromStates(g){_.values(g.ids).forEach(C=>{this.multiState.get(C).doModify(y=>(delete y[g.id],y),()=>({}))})}relationsStateValue(g,C){return _.keyBy(C,y=>y.id)}accumulateRelationsFromInvolved(g,C){g.forEach(y=>{const m=C.filter(P=>P.isInvolved(y)),E=this.relationsStateValue(y,m);this.updateValue(y,E)})}}l.\u0275fac=function(g){return new(g||l)(a.LFG(i.j),a.LFG(u.T),a.LFG(c.u))},l.\u0275prov=a.Yz7({token:l,factory:l.\u0275fac})},54892:(H,D,t)=>{"use strict";t.d(D,{a:()=>n});var i=t(12877),e=t(61289),c=t(70692);class u{constructor(a,p,l,d,g){this.timezoneService=a,this.isReversed=p,this.activities=l,this.activity=d,this.index=g,this.date=this.activityDate(this.activity),this.dateOfPrevious=this.index>0?this.activityDate(this.activities[this.index-1]):void 0,this.isNextDate=this.date!==this.dateOfPrevious}number(a=!1){return this.orderedIndex(this.index,a)}get href(){return this.activity.href}get identifier(){return`${this.href}-${this.version}`}get version(){return this.activity.version}isInitial(a=!1){let p=this.number(a);if(0!==this.activity._type.indexOf("Activity"))return!1;if(1===p)return!0;for(;--p>0;){const l=this.orderedIndex(p,a)-1,d=this.activities[l];if(!_.isNil(d)&&0===d._type.indexOf("Activity"))return!1}return!0}activityDate(a){return moment(a.createdAt).format("LL")}orderedIndex(a,p=!1){return p||this.isReversed?this.activities.length-a:a+1}}var r=t(2316);class n extends e.N{constructor(a,p){super(),this.ConfigurationService=a,this.timezoneService=p}get order(){return this.isReversed?"desc":"asc"}get isReversed(){return!!this.ConfigurationService.commentsSortedInDescendingOrder()}load(a){const p=[],l=[],d=function(g){p.push(g.elements)};return l.push(a.activities.$update().then(d)),a.revisions&&l.push(a.revisions.$update().then(d)),Promise.all(l).then(()=>this.sortedActivityList(p))}sortedActivityList(a,p="createdAt"){const l=_.sortBy(_.flatten(a),p);return this.isReversed?l.reverse():l}info(a,p,l){return new u(this.timezoneService,this.isReversed,a,p,l)}}n.\u0275fac=function(a){return new(a||n)(r.LFG(i.e),r.LFG(c.B))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac})},84109:(H,D,t)=>{"use strict";t.d(D,{p:()=>r});var i=t(47775),e=t(84224),c=t(70482),u=t(2316);class r{constructor(h,a,p){this.$state=h,this.uiRouterGlobals=a,this.$transitions=p,this.currentTab="overview",this.subject=new e.t(1),this.updateTabs(),p.onSuccess({},l=>{this.updateTabs(l.params("to").tabIdentifier)})}get observable(){return this.subject}get lastActiveTab(){return this.isCurrentState("show")?this.currentShowTab:this.currentDetailsTab}goCurrentShowState(h={}){this.$state.go("work-packages.show.tabs",Object.assign(Object.assign(Object.assign({},this.uiRouterGlobals.params),h),{tabIdentifier:this.currentShowTab}))}goCurrentDetailsState(h={}){const a=(0,c.W)(this.$state);this.$state.go(`${a}.tabs`,Object.assign(Object.assign(Object.assign({},this.uiRouterGlobals.params),h),{tabIdentifier:this.currentDetailsTab}))}isDetailsState(h){return!!h&&h.includes(".details")}get currentShowTab(){return"overview"===this.currentTab?"activity":this.currentTab}get currentDetailsTab(){return this.currentTab}get currentTabIdentifier(){return this.uiRouterGlobals.params.tabIdentifier}notify(){this.subject.next({active:this.lastActiveTab,show:this.currentShowTab,details:this.currentDetailsTab})}updateTab(h){this.isCurrentState(h)&&(this.currentTab=this.uiRouterGlobals.params.tabIdentifier,this.notify())}isCurrentState(h){return"show"===h?this.$state.includes("work-packages.show.*"):"details"===h&&this.$state.includes("**.details.*")}updateTabs(h){if(this.isCurrentState("show")&&"activity"===h)return this.currentTab="overview",this.notify();this.updateTab("show"),this.updateTab("details")}}r.\u0275fac=function(h){return new(h||r)(u.LFG(i.StateService),u.LFG(i.UIRouterGlobals),u.LFG(i.TransitionService))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"})},18236:(H,D,t)=>{"use strict";t.d(D,{h:()=>y});var i=t(47775),e=t(86469),c=t(96617),u=t(84939),r=t(70233),n=t(43682),h=t(62964),a=t(26942),p=t(20979),l=t(2316);function d(m,E){if(1&m&&(l.TgZ(0,"div",8),l.TgZ(1,"div",9),l._UZ(2,"p",10),l.qZA(),l.qZA()),2&m){const P=l.oxw();l.xp6(2),l.Q6J("textContent",P.text.loadingError)}}function g(m,E){if(1&m&&l._UZ(0,"op-wp-watcher-entry",11),2&m){const P=E.$implicit;l.Q6J("watcher",P)}}const C=function(m){return{"-read-only":m}};class y extends a.N{constructor(E,P,w,x,k,b,v,M,S){super(),this.I18n=E,this.elementRef=P,this.wpWatchersService=w,this.$transition=x,this.notificationService=k,this.loadingIndicator=b,this.cdRef=v,this.pathHelper=M,this.apiV3Service=S,this.trackByHref=n.u9,this.error=!1,this.noResults=!1,this.allowedToView=!1,this.allowedToAdd=!1,this.allowedToRemove=!1,this.watching=[],this.text={loading:this.I18n.t("js.watchers.label_loading"),loadingError:this.I18n.t("js.watchers.label_error_loading"),autocomplete:{placeholder:this.I18n.t("js.watchers.typeahead_placeholder")}}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.workPackageId=this.$transition.params("to").workPackageId,this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(E=>{this.workPackage=E,this.loadCurrentWatchers()}),this.availableWatchersPath=this.apiV3Service.work_packages.id(this.workPackageId).available_watchers.path}loadCurrentWatchers(){this.error=!1,this.allowedToView=!!this.workPackage.watchers,this.allowedToAdd=!!this.workPackage.addWatcher,this.allowedToRemove=!!this.workPackage.removeWatcher,this.allowedToView?this.wpWatchersService.require(this.workPackage).then(E=>{this.watching=E,this.cdRef.detectChanges()}).catch(E=>{this.notificationService.showError(E,this.workPackage)}):this.error=!0}set loadingPromise(E){this.loadingIndicator.wpDetails.promise=E}addWatcher(E){this.loadingPromise=this.workPackage.addWatcher.$link.$fetch({user:{href:E.href}}).then(()=>{this.wpWatchersService.require(this.workPackage,!0),this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.cdRef.detectChanges()}).catch(P=>this.notificationService.showError(P,this.workPackage))}removeWatcher(E){this.workPackage.removeWatcher.$link.$prepare({user_id:E.id})().then(()=>{_.remove(this.watching,P=>P.href===E.href),this.wpWatchersService.require(this.workPackage,!0),this.apiV3Service.work_packages.id(this.workPackage).refresh(),this.cdRef.detectChanges()}).catch(P=>this.notificationService.showError(P,this.workPackage))}}y.\u0275fac=function(E){return new(E||y)(l.Y36(c.D),l.Y36(l.SBq),l.Y36(u.W),l.Y36(i.Transition),l.Y36(h.q),l.Y36(e.vt),l.Y36(l.sBO),l.Y36(r.j),l.Y36(p.T))},y.\u0275cmp=l.Xpm({type:y,selectors:[["wp-watchers-tab"]],features:[l.qOj],decls:8,vars:10,consts:[["id","detail-panel-watchers"],["class","op-toast -error",4,"ngIf"],[3,"hidden"],[1,"work-package--watchers","form--selected-value--list",3,"ngClass"],[3,"watcher",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package--watchers-lookup","hide-when-print",3,"hidden"],["name","watcherForm","novalidate",""],[1,"wp-watcher--autocomplete",3,"clearAfterSelection","url","onChange"],[1,"op-toast","-error"],[1,"op-toast--content"],[3,"textContent"],[3,"watcher"]],template:function(E,P){1&E&&(l.TgZ(0,"div",0),l.YNc(1,d,3,1,"div",1),l.TgZ(2,"div",2),l.TgZ(3,"div",3),l.YNc(4,g,1,1,"op-wp-watcher-entry",4),l.qZA(),l.TgZ(5,"div",5),l.TgZ(6,"form",6),l.TgZ(7,"user-autocompleter",7),l.NdJ("onChange",function(x){return P.addWatcher(x)}),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&E&&(l.xp6(1),l.Q6J("ngIf",P.error),l.xp6(1),l.Q6J("hidden",P.error),l.xp6(1),l.Q6J("ngClass",l.VKq(8,C,!P.allowedToRemove)),l.xp6(1),l.Q6J("ngForOf",P.watching)("ngForTrackBy",P.trackByHref),l.xp6(1),l.Q6J("hidden",!P.allowedToAdd),l.xp6(2),l.Q6J("clearAfterSelection",!0)("url",P.availableWatchersPath))},encapsulation:2,changeDetection:0})},84939:(H,D,t)=>{"use strict";t.d(D,{W:()=>c});var i=t(61289),e=t(2316);class c extends i.N{load(r){return r.watchers.$update().then(n=>n.elements)}}c.\u0275fac=function(){let u;return function(n){return(u||(u=e.n5z(c)))(n||c)}}(),c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac})},61289:(H,D,t)=>{"use strict";t.d(D,{N:()=>r});var i=t(14808),e=t(53466),c=t(81134);t(19100).hi;class r{constructor(){this.cacheDurationInSeconds=120,this.cache={id:null,state:(0,i.qH)()}}requireAndStream(h,a=!1){const p=h.id,{state:l}=this.cache;return(a||this.cache.id!==p)&&l.clear(),this.isCached(p)?(0,c.of)(l.value):(this.cache.id=p,this.cache.state.putFromPromiseIfPristine(()=>this.load(h)),this.cache.state.values$())}require(h,a=!1){return this.requireAndStream(h,a).pipe((0,e.q)(1)).toPromise()}clear(h){this.cache.id===h&&this.cache.state.clear()}isCached(h){const{state:a}=this.cache;return this.cache.id===h&&a.hasValue()&&!a.isValueOlderThan(1e3*this.cacheDurationInSeconds)}}},77180:(H,D,t)=>{"use strict";t.d(D,{G:()=>vt});var i=t(47775),e=t(96617),c=t(70233),u=t(83720),r=t(33927),h=(t(24897),t(12703)),a=t(60874),p=t(17577),l=t(53448),d=t(79441),g=t(68197),C=t(1056),y=t(91923),m=t(10190),E=t(84699),P=t(26942),w=t(65146),x=t(87853),k=t(44022),b=t(3352),v=t(2316),M=t(54364),S=t(20979),O=t(54892),A=t(1403),F=t(62964);t(53407);class J{constructor(Le,Ee,st,ut,It,Zt,Ut){this.halResourceService=Le,this.apiV3Service=Ee,this.wpSchemaCacheService=st,this.wpActivity=ut,this.notificationService=It,this.halEditing=Zt,this.halEvents=Ut}fetchAction(){this.halResourceService.get(this.action.href).toPromise().then(Le=>{this.action=Le})}update(){const Le={lockVersion:this.workPackage.lockVersion,_links:{workPackage:{href:this.workPackage.href}}};this.halResourceService.post(`${this.action.href}/execute`,Le).subscribe(Ee=>{this.notificationService.showSave(Ee,!1),this.workPackage=Ee,this.wpActivity.clear(this.workPackage.id),this.apiV3Service.work_packages.cache.updateWorkPackage(Ee).then(()=>{this.halEditing.stopEditing(Ee),this.halEvents.push(Ee,{eventType:"updated"})})},Ee=>this.notificationService.handleRawError(Ee,this.workPackage))}onMouseEnter(){this.fetchAction()}}function N(Ue,Le){if(1&Ue&&v._UZ(0,"wp-custom-action",1),2&Ue){const Ee=Le.$implicit,st=v.oxw();v.Q6J("workPackage",st.workPackage)("action",Ee)}}J.\u0275fac=function(Le){return new(Le||J)(v.Y36(y.u),v.Y36(S.T),v.Y36(k.y),v.Y36(O.a),v.Y36(F.q),v.Y36(h.l),v.Y36(A.J))},J.\u0275cmp=v.Xpm({type:J,selectors:[["wp-custom-action"]],hostBindings:function(Le,Ee){1&Le&&v.NdJ("mouseenter",function(){return Ee.onMouseEnter()})},inputs:{workPackage:"workPackage",action:"action"},decls:2,vars:2,consts:[[1,"custom-action--button","button","-narrow","hide-when-print",3,"title","click"]],template:function(Le,Ee){1&Le&&(v.TgZ(0,"button",0),v.NdJ("click",function(){return Ee.update()}),v._uU(1),v.qZA()),2&Le&&(v.s9C("title",Ee.action.description?Ee.action.description:Ee.action.name),v.xp6(1),v.hij(" ",Ee.action.name,"\n"))},encapsulation:2});class te extends P.N{constructor(Le,Ee){super(),this.apiV3Service=Le,this.cdRef=Ee,this.actions=[]}ngOnInit(){this.apiV3Service.work_packages.id(this.workPackage.id).requireAndStream().pipe(this.untilDestroyed()).subscribe(Le=>{this.actions=Le.customActions?[...Le.customActions]:[],this.cdRef.detectChanges()})}}te.\u0275fac=function(Le){return new(Le||te)(v.Y36(S.T),v.Y36(v.sBO))},te.\u0275cmp=v.Xpm({type:te,selectors:[["wp-custom-actions"]],inputs:{workPackage:"workPackage"},features:[v.qOj],decls:1,vars:1,consts:[["class","custom-action",3,"workPackage","action",4,"ngFor","ngForOf"],[1,"custom-action",3,"workPackage","action"]],template:function(Le,Ee){1&Le&&v.YNc(0,N,1,2,"wp-custom-action",0),2&Le&&v.Q6J("ngForOf",Ee.actions)},directives:[M.sg,J],encapsulation:2,changeDetection:0});var ee=t(54262),G=t(96418),se=t(83845),me=t(65532),_e=t(21501),he=t(35403),ae=t(32853),re=t(97047),ye=t(2775),Ce=t(84906);function ke(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",17),v._UZ(1,"editable-attribute-field",18),v.qZA()),2&Ue){const Ee=v.oxw(2);v.xp6(1),v.Q6J("resource",Ee.workPackage)("wrapperClasses","-no-label")("fieldName","subject")}}function Ae(Ue,Le){if(1&Ue&&v._UZ(0,"wp-status-button",19),2&Ue){const Ee=v.oxw(2);v.Q6J("workPackage",Ee.workPackage)}}function Fe(Ue,Le){1&Ue&&v._UZ(0,"attribute-help-text",20),2&Ue&&v.Q6J("attribute","status")("attributeScope","WorkPackage")}function ot(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",21),v._UZ(1,"span",22),v._uU(2,": "),v._UZ(3,"span",22),v.TgZ(4,"span"),v._uU(5,"\xa0"),v.qZA(),v._UZ(6,"op-user-link",23),v.TgZ(7,"span"),v._uU(8,".\xa0"),v.qZA(),v._UZ(9,"span",22),v.TgZ(10,"span"),v._uU(11,"\xa0"),v.qZA(),v._UZ(12,"op-date-time",24),v.TgZ(13,"span"),v._uU(14,"."),v.qZA(),v.qZA()),2&Ue){const Ee=v.oxw(2);v.xp6(1),v.Q6J("textContent",Ee.idLabel),v.xp6(2),v.Q6J("textContent",Ee.text.infoRow.createdBy),v.xp6(3),v.Q6J("user",Ee.workPackage.author),v.xp6(3),v.Q6J("textContent",Ee.text.infoRow.lastUpdatedOn),v.xp6(3),v.Q6J("dateTimeValue",Ee.workPackage.updatedAt)}}function it(Ue,Le){1&Ue&&(v.TgZ(0,"span",34),v._uU(1,"*"),v.qZA())}const Ve=function(Ue){return{"-span-all-columns":Ue}};function Ie(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",28),v.TgZ(1,"div",29),v.TgZ(2,"wp-replacement-label",30),v._uU(3),v.YNc(4,it,2,0,"span",31),v.qZA(),v._UZ(5,"attribute-help-text",20),v.qZA(),v.TgZ(6,"div",32),v._UZ(7,"editable-attribute-field",33),v.qZA(),v.qZA()),2&Ue){const Ee=Le.$implicit,st=v.oxw(3);v.Q6J("ngClass",v.VKq(8,Ve,Ee.spanAll)),v.xp6(2),v.Q6J("fieldName",Ee.name),v.xp6(1),v.hij(" ",Ee.label," "),v.xp6(1),v.Q6J("ngIf",Ee.field.required&&Ee.field.writable),v.xp6(1),v.Q6J("attribute",Ee.name)("attributeScope","WorkPackage"),v.xp6(2),v.Q6J("resource",st.workPackage)("fieldName",Ee.name)}}function ue(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",25),v.TgZ(1,"div"),v._UZ(2,"p",26),v.YNc(3,Ie,8,10,"div",27),v.qZA(),v.qZA()),2&Ue){const Ee=v.oxw(2);v.xp6(2),v.Q6J("textContent",Ee.text.project.required),v.xp6(1),v.Q6J("ngForOf",Ee.projectContext.field)("ngForTrackBy",Ee.trackByName)}}function ie(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",35),v.TgZ(1,"div"),v.TgZ(2,"p"),v._UZ(3,"span",36),v._UZ(4,"br"),v._UZ(5,"a",37),v.qZA(),v.qZA(),v.qZA()),2&Ue){const Ee=v.oxw(2);v.xp6(3),v.Q6J("innerHTML",Ee.projectContextText,v.oJD),v.xp6(2),v.Q6J("textContent",Ee.text.project.switchTo),v.uIk("href",Ee.projectContext.href,v.LSH)}}const R=function(Ue){return{workPackage:Ue}};function L(Ue,Le){if(1&Ue&&(v.ynx(0),v._UZ(1,"ndc-dynamic",38),v.BQk()),2&Ue){const Ee=Le.$implicit,st=v.oxw(2);v.xp6(1),v.Q6J("ndcDynamicComponent",Ee)("ndcDynamicInputs",v.VKq(2,R,st.workPackage))}}const W=function(Ue,Le,Ee){return{workPackage:Ue,group:Le,query:Ee}};function oe(Ue,Le){if(1&Ue&&(v.ynx(0,42),v._UZ(1,"ndc-dynamic",38),v.BQk()),2&Ue){const Ee=v.oxw().$implicit,st=v.oxw(2);v.xp6(1),v.Q6J("ndcDynamicComponent",st.attributeGroupComponent(Ee))("ndcDynamicInputs",v.kEZ(2,W,st.workPackage,Ee,Ee.query))}}const Oe=function(Ue,Le){return{workPackage:Ue,group:Le}};function $(Ue,Le){if(1&Ue&&(v.ynx(0),v.TgZ(1,"div",43),v.TgZ(2,"div",44),v._UZ(3,"h3",45),v.qZA(),v.qZA(),v._UZ(4,"ndc-dynamic",46),v.BQk()),2&Ue){const Ee=v.oxw().$implicit,st=v.oxw(2);v.xp6(3),v.Q6J("textContent",Ee.name),v.xp6(1),v.Q6J("ndcDynamicComponent",st.attributeGroupComponent(Ee))("ndcDynamicInjector",st.injector)("ndcDynamicInputs",v.WLB(4,Oe,st.workPackage,Ee))}}function Xe(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",39),v.YNc(1,oe,2,6,"ng-container",40),v.YNc(2,$,5,7,"ng-container",41),v.qZA()),2&Ue){const Ee=Le.$implicit,st=v.oxw(2);v.Q6J("hidden",st.shouldHideGroup(Ee))("ngClass","__overflowing_"+Ee.id),v.uIk("data-group-name",Ee.name)("data-overflowing-identifier",".__overflowing_"+Ee.id),v.xp6(1),v.Q6J("ngIf",Ee.isolated),v.xp6(1),v.Q6J("ngIf",!Ee.isolated)}}const rt=function(Ue){return{"work-package--single-view_with-columns":Ue}};function ge(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",3),v.YNc(1,ke,2,3,"div",4),v.TgZ(2,"div",5),v.YNc(3,Ae,1,1,"wp-status-button",6),v.YNc(4,Fe,1,2,"attribute-help-text",7),v.YNc(5,ot,15,5,"div",8),v._UZ(6,"wp-custom-actions",9),v.qZA(),v.YNc(7,ue,4,3,"div",10),v.YNc(8,ie,6,3,"div",11),v.YNc(9,L,2,4,"ng-container",12),v.TgZ(10,"div",13),v.TgZ(11,"div",14),v._UZ(12,"editable-attribute-field",15),v.qZA(),v.qZA(),v.YNc(13,Xe,3,6,"div",16),v.qZA()),2&Ue){const Ee=v.oxw();v.Q6J("ngClass",v.VKq(15,rt,Ee.showTwoColumnLayout())),v.xp6(1),v.Q6J("ngIf",Ee.isNewResource),v.xp6(2),v.Q6J("ngIf",!Ee.isNewResource),v.xp6(1),v.Q6J("ngIf",!Ee.isNewResource),v.xp6(1),v.Q6J("ngIf",!Ee.isNewResource),v.xp6(1),v.Q6J("workPackage",Ee.workPackage),v.xp6(1),v.Q6J("ngIf",Ee.projectContext&&Ee.projectContext.field),v.xp6(1),v.Q6J("ngIf",!Ee.isNewResource&&Ee.projectContext&&!Ee.projectContext.matches),v.xp6(1),v.Q6J("ngForOf",Ee.prependedAttributeGroupComponents()),v.xp6(3),v.Q6J("fieldName","description")("resource",Ee.workPackage)("isDropTarget",!0)("wrapperClasses","-no-label"),v.xp6(1),v.Q6J("ngForOf",Ee.groupedFields)("ngForTrackBy",Ee.trackByName)}}const be=function(Ue){return{resource:Ue}};function Me(Ue,Le){if(1&Ue&&v._UZ(0,"ndc-dynamic",38),2&Ue){const Ee=v.oxw(2);v.Q6J("ndcDynamicComponent",Ee.attachmentUploadComponent())("ndcDynamicInputs",v.VKq(2,be,Ee.workPackage))}}function Re(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",47),v.TgZ(1,"div",48),v.TgZ(2,"div",43),v.TgZ(3,"div",44),v._UZ(4,"h3",45),v.qZA(),v.qZA(),v._UZ(5,"ndc-dynamic",38),v.YNc(6,Me,1,4,"ndc-dynamic",49),v.qZA(),v.qZA()),2&Ue){const Ee=v.oxw();v.xp6(4),v.Q6J("textContent",Ee.text.attachments.label),v.xp6(1),v.Q6J("ndcDynamicComponent",Ee.attachmentListComponent())("ndcDynamicInputs",v.VKq(4,be,Ee.workPackage)),v.xp6(1),v.Q6J("ngIf",Ee.workPackage.canAddAttachments)}}const $e=function(Ue){return{workPackageId:Ue,tabIdentifier:"files"}};function pt(Ue,Le){if(1&Ue&&(v.TgZ(0,"div",50),v.TgZ(1,"div",51),v.TgZ(2,"div",43),v.TgZ(3,"div",44),v._UZ(4,"h3",45),v.qZA(),v.qZA(),v.TgZ(5,"div",52),v._UZ(6,"op-icon",53),v._UZ(7,"span",22),v._UZ(8,"a",54),v.qZA(),v.qZA(),v.qZA()),2&Ue){const Ee=v.oxw();v.xp6(4),v.Q6J("textContent",Ee.text.files.label),v.xp6(3),v.Q6J("textContent",Ee.text.files.migration_help),v.xp6(1),v.Q6J("textContent",Ee.text.files.label)("uiSref",Ee.uiSelfRef)("uiParams",v.VKq(5,$e,Ee.workPackage.id))}}class vt extends P.N{constructor(Le,Ee,st,ut,It,Zt,Ut,jt,Dt,bt,Lt,Wt,Rt,xt){super(),this.I18n=Le,this.currentProject=Ee,this.PathHelper=st,this.$state=ut,this.states=It,this.halEditing=Zt,this.halResourceService=Ut,this.displayFieldService=jt,this.schemaCache=Dt,this.hook=bt,this.injector=Lt,this.cdRef=Wt,this.elementRef=Rt,this.browserDetector=xt,this.showProject=!1,this.groupedFields=[],this.resourceContextChange=new d.xQ,this.text={attachments:{label:this.I18n.t("js.label_attachments")},files:{label:this.I18n.t("js.work_packages.tabs.files"),migration_help:this.I18n.t("js.work_packages.tabs.files_tab_migration_help")},project:{required:this.I18n.t("js.project.required_outside_context"),context:this.I18n.t("js.project.context"),switchTo:this.I18n.t("js.project.click_to_switch_context")},fields:{description:this.I18n.t("js.work_packages.properties.description")},infoRow:{createdBy:this.I18n.t("js.label_created_by"),lastUpdatedOn:this.I18n.t("js.label_last_updated_on")}},this.firstTimeFocused=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.isNewResource=(0,E.Z)(this.workPackage),this.uiSelfRef=this.$state.$current.name;const Le=this.halEditing.changeFor(this.workPackage);this.resourceContextChange.next(this.contextFrom(Le.projectedResource)),this.refresh(Le),this.resourceContextChange.pipe(this.untilDestroyed(),(0,u.x)((Ee,st)=>_.isEqual(Ee,st)),(0,r.U)(()=>this.halEditing.changeFor(this.workPackage))).subscribe(Ee=>this.refresh(Ee)),this.halEditing.temporaryEditResource(this.workPackage).values$().pipe(this.untilDestroyed()).subscribe(Ee=>{this.resourceContextChange.next(this.contextFrom(Ee))})}refresh(Le){const Ee=(0,E.Z)(this.workPackage),st=Le.projectedResource;st.project?this.projectContext={href:this.PathHelper.projectWorkPackagePath((0,m.Z)(st.project.href),this.workPackage.id),matches:st.project.href===this.currentProject.apiv3Path}:this.projectContext={matches:!1,href:null},Ee&&!this.currentProject.inProjectContext&&(this.projectContext.field=this.getFields(Le,["project"]));const ut=this.schema(st)._attributeGroups;this.groupedFields=this.rebuildGroupedFields(Le,ut),this.cdRef.detectChanges()}shouldHideGroup(Le){const Ee=0===Le.members.length,st=(0,E.Z)(this.workPackage)&&!!Le.query;return Ee||st}trackByName(Le,Ee){return Ee.name}prependedAttributeGroupComponents(){return this.hook.call("prependedAttributeGroups",this.workPackage)}attributeGroupComponent(Le){return this.hook.call("attributeGroupComponent",Le,this.workPackage).pop()||null}attachmentListComponent(){return this.hook.call("workPackageAttachmentListComponent",this.workPackage).pop()||null}attachmentUploadComponent(){return this.hook.call("workPackageAttachmentUploadComponent",this.workPackage).pop()||null}get idLabel(){return`#${this.workPackage.id||""}`}get projectContextText(){const Le=(0,m.Z)(this.workPackage.project.href),st=`<a href="${this.PathHelper.projectPath(Le)}">${this.workPackage.project.name}<a>`;return this.I18n.t("js.project.work_package_belongs_to",{projectname:st})}showTwoColumnLayout(){return this.$element[0].getBoundingClientRect().width>750}rebuildGroupedFields(Le,Ee){return Ee?Ee.map(st=>{const ut=this.getAttributesGroupId(st);return"WorkPackageFormAttributeGroup"===st._type?{name:st.name,id:ut||(0,g.O)(16),members:this.getFields(Le,st.attributes),type:st._type,isolated:!1}:{name:st.name,id:ut||(0,g.O)(16),query:this.halResourceService.createHalResourceOfClass(p.P,st._embedded.query),relationType:st.relationType,members:[st._embedded.query],type:st._type,isolated:!0}}):[]}getFields(Le,Ee){const st=[];return Ee.forEach(ut=>{if("date"===ut)return void st.push(this.getDateField(Le));if(!Le.schema.ofProperty(ut))return void(0,b.qu)("Unknown field for current schema",ut);const It=this.displayField(Le,ut);st.push({name:ut,label:It.label,multiple:!1,spanAll:It.isFormattable,field:It})}),st}getDateField(Le){const Ee={name:"",label:this.I18n.t("js.work_packages.properties.date"),spanAll:!1,multiple:!1};return Le.schema.ofProperty("date")?(Ee.field=this.displayField(Le,"date"),Ee.name="date"):(Ee.field=this.displayField(Le,"combinedDate"),Ee.name="combinedDate"),Ee}contextFrom(Le){const Ee=this.schema(Le);let st;const ut=Le.project&&Le.project.href;return st=Ee.baseSchema?Ee.baseSchema.href:Ee.href,{isNew:Le.isNew,schema:st,project:ut}}displayField(Le,Ee){return this.displayFieldService.getField(Le.projectedResource,Ee,Le.schema.ofProperty(Ee),{container:"single-view",injector:this.injector,options:{}})}getAttributesGroupId(Le){const Ee=this.$element.find(`[data-group-name='${Le.name}']`).data("overflowingIdentifier");return Ee?Ee.replace(".__overflowing_",""):""}schema(Le){return this.halEditing.typedState(Le).hasValue()?this.halEditing.typedState(this.workPackage).value.schema:this.schemaCache.of(Le)}}vt.\u0275fac=function(Le){return new(Le||vt)(v.Y36(e.D),v.Y36(w.R),v.Y36(c.j),v.Y36(i.StateService),v.Y36(x.G),v.Y36(h.l),v.Y36(y.u),v.Y36(a.i),v.Y36(k.y),v.Y36(l.$),v.Y36(v.zs3),v.Y36(v.sBO),v.Y36(v.SBq),v.Y36(C.o))},vt.\u0275cmp=v.Xpm({type:vt,selectors:[["wp-single-view"]],inputs:{workPackage:"workPackage",showProject:"showProject"},features:[v.qOj],decls:3,vars:3,consts:[["class","work-package--single-view","data-selector","wp-single-view",3,"ngClass",4,"ngIf"],["class","work-packages--attachments attributes-group",4,"ngIf"],["class","work-packages--files attributes-group",4,"ngIf"],["data-selector","wp-single-view",1,"work-package--single-view",3,"ngClass"],["class","wp-new--subject-wrapper",4,"ngIf"],[1,"wp-info-wrapper"],[3,"workPackage",4,"ngIf"],[3,"attribute","attributeScope",4,"ngIf"],["class","work-packages--info-row",4,"ngIf"],[1,"custom-actions",3,"workPackage"],["class","attributes-group -project-context __overflowing_element_container __overflowing_project_context","data-overflowing-identifier",".__overflowing_project_context",4,"ngIf"],["class","attributes-group -project-context hide-when-print",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"attributes-group","description-group"],[1,"single-attribute","work-packages--details--description"],[3,"fieldName","resource","isDropTarget","wrapperClasses"],["class","attributes-group __overflowing_element_container",3,"hidden","ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"wp-new--subject-wrapper"],[3,"resource","wrapperClasses","fieldName"],[3,"workPackage"],[3,"attribute","attributeScope"],[1,"work-packages--info-row"],[3,"textContent"],[1,"user-link",3,"user"],[3,"dateTimeValue"],["data-overflowing-identifier",".__overflowing_project_context",1,"attributes-group","-project-context","__overflowing_element_container","__overflowing_project_context"],[1,"wp-project-context--warning",3,"textContent"],["class","attributes-key-value",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attributes-key-value",3,"ngClass"],[1,"attributes-key-value--key"],[3,"fieldName"],["class","required",4,"ngIf"],[1,"attributes-key-value--value-container"],[3,"resource","fieldName"],[1,"required"],[1,"attributes-group","-project-context","hide-when-print"],[3,"innerHTML"],[1,"project-context--switch-link",3,"textContent"],[3,"ndcDynamicComponent","ndcDynamicInputs"],[1,"attributes-group","__overflowing_element_container",3,"hidden","ngClass"],["wp-isolated-query-space","",4,"ngIf"],[4,"ngIf"],["wp-isolated-query-space",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],[3,"ndcDynamicComponent","ndcDynamicInjector","ndcDynamicInputs"],[1,"work-packages--attachments","attributes-group"],[1,"work-packages--attachments-container"],[3,"ndcDynamicComponent","ndcDynamicInputs",4,"ngIf"],[1,"work-packages--files","attributes-group"],[1,"work-packages--files-container"],[1,"attributes-group--icon-indented-text"],["icon-classes","icon-info1"],[3,"textContent","uiSref","uiParams"]],template:function(Le,Ee){1&Le&&(v.YNc(0,ge,14,17,"div",0),v.YNc(1,Re,7,6,"div",1),v.YNc(2,pt,9,7,"div",2)),2&Le&&(v.Q6J("ngIf",Ee.workPackage),v.xp6(1),v.Q6J("ngIf",Ee.isNewResource),v.xp6(1),v.Q6J("ngIf",!Ee.isNewResource))},directives:[M.O5,M.mk,te,M.sg,ee.k,G.f,se.y,me.F,_e.F,he.L,ae.B5,ae.oc,re.A,ye.o,Ce.AnchorUISref,Ce.UISref],encapsulation:2,changeDetection:0})},46669:(H,D,t)=>{"use strict";t.d(D,{x:()=>l});var i=t(47775),c=(t(24897),t(68197)),u=t(26942),r=t(20979),n=t(2316),h=t(54364),a=t(54262);function p(d,g){if(1&d&&(n.TgZ(0,"div",1),n.TgZ(1,"div",2),n._UZ(2,"editable-attribute-field",3),n.qZA(),n.TgZ(3,"div",4),n._UZ(4,"editable-attribute-field",3),n.qZA(),n.qZA()),2&d){const C=n.oxw();n.Q6J("ngClass","__overflowing_"+C.uniqueElementIdentifier),n.uIk("data-overflowing-identifier",".__overflowing_"+C.uniqueElementIdentifier),n.xp6(2),n.Q6J("resource",C.workPackage)("wrapperClasses","work-packages--type-selector work-packages--subject-element -no-label")("fieldName","type"),n.xp6(2),n.Q6J("resource",C.workPackage)("wrapperClasses","work-packages--details--subject work-packages--subject-element -no-label")("fieldName","subject")}}class l extends u.N{constructor(g,C){super(),this.uiRouterGlobals=g,this.apiV3Service=C,this.uniqueElementIdentifier=`work-packages--subject-type-row-${(0,c.O)(16)}`}ngOnInit(){this.workPackage||this.apiV3Service.work_packages.id(this.uiRouterGlobals.params.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(g=>{this.workPackage=g})}}l.\u0275fac=function(g){return new(g||l)(n.Y36(i.UIRouterGlobals),n.Y36(r.T))},l.\u0275cmp=n.Xpm({type:l,selectors:[["wp-subject"]],inputs:{workPackage:"workPackage"},features:[n.qOj],decls:1,vars:1,consts:[["class","work-packages--subject-type-row __overflowing_element_container",3,"ngClass",4,"ngIf"],[1,"work-packages--subject-type-row","__overflowing_element_container",3,"ngClass"],[1,"work-packages--type-selector","work-packages--subject-element"],[3,"resource","wrapperClasses","fieldName"],[1,"work-packages--details--subject","work-packages--subject-element"]],template:function(g,C){1&g&&n.YNc(0,p,5,8,"div",0),2&g&&n.Q6J("ngIf",C.workPackage)},directives:[h.O5,h.mk,a.k],encapsulation:2})},61736:(H,D,t)=>{"use strict";t.d(D,{M:()=>e});var i=t(40912);class e{constructor(u,r,n,h,a){this.availableTabs=u,this.outletElement=r,this.componentFactoryResolver=n,this.appRef=h,this.injector=a,this.activeTabs={},this.currentTab=null}get activeComponents(){return _.values(this.activeTabs).map(r=>r.componentRef.instance)}switchTo(u){if(void 0!==u.disable)return;this.detach();const r=this.activateInstance(u);this.outletElement.innerHTML="",this.outletElement.appendChild(this._getComponentRootNode(r.componentRef)),this.outletElement.dataset.tabName=u.name,this.currentTab=r}detach(){const u=this.currentTab;null!==u&&(u.portal.setAttachedHost(null),this.currentTab=null)}dispose(){_.each(this.activeTabs,u=>u.dispose()),null!=this.outletElement.parentNode&&this.outletElement.parentNode.removeChild(this.outletElement)}activateInstance(u){return this.activeTabs[u.name]||(this.activeTabs[u.name]=this.createComponent(u)),this.activeTabs[u.name]||null}createComponent(u){const n=this.componentFactoryResolver.resolveComponentFactory(u.componentClass).create(this.injector),h=new i.C5(u.componentClass,null,this.injector);return this.appRef.attachView(n.hostView),Object.assign(Object.assign({},u),{portal:h,componentRef:n,dispose:()=>{this.appRef.detachView(n.hostView),n.destroy()}})}_getComponentRootNode(u){return u.hostView.rootNodes[0]}}},57119:(H,D,t)=>{"use strict";t.d(D,{c:()=>v,Q:()=>M});var i=t(2316),e=t(12877),c=t(71562),u=t(71444),r=t(61736),n=t(74478),h=t(43440),a=t(86469),p=t(96617),l=t(77355),d=t(60312),g=t(62964),C=t(20979),y=t(52932),m=t(54364),E=t(32853),P=t(90590);const w=["tabContentOutlet"];function x(S,O){1&S&&i.GkF(0)}function k(S,O){if(1&S&&(i.ynx(0),i.YNc(1,x,1,0,"ng-container",10),i.BQk()),2&S){const A=i.oxw();i.xp6(1),i.Q6J("ngComponentOutlet",A.prependModalComponent)("ngComponentOutletInjector",A.injector)}}function b(S,O){if(1&S){const A=i.EpF();i.TgZ(0,"op-scrollable-tabs",11),i.NdJ("tabSelected",function(I){return i.CHM(A),i.oxw().switchTo(I)}),i.qZA()}if(2&S){const A=i.oxw();i.Q6J("tabs",A.availableTabs)("currentTabId",null==A.tabPortalHost.currentTab?null:A.tabPortalHost.currentTab.id)}}const v=new i.OlP("WpTableConfigurationModalPrependComponent");class M extends d.T{constructor(O,A,F,I,J,N,te,ee,G,se,me,_e,he,ae,re){super(O,he,re),this.locals=O,this.prependModalComponent=A,this.I18n=F,this.injector=I,this.appRef=J,this.componentFactoryResolver=N,this.loadingIndicator=te,this.querySpace=ee,this.wpStatesInitialization=G,this.apiV3Service=se,this.notificationService=me,this.wpTableColumns=_e,this.cdRef=he,this.ConfigurationService=ae,this.elementRef=re,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.work_packages.table_configuration.modal_title"),closePopup:this.I18n.t("js.close_popup_title"),columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel"),upsaleRelationColumns:this.I18n.t("js.modals.upsale_relation_columns"),upsaleRelationColumnsLink:this.I18n.t("js.modals.upsale_relation_columns_link")},this.onDataUpdated=new i.vpe,this.selectedColumnMap={},this.wpTableConfigurationService=this.injector.get(u.p,new u.p(this.I18n))}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.tabPortalHost=new r.M(this.wpTableConfigurationService.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector),this.loadingIndicator.indicator("modal").promise=this.loadForm().then(()=>{const O=this.locals.initialTab,A=this.availableTabs.find(F=>F.id===O);this.switchTo(A||this.availableTabs[0])})}ngOnDestroy(){this.onDataUpdated.complete(),this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(O){this.tabPortalHost.switchTo(O)}saveChanges(){this.tabPortalHost.activeComponents.forEach(O=>{O.onSave()}),this.onDataUpdated.emit(),this.service.close()}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}loadForm(){const O=this.querySpace.query.value;return this.apiV3Service.queries.form.load(O).toPromise().then(([A,F])=>(this.wpStatesInitialization.updateStatesFromForm(O,A),A)).catch(A=>this.notificationService.handleRawError(A))}}M.\u0275fac=function(O){return new(O||M)(i.Y36(l.E),i.Y36(v,8),i.Y36(p.D),i.Y36(i.zs3),i.Y36(i.z2F),i.Y36(i._Vd),i.Y36(a.vt),i.Y36(h.q),i.Y36(n.f),i.Y36(C.T),i.Y36(g.q),i.Y36(c.i),i.Y36(i.sBO),i.Y36(e.e),i.Y36(i.SBq))},M.\u0275cmp=i.Xpm({type:M,selectors:[["ng-component"]],viewQuery:function(O,A){if(1&O&&i.Gf(w,7),2&O){let F;i.iGM(F=i.CRH())&&(A.tabContentOutlet=F.first)}},features:[i.qOj],decls:11,vars:5,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_wide","wp-table--configuration-modal","loading-indicator--location"],[3,"close"],[1,"op-modal--body"],[4,"ngIf"],[3,"tabs","currentTabId","tabSelected",4,"ngIf"],[1,"tab-content"],["tabContentOutlet",""],[1,"op-modal--footer"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[3,"tabs","currentTabId","tabSelected"]],template:function(O,A){1&O&&(i.TgZ(0,"div",0),i.TgZ(1,"op-modal-header",1),i.NdJ("close",function(I){return A.closeMe(I)}),i._uU(2),i.qZA(),i.TgZ(3,"div",2),i.YNc(4,k,2,2,"ng-container",3),i.YNc(5,b,1,2,"op-scrollable-tabs",4),i._UZ(6,"div",5,6),i.qZA(),i.TgZ(8,"div",7),i.TgZ(9,"button",8),i.NdJ("click",function(){return A.saveChanges()}),i.qZA(),i.TgZ(10,"button",9),i.NdJ("click",function(I){return A.closeMe(I)}),i.qZA(),i.qZA(),i.qZA()),2&O&&(i.xp6(2),i.Oqu(A.text.title),i.xp6(2),i.Q6J("ngIf",!!A.prependModalComponent),i.xp6(1),i.Q6J("ngIf",A.tabPortalHost),i.xp6(4),i.Q6J("textContent",A.text.applyButton),i.xp6(1),i.Q6J("textContent",A.text.cancelButton))},directives:[y.g,m.O5,m.$G,E.dw,P.P],encapsulation:2})},71444:(H,D,t)=>{"use strict";t.d(D,{p:()=>Ie});var i=t(96617),e=t(61083),c=t(99676),u=t(82271),r=t(2316),n=t(1707),h=t(2775),a=t(54364);function p(ue,ie){if(1&ue&&r._UZ(0,"span",6),2&ue){const R=r.oxw();r.Q6J("textContent",R.text.display_mode.hierarchy_hint)}}function l(ue,ie){if(1&ue&&r._UZ(0,"option",15),2&ue){const R=ie.$implicit,L=r.oxw();r.Q6J("textContent",R.name)("selected",L.currentGroup&&L.currentGroup.href===R.href)("value",R.href)}}class d{constructor(ie,R,L,W,oe){this.injector=ie,this.I18n=R,this.wpTableGroupBy=L,this.wpTableHierarchies=W,this.wpTableSums=oe,this.displayMode="default",this.availableGroups=[],this.displaySums=!1,this.text={choose_mode:this.I18n.t("js.work_packages.table_configuration.choose_display_mode"),label_group_by:this.I18n.t("js.label_group_by"),title:this.I18n.t("js.label_group_by"),placeholder:this.I18n.t("js.placeholders.default"),please_select:this.I18n.t("js.placeholders.selection"),default:`\u2014 ${this.I18n.t("js.work_packages.table_configuration.default")}`,display_sums:this.I18n.t("js.work_packages.query.display_sums"),display_sums_hint:`\u2014 ${this.I18n.t("js.work_packages.table_configuration.display_sums_hint")}`,display_mode:{default:this.I18n.t("js.work_packages.table_configuration.default_mode"),grouped:this.I18n.t("js.work_packages.table_configuration.grouped_mode"),hierarchy:this.I18n.t("js.work_packages.table_configuration.hierarchy_mode"),hierarchy_hint:`\u2014 ${this.I18n.t("js.work_packages.table_configuration.hierarchy_hint")}`}}}onSave(){this.wpTableHierarchies.setEnabled("hierarchy"===this.displayMode);const ie="grouped"===this.displayMode?this.currentGroup:null;this.wpTableGroupBy.update(ie),this.wpTableSums.setEnabled(this.displaySums)}updateGroup(ie){this.displayMode="grouped",this.currentGroup=_.find(this.availableGroups,R=>R.href===ie)||null}ngOnInit(){this.wpTableHierarchies.isEnabled?this.displayMode="hierarchy":this.wpTableGroupBy.current&&(this.displayMode="grouped"),this.displaySums=this.wpTableSums.current,this.wpTableGroupBy.onReady().then(()=>{this.availableGroups=_.sortBy(this.wpTableGroupBy.available,"name"),this.currentGroup=this.wpTableGroupBy.current})}}d.\u0275fac=function(ie){return new(ie||d)(r.Y36(r.zs3),r.Y36(i.D),r.Y36(e.w),r.Y36(c.Y),r.Y36(u.X))},d.\u0275cmp=r.Xpm({type:d,selectors:[["ng-component"]],decls:39,vars:16,consts:[[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","value","default","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-no-hierarchy"],[1,"form--inline-instructions",3,"textContent"],["type","radio","value","hierarchy","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-hierarchy"],["class","form--inline-instructions",3,"textContent",4,"ngIf"],["type","radio","value","grouped","name","display_mode_switch",3,"ngModel","ngModelChange"],["icon-classes","icon-group-by"],["id","selected_grouping","name","selected_grouping",1,"form--select","form--inline-select",3,"change"],[3,"textContent","selected","value",4,"ngFor","ngForOf"],["type","checkbox","name","display_sums_switch",3,"checked","change"],[3,"textContent","selected","value"]],template:function(ie,R){1&ie&&(r.TgZ(0,"div"),r.TgZ(1,"form"),r._UZ(2,"p",0),r.TgZ(3,"div",1),r.TgZ(4,"div",2),r.TgZ(5,"label",3),r.TgZ(6,"input",4),r.NdJ("ngModelChange",function(W){return R.displayMode=W}),r.qZA(),r._UZ(7,"op-icon",5),r._uU(8," "),r._UZ(9,"span",0),r._uU(10," "),r._UZ(11,"span",6),r.qZA(),r.qZA(),r.qZA(),r.TgZ(12,"div",1),r.TgZ(13,"div",2),r.TgZ(14,"label",3),r.TgZ(15,"input",7),r.NdJ("ngModelChange",function(W){return R.displayMode=W}),r.qZA(),r._UZ(16,"op-icon",8),r._uU(17," "),r._UZ(18,"span",0),r._uU(19," "),r.YNc(20,p,1,1,"span",9),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"div",1),r.TgZ(22,"div",2),r.TgZ(23,"label",3),r.TgZ(24,"input",10),r.NdJ("ngModelChange",function(W){return R.displayMode=W}),r.qZA(),r._UZ(25,"op-icon",11),r._uU(26," "),r._UZ(27,"span",0),r._uU(28," "),r.TgZ(29,"select",12),r.NdJ("change",function(W){return R.updateGroup(W.target.value)}),r.YNc(30,l,1,3,"option",13),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r._UZ(31,"hr"),r.TgZ(32,"div"),r.TgZ(33,"div",1),r.TgZ(34,"div",2),r.TgZ(35,"label",3),r.TgZ(36,"input",14),r.NdJ("change",function(){return R.displaySums=!R.displaySums}),r.qZA(),r._uU(37),r._UZ(38,"span",6),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()),2&ie&&(r.xp6(2),r.Q6J("textContent",R.text.choose_mode),r.xp6(4),r.Q6J("ngModel",R.displayMode),r.xp6(1),r.uIk("icon-title",R.text.display_mode.default),r.xp6(2),r.Q6J("textContent",R.text.display_mode.default),r.xp6(2),r.Q6J("textContent",R.text.default),r.xp6(4),r.Q6J("ngModel",R.displayMode),r.xp6(1),r.uIk("icon-title",R.text.display_mode.hierarchy),r.xp6(2),r.Q6J("textContent",R.text.display_mode.hierarchy),r.xp6(2),r.Q6J("ngIf","hierarchy"===R.displayMode),r.xp6(4),r.Q6J("ngModel",R.displayMode),r.xp6(1),r.uIk("icon-title",R.text.label_group_by),r.xp6(2),r.Q6J("textContent",R.text.label_group_by),r.xp6(3),r.Q6J("ngForOf",R.availableGroups),r.xp6(6),r.Q6J("checked",R.displaySums),r.xp6(1),r.hij(" ",R.text.display_sums," "),r.xp6(1),r.Q6J("textContent",R.text.display_sums_hint))},directives:[n._Y,n.JL,n.F,n._,n.Fj,n.JJ,n.On,h.o,a.O5,a.sg,n.YN,n.Kr],encapsulation:2});var g=t(12877),C=t(71562),y=t(24e3),m=t(29212),E=t(8158);function P(ue,ie){if(1&ue&&r._UZ(0,"enterprise-banner",5),2&ue){const R=r.oxw();r.Q6J("linkMessage",R.text.upsaleCheckOutLink)("textMessage",R.text.upsaleRelationColumns)}}class w{constructor(ie,R,L,W,oe){this.injector=ie,this.I18n=R,this.wpTableColumns=L,this.ConfigurationService=W,this.bannerService=oe,this.availableColumnsOptions=this.wpTableColumns.all.map(Oe=>this.column2Like(Oe)),this.availableColumns=this.wpTableColumns.all,this.availableColumnsMap=_.keyBy(this.availableColumns,Oe=>Oe.id),this.selectedColumns=this.wpTableColumns.getColumns().map(Oe=>this.column2Like(Oe)),this.selectedColumnMap={},this.eeShowBanners=!1,this.text={columnsHelp:this.I18n.t("js.work_packages.table_configuration.columns_help_text"),columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),upsaleRelationColumns:this.I18n.t("js.work_packages.table_configuration.upsale.relation_columns"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link")}}onSave(){this.wpTableColumns.setColumnsById(this.selectedColumns.map(ie=>ie.id))}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.selectedColumns.forEach(ie=>{this.selectedColumnMap[ie.id]=!0})}column2Like(ie){return{id:ie.id,name:ie.name}}updateSelected(ie){this.selectedColumns=ie}}w.\u0275fac=function(ie){return new(ie||w)(r.Y36(r.zs3),r.Y36(i.D),r.Y36(C.i),r.Y36(g.e),r.Y36(y.j))},w.\u0275cmp=r.Xpm({type:w,selectors:[["ng-component"]],decls:5,vars:5,consts:[[1,"columns-modal--content"],[1,"hidden-for-sighted",3,"textContent"],[3,"options","selected","onChange"],[1,"form--inline-instructions",3,"textContent"],["class","ee-relation-columns-upsale","opReferrer","wp-list-columns#relations",3,"linkMessage","textMessage",4,"ngIf"],["opReferrer","wp-list-columns#relations",1,"ee-relation-columns-upsale",3,"linkMessage","textMessage"]],template:function(ie,R){1&ie&&(r.TgZ(0,"div",0),r._UZ(1,"label",1),r.TgZ(2,"draggable-autocompleter",2),r.NdJ("onChange",function(W){return R.updateSelected(W)}),r.qZA(),r._UZ(3,"p",3),r.qZA(),r.YNc(4,P,1,2,"enterprise-banner",4)),2&ie&&(r.xp6(1),r.Q6J("textContent",R.text.selectedColumns),r.xp6(1),r.Q6J("options",R.availableColumnsOptions)("selected",R.selectedColumns),r.xp6(1),r.Q6J("textContent",R.text.columnsHelp),r.xp6(1),r.Q6J("ngIf",R.eeShowBanners))},directives:[m.i,a.O5,E.P],encapsulation:2});var x=t(78434),k=t(74647),b=t(51522);function v(ue,ie){if(1&ue){const R=r.EpF();r.TgZ(0,"query-filters",1),r.NdJ("filtersChanged",function(W){r.CHM(R);return r.oxw().filters=W}),r.qZA()}if(2&ue){const R=r.oxw();r.Q6J("filters",R.filters)}}class M{constructor(ie,R,L,W,oe){this.injector=ie,this.I18n=R,this.wpTableFilters=L,this.wpFiltersService=W,this.bannerService=oe,this.filters=[],this.eeShowBanners=!1,this.text={columnsLabel:this.I18n.t("js.label_columns"),selectedColumns:this.I18n.t("js.description_selected_columns"),multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect"),upsaleRelationColumns:this.I18n.t("js.modals.upsale_relation_columns"),upsaleRelationColumnsLink:this.I18n.t("js.modals.upsale_relation_columns_link")}}ngOnInit(){this.eeShowBanners=this.bannerService.eeShowBanners,this.wpTableFilters.onReady().then(()=>this.filters=this.wpTableFilters.current),this.wpTableFilters.changes$().subscribe(ie=>{this.filters=this.wpTableFilters.current})}onSave(){this.filters&&this.wpTableFilters.replaceIfComplete(this.filters)}}M.\u0275fac=function(ie){return new(ie||M)(r.Y36(r.zs3),r.Y36(i.D),r.Y36(k.Z),r.Y36(x.U),r.Y36(y.j))},M.\u0275cmp=r.Xpm({type:M,selectors:[["wp-table-config-filters-tab"]],decls:1,vars:1,consts:[[3,"filters","filtersChanged",4,"ngIf"],[3,"filters","filtersChanged"]],template:function(ie,R){1&ie&&r.YNc(0,v,1,1,"query-filters",0),2&ie&&r.Q6J("ngIf",!!R.filters)},directives:[a.O5,b.H],encapsulation:2});var S=t(82763),O=t(15893);function A(ue,ie){if(1&ue&&r._UZ(0,"option",18),2&ue){const R=r.oxw().$implicit;r.Q6J("textContent",R.column.name)("value",R.column.href)}}function F(ue,ie){if(1&ue&&r._UZ(0,"option",19),2&ue){const R=ie.$implicit;r.Q6J("textContent",R.name)("value",R.href)}}function I(ue,ie){if(1&ue){const R=r.EpF();r.TgZ(0,"label",5),r.TgZ(1,"input",20),r.NdJ("ngModelChange",function(W){r.CHM(R);return r.oxw().$implicit.direction=W}),r.qZA(),r._uU(2),r.qZA()}if(2&ue){const R=ie.$implicit,L=r.oxw(),W=L.index,oe=L.$implicit;r.xp6(1),r.MGl("name","modal-sorting-attribute-",W,"--sort-direction"),r.Q6J("ngModel",oe.direction)("value",R.href)("textContent",R.name),r.xp6(1),r.hij(" ",R.name," ")}}function J(ue,ie){if(1&ue){const R=r.EpF();r.TgZ(0,"div"),r.TgZ(1,"div",3),r._UZ(2,"label",11),r.TgZ(3,"div",4),r.TgZ(4,"div",12),r.TgZ(5,"select",13),r.NdJ("change",function(W){const Oe=r.CHM(R).$implicit;return r.oxw(2).updateSelection(Oe,W.target.value)}),r.YNc(6,A,1,2,"option",14),r._UZ(7,"option",15),r.YNc(8,F,1,2,"option",16),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"div",3),r.TgZ(10,"div",4),r.YNc(11,I,3,5,"label",17),r.qZA(),r.qZA(),r.qZA()}if(2&ue){const R=ie.$implicit,L=ie.index,W=r.oxw(2);r.Gre("form--row modal-sorting-row-",L,""),r.xp6(2),r.MGl("for","modal-sorting-attribute-",L,""),r.Q6J("textContent",W.text["sort_criteria_"+L]),r.xp6(3),r.MGl("id","modal-sorting-attribute-",L,""),r.MGl("name","modal-sorting-attribute-",L,""),r.xp6(1),r.Q6J("ngIf",!!R.column.href),r.xp6(1),r.Q6J("textContent",W.emptyColumn.name)("value",W.emptyColumn.href)("selected",!R.column.href),r.xp6(1),r.Q6J("ngForOf",W.availableColumns),r.xp6(3),r.Q6J("ngForOf",W.availableDirections)}}function N(ue,ie){if(1&ue&&(r.ynx(0),r.YNc(1,J,12,13,"div",10),r.BQk()),2&ue){const R=r.oxw();r.xp6(1),r.Q6J("ngForOf",R.sortationObjects)}}class te{constructor(ie,R){this.column=ie,this.direction=R}}class ee{constructor(ie,R,L){this.injector=ie,this.I18n=R,this.wpTableSortBy=L,this.text={title:this.I18n.t("js.label_sort_by"),placeholder:this.I18n.t("js.placeholders.default"),sort_criteria_1:this.I18n.t("js.filter.sorting.criteria.one"),sort_criteria_2:this.I18n.t("js.filter.sorting.criteria.two"),sort_criteria_3:this.I18n.t("js.filter.sorting.criteria.three"),sorting_mode:{description:this.I18n.t("js.work_packages.table_configuration.sorting_mode.description"),automatic:this.I18n.t("js.work_packages.table_configuration.sorting_mode.automatic"),manually:this.I18n.t("js.work_packages.table_configuration.sorting_mode.manually"),warning:this.I18n.t("js.work_packages.table_configuration.sorting_mode.warning")}},this.availableDirections=[{href:O.S9,name:this.I18n.t("js.label_ascending")},{href:O.iV,name:this.I18n.t("js.label_descending")}],this.availableColumns=[],this.allColumns=[],this.sortationObjects=[],this.emptyColumn={name:this.text.placeholder,href:null},this.sortingMode="automatic"}onSave(){let ie;ie="automatic"===this.sortingMode?this.sortationObjects.filter(R=>null!==R.column):[new te(this.manualSortColumn,O.S9)],ie=ie.map(R=>this.getMatchingSort(R.column.href,R.direction)),this.wpTableSortBy.update(_.compact(ie))}ngOnInit(){this.wpTableSortBy.onReadyWithAvailable().subscribe(()=>{const ie=this.wpTableSortBy.available.filter(R=>!R.column.href.endsWith("/parent")).map(R=>({name:R.column.name,href:R.column.href}));this.allColumns=_.uniqBy(ie,"href"),this.getManualSortingOption(),_.each(this.wpTableSortBy.current,R=>{R.column.href.endsWith("/parent")||(this.sortationObjects.push(new te({name:R.column.name,href:R.column.href},R.direction.href)),R.column.href===this.manualSortColumn.href&&this.updateSortingMode("manual"))}),this.updateUsedColumns(),this.fillUpSortElements()})}updateSelection(ie,R){ie.column=_.find(this.allColumns,L=>L.href===R)||this.emptyColumn,this.updateUsedColumns()}updateUsedColumns(){const ie=this.sortationObjects.filter(R=>null!==R.column).map(R=>R.column);this.availableColumns=_.sortBy(_.differenceBy(this.allColumns,ie,"href"),"name")}updateSortingMode(ie){this.sortingMode=ie}getMatchingSort(ie,R){return _.find(this.wpTableSortBy.available,L=>L.column.href===ie&&L.direction.href===R)}fillUpSortElements(){for(;this.sortationObjects.length<3;)this.sortationObjects.push(new te(this.emptyColumn,O.S9))}getManualSortingOption(){this.manualSortColumn=this.allColumns.find(ie=>ie.href.endsWith("/manualSorting")),this.allColumns.splice(this.allColumns.indexOf(this.manualSortColumn),1)}}ee.\u0275fac=function(ie){return new(ie||ee)(r.Y36(r.zs3),r.Y36(i.D),r.Y36(S.q))},ee.\u0275cmp=r.Xpm({type:ee,selectors:[["ng-component"]],decls:16,vars:7,consts:[["name","modalSortingForm"],["id","modal-sorting","data-indicator-name","sorting-modal",1,"modal-content-container","loading-indicator--location"],[3,"textContent"],[1,"form--field","-full-width"],[1,"form--field-container"],[1,"option-label"],["type","radio","name","sorting_mode_switch","value","manual",3,"ngModel","ngModelChange","change"],["type","radio","name","sorting_mode_switch","value","automatic",3,"ngModel","ngModelChange","change"],[1,"form--field-instructions"],[4,"ngIf"],[3,"class",4,"ngFor","ngForOf"],[1,"form--label","hidden-for-sighted",3,"for","textContent"],[1,"form--select-container"],[1,"form--select",3,"id","name","change"],["selected","",3,"textContent","value",4,"ngIf"],[3,"textContent","value","selected"],[3,"textContent","value",4,"ngFor","ngForOf"],["class","option-label",4,"ngFor","ngForOf"],["selected","",3,"textContent","value"],[3,"textContent","value"],["type","radio",3,"ngModel","value","textContent","name","ngModelChange"]],template:function(ie,R){1&ie&&(r.TgZ(0,"form",0),r.TgZ(1,"div",1),r._UZ(2,"p",2),r.TgZ(3,"div",3),r.TgZ(4,"div",4),r.TgZ(5,"label",5),r.TgZ(6,"input",6),r.NdJ("ngModelChange",function(W){return R.sortingMode=W})("change",function(W){return R.updateSortingMode(W.target.value)}),r.qZA(),r._uU(7),r.qZA(),r.qZA(),r.qZA(),r.TgZ(8,"div",3),r.TgZ(9,"div",4),r.TgZ(10,"label",5),r.TgZ(11,"input",7),r.NdJ("ngModelChange",function(W){return R.sortingMode=W})("change",function(W){return R.updateSortingMode(W.target.value)}),r.qZA(),r._uU(12),r.qZA(),r.qZA(),r.TgZ(13,"div",8),r._uU(14),r.qZA(),r.qZA(),r.YNc(15,N,2,1,"ng-container",9),r.qZA(),r.qZA()),2&ie&&(r.xp6(2),r.Q6J("textContent",R.text.sorting_mode.description),r.xp6(4),r.Q6J("ngModel",R.sortingMode),r.xp6(1),r.hij(" ",R.text.sorting_mode.manually," "),r.xp6(4),r.Q6J("ngModel",R.sortingMode),r.xp6(1),r.hij(" ",R.text.sorting_mode.automatic," "),r.xp6(2),r.hij(" ",R.text.sorting_mode.warning," "),r.xp6(1),r.Q6J("ngIf","automatic"===R.sortingMode))},directives:[n._Y,n.JL,n.F,n._,n.Fj,n.JJ,n.On,a.O5,a.sg,n.YN,n.Kr],encapsulation:2});var G=t(73165),se=t(42529);function me(ue,ie){if(1&ue&&r._UZ(0,"option",15),2&ue){const R=ie.$implicit,L=r.oxw(2);r.Q6J("textContent",L.text.zoom[R])("value",R)("selected",L.zoomLevel===R)}}function _e(ue,ie){if(1&ue&&r._UZ(0,"option",15),2&ue){const R=ie.$implicit,L=r.oxw().$implicit,W=r.oxw(2);r.Q6J("textContent",R.name)("value",R.id)("selected",W.labels[L]===R.id)}}function he(ue,ie){if(1&ue){const R=r.EpF();r.TgZ(0,"div",16),r.TgZ(1,"div",1),r.TgZ(2,"label",17),r._uU(3),r.qZA(),r.TgZ(4,"div",3),r.TgZ(5,"div",18),r.TgZ(6,"select",19),r.NdJ("change",function(W){const Oe=r.CHM(R).$implicit;return r.oxw(2).updateLabels(Oe,W.target.value)}),r.YNc(7,_e,1,3,"option",13),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA()}if(2&ue){const R=ie.$implicit,L=r.oxw(2);r.xp6(2),r.MGl("for","modal-timelines-label-",R,""),r.xp6(1),r.hij(" ",L.text.labels[R]," "),r.xp6(3),r.MGl("id","modal-timelines-label-",R,""),r.xp6(1),r.Q6J("ngForOf",L.availableAttributes)}}function ae(ue,ie){if(1&ue){const R=r.EpF();r.ynx(0),r.TgZ(1,"fieldset",8),r._UZ(2,"legend",9),r._UZ(3,"p",10),r.TgZ(4,"div",1),r.TgZ(5,"div",3),r.TgZ(6,"div",11),r.TgZ(7,"select",12),r.NdJ("change",function(W){r.CHM(R);return r.oxw().zoomLevel=W.target.value}),r.YNc(8,me,1,3,"option",13),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(9,"fieldset",8),r._UZ(10,"legend",9),r._UZ(11,"p",10),r.YNc(12,he,8,4,"div",14),r.qZA(),r.BQk()}if(2&ue){const R=r.oxw();r.xp6(2),r.Q6J("textContent",R.text.zoom.level),r.xp6(1),r.Q6J("textContent",R.text.zoom.description),r.xp6(4),r.uIk("disabled",!0===R.autoZoom?"disabled":void 0),r.xp6(1),r.Q6J("ngForOf",R.availableZoomLevels),r.xp6(2),r.Q6J("textContent",R.text.labels.title),r.xp6(1),r.Q6J("textContent",R.text.labels.description),r.xp6(1),r.Q6J("ngForOf",R.availableLabels)}}class re{constructor(ie,R,L,W){this.injector=ie,this.I18n=R,this.wpTableTimeline=L,this.wpTableColumns=W,this.timelineVisible=!1,this.availableZoomLevels=["auto",...se.$r],this.text={title:this.I18n.t("js.timelines.gantt_chart"),display_timelines:this.I18n.t("js.timelines.button_activate"),display_timelines_hint:this.I18n.t("js.work_packages.table_configuration.show_timeline_hint"),zoom:{level:this.I18n.t("js.tl_toolbar.zooms"),description:this.I18n.t("js.timelines.zoom.description"),days:this.I18n.t("js.timelines.zoom.days"),weeks:this.I18n.t("js.timelines.zoom.weeks"),months:this.I18n.t("js.timelines.zoom.months"),quarters:this.I18n.t("js.timelines.zoom.quarters"),years:this.I18n.t("js.timelines.zoom.years"),auto:this.I18n.t("js.timelines.zoom.auto")},labels:{title:this.I18n.t("js.timelines.labels.title"),description:this.I18n.t("js.timelines.labels.description"),bar:this.I18n.t("js.timelines.labels.bar"),none:this.I18n.t("js.timelines.filter.noneSelection"),left:this.I18n.t("js.timelines.labels.left"),right:this.I18n.t("js.timelines.labels.right"),farRight:this.I18n.t("js.timelines.labels.farRight")}}}onSave(){this.wpTableTimeline.update(Object.assign(Object.assign({},this.wpTableTimeline.current),{visible:this.timelineVisible,labels:this.labels,zoomLevel:this.zoomLevel}))}updateLabels(ie,R){""===R&&(R=null),this.labels[ie]=R}ngOnInit(){this.timelineVisible=this.wpTableTimeline.isVisible,this.zoomLevel=this.wpTableTimeline.zoomLevel;const{labels:ie}=this.wpTableTimeline;this.labels=_.clone(ie),this.availableLabels=Object.keys(this.labels);const R=this.wpTableColumns.allPropertyColumns.sort((L,W)=>L.name.localeCompare(W.name));this.availableAttributes=[{id:"",name:this.text.labels.none}].concat(R)}}re.\u0275fac=function(ie){return new(ie||re)(r.Y36(r.zs3),r.Y36(i.D),r.Y36(G.W),r.Y36(C.i))},re.\u0275cmp=r.Xpm({type:re,selectors:[["ng-component"]],decls:9,vars:4,consts:[[1,"form"],[1,"form--field"],["for","display_timelines_switch",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--check-box-container"],["type","checkbox","id","display_timelines_switch","name","display_timelines_switch",3,"checked","change"],[1,"form--field-instructions",3,"textContent"],[4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend",3,"textContent"],[3,"textContent"],[1,"form--text-select-container","-slim"],["id","modal-timelines-zoomlevel",1,"form--select",3,"change"],[3,"textContent","value","selected",4,"ngFor","ngForOf"],["class","form--row",4,"ngFor","ngForOf"],[3,"textContent","value","selected"],[1,"form--row"],[1,"form--label",3,"for"],[1,"form--select-container"],[1,"form--select",3,"id","change"]],template:function(ie,R){1&ie&&(r.TgZ(0,"div"),r.TgZ(1,"form",0),r.TgZ(2,"div",1),r._UZ(3,"label",2),r.TgZ(4,"div",3),r.TgZ(5,"div",4),r.TgZ(6,"input",5),r.NdJ("change",function(){return R.timelineVisible=!R.timelineVisible}),r.qZA(),r.qZA(),r.qZA(),r._UZ(7,"p",6),r.qZA(),r.YNc(8,ae,13,7,"ng-container",7),r.qZA(),r.qZA()),2&ie&&(r.xp6(3),r.Q6J("textContent",R.text.display_timelines),r.xp6(3),r.Q6J("checked",R.timelineVisible),r.xp6(1),r.Q6J("textContent",R.text.display_timelines_hint),r.xp6(1),r.Q6J("ngIf",R.timelineVisible))},directives:[n._Y,n.JL,n.F,a.O5,a.sg,n.YN,n.Kr],encapsulation:2});var ye=t(84897),Ce=t(43440),ke=t(87853),Ae=t(36868);const Fe=["highlightedAttributesNgSelect"],ot=["rowHighlightNgSelect"];function it(ue,ie){if(1&ue&&r._UZ(0,"enterprise-banner",13),2&ue){const R=r.oxw();r.Q6J("linkMessage",R.text.upsaleCheckOutLink)("textMessage",R.text.upsaleAttributeHighlighting)}}class Ve{constructor(ie,R,L,W,oe,Oe){this.injector=ie,this.I18n=R,this.states=L,this.querySpace=W,this.Banners=oe,this.wpTableHighlight=Oe,this.highlightingMode="inline",this.entireRowMode=!1,this.lastEntireRowAttribute="status",this.eeShowBanners=!1,this.availableInlineHighlightedAttributes=[],this.selectedAttributes=[],this.availableRowHighlightedAttributes=[],this.text={title:this.I18n.t("js.work_packages.table_configuration.highlighting"),highlighting_mode:{description:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.description"),none:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.none"),inline:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.inline"),inline_all_attributes:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.inline_all"),status:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.status"),type:this.I18n.t("js.work_packages.properties.type"),priority:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.priority"),entire_row_by:this.I18n.t("js.work_packages.table_configuration.highlighting_mode.entire_row_by")},upsaleAttributeHighlighting:this.I18n.t("js.work_packages.table_configuration.upsale.attribute_highlighting"),upsaleCheckOutLink:this.I18n.t("js.work_packages.table_configuration.upsale.check_out_link")}}ngOnInit(){this.availableInlineHighlightedAttributes=this.availableHighlightedAttributes,this.availableRowHighlightedAttributes=[{name:this.text.highlighting_mode.status,value:"status"},{name:this.text.highlighting_mode.priority,value:"priority"}],this.setSelectedValues(),this.eeShowBanners=this.Banners.eeShowBanners,this.updateMode(this.wpTableHighlight.current.mode),this.eeShowBanners&&this.updateMode("none")}onSave(){const ie=this.highlightingMode;this.wpTableHighlight.update({mode:ie,selectedAttributes:this.selectedAttributes})}updateMode(ie){this.highlightingMode="entire-row"===ie?this.lastEntireRowAttribute:ie,-1!==["status","priority"].indexOf(this.highlightingMode)?(this.lastEntireRowAttribute=this.highlightingMode,this.entireRowMode=!0):this.entireRowMode=!1}updateHighlightingAttributes(ie){this.selectedAttributes=ie}disabledValue(ie){return ie?"disabled":null}get availableHighlightedAttributes(){const{schema:ie}=this.querySpace.queryForm.value;return ie.highlightedAttributes.allowedValues}onOpen(ie){setTimeout(()=>{ie.dropdownPanel&&ie.dropdownPanel._updatePosition()},25)}setSelectedValues(){const ie=this.wpTableHighlight.current.selectedAttributes;ie&&(this.selectedAttributes=ie)}}Ve.\u0275fac=function(ie){return new(ie||Ve)(r.Y36(r.zs3),r.Y36(i.D),r.Y36(ke.G),r.Y36(Ce.q),r.Y36(y.j),r.Y36(ye.B))},Ve.\u0275cmp=r.Xpm({type:Ve,selectors:[["ng-component"]],viewQuery:function(ie,R){if(1&ie&&(r.Gf(Fe,5),r.Gf(ot,5)),2&ie){let L;r.iGM(L=r.CRH())&&(R.highlightedAttributesNgSelect=L.first),r.iGM(L=r.CRH())&&(R.rowHighlightNgSelect=L.first)}},decls:25,vars:22,consts:[["class","ee-attribute-highlighting-upsale","opReferrer","wp-attribute-highlighting#attribute-highlighting",3,"linkMessage","textMessage",4,"ngIf"],[3,"textContent"],[1,"form--field"],[1,"form--label"],["type","radio","value","inline","name","highlighting_mode_switch",3,"ngModel","ngModelChange","change"],[1,"form--field-container"],[1,"form--select-container"],["bindLabel","name","name","highlighting_attributes","appendTo","body",1,"form--select-field","-multi-select",3,"items","ngModel","multiple","disabled","clearable","closeOnSelect","ngModelChange","open","change"],["highlightedAttributesNgSelect",""],["type","radio","name","entire_row_switch",3,"ngModel","value","ngModelChange","change"],["bindLabel","name","bindValue","value","name","selected_attribute","appendTo","body","id","selected_attribute",1,"form--select-field",3,"items","ngModel","disabled","clearable","ngModelChange","open","change"],["rowHighlightNgSelect",""],["type","radio","value","none","name","highlighting_mode_switch",3,"ngModel","ngModelChange","change"],["opReferrer","wp-attribute-highlighting#attribute-highlighting",1,"ee-attribute-highlighting-upsale",3,"linkMessage","textMessage"]],template:function(ie,R){if(1&ie){const L=r.EpF();r.TgZ(0,"div"),r.YNc(1,it,1,2,"enterprise-banner",0),r.TgZ(2,"form"),r._UZ(3,"p",1),r.TgZ(4,"div",2),r.TgZ(5,"label",3),r.TgZ(6,"input",4),r.NdJ("ngModelChange",function(oe){return R.highlightingMode=oe})("change",function(oe){return R.updateMode(oe.target.value)}),r.qZA(),r._UZ(7,"span",1),r._uU(8,"\xa0 "),r.qZA(),r.TgZ(9,"div",5),r.TgZ(10,"div",6),r.TgZ(11,"ng-select",7,8),r.NdJ("ngModelChange",function(oe){return R.selectedAttributes=oe})("open",function(){r.CHM(L);const oe=r.MAs(12);return R.onOpen(oe)})("change",function(oe){return R.updateHighlightingAttributes(oe)}),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(13,"div",2),r.TgZ(14,"label",3),r.TgZ(15,"input",9),r.NdJ("ngModelChange",function(oe){return R.entireRowMode=oe})("change",function(){return R.updateMode("entire-row")}),r.qZA(),r._UZ(16,"span",1),r.qZA(),r.TgZ(17,"div",5),r.TgZ(18,"div",6),r.TgZ(19,"ng-select",10,11),r.NdJ("ngModelChange",function(oe){return R.lastEntireRowAttribute=oe})("open",function(){r.CHM(L);const oe=r.MAs(20);return R.onOpen(oe)})("change",function(oe){return R.updateMode(oe.value)}),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(21,"div",2),r.TgZ(22,"label",3),r.TgZ(23,"input",12),r.NdJ("ngModelChange",function(oe){return R.highlightingMode=oe})("change",function(oe){return R.updateMode(oe.target.value)}),r.qZA(),r._UZ(24,"span",1),r.qZA(),r.qZA(),r.qZA(),r.qZA()}2&ie&&(r.xp6(1),r.Q6J("ngIf",R.eeShowBanners),r.xp6(2),r.Q6J("textContent",R.text.highlighting_mode.description),r.xp6(3),r.Q6J("ngModel",R.highlightingMode),r.uIk("disabled",R.disabledValue(R.eeShowBanners)),r.xp6(1),r.Q6J("textContent",R.text.highlighting_mode.inline),r.xp6(4),r.Q6J("items",R.availableInlineHighlightedAttributes)("ngModel",R.selectedAttributes)("multiple",!0)("disabled","inline"!==R.highlightingMode)("clearable",!1)("closeOnSelect",!1),r.xp6(4),r.Q6J("ngModel",R.entireRowMode)("value",!0),r.uIk("disabled",R.disabledValue(R.eeShowBanners)),r.xp6(1),r.Q6J("textContent",R.text.highlighting_mode.entire_row_by),r.xp6(3),r.Q6J("items",R.availableRowHighlightedAttributes)("ngModel",R.lastEntireRowAttribute)("disabled",R.disabledValue(R.eeShowBanners))("clearable",!1),r.xp6(4),r.Q6J("ngModel",R.highlightingMode),r.uIk("disabled",R.disabledValue(R.eeShowBanners)),r.xp6(1),r.Q6J("textContent",R.text.highlighting_mode.none))},directives:[a.O5,n._Y,n.JL,n.F,n._,n.Fj,n.JJ,n.On,Ae.w9,E.P],encapsulation:2});class Ie{constructor(ie){this.I18n=ie,this._tabs=[{id:"columns",name:this.I18n.t("js.label_columns"),componentClass:w},{id:"filters",name:this.I18n.t("js.work_packages.query.filters"),componentClass:M},{id:"sort-by",name:this.I18n.t("js.label_sort_by"),componentClass:ee},{id:"display-settings",name:this.I18n.t("js.work_packages.table_configuration.display_settings"),componentClass:d},{id:"highlighting",name:this.I18n.t("js.work_packages.table_configuration.highlighting"),componentClass:Ve},{id:"timelines",name:this.I18n.t("js.timelines.gantt_chart"),componentClass:re}]}get tabs(){return this._tabs}}Ie.\u0275fac=function(ie){return new(ie||Ie)(r.LFG(i.D))},Ie.\u0275prov=r.Yz7({token:Ie,factory:Ie.\u0275fac})},77591:(H,D,t)=>{"use strict";t.d(D,{j:()=>a});var i=t(70233),e=t(55977),c=t(53448),u=t(73165),r=t(16793),n=t(2888),h=t(2316);class a{constructor(l,d,g,C,y,m){this.HookService=l,this.UrlParamsHelper=d,this.wpViewRepresentation=g,this.wpViewTimeline=C,this.wpViewIndent=y,this.PathHelper=m,this.BULK_ACTIONS=[{text:I18n.t("js.work_packages.bulk_actions.edit"),key:"edit",link:"update",href:`${this.PathHelper.staticBase}/work_packages/bulk/edit`},{text:I18n.t("js.work_packages.bulk_actions.move"),key:"move",link:"move",href:`${this.PathHelper.staticBase}/work_packages/move/new`},{text:I18n.t("js.work_packages.bulk_actions.copy"),key:"copy",link:"copy",href:`${this.PathHelper.staticBase}/work_packages/move/new?copy=true`},{text:I18n.t("js.work_packages.bulk_actions.delete"),key:"delete",link:"delete",href:`${this.PathHelper.staticBase}/work_packages/bulk?_method=delete`}]}getPermittedActionLinks(l,d,g){const C=[];let y=this.getAllowedActions(l,d);return y=y.concat(this.getAllowedParentActions(l)),y=y.concat(this.getAllowedRelationActions(l,g)),_.each(y,m=>{C.push({key:m.key,text:m.text,icon:m.icon,link:m.link?l[m.link].href:void 0})}),C}getIntersectOfPermittedActions(l){const d=[],g=this.BULK_ACTIONS.concat(this.HookService.call("workPackageBulkContextMenu")),C=_.filter(g,y=>_.every(l,m=>this.isActionAllowed(m,y)));return _.each(C,y=>{d.push({key:y.key,text:y.text,icon:y.icon,link:this.getBulkActionLink(y,l)})}),d}getBulkActionLink(l,d){const g={"ids[]":d.map(P=>P.id)},C=this.UrlParamsHelper.buildQueryString(g),y=l.href.split("?");return`${y.shift()}?${y.concat(new Array(C)).join("&")}`}isActionAllowed(l,d){return _.filter(this.getAllowedActions(l,[d]),g=>g===d).length>=1}getAllowedActions(l,d){const g=[];return _.each(d,C=>{C.link&&l.hasOwnProperty(C.link)&&(C.text=C.text||I18n.t(`js.button_${C.key}`),g.push(C))}),_.each(this.HookService.call("workPackageTableContextMenu"),C=>{if(l.hasOwnProperty(C.link)){const y=C.indexBy?C.indexBy(g):g.length;g.splice(y,0,C)}}),g}getAllowedParentActions(l){const d=[];return this.wpViewRepresentation.isList?(this.wpViewIndent.canOutdent(l)&&d.push({key:"hierarchy-outdent",icon:"icon-paragraph-left",text:I18n.t("js.relation_buttons.hierarchy_outdent")}),this.wpViewIndent.canIndent(l)&&d.push({key:"hierarchy-indent",icon:"icon-paragraph-right",text:I18n.t("js.relation_buttons.hierarchy_indent")}),d):[]}getAllowedRelationActions(l,d){const g=[];return!!l.addRelation&&this.wpViewTimeline.isVisible&&(g.push({key:"relation-precedes",text:I18n.t("js.relation_buttons.add_predecessor"),link:"addRelation"}),g.push({key:"relation-follows",text:I18n.t("js.relation_buttons.add_follower"),link:"addRelation"})),!!l.addChild&&d&&g.push({key:"relation-new-child",text:I18n.t("js.relation_buttons.add_new_child"),link:"addChild"}),g}getPermittedActions(l,d,g){return 1===l.length?this.getPermittedActionLinks(l[0],d,g):this.getIntersectOfPermittedActions(l)}}a.\u0275fac=function(l){return new(l||a)(h.LFG(c.$),h.LFG(e.Z),h.LFG(n.ld),h.LFG(u.W),h.LFG(r.f),h.LFG(i.j))},a.\u0275prov=h.Yz7({token:a,factory:a.\u0275fac})},16451:(H,D,t)=>{"use strict";t.d(D,{B:()=>k});var i=t(43440);class e{constructor(v,M){this.querySpace=v,this.injector=M}get applies(){return!0}onNewOrder(v){}canPickup(v){return!0}handleDrop(v,M){return Promise.resolve(void 0)}changeShadowElement(v,M=!1){return M?v.classList.remove("-dragged"):v.classList.add("-dragged"),!0}}var c=t(3786),u=t(99676),r=t(41945),n=t(32030),h=t(99919),a=t(29161),p=t(20979);class l extends e{get applies(){return this.wpTableHierarchies.isEnabled}canPickup(v){return!!v.changeParent}handleDrop(v,M){return this.determineParent(M).then(S=>this.relationHierarchyService.changeParent(v,S))}determineParent(v){let M=v.previousElementSibling;const S=v.nextElementSibling;let O=null;if(null!==M&&this.droppedIntoGroup(v,M,S)){if(M.className.indexOf((0,h.gx)())>=0){const I=this.findRelationRowRoot(M);if(null==I)return Promise.resolve(null);M=I}const F=M.dataset.workPackageId;if(this.isHiearchyRoot(M,F)){if((0,h._D)(S))return this.determineParent(M);O=F}else O=this.loadParentOfWP(F)}return Promise.resolve(O)}findRelationRowRoot(v){let M=v.previousElementSibling;for(;null!==M;){if(M.className.indexOf((0,h.gx)())<0)return M;M=M.previousElementSibling}return null}droppedIntoGroup(v,M,S){const O=M.className.indexOf((0,n.oQ)(""))>=0,A=M.className.indexOf((0,n.MO)(""))>=0;let F;if(O||A){const I=Array.from(v.classList).filter(se=>se.includes("__hierarchy-group-"))||[],J=Array.from(M.classList).filter(se=>se.includes("__hierarchy-group-"))||[],N=S&&Array.from(S.classList).filter(se=>se.includes("__hierarchy-group-"))||[],te=M.dataset.workPackageId,ee=!N.some(se=>J.includes(se))&&!N.includes((0,n.oQ)(te)),G=I.some(se=>J.includes(se))||I.includes((0,n.oQ)(te));F=ee&&!G}return!F&&O||A}isHiearchyRoot(v,M){return v.classList.contains((0,n.MO)(M))}loadParentOfWP(v){return this.apiV3Service.work_packages.id(v).get().toPromise().then(M=>{var S;return Promise.resolve((null===(S=M.parent)||void 0===S?void 0:S.id)||null)})}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",u.Y)],l.prototype,"wpTableHierarchies",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",r.O)],l.prototype,"relationHierarchyService",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",p.T)],l.prototype,"apiV3Service",void 0);var d=t(61083),g=t(12703),C=t(68130),y=t(67749),m=t(67727),E=t(1403),P=t(44022);class w extends e{get applies(){return this.wpTableGroupBy.isEnabled}canPickup(v){const M=this.groupedAttribute;return null!==M&&this.schemaCache.of(v).isAttributeEditable(M)}handleDrop(v,M){const S=this.halEditing.changeFor(v),O=this.getValueForGroup(M);return S.projectedResource[this.groupedAttribute]=O,this.halEditing.save(S).then(A=>this.halEvents.push(A.resource,{eventType:"updated"})).catch(A=>this.halNotification.handleRawError(A,v))}getValueForGroup(v){const M=(0,h.hK)(v,`.${C.u}`),S=this.groups.find(O=>(0,y.M4)(O)===M.dataset.groupIdentifier);if(!S)return null;if(S._links&&S._links.valueLink){const O=S._links.valueLink;return 1===O.length?O[0]:O}return S.value}get groupedAttribute(){const{current:v}=this.wpTableGroupBy;return v?v.id:null}get groups(){return this.querySpace.groups.value||[]}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",d.w)],w.prototype,"wpTableGroupBy",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",g.l)],w.prototype,"halEditing",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",E.J)],w.prototype,"halEvents",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",m.W)],w.prototype,"halNotification",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",P.y)],w.prototype,"schemaCache",void 0);var x=t(2316);class k{constructor(){this.register=[l,w]}add(v){this.register.push(v)}get(v){const M=v.get(i.q);return this.register.map(O=>new O(M,v)).find(O=>O.applies)||new e(M,v)}}k.\u0275fac=function(v){return new(v||k)},k.\u0275prov=x.Yz7({token:k,factory:k.\u0275fac})},166:(H,D,t)=>{"use strict";t.d(D,{Z:()=>_e});var i=t(3786),e=t(2316),c=t(73165),u=t(40533),r=t(93903),n=t(57119),h=t(77355),a=t(45338),p=t(86469),l=t(55977),d=t(96617),g=t(43440),C=t(34520),y=t(29161),m=t(20979),E=t(65146),P=t(74478);class w extends C._{constructor(){super(...arguments),this.uniqueEmbeddedTableName=`embedded-table-${Date.now()}`,this.initialLoadingIndicator=!0,this.renderTable=!1,this.showTablePagination=!1,this.error=null,this.initialized=!1}ngOnInit(){this.configuration=new a.O(this.providedConfiguration),this.configuration.isEmbedded=!0,this.initialized=!0,super.ngOnInit()}ngAfterViewInit(){this.loadQuery(!0,!1)}ngOnChanges(ae){this.initialized&&(ae.queryId||ae.queryProps)&&this.loadQuery(this.initialLoadingIndicator,!1)}get projectIdentifier(){return this.configuration.projectContext?this.currentProject.identifier||void 0:this.configuration.projectIdentifier||void 0}buildQueryProps(){const ae=this.querySpace.query.value;return this.wpStatesInitialization.applyToQuery(ae),this.urlParamsHelper.buildV3GetQueryFromQueryResource(ae)}buildUrlParams(){const ae=this.querySpace.query.value;return this.wpStatesInitialization.applyToQuery(ae),this.urlParamsHelper.encodeQueryJsonParams(ae)}setLoaded(){this.renderTable=this.configuration.tableVisible,this.cdRef.detectChanges()}refresh(ae=!0,re=!1){const ye=this.querySpace.query.value,Ce=this.wpTablePagination.paginationObject;re&&(Ce.offset=1);const ke=this.urlParamsHelper.buildV3GetQueryFromQueryResource(ye,Ce),Ae=this.wpListService.loadQueryFromExisting(ye,ke,this.queryProjectScope).toPromise().then(Fe=>this.wpStatesInitialization.updateQuerySpace(Fe,Fe.results));return ae&&(this.loadingIndicator=Ae),Ae}get isInitialized(){return!!this.configuration}set loadingIndicator(ae){this.configuration.tableVisible&&(this.loadingIndicatorService.indicator(this.uniqueEmbeddedTableName).promise=ae)}get queryProjectScope(){if(this.configuration.projectContext)return this.projectIdentifier}initializeStates(ae){this.wpStatesInitialization.clearStates(),this.wpStatesInitialization.initializeFromQuery(ae,ae.results),this.wpStatesInitialization.updateQuerySpace(ae,ae.results)}}w.\u0275fac=function(){let he;return function(re){return(he||(he=e.n5z(w)))(re||w)}}(),w.\u0275dir=e.lG2({type:w,inputs:{providedConfiguration:["configuration","providedConfiguration"],uniqueEmbeddedTableName:"uniqueEmbeddedTableName",initialLoadingIndicator:"initialLoadingIndicator"},features:[e.qOj,e.TTD]}),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",m.T)],w.prototype,"apiV3Service",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",g.q)],w.prototype,"querySpace",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",d.D)],w.prototype,"I18n",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",l.Z)],w.prototype,"urlParamsHelper",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",p.vt)],w.prototype,"loadingIndicatorService",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",P.f)],w.prototype,"wpStatesInitialization",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",E.R)],w.prototype,"currentProject",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",e.sBO)],w.prototype,"cdRef",void 0);var x=t(33927),k=t(83720),b=t(17163),v=t(53466),M=t(84109),S=t(54364),O=t(2770),A=t(77434),F=t(18942),I=t(88923);function J(he,ae){if(1&he&&e._UZ(0,"op-filter-container",10),2&he){const re=e.oxw(3);e.Q6J("showFilterButton",re.configuration.showFilterButton)("filterButtonText",re.configuration.filterButtonText)}}function N(he,ae){if(1&he){const re=e.EpF();e.TgZ(0,"wp-table",11),e.NdJ("itemClicked",function(Ce){return e.CHM(re),e.oxw(3).handleWorkPackageClicked(Ce)})("stateLinkClicked",function(Ce){return e.CHM(re),e.oxw(3).openStateLink(Ce)}),e.qZA()}if(2&he){const re=e.oxw(3);e.Q6J("projectIdentifier",re.projectIdentifier)("configuration",re.configuration)}}function te(he,ae){if(1&he){const re=e.EpF();e.TgZ(0,"wp-grid",12),e.NdJ("itemClicked",function(Ce){return e.CHM(re),e.oxw(3).handleWorkPackageClicked(Ce)})("stateLinkClicked",function(Ce){return e.CHM(re),e.oxw(3).openStateLink(Ce)}),e.qZA()}if(2&he){const re=e.oxw(3);e.Q6J("configuration",re.configuration)}}function ee(he,ae){if(1&he&&(e.ynx(0),e.YNc(1,J,1,2,"op-filter-container",4),e.YNc(2,N,1,2,"wp-table",5),e.TgZ(3,"div",6),e.YNc(4,te,1,1,"wp-grid",7),e.qZA(),e.TgZ(5,"div",8),e._UZ(6,"wp-table-pagination",9),e.qZA(),e.BQk()),2&he){const re=e.oxw(2);e.xp6(1),e.Q6J("ngIf",re.configuration.withFilters),e.xp6(1),e.Q6J("ngIf",!re.configuration.isCardView),e.xp6(2),e.Q6J("ngIf",re.configuration.isCardView),e.xp6(2),e.Q6J("hideForSinglePageResults",!0)}}function G(he,ae){if(1&he&&(e.TgZ(0,"div",13),e._UZ(1,"span",14),e.qZA()),2&he){const re=e.oxw(2);e.xp6(1),e.Q6J("textContent",re.error.message||re.error)}}const se=function(he,ae,re){return{"-hierarchy-disabled":he,"-compact-tables":ae,"-external-height":re}};function me(he,ae){if(1&he&&(e.TgZ(0,"div",1),e.YNc(1,ee,7,4,"ng-container",2),e.YNc(2,G,2,1,"div",3),e.qZA()),2&he){const re=e.oxw();e.Q6J("ngClass",e.kEZ(4,se,!re.configuration.hierarchyToggleEnabled,re.configuration.compactTableStyle,re.externalHeight)),e.uIk("data-indicator-name",re.uniqueEmbeddedTableName),e.xp6(1),e.Q6J("ngIf",re.renderTable),e.xp6(1),e.Q6J("ngIf",re.error)}}class _e extends w{constructor(){super(...arguments),this.queryProps={},this.tableActions=[],this.externalHeight=!1,this.onError=new e.vpe,this.onQueryLoaded=new e.vpe}ngOnInit(){super.ngOnInit(),this.loadedQuery=this.querySpace.query.value}ngAfterViewInit(){super.ngAfterViewInit(),this.tableActions&&this.tableActionsService.setActions(...this.tableActions),this.wpTablePagination.updates$().pipe((0,x.U)(ae=>[ae.page,ae.perPage]),(0,k.x)(),this.untilDestroyed(),(0,b.M)(this.querySpace.query.values$())).subscribe(([ae,re])=>{const ye=this.wpTablePagination.paginationObject,Ce=this.urlParamsHelper.buildV3GetQueryFromQueryResource(re,ye);this.loadingIndicator=this.wpListService.loadQueryFromExisting(re,Ce,this.queryProjectScope).toPromise().then(ke=>this.initializeStates(ke))})}openConfigurationModal(ae){this.querySpace.query.valuesPromise().then(()=>{this.opModalService.show(n.Q,this.injector).onDataUpdated.subscribe(ae)})}initializeStates(ae){this.loadForm(ae),super.initializeStates(ae),this.querySpace.initialized.values$().pipe((0,v.q)(1)).subscribe(()=>{this.showTablePagination=ae.results.total>ae.results.count,this.setLoaded(),this.wpTableTimeline.isVisible&&(this.configuration=Object.assign(Object.assign({},this.configuration),{compactTableStyle:!1}))})}loadForm(ae){return this.formPromise?this.formPromise:this.formPromise=this.apiv3Service.withOptionalProject(this.projectIdentifier).queries.form.load(ae).toPromise().then(([re,ye])=>(this.wpStatesInitialization.updateStatesFromForm(ae,re),re)).catch(()=>this.formPromise=void 0)}loadQuery(ae=!0,re=!1){if(this.formPromise=void 0,this.loadedQuery){const Ce=this.loadedQuery;return this.loadedQuery=void 0,this.initializeStates(Ce),Promise.resolve(this.loadedQuery)}this.configuration.tableVisible||(this.queryProps.pageSize=1),re&&(this.queryProps.page=1),this.error=null;const ye=this.apiv3Service.queries.find(this.queryProps,this.queryId,this.queryProjectScope).toPromise().then(Ce=>(this.initializeStates(Ce),this.onQueryLoaded.emit(Ce),Ce)).catch(Ce=>{this.error=this.I18n.t("js.error.embedded_table_loading",{message:_.get(Ce,"message",Ce)}),this.onError.emit(Ce)});return ae&&(this.loadingIndicator=ye),ye}handleWorkPackageClicked(ae){ae.double&&this.$state.go("work-packages.show",{workPackageId:ae.workPackageId})}openStateLink(ae){const re={workPackageId:ae.workPackageId,focus:!0};"split"===ae.requestedState?this.keepTab.goCurrentDetailsState(re):this.keepTab.goCurrentShowState(re)}}_e.\u0275fac=function(){let he;return function(re){return(he||(he=e.n5z(_e)))(re||_e)}}(),_e.\u0275cmp=e.Xpm({type:_e,selectors:[["wp-embedded-table"]],inputs:{queryId:"queryId",queryProps:"queryProps",tableActions:"tableActions",externalHeight:"externalHeight"},outputs:{onError:"onError",onQueryLoaded:"onQueryLoaded"},features:[e.qOj],decls:1,vars:1,consts:[["class","work-packages-embedded-view--container loading-indicator--location",3,"ngClass",4,"ngIf"],[1,"work-packages-embedded-view--container","loading-indicator--location",3,"ngClass"],[4,"ngIf"],["class","op-toast -error",4,"ngIf"],[3,"showFilterButton","filterButtonText",4,"ngIf"],["class","work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked",4,"ngIf"],[1,"work-packages-embedded-view--grid-view"],[3,"configuration","itemClicked","stateLinkClicked",4,"ngIf"],[1,"work-packages-split-view--tabletimeline-footer","hide-when-print"],[3,"hideForSinglePageResults"],[3,"showFilterButton","filterButtonText"],[1,"work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked"],[3,"configuration","itemClicked","stateLinkClicked"],[1,"op-toast","-error"],[3,"textContent"]],template:function(ae,re){1&ae&&e.YNc(0,me,3,8,"div",0),2&ae&&e.Q6J("ngIf",re.configuration)},directives:[S.O5,S.mk,O.v,A.J,F.c,I.b],encapsulation:2}),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",m.T)],_e.prototype,"apiv3Service",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",h.S)],_e.prototype,"opModalService",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",r.j)],_e.prototype,"tableActionsService",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",c.W)],_e.prototype,"wpTableTimeline",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",u.S)],_e.prototype,"wpTablePagination",void 0),(0,i.gn)([(0,y.W)(),(0,i.w6)("design:type",M.p)],_e.prototype,"keepTab",void 0)},62016:(H,D,t)=>{"use strict";t.d(D,{O:()=>l});var i=t(166),e=t(71444),c=t(628),u=t(37605),r=t(55977),n=t(2316),h=t(97047);const a=["embeddedTableForConfiguration"],p=function(){return{tableVisible:!1}};class l{constructor(g,C,y){this.locals=g,this.urlParamsHelper=C,this.cdRef=y}ngOnInit(){this.locals.urlParams?this.queryProps=this.urlParamsHelper.buildV3GetQueryFromJsonParams(this.locals.currentQuery):this.queryProps=this.locals.currentQuery}ngAfterViewInit(){setTimeout(()=>{this.embeddedTable.openConfigurationModal(()=>{this.service.detach(),this.locals.urlParams?this.locals.callback(this.embeddedTable.buildUrlParams()):this.locals.callback(this.embeddedTable.buildQueryProps())}),this.cdRef.detectChanges()})}get service(){return this.locals.service}}l.\u0275fac=function(g){return new(g||l)(n.Y36(u.J),n.Y36(r.Z),n.Y36(n.sBO))},l.\u0275cmp=n.Xpm({type:l,selectors:[["ng-component"]],viewQuery:function(g,C){if(1&g&&n.Gf(a,7),2&g){let y;n.iGM(y=n.CRH())&&(C.embeddedTable=y.first)}},features:[n._Bn([[{provide:e.p,useClass:c.P}]])],decls:3,vars:3,consts:[["wp-isolated-query-space",""],[3,"queryProps","configuration"],["embeddedTableForConfiguration",""]],template:function(g,C){1&g&&(n.ynx(0,0),n._UZ(1,"wp-embedded-table",1,2),n.BQk()),2&g&&(n.xp6(1),n.Q6J("queryProps",C.queryProps)("configuration",n.DdM(2,p)))},directives:[h.A,i.Z],encapsulation:2})},37605:(H,D,t)=>{"use strict";t.d(D,{J:()=>e});const e=new(t(2316).OlP)("OpQueryConfigurationLocalsToken")},5275:(H,D,t)=>{"use strict";t.d(D,{W:()=>h});var i=t(40912),e=t(47775),c=t(7101),u=t(62016),r=t(37605),n=t(2316);class h{constructor(p,l,d,g,C){this.componentFactoryResolver=p,this.FocusHelper=l,this.appRef=d,this.$transitions=g,this.injector=C}get bodyPortalHost(){if(!this._portalHostElement){const p=this._portalHostElement=document.createElement("div");p.classList.add("op-external-query-configuration--container"),document.body.appendChild(p),this._bodyPortalHost=new i.u0(p,this.componentFactoryResolver,this.appRef,this.injector)}return this._bodyPortalHost}show(p){this.detach();const l=new i.C5(this.externalQueryConfigurationComponent(),null,this.injectorFor(p));this.bodyPortalHost.attach(l),this._portalHostElement.style.display="block"}detach(){this.bodyPortalHost.hasAttached()&&(this.bodyPortalHost.detach(),this._portalHostElement.style.display="none")}injectorFor(p){const l=new WeakMap;return p.service=this,l.set(r.J,p),new i.nK(this.injector,l)}externalQueryConfigurationComponent(){return u.O}}h.\u0275fac=function(p){return new(p||h)(n.LFG(n._Vd),n.LFG(c.i),n.LFG(n.z2F),n.LFG(e.TransitionService),n.LFG(n.zs3))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac})},74961:(H,D,t)=>{"use strict";t.d(D,{Q:()=>x});var i=t(5275),e=t(71444),c=t(628),u=t(12877),r=t(96617),n=t(74647),h=t(44022),a=t(2316),p=t(1707),l=t(54364);function d(k,b){if(1&k&&a._UZ(0,"option",4),2&k){const v=b.$implicit,M=a.oxw();a.Q6J("textContent",M.text[v.id])("ngValue",v)}}class g{constructor(b,v,M,S,O){this.injector=b,this.I18n=v,this.wpTableFilters=M,this.ConfigurationService=S,this.schemaCache=O,this.relationFilterIds=["parent","precedes","follows","relates","duplicates","duplicated","blocks","blocked","partof","includes","requires","required"],this.availableRelationFilters=[],this.selectedRelationFilter=void 0,this.text={filter_work_packages_by_relation_type:this.I18n.t("js.work_packages.table_configuration.relation_filters.filter_work_packages_by_relation_type"),please_select:this.I18n.t("js.placeholders.selection"),parent:this.I18n.t("js.relation_labels.children"),precedes:this.I18n.t("js.relation_labels.follows"),follows:this.I18n.t("js.relation_labels.precedes"),relates:this.I18n.t("js.relation_labels.relates"),duplicates:this.I18n.t("js.relation_labels.duplicated"),duplicated:this.I18n.t("js.relation_labels.duplicates"),blocks:this.I18n.t("js.relation_labels.blocked"),blocked:this.I18n.t("js.relation_labels.blocks"),requires:this.I18n.t("js.relation_labels.required"),required:this.I18n.t("js.relation_labels.requires"),partof:this.I18n.t("js.relation_labels.includes"),includes:this.I18n.t("js.relation_labels.partof")}}ngOnInit(){const b=this;this.wpTableFilters.onReady().then(()=>{b.availableRelationFilters=b.relationFiltersOf(b.wpTableFilters.availableFilters),b.setSelectedRelationFilter()})}setSelectedRelationFilter(){const b=this.relationFiltersOf(this.wpTableFilters.current);b.length>0?this.selectedRelationFilter=_.find(this.availableRelationFilters,{id:b[0].id}):this.selectedRelationFilter=this.availableRelationFilters[0],this.onRelationFilterSelected()}onRelationFilterSelected(){this.selectedRelationFilter&&(this.removeRelationFiltersFromCurrentState(),this.addFilterToCurrentState(this.selectedRelationFilter))}removeRelationFiltersFromCurrentState(){const b=this.relationFiltersOf(this.wpTableFilters.current);this.wpTableFilters.remove(...b)}relationFiltersOf(b){return _.filter(b,v=>_.includes(this.relationFilterIds,v.id))}addFilterToCurrentState(b){const v=this.wpTableFilters.instantiate(b),M=this.getOperatorForId(v,"=");v.operator=M,v.values=[{href:"/api/v3/work_packages/{id}"}],this.wpTableFilters.add(v)}getOperatorForId(b,v){return _.find(this.schemaCache.of(b).availableOperators,{id:v})}compareRelationFilters(b,v){return b&&v?b.id===v.id:b===v}}g.\u0275fac=function(b){return new(b||g)(a.Y36(a.zs3),a.Y36(r.D),a.Y36(n.Z),a.Y36(u.e),a.Y36(h.y))},g.\u0275cmp=a.Xpm({type:g,selectors:[["wp-table-configuration-relation-selector"]],decls:6,vars:4,consts:[[1,"relation-filter-selector"],[3,"textContent"],["id","",1,"form--select","form--inline-select",3,"ngModel","compareWith","ngModelChange"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"]],template:function(b,v){1&b&&(a.TgZ(0,"div",0),a.TgZ(1,"h5"),a._UZ(2,"span",1),a._uU(3," "),a.TgZ(4,"select",2),a.NdJ("ngModelChange",function(S){return v.selectedRelationFilter=S})("ngModelChange",function(){return v.onRelationFilterSelected()}),a.YNc(5,d,1,2,"option",3),a.qZA(),a.qZA(),a.qZA()),2&b&&(a.xp6(2),a.Q6J("textContent",v.text.filter_work_packages_by_relation_type),a.xp6(2),a.Q6J("ngModel",v.selectedRelationFilter)("compareWith",v.compareRelationFilters),a.xp6(1),a.Q6J("ngForOf",v.availableRelationFilters))},directives:[p.EJ,p.JJ,p.On,l.sg,p.YN,p.Kr],encapsulation:2});var C=t(57119),y=t(62016),m=t(97047),E=t(166);const P=function(){return{tableVisible:!1}};class w extends y.O{}w.\u0275fac=function(){let k;return function(v){return(k||(k=a.n5z(w)))(v||w)}}(),w.\u0275cmp=a.Xpm({type:w,selectors:[["ng-component"]],features:[a._Bn([[{provide:e.p,useClass:c.P}],{provide:C.c,useValue:g}]),a.qOj],decls:3,vars:3,consts:[["wp-isolated-query-space",""],[3,"queryProps","configuration"],["embeddedTableForConfiguration",""]],template:function(b,v){1&b&&(a.ynx(0,0),a._UZ(1,"wp-embedded-table",1,2),a.BQk()),2&b&&(a.xp6(1),a.Q6J("queryProps",v.queryProps)("configuration",a.DdM(2,P)))},directives:[m.A,E.Z],encapsulation:2});class x extends i.W{externalQueryConfigurationComponent(){return w}}x.\u0275fac=function(){let k;return function(v){return(k||(k=a.n5z(x)))(v||x)}}(),x.\u0275prov=a.Yz7({token:x,factory:x.\u0275fac})},628:(H,D,t)=>{"use strict";t.d(D,{P:()=>r});var i=t(96617),e=t(71444),c=t(37605),u=t(2316);class r extends e.p{constructor(h,a){super(a),this.locals=h,this.I18n=a}get tabs(){const h=this.locals.disabledTabs||{};return this._tabs.map(a=>{const p=h[a.id];return null!=p&&(a.disable=p),a})}}r.\u0275fac=function(h){return new(h||r)(u.LFG(c.J),u.LFG(i.D))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac})},23893:(H,D,t)=>{"use strict";t.d(D,{g:()=>c});var i=t(85003),e=t(65978);class c extends i.z9{constructor(r,n,h,a,p,l){super(r,n),this.injector=r,this.workPackage=n,this.identifier=h,this.title=a,this.applicable=p,this.onClick=l}static factoryFor(r,n,h,a=(()=>!0)){return(p,l)=>new c(p,l,r,n,a,h)}buildElement(){if(!this.applicable(this.workPackage))return null;const r=document.createElement("a");return r.title=this.title,r.href="#",r.classList.add(i.gK,"wp-table-action--unlink"),r.dataset.workPackageId=this.workPackage.id,r.appendChild((0,e.c)("icon","icon-close")),jQuery(r).click(n=>{n.preventDefault(),this.onClick(this.workPackage)}),r}}},85003:(H,D,t)=>{"use strict";t.d(D,{oE:()=>u,K$:()=>r,E4:()=>n,gK:()=>h,z9:()=>a});var i=t(3786),e=t(96617),c=t(29161);const u="wp-table--context-menu-td",r="wp-table--context-menu-span",n="wp-table-context-menu-link",h="wp-table-context-menu-icon";class a{constructor(l,d){this.injector=l,this.workPackage=d}}(0,i.gn)([(0,c.W)(),(0,i.w6)("design:type",e.D)],a.prototype,"I18n",void 0)},93903:(H,D,t)=>{"use strict";t.d(D,{j:()=>l});var i=t(85003),e=t(65978),c=t(84109),u=t(20506),r=t(47775);class h extends i.z9{constructor(){super(...arguments),this.identifier="open-details-action",this.uiStatebuilder=new u.mE(this.injector.get(r.StateService),this.injector.get(c.p)),this.text={button:this.I18n.t("js.button_open_details")}}buildElement(){const g=this.uiStatebuilder.linkToDetails(this.workPackage.id,this.text.button,"");return g.classList.add("wp-table--details-link",i.gK,"hidden-for-mobile"),g.appendChild((0,e.c)("icon","icon-info2")),g}}class a extends i.z9{constructor(){super(...arguments),this.identifier="open-context-menu-action",this.text={linkTitle:this.I18n.t("js.label_open_context_menu")}}buildElement(){const g=document.createElement("a");return g.href="#",g.classList.add(i.E4,i.gK),g.title=this.text.linkTitle,g.appendChild((0,e.c)("icon","icon-show-more-horizontal")),g}}var p=t(2316);class l{constructor(g){this.injector=g,this.actions=[(C,y)=>new h(C,y),(C,y)=>new a(C,y)]}setActions(...g){this.actions=g}render(g){const C=this.actions.map(y=>y(this.injector,g).buildElement());return _.compact(C)}}l.\u0275fac=function(g){return new(g||l)(p.LFG(p.zs3))},l.\u0275prov=p.Yz7({token:l,factory:l.\u0275fac})},2770:(H,D,t)=>{"use strict";t.d(D,{v:()=>Ie});var i=t(96617),e=t(40533),c=t(82763),u=t(43440),r=t(61486),n=t(2316),h=t(26942),a=t(14359),p=t(68853),l=t(54364),d=t(2775);function C(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"li",15),n.TgZ(1,"button",16),n.NdJ("click",function(){const oe=n.CHM(R).$implicit;return n.oxw(3).showPage(oe)}),n.qZA(),n.qZA()}if(2&ue){const R=ie.$implicit;n.xp6(1),n.Q6J("textContent",R)}}function y(ue,ie){if(1&ue&&(n.ynx(0),n.YNc(1,C,2,1,"li",13),n.TgZ(2,"li",14),n._uU(3,"\u2026"),n.qZA(),n.BQk()),2&ue){const R=n.oxw(2);n.xp6(1),n.Q6J("ngForOf",R.prePageNumbers)}}function m(ue,ie){if(1&ue&&(n.TgZ(0,"em"),n._uU(1),n.qZA()),2&ue){const R=n.oxw().$implicit;n.xp6(1),n.Oqu(R)}}function E(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"button",16),n.NdJ("click",function(){n.CHM(R);const W=n.oxw().$implicit;return n.oxw(3).showPage(W)}),n.qZA()}if(2&ue){const R=n.oxw().$implicit;n.Q6J("textContent",R)}}const P=function(ue){return{"op-pagination--item_current":ue}};function w(ue,ie){if(1&ue&&(n.TgZ(0,"li",19),n.YNc(1,m,2,1,"em",6),n.YNc(2,E,1,1,"button",20),n.qZA()),2&ue){const R=ie.$implicit,L=n.oxw(3);n.Q6J("ngClass",n.VKq(3,P,R==L.pagination.page)),n.xp6(1),n.Q6J("ngIf",R==L.pagination.page),n.xp6(1),n.Q6J("ngIf",R!=L.pagination.page)}}function x(ue,ie){1&ue&&(n.TgZ(0,"li",14),n._uU(1,"\u2026"),n.qZA())}function k(ue,ie){if(1&ue&&(n.ynx(0),n.YNc(1,w,3,5,"li",17),n.YNc(2,x,2,0,"li",18),n.BQk()),2&ue){const R=n.oxw(2);n.xp6(1),n.Q6J("ngForOf",R.pageNumbers),n.xp6(1),n.Q6J("ngIf",R.postPageNumbers.length)}}function b(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"li",15),n.TgZ(1,"button",16),n.NdJ("click",function(){const oe=n.CHM(R).$implicit;return n.oxw(3).showPage(oe)}),n.qZA(),n.qZA()}if(2&ue){const R=ie.$implicit;n.xp6(1),n.Q6J("textContent",R)}}function v(ue,ie){if(1&ue&&(n.ynx(0),n.YNc(1,b,2,1,"li",13),n.BQk()),2&ue){const R=n.oxw(2);n.xp6(1),n.Q6J("ngForOf",R.postPageNumbers)}}function M(ue,ie){if(1&ue&&n._UZ(0,"span",21),2&ue){const R=n.oxw(2);n.Q6J("textContent",R.text.no_other_page)}}function S(ue,ie){if(1&ue&&(n.TgZ(0,"li",22),n._UZ(1,"op-icon",23),n._UZ(2,"span",9),n.qZA()),2&ue){const R=n.oxw(2);n.xp6(2),n.Q6J("textContent",R.infoText)}}function O(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"span"),n.TgZ(1,"button",27),n.NdJ("click",function(){n.CHM(R);const W=n.oxw().$implicit;return n.oxw(3).selectPerPage(W)}),n.qZA(),n.qZA()}if(2&ue){const R=n.oxw().$implicit;n.xp6(1),n.Q6J("textContent",R)}}function A(ue,ie){if(1&ue&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&ue){const R=n.oxw().$implicit;n.xp6(1),n.Oqu(R)}}function F(ue,ie){if(1&ue&&(n.TgZ(0,"li",19),n.YNc(1,O,2,1,"span",6),n.YNc(2,A,2,1,"span",6),n.qZA()),2&ue){const R=ie.$implicit,L=n.oxw(3);n.Q6J("ngClass",n.VKq(3,P,R==L.pagination.perPage)),n.xp6(1),n.Q6J("ngIf",R!=L.pagination.perPage),n.xp6(1),n.Q6J("ngIf",R==L.pagination.perPage)}}function I(ue,ie){if(1&ue&&(n.TgZ(0,"div",24),n.TgZ(1,"ul",25),n._UZ(2,"li",26),n.YNc(3,F,3,5,"li",17),n.qZA(),n.qZA()),2&ue){const R=n.oxw(2);n.xp6(2),n.s9C("title",R.text.per_page),n.Q6J("textContent",R.text.per_page),n.xp6(1),n.Q6J("ngForOf",R.perPageOptions)}}function J(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"div",1),n.TgZ(1,"nav",2),n.TgZ(2,"ul",3),n.TgZ(3,"li",4),n.TgZ(4,"button",5),n.NdJ("click",function(){n.CHM(R);const W=n.oxw();return W.showPage(W.pagination.page-1)}),n._uU(5," < "),n.qZA(),n.qZA(),n.YNc(6,y,4,1,"ng-container",6),n.YNc(7,k,3,2,"ng-container",6),n.YNc(8,v,2,1,"ng-container",6),n.TgZ(9,"li",4),n.TgZ(10,"button",7),n.NdJ("click",function(){n.CHM(R);const W=n.oxw();return W.showPage(W.pagination.page+1)}),n._uU(11," > "),n.qZA(),n.qZA(),n.TgZ(12,"li",8),n._UZ(13,"span",9),n.YNc(14,M,1,1,"span",10),n.qZA(),n.YNc(15,S,3,1,"li",11),n.qZA(),n.qZA(),n.YNc(16,I,4,3,"div",12),n.qZA()}if(2&ue){const R=n.oxw();n.xp6(3),n.Q6J("hidden",1==R.pagination.page||!R.showPageSelections),n.xp6(1),n.uIk("aria-label",R.text.label_previous),n.xp6(2),n.Q6J("ngIf",R.prePageNumbers.length>0),n.xp6(1),n.Q6J("ngIf",R.pageNumbers.length>1),n.xp6(1),n.Q6J("ngIf",R.postPageNumbers.length),n.xp6(1),n.Q6J("hidden",!(R.pagination.total&&R.pagination.page<R.pageNumbers[R.pageNumbers.length-1])),n.xp6(1),n.uIk("aria-label",R.text.label_next),n.xp6(3),n.Q6J("textContent",R.currentRange),n.xp6(1),n.Q6J("ngIf",1===R.pageNumbers.length),n.xp6(1),n.Q6J("ngIf",R.infoText),n.xp6(1),n.Q6J("ngIf",R.showPerPageOptions())}}class N extends h.N{constructor(ie,R,L){super(),this.paginationService=ie,this.cdRef=R,this.I18n=L,this.hideForSinglePageResults=!1,this.showPerPage=!0,this.showPageSelections=!0,this.updateResults=new n.vpe,this.text={label_previous:this.I18n.t("js.pagination.pages.previous"),label_next:this.I18n.t("js.pagination.pages.next"),per_page:this.I18n.t("js.label_per_page"),no_other_page:this.I18n.t("js.pagination.no_other_page")},this.currentRange="",this.pageNumbers=[],this.postPageNumbers=[],this.prePageNumbers=[],this.perPageOptions=[]}ngOnInit(){this.paginationService.loadPaginationOptions().then(ie=>{this.perPageOptions=ie.perPageOptions,this.pagination=new a.M(1,parseInt(this.totalEntries),ie.perPage),this.cdRef.detectChanges()})}update(){this.updateCurrentRangeLabel(),this.updatePageNumbers(),this.cdRef.detectChanges()}selectPerPage(ie){this.pagination.perPage=ie,this.paginationService.setPerPage(ie),this.showPage(1)}showPage(ie){this.pagination.page=ie,this.updateCurrentRangeLabel(),this.updatePageNumbers(),this.onUpdatedPage(),this.cdRef.detectChanges()}onUpdatedPage(){this.updateResults.emit(this.pagination)}get isVisible(){return!this.hideForSinglePageResults||this.pagination.total>this.pagination.perPage}updateCurrentRangeLabel(){if(this.pagination.total){const ie=this.pagination.total,R=this.pagination.getLowerPageBound(),L=this.pagination.getUpperPageBound(this.pagination.total);this.currentRange=`(${R}\xa0-\xa0${L}/${ie})`}else this.currentRange="(0 - 0/0)"}updatePageNumbers(){if(!this.showPageSelections)return this.pageNumbers=[],void(this.postPageNumbers=[]);const ie=this.paginationService.getMaxVisiblePageOptions(),R=this.paginationService.getOptionsTruncationSize(),L=[],{perPage:W}=this.pagination,oe=this.pagination.page;if(W){for(let $=1;$<=Math.ceil(this.pagination.total/W);$++)L.push($);const Oe=oe-2*R;Oe>=0&&Oe<=1?this.postPageNumbers=this.truncatePageNums(L,L.length>=ie+2*R,ie+R,L.length,0):(this.prePageNumbers=this.truncatePageNums(L,oe>=ie,0,Math.min(oe-Math.ceil(ie/2),L.length-ie),R),this.postPageNumbers=this.truncatePageNums(L,L.length>=ie+2*R,ie,L.length,0))}this.pageNumbers=L}showPerPageOptions(){return this.showPerPage&&this.perPageOptions.length>0&&this.pagination.total>this.perPageOptions[0]}truncatePageNums(ie,R,L,W,oe){if(R){const Oe=this.paginationService.getOptionsTruncationSize(),$=ie.splice(L,W);return $.length>=2*Oe&&$.splice(oe,$.length-Oe),$}return[]}}function te(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"li",15),n.TgZ(1,"button",16),n.NdJ("click",function(){const oe=n.CHM(R).$implicit;return n.oxw(3).showPage(oe)}),n.qZA(),n.qZA()}if(2&ue){const R=ie.$implicit;n.xp6(1),n.Q6J("textContent",R)}}function ee(ue,ie){if(1&ue&&(n.ynx(0),n.YNc(1,te,2,1,"li",13),n.TgZ(2,"li",14),n._uU(3,"\u2026"),n.qZA(),n.BQk()),2&ue){const R=n.oxw(2);n.xp6(1),n.Q6J("ngForOf",R.prePageNumbers)}}function G(ue,ie){if(1&ue&&(n.TgZ(0,"em"),n._uU(1),n.qZA()),2&ue){const R=n.oxw().$implicit;n.xp6(1),n.Oqu(R)}}function se(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"button",16),n.NdJ("click",function(){n.CHM(R);const W=n.oxw().$implicit;return n.oxw(3).showPage(W)}),n.qZA()}if(2&ue){const R=n.oxw().$implicit;n.Q6J("textContent",R)}}N.\u0275fac=function(ie){return new(ie||N)(n.Y36(p.N),n.Y36(n.sBO),n.Y36(i.D))},N.\u0275cmp=n.Xpm({type:N,selectors:[["","tablePagination",""]],inputs:{totalEntries:"totalEntries",hideForSinglePageResults:"hideForSinglePageResults",showPerPage:"showPerPage",showPageSelections:"showPageSelections",infoText:"infoText"},outputs:{updateResults:"updateResults"},features:[n.qOj],attrs:["tablePagination",""],decls:1,vars:1,consts:[["class","op-pagination",4,"ngIf"],[1,"op-pagination"],[1,"op-pagination--pages"],[1,"op-pagination--items","op-pagination--items_start"],[1,"op-pagination--item",3,"hidden"],["type","button","rel","prev start",1,"op-pagination--item-link","op-pagination--item-link_prev",3,"click"],[4,"ngIf"],["type","button","rel","next",1,"op-pagination--item-link","op-pagination--item-link_next",3,"click"],[1,"op-pagination--range"],[3,"textContent"],["id","op-pagination-empty-text","tabindex","0","class","hidden-for-sighted",3,"textContent",4,"ngIf"],["class","op-pagination--info",4,"ngIf"],["class","op-pagination--options",4,"ngIf"],["class","op-pagination--item",4,"ngFor","ngForOf"],[1,"op-pagination--space"],[1,"op-pagination--item"],["type","button","rel","next",1,"op-pagination--item-link",3,"textContent","click"],["class","op-pagination--item",3,"ngClass",4,"ngFor","ngForOf"],["class","op-pagination--space",4,"ngIf"],[1,"op-pagination--item",3,"ngClass"],["class","op-pagination--item-link","type","button","rel","next",3,"textContent","click",4,"ngIf"],["id","op-pagination-empty-text","tabindex","0",1,"hidden-for-sighted",3,"textContent"],[1,"op-pagination--info"],["icon-classes","icon-info1 icon-context"],[1,"op-pagination--options"],[1,"op-pagination--items","op-pagination--items_end"],[1,"op-pagination--label",3,"textContent","title"],["type","button",1,"op-pagination--item-link",3,"textContent","click"]],template:function(ie,R){1&ie&&n.YNc(0,J,17,11,"div",0),2&ie&&n.Q6J("ngIf",R.pagination&&R.isVisible&&R.pagination.total)},directives:[l.O5,l.sg,l.mk,d.o],encapsulation:2,changeDetection:0});const me=function(ue){return{"op-pagination--item_current":ue}};function _e(ue,ie){if(1&ue&&(n.TgZ(0,"li",19),n.YNc(1,G,2,1,"em",6),n.YNc(2,se,1,1,"button",20),n.qZA()),2&ue){const R=ie.$implicit,L=n.oxw(3);n.Q6J("ngClass",n.VKq(3,me,R==L.pagination.page)),n.xp6(1),n.Q6J("ngIf",R==L.pagination.page),n.xp6(1),n.Q6J("ngIf",R!=L.pagination.page)}}function he(ue,ie){1&ue&&(n.TgZ(0,"li",14),n._uU(1,"\u2026"),n.qZA())}function ae(ue,ie){if(1&ue&&(n.ynx(0),n.YNc(1,_e,3,5,"li",17),n.YNc(2,he,2,0,"li",18),n.BQk()),2&ue){const R=n.oxw(2);n.xp6(1),n.Q6J("ngForOf",R.pageNumbers),n.xp6(1),n.Q6J("ngIf",R.postPageNumbers.length)}}function re(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"li",15),n.TgZ(1,"button",16),n.NdJ("click",function(){const oe=n.CHM(R).$implicit;return n.oxw(3).showPage(oe)}),n.qZA(),n.qZA()}if(2&ue){const R=ie.$implicit;n.xp6(1),n.Q6J("textContent",R)}}function ye(ue,ie){if(1&ue&&(n.ynx(0),n.YNc(1,re,2,1,"li",13),n.BQk()),2&ue){const R=n.oxw(2);n.xp6(1),n.Q6J("ngForOf",R.postPageNumbers)}}function Ce(ue,ie){if(1&ue&&n._UZ(0,"span",21),2&ue){const R=n.oxw(2);n.Q6J("textContent",R.text.no_other_page)}}function ke(ue,ie){if(1&ue&&(n.TgZ(0,"li",22),n._UZ(1,"op-icon",23),n._UZ(2,"span",9),n.qZA()),2&ue){const R=n.oxw(2);n.xp6(2),n.Q6J("textContent",R.infoText)}}function Ae(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"span"),n.TgZ(1,"button",27),n.NdJ("click",function(){n.CHM(R);const W=n.oxw().$implicit;return n.oxw(3).selectPerPage(W)}),n.qZA(),n.qZA()}if(2&ue){const R=n.oxw().$implicit;n.xp6(1),n.Q6J("textContent",R)}}function Fe(ue,ie){if(1&ue&&(n.TgZ(0,"span"),n._uU(1),n.qZA()),2&ue){const R=n.oxw().$implicit;n.xp6(1),n.Oqu(R)}}function ot(ue,ie){if(1&ue&&(n.TgZ(0,"li",19),n.YNc(1,Ae,2,1,"span",6),n.YNc(2,Fe,2,1,"span",6),n.qZA()),2&ue){const R=ie.$implicit,L=n.oxw(3);n.Q6J("ngClass",n.VKq(3,me,R==L.pagination.perPage)),n.xp6(1),n.Q6J("ngIf",R!=L.pagination.perPage),n.xp6(1),n.Q6J("ngIf",R==L.pagination.perPage)}}function it(ue,ie){if(1&ue&&(n.TgZ(0,"div",24),n.TgZ(1,"ul",25),n._UZ(2,"li",26),n.YNc(3,ot,3,5,"li",17),n.qZA(),n.qZA()),2&ue){const R=n.oxw(2);n.xp6(2),n.s9C("title",R.text.per_page),n.Q6J("textContent",R.text.per_page),n.xp6(1),n.Q6J("ngForOf",R.perPageOptions)}}function Ve(ue,ie){if(1&ue){const R=n.EpF();n.TgZ(0,"div",1),n.TgZ(1,"nav",2),n.TgZ(2,"ul",3),n.TgZ(3,"li",4),n.TgZ(4,"button",5),n.NdJ("click",function(){n.CHM(R);const W=n.oxw();return W.showPage(W.pagination.page-1)}),n._uU(5," < "),n.qZA(),n.qZA(),n.YNc(6,ee,4,1,"ng-container",6),n.YNc(7,ae,3,2,"ng-container",6),n.YNc(8,ye,2,1,"ng-container",6),n.TgZ(9,"li",4),n.TgZ(10,"button",7),n.NdJ("click",function(){n.CHM(R);const W=n.oxw();return W.showPage(W.pagination.page+1)}),n._uU(11," > "),n.qZA(),n.qZA(),n.TgZ(12,"li",8),n._UZ(13,"span",9),n.YNc(14,Ce,1,1,"span",10),n.qZA(),n.YNc(15,ke,3,1,"li",11),n.qZA(),n.qZA(),n.YNc(16,it,4,3,"div",12),n.qZA()}if(2&ue){const R=n.oxw();n.xp6(3),n.Q6J("hidden",1==R.pagination.page||!R.showPageSelections),n.xp6(1),n.uIk("aria-label",R.text.label_previous),n.xp6(2),n.Q6J("ngIf",R.prePageNumbers.length>0),n.xp6(1),n.Q6J("ngIf",R.pageNumbers.length>1),n.xp6(1),n.Q6J("ngIf",R.postPageNumbers.length),n.xp6(1),n.Q6J("hidden",!(R.pagination.total&&R.pagination.page<R.pageNumbers[R.pageNumbers.length-1])),n.xp6(1),n.uIk("aria-label",R.text.label_next),n.xp6(3),n.Q6J("textContent",R.currentRange),n.xp6(1),n.Q6J("ngIf",1===R.pageNumbers.length),n.xp6(1),n.Q6J("ngIf",R.infoText),n.xp6(1),n.Q6J("ngIf",R.showPerPageOptions())}}class Ie extends N{constructor(ie,R,L,W,oe,Oe){super(ie,R,Oe),this.paginationService=ie,this.cdRef=R,this.wpTablePagination=L,this.querySpace=W,this.wpTableSortBy=oe,this.I18n=Oe}ngOnInit(){this.paginationService.loadPaginationOptions().then(ie=>{this.perPageOptions=ie.perPageOptions,this.cdRef.detectChanges()}),this.wpTablePagination.live$().pipe(this.untilDestroyed()).subscribe(ie=>{this.pagination=ie.current,this.update()}),(0,r.aj)([this.querySpace.query.values$(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe(([ie,R])=>{this.showPerPage=this.showPageSelections=!this.isManualSortingMode,this.infoText=this.paginationInfoText(ie.results),this.update()})}selectPerPage(ie){this.paginationService.setPerPage(ie),this.wpTablePagination.updateFromObject({page:1,perPage:ie})}showPage(ie){this.wpTablePagination.updateFromObject({page:ie})}get isManualSortingMode(){return this.wpTableSortBy.isManualSortingMode}paginationInfoText(ie){if(this.isManualSortingMode&&ie.count<ie.total)return I18n.t("js.work_packages.limited_results",{count:ie.count})}}Ie.\u0275fac=function(ie){return new(ie||Ie)(n.Y36(p.N),n.Y36(n.sBO),n.Y36(e.S),n.Y36(u.q),n.Y36(c.q),n.Y36(i.D))},Ie.\u0275cmp=n.Xpm({type:Ie,selectors:[["wp-table-pagination"]],features:[n.qOj],decls:1,vars:1,consts:[["class","op-pagination",4,"ngIf"],[1,"op-pagination"],[1,"op-pagination--pages"],[1,"op-pagination--items","op-pagination--items_start"],[1,"op-pagination--item",3,"hidden"],["type","button","rel","prev start",1,"op-pagination--item-link","op-pagination--item-link_prev",3,"click"],[4,"ngIf"],["type","button","rel","next",1,"op-pagination--item-link","op-pagination--item-link_next",3,"click"],[1,"op-pagination--range"],[3,"textContent"],["id","op-pagination-empty-text","tabindex","0","class","hidden-for-sighted",3,"textContent",4,"ngIf"],["class","op-pagination--info",4,"ngIf"],["class","op-pagination--options",4,"ngIf"],["class","op-pagination--item",4,"ngFor","ngForOf"],[1,"op-pagination--space"],[1,"op-pagination--item"],["type","button","rel","next",1,"op-pagination--item-link",3,"textContent","click"],["class","op-pagination--item",3,"ngClass",4,"ngFor","ngForOf"],["class","op-pagination--space",4,"ngIf"],[1,"op-pagination--item",3,"ngClass"],["class","op-pagination--item-link","type","button","rel","next",3,"textContent","click",4,"ngIf"],["id","op-pagination-empty-text","tabindex","0",1,"hidden-for-sighted",3,"textContent"],[1,"op-pagination--info"],["icon-classes","icon-info1 icon-context"],[1,"op-pagination--options"],[1,"op-pagination--items","op-pagination--items_end"],[1,"op-pagination--label",3,"textContent","title"],["type","button",1,"op-pagination--item-link",3,"textContent","click"]],template:function(ie,R){1&ie&&n.YNc(0,Ve,17,11,"div",0),2&ie&&n.Q6J("ngIf",R.pagination&&R.isVisible&&R.pagination.total)},directives:[l.O5,l.sg,l.mk,d.o],encapsulation:2,changeDetection:0})},42529:(H,D,t)=>{"use strict";t.d(D,{mN:()=>c,PY:()=>u,oo:()=>r,LT:()=>n,bz:()=>h,eY:()=>a,$r:()=>l,GC:()=>d,g5:()=>g,O6:()=>C,lW:()=>y,jr:()=>m,kv:()=>E,Nm:()=>P});var i=t(2281);const c="timeline-element",u="timeline-element--bg",r="wp-timeline--grid-element",n="selection-start",h="wp-timeline--header-element",a="wp-timeline-header";class p{constructor(){this.zoomLevel="days"}}const l=["days","weeks","months","quarters","years"];function d(w){switch(w){case"days":return 30;case"weeks":return 15;case"months":return 6;case"quarters":return 2;case"years":return.5}throw new Error(`invalid zoom level: ${w}`)}const g=120;class C{constructor(){this.now=i({hour:0,minute:0,seconds:0}),this.dateDisplayStart=i({hour:0,minute:0,seconds:0}),this.dateDisplayEnd=this.dateDisplayStart.clone().add(1,"day"),this.settings=new p,this.activeSelectionMode=null,this.selectionModeStart=null}get pixelPerDay(){return d(this.settings.zoomLevel)}get maxWidthInPx(){return this.maxSteps*this.pixelPerDay}get maxSteps(){return this.dateDisplayEnd.diff(this.dateDisplayStart,"days")}get dayCountForMarginLeft(){return Math.ceil(g/this.pixelPerDay)}}function y(w,x){return x*w.pixelPerDay}function m(w,x){return`${y(w,x)}px`}function E(w,x,k,b){const v=[],M=[],S=k.clone().startOf(x),O=b.clone().endOf(x);for(;S.isBefore(O);){const J=i.max(S,k).clone(),N=i.min(S.clone().endOf(x),b).clone();S.add(1,x);const te=w.visibleViewportAtCalculationTime;J.isSameOrAfter(te[0])&&J.isSameOrBefore(te[1])||N.isSameOrAfter(te[0])&&N.isSameOrBefore(te[1])?v.push([J,N]):M.push([J,N])}const A=M.splice(0,1)[0],F=M.pop();return{inViewportAndBoundaries:_.concat([A].filter(J=>!_.isNil(J)),v,[F].filter(J=>!_.isNil(J))),rest:M}}function P(w,x,k){let b=i(),v=i();return w.forEach(S=>{const O=S.workPackageId;if(!O)return;const F=x.get(O).value;if(!F)return;const I=F.startDate?F.startDate:F.date;I&&i(I).isBefore(b)&&(b=i(I));const J=F.dueDate?F.dueDate:F.date;J&&i(J).isAfter(v)&&(v=i(J))}),v.diff(b,"days")+1}},45338:(H,D,t)=>{"use strict";t.d(D,{O:()=>i});class i{constructor(c){this.tableVisible=!0,this.compactTableStyle=!1,this.actionsColumnEnabled=!0,this.contextMenuEnabled=!0,this.columnMenuEnabled=!0,this.projectContext=!0,this.projectIdentifier=null,this.inlineCreateEnabled=!0,this.hierarchyToggleEnabled=!0,this.dragAndDropEnabled=!1,this.isEmbedded=!1,this.isCardView=!1,this.withFilters=!1,this.filtersExpanded=!1,this.showFilterButton=!1,this.filterButtonText=I18n.t("js.button_filter"),_.each(c,(u,r)=>{this[r]=u})}}},9822:(H,D,t)=>{"use strict";t.d(D,{UX:()=>e,e9:()=>a});const e=".work-packages-tabletimeline--timeline-side",c=".scroll-sync";function n(p){if(0===p)return p;let l=15;return p<0&&(l*=-1),l}function h(p,l,d){const g=p.target,C=p.originalEvent;let[y,m]=function(p){let l=p.deltaX,d=p.deltaY;return p.shiftKey&&(l=d,d=0),[l,d]}(C);0!==m&&(y=n(y),m=n(m),window.requestAnimationFrame(()=>{l[0].scrollTop=l[0].scrollTop+m,d[0].scrollTop=l[0].scrollTop+m,g.scrollLeft+=y}))}function a(p){const l=jQuery(p).find(".work-packages-tabletimeline--table-side"),d=jQuery(p).find(e);return g=>{let C=!1,y=!1;g?(l.on(`wheel${c}`,m=>{h(m,l,d)}),l.on(`scroll${c}`,m=>{C=!0,y||(d[0].scrollTop=m.target.scrollTop),C&&y&&(C=!1,y=!1)}),d.on(`wheel${c}`,m=>{h(m,l,d)}),d.on(`scroll${c}`,m=>{y=!0,C||(l[0].scrollTop=m.target.scrollTop),C&&y&&(C=!1,y=!1)})):l.off(c)}}},18942:(H,D,t)=>{"use strict";t.d(D,{c:()=>Pt});var i=t(2316),e=t(96617),c=t(3786),u=t(22663),r=t(83720),n=t(43440),h=t(84897),a=t(29161);class p{constructor(Se,Pe){this.injector=Se,this.wpTableHighlighting.updates$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions),(0,r.x)()).subscribe(()=>Pe.redrawTable())}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",h.B)],p.prototype,"wpTableHighlighting",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],p.prototype,"querySpace",void 0);var l=t(53466),d=t(8403),g=t(67727),C=t(82763),y=t(16451),m=t(87853),E=t(21680),P=t(45237),w=t(68354),x=t(95846),k=t(1056),b=t(61043),v=t(20979),M=t(99919),S=t(32030);class O{constructor(Se,Pe){this.injector=Se,this.table=Pe,null!==this.dragService&&(this.inlineCreateService.newInlineWorkPackageCreated.pipe((0,u.R)(this.querySpace.stopAllSubscriptions)).subscribe(We=>(0,c.mG)(this,void 0,void 0,function*(){const et=yield this.wpTableOrder.add(this.currentOrder,We);this.updateRenderedOrder(et)})),this.querySpace.stopAllSubscriptions.pipe((0,l.q)(1)).subscribe(()=>{this.dragService.remove(this.table.tbody)}),this.dragService.register({dragContainer:this.table.tbody,scrollContainers:[this.table.scrollContainer],accepts:()=>!0,moves:(We,et,lt)=>{if(!lt.classList.contains("wp-table--drag-and-drop-handle"))return!1;const ft=We.dataset.workPackageId,kt=this.states.workPackages.get(ft).value;return!!kt&&this.actionService.canPickup(kt)},onMoved:(We,et,lt,ft)=>(0,c.mG)(this,void 0,void 0,function*(){const kt=We.dataset.workPackageId;let Ft;try{const qt=yield this.apiV3Service.work_packages.id(kt).get().toPromise();if((0,M._D)(ft)){const ni=Array.from(ft.classList).find(Ri=>Ri.includes((0,S.xU)())).replace((0,S.xU)(),""),oi=lt.getElementsByClassName((0,S.xU)(ni)),di=oi[oi.length-1];Ft=this.findRowIndex(di)}else Ft=this.findRowIndex(We);const Xt=yield this.wpTableOrder.move(this.currentOrder,kt,Ft);yield this.actionService.handleDrop(qt,We),this.updateRenderedOrder(Xt),this.actionService.onNewOrder(Xt);const Ht=this.querySpace.query.value;Ht&&this.wpTableSortBy.switchToManualSorting(Ht)&&(yield this.wpListService.save(Ht))}catch(qt){this.halNotification.handleRawError(qt),this.actionService.changeShadowElement(We,!0),(0,w.d)(We,We.dataset.sourceIndex||-1,lt)}}),onRemoved:We=>{const et=We.dataset.workPackageId,lt=this.wpTableOrder.remove(this.currentOrder,et);this.updateRenderedOrder(lt)},onAdded:We=>(0,c.mG)(this,void 0,void 0,function*(){const et=We.dataset.workPackageId,lt=yield this.apiV3Service.work_packages.id(et).get().toPromise(),ft=this.findRowIndex(We);return this.actionService.handleDrop(lt,We).then(()=>(0,c.mG)(this,void 0,void 0,function*(){const kt=yield this.wpTableOrder.add(this.currentOrder,et,ft);return this.updateRenderedOrder(kt),this.actionService.onNewOrder(kt),!0})).catch(()=>!1)}),onCloned:(We,et)=>(0,c.mG)(this,void 0,void 0,function*(){const lt=et.dataset.workPackageId,ft=yield this.apiV3Service.work_packages.id(lt).get().toPromise(),kt=We.children.length,Ft=document.createElement("td");Ft.textContent=ft.subjectWithId(),Ft.colSpan=kt,Ft.classList.add("wp-table--cell-td","subject"),We.style.maxWidth="500px",We.innerHTML=Ft.outerHTML}),onShadowInserted:We=>{this.browserDetector.isEdge||this.actionService.changeShadowElement(We)},onCancel:We=>{this.browserDetector.isEdge||this.actionService.changeShadowElement(We,!0)}}))}updateRenderedOrder(Se){return(0,c.mG)(this,void 0,void 0,function*(){Se=_.uniq(Se);const Pe=yield Promise.all(Se.map(We=>this.apiV3Service.work_packages.id(We).get().toPromise()));this.table.initialSetup(Pe)})}get actionService(){return this.dragActionRegistry.get(this.injector)}get currentOrder(){return this.currentRenderedOrder.map(Se=>Se.workPackageId)}get currentRenderedOrder(){return this.querySpace.renderedWorkPackages.getValueOr([])}findRowIndex(Se){return Array.from(this.table.tbody.getElementsByClassName(E.S)).indexOf(Se)||0}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",m.G)],O.prototype,"states",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],O.prototype,"querySpace",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",d.m)],O.prototype,"inlineCreateService",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",g.W)],O.prototype,"halNotification",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",C.q)],O.prototype,"wpTableSortBy",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",x.M)],O.prototype,"wpTableOrder",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",k.o)],O.prototype,"browserDetector",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",v.T)],O.prototype,"apiV3Service",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",b.Z)],O.prototype,"wpListService",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",y.B)],O.prototype,"dragActionRegistry",void 0),(0,c.gn)([(0,a.W)(P.j,null),(0,c.w6)("design:type",Object)],O.prototype,"dragService",void 0);var A=t(55236),F=t(79174);class I{constructor(Se,Pe){this.injector=Se,this.workPackageViewCollapsedGroupsService.updates$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions),(0,r.x)()).subscribe(We=>Pe.setGroupsCollapseState(We.state))}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",F.q)],I.prototype,"workPackageViewCollapsedGroupsService",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],I.prototype,"querySpace",void 0);var J=t(7812),N=t(12703),te=t(88837),ee=t(3352),G=t(52787);class se extends G.X{constructor(Se){super(),this.injector=Se}get EVENT(){return"click.table.cell, keydown.table.cell"}get SELECTOR(){return`.${J.OZ}.${J.c0}`}eventScope(Se){return jQuery(Se.workPackageTable.tableAndTimelineContainer)}processEvent(Se,Pe){(0,ee.qu)("Starting editing on cell: ",Pe.target),Pe.preventDefault();const We=jQuery(Pe.target).closest(`.${J.OZ}`),et=We.data("fieldName");if(!et)return(0,ee.qu)("Click handled by cell not a field? ",Pe.target),!0;const lt=We.closest(`.${E.S}`),ft=lt.data("workPackageId"),kt=this.states.workPackages.get(ft).value,Ft=lt.data("classIdentifier"),qt=Se.editing.startEditing(kt,Ft),Xt=(0,te.b)(Pe);return qt.activate(et).then(Ht=>{Ht.$onUserActivate.next(),Ht.focus(Xt)}).catch(()=>We.addClass(J.n5)),!1}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",m.G)],se.prototype,"states",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",N.l)],se.prototype,"halEditing",void 0);var me=t(41195),_e=t(33791);class he extends G.X{constructor(Se){super(),this.injector=Se}get EVENT(){return"click.table.relationsCell, keydown.table.relationsCell"}get SELECTOR(){return`.${_e._M}`}eventScope(Se){return jQuery(Se.workPackageTable.tableAndTimelineContainer)}processEvent(Se,Pe){(0,ee.qu)("Handled click on relation cell %o",Pe.target),Pe.preventDefault();const et=jQuery(Pe.target).closest(`.${_e.OR}`).data("columnId"),ft=jQuery(Pe.target).closest(`.${E.S}`).data("workPackageId");return this.wpTableRelationColumns.getExpandFor(ft)===et?this.wpTableRelationColumns.collapse(ft):this.wpTableRelationColumns.setExpandFor(ft,et),!1}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",me.a)],he.prototype,"wpTableRelationColumns",void 0);var ae=t(85003),re=t(20506),ye=t(20342),Ce=t(99794),ke=t(16793);class Ae extends Ce.X{constructor(Se,Pe,We,et={},lt){super(Se,Pe,We,et,!0),this.injector=Se,this.workPackageId=Pe,this.$element=We,this.additionalPositionArgs=et,this.table=lt}triggerContextMenuAction(Se){switch(Se.key){case"relation-precedes":this.table.timelineController.startAddRelationPredecessor(this.workPackage);break;case"relation-follows":this.table.timelineController.startAddRelationFollower(this.workPackage);break;case"hierarchy-indent":this.wpViewIndentation.indent(this.workPackage);break;case"hierarchy-outdent":this.wpViewIndentation.outdent(this.workPackage);break;default:super.triggerContextMenuAction(Se)}}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",ke.f)],Ae.prototype,"wpViewIndentation",void 0);class Fe{constructor(Se){this.injector=Se}get rowSelector(){return`.${E.S}`}eventScope(Se){return jQuery(Se.workPackageTable.tableAndTimelineContainer)}openContextMenu(Se,Pe,We,et){const lt=new Ae(this.injector,We,jQuery(Pe.target),et,Se);this.opContextMenu.show(lt,Pe)}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",ye.$)],Fe.prototype,"opContextMenu",void 0);class ot extends Fe{constructor(Se){super(Se),this.injector=Se}get EVENT(){return"click.table.contextmenu"}get SELECTOR(){return`.${ae.E4}`}handleEvent(Se,Pe){const We=jQuery(Pe.target);if(We.closest(`.${re.yF}`).length)return(0,ee.qu)("Allowing original context menu on state link"),!0;Pe.preventDefault(),Pe.stopPropagation();const lt=We.closest(this.rowSelector).data("workPackageId");return lt&&this.openContextMenu(Se.workPackageTable,Pe,lt),!1}}var it=t(33406);class Ve extends Fe{constructor(Se){super(Se),this.injector=Se}get EVENT(){return"keydown.table.contextmenu"}get SELECTOR(){return this.rowSelector}handleEvent(Se,Pe){if(!Se.workPackageTable.configuration.contextMenuEnabled)return!1;const We=jQuery(Pe.target);if(Pe.keyCode!==it.m.F10||!Pe.shiftKey||!Pe.altKey)return!0;Pe.preventDefault(),Pe.stopPropagation();const lt=We.closest(this.SELECTOR).data("workPackageId"),ft={my:"left top",at:"left bottom",of:We};return super.openContextMenu(Se.workPackageTable,Pe,lt,ft),!1}}var Ie=t(60914),ue=t(77850);class ie extends Fe{constructor(Se){super(Se),this.injector=Se}get EVENT(){return"contextmenu.table.rightclick"}get SELECTOR(){return`.${E.S},.${ue.j}`}eventScope(Se){return jQuery(Se.workPackageTable.tableAndTimelineContainer)}handleEvent(Se,Pe){if(!Se.workPackageTable.configuration.contextMenuEnabled)return!1;const We=jQuery(Pe.target);if(We.closest(`.${re.yF}`).length)return(0,ee.qu)("Allowing original context menu on state link"),!0;Pe.preventDefault(),Pe.stopPropagation();const lt=We.closest(this.SELECTOR).data("workPackageId");if(lt){const[ft]=Se.workPackageTable.findRenderedRow(lt);this.wpTableSelection.isSelected(lt)||this.wpTableSelection.setSelection(lt,ft),this.openContextMenu(Se.workPackageTable,Pe,lt)}return!1}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",Ie.J)],ie.prototype,"wpTableSelection",void 0);var R=t(47775),L=t(48451),W=t(91260),oe=t(84109);class Oe{constructor(Se){this.injector=Se}get EVENT(){return"click.table.row"}get SELECTOR(){return`.${E.S}`}eventScope(Se){return jQuery(Se.workPackageTable.tbody)}handleEvent(Se,Pe){const We=jQuery(Pe.target);if(We.is("a")||We.parent().is("a"))return!0;if(We.hasClass(`${J.OZ}`)||We.hasClass(`${W.as}`))return(0,ee.qu)("Skipping click on inner cell"),!0;const et=We.closest(this.SELECTOR),lt=et.data("workPackageId"),ft=et.data("classIdentifier");if(!lt)return!0;const[kt,Ft]=Se.workPackageTable.findRenderedRow(ft);return Pe.ctrlKey||Pe.metaKey||Pe.shiftKey||(this.wpTableSelection.setSelection(lt,kt),Se.itemClicked.emit({workPackageId:lt,double:!1})),Pe.shiftKey&&this.wpTableSelection.setMultiSelectionFrom(Se.workPackageTable.renderedRows,lt,kt),(Pe.ctrlKey||Pe.metaKey)&&this.wpTableSelection.toggleRow(lt),Se.selectionChanged.emit(this.wpTableSelection.getSelectedWorkPackageIds()),this.wpTableFocus.updateFocus(lt),!1}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",R.StateService)],Oe.prototype,"$state",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",m.G)],Oe.prototype,"states",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",oe.p)],Oe.prototype,"keepTab",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",Ie.J)],Oe.prototype,"wpTableSelection",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",L.o)],Oe.prototype,"wpTableFocus",void 0);var $=t(67325),Xe=t(88156);class rt{constructor(Se){this.injector=Se}get EVENT(){return"dblclick.table.row"}get SELECTOR(){return`.${Xe.Nm}`}eventScope(Se){return jQuery(Se.workPackageTable.tbody)}handleEvent(Se,Pe){const We=jQuery(Pe.target);if((0,$.F)(Pe))return!0;if(We.hasClass(`${J.OZ}`)||We.hasClass(`${W.as}`))return(0,ee.qu)("Skipping click on inner cell"),!0;const lt=We.closest(this.SELECTOR).closest(`.${E.S}`).data("workPackageId");return!(!We.is("a")&&!We.parent().is("a"))||(this.wpTableFocus.updateFocus(lt),Se.itemClicked.emit({workPackageId:lt,double:!0}),!1)}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",R.StateService)],rt.prototype,"$state",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",m.G)],rt.prototype,"states",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",Ie.J)],rt.prototype,"wpTableSelection",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",L.o)],rt.prototype,"wpTableFocus",void 0);var ge=t(68130);class be{constructor(Se){this.injector=Se}get EVENT(){return"click.table.groupheader"}get SELECTOR(){return`.${ge.u} .expander`}eventScope(Se){return jQuery(Se.workPackageTable.tbody)}handleEvent(Se,Pe){Pe.preventDefault(),Pe.stopPropagation();const et=jQuery(Pe.target).parents(`.${ge.u}`).data("groupIdentifier");this.workPackageViewCollapsedGroupsService.toggleGroupCollapseState(et)}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],be.prototype,"querySpace",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",F.q)],be.prototype,"workPackageViewCollapsedGroupsService",void 0);var Me=t(99676);class Re extends G.X{constructor(Se){super(),this.injector=Se}get EVENT(){return"click.table.hierarchy"}get SELECTOR(){return".wp-table--hierarchy-indicator"}eventScope(Se){return jQuery(Se.workPackageTable.tbody)}processEvent(Se,Pe){const lt=jQuery(Pe.target).closest(`.${E.S}`).data("workPackageId");return this.wpTableHierarchies.toggle(lt),Pe.stopImmediatePropagation(),Pe.preventDefault(),!1}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",m.G)],Re.prototype,"states",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",Me.Y)],Re.prototype,"wpTableHierarchies",void 0);class $e{constructor(Se){this.injector=Se}get EVENT(){return"click.table.wpLink"}get SELECTOR(){return`.${re.yF}`}eventScope(Se){return jQuery(Se.workPackageTable.tableAndTimelineContainer)}handleEvent(Se,Pe){if(Pe.shiftKey||Pe.ctrlKey||Pe.metaKey||Pe.altKey)return!0;const We=jQuery(Pe.target),et=We.closest(this.SELECTOR),lt=et.data("wpState"),ft=et.data("workPackageId");We.closest("a").blur();const Ft=We.closest(`.${E.S}`).data("classIdentifier"),[qt,Xt]=Se.workPackageTable.findRenderedRow(Ft);return this.wpTableSelection.setSelection(ft,qt),Se.stateLinkClicked.emit({workPackageId:ft,requestedState:lt}),Pe.preventDefault(),Pe.stopPropagation(),!1}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",R.StateService)],$e.prototype,"$state",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",oe.p)],$e.prototype,"keepTab",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",m.G)],$e.prototype,"states",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",Ie.J)],$e.prototype,"wpTableSelection",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",L.o)],$e.prototype,"wpTableFocus",void 0);var pt=t(71562);class mt{constructor(Se,Pe){this.injector=Se,this.table=Pe,this.wpTableColumns.updates$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{if(Pe.originalRows.length>0){const We=performance.now();Pe.redrawTable();const et=performance.now();(0,ee.qu)(`column redraw took ${et-We} milliseconds.`)}})}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],mt.prototype,"querySpace",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",pt.i)],mt.prototype,"wpTableColumns",void 0);var vt=t(33927),Ue=t(9170),Le=t(67362);class Ee{constructor(Se,Pe){this.injector=Se,this.wpTableHierarchies.updates$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions),(0,vt.U)(et=>et.isVisible),(0,r.x)()).subscribe(()=>{this.wpTableHierarchies.isEnabled||Pe.redrawTableAndTimeline()});let We=this.wpTableHierarchies.isEnabled;this.wpTableHierarchies.updates$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions),(0,Ue.h)(()=>this.querySpace.tableRendered.hasValue())).subscribe(et=>{et.isVisible===We&&this.renderHierarchyState(et),We=et.isVisible})}renderHierarchyState(Se){const Pe=this.querySpace.tableRendered.value;jQuery('[class^="__hierarchy-group-"]').removeClass((et,lt)=>(lt.match(/__collapsed-group-\d+/g)||[]).join(" "));const We={};_.each(Se.collapsed,(et,lt)=>{jQuery(`.${(0,S.MO)(lt)} .wp-table--hierarchy-indicator`).toggleClass(Le.YZ,et);const ft=document.querySelector(`.wp-timeline-cell.__hierarchy-root-${lt}`);ft&&(et?ft.classList.add("__hierarchy-root-collapsed"):ft.classList.remove("__hierarchy-root-collapsed"));const kt=jQuery(`.${(0,S.oQ)(lt)}`);kt.toggleClass((0,S.xU)(lt),et),kt.filter(`.${E.S}`).each((Ft,qt)=>{const Xt=jQuery(qt).index();We[Xt]||(Pe[Xt].hidden=et,We[Xt]=et)})}),Se.last&&(0,M.Ui)(Se.last),this.querySpace.tableRendered.putValue(Pe,"Updated hidden state of rows after hierarchy change.")}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",Me.Y)],Ee.prototype,"wpTableHierarchies",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],Ee.prototype,"querySpace",void 0);class st{constructor(Se,Pe){this.injector=Se,this.wpTableRelationColumns.updates$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{Pe.redrawTableAndTimeline()})}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",me.a)],st.prototype,"wpTableRelationColumns",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],st.prototype,"querySpace",void 0);class ut{constructor(Se,Pe){this.injector=Se,this.table=Pe,this.querySpace.initialized.values$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{let We;We=this.wpTableSortBy.isManualSortingMode?this.wpTableOrder.orderedWorkPackages():this.querySpace.results.value.elements,Pe.initialSetup(We)}),this.states.workPackages.observeChange().pipe((0,u.R)(this.querySpace.stopAllSubscriptions.asObservable()),(0,Ue.h)(()=>{const We=this.querySpace.tableRendered.getValueOr([]);return We&&We.length>0})).subscribe(([We,et])=>{void 0!==et&&this.table.refreshRows(et)})}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],ut.prototype,"querySpace",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",C.q)],ut.prototype,"wpTableSortBy",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",x.M)],ut.prototype,"wpTableOrder",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",m.G)],ut.prototype,"states",void 0);var It=t(7101);class Zt{constructor(Se,Pe){this.injector=Se,this.table=Pe,this.querySpace.tableRendered.values$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions)).subscribe(()=>{this.wpTableFocus.ifShouldFocus(We=>{const et=(0,M.Fb)(We);et.length&&((0,M.Ui)(We),this.FocusHelper.focusElement(et,!0))})}),this.wpTableSelection.live$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions)).subscribe(We=>{this.renderSelectionState(We)}),this.wpTableSelection.registerSelectAllListener(()=>Pe.renderedRows),this.wpTableSelection.registerDeselectAllListener()}renderSelectionState(Se){const Pe=jQuery(this.table.tableAndTimelineContainer);Pe.find(`.${E.S}.${re.HZ}`).removeClass(re.HZ),_.each(Se.selected,(We,et)=>{Pe.find(`.${E.S}[data-work-package-id="${et}"]`).toggleClass(re.HZ,We)})}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",Ie.J)],Zt.prototype,"wpTableSelection",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",L.o)],Zt.prototype,"wpTableFocus",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],Zt.prototype,"querySpace",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",It.i)],Zt.prototype,"FocusHelper",void 0);var Ut=t(73165);class jt{constructor(Se,Pe){this.injector=Se,this.table=Pe,this.wpTableTimeline.live$().pipe((0,u.R)(this.querySpace.stopAllSubscriptions)).subscribe(We=>{this.renderVisibility(We.visible)})}renderVisibility(Se){const Pe=jQuery(this.table.tableAndTimelineContainer).parent();Pe.find(".work-packages-tabletimeline--timeline-side").toggle(Se),Pe.find(".work-packages-tabletimeline--table-side").toggleClass("-timeline-visible",Se)}}(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",n.q)],jt.prototype,"querySpace",void 0),(0,c.gn)([(0,a.W)(),(0,c.w6)("design:type",Ut.W)],jt.prototype,"wpTableTimeline",void 0);class Dt extends A.A{constructor(){super(...arguments),this.eventHandlers=[()=>new Re(this.injector),()=>new se(this.injector),()=>new $e(this.injector),()=>new Oe(this.injector),()=>new rt(this.injector),()=>new be(this.injector),()=>new ie(this.injector),()=>new ot(this.injector),()=>new Ve(this.injector),()=>new he(this.injector)],this.stateTransformers=[Zt,ut,mt,I,jt,Ee,st,p,O]}attachTo(Se){this.stateTransformers.map(Pe=>new Pe(this.injector,Se.workPackageTable)),super.attachTo(Se)}}var bt=t(61486),Lt=t(43682),Wt=t(61083),Rt=t(9822);const xt="row-hovered";class Mt{constructor(Se){this.tableAndTimeline=Se,this.lastHoveredElement=null,this.eventListener=Pe=>{const We=Pe.target;We&&We!==this.lastHoveredElement&&this.handleHover(We),this.lastHoveredElement=We}}activate(){window.addEventListener("mousemove",this.eventListener,{passive:!0})}deactivate(){window.removeEventListener("mousemove",this.eventListener),this.removeAllHoverClasses()}locateHoveredTableRow(Se){const Pe=Se.closest("tr");return 0===Pe.length?null:Pe[0]}locateHoveredTimelineRow(Se){const Pe=Se.closest("div.wp-timeline-cell");return 0===Pe.length?null:Pe[0]}handleHover(Se){const Pe=jQuery(Se),We=this.locateHoveredTableRow(Pe),et=this.locateHoveredTimelineRow(Pe);null!==We||null!==et?this.removeOldAndAddNewHoverClass(We,et):this.removeAllHoverClasses()}extractWorkPackageId(Se){return parseInt(Se.getAttribute("data-work-package-id"))}removeOldAndAddNewHoverClass(Se,Pe){const We=null!==Se?Se:Pe,et=this.extractWorkPackageId(We),lt=this.tableAndTimeline.find(`tr.wp-row-${et}`).first(),ft=this.tableAndTimeline.find(`div.wp-row-${et}`).length?this.tableAndTimeline.find(`div.wp-row-${et}`).first():this.tableAndTimeline.find(`div.wp-ancestor-row-${et}`).first();requestAnimationFrame(()=>{this.removeAllHoverClasses(),ft.addClass(xt),lt.addClass(xt)})}removeAllHoverClasses(){this.tableAndTimeline.find(`.${xt}`).removeClass(xt)}}var wt=t(55054),Jt=t(26942),Ze=t(82271),ve=t(45338);function ne(nt,Se){1&nt&&i._UZ(0,"col")}function K(nt,Se){1&nt&&i._UZ(0,"col",19)}function de(nt,Se){1&nt&&i._UZ(0,"col",19)}function He(nt,Se){1&nt&&i._UZ(0,"col")}function ht(nt,Se){1&nt&&i._UZ(0,"op-icon",23)}function yt(nt,Se){if(1&nt&&(i.TgZ(0,"th",20),i.TgZ(1,"div",21),i.YNc(2,ht,1,0,"op-icon",22),i.qZA(),i.qZA()),2&nt){const Pe=i.oxw(2);i.xp6(2),i.Q6J("ngIf",Pe.manualSortEnabled)}}const St=function(nt){return{"-max":nt}};function Et(nt,Se){if(1&nt&&(i.TgZ(0,"th",24),i._UZ(1,"sortHeader",25),i.qZA()),2&nt){const Pe=Se.$implicit,We=i.oxw(2);i.Q6J("ngClass",i.VKq(6,St,"subject"===Pe.id)),i.xp6(1),i.Q6J("headerColumn",Pe)("locale",Pe.custom_field&&Pe.custom_field.name_locale||We.locale)("table",We.workPackageTable)("opColumnsContextMenu-column",Pe)("opColumnsContextMenu-table",We.workPackageTable)}}function je(nt,Se){1&nt&&(i.TgZ(0,"div",28),i._UZ(1,"wp-table-config-menu"),i.qZA())}function le(nt,Se){if(1&nt&&(i.TgZ(0,"th",26),i.YNc(1,je,2,0,"div",27),i.qZA()),2&nt){const Pe=i.oxw(2);i.xp6(1),i.Q6J("ngIf",Pe.configuration.columnMenuEnabled)}}function B(nt,Se){if(1&nt&&(i.TgZ(0,"tbody",29),i.TgZ(1,"tr",30),i.TgZ(2,"td"),i.TgZ(3,"span"),i._UZ(4,"op-icon",31),i.TgZ(5,"span"),i.TgZ(6,"strong"),i._uU(7),i.qZA(),i._uU(8),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.qZA()),2&nt){const Pe=i.oxw(2);i.xp6(2),i.uIk("colspan",Pe.columns.length+2),i.xp6(5),i.Oqu(Pe.text.noResults.title),i.xp6(1),i.hij(" ",Pe.text.noResults.description," ")}}function pe(nt,Se){if(1&nt){const Pe=i.EpF();i.TgZ(0,"tbody",32),i.NdJ("wp-inline-create--showing",function(et){i.CHM(Pe);return i.oxw(2).inlineCreateVisible=et}),i.qZA()}if(2&nt){const Pe=i.oxw(2);i.Q6J("wp-inline-create--table",Pe.workPackageTable)("wp-inline-create--project-identifier",Pe.projectIdentifier)}}function De(nt,Se){1&nt&&(i.TgZ(0,"div",33),i._UZ(1,"wp-resizer",34),i.qZA()),2&nt&&(i.xp6(1),i.Q6J("elementClass","work-packages-tabletimeline--timeline-side")("resizeEvent","wp-resize.timeline")("localStorageKey","openProject-timelineFlexBasis"))}const qe=function(){return[]},ct=function(nt,Se){return{"-single-margin":nt,"-double-margin":Se}};function Tt(nt,Se){if(1&nt&&(i.TgZ(0,"div",1),i.TgZ(1,"div",2),i.TgZ(2,"table",3),i.TgZ(3,"colgroup"),i.YNc(4,ne,1,0,"col",4),i.YNc(5,K,1,0,"col",5),i.YNc(6,de,1,0,"col",6),i.YNc(7,He,1,0,"col",4),i.qZA(),i.TgZ(8,"caption",7),i.TgZ(9,"span"),i._uU(10),i.qZA(),i._UZ(11,"span",8),i.TgZ(12,"span"),i._uU(13),i.qZA(),i.qZA(),i.TgZ(14,"thead",9),i.TgZ(15,"tr"),i.YNc(16,yt,3,1,"th",10),i.YNc(17,Et,2,8,"th",11),i.YNc(18,le,2,1,"th",12),i.qZA(),i.qZA(),i.YNc(19,B,9,3,"tbody",13),i._UZ(20,"tbody",14),i.TgZ(21,"tbody"),i._UZ(22,"tr",15),i.qZA(),i.YNc(23,pe,1,2,"tbody",16),i.qZA(),i.qZA(),i.YNc(24,De,2,3,"div",17),i.TgZ(25,"div",18),i._UZ(26,"wp-timeline-container"),i.qZA(),i.qZA()),2&nt){const Pe=i.oxw();i.xp6(4),i.Q6J("ngIf",Pe.configuration.dragAndDropEnabled),i.xp6(1),i.Q6J("ngForOf",i.DdM(15,qe).constructor(Pe.columns.length)),i.xp6(1),i.Q6J("ngIf",Pe.configuration.columnMenuEnabled),i.xp6(1),i.Q6J("ngIf",!Pe.configuration.columnMenuEnabled),i.xp6(3),i.Oqu(Pe.text.tableSummary),i.xp6(3),i.Oqu(Pe.text.tableSummaryHints),i.xp6(3),i.Q6J("ngIf",Pe.configuration.dragAndDropEnabled),i.xp6(1),i.Q6J("ngForOf",Pe.columns)("ngForTrackBy",Pe.trackByHref),i.xp6(1),i.Q6J("ngIf",Pe.configuration.columnMenuEnabled||Pe.configuration.actionsColumnEnabled),i.xp6(1),i.Q6J("ngIf",!Pe.isEmbedded&&Pe.query&&0===Pe.results.count),i.xp6(3),i.Q6J("wpTableSumsRow-table",Pe.workPackageTable),i.xp6(1),i.Q6J("ngIf",Pe.tableElement&&Pe.configuration.inlineCreateEnabled),i.xp6(1),i.Q6J("ngIf",!Pe.configuration.isEmbedded),i.xp6(1),i.Q6J("ngClass",i.WLB(16,ct,(Pe.sumVisible||Pe.inlineCreateVisible)&&!(Pe.sumVisible&&Pe.inlineCreateVisible),Pe.sumVisible&&Pe.inlineCreateVisible))}}class Pt extends Jt.N{constructor(Se,Pe,We,et,lt,ft,kt,Ft,qt,Xt,Ht,ei){super(),this.elementRef=Se,this.injector=Pe,this.states=We,this.querySpace=et,this.I18n=lt,this.cdRef=ft,this.zone=kt,this.wpTableGroupBy=Ft,this.wpTableTimeline=qt,this.wpTableColumns=Xt,this.wpTableSortBy=Ht,this.wpTableSums=ei,this.selectionChanged=new i.vpe,this.itemClicked=new i.vpe,this.stateLinkClicked=new i.vpe,this.trackByHref=Lt.u9,this.limitedResults=!1,this.inlineCreateVisible=!1,this.sumVisible=!1}ngOnInit(){this.configuration=new ve.O(this.configurationObject),this.$element=jQuery(this.elementRef.nativeElement),this.querySpace.stopAllSubscriptions.next(),this.locale=I18n.locale,this.text={cancel:I18n.t("js.button_cancel"),noResults:{title:I18n.t("js.work_packages.no_results.title"),description:I18n.t("js.work_packages.no_results.description")},limitedResults:(Pe,We)=>I18n.t("js.work_packages.limited_results",{count:Pe,total:We}),tableSummary:I18n.t("js.work_packages.table.summary"),tableSummaryHints:[I18n.t("js.work_packages.table.text_inline_edit"),I18n.t("js.work_packages.table.text_select_hint"),I18n.t("js.work_packages.table.text_sort_hint")].join(" ")},(0,bt.aj)([this.querySpace.results.values$(),this.wpTableGroupBy.live$(),this.wpTableColumns.live$(),this.wpTableTimeline.live$(),this.wpTableSortBy.live$(),this.wpTableSums.live$()]).pipe(this.untilDestroyed()).subscribe(([Pe,We,et,lt,ft,kt])=>{this.query=this.querySpace.query.value,this.results=Pe,this.sumVisible=kt,this.groupBy=We,this.columns=et,this.numTableColumns=this.columns.length+2,this.scrollSyncUpdate&&this.timelineVisible!==lt.visible&&this.scrollSyncUpdate(lt.visible),this.timelineVisible=lt.visible,this.manualSortEnabled=this.wpTableSortBy.isManualSortingMode,this.limitedResults=this.manualSortEnabled&&Pe.total>Pe.count,this.cdRef.detectChanges()}),this.cdRef.detectChanges()}ngOnDestroy(){super.ngOnDestroy(),this.wpTableHoverSync.deactivate()}registerTimeline(Se,Pe){const We=this.$element.find(".work-package--results-tbody"),et=this.$element.find(".work-package-table--container")[0];this.workPackageTable=new wt.t(this.injector,this.$element[0],et,We[0],Pe,Se,this.configuration),this.tbody=We,Se.workPackageTable=this.workPackageTable,new Dt(this.injector).attachTo(this);const lt=this.getTableAndTimelineElement();this.tableElement=lt[0],this.timeline=lt[1],this.wpTableHoverSync=new Mt(this.$element),this.wpTableHoverSync.activate(),this.scrollSyncUpdate=(0,Rt.e9)(this.$element),this.scrollSyncUpdate(this.timelineVisible),this.cdRef.detectChanges()}get isEmbedded(){return this.configuration.isEmbedded}getTableAndTimelineElement(){const Se=this.$element.find(".work-packages-tabletimeline--table-side"),Pe=this.$element.find(".work-packages-tabletimeline--timeline-side");if(0===Pe.length||0===Se.length)throw new Error("invalid state");return[Se[0],Pe[0]]}}Pt.\u0275fac=function(Se){return new(Se||Pt)(i.Y36(i.SBq),i.Y36(i.zs3),i.Y36(m.G),i.Y36(n.q),i.Y36(e.D),i.Y36(i.sBO),i.Y36(i.R0b),i.Y36(Wt.w),i.Y36(Ut.W),i.Y36(pt.i),i.Y36(C.q),i.Y36(Ze.X))},Pt.\u0275cmp=i.Xpm({type:Pt,selectors:[["wp-table"]],inputs:{projectIdentifier:"projectIdentifier",configurationObject:["configuration","configurationObject"]},outputs:{selectionChanged:"selectionChanged",itemClicked:"itemClicked",stateLinkClicked:"stateLinkClicked"},features:[i.qOj],decls:1,vars:1,consts:[["class","work-packages-split-view--tabletimeline-content",4,"ngIf"],[1,"work-packages-split-view--tabletimeline-content"],[1,"work-packages-tabletimeline--table-side","work-package-table--container","__hidden_overflow_container"],[1,"keyboard-accessible-list","generic-table","work-package-table"],[4,"ngIf"],["opHighlightCol","",4,"ngFor","ngForOf"],["opHighlightCol","",4,"ngIf"],[1,"hidden-for-sighted"],["id","wp-table-sort-summary"],[1,"-sticky"],["class","wp-table--manual-sort-th -short hide-when-print",4,"ngIf"],["class","wp-table--table-header",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","wp-table--configuration-modal--trigger wp-table--context-menu-th -short hide-when-print",4,"ngIf"],["class","work-package--empty-tbody",4,"ngIf"],[1,"results-tbody","work-package--results-tbody"],["wpTableSumsRow","",1,"wp-table--sums-row","wp-table--row",3,"wpTableSumsRow-table"],["wpInlineCreate","",3,"wp-inline-create--table","wp-inline-create--project-identifier","wp-inline-create--showing",4,"ngIf"],["class","work-packages--tabletimeline--timeline--resizer hidden-for-mobile hide-when-print",4,"ngIf"],[1,"work-packages-tabletimeline--timeline-side",3,"ngClass"],["opHighlightCol",""],[1,"wp-table--manual-sort-th","-short","hide-when-print"],[1,"generic-table--empty-header"],["icon-classes","icon-sort-by",4,"ngIf"],["icon-classes","icon-sort-by"],[1,"wp-table--table-header",3,"ngClass"],["opColumnsContextMenu","",3,"headerColumn","locale","table","opColumnsContextMenu-column","opColumnsContextMenu-table"],[1,"wp-table--configuration-modal--trigger","wp-table--context-menu-th","-short","hide-when-print"],["class","generic-table--sort-header-outer",4,"ngIf"],[1,"generic-table--sort-header-outer"],[1,"work-package--empty-tbody"],["id","empty-row-notification"],["icon-classes","icon-info1 icon-context"],["wpInlineCreate","",3,"wp-inline-create--table","wp-inline-create--project-identifier","wp-inline-create--showing"],[1,"work-packages--tabletimeline--timeline--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","resizeEvent","localStorageKey"]],template:function(Se,Pe){1&Se&&i.YNc(0,Tt,27,19,"div",0),2&Se&&i.Q6J("ngIf",Pe.query)},styles:[".wp-table--drag-and-drop-handle:hover{cursor:move}\n"],encapsulation:2,changeDetection:0})},38421:(H,D,t)=>{"use strict";t.d(D,{t:()=>d});var i=t(47775),e=t(96617),c=t(20979),u=t(33927),r=t(61024),n=t(2316),h=t(54364),a=t(32853);function p(g,C){if(1&g&&n._UZ(0,"ndc-dynamic",2),2&g){const y=n.oxw().ngIf;n.Q6J("ndcDynamicComponent",null==y||null==y.tab?null:y.tab.component)("ndcDynamicInputs",y)}}function l(g,C){if(1&g&&(n.ynx(0),n.YNc(1,p,1,2,"ndc-dynamic",1),n.BQk()),2&g){const y=C.ngIf;n.xp6(1),n.Q6J("ngIf",y.workPackage&&y.tab)}}class d{constructor(C,y,m,E){this.I18n=C,this.uiRouterGlobals=y,this.apiV3Service=m,this.wpTabsService=E}get workPackageId(){const{workPackageId:C}=this.uiRouterGlobals.params;return C}ngOnInit(){this.ndcDynamicInputs$=this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe((0,u.U)(C=>({workPackage:C,tab:this.findTab(C)})))}findTab(C){const{tabIdentifier:y}=this.uiRouterGlobals.params;return this.wpTabsService.getTab(y,C)}}d.\u0275fac=function(C){return new(C||d)(n.Y36(e.D),n.Y36(i.UIRouterGlobals),n.Y36(c.T),n.Y36(r.o))},d.\u0275cmp=n.Xpm({type:d,selectors:[["op-wp-tab"]],decls:2,vars:3,consts:[[4,"ngIf"],[3,"ndcDynamicComponent","ndcDynamicInputs",4,"ngIf"],[3,"ndcDynamicComponent","ndcDynamicInputs"]],template:function(C,y){1&C&&(n.YNc(0,l,2,1,"ng-container",0),n.ALo(1,"async")),2&C&&n.Q6J("ngIf",n.lcZ(1,1,y.ndcDynamicInputs$))},directives:[h.O5,a.B5,a.oc],pipes:[h.Ov],encapsulation:2})},70971:(H,D,t)=>{"use strict";t.d(D,{e:()=>d});var i=t(84109),e=t(47775),c=t(96617),u=t(61024),n=(t(24897),t(2316)),h=t(90590),a=t(54364),p=t(2775);function l(g,C){if(1&g){const y=n.EpF();n.ynx(0,2),n.TgZ(1,"li",3),n.TgZ(2,"button",4),n.NdJ("click",function(){return n.CHM(y),n.oxw().switchToFullscreen()}),n._UZ(3,"op-icon",5),n.qZA(),n.qZA(),n.TgZ(4,"li",3),n.TgZ(5,"button",6),n.NdJ("click",function(){return n.CHM(y),n.oxw().close()}),n._UZ(6,"op-icon",7),n.qZA(),n.qZA(),n.BQk()}if(2&g){const y=n.oxw();n.xp6(2),n.Q6J("title",y.text.details.goToFullScreen),n.xp6(3),n.Q6J("title",y.text.details.close)}}class d{constructor(C,y,m,E,P,w){this.wpTabsService=C,this.I18n=y,this.injector=m,this.$state=E,this.uiRouterGlobals=P,this.keepTab=w,this.canViewWatchers=!1,this.text={details:{close:this.I18n.t("js.button_close_details"),goToFullScreen:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")}}}ngOnInit(){this.uiSrefBase="split"===this.view?"":"work-packages.show",this.canViewWatchers=!(!this.workPackage||!this.workPackage.watchers),this.tabs=this.getDisplayableTabs()}getDisplayableTabs(){return this.wpTabsService.getDisplayableTabs(this.workPackage).map(C=>Object.assign(Object.assign({},C),{route:`${this.uiSrefBase}.tabs`,routeParams:{workPackageId:this.workPackage.id,tabIdentifier:C.id}}))}switchToFullscreen(){this.keepTab.goCurrentShowState()}close(){this.$state.go(this.uiRouterGlobals.current.data.baseRoute,this.uiRouterGlobals.params)}}d.\u0275fac=function(C){return new(C||d)(n.Y36(u.o),n.Y36(c.D),n.Y36(n.zs3),n.Y36(e.StateService),n.Y36(e.UIRouterGlobals),n.Y36(i.p))},d.\u0275cmp=n.Xpm({type:d,selectors:[["op-wp-tabs"]],inputs:{workPackage:"workPackage",view:"view"},decls:2,vars:2,consts:[[1,"op-work-package-tabs",3,"tabs"],["slot","actions",4,"ngIf"],["slot","actions"],[1,"tab-icon"],["type","button",1,"spot-link","work-packages--details-fullscreen-icon",3,"title","click"],["icon-classes","icon-context icon-no-color icon-to-fullscreen"],["type","button",1,"spot-link","work-packages--details-close-icon",3,"title","click"],["icon-classes","icon-context icon-no-color icon-close"]],template:function(C,y){1&C&&(n.TgZ(0,"op-scrollable-tabs",0),n.YNc(1,l,7,2,"ng-container",1),n.qZA()),2&C&&(n.Q6J("tabs",y.tabs),n.xp6(1),n.Q6J("ngIf","split"===y.view))},directives:[h.P,a.O5,p.o],styles:["[_nghost-%COMP%]{width:100%;max-width:100%;overflow:hidden}"],changeDetection:0})},61024:(H,D,t)=>{"use strict";t.d(D,{o:()=>we});var i=t(30400),e=t(47775),c=t(96617),u=t(26942),r=t(20979),n=t(2316),h=t(54364),p=(t(24897),t(90490)),l=t(22663),d=t(53466),g=t(38519),C=t(53457),y=t(70233),m=t(41945),E=t(97047),P=t(74012);class w extends u.N{constructor(z,V,Qe,Ke){super(),this.wpRelationsHierarchyService=z,this.apiV3Service=V,this.PathHelper=Qe,this.I18n=Ke,this.showEditForm=!1,this.text={parentHeadline:this.I18n.t("js.relations_hierarchy.parent_headline"),childrenHeadline:this.I18n.t("js.relations_hierarchy.children_headline")}}ngOnInit(){this.workPackagePath=this.PathHelper.workPackagePath(this.workPackage.id),this.canModifyHierarchy=!!this.workPackage.changeParent,this.canAddRelation=!!this.workPackage.addRelation,this.childrenQueryProps={filters:JSON.stringify([{parent:{operator:"=",values:[this.workPackage.id]}}]),"columns[]":["id","type","subject","status"],showHierarchies:!1},this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(z=>{var V,Qe;this.workPackage=z;const Ke=null===(Qe=null===(V=this.workPackage.parent)||void 0===V?void 0:V.id)||void 0===Qe?void 0:Qe.toString();Ke&&this.apiV3Service.work_packages.id(Ke).get().pipe((0,d.q)(1)).subscribe(Ct=>{this.workPackage.parent=Ct})})}}w.\u0275fac=function(z){return new(z||w)(n.Y36(m.O),n.Y36(r.T),n.Y36(y.j),n.Y36(c.D))},w.\u0275cmp=n.Xpm({type:w,selectors:[["wp-relations-hierarchy"]],inputs:{workPackage:"workPackage",relationType:"relationType"},features:[n.qOj],decls:6,vars:4,consts:[[1,"wp-relations-hierarchy-section","wp-relations--children"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],["wp-isolated-query-space",""],[3,"workPackage","addExistingChildEnabled","query"]],template:function(z,V){1&z&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"div",2),n._UZ(3,"h3",3),n.qZA(),n.qZA(),n.ynx(4,4),n._UZ(5,"wp-children-query",5),n.BQk(),n.qZA()),2&z&&(n.xp6(3),n.Q6J("textContent",V.text.childrenHeadline),n.xp6(2),n.Q6J("workPackage",V.workPackage)("addExistingChildEnabled",!0)("query",V.childrenQueryProps))},directives:[E.A,P.u],encapsulation:2});var x=t(1403),k=t(62964),b=t(69057),v=t(51017),M=t(2775),S=t(1707),O=t(84312),A=t(84906),F=t(61342),I=t(54262),J=t(82140);const N=["relationDescriptionTextarea"];function te(X,z){if(1&X&&n._UZ(0,"span",17),2&X){const V=n.oxw(3);n.Q6J("textContent",V.normalizedRelationType)}}function ee(X,z){if(1&X&&n._UZ(0,"span",17),2&X){const V=n.oxw(3);n.Q6J("textContent",V.relatedWorkPackage.type.name)}}function G(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"button",14),n.NdJ("click",function(){return n.CHM(V),n.oxw(2).activateRelationTypeEdit()}),n.YNc(1,te,1,1,"span",15),n.YNc(2,ee,1,1,"span",15),n._UZ(3,"span",16),n.qZA()}if(2&X){const V=n.oxw(2);n.xp6(1),n.Q6J("ngIf",V.groupByWorkPackageType),n.xp6(1),n.Q6J("ngIf",!V.groupByWorkPackageType),n.xp6(1),n.Q6J("textContent",V.text.updateRelation)}}function se(X,z){if(1&X&&n._UZ(0,"option",21),2&X){const V=z.$implicit;n.Q6J("textContent",V.label)("ngValue",V)}}function me(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div",18),n.TgZ(1,"select",19),n.NdJ("ngModelChange",function(Ke){n.CHM(V);return n.oxw(2).selectedRelationType=Ke})("change",function(){return n.CHM(V),n.oxw(2).saveRelationType()})("keydown.escape",function(Ke){return n.CHM(V),n.oxw(2).cancelRelationTypeEditOnEscape(Ke)}),n.YNc(2,se,1,2,"option",20),n.qZA(),n.qZA()}if(2&X){const V=n.oxw(2);n.xp6(1),n.Q6J("ngModel",V.selectedRelationType),n.xp6(1),n.Q6J("ngForOf",V.availableRelationTypes)}}const _e=function(X){return{workPackageId:X,tabIdentifier:"relations"}};function he(X,z){if(1&X&&(n.TgZ(0,"div",22),n._UZ(1,"a",23),n.qZA()),2&X){const V=n.oxw(2);n.xp6(1),n.Q6J("uiParams",n.VKq(3,_e,V.relatedWorkPackage.id))("textContent",V.relatedWorkPackage.subjectWithId()),n.uIk("aria-label",V.normalizedRelationType+" "+V.relatedWorkPackage.subjectWithId())}}function ae(X,z){if(1&X&&(n.TgZ(0,"edit-form",24),n._UZ(1,"editable-attribute-field",25),n.qZA()),2&X){const V=n.oxw(2);n.Q6J("resource",V.relatedWorkPackage),n.xp6(1),n.Q6J("resource",V.relatedWorkPackage)}}const re=function(X){return{"-visible":X}};function ye(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"button",26),n.NdJ("click",function(){return n.CHM(V),n.oxw(2).removeRelation()}),n._UZ(1,"op-icon",27),n.qZA()}if(2&X){const V=n.oxw(2);n.Q6J("ngClass",n.VKq(3,re,V.showDescriptionInfo))("title",V.text.removeButton),n.xp6(1),n.Q6J("icon-title",V.text.removeButton)}}function Ce(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"button",31),n.NdJ("click",function(){return n.CHM(V),n.oxw(3).startDescriptionEdit()}),n.qZA()}if(2&X){const V=n.oxw(3);n.ekj("-placeholder",!V.relation.description),n.Q6J("textContent",V.relation.description||V.text.placeholder.description)}}function ke(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div",32),n.TgZ(1,"textarea",33,34),n.NdJ("keyup",function(Ke){return n.CHM(V),n.oxw(3).handleDescriptionKey(Ke)})("ngModelChange",function(Ke){n.CHM(V);return n.oxw(3).userInputs.newRelationText=Ke}),n.qZA(),n.TgZ(3,"edit-field-controls",35),n.NdJ("onSave",function(){return n.CHM(V),n.oxw(3).saveDescription()})("onCancel",function(){return n.CHM(V),n.oxw(3).cancelDescriptionEdit()}),n.qZA(),n.qZA()}if(2&X){const V=n.oxw(3);n.xp6(1),n.Q6J("ngModel",V.userInputs.newRelationText),n.xp6(2),n.Q6J("fieldController",V.fieldController)("saveTitle",V.text.save)("cancelTitle",V.text.cancel)}}function Ae(X,z){if(1&X&&(n.TgZ(0,"div",28),n.YNc(1,Ce,1,3,"button",29),n.YNc(2,ke,4,4,"div",30),n.qZA()),2&X){const V=n.oxw(2);n.xp6(1),n.Q6J("ngIf",!V.userInputs.showDescriptionEditForm),n.xp6(1),n.Q6J("ngIf",V.userInputs.showDescriptionEditForm)}}function Fe(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div",1),n.TgZ(1,"div",2),n.TgZ(2,"div",3),n.YNc(3,G,4,3,"button",4),n.YNc(4,me,3,2,"div",5),n.qZA(),n.YNc(5,he,2,5,"div",6),n.TgZ(6,"div",7),n.YNc(7,ae,2,2,"edit-form",8),n.qZA(),n.TgZ(8,"div",9),n.TgZ(9,"button",10),n.NdJ("click",function(){n.CHM(V);const Ke=n.oxw();return Ke.userInputs.showRelationInfo=!Ke.userInputs.showRelationInfo}),n._UZ(10,"op-icon",11),n.qZA(),n.YNc(11,ye,2,5,"button",12),n.qZA(),n.qZA(),n.YNc(12,Ae,3,2,"div",13),n.qZA()}if(2&X){const V=n.oxw();n.Gre("relation-row relation-row-",V.relatedWorkPackage.id,""),n.xp6(3),n.Q6J("ngIf",!V.userInputs.showRelationTypesForm),n.xp6(1),n.Q6J("ngIf",V.userInputs.showRelationTypesForm),n.xp6(1),n.Q6J("ngIf",V.relatedWorkPackage),n.xp6(2),n.Q6J("ngIf",V.relatedWorkPackage),n.xp6(2),n.Q6J("ngClass",n.VKq(12,re,V.showDescriptionInfo))("title",V.text.description_label),n.xp6(1),n.Q6J("icon-title",V.text.toggleDescription),n.xp6(1),n.Q6J("ngIf",!!V.relation.delete),n.xp6(1),n.Q6J("ngIf",V.userInputs.showRelationInfo)}}class ot extends u.N{constructor(z,V,Qe,Ke,Ct,Nt,Kt){super(),this.apiV3Service=z,this.notificationService=V,this.wpRelations=Qe,this.halEvents=Ke,this.I18n=Ct,this.cdRef=Nt,this.PathHelper=Kt,this.showRelationInfo=!1,this.showEditForm=!1,this.userInputs={newRelationText:"",showDescriptionEditForm:!1,showRelationTypesForm:!1,showRelationInfo:!1},this.fieldController={handler:{active:!0},required:!1},this.text={cancel:this.I18n.t("js.button_cancel"),save:this.I18n.t("js.button_save"),removeButton:this.I18n.t("js.relation_buttons.remove"),description_label:this.I18n.t("js.relation_buttons.update_description"),toggleDescription:this.I18n.t("js.relation_buttons.toggle_description"),updateRelation:this.I18n.t("js.relation_buttons.update_relation"),placeholder:{description:this.I18n.t("js.placeholders.relation_description")}}}ngOnInit(){this.relation=this.relatedWorkPackage.relatedBy,this.userInputs.newRelationText=this.relation.description||"",this.availableRelationTypes=b.d.LOCALIZED_RELATION_TYPES(!1),this.selectedRelationType=_.find(this.availableRelationTypes,{name:this.relation.normalizedType(this.workPackage)}),this.apiV3Service.work_packages.id(this.relatedWorkPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(z=>{this.relatedWorkPackage=z})}get normalizedRelationType(){const z=this.relation.normalizedType(this.workPackage);return this.I18n.t(`js.relation_labels.${z}`)}get relationReady(){return this.relatedWorkPackage&&this.relatedWorkPackage.$loaded}startDescriptionEdit(){this.userInputs.showDescriptionEditForm=!0,setTimeout(()=>{const z=jQuery(this.relationDescriptionTextarea.nativeElement),V=z.val().length;z.focus(),z.prop("selectionStart",V),z.prop("selectionEnd",V)})}handleDescriptionKey(z){27===z.which&&this.cancelDescriptionEdit()}cancelDescriptionEdit(){this.userInputs.showDescriptionEditForm=!1,this.userInputs.newRelationText=this.relation.description||""}saveDescription(){this.wpRelations.updateRelation(this.relation,{description:this.userInputs.newRelationText}).then(z=>{this.relation=z,this.relatedWorkPackage.relatedBy=z,this.userInputs.showDescriptionEditForm=!1,this.notificationService.showSave(this.relatedWorkPackage),this.cdRef.detectChanges()})}get showDescriptionInfo(){return this.userInputs.showRelationInfo||this.relation.description}activateRelationTypeEdit(){this.groupByWorkPackageType&&(this.userInputs.showRelationTypesForm=!0)}cancelRelationTypeEditOnEscape(z){this.userInputs.showRelationTypesForm=!1}saveRelationType(){this.wpRelations.updateRelationType(this.workPackage,this.relatedWorkPackage,this.relation,this.selectedRelationType.name).then(z=>{this.notificationService.showSave(this.relatedWorkPackage),this.relatedWorkPackage.relatedBy=z,this.relation=z,this.userInputs.showRelationTypesForm=!1,this.cdRef.detectChanges()}).catch(z=>this.notificationService.handleRawError(z,this.workPackage))}toggleUserDescriptionForm(){this.userInputs.showDescriptionEditForm=!this.userInputs.showDescriptionEditForm}removeRelation(){this.wpRelations.removeRelation(this.relation).then(()=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:null,relationType:this.relation.normalizedType(this.workPackage)}),this.apiV3Service.work_packages.cache.updateWorkPackage(this.relatedWorkPackage),this.notificationService.showSave(this.relatedWorkPackage)}).catch(z=>this.notificationService.handleRawError(z,this.relatedWorkPackage))}}ot.\u0275fac=function(z){return new(z||ot)(n.Y36(r.T),n.Y36(k.q),n.Y36(C.V),n.Y36(x.J),n.Y36(c.D),n.Y36(n.sBO),n.Y36(y.j))},ot.\u0275cmp=n.Xpm({type:ot,selectors:[["wp-relation-row"]],viewQuery:function(z,V){if(1&z&&n.Gf(N,5),2&z){let Qe;n.iGM(Qe=n.CRH())&&(V.relationDescriptionTextarea=Qe.first)}},inputs:{workPackage:"workPackage",relatedWorkPackage:"relatedWorkPackage",groupByWorkPackageType:"groupByWorkPackageType"},features:[n.qOj],decls:1,vars:1,consts:[["opFocusWithin",".wp-relations-controls-section button",3,"class",4,"ngIf"],["opFocusWithin",".wp-relations-controls-section button"],[1,"grid-block","hierarchy-item"],[1,"grid-content","medium-2","collapse"],["type","button","class","relation-row--type",3,"click",4,"ngIf"],["class","inline-edit--container inplace-edit",4,"ngIf"],["class","grid-content medium-5 collapse",4,"ngIf"],[1,"grid-content","medium-3","collapse","wp-relations-status-field"],[3,"resource",4,"ngIf"],["ng-class","{'-expanded': userInputs.showRelationInfo }",1,"grid-content","medium-2","collapse","wp-relations-controls-section"],["type","button",1,"spot-link","wp-relations--description-btn",3,"ngClass","title","click"],["icon-classes","icon-info1 icon-no-color -padded wp-relations--icon wp-relations--description-icon",3,"icon-title"],["type","button","class","spot-link relation-row--remove-btn",3,"ngClass","title","click",4,"ngIf"],["class","grid-block hierarchy-item description-container",4,"ngIf"],["type","button",1,"relation-row--type",3,"click"],[3,"textContent",4,"ngIf"],[1,"hidden-for-sighted",3,"textContent"],[3,"textContent"],[1,"inline-edit--container","inplace-edit"],["role","listbox","opAutofocus","",1,"inline-edit--field","form--select",3,"ngModel","ngModelChange","change","keydown.escape"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],[3,"textContent","ngValue"],[1,"grid-content","medium-5","collapse"],["uiSref","work-packages.show.tabs",1,"wp-relations--subject-field",3,"uiParams","textContent"],[3,"resource"],["fieldName","status",3,"resource"],["type","button",1,"spot-link","relation-row--remove-btn",3,"ngClass","title","click"],["icon-classes","icon-remove icon-no-color -padded wp-relations--icon",3,"icon-title"],[1,"grid-block","hierarchy-item","description-container"],["type","button","class","wp-relation--description-read-value",3,"-placeholder","textContent","click",4,"ngIf"],["class","wp-relation--description-wrapper textarea-wrapper",4,"ngIf"],["type","button",1,"wp-relation--description-read-value",3,"textContent","click"],[1,"wp-relation--description-wrapper","textarea-wrapper"],["autofocus","","name","description",1,"wp-relation--description-textarea",3,"ngModel","keyup","ngModelChange"],["relationDescriptionTextarea",""],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(z,V){1&z&&n.YNc(0,Fe,13,14,"div",0),2&z&&n.Q6J("ngIf",V.workPackage&&V.relatedWorkPackage)},directives:[h.O5,v.N,h.mk,M.o,S.EJ,O.U,S.JJ,S.On,h.sg,S.YN,S.Kr,A.AnchorUISref,A.UISref,F.n,I.k,S.Fj,J.e],encapsulation:2});const it=["wpRelationGroupByToggler"];function Ve(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div",6),n.TgZ(1,"button",7,8),n.NdJ("click",function(){return n.CHM(V),n.oxw().toggleButton()}),n._UZ(3,"span",9),n.qZA(),n.qZA()}if(2&X){const V=n.oxw();n.xp6(3),n.Q6J("textContent",V.togglerText)}}function Ie(X,z){if(1&X&&n._UZ(0,"wp-relation-row",12),2&X){const V=z.$implicit,Qe=n.oxw(2);n.Q6J("workPackage",Qe.workPackage)("groupByWorkPackageType",Qe.groupByWorkPackageType)("relatedWorkPackage",V)}}function ue(X,z){if(1&X&&(n.TgZ(0,"div",10),n.YNc(1,Ie,1,3,"wp-relation-row",11),n.qZA()),2&X){const V=n.oxw();n.xp6(1),n.Q6J("ngForOf",V.relatedWorkPackages)}}class ie{constructor(z){this.I18n=z,this.onToggleGroupBy=new n.vpe,this.text={groupByType:this.I18n.t("js.relation_buttons.group_by_wp_type"),groupByRelation:this.I18n.t("js.relation_buttons.group_by_relation_type")}}get togglerText(){return this.groupByWorkPackageType?this.text.groupByRelation:this.text.groupByType}toggleButton(){this.onToggleGroupBy.emit(),setTimeout(()=>{this.toggleElement.nativeElement.focus()},20)}}ie.\u0275fac=function(z){return new(z||ie)(n.Y36(c.D))},ie.\u0275cmp=n.Xpm({type:ie,selectors:[["wp-relations-group"]],viewQuery:function(z,V){if(1&z&&n.Gf(it,5),2&z){let Qe;n.iGM(Qe=n.CRH())&&(V.toggleElement=Qe.first)}},inputs:{relatedWorkPackages:"relatedWorkPackages",workPackage:"workPackage",header:"header",firstGroup:"firstGroup",groupByWorkPackageType:"groupByWorkPackageType"},outputs:{onToggleGroupBy:"onToggleGroupBy"},decls:6,vars:3,consts:[[1,"attributes-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text","relation-group--header",3,"textContent"],["class","attributes-group--header-toggle",4,"ngIf"],["class","content",4,"ngIf"],[1,"attributes-group--header-toggle"],["id","wp-relation-group-by-toggle","type","button",1,"button","-small","-transparent","-with-icon","icon-group-by","icon-small","hide-when-print",3,"click"],["wpRelationGroupByToggler",""],[3,"textContent"],[1,"content"],[3,"workPackage","groupByWorkPackageType","relatedWorkPackage",4,"ngFor","ngForOf"],[3,"workPackage","groupByWorkPackageType","relatedWorkPackage"]],template:function(z,V){1&z&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.TgZ(2,"div",2),n._UZ(3,"h3",3),n.qZA(),n.YNc(4,Ve,4,1,"div",4),n.qZA(),n.YNc(5,ue,2,1,"div",5),n.qZA()),2&z&&(n.xp6(3),n.Q6J("textContent",V.header),n.xp6(1),n.Q6J("ngIf",V.firstGroup),n.xp6(1),n.Q6J("ngIf",V.relatedWorkPackages))},directives:[h.O5,h.sg,ot],encapsulation:2});var R=t(11950);function L(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div",4),n.TgZ(1,"div",5),n.TgZ(2,"div",6),n.TgZ(3,"button",7),n.NdJ("click",function(){return n.CHM(V),n.oxw().toggleRelationsCreateForm()}),n._UZ(4,"span",8),n._UZ(5,"span",9),n.qZA(),n.qZA(),n.qZA(),n.qZA()}if(2&X){const V=n.oxw();n.xp6(5),n.Q6J("textContent",V.text.addNewRelation)}}function W(X,z){if(1&X&&n._UZ(0,"option",20),2&X){const V=z.$implicit;n.Q6J("textContent",V.label)("value",V.name)}}function oe(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div",10),n.TgZ(1,"div",11),n._UZ(2,"label",12),n.TgZ(3,"select",13),n.NdJ("ngModelChange",function(Ke){n.CHM(V);return n.oxw().selectedRelationType=Ke}),n.YNc(4,W,1,2,"option",14),n.qZA(),n.qZA(),n.TgZ(5,"div",15),n.TgZ(6,"wp-relations-autocomplete",16),n.NdJ("onSelected",function(Ke){return n.CHM(V),n.oxw().onSelected(Ke)})("onCancel",function(){return n.CHM(V),n.oxw().toggleRelationsCreateForm()}),n.qZA(),n.qZA(),n.TgZ(7,"div",17),n.TgZ(8,"button",18),n.NdJ("click",function(){return n.CHM(V),n.oxw().toggleRelationsCreateForm()}),n._UZ(9,"op-icon",19),n.qZA(),n.qZA(),n.qZA()}if(2&X){const V=n.oxw();n.xp6(2),n.Q6J("textContent",V.text.relationType),n.xp6(1),n.Q6J("ngModel",V.selectedRelationType),n.xp6(1),n.Q6J("ngForOf",V.relationTypes),n.xp6(2),n.Q6J("workPackage",V.workPackage)("hiddenOverflowContainer",".work-packages-tab-view--overflow")("selectedRelationType",V.selectedRelationType),n.xp6(3),n.Q6J("icon-title",V.text.abort)}}class Oe{constructor(z,V,Qe,Ke){this.I18n=z,this.wpRelations=V,this.notificationService=Qe,this.halEvents=Ke,this.showRelationsCreateForm=!1,this.selectedRelationType=b.d.DEFAULT(),this.relationTypes=b.d.LOCALIZED_RELATION_TYPES(!1),this.isDisabled=!1,this.text={abort:this.I18n.t("js.relation_buttons.abort"),relationType:this.I18n.t("js.relation_buttons.relation_type"),addNewRelation:this.I18n.t("js.relation_buttons.add_new_relation")}}createRelation(){!this.selectedRelationType||!this.selectedWpId||(this.isDisabled=!0,this.createCommonRelation().catch(()=>this.isDisabled=!1).then(()=>this.isDisabled=!1))}onSelected(z){z&&(this.selectedWpId=z.id,this.createCommonRelation())}createCommonRelation(){return this.wpRelations.addCommonRelation(this.workPackage.id,this.selectedRelationType,this.selectedWpId).then(z=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:z.id,relationType:this.selectedRelationType}),this.notificationService.showSave(this.workPackage),this.toggleRelationsCreateForm()}).catch(z=>{this.notificationService.handleRawError(z,this.workPackage),this.toggleRelationsCreateForm()})}toggleRelationsCreateForm(){this.showRelationsCreateForm=!this.showRelationsCreateForm,this.selectedWpId=""}}function $(X,z){if(1&X&&(n.TgZ(0,"div",5),n.TgZ(1,"div",6),n.TgZ(2,"div",7),n._UZ(3,"h3",8),n.qZA(),n.qZA(),n.qZA()),2&X){const V=n.oxw();n.xp6(3),n.Q6J("textContent",V.text.relations_header)}}function Xe(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div"),n.TgZ(1,"wp-relations-group",9),n.NdJ("onToggleGroupBy",function(){return n.CHM(V),n.oxw().toggleGroupBy()}),n.qZA(),n.qZA()}if(2&X){const V=z.$implicit,Qe=z.first,Ke=n.oxw();n.xp6(1),n.Q6J("header",V)("groupByWorkPackageType",Ke.groupByWorkPackageType)("firstGroup",Qe)("relatedWorkPackages",Ke.relationGroups[V])("workPackage",Ke.workPackage)}}function rt(X,z){if(1&X&&n._UZ(0,"wp-relations-create",4),2&X){const V=n.oxw();n.Q6J("workPackage",V.workPackage)}}Oe.\u0275fac=function(z){return new(z||Oe)(n.Y36(c.D),n.Y36(C.V),n.Y36(k.q),n.Y36(x.J))},Oe.\u0275cmp=n.Xpm({type:Oe,selectors:[["wp-relations-create"]],inputs:{workPackage:"workPackage"},decls:4,vars:2,consts:[[1,"wp-relations-create"],["class","wp-relations-create-button hide-when-print",4,"ngIf"],["data-indicator-name","relationAddDynamic",1,"loading-indicator--location"],["class","v-align wp-relations-create--form",4,"ngIf"],[1,"wp-relations-create-button","hide-when-print"],[1,"grid-block"],[1,"grid-content","collapse"],["type","button","opAutofocus","","id","relation--add-relation",1,"spot-link","wp-inline-create--add-link",3,"click"],[1,"spot-icon","spot-icon_add"],[3,"textContent"],[1,"v-align","wp-relations-create--form"],[1,"grid-content","collapse","medium-3"],["for","relation-type--select",1,"hidden-for-sighted",3,"textContent"],["id","relation-type--select","role","listbox","opAutoFocus","",1,"form--select","relationTypeSelect",3,"ngModel","ngModelChange"],[3,"textContent","value",4,"ngFor","ngForOf"],[1,"grid-content","medium-8"],[3,"workPackage","hiddenOverflowContainer","selectedRelationType","onSelected","onCancel"],[1,"grid-content","medium-1","collapse","wp-relations-controls-section","relation-row"],["type","button",1,"spot-link","wp-create-relation--cancel",3,"click"],["icon-classes","icon-remove icon-no-color -padded",3,"icon-title"],[3,"textContent","value"]],template:function(z,V){1&z&&(n.TgZ(0,"div",0),n.YNc(1,L,6,1,"div",1),n.TgZ(2,"div",2),n.YNc(3,oe,10,7,"div",3),n.qZA(),n.qZA()),2&z&&(n.xp6(1),n.Q6J("ngIf",!V.showRelationsCreateForm),n.xp6(2),n.Q6J("ngIf",V.showRelationsCreateForm))},directives:[h.O5,O.U,S.EJ,S.JJ,S.On,h.sg,R.t,M.o,S.YN,S.Kr],encapsulation:2});class ge extends u.N{constructor(z,V,Qe,Ke){super(),this.I18n=z,this.wpRelations=V,this.cdRef=Qe,this.apiV3Service=Ke,this.relationGroups={},this.relationGroupKeys=[],this.relationsPresent=!1,this.groupByWorkPackageType=!1,this.text={relations_header:this.I18n.t("js.work_packages.tabs.relations")},this.currentRelations=[]}ngOnInit(){this.canAddRelation=!!this.workPackage.addRelation,this.wpRelations.state(this.workPackage.id).values$().pipe((0,l.R)((0,g.J6)(this))).subscribe(z=>{this.loadedRelations(z)}),this.wpRelations.require(this.workPackage.id),this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe((0,l.R)((0,g.J6)(this))).subscribe(z=>{this.workPackage=z})}getRelatedWorkPackages(z){const V=z.map(Qe=>this.apiV3Service.work_packages.id(Qe).get());return(0,p.$R)(...V)}getRelatedWorkPackageId(z){const V=z.ids;return z.to.href===this.workPackage.href?V.from:V.to}toggleGroupBy(){this.groupByWorkPackageType=!this.groupByWorkPackageType,this.buildRelationGroups()}buildRelationGroups(){_.isNil(this.currentRelations)||(this.relationGroups=_.groupBy(this.currentRelations,z=>{if(this.groupByWorkPackageType)return z.type.name;const V=z.relatedBy.normalizedType(this.workPackage);return this.I18n.t(`js.relation_labels.${V}`)}),this.relationGroupKeys=_.keys(this.relationGroups),this.relationsPresent=_.size(this.relationGroups)>0,this.cdRef.detectChanges())}loadedRelations(z){const V=[],Qe=[];if(0===_.size(z))return this.currentRelations=[],this.buildRelationGroups();_.each(z,Ke=>{const Ct=this.getRelatedWorkPackageId(Ke);V.push(Ct),Qe[Ct]=Ke}),this.getRelatedWorkPackages(V).pipe((0,d.q)(1)).subscribe(Ke=>{this.currentRelations=Ke.map(Ct=>(Ct.relatedBy=Qe[Ct.id],Ct)),this.buildRelationGroups()})}}function be(X,z){if(1&X&&(n.TgZ(0,"div",1),n.TgZ(1,"div",2),n._UZ(2,"wp-relations",3),n.qZA(),n.qZA()),2&X){const V=n.oxw();n.xp6(2),n.Q6J("workPackage",V.workPackage)}}ge.\u0275fac=function(z){return new(z||ge)(n.Y36(c.D),n.Y36(C.V),n.Y36(n.sBO),n.Y36(r.T))},ge.\u0275cmp=n.Xpm({type:ge,selectors:[["wp-relations"]],inputs:{workPackage:"workPackage"},features:[n.qOj],decls:5,vars:4,consts:[["data-indicator-name","relation-groups",1,"loading-indicator--location"],["class","wp-relations-hierarchy-section",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"workPackage",4,"ngIf"],[3,"workPackage"],[1,"wp-relations-hierarchy-section"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"],[3,"header","groupByWorkPackageType","firstGroup","relatedWorkPackages","workPackage","onToggleGroupBy"]],template:function(z,V){1&z&&(n.TgZ(0,"div",0),n.YNc(1,$,4,1,"div",1),n.YNc(2,Xe,2,5,"div",2),n.YNc(3,rt,1,1,"wp-relations-create",3),n._UZ(4,"wp-relations-hierarchy",4),n.qZA()),2&z&&(n.xp6(1),n.Q6J("ngIf",!V.relationsPresent),n.xp6(1),n.Q6J("ngForOf",V.relationGroupKeys),n.xp6(1),n.Q6J("ngIf",V.canAddRelation),n.xp6(1),n.Q6J("workPackage",V.workPackage))},directives:[h.O5,h.sg,w,ie,Oe],encapsulation:2,changeDetection:0});class Me extends u.N{constructor(z,V,Qe){super(),this.I18n=z,this.$transition=V,this.apiV3Service=Qe}ngOnInit(){const z=this.workPackageId||this.$transition.params("to").workPackageId;this.apiV3Service.work_packages.id(z).requireAndStream().pipe(this.untilDestroyed()).subscribe(V=>{this.workPackageId=V.id,this.workPackage=V})}}Me.\u0275fac=function(z){return new(z||Me)(n.Y36(c.D),n.Y36(e.Transition),n.Y36(r.T))},Me.\u0275cmp=n.Xpm({type:Me,selectors:[["wp-relations-tab"]],inputs:{workPackageId:"workPackageId"},features:[n.qOj],decls:1,vars:1,consts:[["class","detail-panel-description detail-panel--relations detail-panel--autocomplete-target",4,"ngIf"],[1,"detail-panel-description","detail-panel--relations","detail-panel--autocomplete-target"],[1,"detail-panel-description-content"],[3,"workPackage"]],template:function(z,V){1&z&&n.YNc(0,be,3,1,"div",0),2&z&&n.Q6J("ngIf",V.workPackage)},directives:[h.O5,ge],encapsulation:2});var Re=t(77180),$e=t(83720),pt=t(33927),mt=t(23896),vt=t(54892),Ue=t(50937);class Le extends u.N{constructor(z,V,Qe,Ke,Ct,Nt,Kt){super(),this.apiV3Service=z,this.I18n=V,this.cdRef=Qe,this.uiRouterGlobals=Ke,this.wpActivity=Ct,this.storeService=Nt,this.wpSingleViewService=Kt,this.unfilteredActivities=[],this.visibleActivities=[],this.onlyComments=!1,this.text={commentsOnly:this.I18n.t("js.label_activity_show_only_comments"),showAll:this.I18n.t("js.label_activity_show_all")},this.additionalScrollMargin=200,this.initialized=!1,this.reverse=Ct.isReversed,this.togglerText=this.text.commentsOnly}ngOnInit(){this.initialized=!1,this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(z=>{this.workPackage=z,this.reloadActivities()}),this.wpSingleViewService.query.selectNotificationsCount$.pipe(this.untilDestroyed(),(0,$e.x)()).subscribe(()=>{this.reloadActivities()})}scrollIfNotificationPresent(){this.storeService.query.hasNotifications$.pipe((0,mt.take)(1)).subscribe(z=>{z&&this.scrollToUnreadNotification()})}reloadActivities(){this.wpActivity.require(this.workPackage,!0).then(z=>{this.updateActivities(z),this.cdRef.detectChanges(),this.initialized||(this.initialized=!0,this.scrollIfNotificationPresent())})}updateActivities(z){this.unfilteredActivities=z;const V=this.getVisibleActivities();this.visibleActivities=V.map((Qe,Ke)=>this.info(Qe,Ke)),this.showToggler=this.shouldShowToggler()}shouldShowToggler(){const z=this.unfilteredActivities.length,V=this.getActivitiesWithComments().length;return z>1&&V>0&&V<this.unfilteredActivities.length}getVisibleActivities(){return this.onlyComments?this.getActivitiesWithComments():this.unfilteredActivities}getActivitiesWithComments(){return this.unfilteredActivities.filter(z=>!!_.get(z,"comment.html"))}hasUnreadNotification(z){return this.storeService.query.selectNotifications$.pipe((0,pt.U)(V=>!!V.find(Qe=>{var Ke;return(null===(Ke=Qe._links.activity)||void 0===Ke?void 0:Ke.href)===z})))}scrollToUnreadNotification(){const z=document.querySelectorAll("[data-notification-selector='notification-activity']");if(window.location.href.indexOf("activity#")>-1||0===z.length)return;const V=z[this.reverse?z.length-1:0],Qe=document.querySelectorAll("[data-notification-selector='notification-scroll-container']")[0],Ke=V.offsetTop-Qe.offsetTop-this.additionalScrollMargin;Qe.scrollTop=Ke}toggleComments(){this.onlyComments=!this.onlyComments,this.updateActivities(this.unfilteredActivities),this.onlyComments?this.togglerText=this.text.showAll:this.togglerText=this.text.commentsOnly}info(z,V){return this.wpActivity.info(this.unfilteredActivities,z,V)}}Le.\u0275fac=function(z){return new(z||Le)(n.Y36(r.T),n.Y36(c.D),n.Y36(n.sBO),n.Y36(e.UIRouterGlobals),n.Y36(vt.a),n.Y36(Ue.O),n.Y36(Ue.O))},Le.\u0275dir=n.lG2({type:Le,features:[n.qOj]});var Ee=t(43682),st=t(3786),ut=t(86469),It=t(12877),Zt=t(36293),Ut=t(86029),jt=t(79441),Dt=t(55749);class bt extends Ut.k{constructor(z,V){super(),this.elementRef=z,this.injector=V,this.fieldName="comment",this.handler=this,this.active=!1,this.inEditMode=!1,this.inFlight=!1,this.onDestroy=new jt.xQ}ngOnInit(){this.change=new Dt.G(this.workPackage)}reset(z=""){z.length>0&&(z+="\n"),this.change.setValue("comment",{raw:z})}get schema(){return{name:I18n.t("js.label_comment"),writable:!0,required:!1,type:"_comment",hasDefault:!1}}get rawComment(){return _.get(this.commentValue,"raw","")}get commentValue(){return this.change.value("comment")}handleUserCancel(){this.deactivate(!0)}activate(z){this.active=!0,this.reset(z)}deactivate(z){this.active=!1,this.onDestroy.next(),this.onDestroy.complete()}focus(){const z=this.elementRef.nativeElement.querySelector(".inplace-editing--trigger-container");z&&z.focus()}onFocusOut(){}handleUserKeydown(z,V){}isChanged(){return!1}stopPropagation(z){return!1}}bt.\u0275fac=function(z){return new(z||bt)(n.Y36(n.SBq),n.Y36(n.zs3))},bt.\u0275dir=n.lG2({type:bt,features:[n.qOj]});var Lt=t(82267),Wt=t(8849),Rt=t(92058);const xt=["commentContainer"];function Mt(X,z){if(1&X&&n.GkF(0,4),2&X){const V=n.oxw();n.Q6J("ngTemplateOutlet",V.template)}}function wt(X,z){if(1&X&&n._UZ(0,"edit-form-portal",10),2&X){const V=n.oxw(2);n.Q6J("schemaInput",V.schema)("changeInput",V.change)("editFieldHandler",V.handler)}}function Jt(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div",11),n.NdJ("dragover",function(Ke){return n.CHM(V),n.oxw(2).startDragOverActivation(Ke)})("dragenter",function(Ke){return n.CHM(V),n.oxw(2).startDragOverActivation(Ke)}),n.TgZ(1,"button",12),n.NdJ("click",function(){return n.CHM(V),n.oxw(2).activate()}),n._UZ(2,"span",13),n._UZ(3,"op-icon",14),n.qZA(),n.qZA()}if(2&X){const V=n.oxw(2);n.xp6(1),n.Q6J("title",V.text.editTitle),n.xp6(1),n.Q6J("textContent",V.text.placeholder),n.xp6(1),n.Q6J("icon-title",V.text.editTitle)}}function Ze(X,z){if(1&X&&(n.TgZ(0,"div",5,6),n.TgZ(2,"div",7),n.YNc(3,wt,1,3,"edit-form-portal",8),n.YNc(4,Jt,4,3,"div",9),n.qZA(),n.qZA()),2&X){const V=n.oxw();n.xp6(3),n.Q6J("ngIf",V.active),n.xp6(1),n.Q6J("ngIf",!V.active)}}function ve(X,z){if(1&X&&n.GkF(0,4),2&X){const V=n.oxw();n.Q6J("ngTemplateOutlet",V.template)}}class ne extends bt{constructor(z,V,Qe,Ke,Ct,Nt,Kt,Li,dn,bi,wi){super(z,V),this.elementRef=z,this.injector=V,this.commentService=Qe,this.wpLinkedActivities=Ke,this.ConfigurationService=Ct,this.loadingIndicator=Nt,this.apiV3Service=Kt,this.workPackageNotificationService=Li,this.toastService=dn,this.cdRef=bi,this.I18n=wi,this.text={editTitle:this.I18n.t("js.label_add_comment_title"),addComment:this.I18n.t("js.label_add_comment"),cancelTitle:this.I18n.t("js.label_cancel_comment"),placeholder:this.I18n.t("js.label_add_comment_title")},this.fieldLabel=this.text.editTitle,this.inFlight=!1,this.htmlId="wp-comment-field"}ngOnInit(){super.ngOnInit(),this.canAddComment=!!this.workPackage.addComment,this.showAbove=this.ConfigurationService.commentsSortedInDescendingOrder(),this.commentService.quoteEvents.pipe(this.untilDestroyed()).subscribe(z=>{this.activate(z),this.commentContainer.nativeElement.scrollIntoView()})}startDragOverActivation(z){return!!this.active||(this.activate(),z.preventDefault(),!1)}activate(z){super.activate(z),this.showAbove||this.scrollToBottom(),this.cdRef.detectChanges()}deactivate(z){z&&this.focus(),this.active=!1,this.cdRef.detectChanges()}handleUserSubmit(){return(0,st.mG)(this,void 0,void 0,function*(){if(this.inFlight||!this.rawComment)return Promise.resolve();this.inFlight=!0,yield this.onSubmit();const z=this.loadingIndicator.wpDetails;return z.promise=this.commentService.createComment(this.workPackage,this.commentValue).then(()=>{this.active=!1,this.toastService.addSuccess(this.I18n.t("js.work_packages.comment_added")),this.wpLinkedActivities.require(this.workPackage,!0),this.apiV3Service.work_packages.id(this.workPackage.id).refresh(),this.inFlight=!1,this.deactivate(!0)}).catch(V=>{this.inFlight=!1,V instanceof Wt.o?this.workPackageNotificationService.showError(V.resource,this.workPackage):this.toastService.addError(this.I18n.t("js.work_packages.comment_send_failed"))}),z.promise})}scrollToBottom(){const z=jQuery(this.elementRef.nativeElement).scrollParent()[0];z&&setTimeout(()=>{z.scrollTop=z.scrollHeight},400)}setErrors(z){}}ne.\u0275fac=function(z){return new(z||ne)(n.Y36(n.SBq),n.Y36(n.zs3),n.Y36(Lt.O),n.Y36(vt.a),n.Y36(It.e),n.Y36(ut.vt),n.Y36(r.T),n.Y36(k.q),n.Y36(Zt.kl),n.Y36(n.sBO),n.Y36(c.D))},ne.\u0275cmp=n.Xpm({type:ne,selectors:[["work-package-comment"]],contentQueries:function(z,V,Qe){if(1&z&&n.Suo(Qe,n.Rgc,5),2&z){let Ke;n.iGM(Ke=n.CRH())&&(V.template=Ke.first)}},viewQuery:function(z,V){if(1&z&&n.Gf(xt,5),2&z){let Qe;n.iGM(Qe=n.CRH())&&(V.commentContainer=Qe.first)}},inputs:{workPackage:"workPackage"},features:[n.qOj],decls:5,vars:3,consts:[["id","work-package-activites-container"],["id","work-package-comment-container"],[3,"ngTemplateOutlet",4,"ngIf"],["class","work-package--details--long-field work-packages--activity--add-comment hide-when-print",4,"ngIf"],[3,"ngTemplateOutlet"],[1,"work-package--details--long-field","work-packages--activity--add-comment","hide-when-print"],["commentContainer",""],[1,"inline-edit--container","inplace-edit"],[3,"schemaInput","changeInput","editFieldHandler",4,"ngIf"],[3,"dragover","dragenter",4,"ngIf"],[3,"schemaInput","changeInput","editFieldHandler"],[3,"dragover","dragenter"],[1,"work-package-comment","inline-edit--display-field",3,"title","click"],[1,"work-package-comment--text",3,"textContent"],["icon-classes","icon-edit",1,"work-package-comment--icon",3,"icon-title"]],template:function(z,V){1&z&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.YNc(2,Mt,1,1,"ng-container",2),n.YNc(3,Ze,5,2,"div",3),n.YNc(4,ve,1,1,"ng-container",2),n.qZA(),n.qZA()),2&z&&(n.xp6(2),n.Q6J("ngIf",!V.showAbove),n.xp6(1),n.Q6J("ngIf",V.canAddComment),n.xp6(1),n.Q6J("ngIf",V.showAbove))},directives:[h.O5,h.tP,Rt.m,M.o],encapsulation:2,changeDetection:0});var K=t(10190),de=t(70692);const He=function(X,z){return{workPackageId:X,"#":z}};class ht{ngOnInit(){this.activityHtmlId=`activity-${this.activityNo}`,this.activityLabel=`#${this.activityNo}`}}ht.\u0275fac=function(z){return new(z||ht)},ht.\u0275cmp=n.Xpm({type:ht,selectors:[["activity-link"]],inputs:{workPackage:"workPackage",activityNo:"activityNo"},decls:1,vars:6,consts:[["uiSref","work-packages.show",3,"id","textContent","uiParams"]],template:function(z,V){1&z&&n._UZ(0,"a",0),2&z&&(n.MGl("id","",V.activityHtmlId,"-link"),n.Q6J("textContent",V.activityLabel)("uiParams",n.WLB(3,He,V.workPackage.id,V.activityHtmlId)))},directives:[A.AnchorUISref,A.UISref],encapsulation:2});var St=t(3742);function Et(X,z){1&X&&n._UZ(0,"span",11)}function je(X,z){if(1&X&&n._UZ(0,"op-principal",12),2&X){const V=n.oxw(2);n.Q6J("principal",V.activity.author)("hideName",!0)}}const le=function(X){return{name:X}};function B(X,z){if(1&X&&n._UZ(0,"op-principal",12),2&X){const V=n.oxw(2);n.Q6J("principal",n.VKq(2,le,V.userName))("hideName",!0)}}function pe(X,z){if(1&X&&(n.TgZ(0,"span",13),n._UZ(1,"a",14),n.qZA()),2&X){const V=n.oxw(2);n.xp6(1),n.Q6J("textContent",V.userName),n.uIk("href",V.userPath,n.LSH)("aria-label",V.userLabel)}}function De(X,z){if(1&X&&n._UZ(0,"span",15),2&X){const V=n.oxw(2);n.Q6J("textContent",V.userName)}}function qe(X,z){if(1&X&&(n.TgZ(0,"div",1),n.TgZ(1,"div",2),n.YNc(2,Et,1,0,"span",3),n._UZ(3,"activity-link",4),n.qZA(),n.YNc(4,je,1,2,"op-principal",5),n.YNc(5,B,1,4,"op-principal",5),n.YNc(6,pe,2,3,"span",6),n.YNc(7,De,1,1,"span",7),n._uU(8,"\xa0 "),n._UZ(9,"span",8),n.TgZ(10,"span",9),n._UZ(11,"span",10),n.qZA(),n.qZA()),2&X){const V=n.oxw();n.uIk("data-notification-selector",V.hasUnreadNotification?"notification-activity":null),n.xp6(2),n.Q6J("ngIf",V.hasUnreadNotification),n.xp6(1),n.Q6J("workPackage",V.workPackage)("activityNo",V.activityNo),n.xp6(1),n.Q6J("ngIf",V.activity.author),n.xp6(1),n.Q6J("ngIf",!V.activity.author&&V.userName),n.xp6(1),n.Q6J("ngIf",V.userActive),n.xp6(1),n.Q6J("ngIf",!V.userActive),n.xp6(2),n.Q6J("innerHtml",V.revisionLink,n.oJD),n.xp6(2),n.Q6J("innerHtml",V.message,n.oJD)}}class ct{constructor(z,V,Qe,Ke){this.I18n=z,this.timezoneService=V,this.cdRef=Qe,this.apiV3Service=Ke}ngOnInit(){this.loadAuthor(),this.project=this.workPackage.project,this.revision=this.activity.identifier,this.message=this.activity.message.html;const z=this.activity.showRevision.$link.href,V=this.activity.formattedIdentifier,Qe=document.createElement("a");Qe.href=z,Qe.title=this.revision,Qe.textContent=this.I18n.t("js.label_committed_link",{revision_identifier:V}),this.revisionLink=this.I18n.t("js.label_committed_at",{committed_revision_link:Qe.outerHTML,date:this.timezoneService.formattedDatetime(this.activity.createdAt)})}loadAuthor(){void 0===this.activity.author?this.userName=this.activity.authorName:this.apiV3Service.users.id((0,K.Z)(this.activity.author.href)).get().subscribe(z=>{this.userId=z.id,this.userName=z.name,this.userActive=z.isActive,this.userAvatar=z.avatar,this.userPath=z.showUser.href,this.userLabel=this.I18n.t("js.label_author",{user:this.userName}),this.cdRef.detectChanges()})}}ct.\u0275fac=function(z){return new(z||ct)(n.Y36(c.D),n.Y36(de.B),n.Y36(n.sBO),n.Y36(r.T))},ct.\u0275cmp=n.Xpm({type:ct,selectors:[["revision-activity"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",hasUnreadNotification:"hasUnreadNotification"},decls:1,vars:1,consts:[["class","work-package-details-activities-activity-contents",4,"ngIf"],[1,"work-package-details-activities-activity-contents"],[1,"comments-number"],["class","comments-number--bubble op-bubble op-bubble_mini","data-qa-selector","revision-activity-bubble",4,"ngIf"],[1,"comments-number--link",3,"workPackage","activityNo"],[3,"principal","hideName",4,"ngIf"],["class","user",4,"ngIf"],["class","user",3,"textContent",4,"ngIf"],[1,"revision-activity--revision-link","date",3,"innerHtml"],[1,"user-comment","wiki"],[1,"message",3,"innerHtml"],["data-qa-selector","revision-activity-bubble",1,"comments-number--bubble","op-bubble","op-bubble_mini"],[3,"principal","hideName"],[1,"user"],[3,"textContent"],[1,"user",3,"textContent"]],template:function(z,V){1&z&&n.YNc(0,qe,12,10,"div",0),2&z&&n.Q6J("ngIf",V.workPackage)},directives:[h.O5,ht,St.N],encapsulation:2,changeDetection:0});t(80044);var Pt=t(71570),nt=t(65532),Se=t(21501),Pe=t(80261);class We{constructor(z,V,Qe){this.domSanitizer=z,this.elementRef=V,this.appRef=Qe,this.dynamicBootstrapper=Pe.Z}set HTML(z){this.innerHtml=this.domSanitizer.bypassSecurityTrustHtml(z),this.dynamicBootstrapper.bootstrapOptionalEmbeddable(this.appRef,this.elementRef.nativeElement)}}function et(X,z){if(1&X&&n._UZ(0,"op-principal",18),2&X){const V=n.oxw(2);n.Q6J("principal",V.user)("hideName",!0)}}function lt(X,z){1&X&&n._UZ(0,"span",19)}function ft(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"button",20),n.NdJ("click",function(){return n.CHM(V),n.oxw(2).quoteComment()}),n._UZ(1,"op-icon",21),n.qZA()}if(2&X){const V=n.oxw(2);n.Q6J("title",V.text.quote_comment)}}function kt(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"button",22),n.NdJ("click",function(){return n.CHM(V),n.oxw(2).activate()}),n._UZ(1,"op-icon",23),n.qZA()}if(2&X){const V=n.oxw(2);n.Q6J("ngClass","edit-activity--"+V.activityNo)("title",V.text.edit_comment)}}function Ft(X,z){if(1&X&&n._UZ(0,"img",24),2&X){const V=n.oxw(2);n.Q6J("src",V.bcfSnapshotUrl,n.LSH)}}function qt(X,z){if(1&X&&(n.TgZ(0,"div",25),n.TgZ(1,"div",26),n._UZ(2,"edit-form-portal",27),n.qZA(),n.qZA()),2&X){const V=n.oxw(2);n.xp6(2),n.Q6J("changeInput",V.change)("schemaInput",V.schema)("editFieldHandler",V.handler)}}function Xt(X,z){if(1&X&&n._UZ(0,"op-dynamic-bootstrap",28),2&X){const V=n.oxw(2);n.Q6J("HTML",V.postedComment)}}function Ht(X,z){if(1&X&&(n.TgZ(0,"li"),n._UZ(1,"span",31),n.qZA()),2&X){const V=z.$implicit;n.xp6(1),n.Q6J("innerHtml",V,n.oJD)}}function ei(X,z){if(1&X&&(n.TgZ(0,"ul",29),n.YNc(1,Ht,2,1,"li",30),n.qZA()),2&X){const V=n.oxw(2);n.xp6(1),n.Q6J("ngForOf",V.details)}}function ni(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"div",1),n.NdJ("mouseenter",function(){return n.CHM(V),n.oxw().focus()})("mouseleave",function(){return n.CHM(V),n.oxw().blur()}),n.TgZ(1,"div",2),n.YNc(2,et,1,2,"op-principal",3),n.TgZ(3,"div"),n._UZ(4,"op-user-link",4),n.TgZ(5,"span",5),n._uU(6),n._UZ(7,"op-date-time",6),n.qZA(),n.qZA(),n.qZA(),n.TgZ(8,"div",7),n.YNc(9,lt,1,0,"span",8),n._UZ(10,"activity-link",9),n.TgZ(11,"div",10),n.YNc(12,ft,2,1,"button",11),n.YNc(13,kt,2,2,"button",12),n.qZA(),n.qZA(),n.YNc(14,Ft,1,1,"img",13),n.TgZ(15,"div",14),n.YNc(16,qt,3,3,"div",15),n.YNc(17,Xt,1,1,"op-dynamic-bootstrap",16),n.YNc(18,ei,2,1,"ul",17),n.qZA(),n.qZA()}if(2&X){const V=n.oxw();n.uIk("data-notification-selector",V.hasUnreadNotification?"notification-activity":null),n.xp6(2),n.Q6J("ngIf",V.userName),n.xp6(2),n.Q6J("user",V.user),n.xp6(2),n.hij(" ",V.isInitial?V.text.label_created_on:V.text.label_updated_on," "),n.xp6(1),n.Q6J("dateTimeValue",V.activity.createdAt),n.xp6(2),n.Q6J("ngIf",V.hasUnreadNotification),n.xp6(1),n.Q6J("workPackage",V.workPackage)("activityNo",V.activityNo),n.xp6(1),n.Q6J("hidden",V.shouldHideIcons()),n.xp6(1),n.Q6J("ngIf",V.userCanQuote),n.xp6(1),n.Q6J("ngIf",V.userCanEdit),n.xp6(1),n.Q6J("ngIf",V.bcfSnapshotUrl),n.xp6(2),n.Q6J("ngIf",V.active),n.xp6(1),n.Q6J("ngIf",!V.active&&(V.isComment||V.isBcfComment)),n.xp6(1),n.Q6J("ngIf",!V.isInitial)}}We.\u0275fac=function(z){return new(z||We)(n.Y36(Pt.H7),n.Y36(n.SBq),n.Y36(n.z2F))},We.\u0275cmp=n.Xpm({type:We,selectors:[["op-dynamic-bootstrap"]],inputs:{HTML:"HTML"},decls:1,vars:1,consts:[[1,"op-uc-container",3,"innerHtml"]],template:function(z,V){1&z&&n._UZ(0,"div",0),2&z&&n.Q6J("innerHtml",V.innerHtml,n.oJD)},encapsulation:2});class oi extends bt{constructor(z,V,Qe,Ke,Ct,Nt,Kt,Li,dn,bi,wi,Oo){super(z,V),this.elementRef=z,this.injector=V,this.sanitization=Qe,this.PathHelper=Ke,this.wpLinkedActivities=Ct,this.commentService=Nt,this.ConfigurationService=Kt,this.apiV3Service=Li,this.cdRef=dn,this.I18n=bi,this.ngZone=wi,this.appRef=Oo,this.userCanEdit=!1,this.userCanQuote=!1,this.details=[],this.focused=!1,this.text={label_created_on:this.I18n.t("js.label_created_on"),label_updated_on:this.I18n.t("js.label_updated_on"),quote_comment:this.I18n.t("js.label_quote_comment"),edit_comment:this.I18n.t("js.label_edit_comment")}}ngOnInit(){super.ngOnInit(),this.htmlId=`user_activity_edit_field_${this.activityNo}`,this.updateCommentText(),this.isComment="Activity::Comment"===this.activity._type,this.isBcfComment="Activity::BcfComment"===this.activity._type,this.$element=jQuery(this.elementRef.nativeElement),this.reset(),this.userCanEdit=!!this.activity.update,this.userCanQuote=!!this.workPackage.addComment,this.$element.bind("focusin",this.focus.bind(this)),this.$element.bind("focusout",this.blur.bind(this)),_.each(this.activity.details,z=>{this.details.push(z.html)}),this.apiV3Service.users.id((0,K.Z)(this.activity.user.href)).get().subscribe(z=>{this.user=z,this.userId=z.id,this.userName=z.name,this.userAvatar=z.avatar,this.cdRef.detectChanges()}),window.location.hash===`#activity-${this.activityNo}`&&this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.elementRef.nativeElement.scrollIntoView(!0)})})}shouldHideIcons(){return!((this.isComment||this.isBcfComment)&&this.focussing())}activate(){super.activate(this.activity.comment.raw),this.cdRef.detectChanges()}handleUserSubmit(){return this.inFlight||!this.rawComment?Promise.resolve():this.updateComment()}quoteComment(){this.commentService.quoteEvents.next(this.quotedText(this.activity.comment.raw))}get bcfSnapshotUrl(){return _.get(this.activity,"bcfViewpoints[0]")?`${_.get(this.activity,"bcfViewpoints[0]").href}/snapshot`:null}updateComment(){return(0,st.mG)(this,void 0,void 0,function*(){return this.inFlight=!0,yield this.onSubmit(),this.commentService.updateComment(this.activity,this.rawComment||"").then(z=>{this.activity=z,this.updateCommentText(),this.wpLinkedActivities.require(this.workPackage,!0),this.apiV3Service.work_packages.cache.updateWorkPackage(this.workPackage)}).finally(()=>{this.deactivate(!0),this.inFlight=!1})})}focusEditIcon(){jQuery(`.edit-activity--${this.activityNo} a`).focus()}focus(){this.focused=!0,this.cdRef.detectChanges()}blur(){this.focused=!1,this.cdRef.detectChanges()}focussing(){return this.focused}setErrors(z){}quotedText(z){const V=z.split("\n").map(Qe=>`\n> ${Qe}`).join("");return`${this.userName} wrote:\n${V}`}deactivate(z){super.deactivate(z),z&&this.focusEditIcon()}updateCommentText(){this.postedComment=this.activity.comment.html}}function di(X,z){if(1&X&&n._UZ(0,"revision-activity",4),2&X){const V=n.oxw();n.Q6J("workPackage",V.workPackage)("activity",V.activity)("activityNo",V.activityNo)("hasUnreadNotification",V.hasUnreadNotification)}}function Ri(X,z){if(1&X&&n._UZ(0,"user-activity",5),2&X){const V=n.oxw();n.Q6J("workPackage",V.workPackage)("activity",V.activity)("activityNo",V.activityNo)("isInitial",V.isInitial)("hasUnreadNotification",V.hasUnreadNotification)}}oi.\u0275fac=function(z){return new(z||oi)(n.Y36(n.SBq),n.Y36(n.zs3),n.Y36(Pt.H7),n.Y36(y.j),n.Y36(vt.a),n.Y36(Lt.O),n.Y36(It.e),n.Y36(r.T),n.Y36(n.sBO),n.Y36(c.D),n.Y36(n.R0b),n.Y36(n.z2F))},oi.\u0275cmp=n.Xpm({type:oi,selectors:[["user-activity"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",isInitial:"isInitial",hasUnreadNotification:"hasUnreadNotification"},features:[n.qOj],decls:1,vars:1,consts:[["class","op-user-activity work-package-details-activities-activity-contents",3,"mouseenter","mouseleave",4,"ngIf"],[1,"op-user-activity","work-package-details-activities-activity-contents",3,"mouseenter","mouseleave"],[1,"op-user-activity--user-line"],["class","op-user-activity--avatar",3,"principal","hideName",4,"ngIf"],[1,"op-user-activity--user-name",3,"user"],[1,"op-user-activity--date"],[3,"dateTimeValue"],[1,"comments-number"],["class","comments-number--bubble op-bubble op-bubble_mini","data-qa-selector","user-activity-bubble",4,"ngIf"],[1,"comments-number--link",3,"workPackage","activityNo"],[1,"comments-icons",3,"hidden"],["type","button","class","spot-link",3,"title","click",4,"ngIf"],["type","button","class","spot-link",3,"ngClass","title","click",4,"ngIf"],["class","activity-thumbnail",3,"src",4,"ngIf"],[1,"user-comment"],["class","inplace-edit",4,"ngIf"],["class","message",3,"HTML",4,"ngIf"],["class","work-package-details-activities-messages",4,"ngIf"],[1,"op-user-activity--avatar",3,"principal","hideName"],["data-qa-selector","user-activity-bubble",1,"comments-number--bubble","op-bubble","op-bubble_mini"],["type","button",1,"spot-link",3,"title","click"],["icon-classes","action-icon icon-quote"],["type","button",1,"spot-link",3,"ngClass","title","click"],["icon-classes","action-icon icon-edit"],[1,"activity-thumbnail",3,"src"],[1,"inplace-edit"],[1,"user-comment--form","inplace-edit--write-value"],[3,"changeInput","schemaInput","editFieldHandler"],[1,"message",3,"HTML"],[1,"work-package-details-activities-messages"],[4,"ngFor","ngForOf"],[1,"message",3,"innerHtml"]],template:function(z,V){1&z&&n.YNc(0,ni,19,15,"div",0),2&z&&n.Q6J("ngIf",V.workPackage)},directives:[h.O5,nt.F,Se.F,ht,St.N,M.o,h.mk,Rt.m,We,h.sg],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-user-activity--user-line[_ngcontent-%COMP%]{display:flex;align-items:center;margin-right:50px;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis}.op-user-activity--user-name[_ngcontent-%COMP%]{display:block;font-weight:bold;line-height:16px;margin-bottom:3px}.op-user-activity--date[_ngcontent-%COMP%]{display:block;font-size:.8rem;color:var(--gray-dark)}.op-user-activity--avatar[_ngcontent-%COMP%]{flex-shrink:0;margin-right:.5rem}"],changeDetection:0});class gi{constructor(z,V){this.PathHelper=z,this.I18n=V}ngOnInit(){this.projectId=(0,K.Z)(this.workPackage.project.href),this.activityType=this.activity._type}}function rn(X,z){if(1&X&&(n.TgZ(0,"div",3),n._UZ(1,"activity-entry",4),n.ALo(2,"async"),n.qZA()),2&X){const V=z.$implicit,Qe=n.oxw(2);n.xp6(1),n.Q6J("workPackage",Qe.workPackage)("activity",V.activity)("activityNo",V.number(V.isReversed))("hasUnreadNotification",n.lcZ(2,5,Qe.hasUnreadNotification(V.href)))("isInitial",V.isInitial())}}function fi(X,z){if(1&X&&(n.TgZ(0,"div",1),n.YNc(1,rn,3,7,"div",2),n.qZA()),2&X){const V=n.oxw();n.xp6(1),n.Q6J("ngForOf",V.latestActivityInfo)("ngForTrackBy",V.trackByHref)}}gi.\u0275fac=function(z){return new(z||gi)(n.Y36(y.j),n.Y36(c.D))},gi.\u0275cmp=n.Xpm({type:gi,selectors:[["activity-entry"]],inputs:{workPackage:"workPackage",activity:"activity",activityNo:"activityNo",isInitial:"isInitial",hasUnreadNotification:"hasUnreadNotification"},decls:4,vars:4,consts:[[3,"id"],[3,"ngSwitch"],[3,"workPackage","activity","activityNo","hasUnreadNotification",4,"ngSwitchCase"],[3,"workPackage","activity","activityNo","isInitial","hasUnreadNotification",4,"ngSwitchDefault"],[3,"workPackage","activity","activityNo","hasUnreadNotification"],[3,"workPackage","activity","activityNo","isInitial","hasUnreadNotification"]],template:function(z,V){1&z&&(n.TgZ(0,"div",0),n.TgZ(1,"div",1),n.YNc(2,di,1,4,"revision-activity",2),n.YNc(3,Ri,1,5,"user-activity",3),n.qZA(),n.qZA()),2&z&&(n.MGl("id","activity-",V.activityNo,""),n.uIk("data-qa-activity-number",V.activityNo),n.xp6(1),n.Q6J("ngSwitch",V.activityType),n.xp6(1),n.Q6J("ngSwitchCase","Revision"))},directives:[h.RF,h.n9,h.ED,ct,oi],encapsulation:2});class pi extends Le{constructor(){super(...arguments),this.latestActivityInfo=[],this.trackByHref=(0,Ee.AT)("identifier")}ngOnInit(){this.workPackageId=this.workPackage.id,super.ngOnInit()}shouldShowToggler(){return!1}updateActivities(z){super.updateActivities(z),this.latestActivityInfo=this.latestActivities()}latestActivities(z=3){if(this.reverse)return this.unfilteredActivities.slice(0,z).map((Ct,Nt)=>this.info(Ct,Nt));const V=this.unfilteredActivities.slice(-z),Qe=this.unfilteredActivities.length-V.length;return V.map((Ke,Ct)=>this.info(Ke,Qe+Ct))}}function Zi(X,z){if(1&X&&n._UZ(0,"wp-single-view",2),2&X){const V=n.oxw();n.Q6J("workPackage",V.workPackage)}}function vi(X,z){if(1&X&&(n.TgZ(0,"div",3),n.TgZ(1,"div",4),n.TgZ(2,"div",5),n._UZ(3,"h3",6),n.qZA(),n.qZA(),n._UZ(4,"newest-activity-on-overview",2),n.qZA()),2&X){const V=n.oxw();n.xp6(3),n.Q6J("textContent",V.tabName),n.xp6(1),n.Q6J("workPackage",V.workPackage)}}pi.\u0275fac=function(){let X;return function(V){return(X||(X=n.n5z(pi)))(V||pi)}}(),pi.\u0275cmp=n.Xpm({type:pi,selectors:[["newest-activity-on-overview"]],inputs:{workPackage:"workPackage"},features:[n.qOj],decls:2,vars:1,consts:[[3,"workPackage"],[1,"work-package-details-activities-list"],["class","work-package-details-activities-activity",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package-details-activities-activity"],[3,"workPackage","activity","activityNo","hasUnreadNotification","isInitial"]],template:function(z,V){1&z&&(n.TgZ(0,"work-package-comment",0),n.YNc(1,fi,2,2,"ng-template"),n.qZA()),2&z&&n.Q6J("workPackage",V.workPackage)},directives:[ne,h.sg,gi],pipes:[h.Ov],encapsulation:2,changeDetection:0});class Yt extends u.N{constructor(z,V,Qe){super(),this.I18n=z,this.$state=V,this.apiV3Service=Qe,this.tabName=this.I18n.t("js.label_latest_activity"),this.workPackageId=this.$state.params.workPackageId,this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(Ke=>this.workPackage=Ke)}}function ui(X,z){if(1&X){const V=n.EpF();n.TgZ(0,"button",11),n.NdJ("click",function(){return n.CHM(V),n.oxw(5).toggleComments()}),n.qZA()}if(2&X){const V=n.oxw(5);n.Q6J("textContent",V.togglerText)}}Yt.\u0275fac=function(z){return new(z||Yt)(n.Y36(c.D),n.Y36(e.StateService),n.Y36(r.T))},Yt.\u0275cmp=n.Xpm({type:Yt,selectors:[["wp-overview-tab"]],features:[n.qOj],decls:2,vars:2,consts:[[3,"workPackage",4,"ngIf"],["class","attributes-group",4,"ngIf"],[3,"workPackage"],[1,"attributes-group"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(z,V){1&z&&(n.YNc(0,Zi,1,1,"wp-single-view",0),n.YNc(1,vi,5,2,"div",1)),2&z&&(n.Q6J("ngIf",V.workPackage),n.xp6(1),n.Q6J("ngIf",V.workPackage))},directives:[h.O5,Re.G,pi],encapsulation:2});const Hi=function(X){return{"-with-toggler":X}};function Ki(X,z){if(1&X&&(n.TgZ(0,"h3",8),n._UZ(1,"span",9),n.YNc(2,ui,1,1,"button",10),n.qZA()),2&X){const V=n.oxw(),Qe=V.first,Ke=V.$implicit,Ct=n.oxw(3);n.Q6J("ngClass",n.VKq(3,Hi,Qe&&Ct.showToggler)),n.xp6(1),n.Q6J("textContent",Ke.date),n.xp6(1),n.Q6J("ngIf",Qe&&Ct.showToggler)}}function Ui(X,z){if(1&X&&(n.TgZ(0,"div",5),n.YNc(1,Ki,3,5,"h3",6),n._UZ(2,"activity-entry",7),n.ALo(3,"async"),n.qZA()),2&X){const V=z.$implicit,Qe=z.first,Ke=n.oxw(3);n.xp6(1),n.Q6J("ngIf",Qe||V.isNextDate),n.xp6(1),n.Q6J("workPackage",Ke.workPackage)("activity",V.activity)("activityNo",V.number(V.isReversed))("hasUnreadNotification",n.lcZ(3,6,Ke.hasUnreadNotification(V.href)))("isInitial",V.isInitial())}}function an(X,z){if(1&X&&(n.TgZ(0,"div",2),n.TgZ(1,"div",3),n.YNc(2,Ui,4,8,"div",4),n.qZA(),n.qZA()),2&X){const V=n.oxw(2);n.xp6(2),n.Q6J("ngForOf",V.visibleActivities)("ngForTrackBy",V.trackByHref)}}function cn(X,z){if(1&X&&(n.TgZ(0,"work-package-comment",1),n.YNc(1,an,3,2,"ng-template"),n.qZA()),2&X){const V=n.oxw();n.Q6J("workPackage",V.workPackage)}}class si extends Le{constructor(){super(...arguments),this.tabName=this.I18n.t("js.work_packages.tabs.activity"),this.trackByHref=(0,Ee.WJ)("version")}ngOnInit(){const{workPackageId:z}=this.uiRouterGlobals.params;this.workPackageId=z,super.ngOnInit()}}si.\u0275fac=function(){let X;return function(V){return(X||(X=n.n5z(si)))(V||si)}}(),si.\u0275cmp=n.Xpm({type:si,selectors:[["wp-activity-tab"]],features:[n.qOj],decls:1,vars:1,consts:[[3,"workPackage",4,"ngIf"],[3,"workPackage"],[1,"detail-activity"],[1,"work-package-details-activities-list"],["class","work-package-details-activities-activity",4,"ngFor","ngForOf","ngForTrackBy"],[1,"work-package-details-activities-activity"],["class","activity-date",3,"ngClass",4,"ngIf"],[3,"workPackage","activity","activityNo","hasUnreadNotification","isInitial"],[1,"activity-date",3,"ngClass"],[1,"activity-date--label",3,"textContent"],["type","button","class","activity-comments--toggler button -small -transparent -with-icon icon-filter icon-small hide-when-print",3,"textContent","click",4,"ngIf"],["type","button",1,"activity-comments--toggler","button","-small","-transparent","-with-icon","icon-filter","icon-small","hide-when-print",3,"textContent","click"]],template:function(z,V){1&z&&n.YNc(0,cn,2,1,"work-package-comment",0),2&z&&n.Q6J("ngIf",V.workPackage)},directives:[h.O5,ne,h.sg,gi,h.mk],pipes:[h.Ov],encapsulation:2});var ki=t(18236),xi=t(53448),ln=t(97661),Ci=t(14274);function Mi(X,z){if(1&X&&(n.TgZ(0,"div",3),n.TgZ(1,"div",4),n._UZ(2,"h3",5),n.qZA(),n.qZA()),2&X){const V=n.oxw();n.xp6(2),n.Q6J("textContent",V.text.attachments.label)}}class ri{constructor(z,V){this.I18n=z,this.hook=V,this.text={attachments:{label:this.I18n.t("js.label_attachments")}}}}ri.\u0275fac=function(z){return new(z||ri)(n.Y36(c.D),n.Y36(xi.$))},ri.\u0275cmp=n.Xpm({type:ri,selectors:[["op-files-tab"]],decls:4,vars:3,consts:[[1,"work-packages--attachments-container"],["class","attributes-group--header",4,"ngIf"],[3,"resource"],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(z,V){1&z&&(n.TgZ(0,"div",0),n.YNc(1,Mi,3,1,"div",1),n._UZ(2,"op-attachment-list",2),n._UZ(3,"op-attachments-upload",2),n.qZA()),2&z&&(n.xp6(1),n.Q6J("ngIf",!1),n.xp6(1),n.Q6J("resource",V.workPackage),n.xp6(1),n.Q6J("resource",V.workPackage))},directives:[h.O5,ln.c,Ci.s],encapsulation:2,changeDetection:0});var _i=t(84939);function yi(X,z){return z.get(_i.W).requireAndStream(X).pipe((0,pt.U)(Qe=>Qe.length))}var Ei=t(61486);function ai(X,z){const V=z.get(C.V),Qe=z.get(r.T),Ke=X.id.toString();return V.require(Ke),(0,Ei.aj)([V.state(Ke.toString()).values$(),Qe.work_packages.id(Ke).requireAndStream()]).pipe((0,pt.U)(([Ct,Nt])=>_.size(Ct)+_.size(Nt.children)))}function Te(X,z){return z.get(Ue.O).query.selectNotificationsCount$}var Q=t(29351);function U(X,z){return z.get(Q.v).query.select().pipe((0,pt.U)(Qe=>{var Ke;const Ct=X.$links.attachments.href;return null==Ct?0:(null===(Ke=Qe.collections[Ct])||void 0===Ke?void 0:Ke.ids.length)||0}))}class we{constructor(z,V,Qe){this.$state=z,this.I18n=V,this.injector=Qe,this.registeredTabs=this.buildDefaultTabs()}get tabs(){return[...this.registeredTabs]}register(...z){this.registeredTabs=[...this.registeredTabs,...z]}getDisplayableTabs(z){return this.tabs.filter(V=>!V.displayable||V.displayable(z,this.$state)).map(V=>Object.assign(Object.assign({},V),{counter:V.count?Qe=>V.count(z,Qe||this.injector):Qe=>(0,i.D)([0])}))}getTab(z,V){return this.getDisplayableTabs(V).find(({id:Qe})=>Qe===z)}buildDefaultTabs(){return[{component:Yt,name:this.I18n.t("js.work_packages.tabs.overview"),id:"overview",displayable:(z,V)=>V.includes("**.details.*")},{id:"activity",component:si,name:I18n.t("js.work_packages.tabs.activity"),count:Te,showCountAsBubble:!0},{id:"files",component:ri,name:I18n.t("js.work_packages.tabs.files"),count:U},{id:"relations",component:Me,name:I18n.t("js.work_packages.tabs.relations"),count:ai},{id:"watchers",component:ki.h,name:I18n.t("js.work_packages.tabs.watchers"),displayable:z=>!!z.watchers,count:yi}]}}we.\u0275fac=function(z){return new(z||we)(n.LFG(e.StateService),n.LFG(c.D),n.LFG(n.zs3))},we.\u0275prov=n.Yz7({token:we,factory:we.\u0275fac,providedIn:"root"})},92092:(H,D,t)=>{"use strict";t.d(D,{E:()=>h});t(24897);var e=t(2316),c=t(54364),u=t(54262);const r=function(){return{colorize:!1}};function n(a,p){if(1&a&&(e.TgZ(0,"div",1),e.TgZ(1,"div",2),e._UZ(2,"editable-attribute-field",3),e.qZA(),e.TgZ(3,"div",4),e._UZ(4,"editable-attribute-field",5),e.qZA(),e.qZA()),2&a){const l=e.oxw();e.xp6(2),e.Q6J("resource",l.workPackage)("displayFieldOptions",e.DdM(7,r))("wrapperClasses","wp-new-top-row--status -no-label")("fieldName","status"),e.xp6(2),e.Q6J("resource",l.workPackage)("wrapperClasses","wp-new-top-row--type -no-label")("fieldName","type")}}class h{}h.\u0275fac=function(p){return new(p||h)},h.\u0275cmp=e.Xpm({type:h,selectors:[["wp-type-status"]],inputs:{workPackage:"workPackage"},decls:1,vars:1,consts:[["class","wp-new-top-row",4,"ngIf"],[1,"wp-new-top-row"],[1,"work-packages--status-selector","wp-new-top-row--element"],[3,"resource","displayFieldOptions","wrapperClasses","fieldName"],[1,"work-packages--type-selector","wp-new-top-row--element"],[3,"resource","wrapperClasses","fieldName"]],template:function(p,l){1&p&&e.YNc(0,n,5,8,"div",0),2&p&&e.Q6J("ngIf",l.workPackage)},directives:[c.O5,u.k],encapsulation:2})},73905:(H,D,t)=>{"use strict";t.d(D,{u:()=>d});t(24897);var e=t(96617),c=t(84939),u=t(26942),r=t(20979),n=t(2316),h=t(54364),a=t(2775);function p(g,C){if(1&g&&n._UZ(0,"span",4),2&g){const y=n.oxw(2);n.Q6J("textContent",y.buttonText)}}function l(g,C){if(1&g){const y=n.EpF();n.TgZ(0,"button",1),n.NdJ("click",function(){return n.CHM(y),n.oxw().toggleWatch()}),n._UZ(1,"op-icon",2),n.YNc(2,p,1,1,"span",3),n.qZA()}if(2&g){const y=n.oxw();n.Q6J("disabled",y.disabled)("ngClass",y.buttonClass)("id",y.buttonId),n.uIk("title",y.buttonTitle),n.xp6(1),n.MGl("icon-classes","button--icon ",y.watchIconClass,""),n.xp6(1),n.Q6J("ngIf",y.showText)}}class d extends u.N{constructor(C,y,m,E){super(),this.I18n=C,this.wpWatchersService=y,this.apiV3Service=m,this.cdRef=E,this.showText=!1,this.disabled=!1}ngOnInit(){this.apiV3Service.work_packages.id(this.workPackage).requireAndStream().pipe(this.untilDestroyed()).subscribe(C=>{this.workPackage=C,this.setWatchStatus(),this.cdRef.detectChanges()})}get isWatched(){return this.workPackage.hasOwnProperty("unwatch")}get displayWatchButton(){return this.isWatched||this.workPackage.hasOwnProperty("watch")}toggleWatch(){const C=this.nextStateLink();C(C.$link.payload).then(()=>{this.wpWatchersService.clear(this.workPackage.id),this.apiV3Service.work_packages.id(this.workPackage).refresh()})}nextStateLink(){const C=this.isWatched?"unwatch":"watch";return this.workPackage[C]}setWatchStatus(){this.isWatched?(this.buttonTitle=this.I18n.t("js.label_unwatch_work_package"),this.buttonText=this.I18n.t("js.label_unwatch"),this.buttonClass="-active",this.buttonId="unwatch-button",this.watchIconClass="icon-watched"):(this.buttonTitle=this.I18n.t("js.label_watch_work_package"),this.buttonText=this.I18n.t("js.label_watch"),this.buttonClass="",this.buttonId="watch-button",this.watchIconClass="icon-unwatched")}}d.\u0275fac=function(C){return new(C||d)(n.Y36(e.D),n.Y36(c.W),n.Y36(r.T),n.Y36(n.sBO))},d.\u0275cmp=n.Xpm({type:d,selectors:[["wp-watcher-button"]],inputs:{workPackage:"workPackage",showText:"showText",disabled:"disabled"},features:[n.qOj],decls:1,vars:1,consts:[["class","button toolbar-icon",3,"disabled","ngClass","id","click",4,"ngIf"],[1,"button","toolbar-icon",3,"disabled","ngClass","id","click"],[3,"icon-classes"],["class","button--text",3,"textContent",4,"ngIf"],[1,"button--text",3,"textContent"]],template:function(C,y){1&C&&n.YNc(0,l,3,6,"button",0),2&C&&n.Q6J("ngIf",y.displayWatchButton)},directives:[h.O5,h.mk,a.o],encapsulation:2,changeDetection:0})},43440:(H,D,t)=>{"use strict";t.d(D,{q:()=>r});var i=t(14808),e=t(79441),c=t(33927),u=t(2316);class r extends i.Ui{constructor(){super(...arguments),this.name="IsolatedQuerySpace",this.query=(0,i.qH)(),this.queryForm=(0,i.qH)(),this.results=(0,i.qH)(),this.groups=(0,i.qH)(),this.columns=(0,i.qH)(),this.collapsedGroups=(0,i.qH)(),this.tableRendered=(0,i.qH)(),this.timelineRendered=new e.xQ,this.renderedWorkPackages=(0,i.sY)(this.tableRendered,h=>h.pipe((0,c.U)(a=>a.filter(p=>!!p.workPackageId)))),this.renderedWorkPackageIds=(0,i.sY)(this.renderedWorkPackages,h=>h.pipe((0,c.U)(a=>a.map(p=>p.workPackageId.toString())))),this.stopAllSubscriptions=new e.xQ,this.additionalRequiredWorkPackages=(0,i.qH)(),this.initialized=(0,i.qH)(),this.available={columns:(0,i.qH)(),sortBy:(0,i.qH)(),groupBy:(0,i.qH)(),filters:(0,i.qH)(),displayRepresentation:(0,i.qH)()}}}r.\u0275fac=function(){let n;return function(a){return(n||(n=u.n5z(r)))(a||r)}}(),r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac})},97047:(H,D,t)=>{"use strict";t.d(D,{A:()=>Ce});var i=t(43440),e=t(93903),c=t(41195),u=t(40533),r=t(61083),n=t(99676),h=t(82763),a=t(71562),p=t(74647),l=t(73165),d=t(60914),g=t(82271),C=t(81691),y=t(84897),m=t(63829),E=t(74478),P=t(48451),w=t(12703),x=t(61043),k=t(41945),b=t(78434),v=t(77591),M=t(8403),S=t(85388),O=t(32869),A=t(81539),F=t(3352),I=t(16451),J=t(95846),N=t(64538),te=t(11337),ee=t(2888),G=t(20066),se=t(16793),me=t(67727),_e=t(62964),he=t(46709),ae=t(79174),re=t(56686),ye=t(2316);class Ce{constructor(Ae,Fe,ot){this.elementRef=Ae,this.querySpace=Fe,this.injector=ot,(0,F.qu)("Opening isolated query space %O in %O",ot,Ae.nativeElement)}}Ce.\u0275fac=function(Ae){return new(Ae||Ce)(ye.Y36(ye.SBq),ye.Y36(i.q),ye.Y36(ye.zs3))},Ce.\u0275dir=ye.lG2({type:Ce,selectors:[["","wp-isolated-query-space",""]],features:[ye._Bn([{provide:me.W,useExisting:_e.q},i.q,e.j,A.Y,x.Z,c.a,u.S,r.w,ae.q,n.Y,h.q,a.i,p.Z,l.W,d.J,g.X,C.G,P.o,y.B,ee.ld,G.F,J.M,se.f,N.h,re.h,k.O,b.U,v.j,M.m,S.j,O.x,te.c,w.l,he.f,m.P,E.f,I.B])]})},99250:(H,D,t)=>{"use strict";t.d(D,{H:()=>Ii});var i=t(21757),e=t(65084),c=t(55811),u=t(53448),r=t(96617),n=t(36293),h=t(2281),a=t(22663),p=t(9170),l=t(14808),d=t(3786),g=t(87853),C=t(12703),y=t(29161),m=t(7812),E=t(50076),P=t(73165),w=t(44022),x=t(43440),k=t(33406),b=t(53466),v=t(20979);const S="leftHandle",O="rightHandle";function F(Ne,Z,Y,ce,xe,Je,Ge,tt,ze,_t,dt,gt){Ne.get(x.q);let ci,$t,Ti=null;gt.change=ce.changeFor(gt.workPackage);const ii=jQuery("body");function As(Bt,Qt){const Gt=Y.getAbsoluteLeftCoordinates(),li=Qt.clientX-Gt;return Math.floor(li/Bt.viewParams.pixelPerDay)}function js(Bt){Bt.keyCode===k.m.ESCAPE&&un(!0)}function Rs(Bt){const Qt=gt.workPackage;dt.isEmpty(Qt)&&((Qt.isLeaf||Qt.scheduleManually)&&dt.canMoveDates(Qt)?(tt.style.cursor="",$t&&$t.remove(),$t=dt.displayPlaceholderUnderCursor(Bt,gt),tt.appendChild($t),tt.onmouseleave=()=>{$t.remove()},tt.onmousedown=li=>{$t.remove(),ze.style.pointerEvents="none",li.preventDefault();const Pi=Math.floor(li.offsetX/gt.viewParams.pixelPerDay),hn=gt.viewParams.dateDisplayStart.clone().add(Pi,"days").format("YYYY-MM-DD"),Sn=dt.onMouseDown(li,hn,gt,_t,ze);if(dt.update(ze,_t,gt),"create"===Sn)return un(!1),void li.preventDefault();ii.on("mousemove.emptytimelinecell",function(Bt,Qt){return Gt=>{const li=Math.abs(tt.getBoundingClientRect().x-Gt.clientX),Pi=Math.floor(li/gt.viewParams.pixelPerDay),In=gt.viewParams.dateDisplayStart.clone().add(Pi,"days"),hn=Pi-Bt,Sn=dt.onDaysMoved(gt.change,In,hn,Qt);dt.assignDateValues(gt.change,_t,Sn),dt.update(ze,_t,gt)}}(Pi,Sn)),ii.on("mouseup.emptytimelinecell",()=>un(!1)),tt.onmouseup=()=>{un(!1)},ii.on("keyup.timelinecell",js)}):tt.style.cursor="not-allowed")}function un(Bt){if(Y.disableViewParamsCalculation=!1,tt.onmousemove=Rs,tt.onmousedown=_.noop,tt.onmouseleave=_.noop,tt.onmouseup=_.noop,ze.style.pointerEvents="auto",ii.off(".timelinecell"),ii.off(".emptytimelinecell"),Y.resetCursor(),Ti=null,ci={},Bt||gt.change.isEmpty())Bi();else{const Qt=()=>{gt.change.clear(),dt.onMouseDownEnd(_t,gt.change)};(function(Bt){const Qt=Ne.get(v.T),Gt=Ne.get(x.q),li=h().toISOString();return Ge.table.promise=ce.save(Bt).then(Pi=>{Je.showSave(Pi.resource);const In=_.map(Gt.tableRendered.value,hn=>hn.workPackageId);return Qt.work_packages.filterUpdatedSince(In,li).get().toPromise().then(()=>(xe.push(Pi.resource,{eventType:"updated"}),Gt.timelineRendered.pipe((0,b.q)(1)).toPromise()))})})(gt.change).then(Qt).catch(Gt=>{Je.handleRawError(Gt,gt.workPackage),Bi()})}}function Bi(){gt.change.clear(),dt.update(ze,_t,gt),dt.onMouseDownEnd(_t,gt.change),Y.refreshView()}ze.onmousedown=Bt=>{1===Bt.which&&function(Bt,Qt){Qt.preventDefault();const Gt="active-drag";if(Bt.classList.add(Gt),ii.on("mouseup.timelinecell",()=>Bt.classList.remove(Gt)),Y.disableViewParamsCalculation=!0,Ti=As(gt,Qt),!gt.workPackage.isLeaf&&!gt.viewParams.activeSelectionMode&&!gt.workPackage.scheduleManually)return;const li=dt.onMouseDown(Qt,null,gt,_t,Bt);ii.on("mousemove.timelinecell",function(Bt){return Qt=>{const Gt=As(gt,Qt.originalEvent)-Ti,li=Math.floor(Qt.offsetX/gt.viewParams.pixelPerDay),Pi=gt.viewParams.dateDisplayStart.clone().add(li,"days");ci=dt.onDaysMoved(gt.change,Pi,Gt,Bt),function(Bt,Qt){dt.assignDateValues(Bt.change,_t,Qt)}(gt,ci),dt.update(ze,_t,gt)}}(li)),ii.on("keyup.timelinecell",js),ii.on("mouseup.timelinecell",()=>un(!1))}(ze,Bt)},tt.onmousemove=Rs}var I=t(86469),J=t(1403),N=t(62964);const te="labelLeft",ee="containerRight",G="labelRight",se="labelHoverLeft",me="labelHoverRight",_e="-label-style",he="labelFarRight",ae="show-on-hover",re="hide-on-hover";class ye{constructor(Z,Y,ce,xe,Je,Ge,tt){this.center=Z,this.left=Y,this.leftHover=ce,this.right=xe,this.rightHover=Je,this.farRight=Ge,this.withAlternativeLabels=tt}}class Ce{constructor(Z,Y,ce,xe,Je,Ge){this.injector=Z,this.workPackageTimeline=Y,this.renderers=ce,this.latestRenderInfo=xe,this.classIdentifier=Je,this.workPackageId=Ge,this.wpElement=null}getMarginLeftOfLeftSide(){return this.cellRenderer(this.latestRenderInfo.workPackage).getMarginLeftOfLeftSide(this.latestRenderInfo)}getMarginLeftOfRightSide(){return this.cellRenderer(this.latestRenderInfo.workPackage).getMarginLeftOfRightSide(this.latestRenderInfo)}getPaddingLeftForIncomingRelationLines(){return this.cellRenderer(this.latestRenderInfo.workPackage).getPaddingLeftForIncomingRelationLines(this.latestRenderInfo)}getPaddingRightForOutgoingRelationLines(){return this.cellRenderer(this.latestRenderInfo.workPackage).getPaddingRightForOutgoingRelationLines(this.latestRenderInfo)}canConnectRelations(){const Z=this.latestRenderInfo.workPackage;return this.schemaCache.of(Z).isMilestone?!_.isNil(Z.date):!_.isNil(Z.startDate)||!_.isNil(Z.dueDate)}clear(){this.cellElement.html(""),this.wpElement=null}get cellContainer(){return this.workPackageTimeline.timelineBody}get cellElement(){return this.cellContainer.find(`.${this.classIdentifier}`)}lazyInit(Z,Y){const ce=this.workPackageTimeline.timelineBody[0],xe=this.cellElement;return xe.length?(null!==this.wpElement&&ce.contains(this.wpElement)&&this.elementShape===Z.type||(Y.isDuplicatedCell||this.clear(),this.wpElement=Z.render(Y),this.labels=Z.createAndAddLabels(Y,this.wpElement),this.elementShape=Z.type,xe.append(this.wpElement),Z.canMoveDates(Y.workPackage)&&(this.wpElement.classList.add("-editable"),F(this.injector,0,this.workPackageTimeline,this.halEditing,this.halEvents,this.notificationService,this.loadingIndicator,xe[0],this.wpElement,this.labels,Z,Y))),Promise.resolve()):Promise.reject("uninitialized")}cellRenderer(Z){return this.schemaCache.of(Z).isMilestone?this.renderers.milestone:this.renderers.generic}refreshView(Z){this.latestRenderInfo=Z;const Y=this.cellRenderer(Z.workPackage);this.lazyInit(Y,Z).then(()=>{Y.update(this.wpElement,this.labels,Z)||this.clear()}).catch(()=>null)}}(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",C.l)],Ce.prototype,"halEditing",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",J.J)],Ce.prototype,"halEvents",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",N.q)],Ce.prototype,"notificationService",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",g.G)],Ce.prototype,"states",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",I.vt)],Ce.prototype,"loadingIndicator",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",w.y)],Ce.prototype,"schemaCache",void 0);var ke=t(42529);class Fe{constructor(Z,Y){this.injector=Z,this.workPackageTimeline=Y,this.text={label_children_derived_duration:this.I18n.t("js.label_children_derived_duration")},this.fieldRenderer=new m.uA(this.injector,"timeline"),this.dateDisplaysOnMouseMove={},this.ganttChartRowHeight=+getComputedStyle(document.documentElement).getPropertyValue("--table-timeline--row-height").replace("px","")}get type(){return"bar"}canMoveDates(Z){const Y=this.schemaCache.of(Z);return Y.startDate.writable&&Y.dueDate.writable&&Y.isAttributeEditable("startDate")}isEmpty(Z){const Y=h(Z.startDate),ce=h(Z.dueDate);return _.isNaN(Y.valueOf())&&_.isNaN(ce.valueOf())}displayPlaceholderUnderCursor(Z,Y){const ce=Math.floor(Z.offsetX/Y.viewParams.pixelPerDay),xe=document.createElement("div");return xe.style.pointerEvents="none",xe.style.position="absolute",xe.style.height="1em",xe.style.width="30px",xe.style.zIndex="9999",xe.style.left=ce*Y.viewParams.pixelPerDay+"px",this.applyTypeColor(Y,xe),xe}assignDateValues(Z,Y,ce){this.assignDate(Z,"startDate",ce.startDate),this.assignDate(Z,"dueDate",ce.dueDate),this.updateLabels(!0,Y,Z)}onDaysMoved(Z,Y,ce,xe){const Je=Z.pristineResource.startDate,Ge=Z.pristineResource.dueDate,tt=h().format("YYYY-MM-DD"),ze=h(Z.projectedResource.startDate),_t=h(Z.projectedResource.dueDate),dt={};return"left"===xe?dt.startDate=h(Je||Ge).add(ce,"days"):"right"===xe?dt.dueDate=h(Ge||tt).add(ce,"days"):"both"===xe?(Je&&(dt.startDate=h(Je).add(ce,"days")),Ge&&(dt.dueDate=h(Ge).add(ce,"days"))):"dragright"===xe&&(dt.dueDate=ze.clone().add(ce,"days")),"both"!==xe&&(void 0!==dt.startDate&&dt.startDate.isAfter(_t)?dt.startDate=_t:void 0!==dt.dueDate&&dt.dueDate.isBefore(ze)&&(dt.dueDate=ze)),dt}onMouseDown(Z,Y,ce,xe,Je){if(ce.viewParams.activeSelectionMode)return ce.viewParams.activeSelectionMode(ce.workPackage),Z.preventDefault(),"both";const Ge=ce.change.projectedResource;let tt;return jQuery(Z.target).hasClass(S)?(tt="left",this.workPackageTimeline.forceCursor("col-resize"),null===Ge.startDate&&(Ge.startDate=Ge.dueDate)):jQuery(Z.target).hasClass(O)||Y?(tt="right",this.workPackageTimeline.forceCursor("col-resize")):(tt="both",this.workPackageTimeline.forceCursor("ew-resize")),Y&&(Ge.startDate=Y,Ge.dueDate=Y,tt="dragright"),this.updateLabels(!0,xe,ce.change),tt}onMouseDownEnd(Z,Y){this.updateLabels(!1,Z,Y)}update(Z,Y,ce){const{change:xe}=ce,Je=Z.querySelector(`.${ke.PY}`);let Ge=h(xe.projectedResource.startDate),tt=h(xe.projectedResource.dueDate);return _.isNaN(Ge.valueOf())&&_.isNaN(tt.valueOf())?Z.style.visibility="hidden":Z.style.visibility="visible",_.isNaN(tt.valueOf())&&!_.isNaN(Ge.valueOf())&&(tt=h(),Je.style.backgroundImage="linear-gradient(90deg, rgba(255,255,255,0) 0%, #F1F1F1 100%)"),_.isNaN(Ge.valueOf())&&!_.isNaN(tt.valueOf())&&(Ge=tt.clone(),Je.style.backgroundImage="linear-gradient(90deg, #F1F1F1 0%, rgba(255,255,255,0) 80%)"),this.setElementPositionAndSize(Z,ce,Ge,tt),Y&&this.updateLabels(!1,Y,xe),this.checkForActiveSelectionMode(ce,Je),this.checkForSpecialDisplaySituations(ce,Je),this.applyTypeColor(ce,Je),!0}checkForActiveSelectionMode(Z,Y){Z.viewParams.activeSelectionMode&&(Y.style.backgroundImage="",Z.viewParams.selectionModeStart===`${Z.workPackage.id}`&&(jQuery(Y).addClass(ke.LT),Y.style.background="none"))}getMarginLeftOfLeftSide(Z){const Y=Z.change.projectedResource;let ce=h(Y.startDate);const xe=h(Y.dueDate);ce=_.isNaN(ce.valueOf())?xe.clone():ce;const Je=ce.diff(Z.viewParams.dateDisplayStart,"days");return(0,ke.lW)(Z.viewParams,Je)}getMarginLeftOfRightSide(Z){const Y=Z.change.projectedResource;let ce=h(Y.startDate),xe=h(Y.dueDate);ce=_.isNaN(ce.valueOf())?xe.clone():ce,xe=_.isNaN(xe.valueOf())?ce.clone():xe;const Je=ce.diff(Z.viewParams.dateDisplayStart,"days"),Ge=xe.diff(ce,"days")+1;return(0,ke.lW)(Z.viewParams,Je+Ge)}getPaddingLeftForIncomingRelationLines(Z){return Z.viewParams.pixelPerDay/8}getPaddingRightForOutgoingRelationLines(Z){return 0}render(Z){const Y=document.createElement("div"),ce=document.createElement("div"),xe=document.createElement("div"),Je=document.createElement("div");return Y.className=`${ke.mN} ${this.type}`,ce.className=ke.PY,xe.className=S,Je.className=O,Y.appendChild(ce),Y.appendChild(xe),Y.appendChild(Je),Y}createAndAddLabels(Z,Y){const ce=document.createElement("div");ce.classList.add("bar-label"),this.applyTypeColor(Z,ce),Y.appendChild(ce);const xe=document.createElement("div");xe.classList.add(te,re),Y.appendChild(xe);const Je=document.createElement("div");Je.classList.add(ee),Y.appendChild(Je);const Ge=document.createElement("div");Ge.classList.add(G,re),Je.appendChild(Ge);const tt=document.createElement("div");tt.classList.add(he,re),Je.appendChild(tt);const ze=document.createElement("div");ze.classList.add(se,ae,_e),Y.appendChild(ze);const _t=document.createElement("div");_t.classList.add(me,ae,_e),Y.appendChild(_t);const dt=new ye(ce,xe,ze,Ge,_t,tt);return this.updateLabels(!1,dt,Z.change),dt}applyTypeColor(Z,Y){const ce=Z.workPackage,{type:xe}=ce,Je=Z.viewParams.activeSelectionMode,{id:Ge}=xe;Je?Y.classList.remove(E.Z.backgroundClass("type",Ge)):Y.classList.add(E.Z.backgroundClass("type",Ge))}assignDate(Z,Y,ce){ce&&(Z.projectedResource[Y]=ce.format("YYYY-MM-DD"))}setElementPositionAndSize(Z,Y,ce,xe){const{viewParams:Je}=Y,Ge=ce.diff(Je.dateDisplayStart,"days");Z.style.left=(0,ke.jr)(Je,Ge);const tt=xe.diff(ce,"days")+1;if(Z.style.width=(0,ke.jr)(Je,tt),!_.isNaN(ce.valueOf())||!_.isNaN(xe.valueOf())){const ze=_.max([Y.viewParams.pixelPerDay,2]);Z.style.minWidth=`${ze}px`}}checkForSpecialDisplaySituations(Z,Y){const ce=Z.workPackage,xe=Y.parentElement.parentElement,Je=Z.viewParams.activeSelectionMode;if(ce.isLeaf||Je||ce.scheduleManually?Y.classList.remove("-readonly"):Y.classList.add("-readonly"),ce.derivedStartDate&&ce.derivedDueDate){const Ge=h(ce.derivedStartDate),tt=h(ce.derivedDueDate),ze=h(Z.change.projectedResource.startDate),_t=h(Z.change.projectedResource.dueDate),dt=xe.querySelector(".children-duration-bar"),gt=document.createElement("div"),ti=document.createElement("div"),Ti=document.querySelectorAll(`.wp-timeline-cell.__hierarchy-group-${ce.id}:not([class*='__collapsed-group'])`).length||0;gt.classList.add("children-duration-bar","-clamp-style"),gt.title=this.text.label_children_derived_duration,ti.classList.add("children-duration-hover-container"),ti.style.height=this.ganttChartRowHeight*Ti+10+"px",(Ge.isBefore(ze)||tt.isAfter(_t))&&gt.classList.add("-duration-overflow"),this.setElementPositionAndSize(gt,Z,Ge,tt),dt&&dt.remove(),gt.appendChild(ti),xe.appendChild(gt)}}updateLabels(Z,Y,ce){const xe=this.wpTableTimeline.getNormalizedLabels(ce.projectedResource);Z||(this.renderLabel(ce,Y,"left",xe.left),this.renderLabel(ce,Y,"right",xe.right),this.renderLabel(ce,Y,"farRight",xe.farRight)),this.renderHoverLabels(Y,ce)}renderHoverLabels(Z,Y){this.renderLabel(Y,Z,"leftHover","startDate"),this.renderLabel(Y,Z,"rightHover","dueDate")}renderLabel(Z,Y,ce,xe){const Je=Y[ce];if(!Je)return;if(Je.innerHTML="",null===xe)return void Je.classList.remove("not-empty");const[Ge,tt]=this.fieldRenderer.renderFieldValue(Z.projectedResource,xe,Z);Je&&Ge&&tt?(tt.classList.add("label-content"),Je.appendChild(tt),Je.classList.add("not-empty")):Je&&Je.classList.remove("not-empty")}isParentWithVisibleChildren(Z){if(!this.workPackageTimeline.inHierarchyMode)return!1;const Y=this.workPackageTimeline.workPackageTable.lastRenderPass;return!!Y&&!!Y.parentsWithVisibleChildren[Z.id]}}(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",P.W)],Fe.prototype,"wpTableTimeline",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",class{})],Fe.prototype,"TimezoneService",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",w.y)],Fe.prototype,"schemaCache",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",r.D)],Fe.prototype,"I18n",void 0);class ot extends Fe{get type(){return"milestone"}isEmpty(Z){const Y=h(Z.date);return _.isNaN(Y.valueOf())}canMoveDates(Z){const Y=this.schemaCache.of(Z);return Y.date.writable&&Y.isAttributeEditable("date")}displayPlaceholderUnderCursor(Z,Y){const ce=Math.floor(Z.offsetX/Y.viewParams.pixelPerDay),xe=document.createElement("div");xe.className="timeline-element milestone",xe.style.pointerEvents="none",xe.style.height="1em",xe.style.width="1em",xe.style.left=ce*Y.viewParams.pixelPerDay+"px";const Je=document.createElement("div");return Je.className="diamond",Je.style.left="0.5em",Je.style.height="1em",Je.style.width="1em",xe.appendChild(Je),this.applyTypeColor(Y,Je),xe}assignDateValues(Z,Y,ce){this.assignDate(Z,"date",ce.date),this.updateLabels(!0,Y,Z)}onDaysMoved(Z,Y,ce,xe){const Je=Z.pristineResource.date,Ge={};return Je&&(Ge.date=h(Je).add(ce,"days")),Ge}onMouseDown(Z,Y,ce,xe,Je){if(ce.viewParams.activeSelectionMode)return ce.viewParams.activeSelectionMode(ce.workPackage),Z.preventDefault(),"both";let Ge="both";return this.workPackageTimeline.forceCursor("ew-resize"),Y?(ce.change.projectedResource.date=Y,Ge="create",Ge):(this.updateLabels(!0,xe,ce.change),Ge)}update(Z,Y,ce){const{viewParams:xe}=ce,Je=h(ce.change.projectedResource.date);if(_.isNaN(Je.valueOf()))return!1;const Ge=jQuery(".diamond",Z)[0];Ge.style.width="15px",Ge.style.height="15px",Ge.style.width="15px",Ge.style.height="15px",Ge.style.marginLeft=ce.viewParams.pixelPerDay/2-7.5+"px",this.applyTypeColor(ce,Ge);const tt=Je.diff(xe.dateDisplayStart,"days");return Z.style.left=`${(0,ke.lW)(xe,tt)}px`,Y&&this.updateLabels(!1,Y,ce.change),this.checkForActiveSelectionMode(ce,Ge),!0}getMarginLeftOfLeftSide(Z){const{change:Y}=Z,xe=h(Y.projectedResource.date).diff(Z.viewParams.dateDisplayStart,"days");return(0,ke.lW)(Z.viewParams,xe)}getMarginLeftOfRightSide(Z){return this.getMarginLeftOfLeftSide(Z)+Z.viewParams.pixelPerDay}getPaddingLeftForIncomingRelationLines(Z){return Z.viewParams.pixelPerDay/2-1}getPaddingRightForOutgoingRelationLines(Z){return 7.5}render(Z){const Y=document.createElement("div");Y.className=`${ke.mN} ${this.type}`;const ce=document.createElement("div");return ce.className="diamond",Y.appendChild(ce),Y}createAndAddLabels(Z,Y){const ce=document.createElement("div");ce.classList.add(te,re),Y.appendChild(ce);const xe=document.createElement("div");xe.classList.add(ee),Y.appendChild(xe);const Je=document.createElement("div");Je.classList.add(G,re),xe.appendChild(Je);const Ge=document.createElement("div");Ge.classList.add(he,re),xe.appendChild(Ge);const tt=document.createElement("div");tt.classList.add(me,ae,_e),Y.appendChild(tt);const ze=document.createElement("div");ze.classList.add(se,ae,_e),Y.appendChild(ze);const _t=new ye(null,ce,ze,Je,tt,Ge,Z.withAlternativeLabels);return this.updateLabels(!1,_t,Z.change),_t}renderHoverLabels(Z,Y){Z.withAlternativeLabels?(this.renderLabel(Y,Z,"leftHover","date"),this.renderLabel(Y,Z,"rightHover","subject")):this.renderLabel(Y,Z,"rightHover","date")}updateLabels(Z,Y,ce){const xe=this.wpTableTimeline.getNormalizedLabels(ce.projectedResource);Z||(Y.withAlternativeLabels?this.renderLabel(ce,Y,"right","subject"):"startDate"===xe.left&&"dueDate"===xe.right?(this.renderLabel(ce,Y,"left",null),this.renderLabel(ce,Y,"right","date")):(this.renderLabel(ce,Y,"left",xe.left),this.renderLabel(ce,Y,"right",xe.right)),this.renderLabel(ce,Y,"farRight",xe.farRight)),this.renderHoverLabels(Y,ce)}renderLabel(Z,Y,ce,xe){("startDate"===xe||"dueDate"===xe)&&(xe="date"),super.renderLabel(Z,Y,ce,xe)}}class it{constructor(Z,Y){this.injector=Z,this.wpTimeline=Y,this.cells={},this.cellRenderers={milestone:new ot(this.injector,Y),generic:new Fe(this.injector,Y)}}hasCell(Z){return this.getCellsFor(Z).length>0}getCellsFor(Z){return _.filter(this.cells,Y=>Y.workPackageId===Z)||[]}refreshAllCells(){this.synchronizeCells(),_.each(this.cells,Z=>this.refreshSingleCell(Z))}refreshCellsFor(Z){_.each(this.getCellsFor(Z),Y=>this.refreshSingleCell(Y))}refreshSingleCell(Z,Y,ce){const xe=this.renderInfoFor(Z.workPackageId,Y,ce);xe.workPackage&&Z.refreshView(xe)}synchronizeCells(){const Z=Object.keys(this.cells),Y=[];_.each(this.wpTimeline.workPackageIdOrder,ce=>{const xe=ce.workPackageId;if(!xe||this.states.workPackages.get(xe).isPristine())return;const Ge=ce.classIdentifier;this.cells[Ge]||(this.cells[Ge]=this.buildCell(Ge,xe.toString())),Y.push(Ge)}),_.difference(Z,Y).forEach(ce=>{this.cells[ce].clear(),delete this.cells[ce]})}buildCell(Z,Y){return new Ce(this.injector,this.wpTimeline,this.cellRenderers,this.renderInfoFor(Y),Z,Y)}renderInfoFor(Z,Y,ce){const xe=this.states.workPackages.get(Z).value;return{viewParams:this.wpTimeline.viewParameters,workPackage:xe,change:this.halEditing.changeFor(xe),isDuplicatedCell:Y,withAlternativeLabels:ce}}buildCellsAndRenderOnRow(Z,Y,ce){const xe=Z.map(Je=>this.buildCell(Y,Je));return xe.forEach(Je=>this.refreshSingleCell(Je,ce,!0)),xe}}(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",g.G)],it.prototype,"states",void 0),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",C.l)],it.prototype,"halEditing",void 0);var Ve=t(53457),Ie=t(99676),ue=t(9822),ie=t(3352),R=t(61486),L=t(26942),W=t(18942),oe=t(67749),Oe=t(79174),$=t(2316);class Xe extends L.N{constructor(Z,Y,ce,xe,Je,Ge,tt,ze,_t,dt,gt,ti,Ti){super(),this.injector=Z,this.elementRef=Y,this.states=ce,this.wpTableComponent=xe,this.toastService=Je,this.wpTableTimeline=Ge,this.notificationService=tt,this.wpRelations=ze,this.wpTableHierarchies=_t,this.halEvents=dt,this.querySpace=gt,this.I18n=ti,this.workPackageViewCollapsedGroupsService=Ti,this._viewParameters=new ke.O6,this.disableViewParamsCalculation=!1,this.workPackageIdOrder=[],this.renderers={},this.cellsRenderer=new it(this.injector,this),this.selectionParams={notification:null},this.refreshRequest=(0,l.qH)(),this.collapsedGroupsCellsMap={},this.orderedRows=[]}get commonPipes(){return Z=>Z.pipe(this.untilDestroyed(),(0,a.R)(this.querySpace.stopAllSubscriptions),(0,p.h)(()=>this.initialized&&this.wpTableTimeline.isVisible))}get workPackagesWithGroupHeaderCell(){const Y=this.querySpace.results.value.elements.filter(xe=>this.shouldBeShownInCollapsedGroupHeaders(xe)).map(xe=>xe.id);return this.orderedRows.filter(xe=>Y.includes(xe.workPackageId)&&!this.workPackageIdOrder.includes(xe))}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),this.text={selectionMode:this.I18n.t("js.timelines.selection_mode.notification")},this.outerContainer=this.$element.find(".wp-table-timeline--outer"),this.timelineBody=this.$element.find(".wp-table-timeline--body"),this.wpTableComponent.registerTimeline(this,this.timelineBody[0]),window.addEventListener("wp-resize.timeline",()=>this.refreshRequest.putValue(void 0)),(0,R.aj)([this.querySpace.tableRendered.values$(),this.refreshRequest.changes$(),this.wpTableTimeline.live$()]).pipe(this.commonPipes).subscribe(([Z,Y,ce])=>{this.workPackageIdOrder=Z.filter(xe=>!xe.hidden),this.orderedRows=Z,this.refreshView()}),this.setupManageCollapsedGroupHeaderCells()}workPackageCells(Z){return this.cellsRenderer.getCellsFor(Z)}workPackageIndex(Z){return this.workPackageIdOrder.findIndex(Y=>Y.classIdentifier===Z)}onRefreshRequested(Z,Y){this.renderers[Z]=Y}getAbsoluteLeftCoordinates(){return this.$element.offset().left}getParentScrollContainer(){return this.outerContainer.closest(ue.UX)[0]}get viewParameters(){return this._viewParameters}get inHierarchyMode(){return this.wpTableHierarchies.isEnabled}get initialized(){return this.workPackageTable&&this.querySpace.tableRendered.hasValue()}refreshView(){this.wpTableTimeline.isVisible?(this.wpTableTimeline.isAutoZoom()?this.applyAutoZoomLevel():(this._viewParameters.settings.zoomLevel=this.wpTableTimeline.zoomLevel,this.wpTableTimeline.appliedZoomLevel=this.wpTableTimeline.zoomLevel),(0,ie.IN)("refreshView() in timeline container",()=>{this.outerContainer.css("width","auto"),this.calculateViewParams(this._viewParameters),this.cellsRenderer.refreshAllCells(),_.each(this.renderers,(Y,ce)=>{(0,ie.qu)(`Refreshing timeline member ${ce}`),Y(this._viewParameters)}),this.refreshCollapsedGroupsHeaderCells(this.collapsedGroupsCellsMap,this.cellsRenderer);const Z=this.$element.find(ke.eY)[0].scrollWidth;this.outerContainer.width(Z),setTimeout(()=>{this.querySpace.timelineRendered.next(null)})})):(0,ie.qu)("refreshView() requested, but TL is invisible.")}startAddRelationPredecessor(Z){this.activateSelectionMode(Z.id,Y=>{this.wpRelations.addCommonRelation(Z.id,"follows",Y.id).then(()=>{this.halEvents.push(Z,{eventType:"association",relatedWorkPackage:Y.id,relationType:"follows"})}).catch(ce=>this.notificationService.handleRawError(ce,Y))})}startAddRelationFollower(Z){this.activateSelectionMode(Z.id,Y=>{this.wpRelations.addCommonRelation(Z.id,"precedes",Y.id).then(()=>{this.halEvents.push(Z,{eventType:"association",relatedWorkPackage:Y.id,relationType:"precedes"})}).catch(ce=>this.notificationService.handleRawError(ce,Y))})}getFirstDayInViewport(){const Z=this.getParentScrollContainer(),{scrollLeft:Y}=Z,ce=Math.floor(Y/this.viewParameters.pixelPerDay);return this.viewParameters.dateDisplayStart.clone().add(ce,"days")}getLastDayInViewport(){const Z=this.getParentScrollContainer(),{scrollLeft:Y}=Z,xe=Y+Z.offsetWidth,Je=Math.ceil(xe/this.viewParameters.pixelPerDay)+1;return this.viewParameters.dateDisplayStart.clone().add(Je,"days")}forceCursor(Z){jQuery(`.${ke.mN}`).css("cursor",Z),jQuery(".wp-timeline-cell").css("cursor",Z),jQuery(".hascontextmenu").css("cursor",Z),jQuery(".leftHandle").css("cursor",Z),jQuery(".rightHandle").css("cursor",Z)}resetCursor(){jQuery(`.${ke.mN}`).css("cursor",""),jQuery(".wp-timeline-cell").css("cursor",""),jQuery(".hascontextmenu").css("cursor",""),jQuery(".leftHandle").css("cursor",""),jQuery(".rightHandle").css("cursor","")}resetSelectionMode(){this._viewParameters.activeSelectionMode=null,this._viewParameters.selectionModeStart=null,this.selectionParams.notification&&this.toastService.remove(this.selectionParams.notification),Mousetrap.unbind("esc"),this.$element.removeClass("active-selection-mode"),jQuery(`.${ke.LT}`).removeClass(ke.LT),this.refreshView()}activateSelectionMode(Z,Y){Z=Z.toString(),this._viewParameters.activeSelectionMode=ce=>{Y(ce),this.resetSelectionMode()},this._viewParameters.selectionModeStart=Z,Mousetrap.bind("esc",()=>this.resetSelectionMode()),this.selectionParams.notification=this.toastService.addNotice(this.text.selectionMode),this.$element.addClass("active-selection-mode"),this.refreshView()}calculateViewParams(Z){if(this.disableViewParamsCalculation)return!1;const Y=new ke.O6;let ce=!1;this.getWorkPackagesToCalculateTimelineWidthFrom().forEach(gt=>{const ti=gt.workPackageId;if(!ti)return;const ci=this.states.workPackages.get(ti).value;if(!ci)return;const $t=ci.startDate?h(ci.startDate):Z.now,ii=ci.dueDate?h(ci.dueDate):Z.now,Mn=ci.date?h(ci.date):Z.now;Y.dateDisplayStart=h.min(Y.dateDisplayStart,Z.now,$t,Mn),Y.dateDisplayEnd=h.max(Y.dateDisplayEnd,Z.now,ii,Mn)}),Y.dateDisplayStart=Y.dateDisplayStart.subtract(Z.dayCountForMarginLeft,"days");const Je=this.$element.children().width(),{pixelPerDay:Ge}=Z,tt=Math.ceil(Je/Ge*1.5);Y.dateDisplayEnd=Y.dateDisplayEnd.add(tt,"days"),Y.dateDisplayStart.isSame(this._viewParameters.dateDisplayStart)||(ce=!0,this._viewParameters.dateDisplayStart=Y.dateDisplayStart),Y.dateDisplayEnd.isSame(this._viewParameters.dateDisplayEnd)||(ce=!0,this._viewParameters.dateDisplayEnd=Y.dateDisplayEnd);const dt=[this.getFirstDayInViewport(),this.getLastDayInViewport()];return this._viewParameters.visibleViewportAtCalculationTime=dt,ce}applyAutoZoomLevel(){if(0===this.workPackageIdOrder.length)return;const Z=this.getWorkPackagesToCalculateTimelineWidthFrom(),Y=(0,ke.Nm)(Z,this.states.workPackages,this._viewParameters),ce=this.$element.parent().width()-2*ke.g5;for(const xe of ke.$r){if(ce/(0,ke.GC)(xe)>=Y||xe===_.last(ke.$r))return this._viewParameters.settings.zoomLevel!==xe&&(this._viewParameters.settings.zoomLevel=xe,this.wpTableComponent.timeline.scrollLeft=0),void(this.wpTableTimeline.appliedZoomLevel=xe)}}setupManageCollapsedGroupHeaderCells(){this.workPackageViewCollapsedGroupsService.updates$().pipe(this.commonPipes).subscribe(Z=>{this.manageCollapsedGroupHeaderCells(Z,this.querySpace.results.value.elements,this.collapsedGroupsCellsMap)})}manageCollapsedGroupHeaderCells(Z,Y,ce){const xe=Z.allGroupsChanged,Je=Z.state,Ge=Object.keys(Je);let tt=[];if(Ge.length){if(xe)tt=Ge.filter(ze=>this.shouldManageCollapsedGroupHeaderCells(ze,Z));else{const ze=Z.lastChangedGroup;this.shouldManageCollapsedGroupHeaderCells(ze,Z)&&(tt=[ze])}tt.forEach(ze=>{Je[ze]?this.createCollapsedGroupHeaderCells(ze,Y,ce):this.removeCollapsedGroupHeaderCells(ze,ce)})}}shouldManageCollapsedGroupHeaderCells(Z,Y){const ce=(0,oe.dF)(Z);return this.workPackageViewCollapsedGroupsService.groupTypesWithHeaderCellsWhenCollapsed.includes(ce)&&this.workPackageViewCollapsedGroupsService.groupTypesWithHeaderCellsWhenCollapsed.includes(Y.groupedBy)}createCollapsedGroupHeaderCells(Z,Y,ce){this.removeCollapsedGroupHeaderCells(Z,ce);const xe=(0,oe.yD)(Z),Je=(0,oe.dF)(Z),ze=Y.filter(_t=>_t[Je].id===xe).filter(_t=>this.shouldBeShownInCollapsedGroupHeaders(_t)&&(_t.date||_t.startDate)).map(_t=>_t.id);this.collapsedGroupsCellsMap[Z]=this.cellsRenderer.buildCellsAndRenderOnRow(ze,`group-${Z}-timeline`,!0)}removeCollapsedGroupHeaderCells(Z,Y){Y[Z]&&(Y[Z].forEach(ce=>ce.clear()),Y[Z]=[])}refreshCollapsedGroupsHeaderCells(Z,Y){Object.keys(Z).forEach(ce=>{Z[ce].forEach(Je=>Y.refreshSingleCell(Je,!1,!0))})}shouldBeShownInCollapsedGroupHeaders(Z){return this.workPackageViewCollapsedGroupsService.wpTypesToShowInCollapsedGroupHeaders.some(Y=>Y(Z))}getWorkPackagesToCalculateTimelineWidthFrom(){return[...this.workPackageIdOrder,...this.workPackagesWithGroupHeaderCell]}}Xe.\u0275fac=function(Z){return new(Z||Xe)($.Y36($.zs3),$.Y36($.SBq),$.Y36(g.G),$.Y36(W.c),$.Y36(n.kl),$.Y36(P.W),$.Y36(N.q),$.Y36(Ve.V),$.Y36(Ie.Y),$.Y36(J.J),$.Y36(x.q),$.Y36(r.D),$.Y36(Oe.q))},Xe.\u0275cmp=$.Xpm({type:Xe,selectors:[["wp-timeline-container"]],features:[$.qOj],decls:7,vars:0,consts:[[1,"wp-table-timeline--outer"],[1,"wp-table-timeline--container"],[1,"wp-table-timeline--body"]],template:function(Z,Y){1&Z&&($.TgZ(0,"div",0),$.TgZ(1,"div",1),$._UZ(2,"wp-timeline-header"),$._UZ(3,"wp-timeline-static-elements"),$._UZ(4,"wp-timeline-grid"),$._UZ(5,"wp-timeline-relations"),$._UZ(6,"div",2),$.qZA(),$.qZA())},encapsulation:2});var rt=t(84366),ge=t(55548),be=t(20342),Me=t(77355),Re=t(71562),$e=t(61083),pt=t(82763),vt=(t(55054),t(57119)),Ue=t(15893),Le=t(84335);class Ee extends ge.n{constructor(Z,Y,ce,xe,Je,Ge,tt,ze,_t,dt){super(Z,Y),this.elementRef=Z,this.opContextMenu=Y,this.wpTableColumns=ce,this.wpTableSortBy=xe,this.wpTableGroupBy=Je,this.wpTableHierarchies=Ge,this.opModalService=tt,this.injector=ze,this.I18n=_t,this.confirmDialog=dt,this.text={confirmDelete:{text:this.I18n.t("js.work_packages.table_configuration.sorting_mode.warning"),title:this.I18n.t("js.modals.form_submit.title")}}}open(Z){!this.table.configuration.columnMenuEnabled||(this.buildItems(),this.opContextMenu.show(this,Z))}get locals(){return{showAnchorRight:this.column&&"id"!==this.column.id,contextMenuId:"column-context-menu",items:this.items}}positionArgs(Z){const Y={of:this.$element.find(".generic-table--sort-header-outer")},ce=super.positionArgs(Z);return _.assign(ce,Y),ce}get afterFocusOn(){return this.$element.find(`#${this.column.id}`)}buildItems(){const Z=this.column;this.items=[{hidden:!this.wpTableSortBy.isSortable(Z),linkText:this.I18n.t("js.work_packages.query.sort_descending"),icon:"icon-sort-descending",onClick:Y=>this.wpTableSortBy.isManualSortingMode?(this.confirmDialog.confirm({text:this.text.confirmDelete}).then(()=>(this.wpTableSortBy.setAsSingleSortCriteria(Z,Ue.iV),!0)),!1):(this.wpTableSortBy.addSortCriteria(Z,Ue.iV),!0)},{hidden:!this.wpTableSortBy.isSortable(Z),linkText:this.I18n.t("js.work_packages.query.sort_ascending"),icon:"icon-sort-ascending",onClick:Y=>this.wpTableSortBy.isManualSortingMode?(this.confirmDialog.confirm({text:this.text.confirmDelete}).then(()=>(this.wpTableSortBy.setAsSingleSortCriteria(Z,Ue.S9),!0)),!1):(this.wpTableSortBy.addSortCriteria(Z,Ue.S9),!0)},{hidden:!this.wpTableGroupBy.isGroupable(Z)||this.wpTableGroupBy.isCurrentlyGroupedBy(Z),linkText:this.I18n.t("js.work_packages.query.group"),icon:"icon-group-by",onClick:()=>(this.wpTableHierarchies.isEnabled&&this.wpTableHierarchies.setEnabled(!1),this.wpTableGroupBy.setBy(Z),!0)},{hidden:this.wpTableColumns.isFirst(Z),linkText:this.I18n.t("js.work_packages.query.move_column_left"),icon:"icon-column-left",onClick:()=>(this.wpTableColumns.shift(Z,-1),!0)},{hidden:this.wpTableColumns.isLast(Z),linkText:this.I18n.t("js.work_packages.query.move_column_right"),icon:"icon-column-right",onClick:()=>(this.wpTableColumns.shift(Z,1),!0)},{linkText:this.I18n.t("js.work_packages.query.hide_column"),icon:"icon-delete",onClick:()=>{const Y=this.wpTableColumns.previous(Z)||this.wpTableColumns.next(Z);return this.wpTableColumns.removeColumn(Z),setTimeout(()=>{Y&&jQuery(`#${Y.id}`).focus()}),!0}},{linkText:this.I18n.t("js.work_packages.query.insert_columns"),icon:"icon-columns",onClick:()=>(this.opModalService.show(vt.Q,this.injector,{initialTab:"columns"}),!0)}]}}Ee.\u0275fac=function(Z){return new(Z||Ee)($.Y36($.SBq),$.Y36(be.$),$.Y36(Re.i),$.Y36(pt.q),$.Y36($e.w),$.Y36(Ie.Y),$.Y36(Me.S),$.Y36($.zs3),$.Y36(r.D),$.Y36(Le.D))},Ee.\u0275dir=$.lG2({type:Ee,selectors:[["","opColumnsContextMenu",""]],inputs:{column:["opColumnsContextMenu-column","column"],table:["opColumnsContextMenu-table","table"]},features:[$.qOj]});class st{constructor(Z,Y,ce,xe){this.I18n=Y,this.wpTimelineService=ce,this.workPackageTimelineTableController=xe,this.$element=jQuery(Z.nativeElement)}ngOnInit(){this.workPackageTimelineTableController.onRefreshRequested("header",Z=>this.refreshView(Z))}refreshView(Z){this.innerHeader=this.$element.find(".wp-table-timeline--header-inner"),this.renderLabels(Z)}renderLabels(Z){if(this.activeZoomLevel!==Z.settings.zoomLevel){switch(this.innerHeader.empty(),this.innerHeader.attr("data-current-zoom-level",this.wpTimelineService.zoomLevel),Z.settings.zoomLevel){case"days":return this.renderLabelsDays(Z);case"weeks":return this.renderLabelsWeeks(Z);case"months":return this.renderLabelsMonths(Z);case"quarters":return this.renderLabelsQuarters(Z);case"years":return this.renderLabelsYears(Z)}this.activeZoomLevel=Z.settings.zoomLevel}}renderLabelsDays(Z){this.renderTimeSlices(Z,"month",0,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("MMM YYYY"),ce.classList.add("wp-timeline--header-top-bold-element"),ce.style.height="13px"}),this.renderTimeSlices(Z,"week",13,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("ww"),ce.classList.add("-top-border"),ce.style.height="32px"}),this.renderTimeSlices(Z,"day",23,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("D"),ce.classList.add("-top-border"),ce.style.height="22px"}),this.renderTimeSlices(Z,"day",33,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("dd"),ce.classList.add("wp-timeline--header-day-element")})}renderLabelsWeeks(Z){this.renderTimeSlices(Z,"month",0,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("MMM YYYY"),ce.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(Z,"week",15,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("ww"),ce.classList.add("-top-border"),ce.style.height="22px"}),this.renderTimeSlices(Z,"day",25,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("D"),ce.classList.add("wp-timeline--header-middle-element")})}renderLabelsMonths(Z){this.renderTimeSlices(Z,"year",0,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("YYYY"),ce.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(Z,"month",15,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("MMM"),ce.classList.add("-top-border"),ce.style.height="30px"}),this.renderTimeSlices(Z,"week",25,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("ww"),ce.classList.add("wp-timeline--header-middle-element")})}renderLabelsQuarters(Z){this.renderTimeSlices(Z,"year",0,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("wp-timeline--header-top-bold-element"),ce.innerHTML=Y.format("YYYY")}),this.renderTimeSlices(Z,"quarter",15,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=this.I18n.t("js.timelines.quarter_label",{quarter_number:Y.format("Q")}),ce.classList.add("-top-border"),ce.style.height="30px"}),this.renderTimeSlices(Z,"month",25,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("MMM"),ce.classList.add("wp-timeline--header-middle-element")})}renderLabelsYears(Z){this.renderTimeSlices(Z,"year",0,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("YYYY"),ce.classList.add("wp-timeline--header-top-bold-element")}),this.renderTimeSlices(Z,"quarter",15,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=this.I18n.t("js.timelines.quarter_label",{quarter_number:Y.format("Q")}),ce.classList.add("-top-border"),ce.style.height="30px"}),this.renderTimeSlices(Z,"month",25,Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.innerHTML=Y.format("M"),ce.classList.add("wp-timeline--header-middle-element")})}renderTimeSlices(Z,Y,ce,xe,Je,Ge){const{inViewportAndBoundaries:tt,rest:ze}=(0,ke.kv)(Z,Y,xe,Je);for(const[_t,dt]of tt){const gt=this.addLabelCell();gt.style.top=`${ce}px`,gt.style.left=(0,ke.jr)(Z,_t.diff(xe,"days")),gt.style.width=(0,ke.jr)(Z,dt.diff(_t,"days")+1),Ge(_t,gt)}setTimeout(()=>{for(const[_t,dt]of ze){const gt=this.addLabelCell();gt.style.top=`${ce}px`,gt.style.left=(0,ke.jr)(Z,_t.diff(xe,"days")),gt.style.width=(0,ke.jr)(Z,dt.diff(_t,"days")+1),Ge(_t,gt)}},0)}addLabelCell(){const Z=document.createElement("div");return Z.className=ke.bz,this.innerHeader.append(Z),Z}}st.\u0275fac=function(Z){return new(Z||st)($.Y36($.SBq),$.Y36(r.D),$.Y36(P.W),$.Y36(Xe))},st.\u0275cmp=$.Xpm({type:st,selectors:[["wp-timeline-header"]],decls:2,vars:0,consts:[[1,"wp-table-timeline--header"],[1,"wp-table-timeline--header-inner"]],template:function(Z,Y){1&Z&&($.TgZ(0,"div",0),$._UZ(1,"div",1),$.qZA())},encapsulation:2});var ut=t(33927);function It(Ne){return`__tl-relation-${Ne}`}class Zt{constructor(Z,Y){this.belongsToId=Z,this.relation=Y}get classNames(){return[It(this.relation.ids.from),It(this.relation.ids.to)]}}const jt="relation-line";function Dt(Ne,Z,Y,ce,xe,Je,Ge,tt){const ze=document.createElement("div");return ze.classList.add(ke.mN,jt,...Z),ze.style.top=`${40*Y+ce}px`,ze.style.left=`${xe}px`,ze.style.width=`${Je}px`,ze.style.height=`${Ge}px`,ze}class bt extends L.N{constructor(Z,Y,ce,xe,Je,Ge){super(),this.injector=Z,this.elementRef=Y,this.states=ce,this.workPackageTimelineTableController=xe,this.wpTableTimeline=Je,this.wpRelations=Ge,this.workPackagesWithRelations={}}ngOnInit(){const Z=jQuery(this.elementRef.nativeElement);this.container=Z.find(".wp-table-timeline--relations"),this.workPackageTimelineTableController.onRefreshRequested("relations",Y=>this.refreshView()),this.setupRelationSubscription()}refreshView(){this.update()}get workPackageIdOrder(){return this.workPackageTimelineTableController.workPackageIdOrder}setupRelationSubscription(){(0,R.aj)([this.querySpace.renderedWorkPackages.values$(),this.wpTableTimeline.live$()]).pipe((0,p.h)(([Z,Y])=>Y.visible),this.untilDestroyed(),(0,ut.U)(([Z,Y])=>Z)).subscribe(Z=>{const Y=_.compact(Z.map(ce=>ce.workPackageId));this.wpRelations.requireAll(Y),Y.forEach(ce=>{const xe=this.wpRelations.state(ce);this.workPackagesWithRelations[ce]=xe,xe.values$().pipe((0,b.q)(1)).subscribe(()=>{this.renderWorkPackagesRelations([ce])})})}),this.states.workPackages.observeChange().pipe(this.untilDestroyed(),(0,p.h)(()=>this.wpTableTimeline.isVisible)).subscribe(([Z])=>{this.renderWorkPackagesRelations([Z])})}renderWorkPackagesRelations(Z){Z.forEach(Y=>{const ce=this.workPackagesWithRelations[Y];if(_.isNil(ce))return;this.removeRelationElementsForWorkPackage(Y);const xe=_.values(ce.value);_.values(xe).forEach(Ge=>{if("precedes"!==Ge.type&&"follows"!==Ge.type)return;const tt=new Zt(Ge.ids.from,Ge);this.renderElement(this.workPackageTimelineTableController.viewParameters,tt)})})}update(){this.removeAllVisibleElements(),this.renderElements()}removeRelationElementsForWorkPackage(Z){const Y=It(Z);this.container.find(`.${Y}`).remove()}removeAllVisibleElements(){this.container.find(`.${jt}`).remove()}renderElements(){const Z=_.keys(this.workPackagesWithRelations);this.renderWorkPackagesRelations(Z)}renderElement(Z,Y){const ce=Y.relation.ids,xe=this.workPackageTimelineTableController.workPackageCells(ce.to),Je=this.workPackageTimelineTableController.workPackageCells(ce.from);0===xe.length||0===Je.length||xe.forEach(Ge=>{const tt=this.workPackageTimelineTableController.workPackageIndex(Ge.classIdentifier);Je.forEach(ze=>{const _t=this.workPackageTimelineTableController.workPackageIndex(ze.classIdentifier);this.renderRelation(Z,Y,tt,_t,Ge,ze)})})}renderRelation(Z,Y,ce,xe,Je,Ge){const tt=this.workPackageIdOrder[ce],ze=this.workPackageIdOrder[xe];if(!tt||!ze||tt.hidden||ze.hidden||!Je.canConnectRelations()||!Ge.canConnectRelations())return;const _t=Je.getMarginLeftOfRightSide()-Je.getPaddingRightForOutgoingRelationLines(),dt=Ge.getMarginLeftOfLeftSide()+Ge.getPaddingLeftForIncomingRelationLines(),gt=ce<xe?"toDown":"toUp",ti=dt>_t?"toRight":dt<_t?"toLeft":"beneath";if(!Je)return;const Ti=Je.getPaddingRightForOutgoingRelationLines(),ci=Ge.getPaddingLeftForIncomingRelationLines()+(Ti>0?Ti:0);this.container.append(Dt(0,Y.classNames,ce,19,_t,ci,1));const $t=_t+ci,ii=Math.abs(xe-ce);"toDown"===gt?"toRight"===ti||"beneath"===ti?this.container.append(Dt(0,Y.classNames,ce,19,$t,1,40*ii)):"toLeft"===ti&&this.container.append(Dt(0,Y.classNames,ce,19,$t,1,40*ii-10)):"toUp"===gt&&this.container.append(Dt(0,Y.classNames,xe,30,$t,1,40*ii-10)),"toRight"===ti?"toDown"===gt?this.container.append(Dt(0,Y.classNames,xe,19,$t,dt-$t,1)):"toUp"===gt&&(this.container.append(Dt(0,Y.classNames,xe,20,$t,1,10)),this.container.append(Dt(0,Y.classNames,xe,20,$t,dt-$t,1))):"toLeft"===ti&&("toDown"===gt?(this.container.append(Dt(0,Y.classNames,xe,0,$t,1,8)),this.container.append(Dt(0,Y.classNames,xe,8,dt,$t-dt,1)),this.container.append(Dt(0,Y.classNames,xe,8,dt,1,11))):"toUp"===gt&&(this.container.append(Dt(0,Y.classNames,xe,30,dt+1,$t-dt,1)),this.container.append(Dt(0,Y.classNames,xe,19,dt+1,1,11))))}}bt.\u0275fac=function(Z){return new(Z||bt)($.Y36($.zs3),$.Y36($.SBq),$.Y36(g.G),$.Y36(Xe),$.Y36(P.W),$.Y36(Ve.V))},bt.\u0275cmp=$.Xpm({type:bt,selectors:[["wp-timeline-relations"]],features:[$.qOj],decls:1,vars:0,consts:[[1,"wp-table-timeline--relations"]],template:function(Z,Y){1&Z&&$._UZ(0,"div",0)},encapsulation:2}),(0,d.gn)([(0,y.W)(),(0,d.w6)("design:type",x.q)],bt.prototype,"querySpace",void 0);const Lt="wp-timeline--static-element";class Rt extends class{constructor(){}render(Z){const Y=document.createElement("div");return Y.id=this.identifier,Y.classList.add(...this.classNames),this.finishElement(Y,Z)}get classNames(){return[Lt]}}{finishElement(Z,Y){const ce=Y.now.diff(Y.dateDisplayStart,"days"),xe=h().hour()/24;return Z.style.left=(0,ke.jr)(Y,ce+xe),Z}get identifier(){return"wp-timeline-static-element-today-line"}}class xt{constructor(Z,Y,ce){this.states=Y,this.workPackageTimelineTableController=ce,this.$element=Z.nativeElement,this.elements=[new Rt]}ngOnInit(){this.container=this.$element.querySelector(".wp-table-timeline--static-elements"),this.workPackageTimelineTableController.onRefreshRequested("static elements",Z=>this.update(Z))}update(Z){this.removeAllVisibleElements(),this.renderElements(Z)}removeAllVisibleElements(){this.container.querySelectorAll(`.${Lt}`).forEach(Z=>Z.remove())}renderElements(Z){for(const Y of this.elements)this.container.appendChild(Y.render(Z))}}function Mt(Ne,Z){const Y=Ne.day();(0===Y||6===Y)&&Z.classList.add("grid-weekend")}xt.\u0275fac=function(Z){return new(Z||xt)($.Y36($.SBq),$.Y36(g.G),$.Y36(Xe))},xt.\u0275cmp=$.Xpm({type:xt,selectors:[["wp-timeline-static-elements"]],decls:1,vars:0,consts:[[1,"wp-table-timeline--static-elements"]],template:function(Z,Y){1&Z&&$._UZ(0,"div",0)},encapsulation:2});class wt{constructor(Z,Y){this.elementRef=Z,this.wpTimeline=Y}ngAfterViewInit(){const Z=jQuery(this.elementRef.nativeElement);this.gridContainer=Z.find(".wp-table-timeline--grid"),this.wpTimeline.onRefreshRequested("grid",Y=>this.refreshView(Y))}refreshView(Z){this.renderLabels(Z)}renderLabels(Z){if(this.activeZoomLevel!==Z.settings.zoomLevel){switch(this.gridContainer.empty(),Z.settings.zoomLevel){case"days":return this.renderLabelsDays(Z);case"weeks":return this.renderLabelsWeeks(Z);case"months":return this.renderLabelsMonths(Z);case"quarters":return this.renderLabelsQuarters(Z);case"years":return this.renderLabelsYears(Z)}this.activeZoomLevel=Z.settings.zoomLevel}}renderLabelsDays(Z){this.renderTimeSlices(Z,"day",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.style.paddingTop="1px",Mt(Y,ce)}),this.renderTimeSlices(Z,"year",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("-grid-highlight"),ce.style.zIndex="2"})}renderLabelsWeeks(Z){this.renderTimeSlices(Z,"day",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{Mt(Y,ce)}),this.renderTimeSlices(Z,"week",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("-grid-highlight")}),this.renderTimeSlices(Z,"year",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("-grid-highlight"),ce.style.zIndex="2"})}renderLabelsMonths(Z){this.renderTimeSlices(Z,"week",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{}),this.renderTimeSlices(Z,"month",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("-grid-highlight")}),this.renderTimeSlices(Z,"year",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("-grid-highlight"),ce.style.zIndex="2"})}renderLabelsQuarters(Z){this.renderTimeSlices(Z,"month",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{}),this.renderTimeSlices(Z,"quarter",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("-grid-highlight")}),this.renderTimeSlices(Z,"year",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("-grid-highlight"),ce.style.zIndex="2"})}renderLabelsYears(Z){this.renderTimeSlices(Z,"month",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{}),this.renderTimeSlices(Z,"year",Z.dateDisplayStart,Z.dateDisplayEnd,(Y,ce)=>{ce.classList.add("-grid-highlight")})}renderTimeSlices(Z,Y,ce,xe,Je){const{inViewportAndBoundaries:Ge,rest:tt}=(0,ke.kv)(Z,Y,ce,xe);for(const[ze,_t]of Ge){const dt=document.createElement("div");dt.classList.add(ke.mN,ke.oo),dt.style.left=(0,ke.jr)(Z,ze.diff(ce,"days")),dt.style.width=(0,ke.jr)(Z,_t.diff(ze,"days")+1),this.gridContainer[0].appendChild(dt),Je(ze,dt)}setTimeout(()=>{for(const[ze,_t]of tt){const dt=document.createElement("div");dt.classList.add(ke.mN,ke.oo),dt.style.left=(0,ke.jr)(Z,ze.diff(ce,"days")),dt.style.width=(0,ke.jr)(Z,_t.diff(ze,"days")+1),this.gridContainer[0].appendChild(dt),Je(ze,dt)}},0)}}wt.\u0275fac=function(Z){return new(Z||wt)($.Y36($.SBq),$.Y36(Xe))},wt.\u0275cmp=$.Xpm({type:wt,selectors:[["wp-timeline-grid"]],decls:1,vars:0,consts:[[1,"wp-table-timeline--grid"]],template:function(Z,Y){1&Z&&$._UZ(0,"div",0)},encapsulation:2});var Jt=t(31283),Ze=t(18236),ne=(t(84481),t(51017)),K=t(3742),de=t(2775);class He{constructor(Z,Y){this.I18n=Z,this.panelCtrl=Y}ngOnInit(){this.text={remove:this.I18n.t("js.label_remove_watcher",{name:this.watcher.name})}}remove(){this.panelCtrl.removeWatcher(this.watcher)}}He.\u0275fac=function(Z){return new(Z||He)($.Y36(r.D),$.Y36(Ze.h))},He.\u0275cmp=$.Xpm({type:He,selectors:[["op-wp-watcher-entry"]],inputs:{watcher:"watcher"},decls:5,vars:3,consts:[["opFocusWithin","button",1,"op-wp-watcher","form--selected-value--container"],[1,"op-wp-watcher--form","form--selected-value"],["size","mini","data-qa-selector","op-wp-watcher-name",3,"principal","link"],["type","button",1,"spot-link","form--selected-value--remover",3,"title","click"],["icon-classes","icon-remove"]],template:function(Z,Y){1&Z&&($.TgZ(0,"div",0),$.TgZ(1,"span",1),$._UZ(2,"op-principal",2),$.qZA(),$.TgZ(3,"button",3),$.NdJ("click",function(){return Y.remove()}),$._UZ(4,"op-icon",4),$.qZA(),$.qZA()),2&Z&&($.xp6(2),$.Q6J("principal",Y.watcher)("link",!0),$.xp6(1),$.Q6J("title",Y.text.remove))},directives:[ne.N,K.N,de.o],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-watcher--form[_ngcontent-%COMP%]{display:inline-block;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}"],changeDetection:0});var ht=t(97779),yt=t(82271),St=t(72184);class Et{constructor(Z,Y,ce,xe,Je,Ge,tt,ze){this.injector=Z,this.elementRef=Y,this.querySpace=ce,this.states=xe,this.schemaCache=Je,this.wpTableColumns=Ge,this.wpTableSums=tt,this.I18n=ze,this.isHidden=!0,this.text={sum:ze.t("js.label_total_sum")}}ngAfterViewInit(){this.element=this.elementRef.nativeElement,(0,R.aj)([this.wpTableColumns.live$(),this.wpTableSums.live$(),this.querySpace.results.values$()]).pipe((0,a.R)(this.querySpace.stopAllSubscriptions)).subscribe(([Z,Y,ce])=>{this.isHidden=!Y,Y&&ce.sumsSchema?this.schemaCache.ensureLoaded(ce.sumsSchema.href).then(xe=>{this.refresh(Z,ce,xe)}):this.clear()})}clear(){this.element.innerHTML=""}refresh(Z,Y,ce){this.clear(),this.render(Z,Y,ce)}render(Z,Y,ce){this.groupSumsBuilder=new St.L(this.injector,this.workPackageTable),this.groupSumsBuilder.text=this.text,this.groupSumsBuilder.renderColumns(Y.totalSums,this.element)}}Et.\u0275fac=function(Z){return new(Z||Et)($.Y36($.zs3),$.Y36($.SBq),$.Y36(x.q),$.Y36(g.G),$.Y36(w.y),$.Y36(Re.i),$.Y36(yt.X),$.Y36(r.D))},Et.\u0275dir=$.lG2({type:Et,selectors:[["","wpTableSumsRow",""]],hostVars:2,hostBindings:function(Z,Y){2&Z&&$.ekj("-hidden",Y.isHidden)},inputs:{workPackageTable:["wpTableSumsRow-table","workPackageTable"]}});var je=t(5275),le=t(74961),B=t(97354),pe=t(84939),De=t(54892),qe=t(74012),ct=t(70233),Pt=(t(24897),t(55977)),nt=t(23893),Se=t(8403),Pe=t(97248),We=t(32869),lt=(t(17577),t(10190)),ft=t(54364),kt=t(166);function Ft(Ne,Z){if(1&Ne&&($.TgZ(0,"div",4),$.TgZ(1,"div",5),$._UZ(2,"h3",6),$.qZA(),$.qZA()),2&Ne){const Y=$.oxw(2);$.xp6(2),$.Q6J("textContent",Y.group.name)}}const qt=function(Ne){return{actionsColumnEnabled:!0,hierarchyToggleEnabled:!1,inlineCreateEnabled:!0,compactTableStyle:!0,columnMenuEnabled:!1,contextMenuEnabled:!1,projectIdentifier:Ne,projectContext:!1}};function Xt(Ne,Z){if(1&Ne){const Y=$.EpF();$.ynx(0),$.YNc(1,Ft,3,1,"div",1),$.TgZ(2,"wp-embedded-table",2,3),$.NdJ("onQueryLoaded",function(xe){return $.CHM(Y),$.oxw().handleQueryLoaded(xe)}),$.qZA(),$.BQk()}if(2&Ne){const Y=$.oxw();$.xp6(1),$.Q6J("ngIf",Y.group),$.xp6(1),$.Q6J("initialLoadingIndicator",!1)("queryProps",Y.queryProps)("tableActions",Y.tableActions)("configuration",$.VKq(5,qt,Y.idFromLink(Y.workPackage.project.href)))}}class Ht extends Pe.y{constructor(Z,Y,ce,xe,Je,Ge,tt){super(Je),this.PathHelper=Z,this.wpInlineCreate=Y,this.wpRelations=ce,this.halEvents=xe,this.queryUrlParamsHelper=Je,this.notificationService=Ge,this.I18n=tt,this.tableActions=[nt.g.factoryFor("remove-relation-action",this.I18n.t("js.relation_buttons.remove"),ze=>{!this.embeddedTable||(this.embeddedTable.loadingIndicator=this.wpRelations.require(ze.id).then(()=>this.wpInlineCreate.remove(this.workPackage,ze)).then(()=>this.refreshTable()).catch(_t=>this.notificationService.handleRawError(_t,this.workPackage)))},ze=>!!ze.changeParent)],this.idFromLink=lt.Z}ngOnInit(){const Z=this.getRelationTypeFromQuery();this.wpInlineCreate.referenceTarget=this.workPackage,this.wpInlineCreate.relationType=Z,this.queryProps=this.buildQueryProps(),this.wpInlineCreate.newInlineWorkPackageCreated.pipe(this.untilDestroyed()).subscribe(Y=>this.addRelation(Y)),this.wpRelations.observe(this.workPackage.id).pipe((0,p.h)(Y=>!_.isEmpty(Y)),this.untilDestroyed()).subscribe(()=>this.refreshTable())}addRelation(Z){this.wpInlineCreate.add(this.workPackage,Z).then(()=>{this.halEvents.push(this.workPackage,{eventType:"association",relatedWorkPackage:Z,relationType:this.getRelationTypeFromQuery()})}).catch(Y=>this.notificationService.handleRawError(Y,this.workPackage))}getRelationTypeFromQuery(){return this.group.relationType}}Ht.\u0275fac=function(Z){return new(Z||Ht)($.Y36(ct.j),$.Y36(Se.m),$.Y36(Ve.V),$.Y36(J.J),$.Y36(Pt.Z),$.Y36(N.q),$.Y36(r.D))},Ht.\u0275cmp=$.Xpm({type:Ht,selectors:[["wp-relation-query"]],inputs:{workPackage:"workPackage",query:"query",group:"group"},features:[$._Bn([{provide:Se.m,useClass:We.x}]),$.qOj],decls:1,vars:1,consts:[[4,"ngIf"],["class","attributes-group--header",4,"ngIf"],[3,"initialLoadingIndicator","queryProps","tableActions","configuration","onQueryLoaded"],["embeddedTable",""],[1,"attributes-group--header"],[1,"attributes-group--header-container"],[1,"attributes-group--header-text",3,"textContent"]],template:function(Z,Y){1&Z&&$.YNc(0,Xt,4,7,"ng-container",0),2&Z&&$.Q6J("ngIf",!Y.hidden)},directives:[ft.O5,kt.Z],encapsulation:2});var ei=t(19866),ni=t(91488),oi=t(70795);class di{constructor(Z,Y,ce,xe){this.I18n=Z,this.injector=Y,this.opModalService=ce,this.opContextMenu=xe}ngOnInit(){this.text={configureTable:I18n.t("js.toolbar.settings.configure_view")}}openTableConfigurationModal(){this.opContextMenu.close(),this.opModalService.show(vt.Q,this.injector)}}di.\u0275fac=function(Z){return new(Z||di)($.Y36(r.D),$.Y36($.zs3),$.Y36(Me.S),$.Y36(be.$))},di.\u0275cmp=$.Xpm({type:di,selectors:[["wp-table-config-menu"]],decls:2,vars:1,consts:[["type","button",1,"spot-link","wp-table--columns-selection",3,"title","click"],["icon-classes","icon-button icon-small icon-no-color icon-settings"]],template:function(Z,Y){1&Z&&($.TgZ(0,"button",0),$.NdJ("click",function(){return Y.openTableConfigurationModal()}),$._UZ(1,"op-icon",1),$.qZA()),2&Z&&$.Q6J("title",Y.text.configureTable)},directives:[de.o],encapsulation:2});var Ri=t(71718),gi=t(55749),rn=t(37409),fi=t(74990),pi=t(84906),Zi=t(32853),vi=t(5282),Yt=t(53875);class ui{}ui.\u0275fac=function(Z){return new(Z||ui)},ui.\u0275mod=$.oAB({type:ui}),ui.\u0275inj=$.cJS({imports:[[ft.ez,pi.UIRouterModule,Zi.wA,vi.l,Yt.Q]]});var Hi=t(45755),Ki=t(87947),an=(t(77180),t(61342)),cn=t(82516),si=t(80639),ki=t(35403),xi=t(83845),ln=t(54262);function Ci(Ne,Z){1&Ne&&($.TgZ(0,"span",10),$._uU(1," *"),$.qZA())}function Mi(Ne,Z){if(1&Ne&&($.TgZ(0,"div",6),$.TgZ(1,"wp-replacement-label",7),$._uU(2),$.YNc(3,Ci,2,0,"span",8),$.qZA(),$._UZ(4,"attribute-help-text",9),$.qZA()),2&Ne){const Y=$.oxw(2).$implicit;$.xp6(1),$.Q6J("fieldName",Y.name),$.xp6(1),$.hij(" ",Y.label," "),$.xp6(1),$.Q6J("ngIf",Y.field.required&&Y.field.writable),$.xp6(1),$.Q6J("attribute",Y.name)("attributeScope","WorkPackage")}}const ri=function(Ne){return{"wp-edit-formattable-field":Ne}};function _i(Ne,Z){if(1&Ne&&($.TgZ(0,"div",11),$._UZ(1,"editable-attribute-field",12),$.qZA()),2&Ne){const Y=$.oxw(2).$implicit,ce=$.oxw();$.xp6(1),$.Q6J("ngClass",$.VKq(4,ri,Y.field.isFormattable))("resource",ce.workPackage)("isDropTarget",Y.field.isFormattable)("fieldName",ce.fieldName(Y.name))}}function yi(Ne,Z){if(1&Ne&&($.YNc(0,Mi,5,5,"div",4),$.YNc(1,_i,2,6,"div",5)),2&Ne){const Y=$.oxw().$implicit;$.Q6J("ngIf",!Y.multiple&&Y.field),$.xp6(1),$.Q6J("ngIf",!Y.multiple&&Y.field)}}const Ei=function(Ne){return{"-span-all-columns":Ne}};function ai(Ne,Z){if(1&Ne&&($.TgZ(0,"div",2),$.YNc(1,yi,2,2,"ng-template",3),$.qZA()),2&Ne){const Y=Z.$implicit,ce=$.oxw();$.Q6J("ngClass",$.VKq(2,Ei,Y.spanAll)),$.xp6(1),$.Q6J("ngIf",!ce.shouldHideField(Y))}}class Te extends L.N{constructor(Z,Y,ce){super(),this.I18n=Z,this.wpEditForm=Y,this.injector=ce}ngAfterViewInit(){setTimeout(()=>this.fixColumns()),(0,cn.R)(window,"resize",{passive:!0}).pipe(this.untilDestroyed(),(0,si.b)(250)).subscribe(()=>{this.fixColumns()})}trackByName(Z,Y){return Y.name}shouldHideField(Z){const Y=Z.field||Z.fields[0];return this.wpEditForm.editMode&&!Y.writable}fieldName(Z){return"startDate"===Z?"combinedDate":Z}fixColumns(){let Z=0;jQuery(`div.attributes-group:contains(${this.group.name})`).find(".attributes-key-value").each(function(){const ce=jQuery(this).position().top;ce<Z&&jQuery(this).addClass("-column-start"),Z=ce})}}Te.\u0275fac=function(Z){return new(Z||Te)($.Y36(r.D),$.Y36(an.n),$.Y36($.zs3))},Te.\u0275cmp=$.Xpm({type:Te,selectors:[["wp-attribute-group"]],inputs:{workPackage:"workPackage",group:"group"},features:[$.qOj],decls:2,vars:2,consts:[[1,"-columns-2"],["class","attributes-key-value",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[1,"attributes-key-value",3,"ngClass"],[3,"ngIf"],["class","attributes-key-value--key",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"],[1,"attributes-key-value--key"],[3,"fieldName"],["class","required",4,"ngIf"],[3,"attribute","attributeScope"],[1,"required"],[1,"attributes-key-value--value-container"],[3,"ngClass","resource","isDropTarget","fieldName"]],template:function(Z,Y){1&Z&&($.TgZ(0,"div",0),$.YNc(1,ai,2,4,"div",1),$.qZA()),2&Z&&($.xp6(1),$.Q6J("ngForOf",Y.group.members)("ngForTrackBy",Y.trackByName))},directives:[ft.sg,ft.mk,ft.O5,ki.L,xi.y,ln.k],encapsulation:2});var Q=t(94232);class U extends Q.W{setValue(Z,Y){super.setValue(Z,Y),"workPackage"===Z&&this.updateForm()}buildPayloadFromChanges(){const Z=super.buildPayloadFromChanges();return delete Z._links.project,Z}}var we=t(14274),X=t(97661),z=t(76869),V=t(84699),Qe=t(81979),Ke=t(41195);function Ct(Ne,Z){if(1&Ne){const Y=$.EpF();$.TgZ(0,"span",9),$.NdJ("click",function(xe){return $.CHM(Y),$.oxw(2).toggleHierarchy(xe)}),$._UZ(1,"op-icon",10),$.qZA()}if(2&Ne){const Y=$.oxw(2);$.uIk("title",Y.text.toggleHierarchy),$.xp6(1),$.MGl("icon-classes","icon ",Y.hierarchyIcon,"")}}const Nt=function(Ne,Z){return[Ne,Z]};function Kt(Ne,Z){if(1&Ne&&($.TgZ(0,"a",11),$._uU(1),$.qZA()),2&Ne){const Y=$.oxw(2);$.s9C("lang",Y.locale),$.s9C("id",Y.headerColumn.id),$.Q6J("ngClass",$.WLB(4,Nt,Y.directionClass&&"sort",Y.directionClass)),$.xp6(1),$.Oqu(Y.headerColumn.name)}}function Li(Ne,Z){if(1&Ne&&($.TgZ(0,"a"),$._uU(1),$.qZA()),2&Ne){const Y=$.oxw(2);$.xp6(1),$.Oqu(Y.headerColumn.name)}}function dn(Ne,Z){if(1&Ne&&$._UZ(0,"op-icon",12),2&Ne){const Y=$.oxw(2);$.s9C("icon-title",Y.text.openMenu)}}function bi(Ne,Z){if(1&Ne&&($.TgZ(0,"span",4),$.YNc(1,Ct,2,2,"span",5),$.YNc(2,Kt,2,7,"a",6),$.YNc(3,Li,2,1,"a",7),$.YNc(4,dn,1,1,"op-icon",8),$.qZA()),2&Ne){const Y=$.oxw();$.xp6(1),$.Q6J("ngIf",Y.displayHierarchyIcon),$.xp6(1),$.Q6J("ngIf",Y.sortable),$.xp6(1),$.Q6J("ngIf",!Y.sortable),$.xp6(1),$.Q6J("ngIf",Y.displayDropdownIcon)}}function wi(Ne,Z){if(1&Ne&&$._UZ(0,"op-icon",12),2&Ne){const Y=$.oxw(2);$.s9C("icon-title",Y.text.openMenu)}}function Oo(Ne,Z){if(1&Ne&&($.TgZ(0,"span",4),$.TgZ(1,"a"),$._UZ(2,"op-icon",13),$._uU(3),$.qZA(),$.YNc(4,wi,1,1,"op-icon",8),$.qZA()),2&Ne){const Y=$.oxw();$.xp6(1),$.uIk("title",Y.headerColumn.name),$.xp6(2),$.hij(" ",Y.columnName," "),$.xp6(1),$.Q6J("ngIf",Y.displayDropdownIcon)}}function On(Ne,Z){if(1&Ne&&$._UZ(0,"span",14),2&Ne){const Y=$.oxw();$.uIk("title",Y.text.sortColumn)}}function Ys(Ne,Z){if(1&Ne&&($.TgZ(0,"a",11),$._uU(1),$.qZA()),2&Ne){const Y=$.oxw(2);$.s9C("lang",Y.locale),$.s9C("id",Y.headerColumn.id),$.Q6J("ngClass",$.WLB(4,Nt,Y.directionClass&&"sort",Y.directionClass)),$.xp6(1),$.Oqu(Y.headerColumn.name)}}function $s(Ne,Z){if(1&Ne&&($.TgZ(0,"a"),$._uU(1),$.qZA()),2&Ne){const Y=$.oxw(2);$.xp6(1),$.Oqu(Y.headerColumn.name)}}function Vs(Ne,Z){if(1&Ne&&$._UZ(0,"op-icon",12),2&Ne){const Y=$.oxw(2);$.s9C("icon-title",Y.text.openMenu)}}function Hs(Ne,Z){if(1&Ne&&($.TgZ(0,"span",4),$.YNc(1,Ys,2,7,"a",6),$.YNc(2,$s,2,1,"a",7),$.YNc(3,Vs,1,1,"op-icon",8),$.qZA()),2&Ne){const Y=$.oxw();$.xp6(1),$.Q6J("ngIf",Y.sortable),$.xp6(1),$.Q6J("ngIf",!Y.sortable),$.xp6(1),$.Q6J("ngIf",Y.displayDropdownIcon)}}class pn extends L.N{constructor(Z,Y,ce,xe,Je,Ge,tt){super(),this.wpTableHierarchies=Z,this.wpTableSortBy=Y,this.wpTableGroupBy=ce,this.wpTableRelationColumns=xe,this.elementRef=Je,this.cdRef=Ge,this.I18n=tt,this.text={toggleHierarchy:this.I18n.t("js.work_packages.hierarchy.show"),openMenu:this.I18n.t("js.label_open_menu"),sortColumn:"Sorting column"}}ngAfterViewInit(){setTimeout(()=>this.initialize())}initialize(){this.element=jQuery(this.elementRef.nativeElement),(0,R.aj)([this.wpTableSortBy.onReadyWithAvailable(),this.wpTableSortBy.live$()]).pipe(this.untilDestroyed()).subscribe(()=>{const Z=this.wpTableSortBy.current[0];Z&&this.headerColumn.href===Z.column.href?this.currentSortDirection=Z.direction:this.currentSortDirection=null,this.setActiveColumnClass(),this.sortable=this.wpTableSortBy.isSortable(this.headerColumn),this.directionClass=this.getDirectionClass(),this.cdRef.detectChanges()}),this.isHierarchyColumn="subject"===this.headerColumn.id,"sortHandle"===this.headerColumn.id&&(this.columnType="sort"),this.isHierarchyColumn?this.columnType="hierarchy":"toType"===this.wpTableRelationColumns.relationColumnType(this.headerColumn)?(this.columnType="relation",this.columnName=this.headerColumn.type.name):"ofType"===this.wpTableRelationColumns.relationColumnType(this.headerColumn)&&(this.columnType="relation",this.columnName=I18n.t(`js.relation_labels.${this.headerColumn.relationType}`)),this.isHierarchyColumn&&(this.hierarchyIcon="icon-hierarchy",this.isHierarchyDisabled=this.wpTableGroupBy.isEnabled,this.wpTableGroupBy.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.isHierarchyDisabled=this.wpTableGroupBy.isEnabled,this.cdRef.detectChanges()}),this.wpTableHierarchies.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.setHierarchyIcon(),this.cdRef.detectChanges()}),this.setHierarchyIcon()),this.cdRef.detectChanges()}get displayDropdownIcon(){return this.table&&this.table.configuration.columnMenuEnabled}get displayHierarchyIcon(){return this.table&&this.table.configuration.hierarchyToggleEnabled}toggleHierarchy(Z){return this.wpTableHierarchies.toggleState()&&this.wpTableGroupBy.disable(),this.setHierarchyIcon(),Z.stopPropagation(),!1}setHierarchyIcon(){this.wpTableHierarchies.isEnabled?(this.text.toggleHierarchy=I18n.t("js.work_packages.hierarchy.hide"),this.hierarchyIcon="icon-hierarchy"):(this.text.toggleHierarchy=I18n.t("js.work_packages.hierarchy.show"),this.hierarchyIcon="icon-no-hierarchy")}getDirectionClass(){if(!this.currentSortDirection)return"";switch(this.currentSortDirection.href){case Ue.S9:return"asc";case Ue.iV:return"desc";default:return""}}setActiveColumnClass(){this.element.toggleClass("active-column",!!this.currentSortDirection)}}pn.\u0275fac=function(Z){return new(Z||pn)($.Y36(Ie.Y),$.Y36(pt.q),$.Y36($e.w),$.Y36(Ke.a),$.Y36($.SBq),$.Y36($.sBO),$.Y36(r.D))},pn.\u0275cmp=$.Xpm({type:pn,selectors:[["sortHeader"]],inputs:{headerColumn:"headerColumn",locale:"locale",table:"table"},features:[$.qOj],decls:5,vars:4,consts:[[1,"generic-table--sort-header-outer",3,"ngSwitch"],["class","generic-table--sort-header",4,"ngSwitchCase"],["class","draggable-table--sort-header",4,"ngSwitchCase"],["class","generic-table--sort-header",4,"ngSwitchDefault"],[1,"generic-table--sort-header"],["class","hierarchy-header--icon","tabindex","-1","aria-hidden","true",3,"click",4,"ngIf"],["href","#","lang-attribute","",3,"ngClass","lang","id",4,"ngIf"],[4,"ngIf"],["icon-classes","dropdown-indicator icon-small icon-pulldown",3,"icon-title",4,"ngIf"],["tabindex","-1","aria-hidden","true",1,"hierarchy-header--icon",3,"click"],[3,"icon-classes"],["href","#","lang-attribute","",3,"ngClass","lang","id"],["icon-classes","dropdown-indicator icon-small icon-pulldown",3,"icon-title"],["icon-classes","icon-context icon-relations relations-header--icon"],[1,"draggable-table--sort-header"]],template:function(Z,Y){1&Z&&($.TgZ(0,"div",0),$.YNc(1,bi,5,4,"span",1),$.YNc(2,Oo,5,3,"span",1),$.YNc(3,On,1,1,"span",2),$.YNc(4,Hs,4,3,"span",3),$.qZA()),2&Z&&($.Q6J("ngSwitch",Y.columnType),$.xp6(1),$.Q6J("ngSwitchCase","hierarchy"),$.xp6(1),$.Q6J("ngSwitchCase","relation"),$.xp6(1),$.Q6J("ngSwitchCase","sort"))},directives:[ft.RF,ft.n9,ft.ED,ft.O5,de.o,ft.mk],encapsulation:2});var Mo=t(1707),Ks=t(78001),Gs=t(55216);class Ii{constructor(Z){Ii.bootstrapAttributeGroups(Z)}static bootstrapAttributeGroups(Z){if(this.bootstrapAttributeGroupsCalled)return;this.bootstrapAttributeGroupsCalled=!0;const Y=Z.get(u.$);Y.register("attributeGroupComponent",(ce,xe)=>"WorkPackageFormAttributeGroup"===ce.type?Te:(0,V.Z)(xe)||"WorkPackageFormChildrenQueryGroup"!==ce.type?(0,V.Z)(xe)||"WorkPackageFormRelationQueryGroup"!==ce.type?null:Ht:qe.u),Y.register("workPackageAttachmentUploadComponent",()=>we.s),Y.register("workPackageAttachmentListComponent",()=>X.c),Y.register("halResourceChangesetClass",ce=>{switch(ce._type){case"WorkPackage":return gi.G;case"TimeEntry":return U;default:return null}})}}Ii.bootstrapAttributeGroupsCalled=!1,Ii.\u0275fac=function(Z){return new(Z||Ii)($.LFG($.zs3))},Ii.\u0275mod=$.oAB({type:Ii}),Ii.\u0275inj=$.cJS({providers:[N.q,je.W,le.Q,w.y,ei.r,B.R,Ve.V,De.a,Ve.V,pe.W,z.$,J.J],imports:[[i.H,e.E,ht.$,Jt.Z,oi.w,Ri.OpenprojectProjectsModule,c.K,fi.C,ui,Hi.i,vi.l]]}),$.B6R(W.c,[ft.O5,ft.sg,Qe.K,de.o,ft.mk,pn,Ee,di,Et,rt.I,Ki.H,Xe],[]),$.B6R(Xe,[st,xt,wt,bt],[]),$.B6R(Ze.h,[ft.O5,ft.mk,ft.sg,He,Mo._Y,Mo.JL,Mo.F,Ks.U],[]),$.B6R(ni.x,[ft.mk,ft.O5,Zi.B5,Zi.oc,ft.sg,rn.P,Gs.S],[])},57973:(H,D,t)=>{"use strict";t.d(D,{r:()=>A});var i=t(3786),e=t(57810),c=t(34520),u=t(53466),r=t(67727),n=t(62964),h=t(91654),a=t(29161),p=t(96617),l=t(77355),d=t(83635),g=t(77434),C=t(48934),y=t(47775),m=t(2316),E=t(54364),P=t(77616),w=t(84906),x=t(81628),k=t(32853);function b(F,I){if(1&F&&m._UZ(0,"op-back-button",11),2&F){const J=m.oxw();m.Q6J("customBackMethod",J.backButtonCallback)}}function v(F,I){if(1&F&&(m.TgZ(0,"li",15),m._UZ(1,"ndc-dynamic",16),m.qZA()),2&F){const J=m.oxw().$implicit,N=m.oxw(2);m.Q6J("ngClass",J.containerClasses),m.xp6(1),m.Q6J("ndcDynamicComponent",J.component)("ndcDynamicInputs",J.inputs)("ndcDynamicInjector",N.injector)("ndcDynamicOutputs",J.outputs)}}function M(F,I){if(1&F&&(m.ynx(0),m.YNc(1,v,2,5,"li",14),m.BQk()),2&F){const J=I.$implicit;m.xp6(1),m.Q6J("ngIf",!J.show||J.show())}}function S(F,I){if(1&F&&(m.TgZ(0,"ul",12),m.YNc(1,M,2,1,"ng-container",13),m.qZA()),2&F){const J=m.oxw();m.xp6(1),m.Q6J("ngForOf",J.toolbarButtonComponents)}}function O(F,I){if(1&F&&m._UZ(0,"ndc-dynamic",17),2&F){const J=m.oxw();m.Q6J("ndcDynamicComponent",J.filterContainerDefinition.component)("ndcDynamicInputs",J.filterContainerDefinition.inputs)("ndcDynamicOutputs",J.filterContainerDefinition.outputs)("ndcDynamicInjector",J.injector)}}class A extends c._{constructor(){super(...arguments),this.text={jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.pagination"),text_jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.label_pagination")},this.showToolbar=!1,this.toolbarButtonComponents=[],this.filterAllowed=!0,this.currentPartition="-split",this.filterContainerDefinition={component:g.J},this.inviteModal=d.E}ngOnInit(){super.ngOnInit(),this.showToolbarSaveButton=!!this.$state.params.query_props,this.setPartition(this.$state.current),this.removeTransitionSubscription=this.$transitions.onSuccess({},I=>{const J=I.params("to"),N=I.to();this.showToolbarSaveButton=!!J.query_props,this.setPartition(N);const te=this.querySpace.query.value;te&&this.shouldUpdateHtmlTitle()&&this.titleService.setFirstPart(this.queryTitle(te)),this.cdRef.detectChanges()}),this.loadInitialQuery(),this.setupInformationLoadedListener(),this.queryParamListener.observe$.pipe(this.untilDestroyed()).subscribe(()=>{this.currentQuery=void 0,this.refresh(!0,!0)}),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(I=>{this.updateTitle(I),this.currentQuery=I})}setPartition(I){this.currentPartition=I.data&&I.data.partition?I.data.partition:"-split"}setupInformationLoadedListener(){this.querySpace.initialized.values$().pipe((0,u.q)(1)).subscribe(()=>{this.showToolbar=!0,this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy(),this.removeTransitionSubscription(),this.queryParamListener.removeQueryChangeListener()}changeChangesFromTitle(I){this.currentQuery&&(0,C.Z)(this.currentQuery)?this.updateTitleName(I):this.wpListService.create(this.currentQuery,I).finally(()=>{this.toolbarDisabled=!1})}updateTitleName(I){this.toolbarDisabled=!0,this.currentQuery.name=I,this.wpListService.save(this.currentQuery).finally(()=>{this.toolbarDisabled=!1})}updateTitle(I){!I||(this.selectedTitle=this.queryTitle(I),this.titleEditingEnabled=this.authorisationService.can("query","updateImmediately"),this.shouldUpdateHtmlTitle()&&this.titleService.setFirstPart(this.selectedTitle))}refresh(I=!1,J=!1){let N=this.loadQuery(J);return I?(N=N.then(te=>(this.wpStatesInitialization.initialize(te,te.results),this.additionalLoadingTime().then(()=>te))),this.loadingIndicator=N):N=N.then(te=>(this.wpStatesInitialization.initialize(te,te.results),te)),N}openInviteUserModal(){this.opModalService.show(this.inviteModal,"global").closingEvent.subscribe(J=>{console.log("Modal closed!",J)})}loadQuery(I=!1){let J;const N=this.currentQuery;if(I||!N)J=this.loadFirstPage();else{const te=this.wpListService.getPaginationInfo();J=this.wpListService.loadQueryFromExisting(N,te,this.projectIdentifier).toPromise()}return J}loadFirstPage(){return this.currentQuery?this.wpListService.reloadQuery(this.currentQuery,this.projectIdentifier).toPromise():this.wpListService.loadCurrentQueryFromParams(this.projectIdentifier)}additionalLoadingTime(){return Promise.resolve()}set loadingIndicator(I){this.loadingIndicatorService.table.promise=I}shouldUpdateHtmlTitle(){return!0}staticQueryName(I){return this.opStaticQueries.getStaticName(I)}loadInitialQuery(){const I=!this.querySpace.initialized.hasValue();this.loadingIndicator=this.loadQuery(I)}queryTitle(I){return(0,C.Z)(I)?I.name:this.staticQueryName(I)}}A.\u0275fac=function(){let F;return function(J){return(F||(F=m.n5z(A)))(J||A)}}(),A.\u0275cmp=m.Xpm({type:A,selectors:[["ng-component"]],features:[m._Bn([{provide:r.W,useClass:n.q},h.E]),m.qOj],decls:11,vars:8,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["class","op-back-button","linkClass","op-back-button_mobile-full-width",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector",4,"ngIf"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","op-back-button_mobile-full-width",1,"op-back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"]],template:function(I,J){1&I&&(m.TgZ(0,"div",0),m.TgZ(1,"div",1),m.TgZ(2,"div",2),m.YNc(3,b,1,1,"op-back-button",3),m.TgZ(4,"editable-toolbar-title",4),m.NdJ("onSave",function(te){return J.changeChangesFromTitle(te)})("onEmptySubmit",function(){return J.updateTitleName("")}),m.qZA(),m.YNc(5,S,2,1,"ul",5),m.qZA(),m.qZA(),m.TgZ(6,"div",6),m.YNc(7,O,1,4,"ndc-dynamic",7),m.qZA(),m.TgZ(8,"div",8),m._UZ(9,"div",9),m._UZ(10,"div",10),m.qZA(),m.qZA()),2&I&&(m.Q6J("ngClass",J.currentPartition),m.xp6(3),m.Q6J("ngIf",J.backButtonCallback),m.xp6(1),m.Q6J("title",J.selectedTitle)("inFlight",J.toolbarDisabled)("showSaveCondition",J.showToolbarSaveButton)("editable",J.titleEditingEnabled),m.xp6(1),m.Q6J("ngIf",J.showToolbar),m.xp6(2),m.Q6J("ngIf",J.filterContainerDefinition))},directives:[E.mk,E.O5,P.s5,w.UIView,x.W,E.sg,k.B5,k.oc],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr);margin-left:-10px;padding-left:10px;width:calc(100% + 10px)}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{flex-grow:1}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .title-container_editable[_ngcontent-%COMP%]{margin-left:-7px}@media only screen and (max-width: 679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:initial;max-width:100vw;max-height:100%}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;justify-items:start}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .op-back-button[_ngcontent-%COMP%]{grid-column:1/3;grid-row:1/2}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{grid-column:1/2;grid-row:2/3;overflow:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-items[_ngcontent-%COMP%]{grid-column:2/3;grid-row:2/3}}"],changeDetection:0}),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",p.D)],A.prototype,"I18n",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",e.V)],A.prototype,"titleService",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",h.E)],A.prototype,"queryParamListener",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",l.S)],A.prototype,"opModalService",void 0),(0,i.gn)([(0,a.W)(),(0,i.w6)("design:type",y.UIRouterGlobals)],A.prototype,"uiRouterGlobals",void 0)},70482:(H,D,t)=>{"use strict";function i(e,c="details"){return`${e.current.data.baseRoute||""}.${c}`}t.d(D,{W:()=>i})},46430:(H,D,t)=>{"use strict";t.d(D,{Z:()=>P});var i=t(39410),e=t(2316),c=t(54364),u=t(61342),r=t(92092),n=t(77180),h=t(66979),a=t(87947);const p=function(){return["status","type"]};function l(w,x){if(1&w){const k=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"edit-form",2),e.NdJ("onSaved",function(v){return e.CHM(k),e.oxw().onSaved(v)}),e.TgZ(2,"div",3),e.TgZ(3,"div",4),e._UZ(4,"wp-type-status",5),e.TgZ(5,"div",6),e.TgZ(6,"a",7),e.NdJ("click",function(){return e.CHM(k),e.oxw().switchToFullscreen()}),e._UZ(7,"span",8),e.qZA(),e.qZA(),e.qZA(),e._UZ(8,"wp-single-view",9),e.qZA(),e.TgZ(9,"div",10),e.TgZ(10,"wp-edit-actions-bar",11),e.NdJ("onCancel",function(){return e.CHM(k),e.oxw().cancelAndBackToList()}),e.qZA(),e.qZA(),e.TgZ(11,"div",12),e._UZ(12,"wp-resizer",13),e.qZA(),e.qZA(),e.qZA()}if(2&w){const k=e.oxw();e.xp6(1),e.Q6J("resource",k.newWorkPackage)("skippedFields",e.DdM(8,p))("inEditMode",!0),e.xp6(3),e.Q6J("workPackage",k.newWorkPackage),e.xp6(4),e.Q6J("workPackage",k.newWorkPackage)("showProject",k.copying),e.xp6(4),e.Q6J("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class d extends i.I{}d.\u0275fac=function(){let w;return function(k){return(w||(w=e.n5z(d)))(k||d)}}(),d.\u0275cmp=e.Xpm({type:d,selectors:[["wp-new-split-view"]],features:[e.qOj],decls:1,vars:1,consts:[["class","work-packages--details work-packages--new",4,"ngIf"],[1,"work-packages--details","work-packages--new"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"work-packages--details-content","-create-mode"],[1,"work-packages--new-details-header"],[3,"workPackage"],[1,"wp--details--switch-fullscreen-wrapper"],[1,"work-packages-show-view-button","wp--details--switch-fullscreen",3,"click"],[1,"icon-context","icon-to-fullscreen"],[3,"workPackage","showProject"],[1,"work-packages--details-toolbar-container"],[3,"onCancel"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(x,k){1&x&&e.YNc(0,l,13,9,"div",0),2&x&&e.Q6J("ngIf",k.newWorkPackage)},directives:[c.O5,u.n,r.E,n.G,h.Y,a.H],encapsulation:2,changeDetection:0});var g=t(38421),C=t(98722);const y=function(){return["status","type"]};function m(w,x){if(1&w){const k=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"edit-form",2),e.NdJ("onSaved",function(v){return e.CHM(k),e.oxw().onSaved(v)}),e.TgZ(2,"div",3),e.TgZ(3,"div",4),e._UZ(4,"wp-type-status",5),e.TgZ(5,"div",6),e.TgZ(6,"a",7),e.NdJ("click",function(){return e.CHM(k),e.oxw().switchToFullscreen()}),e._UZ(7,"span",8),e.qZA(),e.qZA(),e.qZA(),e._UZ(8,"wp-single-view",9),e.qZA(),e.TgZ(9,"div",10),e.TgZ(10,"wp-edit-actions-bar",11),e.NdJ("onCancel",function(){return e.CHM(k),e.oxw().cancelAndBackToList()}),e.qZA(),e.qZA(),e.TgZ(11,"div",12),e._UZ(12,"wp-resizer",13),e.qZA(),e.qZA(),e.qZA()}if(2&w){const k=e.oxw();e.xp6(1),e.Q6J("resource",k.newWorkPackage)("skippedFields",e.DdM(8,y))("inEditMode",!0),e.xp6(3),e.Q6J("workPackage",k.newWorkPackage),e.xp6(4),e.Q6J("workPackage",k.newWorkPackage)("showProject",k.copying),e.xp6(4),e.Q6J("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}class E extends C.H{}function P(w,x,k,b=d,v,M=!0,S=w){return[{name:`${S}.details`,url:"/details/{workPackageId:[0-9]+}",redirectTo:F=>{const I=F.params("to");return{state:`${S}.details.tabs`,params:Object.assign(Object.assign({},I),{tabIdentifier:"overview"})}},reloadOnSearch:!1,data:{bodyClasses:"router--work-packages-partitioned-split-view-details",menuItem:x,baseRoute:w,newRoute:`${S}.new`,partition:v?"-left-only":"-split",mobileAlternative:M?"work-packages.show":void 0},views:v?{"content-left@^.^":{component:k}}:{"content-right@^.^":{component:k}}},{name:`${S}.details.tabs`,url:"/:tabIdentifier",component:g.t,data:{baseRoute:w,menuItem:x,parent:`${S}.details`,mobileAlternative:M?"work-packages.show":void 0}},{name:`${S}.new`,url:"/create_new?{type:[0-9]+}&{parent_id:[0-9]+}",reloadOnSearch:!1,params:{defaults:{value:null}},data:{partition:"-split",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-partitioned-split-view-new",baseRoute:w,parent:w,mobileAlternative:M?"work-packages.show":void 0},views:{"content-right@^.^":{component:b}}},{name:`${S}.copy`,url:"/details/{copiedFromWorkPackageId:[0-9]+}/copy",views:{"content-right@^.^":{component:E}},reloadOnSearch:!1,data:{baseRoute:w,parent:w,allowMovingInEditMode:!0,bodyClasses:"router--work-packages-partitioned-split-view",menuItem:x,partition:"-split",mobileAlternative:M?"work-packages.show":void 0}}]}E.\u0275fac=function(){let w;return function(k){return(w||(w=e.n5z(E)))(k||E)}}(),E.\u0275cmp=e.Xpm({type:E,selectors:[["wp-copy-split-view"]],features:[e.qOj],decls:1,vars:1,consts:[["class","work-packages--details work-packages--new",4,"ngIf"],[1,"work-packages--details","work-packages--new"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"work-packages--details-content","-create-mode"],[1,"work-packages--new-details-header"],[3,"workPackage"],[1,"wp--details--switch-fullscreen-wrapper"],[1,"work-packages-show-view-button","wp--details--switch-fullscreen",3,"click"],[1,"icon-context","icon-to-fullscreen"],[3,"workPackage","showProject"],[1,"work-packages--details-toolbar-container"],[3,"onCancel"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"]],template:function(x,k){1&x&&e.YNc(0,m,13,9,"div",0),2&x&&e.Q6J("ngIf",k.newWorkPackage)},directives:[c.O5,u.n,r.E,n.G,h.Y,a.H],encapsulation:2,changeDetection:0})},1813:(H,D,t)=>{"use strict";t.d(D,{p:()=>h});var i=t(58034),e=t(2316);class c extends i.a{blockedTransition(p){const l=p.to(),d=p.from(),g=p.params("from"),C=p.params("to");return d.name&&/\.(new|copy)$/.exec(d.name)?!(l.data&&l.data.allowMovingInEditMode):void 0===C.workPackageId||C.workPackageId!==g.workPackageId}}c.\u0275fac=function(){let a;return function(l){return(a||(a=e.n5z(c)))(l||c)}}(),c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac});var u=t(97047),r=t(84906);class h{}h.\u0275fac=function(p){return new(p||h)},h.\u0275cmp=e.Xpm({type:h,selectors:[["work-packages-base"]],features:[e._Bn([{provide:i.a,useClass:c}])],decls:2,vars:0,consts:[["wp-isolated-query-space","",1,"work-packages-page--ui-view"]],template:function(p,l){1&p&&(e.TgZ(0,"div",0),e._UZ(1,"ui-view"),e.qZA())},directives:[u.A,r.UIView],encapsulation:2})},73648:(H,D,t)=>{"use strict";t.d(D,{o:()=>O});var i=t(53466),e=t(64538),c=t(45237),u=t(2888),r=t(67727),n=t(62964),h=t(96617),a=t(43440),p=t(53916),l=t(65146),d=t(74647),g=t(26942),C=t(47775),y=t(84109),m=t(2316),E=t(54364),P=t(18942),w=t(88923),x=t(2770);function k(A,F){1&A&&m._UZ(0,"div",4)}function b(A,F){if(1&A){const I=m.EpF();m.TgZ(0,"wp-table",5),m.NdJ("itemClicked",function(N){return m.CHM(I),m.oxw().handleWorkPackageClicked(N)})("stateLinkClicked",function(N){return m.CHM(I),m.oxw().openStateLink(N)}),m.qZA()}if(2&A){const I=m.oxw();m.Q6J("projectIdentifier",I.CurrentProject.identifier)("configuration",I.wpTableConfiguration)}}const v=function(A){return{"-with-resizer":A}};function M(A,F){if(1&A){const I=m.EpF();m.TgZ(0,"div",6),m.TgZ(1,"wp-grid",7),m.NdJ("itemClicked",function(N){return m.CHM(I),m.oxw().handleWorkPackageCardClicked(N)})("stateLinkClicked",function(N){return m.CHM(I),m.oxw().openStateLink(N)}),m.qZA(),m.qZA()}if(2&A){const I=m.oxw();m.Q6J("ngClass",m.VKq(3,v,I.showResizerInCardView())),m.xp6(1),m.Q6J("configuration",I.wpTableConfiguration)("showResizer",I.showResizerInCardView())}}function S(A,F){1&A&&(m.TgZ(0,"div",8),m._UZ(1,"wp-table-pagination"),m.qZA())}class O extends g.N{constructor(F,I,J,N,te,ee,G,se,me,_e,he,ae){super(),this.I18n=F,this.injector=I,this.$state=J,this.keepTab=N,this.querySpace=te,this.wpViewFilters=ee,this.deviceService=G,this.CurrentProject=se,this.wpDisplayRepresentation=me,this.cdRef=_e,this.elementRef=he,this.ngZone=ae,this.text={jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.pagination"),text_jump_to_pagination:this.I18n.t("js.work_packages.jump_marks.label_pagination"),button_settings:this.I18n.t("js.button_settings")},this.showTableView=!0,this.tableInformationLoaded=!1,this.noResults=!1,this.showResultOverlay$=this.wpViewFilters.incomplete$,this.wpTableConfiguration={dragAndDropEnabled:!0}}ngOnInit(){this.setupInformationLoadedListener(),this.querySpace.query.values$().pipe(this.untilDestroyed()).subscribe(F=>{this.updateViewRepresentation(F),this.noResults=0===F.results.total,this.cdRef.detectChanges()}),this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{const F=this.elementRef.nativeElement.querySelector(".wp-table--row.-checked"),I=this.elementRef.nativeElement.querySelector('[data-qa-selector="op-wp-single-card"].-checked');F&&F.previousSibling&&F.previousSibling.scrollIntoView({block:"start"}),I&&I.scrollIntoView({block:"start"})},0)})}setupInformationLoadedListener(){this.querySpace.initialized.values$().pipe((0,i.q)(1)).subscribe(()=>{this.tableInformationLoaded=!0,this.cdRef.detectChanges()})}showResizerInCardView(){return!1}updateViewRepresentation(F){this.showTableView=!(this.deviceService.isMobile||this.wpDisplayRepresentation.valueFromQuery(F)===u.he)}handleWorkPackageClicked(F){F.double&&this.openInFullView(F.workPackageId)}openStateLink(F){const I={workPackageId:F.workPackageId,focus:!0};"split"===F.requestedState?this.keepTab.goCurrentDetailsState(I):this.keepTab.goCurrentShowState(I)}handleWorkPackageCardClicked(F){this.deviceService.isMobile?this.openInFullView(F.workPackageId):this.handleWorkPackageClicked(F)}openInFullView(F){this.$state.go("work-packages.show",{workPackageId:F})}}O.\u0275fac=function(F){return new(F||O)(m.Y36(h.D),m.Y36(m.zs3),m.Y36(C.StateService),m.Y36(y.p),m.Y36(a.q),m.Y36(d.Z),m.Y36(p.U),m.Y36(l.R),m.Y36(u.ld),m.Y36(m.sBO),m.Y36(m.SBq),m.Y36(m.R0b))},O.\u0275cmp=m.Xpm({type:O,selectors:[["wp-list-view"]],hostAttrs:[1,"op-wp-list-view","work-packages-split-view--tabletimeline-side"],features:[m._Bn([{provide:r.W,useClass:n.q},c.j,e.h]),m.qOj],decls:5,vars:6,consts:[["class","op-wp-list-view--result-overlay",4,"ngIf"],["class","work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked",4,"ngIf"],["class","op-wp-list-view--card-view-container",3,"ngClass",4,"ngIf"],["class","work-packages-split-view--tabletimeline-footer hide-when-print",4,"ngIf"],[1,"op-wp-list-view--result-overlay"],[1,"work-packages-split-view--tabletimeline-content",3,"projectIdentifier","configuration","itemClicked","stateLinkClicked"],[1,"op-wp-list-view--card-view-container",3,"ngClass"],["resizerClass","work-packages-partitioned-page--content-right","resizerStorageKey","openProject-splitViewFlexBasis",3,"configuration","showResizer","itemClicked","stateLinkClicked"],[1,"work-packages-split-view--tabletimeline-footer","hide-when-print"]],template:function(F,I){1&F&&(m.YNc(0,k,1,0,"div",0),m.ALo(1,"async"),m.YNc(2,b,1,2,"wp-table",1),m.YNc(3,M,2,5,"div",2),m.YNc(4,S,2,0,"div",3)),2&F&&(m.Q6J("ngIf",m.lcZ(1,4,I.showResultOverlay$)&&I.showTableView),m.xp6(2),m.Q6J("ngIf",I.tableInformationLoaded&&I.showTableView),m.xp6(1),m.Q6J("ngIf",!I.showTableView),m.xp6(1),m.Q6J("ngIf",I.tableInformationLoaded))},directives:[E.O5,P.c,E.mk,w.b,x.v],pipes:[E.Ov],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-list-view--result-overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0;z-index:900;background-color:#fff;opacity:.5}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]{width:100%;overflow:auto;padding-bottom:5px;scrollbar-color:transparent transparent;scrollbar-width:thin}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.op-wp-list-view--card-view-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}@media screen and (min-width: 679px){.op-wp-list-view--card-view-container.-with-resizer[_ngcontent-%COMP%]{padding-left:10px}}@media screen and (max-width: 679px){.op-wp-list-view--card-view-container[_ngcontent-%COMP%]{min-width:calc(100vw + 10px)}}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]{display:flex;flex:1 1 100%;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}@media screen and (min-width: 679px){.work-packages-split-view--tabletimeline-container.-with-resizer[_ngcontent-%COMP%]{padding-left:10px}}@media screen and (max-width: 679px){.work-packages-split-view--tabletimeline-container[_ngcontent-%COMP%]{min-width:calc(100vw + 10px)}}"],changeDetection:0})},85603:(H,D,t)=>{"use strict";t.d(D,{o:()=>me});var i=t(47775),e=t(48451),c=t(87853),u=t(84732),r=t(84109),n=t(60914),h=t(1818),a=t(67727),p=t(62964),l=t(57014),d=t(50937),g=t(2316),C=t(54364),y=t(70971),m=t(87947),E=t(84312),P=t(61342),w=t(5262),x=t(46669),k=t(84906),b=t(81628),v=t(31021),M=t(12703),S=t(96617),A=(t(24897),t(73905)),F=t(74565),I=t(2775);class J{constructor(he,ae){this.I18n=he,this.halEditing=ae,this.text={button_more:this.I18n.t("js.button_more")}}}function N(_e,he){if(1&_e&&g._UZ(0,"op-back-button",18),2&_e){const ae=g.oxw(3);g.Q6J("customBackMethod",ae.backToList.bind(ae))}}function te(_e,he){if(1&_e&&g._UZ(0,"op-work-package-mark-notification-button",19),2&_e){const ae=g.oxw(3);g.Q6J("workPackage",ae.workPackage)}}function ee(_e,he){if(1&_e&&(g.TgZ(0,"div",7),g._UZ(1,"span",8),g.TgZ(2,"edit-form",9),g.TgZ(3,"div",10),g.TgZ(4,"div",11),g._UZ(5,"wp-breadcrumb",12),g.TgZ(6,"div",13),g.YNc(7,N,1,1,"op-back-button",14),g._UZ(8,"wp-subject",15),g.qZA(),g.qZA(),g.YNc(9,te,1,1,"op-work-package-mark-notification-button",16),g.ALo(10,"async"),g.qZA(),g._UZ(11,"div",17),g.qZA(),g.qZA()),2&_e){const ae=g.oxw(2);g.xp6(1),g.Q6J("opAutofocus",ae.shouldFocus)("textContent",ae.focusAnchorLabel),g.xp6(1),g.Q6J("resource",ae.workPackage),g.xp6(3),g.Q6J("workPackage",ae.workPackage),g.xp6(2),g.Q6J("ngIf",ae.showBackButton()),g.xp6(2),g.Q6J("ngIf",g.lcZ(10,6,ae.displayNotificationsButton$)&&"activity"===ae.keepTab.currentTabIdentifier)}}function G(_e,he){if(1&_e&&(g.TgZ(0,"div",20),g._UZ(1,"wp-details-toolbar",21),g.qZA()),2&_e){const ae=g.oxw(2);g.xp6(1),g.Q6J("workPackage",ae.workPackage)}}function se(_e,he){if(1&_e&&(g.TgZ(0,"div",1),g._UZ(1,"op-wp-tabs",2),g.YNc(2,ee,12,8,"div",3),g.YNc(3,G,2,1,"div",4),g.TgZ(4,"div",5),g._UZ(5,"wp-resizer",6),g.qZA(),g.qZA()),2&_e){const ae=g.oxw();g.xp6(1),g.Q6J("workPackage",ae.workPackage)("view","split"),g.xp6(1),g.Q6J("ngIf",ae.workPackage),g.xp6(1),g.Q6J("ngIf",ae.workPackage),g.xp6(2),g.Q6J("elementClass","work-packages-partitioned-page--content-right")("localStorageKey","openProject-splitViewFlexBasis")}}J.\u0275fac=function(he){return new(he||J)(g.Y36(S.D),g.Y36(M.l))},J.\u0275cmp=g.Xpm({type:J,selectors:[["wp-details-toolbar"]],inputs:{workPackage:"workPackage"},decls:5,vars:5,consts:[[1,"work-packages--details-toolbar"],[3,"workPackage","showText"],["wpSingleContextMenu","",1,"button","dropdown-relative",3,"wpSingleContextMenu-workPackage"],[1,"button--text",3,"textContent"],["icon-classes","button--dropdown-indicator"]],template:function(he,ae){1&he&&(g.TgZ(0,"div",0),g._UZ(1,"wp-watcher-button",1),g.TgZ(2,"button",2),g._UZ(3,"span",3),g._UZ(4,"op-icon",4),g.qZA(),g.qZA()),2&he&&(g.xp6(1),g.Q6J("workPackage",ae.workPackage)("showText",!0),g.xp6(1),g.Q6J("wpSingleContextMenu-workPackage",ae.workPackage),g.uIk("accesskey",7),g.xp6(1),g.Q6J("textContent",ae.text.button_more))},directives:[A.u,F.B,I.o],encapsulation:2});class me extends h.e{constructor(he,ae,re,ye,Ce,ke,Ae,Fe){super(he,Ae.params.workPackageId),this.injector=he,this.states=ae,this.firstRoute=re,this.keepTab=ye,this.wpTableSelection=Ce,this.wpTableFocus=ke,this.$state=Ae,this.backRouting=Fe,this.baseRoute=this.$state.current.data.baseRoute}ngOnInit(){this.observeWorkPackage();const he=this.$state.params.workPackageId;if(this.wpTableFocus.focusedWorkPackage)this.wpTableFocus.updateFocus(he,!1);else{const re=this.firstRoute.name===`${this.baseRoute}.details.overview`,ye=this.firstRoute.params&&he===this.firstRoute.params.workPackageI;this.wpTableFocus.updateFocus(he,re&&ye)}this.wpTableSelection.isEmpty&&this.wpTableSelection.setRowState(he,!0),this.wpTableFocus.whenChanged().pipe(this.untilDestroyed()).subscribe(re=>{he.toString()!==re.toString()&&this.$state.includes(`${this.baseRoute}.details`)&&this.$state.go(this.$state.current.name,{workPackageId:re,focus:!1})})}get shouldFocus(){return!0===this.$state.params.focus}showBackButton(){return this.baseRoute.includes("bim")}backToList(){this.backRouting.goToBaseState()}handleLoadingError(he){const ae=this.notificationService.retrieveErrorMessage(he);this.$state.go(this.baseRoute,{flash_message:{type:"error",message:ae}})}}me.\u0275fac=function(he){return new(he||me)(g.Y36(g.zs3),g.Y36(c.G),g.Y36(u.p),g.Y36(r.p),g.Y36(n.J),g.Y36(e.o),g.Y36(i.StateService),g.Y36(l.Y))},me.\u0275cmp=g.Xpm({type:me,selectors:[["op-wp-split-view"]],features:[g._Bn([d.O,{provide:a.W,useClass:p.q}]),g.qOj],decls:1,vars:1,consts:[["class","work-packages--details loading-indicator--location","data-indicator-name","wpDetails",4,"ngIf"],["data-indicator-name","wpDetails",1,"work-packages--details","loading-indicator--location"],[3,"workPackage","view"],["class","work-packages--details-content work-packages-tab-view--overflow",4,"ngIf"],["class","work-packages--details-toolbar-container",4,"ngIf"],[1,"work-packages--details--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"],[1,"work-packages--details-content","work-packages-tab-view--overflow"],["tabindex","-1",1,"hidden-for-sighted",3,"opAutofocus","textContent"],[1,"work-packages--details-form",3,"resource"],[1,"work-packages--details-header"],[1,"work-packages--details-header-left"],[1,"work-packages--breadcrumb",3,"workPackage"],[1,"wp-show--header-container"],["linkClass","work-packages-back-button",3,"customBackMethod",4,"ngIf"],[1,"subject-header"],["class","work-packages--details-button","buttonClasses","-round","data-qa-selector","mark-notification-read-button",3,"workPackage",4,"ngIf"],["data-notification-selector","notification-scroll-container","ui-view","",1,"work-package-details-tab"],["linkClass","work-packages-back-button",3,"customBackMethod"],["buttonClasses","-round","data-qa-selector","mark-notification-read-button",1,"work-packages--details-button",3,"workPackage"],[1,"work-packages--details-toolbar-container"],[3,"workPackage"]],template:function(he,ae){1&he&&g.YNc(0,se,6,6,"div",0),2&he&&g.Q6J("ngIf",ae.workPackage)},directives:[C.O5,y.e,m.H,E.U,P.n,w.f,x.x,k.UIView,b.W,v.q,J],pipes:[C.Ov],encapsulation:2,changeDetection:0})},55236:(H,D,t)=>{"use strict";t.d(D,{m:()=>e,A:()=>c});const e=new(t(2316).OlP)("CardEventHandler");class c{constructor(r){this.injector=r}attachTo(r){this.eventHandlers.map(n=>{const h=n(r);return h.eventScope(r).on(h.EVENT,h.SELECTOR,p=>{h.handleEvent(r,p)}),h})}}},50937:(H,D,t)=>{"use strict";t.d(D,{O:()=>w});var i=t(3786),e=t(19100);let u=class extends e.yh{constructor(){super({notifications:{filters:[]}})}};u=(0,i.gn)([(0,e.yC)({name:"wp-single-view"}),(0,i.w6)("design:paramtypes",[])],u);var r=t(9170),n=t(33927),h=t(96725),a=t(61486);class p extends e.AE{constructor(k,b){super(k),this.store=k,this.resourceService=b,this.selectNotifications$=(0,a.aj)([this.select(v=>v.notifications.filters),this.resourceService.query.select()]).pipe((0,r.h)(v=>v.length>0),(0,n.U)(([v])=>(0,h.wH)(this.resourceService,{filters:v}))),this.selectNotificationsCount$=this.selectNotifications$.pipe((0,n.U)(v=>v.length)),this.hasNotifications$=this.selectNotificationsCount$.pipe((0,n.U)(v=>v>0))}get params(){return{filters:this.getValue().notifications.filters}}}var l=t(53466),d=t(79902),g=t(97542),C=t(78509),y=t(60419),m=t(44838),E=t(96905),P=t(2316);let w=class{constructor(k,b,v){this.actions$=k,this.currentUser$=b,this.resourceService=v,this.id="WorkPackage Activity Store",this.store=new u,this.query=new p(this.store,this.resourceService)}setFilters(k){const b=[["readIAN","=",!1],["resourceId","=",[k]],["resourceType","=",["WorkPackage"]]];this.store.update(({notifications:v})=>({notifications:Object.assign(Object.assign({},v),{filters:b})})),this.reload()}markAllAsRead(){(0,h.mw)(this.resourceService,{filters:this.store.getValue().notifications.filters}).pipe((0,l.q)(1)).subscribe(k=>{this.actions$.dispatch((0,C.L5)({origin:this.id,notifications:k.ids}))})}reload(){this.currentUser$.isLoggedIn$.pipe((0,l.q)(1),(0,r.h)(k=>k),(0,d.w)(()=>this.resourceService.fetchNotifications(this.query.params))).subscribe()}reloadOnNotificationRead(){this.reload()}reloadOnCenterUpdate(){this.reload()}};w.\u0275fac=function(k){return new(k||w)(P.LFG(y.b),P.LFG(E.S),P.LFG(g.W))},w.\u0275prov=P.Yz7({token:w,factory:w.\u0275fac}),(0,i.gn)([(0,m.B)(C.A6),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],w.prototype,"reloadOnNotificationRead",null),(0,i.gn)([(0,m.B)(C.$v),(0,i.w6)("design:type",Function),(0,i.w6)("design:paramtypes",[]),(0,i.w6)("design:returntype",void 0)],w.prototype,"reloadOnCenterUpdate",null),w=(0,i.gn)([m.b,(0,i.w6)("design:paramtypes",[y.b,E.S,g.W])],w)},81691:(H,D,t)=>{"use strict";t.d(D,{G:()=>l});var i=t(43440),e=t(53457),c=t(62964),u=t(44022),r=t(20979),n=t(91923),h=t(99676),a=t(71562),p=t(2316);class l{constructor(g,C,y,m,E,P,w,x){this.querySpace=g,this.wpTableHierarchies=C,this.wpTableColumns=y,this.notificationService=m,this.halResourceService=E,this.apiV3Service=P,this.schemaCache=w,this.wpRelations=x}initialize(g,C){const y=C.elements;Promise.all([this.requireInvolvedRelations(y.map(m=>m.id)),this.requireHierarchyElements(y),this.requireSumsSchema(C)]).then(m=>{this.loadAdditional(_.flatten(m))})}loadAdditional(g){this.apiV3Service.work_packages.requireAll(g).then(()=>{this.querySpace.additionalRequiredWorkPackages.putValue(null,"All required work packages are loaded")}).catch(C=>{this.querySpace.additionalRequiredWorkPackages.putValue(null,"Failure loading required work packages"),this.notificationService.handleRawError(C)})}requireInvolvedRelations(g){return this.wpTableColumns.hasRelationColumns()?this.wpRelations.requireAll(g).then(()=>{const C=this.getInvolvedWorkPackages(g.map(y=>this.wpRelations.state(y).value));return _.flatten(C)}):Promise.resolve([])}requireHierarchyElements(g){if(!this.wpTableHierarchies.isEnabled)return Promise.resolve([]);const C=_.flatten(g.map(y=>y.ancestorIds));return Promise.resolve(C)}getInvolvedWorkPackages(g){const C=[];return _.each(g,y=>{_.each(y,m=>{C.push(m.ids.from,m.ids.to)})}),C}requireSumsSchema(g){return g.sumsSchema?this.schemaCache.ensureLoaded(g.sumsSchema.href).then(()=>[]):Promise.resolve([])}}l.\u0275fac=function(g){return new(g||l)(p.LFG(i.q),p.LFG(h.Y),p.LFG(a.i),p.LFG(c.q),p.LFG(n.u),p.LFG(r.T),p.LFG(u.y),p.LFG(e.V))},l.\u0275prov=p.Yz7({token:l,factory:l.\u0275fac})},54592:(H,D,t)=>{"use strict";t.d(D,{H:()=>a,q:()=>p});var i=t(43440),e=t(14808),c=t(53466),u=t(67202),r=t(33927),n=t(89919),h=t(2316);class a{constructor(d){this.querySpace=d,this.updatesState=(0,e.qH)(),this.pristineState=(0,e.qH)()}initialize(d,g,C){const y=this.valueFromQuery(d,g);this.pristineState.putValue(y)}update(d){this.updatesState.putValue(d)}clear(d){this.pristineState.clear(d),this.updatesState.clear(d)}live$(){return(0,n.T)(this.pristineState.values$(),this.updatesState.values$())}pristine$(){return this.pristineState.values$()}updates$(){return this.updatesState.values$()}changes$(){return this.updatesState.changes$()}onReady(){return this.pristineState.values$().pipe((0,c.q)(1),(0,u.h)(null)).toPromise()}get lastUpdatedState(){const d=(0,e.$e)(this.pristineState,this.updatesState);return(0,e.eS)(d,g=>g.pipe((0,r.U)(([C,y])=>void 0===y?C:y)))}set current(d){d?this.updatesState.putValue(d):this.updatesState.clear()}get current(){return this.lastUpdatedState.value}}a.\u0275fac=function(d){return new(d||a)(h.LFG(i.q))},a.\u0275prov=h.Yz7({token:a,factory:a.\u0275fac});class p extends a{}p.\u0275fac=function(){let l;return function(g){return(l||(l=h.n5z(p)))(g||p)}}(),p.\u0275prov=h.Yz7({token:p,factory:p.\u0275fac})},79174:(H,D,t)=>{"use strict";t.d(D,{q:()=>h});var i=t(61083),e=t(43440),c=t(53466),u=t(44022),r=t(54592),n=t(2316);class h extends r.H{constructor(p,l,d){super(p),this.querySpace=p,this.workPackageViewGroupByService=l,this.schemaCacheService=d,this.groupTypesWithHeaderCellsWhenCollapsed=["project"],this.isMilestone=g=>{var C;return null===(C=this.schemaCacheService.of(g))||void 0===C?void 0:C.isMilestone},this.wpTypesToShowInCollapsedGroupHeaders=[this.isMilestone]}get config(){return this.updatesState.getValueOr(this.getDefaultState())}get currentGroups(){return this.querySpace.groups.value}get allGroupsAreCollapsed(){return this.config.allGroupsAreCollapsed}get allGroupsAreExpanded(){return this.config.allGroupsAreExpanded}get currentGroupedBy(){return this.workPackageViewGroupByService.current}getDefaultState(){var p;return Object.assign({state:this.querySpace.collapsedGroups.value||{},allGroupsChanged:!1,lastChangedGroup:null,groupedBy:(null===(p=this.currentGroupedBy)||void 0===p?void 0:p.id)||null},this.getAllGroupsCollapsedState(this.currentGroups,this.querySpace.collapsedGroups.value))}toggleGroupCollapseState(p){const l=!this.config.state[p],d=Object.assign(Object.assign({},this.config.state),{[p]:l}),g=Object.assign(Object.assign(Object.assign({},this.config),{state:d,lastChangedGroup:p}),this.getAllGroupsCollapsedState(this.currentGroups,d));this.update(g)}setAllGroupsCollapseStateTo(p){const l=this.currentGroups.reduce((g,C)=>Object.assign(Object.assign({},g),{[C.identifier]:p}),{}),d=Object.assign(Object.assign({},this.config),{state:Object.assign(Object.assign({},this.config.state),l),lastChangedGroup:null,allGroupsAreCollapsed:p,allGroupsAreExpanded:!p,allGroupsChanged:!0});this.update(d)}getAllGroupsCollapsedState(p,l){let d=!1,g=!0;if(l&&(null==p?void 0:p.length)){const C=p[0].identifier,y=l[C],m=p.every(E=>null!=l[E.identifier]&&l[E.identifier]===l[C]);d=m&&y,g=m&&!y}return{allGroupsAreCollapsed:d,allGroupsAreExpanded:g}}initialize(p,l,d){this.querySpace.tableRendered.values$().pipe((0,c.q)(1)).subscribe(()=>this.update(Object.assign(Object.assign({},this.config),{allGroupsChanged:!0})))}valueFromQuery(p,l){return this.getDefaultState()}applyToQuery(p){}}h.\u0275fac=function(p){return new(p||h)(n.LFG(e.q),n.LFG(i.w),n.LFG(u.y))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac})},71562:(H,D,t)=>{"use strict";t.d(D,{i:()=>l});var i=t(43440),e=t(87853),c=t(70319),u=t(14808),r=t(53466),n=t(67202),h=t(91720),a=t(54592),p=t(2316);class l extends a.q{constructor(g,C){super(C),this.states=g,this.querySpace=C}initialize(g,C,y){super.initialize(g,C,y)}valueFromQuery(g){return[...g.columns]}hasChanged(g){return!this.isCurrentlyEqualTo(g.columns)}isCurrentlyEqualTo(g){const C=y=>y.map(m=>m.href);return _.isEqual(C(g),C(this.getColumns()))}applyToQuery(g){const C=this.getColumns(),y=g.columns.map(P=>P.id),m=C.map(P=>P.id);return g.columns=(0,h.FQ)(C),!(0===_.difference(m,y).length)&&this.hasRelationColumns()}hasRelationColumns(){const g=[c.L.RELATION_OF_TYPE,c.L.RELATION_TO_TYPE];return!!_.find(this.getColumns(),C=>g.indexOf(C._type)>=0)}getColumns(){return[...this.current]}index(g){return _.findIndex(this.getColumns(),C=>C.id===g)}findById(g){return _.find(this.getColumns(),C=>C.id===g)}previous(g){const C=this.index(g.id);return C<=0?null:this.getColumns()[C-1]}next(g){const C=this.index(g.id);return-1===C||this.isLast(g)?null:this.getColumns()[C+1]}isFirst(g){return 0===this.index(g.id)}isLast(g){return this.index(g.id)===this.columnCount-1}setColumns(g){this.isCurrentlyEqualTo(g)||this.update(g)}setColumnsById(g){const C=g.map(y=>_.find(this.all,m=>m.id===y));this.setColumns(_.compact(C))}moveColumn(g,C){const y=this.getColumns();C>=y.length&&(C=y.length-1),C<0&&(C=0);const m=y[g];y.splice(g,1),y.splice(C,0,m),this.setColumns(y)}shift(g,C){const y=this.index(g.id);-1!==y&&this.moveColumn(y,y+C)}addColumn(g,C){const y=this.getColumns();if(void 0===C&&(C=y.length),-1===this.index(g)){const m=_.find(this.all,E=>E.id===g);if(!m)throw new Error("Column with provided name is not found");y.splice(C,0,m),this.setColumns(y)}}removeColumn(g){const C=this.index(g.id);if(-1!==C){const y=this.getColumns();y.splice(C,1),this.setColumns(y)}}get current(){return this.lastUpdatedState.getValueOr([])}get availableState(){return this.querySpace.available.columns}get columnCount(){return this.getColumns().length}get all(){return this.availableState.getValueOr([])}get allPropertyColumns(){return this.all.filter(g=>g._type===c.L.PROPERTY)}get unused(){return _.differenceBy(this.all,this.getColumns(),"$href")}onReady(){return(0,u.$e)(this.pristineState,this.availableState).values$().pipe((0,r.q)(1),(0,n.h)(null)).toPromise()}}l.\u0275fac=function(g){return new(g||l)(p.LFG(e.G),p.LFG(i.q))},l.\u0275prov=p.Yz7({token:l,factory:l.\u0275fac})},2888:(H,D,t)=>{"use strict";t.d(D,{M5:()=>r,he:()=>n,ld:()=>h});var i=t(87853),e=t(43440),c=t(54592),u=t(2316);const r="list",n="card";class h extends c.q{constructor(p,l){super(l),this.states=p,this.querySpace=l}hasChanged(p){return this.current!==p.displayRepresentation}valueFromQuery(p){return p.displayRepresentation||null}applyToQuery(p){const{current:l}=this;return p.displayRepresentation=null===l?void 0:l,!1}get current(){return this.lastUpdatedState.getValueOr(null)}get isList(){const{current:p}=this;return!p||p===r}get isCards(){return this.current===n}setDisplayRepresentation(p){this.update(p)}}h.\u0275fac=function(p){return new(p||h)(u.LFG(i.G),u.LFG(e.q))},h.\u0275prov=u.Yz7({token:h,factory:h.\u0275fac})},74647:(H,D,t)=>{"use strict";t.d(D,{Z:()=>d});var i=t(43440),e=t(14808),c=t(87853),u=t(53466),r=t(67202),n=t(63085),h=t(91720),a=t(63588),p=t(54592),l=t(2316);class d extends p.q{constructor(C,y){super(y),this.states=C,this.querySpace=y,this.hidden=["datesInterval","precedes","follows","relates","duplicates","duplicated","blocks","blocked","partof","includes","requires","required","search","subjectOrId","subjectOr","manualSort","typeahead"],this.incomplete=(0,e.qH)(!1)}initializeFilters(C,y){const m=(0,h.FQ)(C.filters);this.availableState.putValue(y.filtersSchemas.elements),this.pristineState.putValue(m)}get isEmpty(){const{value:C}=this.lastUpdatedState;return!C||0===C.length}get availableState(){return this.querySpace.available.filters}get incomplete$(){return this.incomplete.values$()}add(C){this.updatesState.putValue([...this.rawFilters,C])}replace(C,y){const m=this.instantiate(C),E=[...this.rawFilters];y(m);const P=this.findIndex(C);-1===P?E.push(m):E.splice(P,1,m),this.update(E)}modify(C,y){const m=this.findIndex(C);if(-1===m)return!1;const E=[...this.rawFilters];return y(E[m]),this.update(E),!0}instantiate(C){const y=C instanceof a.e?C.id:C;return _.find(this.availableSchemas,E=>E.filter.allowedValues[0].id===y).getFilter()}remove(...C){const y=E=>E instanceof n.L?E.id:E,m=new Set(C.map(y));this.update(this.rawFilters.filter(E=>!m.has(y(E))))}remainingVisibleFilters(C=this.current){return this.remainingFilters(C).filter(y=>-1===this.hidden.indexOf(y.id))}get availableFilters(){return this.availableSchemas.map(C=>C.allowedFilterValue)}get availableSchemas(){return this.availableState.getValueOr([])}isComplete(C){return _.every(C,y=>y.isCompletelyDefined())}hasChanged(C){const y=m=>m.map(E=>E.$source);return!_.isEqual(y(C.filters),y(this.rawFilters))}valueFromQuery(C){}update(C){super.update(C),this.incomplete.putValue(!1)}find(C){const y=this.findIndex(C);if(-1!==y)return this.rawFilters[y]}findIndex(C){return _.findIndex(this.current,y=>y.id===C)}applyToQuery(C){return C.filters=this.cloneFilters(),!0}get current(){return[...this.rawFilters]}cloneFilters(){return(0,h.FQ)(this.rawFilters)}get rawFilters(){return this.lastUpdatedState.value||[]}get currentlyVisibleFilters(){const C=new Set(this.hidden);return C.delete("search"),_.reject(this.current,y=>C.has(y.id))}replaceIfComplete(C){this.isComplete(C)?this.update(C):this.incomplete.putValue(!0)}onReady(){return(0,e.$e)(this.pristineState,this.availableState).values$().pipe((0,u.q)(1),(0,r.h)(null)).toPromise()}remainingFilters(C=this.rawFilters){return _.differenceBy(this.availableFilters,C,y=>y.id)}isAvailable(C){return!!this.availableFilters.find(y=>y.id===C.id)}}d.\u0275fac=function(C){return new(C||d)(l.LFG(c.G),l.LFG(i.q))},d.\u0275prov=l.Yz7({token:d,factory:d.\u0275fac})},48451:(H,D,t)=>{"use strict";t.d(D,{o:()=>h});var i=t(43440),e=t(33927),c=t(83720),u=t(60914),r=t(54592),n=t(2316);class h extends r.H{constructor(p,l){super(p),this.querySpace=p,this.wpTableSelection=l}isFocused(p){return this.focusedWorkPackage===p}ifShouldFocus(p){const l=this.current;l&&l.focusAfterRender&&(p(l.workPackageId),l.focusAfterRender=!1,this.update(l))}get focusedWorkPackage(){const p=this.current;if(p)return p.workPackageId;const l=this.querySpace.results.value;return l&&l.elements.length>0?l.elements[0].id.toString():null}whenChanged(){return this.live$().pipe((0,e.U)(p=>p.workPackageId),(0,c.x)())}updateFocus(p,l=!1){this.wpTableSelection.isEmpty&&this.wpTableSelection.setRowState(p,!0),this.update({workPackageId:p,focusAfterRender:l})}valueFromQuery(p,l){}}h.\u0275fac=function(p){return new(p||h)(n.LFG(i.q),n.LFG(u.J))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac})},61083:(H,D,t)=>{"use strict";t.d(D,{w:()=>r});var i=t(87853),e=t(43440),c=t(54592),u=t(2316);class r extends c.q{constructor(h,a){super(a),this.states=h,this.querySpace=a}valueFromQuery(h){return h.groupBy||null}hasChanged(h){const a=p=>p?p.href:null;return!_.isEqual(a(h.groupBy),a(this.current))}applyToQuery(h){const{current:a}=this;return h.groupBy=null===a?void 0:a,!0}isGroupable(h){return!!_.find(this.available,a=>a.id===h.id)}disable(){this.update(null)}setBy(h){const a=_.find(this.available,p=>p.id===h.id);a&&this.update(a)}get current(){return this.lastUpdatedState.getValueOr(null)}get availableState(){return this.querySpace.available.groupBy}get isEnabled(){return!!this.current}get available(){return this.availableState.getValueOr([])}isCurrentlyGroupedBy(h){const a=this.current;return!(!a||a.id!==h.id)}}r.\u0275fac=function(h){return new(h||r)(u.LFG(i.G),u.LFG(e.q))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac})},16793:(H,D,t)=>{"use strict";t.d(D,{f:()=>p});var i=t(3786),e=t(99676),c=t(43440),u=t(41945),r=t(87853),n=t(2888),h=t(20979),a=t(2316);class p{constructor(d,g,C,y,m,E){this.wpViewHierarchies=d,this.wpDisplayRepresentation=g,this.states=C,this.wpRelationHierarchy=y,this.apiV3Service=m,this.querySpace=E}get applicable(){return this.wpViewHierarchies.isEnabled&&this.wpDisplayRepresentation.isList}canIndent(d){if(!d.changeParent||!this.applicable)return!1;const g=this.renderedWorkPackageIds,C=g.indexOf(d.id);if(0===C)return!1;const y=d.ancestorIds,m=y.length;if(0===m)return!0;const E=y[m-1];return g[C-1]!==E}canOutdent(d){return!(!d.changeParent||!this.applicable)&&!!d.parent}indent(d){return(0,i.mG)(this,void 0,void 0,function*(){if(!this.canIndent(d))return Promise.reject();const g=this.renderedWorkPackageIds,C=g.indexOf(d.id),y=g[C-1];let m=y;const E=yield this.apiV3Service.work_packages.id(y).get().toPromise(),P=_.difference(E.ancestorIds,d.ancestorIds);return P&&P.length>0&&(m=P[0]),this.wpRelationHierarchy.changeParent(d,m)})}outdent(d){if(!this.canOutdent(d))return Promise.reject();let g=null;const{ancestorIds:C}=d,y=C.length;return y>1&&(g=C[y-2]),this.wpRelationHierarchy.changeParent(d,g)}get renderedWorkPackageIds(){return this.querySpace.renderedWorkPackageIds.getValueOr([])}}p.\u0275fac=function(d){return new(d||p)(a.LFG(e.Y),a.LFG(n.ld),a.LFG(r.G),a.LFG(u.O),a.LFG(h.T),a.LFG(c.q))},p.\u0275prov=a.Yz7({token:p,factory:p.\u0275fac})},99676:(H,D,t)=>{"use strict";t.d(D,{Y:()=>u});class i{constructor(n){this.isVisible=!1,this.last=null,this.collapsed={},this.isVisible=n}}var e=t(54592),c=t(2316);class u extends e.q{valueFromQuery(n){const h=new i(n.showHierarchies),{current:a}=this;return a&&(h.collapsed=a.collapsed),h}hasChanged(n){return n.showHierarchies!==this.isEnabled}applyToQuery(n){return n.showHierarchies=this.isEnabled,this.isEnabled}get isEnabled(){return!(!this.current||!this.current.isVisible)}setEnabled(n=!0){const h=Object.assign(Object.assign({},this.current),{isVisible:n,last:null});this.update(h)}toggleState(){return this.setEnabled(!this.isEnabled),this.isEnabled}collapsed(n){return this.current.collapsed[n]}collapse(n){this.setState(n,!0)}expand(n){this.setState(n,!1)}toggle(n){this.setState(n,!this.collapsed(n))}setState(n,h){const a=Object.assign(Object.assign({},this.current),{last:n});a.collapsed[n]=h,this.update(a)}get current(){const n=this.lastUpdatedState.value;return void 0===n?this.initialState:(n.collapsed||(n.collapsed={}),n)}get initialState(){return new i(!1)}}u.\u0275fac=function(){let r;return function(h){return(r||(r=c.n5z(u)))(h||u)}}(),u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},84897:(H,D,t)=>{"use strict";t.d(D,{B:()=>n});var i=t(43440),e=t(87853),c=t(24e3),u=t(54592),r=t(2316);class n extends u.q{constructor(a,p,l){super(l),this.states=a,this.Banners=p,this.querySpace=l}initialize(a,p,l){super.initialize(a,p,l)}shouldHighlightInline(a){return!(!this.isInline||this.Banners.eeShowBanners)&&(void 0===this.current.selectedAttributes||this.current.selectedAttributes===[]||!!_.find(this.current.selectedAttributes,p=>p.id===a))}get current(){const a=this.lastUpdatedState.getValueOr({mode:"inline"});return this.filteredValue(a)}get isInline(){return"inline"===this.current.mode}get isDisabled(){return"none"===this.current.mode}update(a){super.update(this.filteredValue(a))}valueFromQuery(a){const p={mode:a.highlightingMode||"inline",selectedAttributes:a.highlightedAttributes};return this.filteredValue(p)}hasChanged(a){return a.highlightingMode!==this.current.mode||!_.isEqual(a.highlightedAttributes,this.current.selectedAttributes)}applyToQuery(a){const{current:p}=this;return a.highlightingMode=p.mode,a.highlightedAttributes=p.selectedAttributes,!1}filteredValue(a){return _.isEmpty(a.selectedAttributes)&&(a.selectedAttributes=void 0),this.Banners.conditional(()=>{a.mode="none",a.selectedAttributes=void 0}),a}}n.\u0275fac=function(a){return new(a||n)(r.LFG(e.G),r.LFG(c.j),r.LFG(i.q))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac})},20066:(H,D,t)=>{"use strict";t.d(D,{F:()=>r});var i=t(87853),e=t(43440),c=t(54592),u=t(2316);class r extends c.q{constructor(h,a){super(a),this.states=h,this.querySpace=a}hasChanged(h){return this.current!==h.includeSubprojects}valueFromQuery(h){return h.includeSubprojects||!1}applyToQuery(h){const{current:a}=this;return h.includeSubprojects=a,!0}get current(){return this.lastUpdatedState.getValueOr(!1)}setIncludeSubprojects(h){this.update(h)}}r.\u0275fac=function(h){return new(h||r)(u.LFG(i.G),u.LFG(e.q))},r.\u0275prov=u.Yz7({token:r,factory:r.\u0275fac})},95846:(H,D,t)=>{"use strict";t.d(D,{M:()=>te});var i=t(3786),e=t(53466),c=t(87853),u=t(43440),r=t(70233),n=t(48934),h=t(3352);const a=-2147483647,p=2147483647,d=16384;function g(ee,G,se){return void 0===ee[se]?G[se]:ee[se]}function C(ee,G,se,me){return g(ee,se,G[me])}function k(ee,G,se,me){const _e=G.length;let he=se,ae=me,re=Math.floor((ae-he)/(_e-1));if(re<1){if(ae+_e<=p)ae+=_e;else{if(!(he-_e>=a))throw new Error("Elements cannot be moved further and no space is left. Too many elements");he-=_e}re=Math.floor((ae-he)/(_e-1))}const ye=Object.assign({},ee);for(let Ce=0;Ce<_e;Ce+=1){ye[G[Ce]]=he+Ce*re}return ye}function b(ee,G,se){const me=function(ee,G,se){return g(ee,se,G[0]||"")||0}(ee,G,se),_e=function(ee,G,se){for(let me=G.length-1;me>=0;me-=1){const he=g(ee,se,G[me]);if(void 0!==he)return he}return 0}(ee,G,se);return k(ee,G,me,_e)}function v(ee,G,se,me,_e){const he={};if(ee.length<=1&&void 0===G[se])return Object.assign(Object.assign({},he),{[se]:0});const ae=function(ee,G,se,me,_e,he){if(null===_e)return ee;const ae=C(ee,G,se,me),re=G[_e],ye=C(ee,G,se,_e);return void 0===ae||void 0===ye?ee:Object.assign(Object.assign({},ee),{[`${he}`]:ye,[`${re}`]:ae})}(he,ee,G,me,_e,se);if(null!==_e&&1===Math.abs(_e-me)&&he!==ae)return ae;if(0===me)return function(ee,G,se,me,_e){const he=C(ee,G,se,me+1);return void 0===he?Object.assign(Object.assign({},ee),{[_e]:0}):Object.assign(Object.assign({},ee),{[_e]:he-d/2})}(ae,ee,G,me,se);const{delta:re,predecessorPosition:ye}=function(ee,G,se,me){let _e=0-d;const he=Object.assign({},ee);for(let ae=0;ae<me;ae+=1){const re=G[ae],ye=se[re];void 0===ye?(he[re]=_e+d,_e=he[re]):_e=ye}return{predecessorPosition:_e,delta:he}}(ae,ee,G,me);if(ye>=p)return(0,h.qu)("Predecessor position is at max order, need to reorder"),b(re,ee,G);const Ce=C(re,ee,G,me+1);if(void 0===Ce)return Object.assign(Object.assign({},re),{[se]:ye+d/2});if(Ce>=p)return(0,h.qu)("Successor position is at max order, need to reorder"),b(re,ee,G);const ke=Math.floor((Ce-ye)/2);return ke<1?((0,h.qu)("Cannot insert at optimal position, no space left. Need to reorder"),b(re,ee,G)):Object.assign(Object.assign({},re),{[se]:ye+ke})}function S(ee,G){const se={},[me,_e]=function(ee,G,se){let me=p,_e=a,he=!1;for(let ae=G.length-1;ae>=0;ae-=1){const ye=g(ee,se,G[ae]);void 0!==ye&&(me=Math.min(ye,me),_e=Math.max(ye,_e),he=!0)}return he&&me!==_e?[me,_e]:[0,G.length*d]}(se,ee,G);return k(se,ee,me,_e)}var A=t(82763),F=t(64538),I=t(20979),J=t(54592),N=t(2316);class te extends J.q{constructor(G,se,me,_e,he,ae){super(G),this.querySpace=G,this.apiV3Service=se,this.states=me,this.causedUpdates=_e,this.wpTableSortBy=he,this.pathHelper=ae}initialize(G,se,me){return!(0,n.Z)(G)&&this.positions.hasValue()&&this.applyToQuery(G),this.wpTableSortBy.isManualSortingMode?this.withLoadedPositions():Promise.resolve()}move(G,se,me){return(0,i.mG)(this,void 0,void 0,function*(){const _e=G.findIndex(he=>he===se);return G.splice(_e,1),G.splice(me,0,se),yield this.assignPosition(G,se,me,_e),G})}remove(G,se){return _.remove(G,me=>me===se),this.update({[se]:-1}),G}add(G,se,me=-1){return(0,i.mG)(this,void 0,void 0,function*(){return-1===me?(G.push(se),me=G.length-1):G.splice(me,0,se),yield this.assignPosition(G,se,me),G})}get applicable(){return(0,n.Z)(this.currentQuery)}get currentQuery(){return this.querySpace.query.value}assignPosition(G,se,me,_e=null){return(0,i.mG)(this,void 0,void 0,function*(){const he=yield this.withLoadedPositions(),ae=function(ee,G,se,me,_e){return function(ee,G,se){let me;for(let _e=0,he=ee.length;_e<he;_e+=1){const re=G[ee[_e]];if(_e!==se){if(void 0===me||void 0===re){me=re;continue}if(re<me)return!1}}return!0}(ee,G,me)?v(ee,G,se,me,_e):S(ee,G)}(G,he,se,me,_e);yield this.update(ae)})}get positions(){return this.updatesState}update(G){return(0,i.mG)(this,void 0,void 0,function*(){const se=this.positions.getValueOr({});if(this.positions.putValue(Object.assign(Object.assign({},se),G)),(0,n.Z)(this.currentQuery)){const me=yield this.apiV3Service.queries.id(this.currentQuery).order.update(G);this.currentQuery.updatedAt=me,this.causedUpdates.add(this.currentQuery)}this.applyToQuery(this.currentQuery),this.querySpace.query.putValue(this.currentQuery)})}withLoadedPositions(){if((0,n.Z)(this.currentQuery)){const{value:G}=this.positions;(G==={}||this.positions.isValueOlderThan(6e4))&&this.positions.clear("Clearing old positions value"),this.positions.putFromPromiseIfPristine(()=>this.apiV3Service.queries.id(this.currentQuery).order.get())}else this.positions.isPristine()&&this.positions.putValue({});return this.positions.values$().pipe((0,e.q)(1)).toPromise()}valueFromQuery(G){}orderedWorkPackages(){const G=this.querySpace.results.value.elements.map(me=>this.states.workPackages.get(me.id).getValueOr(me));if((0,n.Z)(this.currentQuery)||this.positions.isPristine())return G;const se=this.positions.value;return _.sortBy(G,me=>{const _e=se[me.id];return void 0!==_e?_e:p})}applyToQuery(G){return G.orderedWorkPackages=this.positions.getValueOr({}),!1}hasChanged(G){return!1}}te.\u0275fac=function(G){return new(G||te)(N.LFG(u.q),N.LFG(I.T),N.LFG(c.G),N.LFG(F.h),N.LFG(A.q),N.LFG(r.j))},te.\u0275prov=N.Yz7({token:te,factory:te.\u0275fac})},40533:(H,D,t)=>{"use strict";t.d(D,{S:()=>h});var i=t(43440),e=t(14359);class c{constructor(p){this.current=new e.M(p.offset,p.total,p.pageSize)}get page(){return this.current.page}set page(p){this.current.page=p}get perPage(){return this.current.perPage}set perPage(p){this.current.perPage=p}get total(){return this.current.total}set total(p){this.current.total=p}}var u=t(54592),r=t(68853),n=t(2316);class h extends u.H{constructor(p,l){super(p),this.paginationService=l}get paginationObject(){return this.current?{pageSize:this.current.perPage,offset:this.current.page}:{pageSize:this.paginationService.getCachedPerPage([]),offset:1}}valueFromQuery(p,l){return new c(l)}updateFromObject(p){const l=this.current;p.page&&(l.page=p.page),p.perPage&&(l.perPage=p.perPage),p.total&&(l.total=p.total),this.updatesState.putValue(l)}updateFromResults(p){const l={page:p.offset,perPage:p.pageSize,total:p.total,count:p.count};this.updateFromObject(l)}get current(){return this.lastUpdatedState.value}}h.\u0275fac=function(p){return new(p||h)(n.LFG(i.q),n.LFG(r.N))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac})},41195:(H,D,t)=>{"use strict";t.d(D,{a:()=>p});var i=t(43440),e=t(53457),c=t(70319),u=t(20979),r=t(91923),n=t(54592),h=t(71562),a=t(2316);class p extends n.H{constructor(d,g,C,y,m){super(d),this.querySpace=d,this.wpTableColumns=g,this.halResourceService=C,this.apiV3Service=y,this.wpRelations=m}valueFromQuery(d){return this.current}relationsToExtendFor(d,g,C){if(!this.wpTableColumns.hasRelationColumns()||!this.lastUpdatedState.hasValue()||_.isNil(g))return;const y=this.getExpandFor(d.id);if(void 0===y)return;const m=this.wpTableColumns.findById(y),E=this.relationColumnType(m);null!==E&&_.each(this.relationsForColumn(d,g,m),P=>C(P,m,E))}relationsForColumn(d,g,C){if(_.isNil(g))return[];const y=this.relationColumnType(C);if("toType"===y){const m=C.type.href;return _.filter(g,E=>{const P=E.denormalized(d),w=this.apiV3Service.work_packages.cache.state(P.targetId).value;return _.get(w,"type.href")===m})}if("ofType"===y){const{relationType:m}=C;return _.filter(g,E=>E.denormalized(d).relationType===m)}return[]}relationColumnType(d){switch(d._type){case c.L.RELATION_TO_TYPE:return"toType";case c.L.RELATION_OF_TYPE:return"ofType";default:return null}}getExpandFor(d){return this.current[d]}setExpandFor(d,g){const C=Object.assign({},this.current);C[d]=g,this.update(C)}collapse(d){const g=Object.assign({},this.current);delete g[d],this.update(g)}get current(){return this.lastUpdatedState.getValueOr({})}}p.\u0275fac=function(d){return new(d||p)(a.LFG(i.q),a.LFG(h.i),a.LFG(r.u),a.LFG(u.T),a.LFG(e.V))},p.\u0275prov=a.Yz7({token:p,factory:p.\u0275fac})},60914:(H,D,t)=>{"use strict";t.d(D,{J:()=>n});var i=t(43440),e=t(87853),c=t(20342),u=t(54592),r=t(2316);class n extends u.H{constructor(a,p,l){super(a),this.querySpace=a,this.states=p,this.opContextMenu=l,this.reset()}ngOnDestroy(){Mousetrap.unbind(["command+d","ctrl+d"]),Mousetrap.unbind(["command+a","ctrl+a"])}initializeSelection(a){const p={selected:{},activeRowIndex:null};a.forEach(l=>p.selected[l]=!0),this.updatesState.clear(),this.pristineState.putValue(p)}isSelected(a){var p;return!!(null===(p=this.current)||void 0===p?void 0:p.selected[a])}selectAll(a){const p=this._emptyState;a.forEach(l=>{l.workPackageId&&(p.selected[l.workPackageId]=!0)}),this.update(p)}getSelectedWorkPackages(){const a=this.states.workPackages;return this.getSelectedWorkPackageIds().map(p=>a.get(p).value)}getSelectedWorkPackageIds(){var a;const p=[];return _.each(null===(a=this.current)||void 0===a?void 0:a.selected,(l,d)=>{l&&p.push(d)}),p}reset(){this.update(this._emptyState)}get isEmpty(){return 0===this.selectionCount}get selectionCount(){var a;return _.size(null===(a=this.current)||void 0===a?void 0:a.selected)}toggleRow(a){var p;const l=null===(p=this.current)||void 0===p?void 0:p.selected[a];this.setRowState(a,!l)}setRowState(a,p){const l=this.current||this._emptyState;l.selected[a]=p,this.update(l)}setSelection(a,p){const l=this._emptyState;l.selected[a]=!0,l.activeRowIndex=p,this.update(l)}setMultiSelectionFrom(a,p,l){const d=this.current||this._emptyState;if(0===this.selectionCount||null===d.activeRowIndex)d.selected[p]=!0,d.activeRowIndex=l;else{const g=Math.min(l,d.activeRowIndex),C=Math.max(l,d.activeRowIndex);a.forEach((y,m)=>{y.workPackageId&&(d.selected[y.workPackageId]=m>=g&&m<=C)})}this.update(d)}registerSelectAllListener(a){Mousetrap.bind(["command+a","ctrl+a"],p=>(this.selectAll(a()),p.preventDefault(),this.opContextMenu.close(),!1))}registerDeselectAllListener(){Mousetrap.bind(["command+d","ctrl+d"],a=>(this.reset(),a.preventDefault(),this.opContextMenu.close(),!1))}get _emptyState(){return{selected:{},activeRowIndex:null}}valueFromQuery(a,p){}}n.\u0275fac=function(a){return new(a||n)(r.LFG(i.q),r.LFG(e.G),r.LFG(c.$))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac})},82763:(H,D,t)=>{"use strict";t.d(D,{q:()=>p});var i=t(14808),e=t(67202),c=t(43440),u=t(87853),r=t(48934),n=t(70233),h=t(54592),a=t(2316);class p extends h.q{constructor(d,g,C){super(g),this.states=d,this.querySpace=g,this.pathHelper=C}valueFromQuery(d){return[...d.sortBy]}onReadyWithAvailable(){return(0,i.$e)(this.pristineState,this.querySpace.available.sortBy).values$().pipe((0,e.h)(null))}hasChanged(d){const g=C=>C.map(y=>y.href);return!_.isEqual(g(d.sortBy),g(this.current))}applyToQuery(d){const g=this.isManuallySorted(d.sortBy);return d.sortBy=[...this.current],!(g&&this.isManualSortingMode)}isSortable(d){return!!_.find(this.available,g=>g.column.href===d.href)}addSortCriteria(d,g){const C=this.findAvailableDirection(d,g);C&&this.add(C)}setAsSingleSortCriteria(d,g){const C=this.findAvailableDirection(d,g);C&&this.update([C])}findAvailableDirection(d,g){return _.find(this.available,C=>C.column.href===d.href&&C.direction.href===g)}add(d){const g=_.uniqBy([d,...this.current],C=>C.column.href).slice(0,3);this.update(g)}get isManualSortingMode(){return this.isManuallySorted(this.current)}switchToManualSorting(d){const{manualSortObject:g}=this;if(g&&!this.isManualSortingMode){if(d&&(0,r.Z)(d))return d.sortBy=[g],!0;this.update([g])}return!1}get current(){return this.lastUpdatedState.getValueOr([])}get availableState(){return this.querySpace.available.sortBy}get available(){return this.availableState.getValueOr([])}isManuallySorted(d){return!!(d&&d.length>0)&&d[0].column.href.endsWith("/manualSorting")}get manualSortObject(){return _.find(this.available,d=>d.column.href.endsWith("/manualSorting"))}}p.\u0275fac=function(d){return new(d||p)(a.LFG(u.G),a.LFG(c.q),a.LFG(n.j))},p.\u0275prov=a.Yz7({token:p,factory:p.\u0275fac})},82271:(H,D,t)=>{"use strict";t.d(D,{X:()=>u});var i=t(43440),e=t(54592),c=t(2316);class u extends e.q{constructor(n){super(n)}valueFromQuery(n){return!!n.sums}initialize(n){this.pristineState.putValue(!!n.sums)}hasChanged(n){return n.sums!==this.isEnabled}applyToQuery(n){return n.sums=this.isEnabled,!0}toggle(){this.updatesState.putValue(!this.current)}setEnabled(n){this.updatesState.putValue(n)}get isEnabled(){return this.current}get current(){return this.lastUpdatedState.getValueOr(!1)}}u.\u0275fac=function(n){return new(n||u)(c.LFG(i.q))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},73165:(H,D,t)=>{"use strict";t.d(D,{W:()=>n});var i=t(43440),e=t(14808),c=t(42529),u=t(54592),r=t(2316);class n extends u.q{constructor(a){super(a),this.querySpace=a,this.appliedZoomLevel$=(0,e.qH)("auto")}valueFromQuery(a){return Object.assign(Object.assign({},this.defaultState),{visible:a.timelineVisible,zoomLevel:a.timelineZoomLevel,labels:a.timelineLabels})}set appliedZoomLevel(a){this.appliedZoomLevel$.putValue(a)}get appliedZoomLevel(){return this.appliedZoomLevel$.value}hasChanged(a){const p=this.isVisible!==a.timelineVisible,l=this.zoomLevel!==a.timelineZoomLevel,d=!_.isEqual(this.current.labels,a.timelineLabels);return p||l||d}applyToQuery(a){return a.timelineVisible=this.isVisible,a.timelineZoomLevel=this.zoomLevel,a.timelineLabels=this.current.labels,!1}toggle(){const a=this.current;this.setVisible(!a.visible)}setVisible(a){this.updatesState.putValue(Object.assign(Object.assign({},this.current),{visible:a}))}get isVisible(){return this.current.visible}get zoomLevel(){return this.current.zoomLevel}get labels(){return _.isEmpty(this.current.labels)?this.defaultLabels:this.current.labels}updateLabels(a){this.modify({labels:a})}getNormalizedLabels(a){const p=this.defaultLabels;return _.each(this.current.labels,(l,d)=>{const g=d;p[g]=""===l?null:l}),p}setZoomLevel(a){this.modify({zoomLevel:a})}updateZoomWithDelta(a){const p=this.current.zoomLevel;if("auto"!==p)return this.applyZoomLevel(p,a);const l=this.appliedZoomLevel;if(l&&"auto"!==l)this.applyZoomLevel(l,a);else{const d=a<0?"days":"years";this.setZoomLevel(d)}}isAutoZoom(){return"auto"===this.current.zoomLevel}enableAutozoom(){this.modify({zoomLevel:"auto"})}get current(){return this.lastUpdatedState.getValueOr(this.defaultState)}modify(a){this.update(Object.assign(Object.assign({},this.current),a))}applyZoomLevel(a,p){let l=c.$r.indexOf(a);l+=p,l>=0&&l<c.$r.length&&this.setZoomLevel(c.$r[l])}get defaultLabels(){return{left:"",right:"",farRight:"subject"}}get defaultState(){return{zoomLevel:"auto",visible:!1,labels:this.defaultLabels}}}n.\u0275fac=function(a){return new(a||n)(r.LFG(i.q))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac})},1818:(H,D,t)=>{"use strict";t.d(D,{e:()=>x});var i=t(3786),e=t(2316),c=t(96617),u=t(70233),r=t(48451),n=t(57810),h=t(7493),a=t(87853),p=t(84109),l=t(12703),d=t(62964),g=t(29161),C=t(26942),y=t(20979),m=t(53448),E=t(50937),P=t(60419),w=t(29351);class x extends C.N{constructor(b,v){super(),this.injector=b,this.workPackageId=v,this.text={},this.initializeTexts()}observeWorkPackage(){this.apiV3Service.work_packages.id(this.workPackageId).requireAndStream().pipe(this.untilDestroyed()).subscribe(b=>{this.workPackage?this.workPackage=b:(this.workPackage=b,this.init()),this.cdRef.detectChanges()},b=>{this.handleLoadingError(b)})}initializeTexts(){this.text.tabs={},["overview","activity","relations","watchers"].forEach(b=>{this.text.tabs[b]=this.I18n.t(`js.work_packages.tabs.${b}`)})}init(){this.apiV3Service.projects.id(this.workPackage.project).requireAndStream().subscribe(()=>{this.projectIdentifier=this.workPackage.project.identifier,this.cdRef.detectChanges()}),this.displayNotificationsButton$=this.storeService.query.hasNotifications$,this.storeService.setFilters(this.workPackage.id),this.authorisationService.initModelAuth("work_package",this.workPackage.$links),this.titleService.setFirstPart(this.workPackage.subjectWithType(20)),this.showStaticPagePath=this.PathHelper.workPackagePath(this.workPackageId);const b=this.workPackage.attachments;this.attachmentsResourceService.fetchAttachments(b.href).subscribe(),this.keepTab.observable.pipe(this.untilDestroyed()).subscribe(v=>{this.updateFocusAnchorLabel(v.active)})}handleLoadingError(b){this.notificationService.handleRawError(b)}updateFocusAnchorLabel(b){const v=this.I18n.t("js.label_work_package_details_you_are_here",{tab:this.I18n.t(`js.work_packages.tabs.${b}`),type:this.workPackage.type.name,subject:this.workPackage.subject});return this.focusAnchorLabel=v}}(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",a.G)],x.prototype,"states",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",c.D)],x.prototype,"I18n",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",p.p)],x.prototype,"keepTab",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",u.j)],x.prototype,"PathHelper",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",l.l)],x.prototype,"halEditing",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",r.o)],x.prototype,"wpTableFocus",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",d.q)],x.prototype,"notificationService",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",h.g)],x.prototype,"authorisationService",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",w.v)],x.prototype,"attachmentsResourceService",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",e.sBO)],x.prototype,"cdRef",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",n.V)],x.prototype,"titleService",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",y.T)],x.prototype,"apiV3Service",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",m.$)],x.prototype,"hooks",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",P.b)],x.prototype,"actions$",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",E.O)],x.prototype,"storeService",void 0)},34520:(H,D,t)=>{"use strict";t.d(D,{_:()=>G});var i=t(3786),e=t(2316),c=t(47775),u=t(7493),r=t(43440),n=t(17163),h=t(9170),a=t(53466),p=t(86469),l=t(96617),d=t(75867),g=t(84897),C=t(87853),y=t(71562),m=t(82763),E=t(61083),P=t(74647),w=t(82271),x=t(73165),k=t(99676),b=t(40533),v=t(61043),M=t(81539),S=t(74478),O=t(95846),A=t(2888),F=t(20066),I=t(1403),J=t(53916),N=t(29161),te=t(65146),ee=t(26942);class G extends ee.N{constructor(me){super(),this.injector=me,this.queryLoaded=!1,this.destroyed=!1}ngOnInit(){this.setupQueryObservers(),this.setupRefreshObserver(),this.setupQueryLoadedListener()}setupQueryObservers(){this.wpTablePagination.updates$().pipe(this.untilDestroyed(),(0,n.M)(this.querySpace.query.values$())).subscribe(([me,_e])=>{this.wpListChecksumService.isQueryOutdated(_e,me)&&(this.wpListChecksumService.update(_e,me),this.refresh(!0,!1))}),this.setupChangeObserver(this.wpTableFilters,!0),this.setupChangeObserver(this.wpTableGroupBy),this.setupChangeObserver(this.wpTableSortBy),this.setupChangeObserver(this.wpTableSum),this.setupChangeObserver(this.wpTableTimeline),this.setupChangeObserver(this.wpTableHierarchies),this.setupChangeObserver(this.wpTableColumns),this.setupChangeObserver(this.wpTableHighlighting),this.setupChangeObserver(this.wpTableOrder),this.setupChangeObserver(this.wpDisplayRepresentation),this.setupChangeObserver(this.wpIncludeSubprojects)}setupChangeObserver(me,_e=!1){const he=this.querySpace.query;me.updates$().pipe(this.untilDestroyed(),(0,h.h)(()=>he.hasValue()&&me.hasChanged(he.value))).subscribe(()=>{const ae=he.value,re=me.applyToQuery(ae);this.querySpace.query.putValue(ae),this.wpListChecksumService.updateIfDifferent(ae,this.wpTablePagination.current).then(()=>{re&&this.refresh(!0,_e)})})}get projectIdentifier(){return this.currentProject.identifier||void 0}setupRefreshObserver(){this.halEvents.aggregated$("WorkPackage").pipe(this.untilDestroyed(),(0,h.h)(me=>this.filterRefreshEvents(me))).subscribe(me=>{this.refresh(!1,!1)})}filterRefreshEvents(me){var _e;const he=this.querySpace.renderedWorkPackageIds.value||(null===(_e=this.querySpace.results.value)||void 0===_e?void 0:_e.elements.map(re=>re.id))||[],ae=new Set(he);for(let re=0;re<me.length;re++){const ye=me[re];if(ae.has(ye.id)||"created"===ye.eventType)return!0}return!1}setupQueryLoadedListener(){this.querySpace.initialized.values$().pipe((0,a.q)(1),(0,h.h)(()=>!this.componentDestroyed)).subscribe(()=>{this.queryLoaded=!0,this.cdRef.detectChanges()})}}G.\u0275fac=function(me){return new(me||G)(e.Y36(e.zs3))},G.\u0275dir=e.lG2({type:G,features:[e.qOj]}),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",c.StateService)],G.prototype,"$state",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",C.G)],G.prototype,"states",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",r.q)],G.prototype,"querySpace",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",u.g)],G.prototype,"authorisationService",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",y.i)],G.prototype,"wpTableColumns",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",g.B)],G.prototype,"wpTableHighlighting",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",m.q)],G.prototype,"wpTableSortBy",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",E.w)],G.prototype,"wpTableGroupBy",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",P.Z)],G.prototype,"wpTableFilters",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",w.X)],G.prototype,"wpTableSum",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",x.W)],G.prototype,"wpTableTimeline",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",k.Y)],G.prototype,"wpTableHierarchies",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",b.S)],G.prototype,"wpTablePagination",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",O.M)],G.prototype,"wpTableOrder",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",v.Z)],G.prototype,"wpListService",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",M.Y)],G.prototype,"wpListChecksumService",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",p.vt)],G.prototype,"loadingIndicatorService",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",c.TransitionService)],G.prototype,"$transitions",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",l.D)],G.prototype,"I18n",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",d.p)],G.prototype,"opStaticQueries",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",S.f)],G.prototype,"wpStatesInitialization",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",e.sBO)],G.prototype,"cdRef",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",A.ld)],G.prototype,"wpDisplayRepresentation",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",F.F)],G.prototype,"wpIncludeSubprojects",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",I.J)],G.prototype,"halEvents",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",J.U)],G.prototype,"deviceService",void 0),(0,i.gn)([(0,N.W)(),(0,i.w6)("design:type",te.R)],G.prototype,"currentProject",void 0)},62964:(H,D,t)=>{"use strict";t.d(D,{q:()=>u});var i=t(67727),e=t(20979),c=t(2316);class u extends i.W{constructor(n,h){super(n),this.injector=n,this.apiV3Service=h}showSave(n,h=!1){const a={message:this.I18n.t("js.notice_successful_"+(h?"create":"update"))};this.addWorkPackageFullscreenLink(a,n),this.ToastService.addSuccess(a)}showCustomError(n,h){return"urn:openproject-org:api:v3:errors:UpdateConflict"===n.errorIdentifier?(this.ToastService.addError({message:n.message,type:"error",link:{text:this.I18n.t("js.hal.error.update_conflict_refresh"),target:()=>this.apiV3Service.work_packages.id(h).refresh()}}),!0):super.showCustomError(n,h)}addWorkPackageFullscreenLink(n,h){this.$state.includes("work-packages.show")||(n.link={target:()=>this.$state.go("work-packages.show.tabs",{tabIdentifier:"activity",workPackageId:h.id}),text:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")})}}u.\u0275fac=function(n){return new(n||u)(c.LFG(c.zs3),c.LFG(e.T))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},56686:(H,D,t)=>{"use strict";t.d(D,{h:()=>p});var i=t(47775),e=t(70233),c=t(55977),u=t(36293),r=t(96617),n=t(1403),h=t(2316),a=t(53882);class p{constructor(d,g,C,y,m,E,P){this.http=d,this.$state=g,this.PathHelper=C,this.UrlParamsHelper=y,this.toastService=m,this.I18n=E,this.halEvents=P,this.text={successful_delete:this.I18n.t("js.work_packages.message_successful_bulk_delete")}}performBulkDelete(d,g){const C={"ids[]":d},y=this.http.delete(this.PathHelper.workPackagesBulkDeletePath(),{params:C,withCredentials:!0}).toPromise();return g&&y.then(()=>{this.toastService.addSuccess(this.text.successful_delete),d.forEach(m=>this.halEvents.push({_type:"WorkPackage",id:m},{eventType:"deleted"})),this.$state.includes("**.list.details.**")&&d.indexOf(this.$state.params.workPackageId)>-1&&this.$state.go("work-packages.partitioned.list",this.$state.params)}).catch(()=>{const m=this.UrlParamsHelper.buildQueryString(C);window.location.href=`${this.PathHelper.workPackagesBulkDeletePath()}?${m}`}),y}}p.\u0275fac=function(d){return new(d||p)(h.LFG(a.eN),h.LFG(i.StateService),h.LFG(e.j),h.LFG(c.Z),h.LFG(u.kl),h.LFG(r.D),h.LFG(n.J))},p.\u0275prov=h.Yz7({token:p,factory:p.\u0275fac})},97661:(H,D,t)=>{"use strict";t.d(D,{c:()=>O});var i=t(43682),c=(t(80044),t(26942)),u=t(29351),r=t(33927),n=t(79902),h=t(98636),a=t(84699),p=t(2316),l=t(54364),d=t(81134),g=t(96617),C=t(70233),y=t(32042),m=t(10190),E=t(2775),P=t(70692);function w(A,F){if(1&A&&p._UZ(0,"span",3),2&A){const I=p.oxw();p.Q6J("textContent",I.authorName)}}function x(A,F){if(1&A&&p._UZ(0,"a",3),2&A){const I=p.oxw();p.Q6J("textContent",I.authorName),p.uIk("href",I.authorLink,p.LSH)}}class k{constructor(F,I){this.PathHelper=F,this.timezoneService=I}get authorName(){return this.author&&this.author.name||""}get authorLink(){return this.author&&this.PathHelper.userPath(this.author.id)||""}ngOnInit(){this.createdOnTime=this.timezoneService.parseDatetime(this.createdOn),this.timeago=this.createdOnTime.fromNow(),this.time=this.createdOnTime.format("LLL")}}function b(A,F){if(1&A){const I=p.EpF();p.TgZ(0,"a",7),p.NdJ("click",function(N){return p.CHM(I),p.oxw().confirmRemoveAttachment(N)}),p._UZ(1,"op-icon",8),p.qZA()}if(2&A){const I=p.oxw();p.xp6(1),p.Q6J("icon-title",I.deleteIconTitle)}}k.\u0275fac=function(F){return new(F||k)(p.Y36(C.j),p.Y36(P.B))},k.\u0275cmp=p.Xpm({type:k,selectors:[["op-authoring"]],inputs:{createdOn:"createdOn",author:"author",showAuthorAsLink:"showAuthorAsLink"},decls:4,vars:4,consts:[[1,"op-authoring"],[3,"textContent",4,"ngIf"],[1,"op-authoring--timestamp",3,"textContent"],[3,"textContent"]],template:function(F,I){1&F&&(p.TgZ(0,"div",0),p.YNc(1,w,1,1,"span",1),p.YNc(2,x,1,2,"a",1),p._UZ(3,"span",2),p.qZA()),2&F&&(p.xp6(1),p.Q6J("ngIf",I.showAuthorAsLink),p.xp6(1),p.Q6J("ngIf",!I.showAuthorAsLink),p.xp6(1),p.Q6J("textContent",I.timeago),p.uIk("title",I.time))},directives:[l.O5],styles:['.op-authoring--timestamp[_ngcontent-%COMP%]:before{content:" ";white-space:pre}'],changeDetection:0});class v{constructor(F,I,J){this.principalsResourceService=F,this.I18n=I,this.pathHelper=J,this.destroyImmediately=!0,this.removeAttachment=new p.vpe,this.text={dragHint:this.I18n.t("js.attachments.draggable_hint"),destroyConfirmation:this.I18n.t("js.text_attachment_destroy_confirmation"),removeFile:N=>this.I18n.t("js.label_remove_file",N)}}get deleteIconTitle(){return this.text.removeFile({fileName:this.attachment.fileName})}ngOnInit(){const F=(0,m.Z)(this.attachment._links.author.href);this.author$=this.principalsResourceService.query.selectEntity(F).pipe((0,n.w)(I=>I?(0,d.of)(I):this.principalsResourceService.fetchUser(F)),(0,r.U)(I=>I))}setDragData(F){const I=this.downloadPath,J=this.draggableHTML(I);null!=F.dataTransfer&&(F.dataTransfer.setData("text/plain",I),F.dataTransfer.setData("text/html",J.outerHTML),F.dataTransfer.setData("text/uri-list",I),F.dataTransfer.setDragImage(J,0,0))}draggableHTML(F){let I;return this.isImage?(I=document.createElement("img"),I.src=F,I.textContent=this.fileName):(I=document.createElement("a"),I.href=F,I.textContent=this.fileName),I}get downloadPath(){return this.pathHelper.attachmentDownloadPath(String(this.attachment.id),this.fileName)}get isImage(){const F=this.fileName.split(".").pop()||"";return v.imageFileExtensions.indexOf(F.toLowerCase())>-1}get fileName(){return this.attachment.fileName}confirmRemoveAttachment(F){return window.confirm(this.text.destroyConfirmation)?(this.removeAttachment.emit(),!1):(F.stopImmediatePropagation(),F.preventDefault(),!1)}}function M(A,F){if(1&A){const I=p.EpF();p.TgZ(0,"ul",3),p.TgZ(1,"op-attachment-list-item",4),p.NdJ("removeAttachment",function(){const te=p.CHM(I).$implicit;return p.oxw(2).removeAttachment(te)}),p.qZA(),p.qZA()}if(2&A){const I=F.$implicit,J=F.index,N=p.oxw(2);p.xp6(1),p.Q6J("attachment",I)("resource",N.resource)("index",J)}}function S(A,F){if(1&A&&(p.TgZ(0,"div",1),p.YNc(1,M,2,3,"ul",2),p.ALo(2,"async"),p.qZA()),2&A){const I=p.oxw();p.xp6(1),p.Q6J("ngForOf",p.lcZ(2,2,I.$attachments))("ngForTrackBy",I.trackByFileName)}}v.imageFileExtensions=["jpeg","jpg","gif","bmp","png"],v.\u0275fac=function(F){return new(F||v)(p.Y36(y.P),p.Y36(g.D),p.Y36(C.j))},v.\u0275cmp=p.Xpm({type:v,selectors:[["op-attachment-list-item"]],inputs:{resource:"resource",attachment:"attachment",index:"index",destroyImmediately:"destroyImmediately"},outputs:{removeAttachment:"removeAttachment"},decls:9,vars:11,consts:[["opFocusWithin",".inplace-editing--trigger-icon","draggable","true","data-qa-selector","op-attachment-list-item",1,"form--selected-value--container","work-package--attachments--draggable-item",3,"title","dragstart"],[1,"form--selected-value"],["icon-classes","icon-context icon-attachment"],["target","_blank","rel","noopener",1,"work-package--attachments--filename"],[1,"work-package--attachments--info",3,"createdOn","author","showAuthorAsLink"],["href","","class","form--selected-value--remover work-package--attachments--delete-button",3,"click",4,"ngIf"],["type","hidden",3,"name","value"],["href","",1,"form--selected-value--remover","work-package--attachments--delete-button",3,"click"],["icon-classes","icon-delete",3,"icon-title"]],template:function(F,I){1&F&&(p.TgZ(0,"li",0),p.NdJ("dragstart",function(N){return I.setDragData(N)}),p.TgZ(1,"span",1),p._UZ(2,"op-icon",2),p.TgZ(3,"a",3),p._uU(4),p._UZ(5,"op-authoring",4),p.ALo(6,"async"),p.qZA(),p.qZA(),p.YNc(7,b,2,1,"a",5),p._UZ(8,"input",6),p.qZA()),2&F&&(p.Q6J("title",I.text.dragHint),p.xp6(3),p.uIk("href",I.downloadPath||"#",p.LSH),p.xp6(1),p.hij(" ",I.fileName," "),p.xp6(1),p.Q6J("createdOn",I.attachment.createdAt)("author",p.lcZ(6,9,I.author$))("showAuthorAsLink",!1),p.xp6(2),p.Q6J("ngIf",!!I.attachment._links.delete),p.xp6(1),p.MGl("name","attachments[",I.index,"][id]"),p.s9C("value",I.attachment.id))},directives:[E.o,k,l.O5],pipes:[l.Ov],encapsulation:2,changeDetection:0});class O extends c.N{constructor(F){super(),this.attachmentsResourceService=F,this.trackByFileName=(0,i.AT)("fileName")}get attachmentsSelfLink(){return this.resource.attachments.href}get collectionKey(){return(0,a.Z)(this.resource)?"new":this.attachmentsSelfLink}ngOnInit(){(0,a.Z)(this.resource)||this.attachmentsResourceService.requireCollection(this.attachmentsSelfLink),this.$attachments=this.attachmentsResourceService.query.select().pipe(this.untilDestroyed(),(0,r.U)(F=>{var I;return null===(I=F.collections[this.collectionKey])||void 0===I?void 0:I.ids}),(0,n.w)(F=>this.attachmentsResourceService.query.selectMany(F)),(0,h.b)(F=>{(0,a.Z)(this.resource)&&(this.resource.attachments={elements:F.map(I=>I._links.self)})}))}removeAttachment(F){this.attachmentsResourceService.removeAttachment(this.collectionKey,F).subscribe()}}O.\u0275fac=function(F){return new(F||O)(p.Y36(u.v))},O.\u0275cmp=p.Xpm({type:O,selectors:[["op-attachment-list"]],inputs:{resource:"resource"},features:[p.qOj],decls:1,vars:1,consts:[["class","work-package--attachments--files",4,"ngIf"],[1,"work-package--attachments--files"],["class","form--selected-value--list",4,"ngFor","ngForOf","ngForTrackBy"],[1,"form--selected-value--list"],[3,"attachment","resource","index","removeAttachment"]],template:function(F,I){1&F&&p.YNc(0,S,3,4,"div",0),2&F&&p.Q6J("ngIf",I.resource)},directives:[l.O5,l.sg,v],pipes:[l.Ov],encapsulation:2,changeDetection:0})},14274:(H,D,t)=>{"use strict";t.d(D,{s:()=>g});var i=t(96617),e=t(12877),u=(t(80044),t(91923)),r=t(36293),n=t(29351),h=t(2316),a=t(54364),p=t(2775);const l=["hiddenFileInput"];function d(C,y){if(1&C){const m=h.EpF();h.TgZ(0,"div",1),h.NdJ("drop",function(P){return h.CHM(m),h.oxw().onDropFiles(P)})("dragover",function(P){return h.CHM(m),h.oxw().onDragOver(P)})("dragleave",function(P){return h.CHM(m),h.oxw().onDragLeave(P)}),h.TgZ(1,"input",2,3),h.NdJ("change",function(){return h.CHM(m),h.oxw().onFilePickerChanged()}),h.qZA(),h.TgZ(3,"button",4),h.NdJ("click",function(P){return h.CHM(m),h.oxw().triggerFileInput(P)}),h.TgZ(4,"span",5),h._UZ(5,"op-icon",6),h.TgZ(6,"label",7),h._uU(7),h._UZ(8,"br"),h._uU(9),h.qZA(),h.qZA(),h.qZA(),h.qZA()}if(2&C){const m=h.oxw();h.uIk("aria-label",m.text.uploadLabel),h.xp6(3),h.ekj("-dragging",m.draggingOver),h.xp6(4),h.hij(" ",m.text.dropFiles," "),h.xp6(2),h.hij(" ",m.text.dropFilesHint," ")}}class g{constructor(y,m,E,P,w,x){this.I18n=y,this.attachmentsResourceService=m,this.configurationService=E,this.toastService=P,this.elementRef=w,this.halResourceService=x,this.draggingOver=!1,this.text={uploadLabel:this.I18n.t("js.label_add_attachments"),dropFiles:this.I18n.t("js.label_drop_files"),dropFilesHint:this.I18n.t("js.label_drop_files_hint"),foldersWarning:this.I18n.t("js.label_drop_folders_hint")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.configurationService.initialized.then(()=>{this.maxFileSize=this.configurationService.maximumAttachmentFileSize})}triggerFileInput(y){return this.filePicker.nativeElement.click(),y.preventDefault(),y.stopPropagation(),!1}onDropFiles(y){if(null===y.dataTransfer)return;y.dataTransfer.dropEffect="copy",y.preventDefault(),y.stopPropagation();const m=y.dataTransfer.files,E=m?m.length:0,P=[];for(let w=0;w<E;w++)P.push(m[w]);this.uploadFiles(P),this.draggingOver=!1}onDragOver(y){null!==y.dataTransfer&&g.containsFiles(y.dataTransfer)&&(y.dataTransfer.dropEffect="copy",this.draggingOver=!0),y.preventDefault(),y.stopPropagation()}onDragLeave(y){this.draggingOver=!1,y.preventDefault(),y.stopPropagation()}onFilePickerChanged(){const y=this.filePicker.nativeElement.files;if(null===y)return;const m=Array.from(y);this.uploadFiles(m)}static containsFiles(y){return y.types.indexOf("Files")>=0}uploadFiles(y){let m=y||[];const E=y.length;m=this.filterFolders(m),0!==m.length?this.attachmentsResourceService.attachFiles(this.resource,m).subscribe():E>0&&this.toastService.addNotice(this.text.foldersWarning)}filterFolders(y){return y.filter(m=>""!==m.type||(0!==m.size&&4096!==m.size||(console.warn(`Skipping file because of file size (${m.size}) %O`,m),!1)))}}g.\u0275fac=function(y){return new(y||g)(h.Y36(i.D),h.Y36(n.v),h.Y36(e.e),h.Y36(r.kl),h.Y36(h.SBq),h.Y36(u.u))},g.\u0275cmp=h.Xpm({type:g,selectors:[["op-attachments-upload"]],viewQuery:function(y,m){if(1&y&&h.Gf(l,5),2&y){let E;h.iGM(E=h.CRH())&&(m.filePicker=E.first)}},inputs:{resource:"resource"},decls:1,vars:1,consts:[["class","wp-attachment-upload hide-when-print",3,"drop","dragover","dragleave",4,"ngIf"],[1,"wp-attachment-upload","hide-when-print",3,"drop","dragover","dragleave"],["type","file","id","attachment_files","name","attachment_files","hidden","","multiple","",3,"change"],["hiddenFileInput",""],["type","button",1,"work-package--attachments--drop-box",3,"click"],[1,"work-package--attachments--label"],["icon-classes","icon-attachment"],["for","attachment_files"]],template:function(y,m){1&y&&h.YNc(0,d,10,5,"div",0),2&y&&h.Q6J("ngIf",m.resource.canAddAttachments)},directives:[a.O5,p.o],encapsulation:2,changeDetection:0})},41689:(H,D,t)=>{"use strict";t.d(D,{e:()=>y,t:()=>m});t(80044);var e=t(91923),c=t(96617),u=t(87853),r=t(9170),n=t(26942),h=t(2316),a=t(54364),p=t(97661),l=t(14274);function d(E,P){if(1&E&&h._UZ(0,"op-attachment-list",6),2&E){const w=h.oxw(2);h.Q6J("resource",w.resource)}}function g(E,P){if(1&E&&h._UZ(0,"op-attachments-upload",7),2&E){const w=h.oxw(2);h.Q6J("resource",w.resource)}}function C(E,P){if(1&E&&(h.TgZ(0,"fieldset",1),h.TgZ(1,"legend",2),h._uU(2),h.qZA(),h.TgZ(3,"div",3),h.YNc(4,d,1,1,"op-attachment-list",4),h.YNc(5,g,1,1,"op-attachments-upload",5),h.qZA(),h.qZA()),2&E){const w=h.oxw();h.xp6(2),h.hij(" ",w.text.attachments," "),h.xp6(2),h.Q6J("ngIf",w.resource.attachments),h.xp6(1),h.Q6J("ngIf",w.allowUploading)}}const y="attachments";class m extends n.N{constructor(P,w,x,k){super(),this.elementRef=P,this.I18n=w,this.states=x,this.halResourceService=k,this.text={attachments:this.I18n.t("js.label_attachments")}}ngOnInit(){if(this.$element=jQuery(this.elementRef.nativeElement),!this.resource){const P=this.$element.data("resource");this.resource=this.halResourceService.createHalResource(P,!0)}this.allowUploading=this.$element.data("allow-uploading"),void 0!==this.$element.data("destroy-immediately")?this.destroyImmediately=this.$element.data("destroy-immediately"):this.destroyImmediately=!0,this.setupResourceUpdateListener()}setupResourceUpdateListener(){this.states.forResource(this.resource).changes$().pipe(this.untilDestroyed(),(0,r.h)(P=>!!P)).subscribe(P=>{this.resource=P||this.resource})}showAttachments(){return this.allowUploading||_.get(this.resource,"attachments.count",0)>0}}m.\u0275fac=function(P){return new(P||m)(h.Y36(h.SBq),h.Y36(c.D),h.Y36(u.G),h.Y36(e.u))},m.\u0275cmp=h.Xpm({type:m,selectors:[["attachments"]],inputs:{resource:"resource"},features:[h.qOj],decls:1,vars:1,consts:[["class","form--fieldset",4,"ngIf"],[1,"form--fieldset"],[1,"form--fieldset-legend"],["id","attachments_fields"],[3,"resource",4,"ngIf"],["class","hide-when-print",3,"resource",4,"ngIf"],[3,"resource"],[1,"hide-when-print",3,"resource"]],template:function(P,w){1&P&&h.YNc(0,C,6,3,"fieldset",0),2&P&&h.Q6J("ngIf",w.showAttachments())},directives:[a.O5,p.c,l.s],encapsulation:2})},31283:(H,D,t)=>{"use strict";t.d(D,{Z:()=>u});var i=t(54364),e=t(53875),c=t(2316);class u{}u.\u0275fac=function(n){return new(n||u)},u.\u0275mod=c.oAB({type:u}),u.\u0275inj=c.cJS({imports:[[i.ez,e.Q]]})},83845:(H,D,t)=>{"use strict";t.d(D,{y:()=>k,w:()=>x});var i=t(3786),e=t(2316),c=t(96617),u=t(77355),r=t(14808),n=t(20979),h=t(53466);class a{constructor(v){this.apiV3Service=v,this.helpTexts=(0,r.qH)()}require(v,M){return this.load(),new Promise((S,O)=>{this.helpTexts.valuesPromise().then(()=>S(this.find(v,M)))})}requireById(v){return this.load(),this.helpTexts.values$().pipe((0,h.q)(1)).toPromise().then(()=>{const M=this.helpTexts.getValueOr([]);return _.find(M,S=>{var O;return(null===(O=S.id)||void 0===O?void 0:O.toString())===v.toString()})})}load(){this.helpTexts.putFromPromiseIfPristine(()=>this.apiV3Service.help_texts.get().toPromise().then(v=>v.elements))}find(v,M){const S=this.helpTexts.getValueOr([]);return _.find(S,O=>O.scope===M&&O.attribute===v)}}a.\u0275fac=function(v){return new(v||a)(e.LFG(n.T))},a.\u0275prov=e.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"});var p=t(60312),l=t(52932),d=t(41689),g=t(54364),C=t(2775);function y(b,v){if(1&b&&(e.TgZ(0,"a",9),e._UZ(1,"op-icon",10),e._UZ(2,"span",11),e.qZA()),2&b){const M=e.oxw();e.uIk("href",M.helpTextLink,e.LSH)("title",M.text.edit),e.xp6(2),e.Q6J("textContent",M.text.edit)}}class m extends p.T{constructor(v,M,S,O){super(v,S,O),this.locals=v,this.I18n=M,this.cdRef=S,this.elementRef=O,this.closeOnEscape=!0,this.closeOnOutsideClick=!1,this.text={edit:this.I18n.t("js.button_edit"),close:this.I18n.t("js.button_close")},this.helpText=this.locals.helpText}ngOnInit(){super.ngOnInit(),this.helpText.attachments.$load().then(()=>this.cdRef.detectChanges())}get helpTextLink(){return this.helpText.editText?this.helpText.editText.$link.href:""}}m.\u0275fac=function(v){return new(v||m)(e.Y36(u.E),e.Y36(c.D),e.Y36(e.sBO),e.Y36(e.SBq))},m.\u0275cmp=e.Xpm({type:m,selectors:[["ng-component"]],features:[e.qOj],decls:9,vars:4,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_autoheight","attribute-help-text--modal","loading-indicator--location"],[3,"close"],[1,"icon-context","icon-help1"],[3,"textContent"],[1,"op-modal--body","op-modal--body_limited-height"],[1,"op-uc-container","op-uc-container__no-permalinks",3,"innerHtml"],["data-allow-uploading","false",3,"resource"],[1,"op-modal--footer"],["class","help-text--edit-button button",4,"ngIf"],[1,"help-text--edit-button","button"],["icon-classes","button--icon icon-edit"],[1,"button--text",3,"textContent"]],template:function(v,M){1&v&&(e.TgZ(0,"div",0),e.TgZ(1,"op-modal-header",1),e.NdJ("close",function(O){return M.closeMe(O)}),e._UZ(2,"span",2),e._UZ(3,"span",3),e.qZA(),e.TgZ(4,"div",4),e._UZ(5,"div",5),e._UZ(6,"attachments",6),e.qZA(),e.TgZ(7,"div",7),e.YNc(8,y,3,3,"a",8),e.qZA(),e.qZA()),2&v&&(e.xp6(3),e.Q6J("textContent",M.helpText.attributeCaption),e.xp6(2),e.Q6J("innerHtml",M.helpText.helpText.html,e.oJD),e.xp6(1),e.Q6J("resource",M.helpText),e.xp6(2),e.Q6J("ngIf",M.helpText.editText))},directives:[l.g,d.t,g.O5,C.o],encapsulation:2,changeDetection:0});var E=t(58004);function P(b,v){if(1&b&&e._UZ(0,"span",4),2&b){const M=e.oxw(2);e.Q6J("textContent",M.additionalLabel)}}function w(b,v){if(1&b){const M=e.EpF();e.TgZ(0,"div",1),e.NdJ("click",function(O){return e.CHM(M),e.oxw().handleClick(O)})("keydown.enter",function(O){return e.CHM(M),e.oxw().handleClick(O)})("keydown.space",function(O){return e.CHM(M),e.oxw().handleClick(O)}),e.YNc(1,P,1,1,"span",2),e._UZ(2,"op-icon",3),e.qZA()}if(2&b){const M=e.oxw();e.Q6J("title",M.text.open_dialog),e.uIk("data-qa-help-text-for",M.attribute),e.xp6(1),e.Q6J("ngIf",M.additionalLabel)}}const x="attribute-help-text";let k=class{constructor(v,M,S,O,A,F){this.elementRef=v,this.attributeHelpTexts=M,this.opModalService=S,this.cdRef=O,this.injector=A,this.I18n=F,this.exists=!1,this.text={open_dialog:this.I18n.t("js.help_texts.show_modal"),edit:this.I18n.t("js.button_edit"),close:this.I18n.t("js.button_close")}}ngOnInit(){this.helpTextId?this.exists=!0:this.load().then(v=>(this.exists=!!v,this.cdRef.detectChanges(),v))}handleClick(v){this.load().then(M=>{this.opModalService.show(m,this.injector,{helpText:M})}),v.preventDefault()}load(){return this.helpTextId?this.attributeHelpTexts.requireById(this.helpTextId):this.attributeHelpTexts.require(this.attribute,this.attributeScope)}};k.\u0275fac=function(v){return new(v||k)(e.Y36(e.SBq),e.Y36(a),e.Y36(u.S),e.Y36(e.sBO),e.Y36(e.zs3),e.Y36(c.D))},k.\u0275cmp=e.Xpm({type:k,selectors:[["attribute-help-text"]],inputs:{attribute:"attribute",additionalLabel:"additionalLabel",attributeScope:"attributeScope",helpTextId:"helpTextId"},decls:1,vars:1,consts:[["class","spot-link help-text--entry","role","button","tabindex","0",3,"title","click","keydown.enter","keydown.space",4,"ngIf"],["role","button","tabindex","0",1,"spot-link","help-text--entry",3,"title","click","keydown.enter","keydown.space"],[3,"textContent",4,"ngIf"],["icon-classes","icon3 icon-help1"],[3,"textContent"]],template:function(v,M){1&v&&e.YNc(0,w,3,3,"div",0),2&v&&e.Q6J("ngIf",M.exists)},directives:[g.O5,C.o],encapsulation:2,changeDetection:0}),k=(0,i.gn)([E.z,(0,i.w6)("design:paramtypes",[e.SBq,a,u.S,e.sBO,e.zs3,c.D])],k)},71858:(H,D,t)=>{"use strict";t.d(D,{a:()=>n});var i=t(54364),e=t(55811),c=t(31283),u=t(53875),r=t(2316);class n{}n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=r.oAB({type:n}),n.\u0275inj=r.cJS({providers:[],imports:[[i.ez,e.K,c.Z,u.Q]]})},7301:(H,D,t)=>{"use strict";t.d(D,{$:()=>r,r:()=>n});var i=t(36868),e=t(2316),c=t(1707);function u(h,a){if(1&h&&e._uU(0),2&h){const p=a.item;e.hij(" ",p.label," ")}}const r="autocomplete-select-decoration";class n{constructor(a){this.elementRef=a,this.multiselect=!1}ngOnInit(){const a=this.elementRef.nativeElement;this.multiselect="true"===a.dataset.multiselect,this.labelForId=a.dataset.inputId,this.syncInputFieldName=a.dataset.inputName,this.multiselect&&(this.syncInputFieldName+="[]");const p=JSON.parse(a.dataset.options);this.setInitialSelection(p),this.multiselect||(this.selected=this.selected[0]),this.options=p,a.parentElement.hidden=!1}setInitialSelection(a){this.updateSelection(a.filter(p=>p.selected))}updateSelection(a){this.selected=a,a=_.castArray(a),this.removeCurrentSyncedFields(),a.forEach(p=>{this.createSyncedField(p.value)})}createSyncedField(a){jQuery(this.elementRef.nativeElement).parent().append(`<input type="hidden" name="${this.syncInputFieldName||""}" value="${a}" />`)}removeCurrentSyncedFields(){jQuery(this.elementRef.nativeElement).parent().find(`input[name="${this.syncInputFieldName}"]`).remove()}}n.\u0275fac=function(a){return new(a||n)(e.Y36(e.SBq))},n.\u0275cmp=e.Xpm({type:n,selectors:[["autocomplete-select-decoration"]],viewQuery:function(a,p){if(1&a&&e.Gf(i.w9,5),2&a){let l;e.iGM(l=e.CRH())&&(p.ngSelectComponent=l.first)}},decls:2,vars:5,consts:[["bindLabel","label","appendTo","body","placeholder","Please select",3,"items","labelForId","multiple","virtualScroll","ngModel","ngModelChange"],["ng-option-tmp",""]],template:function(a,p){1&a&&(e.TgZ(0,"ng-select",0),e.NdJ("ngModelChange",function(d){return p.updateSelection(d)}),e.YNc(1,u,1,1,"ng-template",1),e.qZA()),2&a&&e.Q6J("items",p.options)("labelForId",p.labelForId)("multiple",p.multiselect)("virtualScroll",!0)("ngModel",p.selected)},directives:[i.w9,c.JJ,c.On,i.Z2],encapsulation:2})},44265:(H,D,t)=>{"use strict";t.d(D,{q:()=>e});var i=t(2316);class e{}e.\u0275fac=function(u){return new(u||e)},e.\u0275dir=i.lG2({type:e,selectors:[["","op-autocompleter-footer-tmp",""]]})},66220:(H,D,t)=>{"use strict";t.d(D,{c:()=>S});var i=t(3786),e=t(2316),c=t(36868),u=t(96617),r=t(2308),n=t(65146),h=t(70233),p=(t(80044),t(26942)),l=t(29161),d=t(46862),g=t(43682),C=t(9170),y=t(1707),m=t(54364),E=t(3353),P=t(3742),w=t(28470);function x(O,A){if(1&O&&(e._UZ(0,"b",5),e._uU(1)),2&O){const F=A.searchTerm,I=e.oxw();e.Q6J("textContent",I.text.add_new_action),e.xp6(1),e.hij(": ",F," ")}}function k(O,A){if(1&O&&e._UZ(0,"op-principal",8),2&O){const F=e.oxw().item;e.Q6J("hideName",!0)("principal",F)}}function b(O,A){if(1&O&&(e.YNc(0,k,1,2,"op-principal",6),e._UZ(1,"span",7)),2&O){const F=A.item,I=A.searchTerm,J=e.oxw();e.Q6J("ngIf",J.isPrincipal(F)),e.xp6(1),e.Q6J("ngOptionHighlight",I)("textContent",F.name)}}function v(O,A){if(1&O&&e._UZ(0,"op-invite-user-button",10),2&O){const F=e.oxw(2);e.Q6J("projectId",null==F.resource.project?null:F.resource.project.id)}}function M(O,A){1&O&&e.YNc(0,v,1,1,"ng-template",9)}class S extends p.N{constructor(A){super(),this.injector=A,this.required=!1,this.disabled=!1,this.finishedLoading=!1,this.id="",this.classes="",this.hideSelected=!1,this.onChange=new e.vpe,this.onKeydown=new e.vpe,this.onOpen=new e.vpe,this.onClose=new e.vpe,this.onAfterViewInit=new e.vpe,this.onAddNew=new e.vpe,this.compareByHref=g.U5,this.text={},this.createAllowed=!1,this._openDirectly=!1,this.text.add_new_action=this.I18n.t("js.label_create")}ngAfterViewInit(){this.onAfterViewInit.emit(this),this.opInviteUserModalService&&this.opInviteUserModalService.close.pipe(this.untilDestroyed(),(0,C.h)(A=>!!A)).subscribe(A=>{this.onAddNew.emit(A)})}openSelect(){this.ngSelectComponent&&(this.ngSelectComponent.open(),this.openDirectly=!1)}closeSelect(){this.ngSelectComponent&&this.ngSelectComponent.close()}changeModel(A){this.onChange.emit(A)}opened(){setTimeout(()=>{const A=this.ngSelectComponent;this.appendTo&&A&&A.dropdownPanel&&A.dropdownPanel._updatePosition()},25),this.onOpen.emit()}closed(){this.openDirectly=!1,this.onClose.emit()}keyPressed(A){this.onKeydown.emit(A)}get openDirectly(){return this._openDirectly}set openDirectly(A){this._openDirectly=A,A&&this.openSelect()}focusInputField(){this.ngSelectComponent&&this.ngSelectComponent.focus()}isPrincipal(A){return A.href&&null!==(0,d.l)(A.href)}}S.\u0275fac=function(A){return new(A||S)(e.Y36(e.zs3))},S.\u0275cmp=e.Xpm({type:S,selectors:[["create-autocompleter"]],viewQuery:function(A,F){if(1&A&&e.Gf(c.w9,5),2&A){let I;e.iGM(I=e.CRH())&&(F.ngSelectComponent=I.first)}},inputs:{availableValues:"availableValues",appendTo:"appendTo",resource:"resource",model:"model",required:"required",disabled:"disabled",finishedLoading:"finishedLoading",id:"id",classes:"classes",typeahead:"typeahead",hideSelected:"hideSelected",showAddNewButton:"showAddNewButton"},outputs:{onChange:"onChange",onKeydown:"onKeydown",onOpen:"onOpen",onClose:"onClose",onAfterViewInit:"onAfterViewInit",onAddNew:"onAddNew"},features:[e._Bn([r.j]),e.qOj],decls:5,vars:16,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","compareWith","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[4,"ngIf"],[3,"textContent"],["size","mini",3,"hideName","principal",4,"ngIf"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent"],["size","mini",3,"hideName","principal"],["ng-footer-tmp",""],[1,"op-select-footer",3,"projectId"]],template:function(A,F){1&A&&(e.TgZ(0,"ng-select",0,1),e.NdJ("ngModelChange",function(J){return F.model=J})("change",function(J){return F.changeModel(J)})("open",function(){return F.opened()})("close",function(){return F.closed()})("keydown",function(J){return F.keyPressed(J)}),e.YNc(2,x,2,2,"ng-template",2),e.YNc(3,b,2,3,"ng-template",3),e.YNc(4,M,1,0,void 0,4),e.qZA()),2&A&&(e.Q6J("ngModel",F.model)("items",F.availableValues)("ngClass",F.classes)("addTag",F.createAllowed)("virtualScroll",!0)("required",F.required)("clearable",!F.required)("disabled",F.disabled)("typeahead",F.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",F.appendTo)("hideSelected",F.hideSelected)("compareWith",F.compareByHref)("id",F.id),e.xp6(4),e.Q6J("ngIf",F.showAddNewButton))},directives:[c.w9,y.JJ,y.On,m.mk,y.Q7,c.N6,c.Z2,m.O5,E.s,P.N,c.x0,w.R],styles:[".button.-tiny[_ngcontent-%COMP%]{margin:0}"]}),(0,i.gn)([(0,l.W)(),(0,i.w6)("design:type",r.j)],S.prototype,"opInviteUserModalService",void 0),(0,i.gn)([(0,l.W)(),(0,i.w6)("design:type",u.D)],S.prototype,"I18n",void 0),(0,i.gn)([(0,l.W)(),(0,i.w6)("design:type",e.sBO)],S.prototype,"cdRef",void 0),(0,i.gn)([(0,l.W)(),(0,i.w6)("design:type",n.R)],S.prototype,"currentProject",void 0),(0,i.gn)([(0,l.W)(),(0,i.w6)("design:type",h.j)],S.prototype,"pathHelper",void 0)},29212:(H,D,t)=>{"use strict";t.d(D,{i:()=>g});var i=t(2316),e=t(96617),c=t(35900),u=t(26942),r=t(89919),n=t(87873),h=t(82503),a=t(54364),p=t(36868);const l=["ngSelectComponent"];function d(C,y){if(1&C){const m=i.EpF();i.TgZ(0,"div",5),i._UZ(1,"span",6),i.TgZ(2,"a",7),i.NdJ("click",function(){const w=i.CHM(m).$implicit;return i.oxw().remove(w)}),i.qZA(),i.qZA()}if(2&C){const m=y.$implicit;i.xp6(1),i.Q6J("textContent",m.name)}}class g extends u.N{constructor(y,m){super(),this.I18n=y,this.dragula=m,this.autofocus=!0,this._selected=[],this.onChange=new i.vpe,this.availableOptions=[],this.text={placeholder:this.I18n.t("js.label_add_columns")}}ngOnInit(){this.updateAvailableOptions(),this.columnsGroup=this.dragula.createGroup("columns",{}),this.dragula.drag("columns").pipe(this.untilDestroyed()).subscribe(()=>(0,n.h)("move","important")),(0,r.T)(this.dragula.drop("columns"),this.dragula.cancel("columns")).pipe(this.untilDestroyed()).subscribe(()=>(0,n.h)("auto"));const y=this;this.autoscroll=new c.x([document.getElementById("content-wrapper")],{margin:25,maxSpeed:10,scrollWhenOutside:!0,autoScroll(){return this.down&&y.columnsGroup.drake.dragging}})}ngAfterViewInit(){this.autofocus&&this.ngSelectComponent.focus()}ngOnDestroy(){super.ngOnDestroy(),this.dragula.destroy("columns")}select(y){!y||(this.selected=[...this.selected,y],this.ngSelectComponent.clearModel())}remove(y){this.selected=this.selected.filter(m=>m.id!==y.id)}get selected(){return this._selected}set selected(y){this._selected=y,this.updateAvailableOptions(),this.onChange.emit(this.selected)}opened(){setTimeout(()=>{const y=this.ngSelectComponent;y&&y.dropdownPanel&&y.dropdownPanel._updatePosition()},25)}updateAvailableOptions(){this.availableOptions=this.options.filter(y=>!this.selected.find(m=>m.id===y.id))}}g.\u0275fac=function(y){return new(y||g)(i.Y36(e.D),i.Y36(h.pQ))},g.\u0275cmp=i.Xpm({type:g,selectors:[["draggable-autocompleter"]],viewQuery:function(y,m){if(1&y&&i.Gf(l,5),2&y){let E;i.iGM(E=i.CRH())&&(m.ngSelectComponent=E.first)}},inputs:{options:"options",autofocus:"autofocus",_selected:["selected","_selected"]},outputs:{onChange:"onChange"},features:[i.qOj],decls:5,vars:8,consts:[[1,"op-draggable-autocomplete"],["dragula","columns",1,"op-draggable-autocomplete--selected",3,"dragulaModel","dragulaModelChange"],["class","op-draggable-autocomplete--item",4,"ngFor","ngForOf"],["ngClass","op-draggable-autocomplete--input","bindLabel","name","appendTo","body",3,"items","multiple","virtualScroll","placeholder","clearSearchOnAdd","closeOnSelect","open","change"],["ngSelectComponent",""],[1,"op-draggable-autocomplete--item"],[1,"op-draggable-autocomplete--item-text",3,"textContent"],[1,"op-draggable-autocomplete--remove-item","icon-remove",3,"click"]],template:function(y,m){1&y&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.NdJ("dragulaModelChange",function(P){return m.selected=P}),i.YNc(2,d,3,1,"div",2),i.qZA(),i.TgZ(3,"ng-select",3,4),i.NdJ("open",function(){return m.opened()})("change",function(P){return m.select(P)}),i.qZA(),i.qZA()),2&y&&(i.xp6(1),i.Q6J("dragulaModel",m.selected),i.xp6(1),i.Q6J("ngForOf",m.selected),i.xp6(1),i.Q6J("items",m.availableOptions)("multiple",!1)("virtualScroll",!0)("placeholder",m.text.placeholder)("clearSearchOnAdd",!0)("closeOnSelect",!0))},directives:[h.sW,a.sg,p.w9,a.mk],styles:[".op-draggable-autocomplete--selected[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;padding-bottom:1rem}.op-draggable-autocomplete--item[_ngcontent-%COMP%]{padding:5px;margin-right:5px;margin-bottom:5px;min-width:50px;border:1px solid #ddd;background:#F8F8F8;cursor:move;font-size:14px;display:flex;align-items:center;justify-content:space-between}.op-draggable-autocomplete--remove-item[_ngcontent-%COMP%]{font-size:8px;color:#999;padding-left:5px}"],changeDetection:0})},17208:(H,D,t)=>{"use strict";t.d(D,{S:()=>e});var i=t(2316);class e{}e.\u0275fac=function(u){return new(u||e)},e.\u0275dir=i.lG2({type:e,selectors:[["","op-autocompleter-header-tmp",""]]})},28830:(H,D,t)=>{"use strict";t.d(D,{v:()=>e});var i=t(2316);class e{}e.\u0275fac=function(u){return new(u||e)},e.\u0275dir=i.lG2({type:e,selectors:[["","op-autocompleter-label-tmp",""]]})},80104:(H,D,t)=>{"use strict";t.d(D,{u:()=>e});var i=t(2316);class e{}e.\u0275fac=function(u){return new(u||e)},e.\u0275dir=i.lG2({type:e,selectors:[["","op-autocompleter-option-tmp",""]]})},91593:(H,D,t)=>{"use strict";t.d(D,{s:()=>ue});var i=t(2316),e=t(76491),c=t(79441),u=t(89919),r=t(81134),n=t(90425),h=t(9170),a=t(83720),p=t(80639),l=t(98636),d=t(79902),g=t(50076),C=t(26942),y=t(96617),m=t(43682),E=t(44265),P=t(26269),w=t(33927),x=t(20979);class k extends C.N{constructor(R){super(),this.apiV3Service=R}loadAvailable(R,L,W,oe){const Oe=this.createFilters(null!=W?W:[],R,oe);return this.apiV3Service[L].filtered(Oe).get().pipe((0,w.U)(Xe=>Xe.elements))}createFilters(R,L,W){const oe=new P.qM;for(const Oe of R)oe.add(Oe.name,Oe.operator,Oe.values);return L&&oe.add(null!=W?W:"","**",[L]),oe}loadData(R,L,W,oe){return this.loadAvailable(R,L,W,oe)}}k.\u0275fac=function(R){return new(R||k)(i.LFG(x.T))},k.\u0275prov=i.Yz7({token:k,factory:k.\u0275fac});var b=t(17208),v=t(28830),M=t(80104),S=t(36868),O=t(1707),A=t(54364),F=t(3353),I=t(3742);const J=["ngSelectInstance"],N=function(ie,R,L){return{$implicit:ie,search:R,index:L}};function te(ie,R){if(1&ie&&i.GkF(0,9),2&ie){const L=R.item,W=R.index,oe=R.searchTerm,Oe=i.oxw(2);i.Q6J("ngTemplateOutlet",Oe.headerTemplate)("ngTemplateOutletContext",i.kEZ(2,N,L,oe,W))}}function ee(ie,R){1&ie&&i.YNc(0,te,1,6,"ng-template",8)}const G=function(ie,R,L,W){return{$implicit:ie,search:R,index:L,clear:W}};function se(ie,R){if(1&ie&&i.GkF(0,9),2&ie){const L=R.item,W=R.index,oe=R.searchTerm,Oe=R.clear,$=i.oxw(2),Xe=i.MAs(12);i.Q6J("ngTemplateOutlet",$.labelTemplate||Xe)("ngTemplateOutletContext",i.l5B(2,G,L,oe,W,Oe))}}function me(ie,R){1&ie&&i.YNc(0,se,1,7,"ng-template",10)}function _e(ie,R){if(1&ie&&i.GkF(0,9),2&ie){const L=R.item,W=R.index,oe=R.searchTerm,Oe=i.oxw(),$=i.MAs(10);i.Q6J("ngTemplateOutlet",Oe.optionTemplate?Oe.optionTemplate:$)("ngTemplateOutletContext",i.kEZ(2,N,L,oe,W))}}function he(ie,R){if(1&ie&&i.GkF(0,9),2&ie){const L=R.item,W=R.index,oe=R.searchTerm,Oe=i.oxw(2);i.Q6J("ngTemplateOutlet",Oe.footerTemplate)("ngTemplateOutletContext",i.kEZ(2,N,L,oe,W))}}function ae(ie,R){1&ie&&i.YNc(0,he,1,6,"ng-template",11)}function re(ie,R){if(1&ie&&i._UZ(0,"op-principal",22),2&ie){const L=i.oxw(2).$implicit;i.Q6J("principal",L.author)("hideName",!0)}}function ye(ie,R){if(1&ie&&i._UZ(0,"span",23),2&ie){const L=i.oxw(2).$implicit,W=i.oxw();i.MGl("textContent","",L.type.name," "),i.Q6J("ngClass",W.highlighting("type",L.type.id))}}function Ce(ie,R){if(1&ie&&(i.ynx(0),i.TgZ(1,"div",13),i.YNc(2,re,1,2,"op-principal",14),i.TgZ(3,"span",15),i.YNc(4,ye,1,2,"span",16),i._UZ(5,"span",17),i.qZA(),i.TgZ(6,"div",18),i._UZ(7,"span",19),i.TgZ(8,"span",20),i._uU(9),i.qZA(),i._UZ(10,"span",21),i.qZA(),i.qZA(),i.BQk()),2&ie){const L=i.oxw(),W=L.$implicit,oe=L.search,Oe=i.oxw();i.xp6(2),i.Q6J("ngIf",W.author&&W.author.href),i.xp6(2),i.Q6J("ngIf",W.type),i.xp6(1),i.Q6J("ngOptionHighlight",oe)("textContent",W.subject),i.xp6(2),i.Q6J("ngOptionHighlight",oe)("textContent",null==W.project?null:W.project.name),i.xp6(1),i.Q6J("ngOptionHighlight",oe),i.xp6(1),i.hij("#",W.id,""),i.xp6(1),i.Q6J("textContent",null==W.status?null:W.status.name)("ngClass",Oe.highlighting("status",null==W.status?null:W.status.id))}}function ke(ie,R){if(1&ie&&i._UZ(0,"op-principal",27),2&ie){const L=i.oxw(2).$implicit;i.Q6J("principal",L)("hideName",!0)}}function Ae(ie,R){if(1&ie&&(i.ynx(0),i.TgZ(1,"div",24),i.YNc(2,ke,1,2,"op-principal",25),i.TgZ(3,"span",26),i._uU(4),i.qZA(),i.qZA(),i.BQk()),2&ie){const L=i.oxw(),W=L.$implicit,oe=L.search;i.xp6(2),i.Q6J("ngIf",W&&W.href),i.xp6(1),i.Q6J("ngOptionHighlight",oe),i.xp6(1),i.Oqu(W.name)}}function Fe(ie,R){if(1&ie&&(i.ynx(0),i.TgZ(1,"span",28),i._uU(2),i.qZA(),i.BQk()),2&ie){const L=i.oxw(),W=L.search,oe=L.$implicit;i.xp6(1),i.Q6J("ngOptionHighlight",W),i.xp6(1),i.Oqu(oe.name)}}function ot(ie,R){if(1&ie&&(i.YNc(0,Ce,11,10,"ng-container",12),i.YNc(1,Ae,5,3,"ng-container",12),i.YNc(2,Fe,3,2,"ng-container",12)),2&ie){const L=i.oxw();i.Q6J("ngSwitchCase","work_packages"===L.resource||"parent-child"===L.resource),i.xp6(1),i.Q6J("ngSwitchCase","user"===L.resource||"assignee"===L.resource),i.xp6(1),i.Q6J("ngSwitchCase","subproject"===L.resource||"version"===L.resource||"status"===L.resource||"default"===L.resource||!L.resource)}}function it(ie,R){if(1&ie&&(i.ynx(0),i.TgZ(1,"span",28),i._uU(2),i.qZA(),i.BQk()),2&ie){const L=i.oxw(),W=L.search,oe=L.$implicit;i.xp6(1),i.Q6J("ngOptionHighlight",W),i.xp6(1),i.lnq(" ",null==oe.type?null:oe.type.name," #",oe.id," ",oe.subject," ")}}function Ve(ie,R){if(1&ie){const L=i.EpF();i.ynx(0),i.TgZ(1,"span",29),i.NdJ("click",function(){i.CHM(L);const oe=i.oxw(),Oe=oe.$implicit;return oe.clear(Oe)}),i._uU(2,"\xd7"),i.qZA(),i.TgZ(3,"span",30),i._uU(4),i.qZA(),i.BQk()}if(2&ie){const L=i.oxw(),W=L.search,oe=L.$implicit;i.xp6(3),i.Q6J("ngOptionHighlight",W),i.xp6(1),i.Oqu(oe.name)}}function Ie(ie,R){if(1&ie&&(i.YNc(0,it,3,4,"ng-container",3),i.YNc(1,Ve,5,2,"ng-container",3)),2&ie){const L=i.oxw();i.Q6J("ngIf","work_packages"===L.resource),i.xp6(1),i.Q6J("ngIf","work_packages"!==L.resource)}}class ue extends C.N{constructor(R,L,W,oe){super(),this.opAutocompleterService=R,this.cdRef=L,this.ngZone=W,this.I18n=oe,this.className=!0,this.filters=[],this.searchKey="",this.defaultData=!1,this.focusDirectly=!0,this.fetchDataDirectly=!1,this.labelRequired=!0,this.required=!1,this.searchable=!0,this.clearable=!0,this.addTag=!1,this.items$=new e.X(null),this.clearSearchOnAdd=!0,this.multiple=!1,this.openDirectly=!1,this.markFirst=!0,this.placeholder=this.I18n.t("js.autocompleter.placeholder"),this.notFoundText=this.I18n.t("js.autocompleter.notFoundText"),this.typeToSearchText=this.I18n.t("js.autocompleter.typeToSearchText"),this.loadingText=this.I18n.t("js.ajax.loading"),this.dropdownPosition="auto",this.closeOnSelect=!0,this.hideSelected=!1,this.selectOnTab=!1,this.bufferAmount=4,this.selectableGroup=!1,this.selectableGroupAsModel=!0,this.searchFn=null,this.trackByFn=null,this.clearOnBackspace=!0,this.labelForId=null,this.inputAttrs={},this.readonly=!1,this.searchWhileComposing=!0,this.minTermLength=0,this.editableSearchTerm=!1,this.keyDownFn=()=>!0,this.open=new i.vpe,this.close=new i.vpe,this.change=new i.vpe,this.focus=new i.vpe,this.blur=new i.vpe,this.search=new i.vpe,this.keydown=new i.vpe,this.clear=new i.vpe,this.add=new i.vpe,this.remove=new i.vpe,this.scroll=new i.vpe,this.scrollToEnd=new i.vpe,this.compareByHrefOrString=m.q9,this.loading$=new c.xQ}ngOnInit(){(this.getOptionsFn||this.defaultData)&&(this.typeahead=new e.X(null))}ngOnChanges(R){R.items&&this.items$.next(R.items.currentValue)}ngAfterViewInit(){!this.ngSelectInstance||this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{var R;this.results$=(0,u.T)(this.items$,this.autocompleteInputStream()),this.fetchDataDirectly&&(null===(R=this.typeahead)||void 0===R||R.next("")),this.openDirectly?(this.ngSelectInstance.open(),this.ngSelectInstance.focus()):this.focusDirectly&&this.ngSelectInstance.focus()},25)})}repositionDropdown(){this.ngSelectInstance&&setTimeout(()=>{this.cdRef.detectChanges();const R=this.ngSelectInstance;R&&R.dropdownPanel&&R.dropdownPanel._updatePosition()},25)}opened(R){var L;null===(L=this.typeahead)||void 0===L||L.next(""),this.repositionDropdown(),this.open.emit()}getOptionsItems(R){var L;return(0,r.of)(null===(L=this.items)||void 0===L?void 0:L.filter(W=>W.name.includes(R)))}closeSelect(){this.ngSelectInstance&&this.ngSelectInstance.close()}openSelect(){this.ngSelectInstance&&this.ngSelectInstance.open()}focusSelect(){this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.ngSelectInstance.focus()},25)})}closed(R){this.close.emit()}changed(R){this.change.emit(R)}searched(R){this.search.emit(R)}blured(R){this.blur.emit(R)}focused(R){this.focus.emit(R)}cleared(R){this.clear.emit(R)}keydowned(R){this.keydown.emit(R)}added(R){this.add.emit(R)}removed(R){this.remove.emit(R)}scrolled(R){this.scroll.emit(R)}scrolledToEnd(R){this.scrollToEnd.emit(R)}highlighting(R,L){return g.Z.inlineClass(R,L)}autocompleteInputStream(){return this.typeahead?this.typeahead.pipe((0,h.h)(()=>!(!this.defaultData&&!this.getOptionsFn)),(0,h.h)(R=>null!==R),(0,a.x)(),(0,p.b)(250),(0,l.b)(()=>this.loading$.next(!0)),(0,d.w)(R=>this.defaultData?this.opAutocompleterService.loadData(R,this.resource,this.filters,this.searchKey):this.getOptionsFn?this.getOptionsFn(R):n.C),(0,l.b)(()=>this.loading$.next(!1),()=>this.loading$.next(!1))):n.C}}ue.\u0275fac=function(R){return new(R||ue)(i.Y36(k),i.Y36(i.sBO),i.Y36(i.R0b),i.Y36(y.D))},ue.\u0275cmp=i.Xpm({type:ue,selectors:[["op-autocompleter"]],contentQueries:function(R,L,W){if(1&R&&(i.Suo(W,M.u,5,i.Rgc),i.Suo(W,v.v,5,i.Rgc),i.Suo(W,b.S,5,i.Rgc),i.Suo(W,E.q,5,i.Rgc)),2&R){let oe;i.iGM(oe=i.CRH())&&(L.optionTemplate=oe.first),i.iGM(oe=i.CRH())&&(L.labelTemplate=oe.first),i.iGM(oe=i.CRH())&&(L.headerTemplate=oe.first),i.iGM(oe=i.CRH())&&(L.footerTemplate=oe.first)}},viewQuery:function(R,L){if(1&R&&i.Gf(J,5),2&R){let W;i.iGM(W=i.CRH())&&(L.ngSelectInstance=W.first)}},hostVars:2,hostBindings:function(R,L){2&R&&i.ekj("op-autocompleter",L.className)},inputs:{filters:"filters",resource:"resource",model:"model",searchKey:"searchKey",defaultData:"defaultData",focusDirectly:"focusDirectly",fetchDataDirectly:"fetchDataDirectly",labelRequired:"labelRequired",name:"name",required:"required",disabled:"disabled",searchable:"searchable",clearable:"clearable",addTag:"addTag",id:"id",accesskey:"accesskey",items:"items",clearSearchOnAdd:"clearSearchOnAdd",classes:"classes",multiple:"multiple",openDirectly:"openDirectly",bindLabel:"bindLabel",bindValue:"bindValue",markFirst:"markFirst",placeholder:"placeholder",notFoundText:"notFoundText",typeToSearchText:"typeToSearchText",addTagText:"addTagText",loadingText:"loadingText",clearAllText:"clearAllText",appearance:"appearance",dropdownPosition:"dropdownPosition",appendTo:"appendTo",closeOnSelect:"closeOnSelect",hideSelected:"hideSelected",selectOnTab:"selectOnTab",openOnEnter:"openOnEnter",maxSelectedItems:"maxSelectedItems",groupBy:"groupBy",groupValue:"groupValue",bufferAmount:"bufferAmount",virtualScroll:"virtualScroll",selectableGroup:"selectableGroup",selectableGroupAsModel:"selectableGroupAsModel",searchFn:"searchFn",trackByFn:"trackByFn",clearOnBackspace:"clearOnBackspace",labelForId:"labelForId",inputAttrs:"inputAttrs",tabIndex:"tabIndex",readonly:"readonly",searchWhileComposing:"searchWhileComposing",minTermLength:"minTermLength",editableSearchTerm:"editableSearchTerm",keyDownFn:"keyDownFn",typeahead:"typeahead",getOptionsFn:"getOptionsFn"},outputs:{open:"open",close:"close",change:"change",focus:"focus",blur:"blur",search:"search",keydown:"keydown",clear:"clear",add:"add",remove:"remove",scroll:"scroll",scrollToEnd:"scrollToEnd"},features:[i._Bn([k]),i.qOj,i.TTD],decls:13,vars:55,consts:[[1,"inline-label","ng-select-container"],["bindLabel","name",3,"ngModel","items","ngClass","typeahead","clearOnBackspace","clearSearchOnAdd","hideSelected","appendTo","multiple","loading","addTag","virtualScroll","required","clearable","closeOnSelect","openOnEnter","disabled","name","id","bindValue","markFirst","notFoundText","typeToSearchText","addTagText","loadingText","clearAllText","appearance","dropdownPosition","selectOnTab","maxSelectedItems","placeholder","groupBy","groupValue","bufferAmount","selectableGroup","searchable","selectableGroupAsModel","trackByFn","labelForId","inputAttrs","tabIndex","readonly","searchWhileComposing","minTermLength","editableSearchTerm","keyDownFn","ngModelChange","change","open","close","blur","focus","clear","keydown","search","scroll","scrollToEnd","add","remove"],["ngSelectInstance",""],[4,"ngIf"],["ng-option-tmp",""],[3,"ngSwitch"],["defaultOption",""],["defaultLabel",""],["ng-header-tmp",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["ng-label-tmp",""],["ng-footer-tmp",""],[4,"ngSwitchCase"],[1,"op-autocompleter--option-wrapper"],["class","op-autocompleter--option-principal",3,"principal","hideName",4,"ngIf"],["data-qa-selector","op-autocompleter-item-subject",1,"op-autocompleter--wp-subject"],[3,"ngClass","textContent",4,"ngIf"],[3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-content"],[1,"op-autocompleter--wp-project",3,"ngOptionHighlight","textContent"],[1,"op-autocompleter--wp-id",3,"ngOptionHighlight"],[1,"op-autocompleter--wp-status",3,"textContent","ngClass"],[1,"op-autocompleter--option-principal",3,"principal","hideName"],[3,"ngClass","textContent"],[1,"op-autocompleter--option-principal-wrapper"],["class","op-autocompleter--option-principal-avatar","size","mini",3,"principal","hideName",4,"ngIf"],[1,"ellipsis",3,"ngOptionHighlight"],["size","mini",1,"op-autocompleter--option-principal-avatar",3,"principal","hideName"],[3,"ngOptionHighlight"],[1,"ng-value-icon","left",3,"click"],[1,"ng-value-label",3,"ngOptionHighlight"]],template:function(R,L){1&R&&(i.TgZ(0,"div",0),i.TgZ(1,"ng-select",1,2),i.NdJ("ngModelChange",function(oe){return L.model=oe})("change",function(oe){return L.changed(oe)})("open",function(oe){return L.opened(oe)})("close",function(oe){return L.closed(oe)})("blur",function(oe){return L.blured(oe)})("focus",function(oe){return L.focused(oe)})("clear",function(oe){return L.cleared(oe)})("keydown",function(oe){return L.keydowned(oe)})("search",function(oe){return L.searched(oe)})("scroll",function(oe){return L.scrolled(oe)})("scrollToEnd",function(oe){return L.scrolledToEnd(oe)})("add",function(oe){return L.added(oe)})("remove",function(oe){return L.removed(oe)}),i.ALo(3,"async"),i.ALo(4,"async"),i.YNc(5,ee,1,0,void 0,3),i.YNc(6,me,1,0,void 0,3),i.YNc(7,_e,1,6,"ng-template",4),i.YNc(8,ae,1,0,void 0,3),i.qZA(),i.qZA(),i.YNc(9,ot,3,3,"ng-template",5,6,i.W1O),i.YNc(11,Ie,2,2,"ng-template",null,7,i.W1O)),2&R&&(i.xp6(1),i.Q6J("ngModel",L.model)("items",i.lcZ(3,51,L.results$))("ngClass",L.classes)("typeahead",L.typeahead)("clearOnBackspace",L.clearOnBackspace)("clearSearchOnAdd",L.clearSearchOnAdd)("hideSelected",L.hideSelected)("appendTo",L.appendTo)("multiple",L.multiple)("loading",i.lcZ(4,53,L.loading$))("addTag",L.addTag)("virtualScroll",L.virtualScroll)("required",L.required)("clearable",L.clearable)("closeOnSelect",L.closeOnSelect)("openOnEnter",L.openOnEnter)("disabled",L.disabled)("name",L.name)("id",L.id)("bindValue",L.bindValue)("markFirst",L.markFirst)("notFoundText",L.notFoundText)("typeToSearchText",L.typeToSearchText)("addTagText",L.addTagText)("loadingText",L.loadingText)("clearAllText",L.clearAllText)("appearance",L.appearance)("dropdownPosition",L.dropdownPosition)("selectOnTab",L.selectOnTab)("maxSelectedItems",L.maxSelectedItems)("placeholder",L.placeholder)("groupBy",L.groupBy)("groupValue",L.groupValue)("bufferAmount",L.bufferAmount)("selectableGroup",L.selectableGroup)("searchable",L.searchable)("selectableGroupAsModel",L.selectableGroupAsModel)("trackByFn",L.trackByFn)("labelForId",L.labelForId)("inputAttrs",L.inputAttrs)("tabIndex",L.tabIndex)("readonly",L.readonly)("searchWhileComposing",L.searchWhileComposing)("minTermLength",L.minTermLength)("editableSearchTerm",L.editableSearchTerm)("keyDownFn",L.keyDownFn),i.uIk("accesskey",L.accesskey||void 0),i.xp6(4),i.Q6J("ngIf",L.headerTemplate),i.xp6(1),i.Q6J("ngIf",L.labelRequired),i.xp6(2),i.Q6J("ngIf",L.footerTemplate),i.xp6(1),i.Q6J("ngSwitch",!0))},directives:[S.w9,O.JJ,O.On,A.mk,O.Q7,A.O5,S.Z2,A.RF,S.A3,A.tP,S.bb,S.x0,A.n9,F.s,I.N],pipes:[A.Ov],styles:['.op-autocompleter--option-wrapper[_ngcontent-%COMP%]{padding:5px;line-height:15px;min-height:25px;word-break:break-word;display:grid;grid-template-columns:auto 1fr;grid-template-rows:1fr 1fr}.op-autocompleter--option-principal[_ngcontent-%COMP%]{margin-right:5px;float:left;grid-column-start:1;grid-column-end:2;grid-row-start:1;grid-row-end:3}.op-autocompleter--wp-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto;grid-template-areas:"project idlink status";font-size:.8rem;padding:1px 0 5px}.op-autocompleter--wp-project[_ngcontent-%COMP%]{grid-area:project;display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.op-autocompleter--wp-id[_ngcontent-%COMP%]{grid-area:idlink;place-self:right;font-style:italic;margin:0 .5rem;text-align:center}.op-autocompleter--wp-status[_ngcontent-%COMP%]{grid-area:status;overflow:hidden;font-style:italic}.op-autocompleter--wp-subject[_ngcontent-%COMP%]{font-weight:bold;display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.op-autocompleter--option-principal-wrapper[_ngcontent-%COMP%]{display:flex;overflow:hidden}'],changeDetection:0})},74990:(H,D,t)=>{"use strict";t.d(D,{C:()=>M});var i=t(55811),e=t(36868),c=t(21757),u=t(29212),r=t(32853),n=t(87064),h=t(61598),a=t(50166),p=t(7301),l=t(54622),d=t(78001),g=t(54364),C=t(32775),y=t(82503),m=t(91593),E=t(80104),P=t(28830),w=t(17208),x=t(66220),k=t(44265),b=t(2316);const v=[x.c,l.y,h.e,a.R,u.i,d.U,n.O,p.r,m.s,E.u,P.v,w.S,k.q];class M{}M.\u0275fac=function(O){return new(O||M)},M.\u0275mod=b.oAB({type:M}),M.\u0275inj=b.cJS({imports:[[g.ez,c.H,i.K,C.N,e.A0,y.qE,r.wA.withComponents(v)]]})},50166:(H,D,t)=>{"use strict";t.d(D,{R:()=>a});var i=t(2316),e=t(61598),c=t(91593),u=t(54364),r=t(17208);function n(p,l){if(1&p){const d=i.EpF();i.TgZ(0,"div",4),i.TgZ(1,"div",5),i.TgZ(2,"ul",6),i.TgZ(3,"li",7),i.NdJ("click",function(){return i.CHM(d),i.oxw().setMode("all")}),i._UZ(4,"a",8),i.qZA(),i.TgZ(5,"li",7),i.NdJ("click",function(){return i.CHM(d),i.oxw().setMode("recent")}),i._UZ(6,"a",8),i.qZA(),i.qZA(),i.qZA(),i.qZA()}if(2&p){const d=i.oxw();i.xp6(4),i.ekj("op-tab-row--link_selected","all"===d.mode),i.Q6J("textContent",d.text.all),i.xp6(2),i.ekj("op-tab-row--link_selected","recent"===d.mode),i.Q6J("textContent",d.text.recent)}}function h(p,l){if(1&p&&(i._UZ(0,"b",9),i._uU(1)),2&p){const d=l.searchTerm,g=i.oxw();i.Q6J("textContent",g.text.add_new_action),i.xp6(1),i.hij(": ",d," ")}}class a extends e.e{constructor(l){super(l),this.injector=l,this.modeSwitch=new i.vpe,this.mode="all",this.text.all=this.I18n.t("js.label_all"),this.text.recent=this.I18n.t("js.label_recent")}setMode(l){l!==this.mode&&this.modeSwitch.emit(l),this.mode=l}}a.\u0275fac=function(l){return new(l||a)(i.Y36(i.zs3))},a.\u0275cmp=i.Xpm({type:a,selectors:[["te-work-package-autocompleter"]],outputs:{modeSwitch:"modeSwitch"},features:[i.qOj],decls:4,vars:13,consts:[["bindLabel","name","resource","work_packages",3,"model","items","ngClass","addTag","virtualScroll","required","clearable","disabled","clearOnBackspace","typeahead","appendTo","hideSelected","id","change","open","close","keydown"],["ngSelectComponent",""],["op-autocompleter-header-tmp",""],["op-autocompleter-tag-tmp",""],[1,"scrollable-tabs"],[1,"op-scrollable-tabs--tab-container"],[1,"op-tab-row"],[1,"op-tab-row--tab",3,"click"],["href","#",1,"op-tab-row--link",3,"textContent"],[3,"textContent"]],template:function(l,d){1&l&&(i.TgZ(0,"op-autocompleter",0,1),i.NdJ("change",function(C){return d.changeModel(C)})("open",function(){return d.opened()})("close",function(){return d.closed()})("keydown",function(C){return d.keyPressed(C)}),i.YNc(2,n,7,6,"ng-template",2),i.YNc(3,h,2,2,"ng-template",3),i.qZA()),2&l&&i.Q6J("model",d.model)("items",d.availableValues)("ngClass",d.classes)("addTag",d.createAllowed)("virtualScroll",!0)("required",d.required)("clearable",!d.required)("disabled",d.disabled)("clearOnBackspace",!1)("typeahead",d.typeahead)("appendTo",d.appendTo)("hideSelected",d.hideSelected)("id",d.id)},directives:[c.s,u.mk,r.S],styles:[".ng-dropdown-panel .ng-dropdown-header{padding-bottom:0}\n"],encapsulation:2})},78001:(H,D,t)=>{"use strict";t.d(D,{X:()=>E,U:()=>P});var i=t(2316),e=t(91923),c=t(70233),u=t(96617),r=t(33927),n=t(26479),h=t(67727),a=t(36868),p=t(20979),l=t(26269),d=t(1707),g=t(54364),C=t(3742);function y(w,x){if(1&w&&i._UZ(0,"op-principal",3),2&w){const k=i.oxw().item;i.Q6J("principal",k)("hideName",!0)}}function m(w,x){if(1&w&&(i.YNc(0,y,1,2,"op-principal",2),i._uU(1)),2&w){const k=x.item;i.Q6J("ngIf",k&&k.href),i.xp6(1),i.hij(" ",k.name," ")}}const E="user-autocompleter";class P{constructor(x,k,b,v,M,S,O){this.elementRef=x,this.halResourceService=k,this.I18n=b,this.halNotification=v,this.pathHelper=M,this.apiV3Service=S,this.injector=O,this.userTracker=A=>A.href||A.id,this.onChange=new i.vpe,this.clearAfterSelection=!1,this.url=this.apiV3Service.users.path,this.allowEmpty=!1,this.appendTo="",this.multiple=!1,this.initialSelection=null,this.requests=new n.u(A=>this.getAvailableUsers(this.url,A),(0,n.G)(this.halNotification)),this.inputFilters=new l.qM}ngOnInit(){const x=this.elementRef.nativeElement.dataset.updateInput,{allowEmpty:k}=this.elementRef.nativeElement.dataset,{appendTo:b}=this.elementRef.nativeElement.dataset,{multiple:v}=this.elementRef.nativeElement.dataset,{url:M}=this.elementRef.nativeElement.dataset;x&&(this.updateInputField=document.getElementsByName(x)[0],this.setInitialSelection());const S=this.elementRef.nativeElement.dataset.additionalFilter;S&&JSON.parse(S).forEach(O=>{this.inputFilters.add(O.selector,O.operator,O.values)}),"true"===k&&(this.allowEmpty=!0),b&&(this.appendTo=b),"true"===v&&(this.multiple=!0),M&&(this.url=M)}onFocus(){this.requests.lastRequestedValue||this.requests.input$.next("")}onModelChange(x){x&&(this.onChange.emit(x),this.requests.input$.next(""),this.clearAfterSelection&&this.ngSelectComponent.clearItem(x),this.updateInputField&&(this.multiple?this.updateInputField.value=x.map(k=>k.id):this.updateInputField.value=x.id))}getAvailableUsers(x,k){const b=this.inputFilters.clone();return k&&k.length&&b.add("name","~",[k]),this.halResourceService.get(x,{filters:b.toJson()}).pipe((0,r.U)(v=>{const M=v.elements.map(S=>({name:S.name,id:S.id,href:S.href,avatar:S.avatar}));return this.allowEmpty&&M.unshift({name:this.I18n.t("js.timelines.filter.noneSelection"),href:null,id:null}),M}))}setInitialSelection(){if(this.updateInputField){const x=parseInt(this.updateInputField.value);this.initialSelection=isNaN(x)?null:x}}}P.\u0275fac=function(x){return new(x||P)(i.Y36(i.SBq),i.Y36(e.u),i.Y36(u.D),i.Y36(h.W),i.Y36(c.j),i.Y36(p.T),i.Y36(i.zs3))},P.\u0275cmp=i.Xpm({type:P,selectors:[["user-autocompleter"]],viewQuery:function(x,k){if(1&x&&i.Gf(a.w9,7),2&x){let b;i.iGM(b=i.CRH())&&(k.ngSelectComponent=b.first)}},inputs:{clearAfterSelection:"clearAfterSelection",url:"url",allowEmpty:"allowEmpty",appendTo:"appendTo",multiple:"multiple",initialSelection:"initialSelection"},outputs:{onChange:"onChange"},decls:4,vars:12,consts:[["bindLabel","name","bindValue","id",3,"items","ngModel","virtualScroll","trackByFn","typeahead","loading","appendTo","multiple","focus","change"],["ng-option-tmp",""],["size","mini",3,"principal","hideName",4,"ngIf"],["size","mini",3,"principal","hideName"]],template:function(x,k){1&x&&(i.TgZ(0,"ng-select",0),i.NdJ("focus",function(){return k.onFocus()})("change",function(v){return k.onModelChange(v)}),i.ALo(1,"async"),i.ALo(2,"async"),i.YNc(3,m,2,2,"ng-template",1),i.qZA()),2&x&&i.Q6J("items",i.lcZ(1,8,k.requests.output$))("ngModel",k.initialSelection)("virtualScroll",!0)("trackByFn",k.userTracker)("typeahead",k.requests.input$)("loading",i.lcZ(2,10,k.requests.loading$))("appendTo",k.appendTo)("multiple",k.multiple)},directives:[a.w9,d.JJ,d.On,a.Z2,g.O5,C.N],pipes:[g.Ov],encapsulation:2})},54622:(H,D,t)=>{"use strict";t.d(D,{y:()=>x});var i=t(2316),e=t(65146),c=t(66220),u=t(20979),r=t(67727),n=t(96617),h=t(70233),a=t(36868),p=t(1707),l=t(54364),d=t(3353),g=t(3742),C=t(28470);function y(k,b){if(1&k&&(i._UZ(0,"b",5),i._uU(1)),2&k){const v=b.searchTerm,M=i.oxw();i.Q6J("textContent",M.text.add_new_action),i.xp6(1),i.hij(": ",v," ")}}function m(k,b){if(1&k&&i._UZ(0,"op-principal",8),2&k){const v=i.oxw().item;i.Q6J("hideName",!0)("principal",v)}}function E(k,b){if(1&k&&(i.YNc(0,m,1,2,"op-principal",6),i._UZ(1,"span",7)),2&k){const v=b.item,M=b.searchTerm,S=i.oxw();i.Q6J("ngIf",S.isPrincipal(v)),i.xp6(1),i.Q6J("ngOptionHighlight",M)("textContent",v.name)}}function P(k,b){if(1&k&&i._UZ(0,"op-invite-user-button",10),2&k){const v=i.oxw(2);i.Q6J("projectId",null==v.resource.project?null:v.resource.project.id)}}function w(k,b){1&k&&i.YNc(0,P,1,1,"ng-template",9)}class x extends c.c{constructor(b,v,M,S,O,A,F){super(b),this.injector=b,this.I18n=v,this.currentProject=M,this.cdRef=S,this.pathHelper=O,this.apiV3Service=A,this.halNotification=F,this.onCreate=new i.vpe}ngAfterViewInit(){super.ngAfterViewInit(),this.canCreateNewActionElements().then(b=>{b&&(this.createAllowed=v=>this.createNewVersion(v),this.cdRef.detectChanges())})}canCreateNewActionElements(){return this.currentProject.id?this.apiV3Service.versions.available_projects.exists(this.currentProject.id).toPromise().catch(()=>!1):Promise.resolve(!1)}createNewVersion(b){this.apiV3Service.versions.post(this.getVersionPayload(b)).subscribe(v=>this.onCreate.emit(v),v=>{this.closeSelect(),this.halNotification.handleRawError(v)})}getVersionPayload(b){const v={};return v.name=b,v._links={definingProject:{href:this.apiV3Service.projects.id(this.currentProject.id).path}},v}}x.\u0275fac=function(b){return new(b||x)(i.Y36(i.zs3),i.Y36(n.D),i.Y36(e.R),i.Y36(i.sBO),i.Y36(h.j),i.Y36(u.T),i.Y36(r.W))},x.\u0275cmp=i.Xpm({type:x,selectors:[["version-autocompleter"]],outputs:{onCreate:"onCreate"},features:[i.qOj],decls:5,vars:16,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","compareWith","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[4,"ngIf"],[3,"textContent"],["size","mini",3,"hideName","principal",4,"ngIf"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent"],["size","mini",3,"hideName","principal"],["ng-footer-tmp",""],[1,"op-select-footer",3,"projectId"]],template:function(b,v){1&b&&(i.TgZ(0,"ng-select",0,1),i.NdJ("ngModelChange",function(S){return v.model=S})("change",function(S){return v.changeModel(S)})("open",function(){return v.opened()})("close",function(){return v.closed()})("keydown",function(S){return v.keyPressed(S)}),i.YNc(2,y,2,2,"ng-template",2),i.YNc(3,E,2,3,"ng-template",3),i.YNc(4,w,1,0,void 0,4),i.qZA()),2&b&&(i.Q6J("ngModel",v.model)("items",v.availableValues)("ngClass",v.classes)("addTag",v.createAllowed)("virtualScroll",!0)("required",v.required)("clearable",!v.required)("disabled",v.disabled)("typeahead",v.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",v.appendTo)("hideSelected",v.hideSelected)("compareWith",v.compareByHref)("id",v.id),i.xp6(4),i.Q6J("ngIf",v.showAddNewButton))},directives:[a.w9,p.JJ,p.On,l.mk,p.Q7,a.N6,a.Z2,l.O5,d.s,g.N,a.x0,C.R],encapsulation:2})},61598:(H,D,t)=>{"use strict";t.d(D,{e:()=>y});var i=t(66220),e=t(2316),c=t(36868),u=t(1707),r=t(54364),n=t(3353),h=t(3742),a=t(28470);function p(m,E){if(1&m&&(e._UZ(0,"b",5),e._uU(1)),2&m){const P=E.searchTerm,w=e.oxw();e.Q6J("textContent",w.text.add_new_action),e.xp6(1),e.hij(": ",P," ")}}function l(m,E){if(1&m&&e._UZ(0,"op-principal",8),2&m){const P=e.oxw().item;e.Q6J("hideName",!0)("principal",P)}}function d(m,E){if(1&m&&(e.YNc(0,l,1,2,"op-principal",6),e._UZ(1,"span",7)),2&m){const P=E.item,w=E.searchTerm,x=e.oxw();e.Q6J("ngIf",x.isPrincipal(P)),e.xp6(1),e.Q6J("ngOptionHighlight",w)("textContent",P.name)}}function g(m,E){if(1&m&&e._UZ(0,"op-invite-user-button",10),2&m){const P=e.oxw(2);e.Q6J("projectId",null==P.resource.project?null:P.resource.project.id)}}function C(m,E){1&m&&e.YNc(0,g,1,1,"ng-template",9)}class y extends i.c{}y.\u0275fac=function(){let m;return function(P){return(m||(m=e.n5z(y)))(P||y)}}(),y.\u0275cmp=e.Xpm({type:y,selectors:[["wp-autocompleter"]],features:[e.qOj],decls:5,vars:16,consts:[["bindLabel","name",3,"ngModel","items","ngClass","addTag","virtualScroll","required","clearable","disabled","typeahead","clearOnBackspace","clearSearchOnAdd","appendTo","hideSelected","compareWith","id","ngModelChange","change","open","close","keydown"],["ngSelectComponent",""],["ng-tag-tmp",""],["ng-option-tmp",""],[4,"ngIf"],[3,"textContent"],["size","mini",3,"hideName","principal",4,"ngIf"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight","textContent"],["size","mini",3,"hideName","principal"],["ng-footer-tmp",""],[1,"op-select-footer",3,"projectId"]],template:function(E,P){1&E&&(e.TgZ(0,"ng-select",0,1),e.NdJ("ngModelChange",function(x){return P.model=x})("change",function(x){return P.changeModel(x)})("open",function(){return P.opened()})("close",function(){return P.closed()})("keydown",function(x){return P.keyPressed(x)}),e.YNc(2,p,2,2,"ng-template",2),e.YNc(3,d,2,3,"ng-template",3),e.YNc(4,C,1,0,void 0,4),e.qZA()),2&E&&(e.Q6J("ngModel",P.model)("items",P.availableValues)("ngClass",P.classes)("addTag",P.createAllowed)("virtualScroll",!0)("required",P.required)("clearable",!P.required)("disabled",P.disabled)("typeahead",P.typeahead)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("appendTo",P.appendTo)("hideSelected",P.hideSelected)("compareWith",P.compareByHref)("id",P.id),e.xp6(4),e.Q6J("ngIf",P.showAddNewButton))},directives:[c.w9,u.JJ,u.On,r.mk,u.Q7,c.N6,c.Z2,r.O5,n.s,h.N,c.x0,a.R],encapsulation:2})},87064:(H,D,t)=>{"use strict";t.d(D,{w:()=>p,O:()=>l});var i=t(50076),e=t(96617),c=t(2316),u=t(36868),r=t(1707),n=t(54364);function h(d,g){if(1&d&&(c.TgZ(0,"span",3),c._uU(1),c.qZA()),2&d){const C=g.item,y=c.oxw();c.Q6J("ngClass",y.highlightColor(C)),c.xp6(1),c.Oqu(C.name)}}function a(d,g){if(1&d&&(c.TgZ(0,"span",3),c._uU(1),c.qZA()),2&d){const C=g.item,y=c.oxw();c.Q6J("ngClass",y.highlightColor(C)),c.xp6(1),c.Oqu(C.name)}}const p="colors-autocompleter";class l{constructor(g,C){this.elementRef=g,this.I18n=C,this.highlightTextInline=!1}ngOnInit(){this.setColorOptions(),this.updateInputField=document.getElementsByName(this.elementRef.nativeElement.dataset.updateInput)[0],this.highlightTextInline=JSON.parse(this.elementRef.nativeElement.dataset.highlightTextInline)}onModelChange(g){g&&this.updateInputField&&(this.updateInputField.value=g.value)}setColorOptions(){this.options=JSON.parse(this.elementRef.nativeElement.dataset.colors),this.options.unshift({name:this.I18n.t("js.label_no_color"),value:""}),this.selectedOption=this.options.find(g=>!0===g.selected),this.selectedOption?this.selectedOption=this.selectedOption.value:(this.selectedColorId=this.elementRef.nativeElement.dataset.selectedColor,this.selectedOption=this.selectedColorId?this.selectedColorId:"")}highlightColor(g){if(""===g.value)return;let C;return C=this.highlightTextInline?"__hl_inline_type_ ":"__hl_inline_ ",C+i.Z.colorClass(this.highlightTextInline,g.value)}}l.\u0275fac=function(g){return new(g||l)(c.Y36(c.SBq),c.Y36(e.D))},l.\u0275cmp=c.Xpm({type:l,selectors:[["colors-autocompleter"]],decls:3,vars:4,consts:[["bindLabel","name","bindValue","value","appendTo","body",3,"items","virtualScroll","ngModel","clearable","ngModelChange","change"],["ng-label-tmp",""],["ng-option-tmp",""],[3,"ngClass"]],template:function(g,C){1&g&&(c.TgZ(0,"ng-select",0),c.NdJ("ngModelChange",function(m){return C.selectedOption=m})("change",function(m){return C.onModelChange(m)}),c.YNc(1,h,2,2,"ng-template",1),c.YNc(2,a,2,2,"ng-template",2),c.qZA()),2&g&&c.Q6J("items",C.options)("virtualScroll",!0)("ngModel",C.selectedOption)("clearable",!1)},directives:[u.w9,r.JJ,r.On,u.bb,u.Z2,n.mk],encapsulation:2})},52167:(H,D,t)=>{"use strict";t.d(D,{c:()=>e});var i=t(2316);class e{toHsl(u){return`hsl(${this.valueHash(u)}, 50%, 50%)`}toHsla(u,r){return`hsla(${this.valueHash(u)}, 50%, 50%, ${r}%)`}valueHash(u){let r=0;for(let n=0;n<u.length;n++)r=u.charCodeAt(n)+((r<<5)-r);return r%360}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})},58004:(H,D,t)=>{"use strict";t.d(D,{z:()=>c});t(43887);function c(u){return class extends u{constructor(...r){super(...r);const n=u,h=Object.keys(n).find(l=>"object"==typeof n[l].declaredInputs);if(!h)throw new Error("Could not find declared inputs for component");const p=n[h].declaredInputs;Object.keys(p).forEach(l=>{const d=p[l],{dataset:g}=this.elementRef.nativeElement;if(g[l])try{this[d]=JSON.parse(g[l]||"")}catch(C){throw console.error("Couldn't parse input: ",l,this.elementRef.nativeElement.dataset),console.error("\nMake sure to make all data attributes you want to use as input JSON parseable.\nThis means that plain strings have to be wrapped in double quotes, and the attribute value is easiest to set with single quotes.\nAn example:\n\n<op-example example-input='\"myString\"'></op-example>\n"),C}})}}}},21501:(H,D,t)=>{"use strict";t.d(D,{F:()=>c});var i=t(70692),e=t(2316);class c{constructor(r){this.timezoneService=r}ngOnInit(){const r=this.timezoneService.formattedDatetimeComponents(this.dateTimeValue);this.date=r[0],this.time=r[1]}}c.\u0275fac=function(r){return new(r||c)(e.Y36(i.B))},c.\u0275cmp=e.Xpm({type:c,selectors:[["op-date-time"]],inputs:{dateTimeValue:"dateTimeValue"},decls:5,vars:4,consts:[[3,"title"],[3,"textContent"]],template:function(r,n){1&r&&(e.TgZ(0,"span",0),e._UZ(1,"span",1),e.TgZ(2,"span"),e._uU(3,"\xa0"),e.qZA(),e._UZ(4,"span",1),e.qZA()),2&r&&(e.hYB("title","",n.date," ",n.time,""),e.xp6(1),e.Q6J("textContent",n.date),e.xp6(3),e.Q6J("textContent",n.time))},encapsulation:2})},57958:(H,D,t)=>{"use strict";t.d(D,{r:()=>M});var i=t(2316),e=t(66586),c=t(96617),u=t(70233),r=t(71435),n=t(18293),h=t(36293),a=t(3786),p=t(81134),l=t(33927),d=t(53882);class g{constructor(O){this._httpClient=O}submit$(O,A,F,I,J){const N=this.formatModelToSubmit(O.getRawValue(),J),te=F?"patch":I||"post",ee=F?`${A}/${F}`:A;return this._httpClient[te](ee,N,{withCredentials:!0,responseType:"json"}).pipe((0,n.K)(G=>{throw 422==G.status&&this.handleBackendFormValidationErrors(G,O),G}))}validateForm$(O,A,F){const I=this.formatModelToSubmit(O.value,F);return this._httpClient.post(`${A}/form`,I,{withCredentials:!0,responseType:"json"}).pipe((0,l.U)(J=>{var N;return this.getFormattedErrors(Object.values(null===(N=null==J?void 0:J._embedded)||void 0===N?void 0:N.validationErrors))}),(0,l.U)(J=>this.setFormValidationErrors(J,O)))}formatModelToSubmit(O,A={}){let{_links:F}=O,I=(0,a._T)(O,["_links"]);const J=F||Object.keys(A).filter(te=>{var ee,G;return!!(null===(ee=A[te])||void 0===ee?void 0:ee.type)&&"_links"===(null===(G=A[te])||void 0===G?void 0:G.location)}).reduce((te,ee)=>{const G=I,se=ee;G[se];return I=(0,a._T)(G,["symbol"==typeof se?se:se+""]),Object.assign(Object.assign({},te),{[ee]:O[ee]})},{}),N=Object.keys(J).reduce((te,ee)=>{var G,se;const me=J[ee],_e=Array.isArray(me)?me.map(he=>{var ae,re;return{href:(null==he?void 0:he.href)||(null===(re=null===(ae=null==he?void 0:he._links)||void 0===ae?void 0:ae.self)||void 0===re?void 0:re.href)||null}}):{href:(null==me?void 0:me.href)||(null===(se=null===(G=null==me?void 0:me._links)||void 0===G?void 0:G.self)||void 0===se?void 0:se.href)||null};return Object.assign(Object.assign({},te),{[ee]:_e})},{});return Object.assign(Object.assign({},I),{_links:N})}formatModelToEdit(O={}){const{_links:A,_meta:F}=O,I=(0,a._T)(O,["_links","_meta"]),J=Object.keys(I).filter(te=>this.isValue(I[te])).reduce((te,ee)=>Object.assign(Object.assign({},te),{[ee]:I[ee]}),{});return Object.assign(Object.assign(Object.assign({},J),{_meta:F}),this.getFormattedResourcesModel(A))}handleBackendFormValidationErrors(O,A){var F,I,J,N;const te=(null===(I=null===(F=null==O?void 0:O.error)||void 0===F?void 0:F._embedded)||void 0===I?void 0:I.errors)?null===(N=null===(J=null==O?void 0:O.error)||void 0===J?void 0:J._embedded)||void 0===N?void 0:N.errors:[O.error],ee=this.getFormattedErrors(te);this.setFormValidationErrors(ee,A)}setFormValidationErrors(O,A){O.forEach(F=>{var I;const J=A.get(F.key)||(null===(I=A.get("_links"))||void 0===I?void 0:I.get(F.key));null==J||J.setErrors({[F.key]:{message:F.message}})})}getAllFormValidationErrors(O,A){const F=Object.values(O),I=Array.isArray(A)?A:[A];return this.getFormattedErrors(F).filter(N=>!A||I.includes(N.key)).reduce((N,{key:te,message:ee})=>Object.assign(Object.assign({},N),{[te]:{message:ee}}),{})}getFormattedErrors(O){return O.map(F=>({key:F._embedded.details.attribute,message:F.message}))}getFormattedResourcesModel(O={}){return Object.keys(O).reduce((A,F)=>{const I=O[F],J=Array.isArray(I)?I.map(N=>Object.assign(Object.assign({},N),{name:(null==N?void 0:N.name)||(null==N?void 0:N.title)})):Object.assign(Object.assign({},I),{name:(null==I?void 0:I.name)||(null==I?void 0:I.title)});return A=Object.assign(Object.assign({},A),this.isValue(J)&&{[F]:J})},{})}isValue(O){return![null,void 0,""].includes(O)}}g.\u0275fac=function(O){return new(O||g)(i.LFG(d.eN))},g.\u0275prov=i.Yz7({token:g,factory:g.\u0275fac,providedIn:"root"});var C=t(18217);class y{constructor(O,A,F){this.httpClient=O,this.I18n=A,this.formsService=F,this.selectDefaultValue={name:"-",_links:{self:{href:null}}},this.inputsCatalogue=[{config:{type:"textInput",templateOptions:{type:"text"}},useForFields:["String"]},{config:{type:"textInput",templateOptions:{type:"password"}},useForFields:["Password"]},{config:{type:"integerInput",templateOptions:{type:"number",locale:this.I18n.locale}},useForFields:["Integer","Float"]},{config:{type:"booleanInput",templateOptions:{type:"checkbox"}},useForFields:["Boolean"]},{config:{type:"dateInput"},useForFields:["Date","DateTime"]},{config:{type:"formattableInput",className:"",templateOptions:{editorType:"full",noWrapLabel:!0}},useForFields:["Formattable"]},{config:{type:"selectInput",defaultValue:this.selectDefaultValue,templateOptions:{locale:this.I18n.locale,bindLabel:"name",searchable:!0,virtualScroll:!0,clearOnBackspace:!1,clearSearchOnAdd:!1,hideSelected:!1,text:{add_new_action:this.I18n.t("js.label_create")}},expressionProperties:{"templateOptions.clearable":(I,J,N)=>{var te;return!(null===(te=N.templateOptions)||void 0===te?void 0:te.required)}}},useForFields:["Priority","Status","Type","User","Version","TimeEntriesActivity","Category","CustomOption","Project"]},{config:{type:"selectProjectStatusInput",defaultValue:this.selectDefaultValue,templateOptions:{locale:this.I18n.locale,bindLabel:"name",searchable:!0},expressionProperties:{"templateOptions.clearable":(I,J,N)=>{var te;return!(null===(te=N.templateOptions)||void 0===te?void 0:te.required)}}},useForFields:["ProjectStatus"]}]}getConfig(O,A){var F;const I=null===(F=O._attributeGroups)||void 0===F?void 0:F.map(ee=>({name:ee.name,fieldsFilter:G=>{var se,me;return null===(se=ee.attributes)||void 0===se?void 0:se.includes(null===(me=G.templateOptions)||void 0===me?void 0:me.property)}})),N=this.getFieldsSchemasWithKey(O).map(ee=>this.getFormlyFieldConfig(ee,A)).filter(ee=>null!==ee);return this.getFormlyFormWithFieldGroups(I,N)}getModel(O){return this.formsService.formatModelToEdit(O)}getFormlyFormWithFieldGroups(O=[],A=[]){return[...(A=A.reduce((J,N)=>N.fieldGroup?[...J,...N.fieldGroup]:[...J,N],[])).filter(J=>O.every(N=>!N.fieldsFilter||!N.fieldsFilter(J))),...this.getDynamicFormFieldGroups(O,A)]}getFieldsSchemasWithKey(O){return Object.keys(O).map(A=>Object.assign(Object.assign({},O[A]),{key:this.getAttributeKey(O[A],A)})).filter(A=>this.isFieldSchema(A)&&A.writable)}getAttributeKey(O,A){switch(O.location){case"_meta":return`${O.location}.${A}`;default:return A}}isFieldSchema(O){return!!(null==O?void 0:O.type)}getFormlyFieldConfig(O,A){const{key:F,name:I,required:J,hasDefault:N,minLength:te,maxLength:ee}=O,G=this.getFieldTypeConfig(O);if(!G)return null;const{templateOptions:se}=G,me=(0,a._T)(G,["templateOptions"]),_e=this.getFieldProperty(F),he=_e&&(A[_e]||A._links&&A._links[_e]),ae=this.getFieldOptions(O,he);return Object.assign(Object.assign({},me),{key:F,wrappers:["op-dynamic-field-wrapper"],className:`op-form--field ${(null==me?void 0:me.className)||""}`,templateOptions:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({property:_e,required:J,label:I,hasDefault:N},null!=he&&{payloadValue:he}),te&&{minLength:te}),ee&&{maxLength:ee}),se),ae&&{options:ae})})}getFieldTypeConfig(O){var A;const F=O.type.replace("[]",""),I=this.inputsCatalogue.find(te=>te.useForFields.includes(F));if(!I)return console.warn(`Could not find a input definition for a field with the following type: ${F}. The full field configuration is`,O),null;const J=I.config;let N;return"integerInput"===J.type||"selectInput"===J.type||"selectProjectStatusInput"===J.type?N={className:O.name,templateOptions:Object.assign(Object.assign(Object.assign({},J.templateOptions),this.isMultiSelectField(O)&&{multiple:!0}),"User"===F&&{showAddNewUserButton:!0})}:"formattableInput"===J.type&&(N={templateOptions:Object.assign(Object.assign({},J.templateOptions),{rtl:null===(A=O.options)||void 0===A?void 0:A.rtl,name:O.name})}),Object.assign(Object.assign({},J),N)}getFieldOptions(O,A){var F,I,J,N,te;const ee=(null===(F=O._embedded)||void 0===F?void 0:F.allowedValues)||(null===(I=O._links)||void 0===I?void 0:I.allowedValues);let G;if(ee){if(Array.isArray(ee)){const se=(null===(te=null===(N=null===(J=ee[0])||void 0===J?void 0:J._links)||void 0===N?void 0:N.self)||void 0===te?void 0:te.title)?this.formatAllowedValues(ee):ee;G=(0,p.of)(se)}else ee.href&&(G=this.httpClient.get((0,C.Y)(ee.href,{pageSize:"-1"})).pipe((0,l.U)(se=>se._embedded.elements),(0,l.U)(se=>this.formatAllowedValues(se))));return null==G?void 0:G.pipe((0,l.U)(se=>this.prependCurrentValue(se,A)),(0,l.U)(se=>this.prependDefaultValue(se,O)))}}formatAllowedValues(O){return O.map(A=>{var F,I;return Object.assign(Object.assign({},A),{name:null===(I=null===(F=A._links)||void 0===F?void 0:F.self)||void 0===I?void 0:I.title})})}getFieldProperty(O){return O.split(".").pop()}getDynamicFormFieldGroups(O=[],A=[]){return O.reduce((F,I)=>{var J;let N=this.getDefaultFieldGroupSettings(I,A);return I.settings&&(N=Object.assign(Object.assign({},N),{templateOptions:Object.assign(Object.assign({},N.templateOptions),I.settings.templateOptions&&I.settings.templateOptions),expressionProperties:Object.assign(Object.assign({},N.expressionProperties),I.settings.expressionProperties&&I.settings.expressionProperties)})),(null===(J=null==N?void 0:N.fieldGroup)||void 0===J?void 0:J.length)&&(F=[...F,N]),F},[])}getDefaultFieldGroupSettings(O,A){return{wrappers:["op-dynamic-field-group-wrapper"],fieldGroupClassName:"op-form--fieldset",templateOptions:{label:O.name,isFieldGroup:!0,collapsibleFieldGroups:!0,collapsibleFieldGroupsCollapsed:!0},fieldGroup:this.getGroupFields(O,A),expressionProperties:{"templateOptions.collapsibleFieldGroupsCollapsed":this.collapsibleFieldGroupsCollapsedExpressionProperty}}}getGroupFields(O,A){return A.filter(F=>!(!F.key||!this.getFieldProperty(F.key))&&(!O.fieldsFilter||O.fieldsFilter(F)))}collapsibleFieldGroupsCollapsedExpressionProperty(O,A,F){var I,J,N;return!("formly-group"!==F.type||!(null===(I=F.templateOptions)||void 0===I?void 0:I.collapsibleFieldGroups)||!(null===(J=F.templateOptions)||void 0===J?void 0:J.collapsibleFieldGroupsCollapsed))&&!(null===(N=F.fieldGroup)||void 0===N?void 0:N.some(te=>{var ee,G,se;return(null===(ee=te.formControl)||void 0===ee?void 0:ee.errors)&&!te.hide&&(null===(se=null===(G=F.options)||void 0===G?void 0:G.parentForm)||void 0===se?void 0:se.submitted)}))}prependCurrentValue(O,A){return!(null==A?void 0:A.href)||O.some(F=>{var I,J;return(null===(J=null===(I=null==F?void 0:F._links)||void 0===I?void 0:I.self)||void 0===J?void 0:J.href)===A.href})?O:[{name:A.title,_links:{self:A}},...O]}prependDefaultValue(O,A){return A.required||this.isMultiSelectField(A)?O:[this.selectDefaultValue,...O]}isMultiSelectField(O){var A;return null===(A=null==O?void 0:O.type)||void 0===A?void 0:A.startsWith("[]")}}y.\u0275fac=function(O){return new(O||y)(i.LFG(d.eN),i.LFG(c.D),i.LFG(g))},y.\u0275prov=i.Yz7({token:y,factory:y.\u0275fac});var m=t(26942),E=t(84335),P=t(1707);class w{constructor(O,A,F){this._httpClient=O,this._dynamicFieldsService=A,this._formsService=F}registerForm(O){this.dynamicForm=O}getSettingsFromBackend$(O,A,F={}){const I=A?`/${A}`:"",J=(null==O?void 0:O.endsWith("/form"))?"":"/form",N=`${O}${I}${J}`;return this._httpClient.post(N,F,{withCredentials:!0,responseType:"json"}).pipe((0,l.U)(te=>this.getSettings(te)))}getSettings(O){var A,F;this.formSchema=null===(A=O._embedded)||void 0===A?void 0:A.schema;const I=null===(F=O._embedded)||void 0===F?void 0:F.payload;return{form:new P.cw({}),fields:this._dynamicFieldsService.getConfig(this.formSchema,I),model:this._dynamicFieldsService.getModel(I)}}formatModelToEdit(O){return this._formsService.formatModelToEdit(O)}validateForm$(O,A){return this._formsService.validateForm$(O,A,this.formSchema)}submit$(O,A,F,I){return this._formsService.submit$(O,A,F,I,this.formSchema)}}w.\u0275fac=function(O){return new(O||w)(i.LFG(d.eN),i.LFG(y),i.LFG(g))},w.\u0275prov=i.Yz7({token:w,factory:w.\u0275fac});var x=t(54364);function k(S,O){if(1&S){const A=i.EpF();i.TgZ(0,"div",5),i.TgZ(1,"button",6),i._uU(2),i.qZA(),i.TgZ(3,"button",7),i.NdJ("click",function(){return i.CHM(A),i.oxw(2).handleCancel()}),i._uU(4),i.qZA(),i.qZA()}if(2&S){const A=i.oxw(2);i.xp6(1),i.Q6J("disabled",A.inFlight),i.xp6(1),i.hij(" ",A.text.save," "),i.xp6(2),i.hij(" ",A.text.cancel," ")}}function b(S,O){if(1&S){const A=i.EpF();i.TgZ(0,"form",2),i.NdJ("submit",function(){i.CHM(A);const I=i.oxw();return I.submitForm(I.form)}),i.TgZ(1,"formly-form",3),i.NdJ("modelChange",function(I){return i.CHM(A),i.oxw().onModelChange(I)}),i.qZA(),i.YNc(2,k,5,3,"div",4),i.qZA()}if(2&S){const A=i.oxw();i.Q6J("formGroup",A.form),i.xp6(1),i.Q6J("form",A.form)("model",A.innerModel)("fields",A.fields),i.xp6(1),i.Q6J("ngIf",A.handleSubmit)}}function v(S,O){if(1&S){const A=i.EpF();i.TgZ(0,"formly-form",8),i.NdJ("modelChange",function(I){return i.CHM(A),i.oxw().onModelChange(I)}),i.qZA()}if(2&S){const A=i.oxw();i.Q6J("form",A.form)("model",A.innerModel)("fields",A.fields)}}class M extends m.N{constructor(O,A,F,I,J,N,te){super(),this.dynamicFormService=O,this.dynamicFieldsService=A,this.I18n=F,this.pathHelperService=I,this.toastService=J,this.changeDetectorRef=N,this.confirmDialogService=te,this.formHttpMethod="post",this.initialPayload={},this.showNotifications=!0,this.showValidationErrorsOn="submit",this.handleSubmit=!0,this.modelChange=new i.vpe,this.submitted=new i.vpe,this.errored=new i.vpe,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel"),load_error_message:this.I18n.t("js.forms.load_error_message"),successful_update:this.I18n.t("js.notice_successful_update"),successful_create:this.I18n.t("js.notice_successful_create"),job_started:this.I18n.t("js.notice_job_started")},this.noSettingsSourceErrorMessage="DynamicFormComponent needs a settings, formUrl or resourcePath @Input\n  in order to fetch its setting. Please provide one.",this.noPathToSubmitToError="DynamicForm needs a resourcePath or formUrl @Input in order to be submitted \n  and validated. Please provide one."}set model(O){if(!this.innerModel&&!O)return;const A=this.dynamicFormService.formatModelToEdit(O);this.form.patchValue(A)}get model(){return this.form.getRawValue()}set dynamicForm(O){this.dynamicFormService.registerForm(O)}setDisabledState(O){O?this.form.disable():this.form.enable()}ngOnChanges(O){(O.settings||O.resourcePath||O.resourceId||O.formUrl||O.formHttpMethod||O.dynamicFormGroup||O.initialPayload||O.fieldsSettingsPipe||O.fieldGroups)&&this.initializeDynamicForm(this.settings,this.resourcePath,this.resourceId,this.formUrl,this.initialPayload)}onModelChange(O){this.modelChange.emit(O)}submitForm(O){if(this.handleSubmit){if(!this.formEndpoint)throw new Error(this.noPathToSubmitToError);this.inFlight=!0,this.dynamicFormService.submit$(O,this.formEndpoint,this.resourceId,this.formHttpMethod).pipe((0,r.x)(()=>this.inFlight=!1)).subscribe(A=>{this.submitted.emit(A),this.showNotifications&&this.showSuccessNotification(A)},A=>{var F;this.errored.emit((null==A?void 0:A.error)||A),this.showNotifications&&this.toastService.addError((null===(F=null==A?void 0:A.error)||void 0===F?void 0:F.message)||(null==A?void 0:A.message))})}}validateForm(){if(!this.formEndpoint)throw new Error(this.noPathToSubmitToError);return this.dynamicFormService.validateForm$(this.form,this.formEndpoint)}handleCancel(){this.form.dirty?this.confirmDialogService.confirm({text:{title:this.I18n.t("js.text_are_you_sure"),text:this.I18n.t("js.text_data_lost")}}).then(()=>{this.goBack()}).catch(()=>{}):this.goBack()}goBack(){window.history.back()}initializeDynamicForm(O,A,F,I,J){const N=this.getFormEndPoint(I,A);if(!N)throw new Error(this.noSettingsSourceErrorMessage);N!==this.formEndpoint&&(this.formEndpoint=N),O?this.setupDynamicFormFromSettings(O):this.setupDynamicFormFromBackend(this.formEndpoint,F,J)}getFormEndPoint(O,A){return O?O.endsWith("/form")?O.replace("/form",""):O:A||""}setupDynamicFormFromBackend(O,A,F){this.dynamicFormService.getSettingsFromBackend$(O,A,F).pipe((0,n.K)(I=>{throw this.toastService.addError(this.text.load_error_message),I})).subscribe(I=>this.setupDynamicForm(I))}setupDynamicFormFromSettings(O){const A={_embedded:{payload:null==O?void 0:O.payload,schema:null==O?void 0:O.schema}},F=this.dynamicFormService.getSettings(A);this.setupDynamicForm(F)}setupDynamicForm({fields:O,model:A,form:F}){this.fieldsSettingsPipe&&(O=this.fieldsSettingsPipe(O)),this.fieldGroups&&(O=this.dynamicFieldsService.getFormlyFormWithFieldGroups(this.fieldGroups,O)),this.fields=O,this.innerModel=A,this.form=this.dynamicFormGroup||F,this.changeDetectorRef.detectChanges()}showSuccessNotification(O){const A=(()=>{var F;return(null==O?void 0:O.jobId)?`${(null===(F=null==O?void 0:O.payload)||void 0===F?void 0:F.title)||""} ${this.text.job_started}`:"patch"===this.formHttpMethod?this.text.successful_update:this.text.successful_create})();this.toastService.addSuccess(A)}}M.\u0275fac=function(O){return new(O||M)(i.Y36(w),i.Y36(y),i.Y36(c.D),i.Y36(u.j),i.Y36(h.kl),i.Y36(i.sBO),i.Y36(E.D))},M.\u0275cmp=i.Xpm({type:M,selectors:[["op-dynamic-form"]],viewQuery:function(O,A){if(1&O&&i.Gf(e.T7,5),2&O){let F;i.iGM(F=i.CRH())&&(A.dynamicForm=F.first)}},inputs:{formUrl:"formUrl",formHttpMethod:"formHttpMethod",resourcePath:"resourcePath",resourceId:"resourceId",settings:"settings",dynamicFormGroup:"dynamicFormGroup",initialPayload:"initialPayload",model:"model",fieldsSettingsPipe:"fieldsSettingsPipe",fieldGroups:"fieldGroups",showNotifications:"showNotifications",showValidationErrorsOn:"showValidationErrorsOn",handleSubmit:"handleSubmit",helpTextAttributeScope:"helpTextAttributeScope"},outputs:{modelChange:"modelChange",submitted:"submitted",errored:"errored"},features:[i._Bn([w,y]),i.qOj,i.TTD],decls:2,vars:2,consts:[["data-qa","op-form--container","class","op-form",3,"formGroup","submit",4,"ngIf"],["data-qa","op-form--container","class","op-form--fieldset",3,"form","model","fields","modelChange",4,"ngIf"],["data-qa","op-form--container",1,"op-form",3,"formGroup","submit"],[1,"op-form--fieldset",3,"form","model","fields","modelChange"],["class","op-form--submit",4,"ngIf"],[1,"op-form--submit"],["type","submit",1,"button","-highlight",3,"disabled"],["type","button",1,"button",3,"click"],["data-qa","op-form--container",1,"op-form--fieldset",3,"form","model","fields","modelChange"]],template:function(O,A){1&O&&(i.YNc(0,b,3,5,"form",0),i.YNc(1,v,1,3,"formly-form",1)),2&O&&(i.Q6J("ngIf",A.form&&A.handleSubmit),i.xp6(1),i.Q6J("ngIf",A.form&&!A.handleSubmit))},directives:[x.O5,P._Y,P.JL,P.sg,e.T7],styles:[""]})},31256:(H,D,t)=>{"use strict";t.d(D,{r:()=>ie});var i=t(54364),e=t(66586),c=t(2316),u=t(1707);class r extends e.fS{}r.\u0275fac=function(){let R;return function(W){return(R||(R=c.n5z(r)))(W||r)}}(),r.\u0275cmp=c.Xpm({type:r,selectors:[["op-text-input"]],features:[c.qOj],decls:1,vars:4,consts:[[1,"op-input",3,"type","formControl","formlyAttributes"]],template:function(L,W){1&L&&c._UZ(0,"input",0),2&L&&(c.Q6J("type",W.to.type)("formControl",W.formControl)("formlyAttributes",W.field),c.uIk("aria-required",W.to.required))},directives:[u.Fj,u.JJ,u.oH,e.VQ],styles:[""]});var n=t(53882);class h extends e.fS{}h.\u0275fac=function(){let R;return function(W){return(R||(R=c.n5z(h)))(W||h)}}(),h.\u0275cmp=c.Xpm({type:h,selectors:[["op-integer-input"]],features:[c.qOj],decls:1,vars:5,consts:[[1,"op-input",3,"type","formControl","formlyAttributes"]],template:function(L,W){1&L&&c._UZ(0,"input",0),2&L&&(c.Q6J("type",W.to.type)("formControl",W.formControl)("formlyAttributes",W.field),c.uIk("aria-required",W.to.required)("lang",W.to.locale))},directives:[u.Fj,u.JJ,u.oH,e.VQ],styles:[""]});var a=t(10190),p=t(36868),l=t(3353),d=t(28470);function g(R,L){if(1&R&&(c._UZ(0,"b",4),c._uU(1)),2&R){const W=L.searchTerm,oe=c.oxw();c.Q6J("textContent",oe.to.text.add_new_action),c.xp6(1),c.hij(": ",W," ")}}function C(R,L){if(1&R&&(c.TgZ(0,"div",5),c._uU(1),c.qZA()),2&R){const W=L.item,oe=L.searchTerm;c.Q6J("ngOptionHighlight",oe),c.xp6(1),c.Oqu(W.name)}}function y(R,L){if(1&R&&c._UZ(0,"op-invite-user-button",7),2&R){const W=c.oxw(2);c.Q6J("projectId",W.projectId)}}function m(R,L){1&R&&c.YNc(0,y,1,1,"ng-template",6)}class E extends e.fS{ngOnInit(){var L,W;(null===(L=this.model)||void 0===L?void 0:L.project)&&(this.projectId=(0,a.Z)(null===(W=this.model.project)||void 0===W?void 0:W.href))}}E.\u0275fac=function(){let R;return function(W){return(R||(R=c.n5z(E)))(W||E)}}(),E.\u0275cmp=c.Xpm({type:E,selectors:[["op-select-input"]],features:[c.qOj],decls:5,vars:17,consts:[[3,"items","formControl","formlyAttributes","multiple","bindLabel","searchable","virtualScroll","clearable","typeahead","clearOnBackspace","clearSearchOnAdd","hideSelected"],["ng-tag-tmp",""],["ng-option-tmp",""],[4,"ngIf"],[3,"textContent"],[1,"ng-option-label","ellipsis",3,"ngOptionHighlight"],["ng-footer-tmp",""],[1,"op-select-footer",3,"projectId"]],template:function(L,W){1&L&&(c.TgZ(0,"ng-select",0),c.ALo(1,"async"),c.YNc(2,g,2,2,"ng-template",1),c.YNc(3,C,2,2,"ng-template",2),c.YNc(4,m,1,0,void 0,3),c.qZA()),2&L&&(c.Q6J("items",c.lcZ(1,15,null==W.to?null:W.to.options))("formControl",W.formControl)("formlyAttributes",W.field)("multiple",W.to.multiple)("bindLabel",W.to.bindLabel)("searchable",W.to.searchable)("virtualScroll",W.to.virtualScroll)("clearable",W.to.clearable)("typeahead",W.to.typeahead)("clearOnBackspace",W.to.clearOnBackspace)("clearSearchOnAdd",W.to.clearSearchOnAdd)("hideSelected",W.to.hideSelected),c.uIk("aria-required",W.to.required)("required",W.to.required),c.xp6(4),c.Q6J("ngIf",W.to.showAddNewUserButton))},directives:[p.w9,u.JJ,u.oH,e.VQ,u.Q7,p.N6,p.Z2,i.O5,l.s,p.x0,d.R],pipes:[i.Ov],styles:[""]});var P=t(63419);function w(R,L){if(1&R&&(c._UZ(0,"span",3),c.TgZ(1,"span",4),c._uU(2),c.qZA()),2&R){const W=L.item,oe=c.oxw();c.Q6J("ngClass",oe.cssClass(W)),c.xp6(1),c.Q6J("ngClass",oe.cssClass(W)),c.xp6(1),c.Oqu(W.name)}}function x(R,L){if(1&R&&(c._UZ(0,"span",3),c.TgZ(1,"span",4),c._uU(2),c.qZA()),2&R){const W=L.item,oe=c.oxw();c.Q6J("ngClass",oe.cssClass(W)),c.xp6(1),c.Q6J("ngClass",oe.cssClass(W)),c.xp6(1),c.Oqu(W.name)}}class k extends e.fS{cssClass(L){return(0,P.p)(L.id)}}k.\u0275fac=function(){let R;return function(W){return(R||(R=c.n5z(k)))(W||k)}}(),k.\u0275cmp=c.Xpm({type:k,selectors:[["op-select-project-status-input"]],features:[c.qOj],decls:4,vars:11,consts:[["bindLabel","name",3,"items","formControl","formlyAttributes","searchable","virtualScroll","clearable","clearOnBackspace","clearSearchOnAdd","hideSelected"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"project-status--bulb","-inline",3,"ngClass"],[1,"project-status--name",3,"ngClass"]],template:function(L,W){1&L&&(c.TgZ(0,"ng-select",0),c.ALo(1,"async"),c.YNc(2,w,3,3,"ng-template",1),c.YNc(3,x,3,3,"ng-template",2),c.qZA()),2&L&&c.Q6J("items",c.lcZ(1,9,null==W.to?null:W.to.options))("formControl",W.formControl)("formlyAttributes",W.field)("searchable",!0)("virtualScroll",!0)("clearable",!1)("clearOnBackspace",!1)("clearSearchOnAdd",!1)("hideSelected",!0)},directives:[p.w9,u.JJ,u.oH,e.VQ,p.bb,p.Z2,i.mk],pipes:[i.Ov],encapsulation:2});var b=t(81496);class v{}v.\u0275fac=function(L){return new(L||v)},v.\u0275mod=c.oAB({type:v}),v.\u0275inj=c.cJS({imports:[[i.ez,b.I]]});class M extends e.fS{}M.\u0275fac=function(){let R;return function(W){return(R||(R=c.n5z(M)))(W||M)}}(),M.\u0275cmp=c.Xpm({type:M,selectors:[["op-boolean-input"]],features:[c.qOj],decls:1,vars:3,consts:[["type","checkbox",3,"formControl","formlyAttributes"]],template:function(L,W){1&L&&c._UZ(0,"input",0),2&L&&(c.Q6J("formControl",W.formControl)("formlyAttributes",W.field),c.uIk("aria-required",W.to.required))},directives:[u.Wl,u.JJ,u.oH,e.VQ],styles:[""]});var S=t(96617),O=t(26611);class A{constructor(L){this.I18n=L,this.disabled=!1,this.initializationError=!1,this.onChange=()=>{},this.onTouch=()=>{}}get ckEditorContext(){var L;return{type:this.templateOptions.editorType,macros:"none",options:{rtl:null===(L=this.templateOptions)||void 0===L?void 0:L.rtl}}}ngOnInit(){var L,W;this.text={attachmentLabel:this.I18n.t("js.label_formattable_attachment_hint"),save:this.I18n.t("js.inplace.button_save",{attribute:null===(L=this.templateOptions)||void 0===L?void 0:L.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:null===(W=this.templateOptions)||void 0===W?void 0:W.name})}}writeValue(L){this.value=L}registerOnChange(L){this.onChange=L}registerOnTouched(L){this.onTouch=L}setDisabledState(L){this.disabled=L,this.editor.ckEditorInstance.isReadOnly=L}onContentChange(L){const W={raw:L};this.onTouch(),this.onChange(W)}onCkeditorSetup(L){this.editor.ckEditorInstance.ui.focusTracker.on("change:isFocused",(W,oe,Oe)=>{!Oe&&!this.touched&&(this.touched=!0,this.onTouch())})}}A.\u0275fac=function(L){return new(L||A)(c.Y36(S.D))},A.\u0275cmp=c.Xpm({type:A,selectors:[["op-formattable-control"]],viewQuery:function(L,W){if(1&L&&c.Gf(O.F,7),2&L){let oe;c.iGM(oe=c.CRH())&&(W.editor=oe.first)}},inputs:{templateOptions:"templateOptions"},features:[c._Bn([{provide:u.JU,useExisting:(0,c.Gpc)(()=>A),multi:!0}])],decls:2,vars:2,consts:[[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"context","content","onContentChange","onInitializationFailed","onInitialized"]],template:function(L,W){1&L&&(c.TgZ(0,"div",0),c.TgZ(1,"op-ckeditor",1),c.NdJ("onContentChange",function(Oe){return W.onContentChange(Oe)})("onInitializationFailed",function(){return W.initializationError=!0})("onInitialized",function(Oe){return W.onCkeditorSetup(Oe)}),c.qZA(),c.qZA()),2&L&&(c.xp6(1),c.Q6J("context",W.ckEditorContext)("content",null==W.value?null:W.value.raw))},directives:[O.F],styles:[""]});class F extends e.fS{}F.\u0275fac=function(){let R;return function(W){return(R||(R=c.n5z(F)))(W||F)}}(),F.\u0275cmp=c.Xpm({type:F,selectors:[["op-formattable-textarea-input"]],features:[c.qOj],decls:1,vars:3,consts:[[3,"templateOptions","formControl","formlyAttributes"]],template:function(L,W){1&L&&c._UZ(0,"op-formattable-control",0),2&L&&c.Q6J("templateOptions",W.to)("formControl",W.formControl)("formlyAttributes",W.field)},directives:[A,u.JJ,u.oH,e.VQ],styles:[""]});var I=t(57958),J=t(18252),N=t(22784);function te(R,L){if(1&R&&(c.TgZ(0,"op-form-field",2),c.GkF(1,3,4),c._UZ(3,"formly-validation-message",5),c.qZA()),2&R){const W=c.oxw();c.Q6J("control",null==W.field?null:W.field.formControl)("label",null==W.to?null:W.to.label)("hidden",null==W.field?null:W.field.hide)("noWrapLabel",null==W.to?null:W.to.noWrapLabel)("required",null==W.to?null:W.to.required)("helpTextAttribute",null==W.to?null:W.to.property)("helpTextAttributeScope",(null==W.to?null:W.to.helpTextAttributeScope)||(null==W.dynamicFormComponent?null:W.dynamicFormComponent.helpTextAttributeScope))("showValidationErrorOn",(null==W.to?null:W.to.showValidationErrorOn)||(null==W.dynamicFormComponent?null:W.dynamicFormComponent.showValidationErrorsOn)),c.uIk("data-qa-field-name",null==W.to?null:W.to.property),c.xp6(3),c.Q6J("field",W.field)}}function ee(R,L){if(1&R&&(c.TgZ(0,"op-checkbox-field",6),c.GkF(1,3,4),c._UZ(3,"formly-validation-message",5),c.qZA()),2&R){const W=c.oxw();c.Q6J("control",null==W.field?null:W.field.formControl)("label",null==W.to?null:W.to.label)("hidden",null==W.field?null:W.field.hide)("required",null==W.to?null:W.to.required)("helpTextAttribute",null==W.to?null:W.to.property)("helpTextAttributeScope",(null==W.to?null:W.to.helpTextAttributeScope)||(null==W.dynamicFormComponent?null:W.dynamicFormComponent.helpTextAttributeScope))("showValidationErrorOn",(null==W.to?null:W.to.showValidationErrorOn)||(null==W.dynamicFormComponent?null:W.dynamicFormComponent.showValidationErrorsOn)),c.uIk("data-qa-field-name",null==W.to?null:W.to.property),c.xp6(3),c.Q6J("field",W.field)}}class G extends e.n2{constructor(L){super(),this.dynamicFormComponent=L}}G.\u0275fac=function(L){return new(L||G)(c.Y36(I.r,8))},G.\u0275cmp=c.Xpm({type:G,selectors:[["op-dynamic-field-wrapper"]],features:[c.qOj],decls:2,vars:2,consts:[[3,"control","label","hidden","noWrapLabel","required","helpTextAttribute","helpTextAttributeScope","showValidationErrorOn",4,"ngIf"],[3,"control","label","hidden","required","helpTextAttribute","helpTextAttributeScope","showValidationErrorOn",4,"ngIf"],[3,"control","label","hidden","noWrapLabel","required","helpTextAttribute","helpTextAttributeScope","showValidationErrorOn"],["slot","input"],["fieldComponent",""],["slot","errors",1,"op-form-field--error",3,"field"],[3,"control","label","hidden","required","helpTextAttribute","helpTextAttributeScope","showValidationErrorOn"]],template:function(L,W){1&L&&(c.YNc(0,te,4,10,"op-form-field",0),c.YNc(1,ee,4,9,"op-checkbox-field",1)),2&L&&(c.Q6J("ngIf","booleanInput"!==W.field.type),c.xp6(1),c.Q6J("ngIf","booleanInput"===W.field.type))},directives:[i.O5,J.V,e.u_,N.X],styles:[""],changeDetection:0});var se=t(6894),me=t(2281),_e=t(70692),he=t(90547),ae=t(12877);class re extends he.S{constructor(L,W,oe,Oe){super(L,W),this.ngZone=oe,this.changeDetectorRef=Oe,this.onControlChange=$=>{},this.onControlTouch=()=>{}}writeValue(L){this.initialDate=this.formatter(L)}registerOnChange(L){this.onControlChange=L}registerOnTouched(L){this.onControlTouch=L}setDisabledState(L){this.disabled=L}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.initializeDatepicker(),this.changeDetectorRef.detectChanges()})})}onInputChange(){const L=this.inputIsValidDate()?this.parser(this.currentValue):"";this.onControlChange(L),this.onControlTouch()}closeOnOutsideClick(L){super.closeOnOutsideClick(L),this.onControlTouch()}parser(L){return me(L,"YYYY-MM-DD",!0).isValid()?L:null}formatter(L){if(me(L,"YYYY-MM-DD",!0).isValid()){const W=this.timezoneService.parseDate(L);return this.timezoneService.formattedISODate(W)}return""}}re.\u0275fac=function(L){return new(L||re)(c.Y36(_e.B),c.Y36(ae.e),c.Y36(c.R0b),c.Y36(c.sBO))},re.\u0275cmp=c.Xpm({type:re,selectors:[["op-date-picker-control"]],inputs:{disabled:["disable","disabled"]},features:[c._Bn([{provide:u.JU,useExisting:(0,c.Gpc)(()=>re),multi:!0}]),c.qOj],decls:2,vars:7,consts:[["type","text",3,"id","name","value","ngClass","size","required","disabled","click","keydown.escape","blur","input"],["dateInput",""]],template:function(L,W){1&L&&(c.TgZ(0,"input",0,1),c.NdJ("click",function(){return W.openOnClick()})("keydown.escape",function(){return W.close()})("blur",function(Oe){return W.closeOnOutsideClick(Oe)})("input",function(){return W.onInputChange()}),c.qZA()),2&L&&c.Q6J("id",W.id)("name",W.name)("value",W.initialDate||"")("ngClass",W.classes+" op-input")("size",W.size)("required",W.required)("disabled",W.disabled)},directives:[i.mk],encapsulation:2});class ye extends e.fS{}ye.\u0275fac=function(){let R;return function(W){return(R||(R=c.n5z(ye)))(W||ye)}}(),ye.\u0275cmp=c.Xpm({type:ye,selectors:[["op-date-input"]],features:[c.qOj],decls:1,vars:4,consts:[[3,"required","disable","formControl","formlyAttributes"]],template:function(L,W){1&L&&c._UZ(0,"op-date-picker-control",0),2&L&&c.Q6J("required",W.to.required)("disable",W.to.disabled)("formControl",W.formControl)("formlyAttributes",W.field)},directives:[re,u.Q7,u.JJ,u.oH,e.VQ],styles:[""]});const Ce=function(R){return{"op-fieldset_collapsed":R}};function ke(R,L){if(1&R){const W=c.EpF();c.TgZ(0,"fieldset",2),c.TgZ(1,"legend",3),c.TgZ(2,"button",4),c.NdJ("click",function(){c.CHM(W);const Oe=c.oxw();return Oe.to.collapsibleFieldGroupsCollapsed=!Oe.to.collapsibleFieldGroupsCollapsed}),c._uU(3),c.qZA(),c.qZA(),c.TgZ(4,"div",5),c.GkF(5,null,6),c.qZA(),c.qZA()}if(2&R){const W=c.oxw();c.Q6J("ngClass",c.VKq(2,Ce,W.to.collapsibleFieldGroupsCollapsed)),c.xp6(3),c.hij(" ",W.to.label," ")}}function Ae(R,L){if(1&R&&(c.TgZ(0,"fieldset",7),c.TgZ(1,"legend",3),c._uU(2),c.qZA(),c.TgZ(3,"div",5),c.GkF(4,null,6),c.qZA(),c.qZA()),2&R){const W=c.oxw();c.xp6(2),c.Oqu(W.to.label)}}class Fe extends e.n2{}Fe.\u0275fac=function(){let R;return function(W){return(R||(R=c.n5z(Fe)))(W||Fe)}}(),Fe.\u0275cmp=c.Xpm({type:Fe,selectors:[["op-dynamic-field-group-wrapper"]],features:[c.qOj],decls:2,vars:2,consts:[["class","op-fieldset op-fieldset_collapsible",3,"ngClass",4,"ngIf"],["class","op-fieldset",4,"ngIf"],[1,"op-fieldset","op-fieldset_collapsible",3,"ngClass"],[1,"op-fieldset--legend"],["title","Show/hide","type","button",1,"op-fieldset--toggle",3,"click"],[1,"op-fieldset--fields"],["fieldComponent",""],[1,"op-fieldset"]],template:function(L,W){1&L&&(c.YNc(0,ke,7,4,"fieldset",0),c.YNc(1,Ae,6,1,"fieldset",1)),2&L&&(c.Q6J("ngIf",null==W.to?null:W.to.collapsibleFieldGroups),c.xp6(1),c.Q6J("ngIf",!(null!=W.to&&W.to.collapsibleFieldGroups)))},directives:[i.O5,i.mk],styles:[""]});var ot=t(18869),it=t(97779),Ve=t(76315);class Ie{}Ie.\u0275fac=function(L){return new(L||Ie)},Ie.\u0275mod=c.oAB({type:Ie}),Ie.\u0275inj=c.cJS({imports:[[i.ez,it.$,Ve.s]]});var ue=t(21757);class ie{}ie.\u0275fac=function(L){return new(L||ie)},ie.\u0275mod=c.oAB({type:ie}),ie.\u0275inj=c.cJS({providers:[{provide:n.TP,useClass:ot.s,multi:!0}],imports:[[i.ez,u.UX,e.X0.forRoot({types:[{name:"booleanInput",component:M},{name:"integerInput",component:h},{name:"textInput",component:r},{name:"dateInput",component:ye},{name:"selectInput",component:E},{name:"selectProjectStatusInput",component:k},{name:"formattableInput",component:F}],wrappers:[{name:"op-dynamic-field-group-wrapper",component:Fe},{name:"op-dynamic-field-wrapper",component:G}]}),n.JF,ue.H,p.A0,l._,se.Y,v,Ie]]})},77616:(H,D,t)=>{"use strict";t.d(D,{mE:()=>E,U$:()=>P,s5:()=>w});var i=t(3786),e=t(2316),c=t(96617),u=t(49951),r=t(29161),n=t(54364),h=t(1707),a=t(84312),p=t(2775);const l=["editableTitleInput"];function d(x,k){if(1&x){const b=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(M){return e.CHM(b),e.oxw(2).save(M,!0)}),e._UZ(1,"op-icon",8),e.qZA()}if(2&x){const b=e.oxw(2);e.uIk("title",b.text.query_has_changed_click_to_save)}}const g=function(x,k){return{"-error":x,"-changed":k}};function C(x,k){if(1&x){const b=e.EpF();e.TgZ(0,"div",2),e.NdJ("focusout",function(M){return e.CHM(b),e.oxw().saveWhenFocusOutside(M)}),e.YNc(1,d,2,1,"button",3),e.TgZ(2,"input",4,5),e.NdJ("focus",function(M){return e.CHM(b),e.oxw().onFocus(M)})("blur",function(){return e.CHM(b),e.oxw().onBlur()})("keydown.escape",function(M){return e.CHM(b),e.oxw().reset(M)})("keydown.enter",function(M){return e.CHM(b),e.oxw().save(M)})("ngModelChange",function(M){e.CHM(b);return e.oxw().selectedTitle=M}),e.qZA(),e.TgZ(4,"input-shim",6),e._uU(5),e.qZA(),e.qZA()}if(2&x){const b=e.oxw();e.xp6(1),e.Q6J("ngIf",b.showSave),e.xp6(1),e.Q6J("opAutofocus",b.initialFocus||void 0)("ngModel",b.selectedTitle)("disabled",b.inFlight)("ngClass",e.WLB(10,g,b.isEmpty,b.showSave)),e.uIk("name",b.selectableTitleIdentifier)("placeholder",b.text.input_placeholder)("title",b.text.input_title),e.xp6(3),e.AsE("",b.selectedTitle||b.text.input_placeholder,"",b.selectedTitle?"\xa0\xa0":"","")}}const y=function(x,k){return{"-disabled":x,"-small":k}};function m(x,k){if(1&x&&(e.TgZ(0,"h2",9),e._uU(1),e.qZA()),2&x){const b=e.oxw();e.Q6J("ngClass",e.WLB(3,y,b.disabled,b.smallHeader)),e.uIk("title",b.selectedTitle),e.xp6(1),e.hij("",b.selectedTitle,"\n")}}const E="op:selectableTitle:trigger",P="editable-toolbar-title";class w{constructor(k){this.injector=k,this.editable=!0,this.inFlight=!1,this.showSaveCondition=!1,this.initialFocus=!1,this.smallHeader=!1,this.onSave=new e.vpe,this.onEmptySubmit=new e.vpe,this.baseClass=!0,this.selectableTitleIdentifier=P,this.text={click_to_edit:this.I18n.t("js.work_packages.query.click_to_edit_query_name"),press_enter_to_save:this.I18n.t("js.label_press_enter_to_save"),query_has_changed_click_to_save:this.I18n.t("js.label_view_has_changed"),input_title:"",input_placeholder:this.I18n.t("js.work_packages.query.rename_query_placeholder"),search_query_title:this.I18n.t("js.toolbar.search_query_title"),confirm_edit_cancel:this.I18n.t("js.work_packages.query.confirm_edit_cancel"),duplicate_query_title:this.I18n.t("js.work_packages.query.errors.duplicate_query_title")}}get editableClass(){return this.editable}ngOnInit(){this.text.input_title=`${this.text.click_to_edit} ${this.text.press_enter_to_save}`,jQuery(this.elementRef.nativeElement).on(E,(k,b="")=>{!this.inputField||(this.selectedTitle=b,setTimeout(()=>{this.inputField.nativeElement.focus()},20),k.stopPropagation())})}ngOnChanges(k){if(k.inputTitle&&(this.selectedTitle=k.inputTitle.currentValue),k.initialFocus&&k.initialFocus.firstChange&&this.inputField){const b=this.inputField.nativeElement;this.selectInputOnInitalFocus(b)}}onFocus(k){this.toggleToolbarButtonVisibility(!0),this.selectInputOnInitalFocus(k.target)}onBlur(){this.toggleToolbarButtonVisibility(!1)}selectInputOnInitalFocus(k){this.initialFocus&&(k.select(),this.initialFocus=!1)}saveWhenFocusOutside(k){(0,u.w)(this.elementRef.nativeElement,()=>this.save(k))}reset(){this.resetInputField(),this.selectedTitle=this.inputTitle}get showSave(){return this.editable&&this.showSaveCondition}save(k,b=!1){k.preventDefault(),this.resetInputField(),this.selectedTitle=this.selectedTitle.trim(),this.isEmpty?this.onEmptyError():!b&&this.inputTitle===this.selectedTitle||(this.inputField&&this.inputField.nativeElement.blur(),!this.inFlight&&(this.inFlight=!0,this.emitSave(this.selectedTitle),setTimeout(()=>this.inFlight=!1,100)))}get isEmpty(){return""===this.selectedTitle}emitSave(k){this.onSave.emit(k)}onEmptyError(){this.onEmptySubmit.emit(),this.focusInputOnError()}focusInputOnError(){if(this.inputField){const k=this.inputField.nativeElement;k.classList.add("-error"),k.focus()}}resetInputField(){this.inputField&&this.inputField.nativeElement.classList.remove("-error")}toggleToolbarButtonVisibility(k){jQuery(".toolbar-items").toggleClass("hidden-for-mobile",k)}}w.\u0275fac=function(k){return new(k||w)(e.Y36(e.zs3))},w.\u0275cmp=e.Xpm({type:w,selectors:[["editable-toolbar-title"]],viewQuery:function(k,b){if(1&k&&e.Gf(l,5),2&k){let v;e.iGM(v=e.CRH())&&(b.inputField=v.first)}},hostVars:4,hostBindings:function(k,b){2&k&&e.ekj("title-container",b.baseClass)("title-container_editable",b.editableClass)},inputs:{inputTitle:["title","inputTitle"],editable:"editable",inFlight:"inFlight",showSaveCondition:"showSaveCondition",initialFocus:"initialFocus",smallHeader:"smallHeader"},outputs:{onSave:"onSave",onEmptySubmit:"onEmptySubmit"},features:[e.TTD],decls:2,vars:2,consts:[["class","editable-toolbar-title--container",3,"focusout",4,"ngIf"],["class","editable-toolbar-title--fixed",3,"ngClass",4,"ngIf"],[1,"editable-toolbar-title--container",3,"focusout"],["type","button","class","spot-link editable-toolbar-title--save",3,"click",4,"ngIf"],["size","1","type","text","aria-required","true",1,"editable-toolbar-title--input","-border-on-hover-only","toolbar--editable-toolbar","ellipsis",3,"opAutofocus","ngModel","disabled","ngClass","focus","blur","keydown.escape","keydown.enter","ngModelChange"],["editableTitleInput",""],[1,"editable-toolbar-title--input","editable-toolbar-title--input-shim","toolbar--editable-toolbar"],["type","button",1,"spot-link","editable-toolbar-title--save",3,"click"],["icon-classes","icon icon-save icon-no-color"],[1,"editable-toolbar-title--fixed",3,"ngClass"]],template:function(k,b){1&k&&(e.YNc(0,C,6,13,"div",0),e.YNc(1,m,2,6,"h2",1)),2&k&&(e.Q6J("ngIf",b.editable),e.xp6(1),e.Q6J("ngIf",!b.editable))},directives:[n.O5,h.Fj,a.U,h.JJ,h.On,n.mk,p.o],styles:['.editable-toolbar-title--container[_ngcontent-%COMP%]{display:grid;align-items:center;grid-template-columns:auto auto 1fr}.editable-toolbar-title--container[_ngcontent-%COMP%]:before, .editable-toolbar-title--container[_ngcontent-%COMP%]:after{display:block;content:""}.editable-toolbar-title--container[_ngcontent-%COMP%]:before{grid-area:1/1}.editable-toolbar-title--container[_ngcontent-%COMP%]:after{grid-area:1/3}.editable-toolbar-title--fixed[_ngcontent-%COMP%]{padding:0;cursor:default}.editable-toolbar-title--save[_ngcontent-%COMP%]{grid-area:1/1}.editable-toolbar-title--save[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:before{color:#5f5f5f}.editable-toolbar-title--save[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]:before{color:#2c2c2c}.editable-toolbar-title--input[_ngcontent-%COMP%]{color:#5f5f5f}.editable-toolbar-title--input[_ngcontent-%COMP%]:focus{border-color:#999;box-shadow:0 0 0 1px #999}.editable-toolbar-title--input.-changed[_ngcontent-%COMP%]{font-style:italic}.editable-toolbar-title--input[_ngcontent-%COMP%]{display:block;grid-area:1/2;padding-left:5px;width:auto;min-width:1em}.editable-toolbar-title--input-shim[_ngcontent-%COMP%]{visibility:hidden;white-space:pre}input-shim[_ngcontent-%COMP%]{border:1px solid transparent;padding:.375rem;margin:0}']}),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",e.SBq)],w.prototype,"elementRef",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",c.D)],w.prototype,"I18n",void 0)},17076:(H,D,t)=>{"use strict";t.d(D,{K:()=>c});var i=t(80261),e=t(2316);class c{constructor(r,n,h){this.componentFactoryResolver=r,this.appRef=n,this.injector=h}render(r,n){r.innerHTML=n;const h=[];return i.Z.getEmbeddable().forEach(a=>{const p=r.querySelectorAll(a.selector);for(let l=0,d=p.length;l<d;l++){const C=this.componentFactoryResolver.resolveComponentFactory(a.cls).create(this.injector,[],p[l]);h.push(C),this.appRef.attachView(C.hostView),C.changeDetectorRef.detectChanges()}}),()=>{h.forEach(a=>{this.appRef.detachView(a.hostView),a.destroy()}),h.length=0,r.innerHTML=""}}}c.\u0275fac=function(r){return new(r||c)(e.LFG(e._Vd),e.LFG(e.z2F),e.LFG(e.zs3))},c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac})},37130:(H,D,t)=>{"use strict";t.d(D,{j:()=>u});var i=t(3786),e=t(70233),c=t(2316);class u{constructor(n){this.PathHelper=n,this.loadedLocale="en"}create(n,h,a=null){return(0,i.mG)(this,void 0,void 0,function*(){yield this.load();const{type:p}=h,l="constrained"===p?window.OPConstrainedEditor:window.OPClassicEditor;n.classList.add(`ckeditor-type-${p}`);const d=n.querySelector(".document-editor__toolbar"),g=n.querySelector(".document-editor__editable"),C=this.loadedLocale,y=h.options&&h.options.rtl?"ar":"en",m={openProject:this.createConfig(h),initialData:a,language:{ui:C,content:y}};return this.createWatchdog(l,g,m).then(E=>{const{editor:P}=E;return d.appendChild(P.ui.view.toolbar.element),jQuery(n).on("op:ckeditor:setData",(w,x)=>P.setData(x)).on("op:ckeditor:clear",()=>P.setData(" ")).on("op:ckeditor:getData",(w,x)=>x(P.getData({trim:!1}))),E})})}createWatchdog(n,h,a){const p=new window.OPEditorWatchdog;return p.setCreator(()=>n.createCustomized(h,a)),p.setDestructor(l=>l.destroy()),p.create(h,{}).then(()=>p)}load(){return(0,i.mG)(this,void 0,void 0,function*(){yield t.e("src_vendor_ckeditor_ckeditor_js").then(t.t.bind(t,24626,23));try{yield t(87983)(`./${I18n.locale}.js`),this.loadedLocale=I18n.locale}catch(n){console.warn(`Failed to load translation for CKEditor: ${n}`)}})}createConfig(n){return"none"===n.macros?n.macros=!1:"resource"===n.macros&&(n.macros=["OPMacroToc","OPMacroEmbeddedTable","OPMacroWpButton"]),{context:n,helpURL:this.PathHelper.textFormattingHelp(),pluginContext:window.OpenProject.pluginContext.value}}}u.\u0275fac=function(n){return new(n||u)(c.LFG(e.j))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},26611:(H,D,t)=>{"use strict";t.d(D,{F:()=>d});var i=t(2316),e=t(36293),c=t(96617),u=t(12877),r=t(37130),n=t(54364);const h=["opCkeditorReplacementContainer"],a=["codeMirrorPane"];function p(g,C){if(1&g&&(i.TgZ(0,"div",6),i.TgZ(1,"div",7),i.TgZ(2,"p"),i._UZ(3,"strong",8),i._UZ(4,"br"),i._UZ(5,"span",8),i.qZA(),i.qZA(),i.qZA()),2&g){const y=i.oxw();i.xp6(3),i.Q6J("textContent",y.text.errorTitle),i.xp6(2),i.Q6J("textContent",y.error)}}class d{constructor(C,y,m,E,P){this.elementRef=C,this.Notifications=y,this.I18n=m,this.configurationService=E,this.ckEditorSetup=P,this.onInitialized=new i.vpe,this.onContentChange=new i.vpe,this.onInitializationFailed=new i.vpe,this.error=null,this.allowManualMode=!1,this.manualMode=!1,this._content="",this.text={errorTitle:this.I18n.t("js.editor.ckeditor_error")},this.debouncedEmitter=_.debounce(()=>{this.getTransformedContent(!1).then(w=>{this.onContentChange.emit(w)})},1e3,{leading:!0})}set content(C){this._content=C||"",this.initialized&&this.ckEditorInstance.setData(this._content)}getRawData(){return this.manualMode?this._content=this.codeMirrorInstance.getValue():this._content=this.ckEditorInstance.getData({trim:!1})}getTransformedContent(C=!0){if(!this.initialized)throw new Error("Tried to access CKEditor instance before initialization.");return new Promise((y,m)=>{try{y(this.getRawData())}catch(E){console.error(`Failed to save CKEditor content: ${E}.`);const P=this.I18n.t("js.editor.error_saving_failed",{error:E||this.I18n.t("js.error.internal")});C&&this.Notifications.addError(P),m(P)}})}get content(){return this._content}get initialized(){return void 0!==this.ckEditorInstance}ngOnInit(){try{this.initializeEditor()}catch(C){console.error(`Failed to setup CKEditor instance: ${C}`),this.error=C,this.onInitializationFailed.emit(C)}}ngOnDestroy(){var C;try{null===(C=this.watchdog)||void 0===C||C.destroy()}catch(y){console.error("Failed to destroy CKEditor instance:",y)}}initializeEditor(){this.$element=jQuery(this.elementRef.nativeElement);const C=this.ckEditorSetup.create(this.opCkeditorReplacementContainer.nativeElement,this.context,this.content).catch(y=>{throw y}).then(y=>(this.setupWatchdog(y),this.ckEditorInstance=y.editor,y.editor.model.document.on("change",this.debouncedEmitter),y.editor.on("op:source-code-enabled",()=>this.enableManualMode()),y.editor.on("op:source-code-disabled",()=>this.disableManualMode()),this.onInitialized.emit(y.editor),y.editor));this.$element.data("editor",C)}disableManualMode(){const C=this.getRawData();this.ckEditorInstance.setData(C),this.codeMirrorInstance=null,this.manualMode=!1}enableManualMode(){const C=this.getRawData();Promise.all([t.e("default-node_modules_codemirror_lib_codemirror_js").then(t.t.bind(t,21302,23)),t(30341)("./gfm/gfm.js")]).then(m=>{const E=m[0].default;this.codeMirrorInstance=E(this.$element.find(".ck-editor__source")[0],{lineNumbers:!0,smartIndent:!0,value:C,mode:""}),this.codeMirrorInstance.on("change",this.debouncedEmitter),setTimeout(()=>this.codeMirrorInstance.refresh(),100),this.manualMode=!0})}setupWatchdog(C){this.watchdog=C,C.on("error",(y,{error:m})=>{this.error=m.message})}}d.\u0275fac=function(C){return new(C||d)(i.Y36(i.SBq),i.Y36(e.kl),i.Y36(c.D),i.Y36(u.e),i.Y36(r.j))},d.\u0275cmp=i.Xpm({type:d,selectors:[["op-ckeditor"]],viewQuery:function(C,y){if(1&C&&(i.Gf(h,7),i.Gf(a,5)),2&C){let m;i.iGM(m=i.CRH())&&(y.opCkeditorReplacementContainer=m.first),i.iGM(m=i.CRH())&&(y.codeMirrorPane=m.first)}},inputs:{context:"context",content:"content"},outputs:{onInitialized:"onInitialized",onContentChange:"onContentChange",onInitializationFailed:"onInitializationFailed"},decls:7,vars:1,consts:[["class","op-toast -error",4,"ngIf"],[1,"op-ckeditor-source-element","document-editor"],["opCkeditorReplacementContainer",""],[1,"document-editor__toolbar"],[1,"document-editor__editable-container"],[1,"document-editor__editable"],[1,"op-toast","-error"],[1,"op-toast--content"],[3,"textContent"]],template:function(C,y){1&C&&(i.ynx(0),i.YNc(1,p,6,2,"div",0),i.TgZ(2,"div",1,2),i._UZ(4,"div",3),i.TgZ(5,"div",4),i._UZ(6,"div",5),i.qZA(),i.qZA(),i.BQk()),2&C&&(i.xp6(1),i.Q6J("ngIf",y.error))},directives:[n.O5],styles:[".op-ckeditor--mode-switch[_ngcontent-%COMP%]{text-align:right}.op-ckeditor--mode-switch[_ngcontent-%COMP%]   button.button[_ngcontent-%COMP%]{margin:0 0 5px}"]})},97779:(H,D,t)=>{"use strict";t.d(D,{$:()=>p});var i=t(1707),e=t(54364),c=t(31283),u=t(55811),r=t(37130),n=t(17076),h=t(82170),a=t(2316);class p{}p.\u0275fac=function(d){return new(d||p)},p.\u0275mod=a.oAB({type:p}),p.\u0275inj=a.cJS({providers:[h.f,r.j,n.K],imports:[[i.u5,e.ez,c.Z,u.K]]})},8158:(H,D,t)=>{"use strict";t.d(D,{P:()=>n});var i=t(24e3),e=t(96617),c=t(2316),u=t(54364);const r=function(h){return{"-left-margin":h}};class n{constructor(a,p){this.I18n=a,this.bannersService=p,this.leftMargin=!1,this.text={enterpriseFeature:this.I18n.t("js.upsale.ee_only")}}ngOnInit(){this.link=this.bannersService.getEnterPriseEditionUrl({referrer:this.opReferrer})}}n.\u0275fac=function(a){return new(a||n)(c.Y36(e.D),c.Y36(i.j))},n.\u0275cmp=c.Xpm({type:n,selectors:[["enterprise-banner"]],inputs:{leftMargin:"leftMargin",textMessage:"textMessage",linkMessage:"linkMessage",opReferrer:"opReferrer"},decls:6,vars:7,consts:[["data-qa-selector","op-enterprise-banner",1,"op-enterprise-banner"],[1,"op-toast","-ee-upsale",3,"ngClass"],[1,"op-toast--content"],[1,"-bold",3,"textContent"],[3,"textContent"],["target","blank",3,"href","textContent"]],template:function(a,p){1&a&&(c.TgZ(0,"div",0),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c._UZ(3,"p",3),c._UZ(4,"p",4),c._UZ(5,"a",5),c.qZA(),c.qZA(),c.qZA()),2&a&&(c.xp6(1),c.Q6J("ngClass",c.VKq(5,r,p.leftMargin)),c.xp6(2),c.Q6J("textContent",p.text.enterpriseFeature),c.xp6(1),c.Q6J("textContent",p.textMessage),c.xp6(1),c.Q6J("href",p.link,c.LSH)("textContent",p.linkMessage))},directives:[u.mk],styles:[".op-enterprise-banner[_ngcontent-%COMP%]   .op-toast.-left-margin[_ngcontent-%COMP%]{margin-left:1.25rem}.op-enterprise-banner[_ngcontent-%COMP%]   .op-toast[_ngcontent-%COMP%]   .op-toast--content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:10px}"],changeDetection:0})},94232:(H,D,t)=>{"use strict";t.d(D,{W:()=>p});class i{constructor(){this.changes={}}contains(d){return this.changes.hasOwnProperty(d)}get changed(){return _.keys(this.changes)}get all(){return this.changes}reset(...d){d.forEach(g=>{delete this.changes[g]})}clear(){this.changes={}}set(d,g,C){this.changes[d]={from:C,to:g}}getItem(d){return this.changes[d]}getValue(d){var g;return null===(g=this.getItem(d))||void 0===g?void 0:g.to}getPristine(d){var g;return null===(g=this.changes[d])||void 0===g?void 0:g.from}}var e=t(14808),c=t(3352),u=t(53466),r=t(44022),n=t(81531),h=t(84699);class p{constructor(d,g,C=null){this.state=g,this.changeset=new i,this.form$=(0,e.qH)(),this.cache={},this.inFlight=!1,this.updatePristineResource(d),this.schemaCache=d.injector.get(r.y),C&&this.form$.putValue(C)}push(){this.state&&this.state.putValue(this)}buildRequestPayload(){return this.getForm().then(()=>this.buildPayloadFromChanges())}updatePristineResource(d){if(d.__is_changeset_proxy)throw new Error("You're trying to pass proxy object as a pristine resource. This will cause errors");this._pristineResource=d,this.projectedResource=new Proxy(this._pristineResource,{get:(g,C)=>this.proxyGet(C),set:(g,C,y)=>(this.setValue(C,y),!0)})}get pristineResource(){return this._pristineResource}getForm(d=!1){return!this.form$.isPristine()&&!d||this.form$.hasActivePromiseRequest()?this.form$.values$().pipe((0,u.q)(1)).toPromise():this.updateForm()}updateForm(){const d=this.buildPayloadFromChanges(),g=this.pristineResource.$links.update(d).then(C=>(this.cache={},this.form$.putValue(C),this.setNewDefaults(C),this.push(),C));return this.form$.putFromPromiseIfPristine(()=>g),g}isEmpty(){return 0===this.changeset.changed.length}get id(){return this.pristineResource.id.toString()}get href(){return this.pristineResource.href}get changes(){const d={};return _.each(this.changeset.all,(g,C)=>{d[C]=g.to}),d}get changeMap(){return Object.assign({},this.changeset.all)}get changedAttributes(){return this.changeset.changed}isWritable(d){const g=this.schema.ofProperty(d);return!(!g||!g.writable)}humanName(d){return _.get(this.schema,`${d}.name`,d)}contains(d){return this.changeset.contains(d)}proxyGet(d){return"__is_proxy"===d||this.value(d)}value(d){return this.changeset.contains(d)?this.changeset.getValue(d):this.pristineResource[d]}valueExists(d){return this.changeset.contains(d)||this.pristineResource.hasOwnProperty(d)}setValue(d,g){this.changeset.set(d,g,this.pristineResource[d])}clearValue(...d){this.changeset.reset(...d)}clear(){this.state&&this.state.clear(),this.changeset.clear(),this.cache={},this.form$.clear()}reset(d){this.changeset.reset(d)}isOverridden(d){return this.changes.hasOwnProperty(d)}get schema(){return this.form$.hasValue()?n.V.create(this.form$.value.schema,this.projectedResource):this.schemaCache.of(this.pristineResource)}cacheValue(d,g){return this.cache[d]?this.cache[d]:this.cache[d]=g()}get minimalPayload(){return{lockVersion:this.pristineResource.lockVersion,_links:{}}}applyChanges(d){let g=this.pristineResource.$source;return this.form$.value&&(g=this.form$.value.payload.$source),_.each(this.changeset.all,(C,y)=>{if(!this.schema.isAttributeEditable(y))return void(0,c.qu)(`Trying to write ${y} but is not writable in schema`);const m=this.schema.ofProperty(y);m&&g._links[y]?d._links[y]=this.getLinkedValue(C.to,m):d[y]=C.to}),d}buildPayloadFromChanges(){let d;return(0,h.Z)(this.pristineResource)?(d=this.form$.value?_.cloneDeep(this.form$.value.payload.$source):_.cloneDeep(this.pristineResource.$source),this.pristineResource.attachments&&(d._links.attachments=this.pristineResource.attachments.elements.map(g=>({href:g.href})))):d=this.minimalPayload,this.applyChanges(d)}getLinkedValue(d,g){if(_.isNil(d))return{href:null};const C=(g.type||"").startsWith("[]");let y=!1;if((d.forEach||d.elements)&&(y=!0),y&&C){const m=[];return d&&(d.forEach&&d||d.elements).forEach(P=>{P.href&&m.push({href:P.href})}),m}return{href:_.get(d,"href",null)}}setNewDefaults(d){_.each(d.payload,(g,C)=>{const y=this.schema.ofProperty(C);!(null==y?void 0:y.writable)||this.setNewDefaultFor(C,g)})}setNewDefaultFor(d,g){this.valueExists(d)||((0,c.qu)(`Taking over default value from form for ${d}`),this.setValue(d,g))}}},7812:(H,D,t)=>{"use strict";t.d(D,{uA:()=>v,OZ:()=>x,zZ:()=>k,c0:()=>m,n5:()=>P});var i=t(3786),e=t(96617),c=t(60874),u=t(55741),r=t(79644);class n extends r.L{render(S,O){const A=this.value;S.setAttribute("title",O),S.textContent=O,S.innerHTML="",0===A.length?this.renderEmpty(S):this.renderValues(A,S)}renderValues(S,O){S.forEach(A=>{const F=document.createElement("div");F.classList.add(u.x,"-multiple-lines"),F.setAttribute("title",A),F.textContent=A,O.appendChild(F)})}}var h=t(39469);class a extends h.N{render(S,O){const A=this.percentLabel;S.setAttribute("title",A),S.innerHTML="",S.textContent=A}}var p=t(29161),l=t(13964);class d extends r.L{render(S,O){const A=this.attribute;S.setAttribute("title",O),S.textContent=O,S.innerHTML="",0===A.length?this.renderEmpty(S):this.renderValues(A,S)}renderValues(S,O){this.principalRenderer.renderMultiple(O,S,{hide:!1,link:!1},{hide:!1,size:"medium"},!0)}}(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",l.C)],d.prototype,"principalRenderer",void 0);var g=t(44022),C=t(12703),y=t(63733);const m="-editable",P="-read-only",x="inline-edit--display-field",k="inline-edit--container";class v{constructor(S,O,A={}){this.injector=S,this.container=O,this.options=A,this.fieldCache={}}render(S,O,A,F){const[I,J]=this.renderFieldValue(S,O,A,F);return null===I||this.setSpanAttributes(J,I,O,S,A),J}renderFieldValue(S,O,A,F){const I=document.createElement("span"),J=this.schema(S,A),N=this.attributeName(O,J),te=J.ofProperty(N);if(!te)return[null,I];const ee=this.getField(S,te,N,A);ee.render(I,this.getText(ee,te,F),te.options);const{title:G}=ee;return G&&I.setAttribute("title",G),I.setAttribute("aria-label",this.getAriaLabel(ee,J)),[ee,I]}getField(S,O,A,F){let I=this.fieldCache[A];return I||(I=this.fieldCache[A]=this.getFieldForCurrentContext(S,A,O)),I.apply(S,O),I.activeChange=F,I}getFieldForCurrentContext(S,O,A){const F={container:this.container,injector:this.injector,options:this.options},I=["[]CustomOption"].indexOf(A.type)>=0;if("single-view"===this.container&&I)return new n(O,F);const J=["[]User"].indexOf(A.type)>=0;return"single-view"===this.container&&J?new d(O,F):"timeline"===this.container&&"percentageDone"===O?new a(O,F):"table"===this.container&&["startDate","dueDate","date"].includes(O)?new y.C(O,F):this.displayFieldService.getField(S,O,A,F)}getText(S,O,A){return S.isEmpty()?A||this.getDefaultPlaceholder(O):S.valueString}setSpanAttributes(S,O,A,F,I){S.classList.add(x,A),S.dataset.fieldName=A,S.setAttribute("tabindex","id"===A?"-1":"0"),O.required&&S.classList.add("-required"),O.isEmpty()&&S.classList.add("-placeholder");const J=this.schema(F,I);this.isAttributeEditable(J,A)?(S.classList.add(m),S.setAttribute("role","button")):S.classList.add(P)}isAttributeEditable(S,O){return["startDate","dueDate","date"].includes(O)&&(O="combinedDate"),S.isAttributeEditable(O)}getAriaLabel(S,O){let A;const F=this.getLabelContent(S);if(S.isFormattable&&!S.isEmpty())try{A=_.escape(jQuery(`<div>${F}</div>`).text())}catch(I){console.error("Failed to parse formattable labelContent"),A=`Label for ${S.displayName}`}else A=F;return S.writable&&O.isAttributeEditable(S.name)?this.I18n.t("js.inplace.button_edit",{attribute:`${S.displayName} ${A}`}):`${S.displayName} ${A}`}getLabelContent(S){return S.isEmpty()?this.I18n.t("js.inplace.null_value_label"):S.valueString}attributeName(S,O){return O.mappedName?O.mappedName(S):S}getDefaultPlaceholder(S){return"Formattable"===S.type?this.I18n.t("js.work_packages.placeholders.formattable",{name:S.name}):"-"}schema(S,O){return O?O.schema:this.halEditing.typedState(S).hasValue()?this.halEditing.typedState(S).value.schema:this.schemaCache.of(S)}}(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",c.i)],v.prototype,"displayFieldService",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",g.y)],v.prototype,"schemaCache",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",C.l)],v.prototype,"halEditing",void 0),(0,i.gn)([(0,p.W)(),(0,i.w6)("design:type",e.D)],v.prototype,"I18n",void 0)},55741:(H,D,t)=>{"use strict";t.d(D,{x:()=>r,C:()=>n});var i=t(3786),e=t(82635),c=t(96617),u=t(29161);const r="custom-option";class n extends e.g{constructor(a,p){super(),this.name=a,this.context=p,this.mode=null,this.activeChange=null,this.texts={empty:this.I18n.t("js.label_no_value"),placeholder:this.I18n.t("js.placeholders.default")}}apply(a,p){this.resource=a,this.schema=p}get isFormattable(){return!1}get injector(){return this.context.injector}get value(){return this.schema?this.activeChange?this.activeChange.projectedResource[this.name]:this.attribute:null}get attribute(){return this.resource[this.name]}get type(){return this.constructor.type}get valueString(){return this.value}get placeholder(){return"-"}get label(){return this.schema.name||this.name}get title(){return this.isFormattable?null:this.valueString}render(a,p,l={}){a.textContent=p}renderEmpty(a){const p=document.createElement("div");p.setAttribute("title",this.texts.empty),p.textContent=this.texts.placeholder,p.classList.add(r,"-empty"),a.appendChild(p)}}(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",c.D)],n.prototype,"I18n",void 0)},60874:(H,D,t)=>{"use strict";t.d(D,{i:()=>c});var i=t(39478),e=t(2316);class c extends i.h{getField(r,n,h,a){const l=new(this.getSpecificClassFor(r._type,n,h.type))(n,a);return l.apply(r,h),l}}c.\u0275fac=function(){let u;return function(n){return(u||(u=e.n5z(c)))(n||c)}}(),c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})},74215:(H,D,t)=>{"use strict";t.d(D,{Z:()=>e});var i=t(63733);class e extends i.C{constructor(){super(...arguments),this.text={placeholder:{startDate:this.I18n.t("js.label_no_start_date"),dueDate:this.I18n.t("js.label_no_due_date")}}}render(u,r){u.innerHTML="";const n=this.createDateDisplayField("startDate"),h=this.createDateDisplayField("dueDate"),a=document.createElement("span");a.textContent=" - ",u.appendChild(n),u.appendChild(a),u.appendChild(h)}createDateDisplayField(u){const r=document.createElement("span"),n=new i.C(u,this.context),h=this.resource[u]?this.timezoneService.formattedDate(this.resource[u]):this.text.placeholder[u];return n.apply(this.resource,this.schema),n.render(r,h),r}}},63733:(H,D,t)=>{"use strict";t.d(D,{C:()=>h});var i=t(3786),e=t(50076),c=t(69671),u=t(29161),r=t(20979),n=t(70692);class h extends c.z{render(p,l){if(super.render(p,l),this.showSchedulingMode()){const d=document.createElement("span");d.classList.add("icon-context"),this.resource.scheduleManually&&d.classList.add("icon-pin"),p.prepend(d)}if(this.shouldHighlight&&this.canOverdue){const d=this.timezoneService.daysFromToday(this.value);this.apiV3Service.statuses.id(this.resource.status.id).get().toPromise().then(g=>{g.isClosed||p.classList.add(e.Z.overdueDate(d))})}}get canOverdue(){return-1!==["dueDate","date"].indexOf(this.name)}get valueString(){return this.value?this.timezoneService.formattedDate(this.value):""}showSchedulingMode(){return"startDate"===this.name||"date"===this.name}}(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",n.B)],h.prototype,"timezoneService",void 0),(0,i.gn)([(0,u.W)(),(0,i.w6)("design:type",r.T)],h.prototype,"apiV3Service",void 0)},69671:(H,D,t)=>{"use strict";t.d(D,{z:()=>r});var i=t(3786),e=t(55741),c=t(84897),u=t(29161);class r extends e.C{get highlightName(){return"date"===this.name?"dueDate":this.name}get shouldHighlight(){if(!1===this.context.options.colorize)return!1;const h=!!this.viewHighlighting&&this.viewHighlighting.shouldHighlightInline(this.highlightName);return"table"!==this.context.container||h}}(0,i.gn)([(0,u.W)(c.B,null),(0,i.w6)("design:type",c.B)],r.prototype,"viewHighlighting",void 0)},39469:(H,D,t)=>{"use strict";t.d(D,{N:()=>e});var i=t(55741);class e extends i.C{get value(){return this.schema?this.resource[this.name]||0:null}get percentLabel(){return`${this.roundedProgress}%`}get roundedProgress(){return Math.round(Number(this.value))||0}render(u,r){u.setAttribute("title",r),u.innerHTML=`\n      <span>\n        <span style="width: 80px" class="progress-bar">\n          <span style="width: ${this.roundedProgress}%" class="inner-progress closed"></span>\n          <span style="width: 0%" class="inner-progress done"></span>\n        </span>\n        <span class="progress-bar-legend">${this.percentLabel}</span>\n      </span>\n    `}}},79644:(H,D,t)=>{"use strict";t.d(D,{L:()=>e});var i=t(55741);class e extends i.C{isEmpty(){return _.isEmpty(this.value)}get value(){const u=this.resource[this.name];return this.schema&&u?u.elements?u.elements.map(r=>r.name):u.map?u.map(r=>r.name):u.name?[u.name]:[`error: ${JSON.stringify(u)}`]:[]}render(u,r){const n=this.value;u.innerHTML="",u.setAttribute("title",n.join(", ")),0===n.length?this.renderEmpty(u):this.renderValues(n,u)}renderValues(u,r){const n=document.createDocumentFragment(),h=this.optionDiv(this.valueAbridged(u));if(n.appendChild(h),u.length>2){const a=this.optionDiv(u.length.toString(),"badge","-secondary");n.appendChild(a)}r.appendChild(n)}optionDiv(u,...r){const n=document.createElement("div"),h=document.createElement("span");return n.classList.add(i.x),h.classList.add(...r),h.textContent=u,n.appendChild(h),n}valueAbridged(u){const r=_.take(u,2);return u.length>2&&r.push("... "),r.join(", ")}}},18322:(H,D,t)=>{"use strict";t.d(D,{Dz:()=>n,uS:()=>h,Nm:()=>a,sS:()=>d,su:()=>g});var i=t(2316),c=(t(86029),t(96617)),u=t(82635);t(94232);const n=new i.OlP("editing-portal--schema"),h=new i.OlP("editing-portal--handler"),a=new i.OlP("editing-portal--changeset"),d="-editing";class g extends u.g{constructor(y,m,E,P,w,x,k){super(),this.I18n=y,this.elementRef=m,this.change=E,this.schema=P,this.handler=w,this.cdRef=x,this.injector=k,this.self=this,this.updateFromChangeset(E),this.change.state&&this.change.state.values$().pipe(this.untilDestroyed()).subscribe(b=>{if(!b.schema.ofProperty(this.name))return w.deactivate(!1);this.updateFromChangeset(b),this.initialize(),this.cdRef.markForCheck()})}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.initialize()}get overflowingSelector(){return this.$element?this.$element.closest(".__overflowing_element_container").data("overflowingIdentifier"):null}get inFlight(){return this.handler.inFlight}get value(){return this.resource[this.name]}set value(y){this.resource[this.name]=this.parseValue(y)}get placeholder(){return"subject"===this.name?this.I18n.t("js.placeholders.subject"):""}initialize(){}updateFromChangeset(y){this.change=y,this.resource=this.change.projectedResource,this.schema=this.change.schema.ofProperty(this.handler.fieldName)||this.schema,this.name=this.change.schema.mappedName(this.handler.fieldName)}parseValue(y){return y}}g.\u0275fac=function(y){return new(y||g)(i.Y36(c.D),i.Y36(i.SBq),i.Y36(a),i.Y36(n),i.Y36(h),i.Y36(i.sBO),i.Y36(i.zs3))},g.\u0275dir=i.lG2({type:g,features:[i.qOj]})},84568:(H,D,t)=>{"use strict";t.d(D,{h:()=>c});var i=t(39478),e=t(2316);class c extends i.h{}c.\u0275fac=function(){let u;return function(n){return(u||(u=e.n5z(c)))(n||c)}}(),c.\u0275prov=e.Yz7({token:c,factory:c.\u0275fac,providedIn:"root"})},58034:(H,D,t)=>{"use strict";t.d(D,{a:()=>e});var i=t(2316);class e{blockedTransition(u){return!0}}e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac})},61342:(H,D,t)=>{"use strict";t.d(D,{n:()=>E});var i=t(3786),e=t(2316),c=t(47775),u=t(12877),r=t(14808),n=t(9170),h=t(53466),a=t(33927),p=t(96617),l=t(91260),g=(t(80044),t(37048)),C=t(58034);class y{constructor(w){this.i18nService=w,this.activeForms=new Map,window.addEventListener("beforeunload",x=>{this.thereAreFormsWithUnsavedChanges&&(x.preventDefault(),x.returnValue=this.i18nService.t("js.work_packages.confirm_edit_cancel"))})}get thereAreFormsWithUnsavedChanges(){return Array.from(this.activeForms.keys()).some(w=>!w.change.isEmpty())}addToActiveForms(w){this.activeForms.set(w,!0)}removeFromActiveForms(w){this.activeForms.delete(w)}}y.\u0275fac=function(w){return new(w||y)(e.LFG(p.D))},y.\u0275prov=e.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"});class E extends l.Py{constructor(w,x,k,b,v,M,S,O,A){super(w),this.injector=w,this.elementRef=x,this.$transitions=k,this.ConfigurationService=b,this.editingPortalService=v,this.$state=M,this.I18n=S,this.editFormRouting=O,this.globalEditFormChangesTrackerService=A,this.initializeEditMode=!1,this.skippedFields=[],this.onSavedEmitter=new e.vpe,this.fields={},this.registeredFields=(0,r.qH)();const F=S.t("js.work_packages.confirm_edit_cancel"),I=b.warnOnLeavingUnsaved();this.unregisterListener=k.onBefore({},J=>{if(this.editing){if(!this.editFormRouting||this.editFormRouting.blockedTransition(J)){if(I&&!window.confirm(F))return!1;this.cancel(!1)}return!0}})}ngOnInit(){this.editMode=this.initializeEditMode,this.globalEditFormChangesTrackerService.addToActiveForms(this),this.initializeEditMode&&this.start()}ngOnDestroy(){this.unregisterListener(),this.globalEditFormChangesTrackerService.removeFromActiveForms(this)}activateField(w,x,k,b){return(0,i.mG)(this,void 0,void 0,function*(){return this.waitForField(k).then(v=>{v.setActive(!0);const M=v.editContainer.nativeElement;return this.editingPortalService.create(M,this.injector,w,x,k,b)})})}reset(w,x=!1){return(0,i.mG)(this,void 0,void 0,function*(){const k=yield this.waitForField(w);k.reset(),k.deactivate(x)})}onSaved(w){this.cancel(!1),this.onSavedEmitter.emit({savedResource:w.resource,isInitial:w.wasNew})}cancel(w=!1){this.editMode=!1,this.closeEditFields("all",w),w&&this.halEditing.reset(this.change)}requireVisible(w){return new Promise((x,k)=>{const b=setInterval(()=>{void 0!==this.fields[w]&&(clearInterval(b),x())},50)})}get editing(){return this.editMode||this.hasActiveFields()}register(w){this.fields[w.fieldName]=w,this.registeredFields.putValue(_.keys(this.fields)),(this.editMode&&!this.skipField(w)||this.activeFields[w.fieldName])&&w.activateOnForm(!0)}waitForField(w){return this.registeredFields.values$().pipe((0,n.h)(x=>x.indexOf(w)>=0),(0,h.q)(1),(0,a.U)(()=>this.fields[w])).toPromise()}start(){_.each(this.fields,w=>this.activate(w.fieldName))}focusOnFirstError(){jQuery(this.elementRef.nativeElement).find(`.${l.fA}.-error .${l.as}`).first().trigger("focus")}skipField(w){const{fieldName:x}=w;if(-1===this.skippedFields.indexOf(x))return!1;const b=this.resource[x],v=this.change.changes[x];return b&&!v}}E.\u0275fac=function(w){return new(w||E)(e.Y36(e.zs3),e.Y36(e.SBq),e.Y36(c.TransitionService),e.Y36(u.e),e.Y36(g.b),e.Y36(c.StateService),e.Y36(p.D),e.Y36(C.a,8),e.Y36(y))},E.\u0275cmp=e.Xpm({type:E,selectors:[["edit-form"],["","edit-form",""]],inputs:{resource:"resource",initializeEditMode:["inEditMode","initializeEditMode"],skippedFields:"skippedFields"},outputs:{onSavedEmitter:"onSaved"},features:[e.qOj],ngContentSelectors:["*"],decls:1,vars:0,template:function(w,x){1&w&&(e.F$t(),e.Hsn(0))},encapsulation:2})},91260:(H,D,t)=>{"use strict";t.d(D,{fA:()=>p,as:()=>l,Py:()=>d});var i=t(3786),e=t(87853),c=t(12703),u=t(1403),r=t(29161),n=t(67727),h=t(84699),a=t(8849);const p="inline-edit--active-field",l="inline-edit--field";class d{constructor(C){this.injector=C,this.activeFields={},this.errorsPerAttribute={},this.editMode=!1}onSaved(C){}hasActiveFields(){return!_.isEmpty(this.activeFields)}get change(){return this.halEditing.changeFor(this.resource)}activate(C,y=!1){return this.loadFieldSchema(C,y).then(m=>m.writable||y?this.renderField(C,m):(this.halNotification.showEditingBlockedError(m.name||C),Promise.reject()))}activateWhenNeeded(C){return this.activeFields[C]?Promise.resolve():this.requireVisible(C).then(()=>this.activate(C,!0))}activateMissingFields(){this.change.getForm().then(C=>{_.each(C.validationErrors,(y,m)=>{"id"!==m&&this.activateWhenNeeded(m)})})}submit(){return(0,i.mG)(this,void 0,void 0,function*(){if(this.change.isEmpty()&&!(0,h.Z)(this.resource))return this.closeEditFields(),Promise.resolve(this.resource);this.change.inFlight=!0,this.errorsPerAttribute={};const C=_.keys(this.activeFields);return yield Promise.all(_.map(this.activeFields,y=>y.onSubmit())),new Promise((y,m)=>{this.halEditing.save(this.change).then(E=>{this.closeEditFields(C),y(E.resource),this.halNotification.showSave(E.resource,E.wasNew),this.editMode=!1,this.onSaved(E),this.change.inFlight=!1}).catch(E=>(this.halNotification.handleRawError(E,this.resource),E instanceof a.o&&E.resource&&(this.handleSubmissionErrors(E.resource),m()),this.change.inFlight=!1,Promise.reject(E)))})})}closeEditFields(C="all",y=!0){"all"===C&&(C=_.keys(this.activeFields)),C.forEach(m=>{const E=this.activeFields[m];E&&E.deactivate(!1),y&&this.change.reset(m)})}handleSubmissionErrors(C){this.handleErroneousAttributes(C)}handleErroneousAttributes(C){const y=C.getInvolvedAttributes();this.errorsPerAttribute=C.getMessagesPerAttribute(),0!==y.length&&this.setErrorsForFields(y)}setErrorsForFields(C){const y=C.map(m=>this.requireVisible(m).then(()=>(this.activeFields[m]&&this.activeFields[m].setErrors(this.errorsPerAttribute[m]||[]),this.activateWhenNeeded(m))));Promise.all(y).then(()=>{setTimeout(()=>this.focusOnFirstError())}).catch(()=>{console.error("Failed to activate all erroneous fields.")})}loadFieldSchema(C,y=!1){return new Promise((m,E)=>{this.loadFormAndCheck(C,y);const P=this.change.schema.ofProperty(C);if(!P)throw new Error;m(P)})}loadFormAndCheck(C,y=!1){this.change.getForm().then(()=>{const m=this.change.schema.ofProperty(C);!m.writable&&!y&&(this.halNotification.showEditingBlockedError(m.name||C),this.closeEditFields([C]))}).catch(m=>{console.error("Failed to build edit field: %o",m),this.halNotification.handleRawError(m,this.resource),this.closeEditFields([C])})}renderField(C,y){return this.activateField(this,y,C,this.errorsPerAttribute[C]||[]).then(E=>(this.activeFields[C]=E,E)).catch(E=>{console.error(`Failed to render edit field:${E}`),this.halNotification.handleRawError(E)})}}(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",e.G)],d.prototype,"states",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",c.l)],d.prototype,"halEditing",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",n.W)],d.prototype,"halNotification",void 0),(0,i.gn)([(0,r.W)(),(0,i.w6)("design:type",u.J)],d.prototype,"halEvents",void 0)},86029:(H,D,t)=>{"use strict";t.d(D,{k:()=>c});var i=t(79441),e=t(26942);class c extends e.N{constructor(){super(...arguments),this.onDestroy=new i.xQ,this._onSubmitHandlers=[],this._onBeforeSubmitHandlers=[]}errorMessageOnLabel(){}onSubmit(){return Promise.all(this._onSubmitHandlers.map(r=>r()))}registerOnSubmit(r){this._onSubmitHandlers.push(r)}onBeforeSubmit(){return this._onBeforeSubmitHandlers.map(r=>r())}registerOnBeforeSubmit(r){this._onBeforeSubmitHandlers.push(r)}previewContext(r){}}},92058:(H,D,t)=>{"use strict";t.d(D,{m:()=>C});var i=t(2316),c=(t(86029),t(18322)),u=t(50945),r=t(84568),h=(t(94232),t(54364)),a=t(1707),p=t(32853);function l(y,m){1&y&&i.GkF(0)}const d=function(y){return{"-error":y}};function g(y,m){if(1&y){const E=i.EpF();i.TgZ(0,"div",1),i.TgZ(1,"form",2),i.NdJ("submit",function(){return i.CHM(E),i.oxw().handler.handleUserSubmit()}),i.TgZ(2,"label",3),i._uU(3),i.qZA(),i.YNc(4,l,1,0,"ng-container",4),i.qZA(),i.qZA()}if(2&y){const E=i.oxw();i.Gre("inline-edit--active-field inplace-edit ",E.handler.fieldName,""),i.Q6J("ngClass",i.VKq(9,d,E.handler.isErrorenous)),i.xp6(2),i.Q6J("for",E.handler.htmlId),i.xp6(1),i.AsE(" ",E.handler.fieldLabel," ",E.handler.errorMessageOnLabel()," "),i.xp6(1),i.Q6J("ngComponentOutlet",E.componentClass)("ngComponentOutletInjector",E.fieldInjector)}}class C{constructor(m,E,P){this.injector=m,this.editField=E,this.elementRef=P,this.onEditFieldReady=new i.vpe}ngOnInit(){this.editFieldHandler&&this.schemaInput?(this.handler=this.editFieldHandler,this.schema=this.schemaInput,this.change=this.changeInput):(this.handler=this.injector.get(c.uS),this.schema=this.injector.get(c.Dz),this.change=this.injector.get(c.Nm)),this.componentClass=this.editField.getSpecificClassFor(this.change.pristineResource._type,this.handler.fieldName,this.schema.type),this.fieldInjector=(0,u.E)(this.injector,this.change,this.handler,this.schema)}ngOnDestroy(){this.onEditFieldReady.complete()}ngAfterViewInit(){setTimeout(()=>{this.onEditFieldReady.emit()})}}C.\u0275fac=function(m){return new(m||C)(i.Y36(i.zs3),i.Y36(r.h),i.Y36(i.SBq))},C.\u0275cmp=i.Xpm({type:C,selectors:[["edit-form-portal"]],inputs:{schemaInput:"schemaInput",changeInput:"changeInput",editFieldHandler:"editFieldHandler"},outputs:{onEditFieldReady:"onEditFieldReady"},decls:1,vars:1,consts:[[3,"class","ngClass",4,"ngIf"],[3,"ngClass"],["role","form","tabindex","-1",3,"submit"],[1,"hidden-for-sighted",3,"for"],[4,"ngComponentOutlet","ngComponentOutletInjector"]],template:function(m,E){1&m&&i.YNc(0,g,5,11,"div",0),2&m&&i.Q6J("ngIf",E.handler)},directives:[h.O5,h.mk,a._Y,a.JL,a.F,h.$G,p.dw],encapsulation:2})},50945:(H,D,t)=>{"use strict";t.d(D,{E:()=>c});var i=t(18322),e=t(40912);function c(u,r,n,h){const a=new WeakMap;return a.set(i.Nm,r),a.set(i.uS,n),a.set(i.Dz,h),new e.nK(u,a)}},37048:(H,D,t)=>{"use strict";t.d(D,{b:()=>w});var i=t(40912),e=t(92058),c=t(50945),u=t(53466),r=t(70233),n=t(3786),h=t(33406),a=t(96617),p=t(12877),l=t(7101),d=t(86029),g=t(88837),C=t(3352),y=t(79441),m=t(29161);class E extends d.k{constructor(k,b,v,M,S,O,A){super(),this.injector=k,this.form=b,this.fieldName=v,this.schema=M,this.element=S,this.pathHelper=O,this.withErrors=A,this.$onUserActivate=new y.xQ,void 0!==A&&this.setErrors(A),this.htmlId=`wp-${this.resource.id}-inline-edit--field-${this.fieldName}`,this.fieldLabel=this.schema.name||this.fieldName}stopPropagation(k){return k.stopPropagation(),!1}get inEditMode(){return this.form.editMode}get inFlight(){return this.form.change.inFlight}focus(k){const b=this.element.querySelector(".inline-edit--field");b?(b.focus(),k&&"INPUT"===b.tagName&&(0,g.w)(b,k)):(0,C.qu)(`Tried to focus on ${this.fieldName}, but element does not (yet) exist.`)}onFocusOut(){this.resource.subject&&this.withErrors&&0===this.withErrors.length&&this.handleUserSubmit()}setErrors(k){this.errors=k,this.element.classList.toggle("-error",this.isErrorenous)}handleUserSubmit(){return this.onBeforeSubmit(),this.inFlight||this.form.editMode?Promise.resolve():this.onSubmit().then(()=>this.form.submit())}handleUserKeydown(k,b=!1){return this.inEditMode&&!b?k.which!==h.m.ENTER||(this.form.submit(),!1):k.which!==h.m.ESCAPE||(this.handleUserCancel(),!1)}handleUserCancel(){this.reset()}reset(){this.form.change.reset(this.fieldName),this.deactivate(!0)}deactivate(k=!1){delete this.form.activeFields[this.fieldName],this.onDestroy.next(),this.onDestroy.complete(),this.form.reset(this.fieldName,k)}get isErrorenous(){return this.errors.length>0}isChanged(){return this.form.change.contains(this.fieldName)}get resource(){return this.form.resource}get project(){return this.form.change.projectedResource.project}errorMessageOnLabel(){return this.isErrorenous?this.I18n.t("js.inplace.errors.messages_on_field",{messages:this.errors.join(" ")}):""}previewContext(k){return k.previewPath()}}(0,n.gn)([(0,m.W)(),(0,n.w6)("design:type",l.i)],E.prototype,"FocusHelper",void 0),(0,n.gn)([(0,m.W)(),(0,n.w6)("design:type",p.e)],E.prototype,"ConfigurationService",void 0),(0,n.gn)([(0,m.W)(),(0,n.w6)("design:type",a.D)],E.prototype,"I18n",void 0);var P=t(2316);class w{constructor(k,b,v){this.appRef=k,this.componentFactoryResolver=b,this.pathHelper=v}create(k,b,v,M,S,O){const A=this.createDomOutlet(k,b),F=new E(b,v,S,M,k,this.pathHelper,O);F.onDestroy.pipe((0,u.q)(1)).subscribe(()=>A.detach());const I=(0,c.E)(b,v.change,F,M),J=new i.C5(e.m,null,I);return k.innerHTML="",A.attachComponentPortal(J).instance.onEditFieldReady.pipe((0,u.q)(1)).toPromise().then(()=>F)}createDomOutlet(k,b){return new i.u0(k,this.componentFactoryResolver,this.appRef,b)}}w.\u0275fac=function(k){return new(k||w)(P.LFG(P.z2F),P.LFG(P._Vd),P.LFG(r.j))},w.\u0275prov=P.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"})},82140:(H,D,t)=>{"use strict";t.d(D,{e:()=>u});var i=t(2316),c=(t(18322),t(2775));class u{constructor(){this.onSave=new i.vpe,this.onCancel=new i.vpe}save(){this.onSave.emit()}cancel(){this.onCancel.emit()}}u.\u0275fac=function(n){return new(n||u)},u.\u0275cmp=i.Xpm({type:u,selectors:[["edit-field-controls"]],inputs:{cancelTitle:"cancelTitle",saveTitle:"saveTitle",field:["fieldController","field"]},outputs:{onSave:"onSave",onCancel:"onCancel"},decls:6,vars:5,consts:[[1,"inplace-edit--dashboard"],[1,"inplace-edit--controls"],["type","button",1,"inplace-edit--control","inplace-edit--control--save",3,"disabled","title","click"],["icon-classes","icon-checkmark icon-no-color",3,"icon-title"],["type","button",1,"inplace-edit--control","inplace-edit--control--cancel",3,"title","click"],["icon-classes","icon-close icon-no-color",3,"icon-title"]],template:function(n,h){1&n&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"button",2),i.NdJ("click",function(){return h.save()}),i._UZ(3,"op-icon",3),i.qZA(),i.TgZ(4,"button",4),i.NdJ("click",function(){return h.cancel()}),i._UZ(5,"op-icon",5),i.qZA(),i.qZA(),i.qZA()),2&n&&(i.xp6(2),i.Q6J("disabled",h.field.required&&h.field.isEmpty()||void 0)("title",h.saveTitle),i.xp6(1),i.Q6J("icon-title",h.saveTitle),i.xp6(1),i.Q6J("title",h.cancelTitle),i.xp6(1),i.Q6J("icon-title",h.cancelTitle))},directives:[c.o],encapsulation:2})},45755:(H,D,t)=>{"use strict";t.d(D,{i:()=>u});var i=t(54364),e=t(21757),c=t(2316);class u{}u.\u0275fac=function(n){return new(n||u)},u.\u0275mod=c.oAB({type:u}),u.\u0275inj=c.cJS({imports:[[i.ez,e.H]]})},76315:(H,D,t)=>{"use strict";t.d(D,{s:()=>r});var i=t(54364),e=t(97779),c=t(45755),u=t(2316);class r{}r.\u0275fac=function(h){return new(h||r)},r.\u0275mod=u.oAB({type:r}),r.\u0275inj=u.cJS({imports:[[i.ez,e.$,c.i]]})},54262:(H,D,t)=>{"use strict";t.d(D,{k:()=>x});var i=t(12703),e=t(12877),c=t(20342),u=t(96617),r=t(88837),n=t(61342),a=(t(80044),t(26942)),p=t(44022),l=t(7812),d=t(87853),g=t(3352);var y=t(2316),m=t(54364);const E=["displayContainer"],P=["editContainer"],w=function(k,b,v,M){return[k,b,v,M]};class x extends a.N{constructor(b,v,M,S,O,A,F,I,J,N){super(),this.states=b,this.injector=v,this.elementRef=M,this.ConfigurationService=S,this.opContextMenu=O,this.halEditing=A,this.schemaCache=F,this.editForm=I,this.cdRef=J,this.I18n=N,this.displayFieldOptions={},this.isDropTarget=!1,this.editFieldContainerClass=l.zZ,this.active=!1,this.destroyed=!1}setActive(b=!0){this.active=b,this.componentDestroyed||this.cdRef.detectChanges()}ngOnInit(){var b;this.fieldRenderer=new l.uA(this.injector,"single-view",this.displayFieldOptions),this.$element=jQuery(this.elementRef.nativeElement),null===(b=this.editForm)||void 0===b||b.register(this),this.halEditing.temporaryEditResource(this.resource).values$().pipe(this.untilDestroyed()).subscribe(v=>{this.resource=v,this.render()})}startDragOverActivation(b){return!(this.isDropTarget&&this.isEditable&&!this.active)||(this.handleUserActivate(null),b.preventDefault(),!1)}render(){const b=this.fieldRenderer.render(this.resource,this.fieldName,null,this.displayPlaceholder);this.displayContainer.nativeElement.innerHTML="",this.displayContainer.nativeElement.appendChild(b)}deactivate(b=!1){this.editContainer.nativeElement.innerHTML="",this.editContainer.nativeElement.hidden=!0,this.setActive(!1),b&&setTimeout(()=>this.$element.find(`.${l.OZ}`).focus(),20)}get isEditable(){return this.editForm&&this.schema.isAttributeEditable(this.fieldName)}activateIfEditable(b){return function(k){try{const b=window.getSelection(),v=b.toString().length>0,M=k.contains(b.anchorNode);return v&&M}catch(b){return console.error("Failed to test whether in selection ",b),!1}}(b.target)?((0,g.qu)(`Not activating ${this.fieldName} because of active selection within`),!0):jQuery(b.target).closest("a,macro",this.displayContainer.nativeElement).length>0||(this.isEditable&&this.handleUserActivate(b),this.opContextMenu.close(),b.preventDefault(),b.stopImmediatePropagation(),!1)}activateOnForm(b=!1){return this.setActive(!0),this.editForm.activate(this.fieldName,b).catch(()=>this.deactivate(!0))}handleUserActivate(b){let v=0;return"click"===(null==b?void 0:b.type)&&(v=(0,r.b)(b)),this.activateOnForm().then(M=>{!M||(M.$onUserActivate.next(),M.focus(v))}),!1}reset(){this.render(),this.deactivate()}get schema(){return this.halEditing.typedState(this.resource).hasValue()?this.halEditing.typedState(this.resource).value.schema:this.schemaCache.of(this.resource)}}x.\u0275fac=function(b){return new(b||x)(y.Y36(d.G),y.Y36(y.zs3),y.Y36(y.SBq),y.Y36(e.e),y.Y36(c.$),y.Y36(i.l),y.Y36(p.y),y.Y36(n.n,8),y.Y36(y.sBO),y.Y36(u.D))},x.\u0275cmp=y.Xpm({type:x,selectors:[["editable-attribute-field"]],viewQuery:function(b,v){if(1&b&&(y.Gf(E,7),y.Gf(P,7)),2&b){let M;y.iGM(M=y.CRH())&&(v.displayContainer=M.first),y.iGM(M=y.CRH())&&(v.editContainer=M.first)}},inputs:{fieldName:"fieldName",resource:"resource",wrapperClasses:"wrapperClasses",displayFieldOptions:"displayFieldOptions",displayPlaceholder:"displayPlaceholder",isDropTarget:"isDropTarget"},features:[y.qOj],decls:5,vars:8,consts:[[3,"ngClass","dragover"],[3,"hidden"],["editContainer",""],["tabindex","-1",3,"hidden","click","keydown.enter"],["displayContainer",""]],template:function(b,v){1&b&&(y.TgZ(0,"div",0),y.NdJ("dragover",function(S){return v.startDragOverActivation(S)}),y._UZ(1,"div",1,2),y.TgZ(3,"div",3,4),y.NdJ("click",function(S){return v.activateIfEditable(S)})("keydown.enter",function(S){return v.activateIfEditable(S)}),y.qZA(),y.qZA()),2&b&&(y.Q6J("ngClass",y.l5B(3,w,v.editFieldContainerClass,v.fieldName,v.active?"-active":"",v.wrapperClasses||"-small")),y.xp6(1),y.Q6J("hidden",!v.active),y.xp6(2),y.Q6J("hidden",v.active))},directives:[m.mk],encapsulation:2,changeDetection:0})},12703:(H,D,t)=>{"use strict";t.d(D,{l:()=>y});var i=t(3786),e=t(14808),c=t(9170),u=t(33927),r=t(79441),n=t(94232),h=t(53448),a=t(1403),p=t(79175),l=t(84699),d=t(2316);class g extends e.Ui{constructor(){super(),this.name="Changesets",this.changesets=(0,e.r9)(),this.initializeMembers()}}class C{constructor(E,P){this.wasNew=!1,this.id=P.id.toString(),this.wasNew=(0,l.Z)(E.pristineResource),this.resource=P,this.changes=E.changeMap}}class y extends p.r{constructor(E,P,w){super((new g).changesets),this.injector=E,this.halEvents=P,this.hook=w,this.committedChanges=new r.xQ}save(E){return(0,i.mG)(this,void 0,void 0,function*(){const P=yield E.buildRequestPayload(),w=yield E.pristineResource.$links.updateImmediately(P);return w.retainFrom(E.pristineResource),yield this.onSaved(w),this.complete(E,w)})}complete(E,P){const w=new C(E,P);this.committedChanges.next(w),this.reset(E);const x=w.wasNew?"created":"updated";return this.halEvents.push(w.resource,{eventType:x,commit:w}),w}reset(E){E.clear(),this.clearSome(E.href)}typedState(E){return this.multiState.get(E.href)}edit(E,P){const w=this.multiState.get(E.href),x=this.newChangeset(E,w,P);return w.putValue(x),x}newChangeset(E,P,w){return new(this.hook.call("halResourceChangesetClass",E).pop()||n.W)(E,P,w)}changeFor(E){const P=this.multiState.get(E.href);let w=E;E.state&&(w=E.state.getValueOr(E));const x=P.value;return x&&!x.isEmpty()?x:x?w.hasOwnProperty("lockVersion")&&x.pristineResource.lockVersion<w.lockVersion?this.edit(w):(x.updatePristineResource(w),x):this.edit(w)}temporaryEditResource(E){const P=(0,e.$e)(E.state,this.typedState(E));return(0,e.eS)(P,w=>w.pipe((0,c.h)(([x,k])=>!!x),(0,u.U)(([x,k])=>k?(k.updatePristineResource(x),k.projectedResource):x)))}stopEditing(E){this.multiState.get(E.href).clear()}onSaved(E){return E.state?E.push(E):Promise.resolve()}}y.\u0275fac=function(E){return new(E||y)(d.LFG(d.zs3),d.LFG(a.J),d.LFG(h.$))},y.\u0275prov=d.Yz7({token:y,factory:y.\u0275fac})},82635:(H,D,t)=>{"use strict";t.d(D,{g:()=>e});var i=t(26942);class e extends i.N{get displayName(){return this.schema.name||this.name}get value(){return this.resource[this.name]}get type(){return this.constructor.type}get required(){return!!this.schema.required}get writable(){return this.schema.writable&&!1!==this.context.options.writable}get hasDefault(){return this.schema.hasDefault}get options(){return this.schema.options}isEmpty(){return void 0===this.value||null===this.value||""===this.value}get unknownAttribute(){return this.isEmpty()&&!this.schema}}},39478:(H,D,t)=>{"use strict";t.d(D,{h:()=>i});class i{constructor(){this.fields={},this.classes={}}fieldType(c){return this.fields[c]}getClassFor(c,u="unknown"){const r=this.fieldType(c)||this.fieldType(u)||this.defaultFieldType;return this.classes[r]}getSpecificClassFor(c,u,r="unknown"){const n=this.fieldType(`${c}-${u}`)||this.fieldType(`${c}-${r}`);return n?this.classes[n]:this.getClassFor(u,r)}addFieldType(c,u,r){return c.fieldType=u,this.register(c,r),this}addSpecificFieldType(c,u,r,n){return u.fieldType=`${c}-${r}`,n=n.map(h=>`${c}-${h}`),this.register(u,n),this}extendFieldType(c,u){const r=this.classes[c]||this.getClassFor(c);return this.addFieldType(r,c,u)}register(c,u=[]){const r=c.fieldType;u.forEach(n=>this.fields[n]=r),this.classes[r]=c}}},63419:(H,D,t)=>{"use strict";function i(u){return`-${(u=c(u)).replace("_","-")}`}function e(u,r){return u=c(u),r.t(`js.grid.widgets.project_status.${u.replace("-","_")}`)}function c(u){return u||"not-set"}t.d(D,{p:()=>i,v:()=>e})},65084:(H,D,t)=>{"use strict";t.d(D,{E:()=>ai});var i=t(2316),e=t(54364),c=t(55811),u=t(97779),r=t(31283),n=t(21757),h=t(71858),a=t(84568),p=t(60874),l=t(18322),d=t(1707),g=t(84312);class C extends l.su{constructor(){super(...arguments),this.shouldFocus="subject"===this.name}}C.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(C)))(U||C)}}(),C.\u0275cmp=i.Xpm({type:C,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:6,consts:[["type","text",1,"inline-edit--field","op-input",3,"opAutofocus","disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(Q,U){1&Q&&(i.TgZ(0,"input",0),i.NdJ("ngModelChange",function(X){return U.value=X})("keydown",function(X){return U.handler.handleUserKeydown(X)})("focusout",function(){return U.handler.onFocusOut()}),i.qZA()),2&Q&&(i.Q6J("opAutofocus",U.shouldFocus)("disabled",U.inFlight)("ngModel",U.value)("id",U.handler.htmlId),i.uIk("aria-required",U.required)("required",U.required))},directives:[d.Fj,g.U,d.Q7,d.JJ,d.On],encapsulation:2});class y extends l.su{constructor(){super(...arguments),this.locale=I18n.locale}}y.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(y)))(U||y)}}(),y.\u0275cmp=i.Xpm({type:y,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:6,consts:[["type","number",1,"inline-edit--field","op-input",3,"disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(Q,U){1&Q&&(i.TgZ(0,"input",0),i.NdJ("ngModelChange",function(X){return U.value=X})("keydown",function(X){return U.handler.handleUserKeydown(X)})("focusout",function(){return U.handler.onFocusOut()}),i.qZA()),2&Q&&(i.Q6J("disabled",U.inFlight)("ngModel",U.value)("id",U.handler.htmlId),i.uIk("aria-required",U.required)("required",U.required)("lang",U.locale))},directives:[d.wV,d.Fj,d.Q7,d.JJ,d.On],encapsulation:2});var m=t(3786),E=t(2281),P=t(29161),w=t(70692);class x extends l.su{parser(Q,U){return null==Q&&!U.validity.valid&&(Q=this.value||0),E.duration(Q,"hours")}formatter(Q){return Number(E.duration(Q).asHours().toFixed(2))}parseValue(Q){if(null===Q)return Q;let U;return U=Q.isValid()?Q.toISOString():null,U}}x.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(x)))(U||x)}}(),x.\u0275cmp=i.Xpm({type:x,selectors:[["ng-component"]],features:[i.qOj],decls:2,vars:5,consts:[["type","number","step","0.01",1,"inline-edit--field","op-input",3,"ngModel","disabled","id","ngModelChange","keydown"],["input",""]],template:function(Q,U){if(1&Q){const we=i.EpF();i.TgZ(0,"input",0,1),i.NdJ("ngModelChange",function(z){i.CHM(we);const V=i.MAs(1);return U.value=U.parser(z,V)})("keydown",function(z){return U.handler.handleUserKeydown(z)}),i.qZA()}2&Q&&(i.Q6J("ngModel",U.formatter(U.value))("disabled",U.inFlight)("id",U.handler.htmlId),i.uIk("aria-required",U.required)("required",U.required))},directives:[d.wV,d.Fj,d.JJ,d.On,d.Q7],encapsulation:2}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",w.B)],x.prototype,"TimezoneService",void 0);class k{constructor(){this._fields=[]}register(Q,U){this._fields.push({attribute:U,component:Q})}getAutocompleterOfAttribute(Q){const U=_.find(this._fields,we=>we.attribute===Q);return U?U.component:void 0}}k.\u0275fac=function(Q){return new(Q||k)},k.\u0275prov=i.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"});var b=t(30400),v=t(33927),M=t(98636),S=t(66220),O=t(61342),A=t(47775),F=t(67727),I=t(29092),J=t(32853);const N=function(Te,Q,U,we,X,z,V,Qe,Ke){return{availableValues:Te,appendTo:Q,model:U,required:we,disabled:X,id:z,finishedLoading:!0,classes:V,resource:Qe,showAddNewButton:Ke}};class te extends l.su{constructor(){super(...arguments),this.appendTo=null,this.referenceOutputs={onCreate:Q=>this.onCreate(Q),onChange:Q=>this.onChange(Q),onAddNew:Q=>this.onNewValueAdded(Q),onKeydown:Q=>this.handler.handleUserKeydown(Q,!0),onOpen:()=>this.onOpen(),onClose:()=>this.onClose(),onAfterViewInit:Q=>this._autocompleterComponent=Q},this.valuesLoaded=!1,this.hiddenOverflowContainer=".__hidden_overflow_container"}get selectedOption(){const Q=this.value?this.value.href:null;return _.find(this.availableOptions,U=>U.href===Q)}set selectedOption(Q){const U=_.find(this.availableOptions,we=>we.href===Q.href);U&&""===U.href&&(U.href=null),this.value=U||Q}ngOnInit(){var Q;super.ngOnInit(),this.appendTo=this.overflowingSelector,this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.valuesLoadingPromise.then(()=>{this._autocompleterComponent.openDirectly=!0})}),this._syncUrlParamsOnChangeIfNeeded(this.handler.fieldName,null===(Q=this.editFormComponent)||void 0===Q?void 0:Q.editMode)}initialize(){this.text={requiredPlaceholder:this.I18n.t("js.placeholders.selection"),placeholder:this.I18n.t("js.placeholders.default")},this.valuesLoadingPromise=this.change.getForm().then(()=>this.initialValueLoading()),this.initializeShowAddButton()}initializeShowAddButton(){this.showAddNewButton="User"===this.schema.type}initialValueLoading(){return this.valuesLoaded=!1,this.loadValues().toPromise()}autocompleterComponent(){const{type:Q}=this.schema;return this.selectAutocompleterRegister.getAutocompleterOfAttribute(Q)||S.c}setValues(Q){this.availableOptions=this.sortValues(Q),this.addEmptyOption()}loadValues(Q){const{allowedValues:U}=this.schema;if(Array.isArray(U))this.setValues(U),this.valuesLoaded=!0;else{if(U&&!this.valuesLoaded)return this.loadValuesFromBackend(Q);this.setValues([])}return(0,b.D)(Promise.resolve(this.availableOptions))}loadValuesFromBackend(Q){return(0,b.D)(this.loadAllowedValues(Q)).pipe((0,v.U)(U=>void 0===U.count||void 0===U.total||!Q&&U.total===U.count||!this.value?U.elements:U.elements.concat([this.value])),(0,M.b)(U=>this.setValues(U)),(0,v.U)(()=>this.availableOptions))}loadAllowedValues(Q){if(!Q){const U=this.schema.allowedValues.$link.href;return this.change.cacheValue(U,this.fetchAllowedValueQuery.bind(this))}return this.fetchAllowedValueQuery(Q)}fetchAllowedValueQuery(Q){return this.schema.allowedValues.$link.$fetch(this.allowedValuesFilter(Q))}addValue(Q){this.availableOptions.push(Q)}get currentValueInvalid(){return!!(this.value&&!_.some(this.availableOptions,Q=>Q.href===this.value.href)||!this.value&&this.schema.required)}onCreate(Q){this.addValue(Q),this.selectedOption={name:Q.name,href:Q.href},this.handler.handleUserSubmit()}onOpen(){jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this._autocompleterComponent.closeSelect()})}onClose(){}onChange(Q){if(Q)return this.selectedOption=Q,void this.handler.handleUserSubmit();const U=this.getEmptyOption();U&&(this.selectedOption=U,this.handler.handleUserSubmit())}onNewValueAdded(Q){return(0,m.mG)(this,void 0,void 0,function*(){!Q||(yield this.change.getForm(!0),this.onChange(Q))})}addEmptyOption(){this.isRequired()||void 0===this.getEmptyOption()&&this.availableOptions.unshift({name:this.text.placeholder,href:""})}isRequired(){return this.schema.required}sortValues(Q){return this.halSorting.sort(Q)}allowedValuesFilter(Q){return{}}getEmptyOption(){return _.find(this.availableOptions,Q=>Q.name===this.text.placeholder)}_syncUrlParamsOnChangeIfNeeded(Q,U){"type"===Q&&U&&this.handler.registerOnBeforeSubmit(()=>{var we,X;const z=null===(X=null===(we=this.value)||void 0===we?void 0:we.$source)||void 0===X?void 0:X.id;z&&this.$state.go(".",{type:z},{notify:!1})})}}te.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(te)))(U||te)}}(),te.\u0275cmp=i.Xpm({type:te,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:13,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(Q,U){1&Q&&i._UZ(0,"ndc-dynamic",0),2&Q&&i.Q6J("ndcDynamicComponent",U.autocompleterComponent())("ndcDynamicInputs",i.rFY(3,N,[U.availableOptions,U.appendTo,U.selectedOption?U.selectedOption:"",U.required,U.inFlight,U.handler.htmlId,"inline-edit--field "+U.handler.fieldName,U.resource,U.showAddNewButton]))("ndcDynamicOutputs",U.referenceOutputs)},directives:[J.B5,J.oc],encapsulation:2}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",k)],te.prototype,"selectAutocompleterRegister",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",F.W)],te.prototype,"halNotification",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",I.h)],te.prototype,"halSorting",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",A.StateService)],te.prototype,"$state",void 0),(0,m.gn)([(0,P.W)(O.n,null,i.XFs.Optional),(0,m.w6)("design:type",O.n)],te.prototype,"editFormComponent",void 0);var ee=t(96617),G=t(36868),se=t(82140);function me(Te,Q){if(1&Te){const U=i.EpF();i.TgZ(0,"op-invite-user-button",4),i.NdJ("invited",function(X){i.CHM(U);return i.oxw(2).selectedOption=X}),i.qZA()}if(2&Te){const U=i.oxw(2);i.Q6J("projectId",null==U.resource.project?null:U.resource.project.id)}}function _e(Te,Q){1&Te&&i.YNc(0,me,1,1,"ng-template",3)}function he(Te,Q){if(1&Te){const U=i.EpF();i.TgZ(0,"edit-field-controls",5),i.NdJ("onSave",function(){return i.CHM(U),i.oxw().handler.handleUserSubmit()})("onCancel",function(){return i.CHM(U),i.oxw().handler.handleUserCancel()}),i.qZA()}if(2&Te){const U=i.oxw();i.Q6J("fieldController",U.self)("saveTitle",U.text.save)("cancelTitle",U.text.cancel)}}class ae extends l.su{constructor(){super(...arguments),this.availableOptions=[],this.text={requiredPlaceholder:this.I18n.t("js.placeholders.selection"),placeholder:this.I18n.t("js.placeholders.default"),save:this.I18n.t("js.inplace.button_save",{attribute:this.schema.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.schema.name})},this.appendTo=null,this.currentValueInvalid=!1,this.hiddenOverflowContainer=".__hidden_overflow_container",this.requestFocus=!1}ngOnInit(){this.nullOption={name:this.text.placeholder,href:null},this.showAddNewUserButton="User"===this.schema.type,this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.requestFocus=0===this.availableOptions.length,this.requestFocus||this.openAutocompleteSelectField()}),super.ngOnInit(),this.appendTo=this.overflowingSelector}get value(){const Q=this.resource[this.name];return Q&&Q[0]}buildSelectedOption(){const Q=this.resource[this.name];return Q?_.castArray(Q).map(U=>this.findValueOption(U)):[]}get selectedOption(){return this._selectedOption}set selectedOption(Q){this._selectedOption=Q;const U=we=>{const X=_.find(this.availableOptions,z=>z.href===we.href)||this.nullOption;return X&&""===X.href&&(X.href=null),X};this.resource[this.name]=_.castArray(Q).map(we=>U(we))}onOpen(){jQuery(this.hiddenOverflowContainer).one("scroll",()=>{this.ngSelectComponent.close()})}onClose(){}repositionDropdown(){this.ngSelectComponent&&this.ngSelectComponent.dropdownPanel&&setTimeout(()=>this.ngSelectComponent.dropdownPanel.adjustPosition(),0)}openAutocompleteSelectField(){const Q=this;window.setTimeout(()=>{Q.ngSelectComponent.open()},0)}findValueOption(Q){let U;return Q&&(U=_.find(this.availableOptions,we=>we.href===Q.href)),U||this.nullOption}setValues(Q,U=!1){U&&Q.sort((we,X)=>{const z=we.name.toLowerCase(),V=X.name.toLowerCase();return z<V?-1:z>V?1:0}),this.availableOptions=Q||[],this._selectedOption=this.buildSelectedOption(),this.checkCurrentValueValidity(),this.availableOptions.length>0&&this.requestFocus&&(this.openAutocompleteSelectField(),this.requestFocus=!1)}initialize(){super.initialize(),this.loadValues()}loadValues(){const{allowedValues:Q}=this.schema;if(Array.isArray(Q))this.setValues(Q);else{if(this.schema.allowedValues)return this.schema.allowedValues.$load().then(U=>{U.count>0&&"Project"===U.elements[0]._type?this.setValues(U.elements,!0):this.setValues(U.elements)});this.setValues([])}return Promise.resolve()}checkCurrentValueValidity(){this.value?this.currentValueInvalid=!_.some(this.value,Q=>_.some(this.availableOptions,U=>U.href===Q.href)):this.currentValueInvalid=!!this.schema.required}}ae.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(ae)))(U||ae)}}(),ae.\u0275cmp=i.Xpm({type:ae,selectors:[["ng-component"]],viewQuery:function(Q,U){if(1&Q&&i.Gf(G.w9,7),2&Q){let we;i.iGM(we=i.CRH())&&(U.ngSelectComponent=we.first)}},features:[i.qOj],decls:3,vars:16,consts:[["bindLabel","name",3,"ngModel","ngClass","required","clearable","disabled","id","items","virtualScroll","clearSearchOnAdd","multiple","closeOnSelect","appendTo","dropdownPosition","hideSelected","ngModelChange","keydown","open","close","add","remove"],[4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],["ng-footer-tmp",""],[3,"projectId","invited"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(Q,U){1&Q&&(i.TgZ(0,"ng-select",0),i.NdJ("ngModelChange",function(X){return U.selectedOption=X})("keydown",function(X){return U.handler.handleUserKeydown(X,!0)})("open",function(){return U.onOpen()})("close",function(){return U.onClose()})("add",function(){return U.repositionDropdown()})("remove",function(){return U.repositionDropdown()}),i.YNc(1,_e,1,0,void 0,1),i.qZA(),i.YNc(2,he,1,3,"edit-field-controls",2)),2&Q&&(i.Q6J("ngModel",U.selectedOption)("ngClass","inline-edit--field -multi-select")("required",U.required)("clearable",!U.required)("disabled",U.inFlight)("id",U.handler.htmlId)("items",U.availableOptions)("virtualScroll",!0)("clearSearchOnAdd",!0)("multiple",!0)("closeOnSelect",!1)("appendTo",U.appendTo)("dropdownPosition","top")("hideSelected",!0),i.xp6(1),i.Q6J("ngIf",U.showAddNewUserButton),i.xp6(1),i.Q6J("ngIf",!U.handler.inEditMode))},directives:[G.w9,d.JJ,d.On,e.mk,d.Q7,e.O5,G.x0,se.e],encapsulation:2}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",ee.D)],ae.prototype,"I18n",void 0);class re extends l.su{constructor(){super(...arguments),this.locale=I18n.locale}}re.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(re)))(U||re)}}(),re.\u0275cmp=i.Xpm({type:re,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:6,consts:[["type","number","step","any",1,"inline-edit--field","op-input",3,"disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(Q,U){1&Q&&(i.TgZ(0,"input",0),i.NdJ("ngModelChange",function(X){return U.value=X})("keydown",function(X){return U.handler.handleUserKeydown(X)})("focusout",function(){return U.handler.onFocusOut()}),i.qZA()),2&Q&&(i.Q6J("disabled",U.inFlight)("ngModel",U.value)("id",U.handler.htmlId),i.uIk("aria-required",U.required)("required",U.required)("lang",U.locale))},directives:[d.wV,d.Fj,d.Q7,d.JJ,d.On],encapsulation:2});class ye extends l.su{updateValue(Q){this.value=Q,this.handler.handleUserSubmit()}}ye.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(ye)))(U||ye)}}(),ye.\u0275cmp=i.Xpm({type:ye,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:4,consts:[["type","checkbox",1,"inline-edit--field","inline-edit--boolean-field",3,"checked","disabled","id","change","keydown"]],template:function(Q,U){1&Q&&(i.TgZ(0,"input",0),i.NdJ("change",function(){return U.updateValue(!U.value)})("keydown",function(X){return U.handler.handleUserKeydown(X)}),i.qZA()),2&Q&&(i.Q6J("checked",U.value)("disabled",U.inFlight)("id",U.handler.htmlId),i.uIk("aria-required",U.required))},encapsulation:2});var Ce=t(26479),ke=t(53466),Ae=t(26269);const Fe=function(Te,Q,U,we,X,z,V,Qe,Ke){return{availableValues:Te,appendTo:Q,model:U,required:we,disabled:X,id:z,finishedLoading:V,classes:Qe,typeahead:Ke,hideSelected:!0}};class ot extends te{constructor(){super(...arguments),this.requests=new Ce.u(Q=>this.loadValues(Q),(0,Ce.G)(this.halNotification))}initialValueLoading(){return this.valuesLoaded=!1,new Promise(Q=>{this.requests.output$.pipe((0,ke.q)(1)).subscribe(U=>{Q(U)}),this.requests.input$.next("")})}get typeahead(){return this.requests.input$}allowedValuesFilter(Q){let U=super.allowedValuesFilter(Q);if(Q){const we=new Ae.qM;we.add("subjectOrId","**",[Q]),U={filters:we.toJson()}}return U}}ot.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(ot)))(U||ot)}}(),ot.\u0275cmp=i.Xpm({type:ot,selectors:[["ng-component"]],features:[i.qOj],decls:2,vars:15,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(Q,U){1&Q&&(i._UZ(0,"ndc-dynamic",0),i.ALo(1,"async")),2&Q&&i.Q6J("ndcDynamicComponent",U.autocompleterComponent())("ndcDynamicInputs",i.rFY(5,Fe,[i.lcZ(1,3,U.requests.output$),U.appendTo,U.selectedOption?U.selectedOption:"",U.required,U.inFlight,U.handler.htmlId,U.requests.loading$,"inline-edit--field "+U.handler.fieldName,U.typeahead]))("ndcDynamicOutputs",U.referenceOutputs)},directives:[J.B5,J.oc],pipes:[e.Ov],encapsulation:2});var it=t(77355),Ve=t(90547);class Ie extends l.su{ngOnInit(){super.ngOnInit()}onValueSelected(Q){this.value=this.parser(Q),this.handler.handleUserSubmit()}onCancel(){this.handler.handleUserCancel()}parser(Q){return E(Q,"YYYY-MM-DD",!0).isValid()?Q:null}formatter(Q){if(E(Q,"YYYY-MM-DD",!0).isValid()){const U=this.timezoneService.parseDate(Q);return this.timezoneService.formattedISODate(U)}return null}}Ie.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(Ie)))(U||Ie)}}(),Ie.\u0275cmp=i.Xpm({type:Ie,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:4,consts:[["tabindex","-1","classes","inline-edit--field",3,"initialDate","required","disabled","id","changed","canceled"]],template:function(Q,U){1&Q&&(i.TgZ(0,"op-single-date-picker",0),i.NdJ("changed",function(X){return U.onValueSelected(X)})("canceled",function(){return U.onCancel()}),i.qZA()),2&Q&&i.Q6J("initialDate",U.formatter(U.value))("required",U.required)("disabled",U.inFlight)("id",U.handler.htmlId)},directives:[Ve.S],encapsulation:2}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",w.B)],Ie.prototype,"timezoneService",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",it.S)],Ie.prototype,"opModalService",void 0);var ue=t(26611),ie=t(84699);function R(Te,Q){if(1&Te){const U=i.EpF();i.TgZ(0,"edit-field-controls",4),i.NdJ("onSave",function(){return i.CHM(U),i.oxw().handleUserSubmit()})("onCancel",function(){return i.CHM(U),i.oxw().handler.handleUserCancel()}),i.qZA()}if(2&Te){const U=i.oxw();i.Q6J("fieldController",U.field)("saveTitle",U.text.save)("cancelTitle",U.text.cancel)}}class L extends l.su{constructor(){super(...arguments),this.field=this,this.initializationError=!1,this.isPreview=!1,this.previewHtml="",this.text={},this.ckEditorContext=Object.assign({resource:this.change.pristineResource,macros:"none",previewContext:this.previewContext,options:{rtl:this.schema.options&&this.schema.options.rtl},type:"constrained"},this.resource.getEditorContext(this.field.name))}ngOnInit(){super.ngOnInit(),this.handler.registerOnSubmit(()=>this.getCurrentValue()),this.text={attachmentLabel:this.I18n.t("js.label_formattable_attachment_hint"),save:this.I18n.t("js.inplace.button_save",{attribute:this.schema.name}),cancel:this.I18n.t("js.inplace.button_cancel",{attribute:this.schema.name})}}onCkeditorSetup(Q){(0,ie.Z)(this.resource)||setTimeout(()=>Q.editing.view.focus())}getCurrentValue(){return this.editor.getTransformedContent().then(Q=>{this.rawValue=Q})}onContentChange(Q){this.rawValue!==Q&&(this.rawValue=Q)}handleUserSubmit(){return this.getCurrentValue().then(()=>{this.handler.handleUserSubmit()}),!1}get previewContext(){return this.handler.previewContext(this.resource)}reset(){this.editor&&this.editor.initialized&&(this.editor.content=this.rawValue,this.cdRef.markForCheck())}get rawValue(){return this.value&&this.value.raw?this.value.raw:""}set rawValue(Q){this.value={raw:Q}}isEmpty(){return!(this.value&&this.value.raw)}initialize(){this.initialContent=this.rawValue,(0,ie.Z)(this.resource)&&this.editor&&this.reset()}}L.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(L)))(U||L)}}(),L.\u0275cmp=i.Xpm({type:L,selectors:[["ng-component"]],viewQuery:function(Q,U){if(1&Q&&i.Gf(ue.F,7),2&Q){let we;i.iGM(we=i.CRH())&&(U.editor=we.first)}},features:[i.qOj],decls:4,vars:3,consts:[[1,"textarea-wrapper"],[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"context","content","onContentChange","onInitializationFailed","onInitialized"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(Q,U){1&Q&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"op-ckeditor",2),i.NdJ("onContentChange",function(X){return U.onContentChange(X)})("onInitializationFailed",function(){return U.initializationError=!0})("onInitialized",function(X){return U.onCkeditorSetup(X)}),i.qZA(),i.qZA(),i.YNc(3,R,1,3,"edit-field-controls",3),i.qZA()),2&Q&&(i.xp6(2),i.Q6J("context",U.ckEditorContext)("content",U.initialContent),i.xp6(1),i.Q6J("ngIf",!(U.handler.inEditMode||U.initializationError)))},directives:[ue.F,e.O5,se.e],encapsulation:2,changeDetection:0});var W=t(63419);function oe(Te,Q){if(1&Te&&(i._UZ(0,"span",3),i.TgZ(1,"span",4),i._uU(2),i.qZA()),2&Te){const U=Q.item;i.Q6J("ngClass",U.colorClass),i.xp6(1),i.Q6J("ngClass",U.colorClass),i.xp6(1),i.Oqu(U.name)}}function Oe(Te,Q){if(1&Te&&(i._UZ(0,"span",3),i.TgZ(1,"span",4),i._uU(2),i.qZA()),2&Te){const U=Q.item;i.Q6J("ngClass",U.colorClass),i.xp6(1),i.Q6J("ngClass",U.colorClass),i.xp6(1),i.Oqu(U.name)}}class $ extends l.su{constructor(){super(...arguments),this.availableStatuses=[{href:"not_set",name:(0,W.v)("not_set",this.I18n),colorClass:(0,W.p)("not_set")}],this.hiddenOverflowContainer="#content-wrapper",this.appendToContainer="body"}ngOnInit(){this.currentStatusCode=null===this.resource.status?this.availableStatuses[0].href:this.resource.status.href,this.change.getForm().then(Q=>{Q.schema.status.allowedValues.forEach(we=>{this.availableStatuses=[...this.availableStatuses,{href:we.href,name:we.name,colorClass:(0,W.p)(we.id)}]});const U=this;window.setTimeout(()=>{U.ngSelectComponent.open()},0)})}onChange(){this.resource.status=this.currentStatusCode===this.availableStatuses[0].href?null:{href:this.currentStatusCode},this.handler.handleUserSubmit()}onOpen(){setTimeout(()=>{const Q=this.ngSelectComponent;Q&&Q.dropdownPanel&&Q.dropdownPanel._updatePosition(),jQuery(this.hiddenOverflowContainer).one("scroll.autocompleteContainer",()=>{this.ngSelectComponent.close()})},25)}onClose(){jQuery(this.hiddenOverflowContainer).off("scroll.autocompleteContainer")}}$.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z($)))(U||$)}}(),$.\u0275cmp=i.Xpm({type:$,selectors:[["ng-component"]],viewQuery:function(Q,U){if(1&Q&&i.Gf(G.w9,7),2&Q){let we;i.iGM(we=i.CRH())&&(U.ngSelectComponent=we.first)}},features:[i.qOj],decls:3,vars:5,consts:[["bindLabel","name","bindValue","href",1,"project-status",3,"items","ngModel","appendTo","hideSelected","disabled","ngModelChange","open","close","change"],["ng-label-tmp",""],["ng-option-tmp",""],[1,"project-status--bulb",3,"ngClass"],[1,"project-status--name",3,"ngClass"]],template:function(Q,U){1&Q&&(i.TgZ(0,"ng-select",0),i.NdJ("ngModelChange",function(X){return U.currentStatusCode=X})("open",function(){return U.onOpen()})("close",function(){return U.onClose()})("change",function(){return U.onChange()}),i.YNc(1,oe,3,3,"ng-template",1),i.YNc(2,Oe,3,3,"ng-template",2),i.qZA()),2&Q&&i.Q6J("items",U.availableStatuses)("ngModel",U.currentStatusCode)("appendTo",U.appendToContainer)("hideSelected",!0)("disabled",U.inFlight)},directives:[G.w9,d.JJ,d.On,G.bb,G.Z2,e.mk],styles:[""]}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",ee.D)],$.prototype,"I18n",void 0);class Xe extends l.su{constructor(){super(...arguments),this.shouldFocus=!1}get value(){if(!this.schema)return"";const Q=this.resource[this.name];return Q&&Q.raw||""}set value(Q){this.resource[this.name]={raw:Q}}}Xe.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(Xe)))(U||Xe)}}(),Xe.\u0275cmp=i.Xpm({type:Xe,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:6,consts:[["type","text",1,"inline-edit--field","op-input",3,"opAutofocus","disabled","ngModel","id","ngModelChange","keydown","focusout"]],template:function(Q,U){1&Q&&(i.TgZ(0,"input",0),i.NdJ("ngModelChange",function(X){return U.value=X})("keydown",function(X){return U.handler.handleUserKeydown(X)})("focusout",function(){return U.handler.onFocusOut()}),i.qZA()),2&Q&&(i.Q6J("opAutofocus",U.shouldFocus)("disabled",U.inFlight)("ngModel",U.value)("id",U.handler.htmlId),i.uIk("aria-required",U.required)("required",U.required))},directives:[d.Fj,g.U,d.Q7,d.JJ,d.On],encapsulation:2});var rt=t(10190),ge=t(20979),be=t(50166);const Me=function(Te,Q,U,we,X,z,V,Qe,Ke){return{availableValues:Te,appendTo:Q,model:U,required:we,disabled:X,id:z,finishedLoading:V,classes:Qe,typeahead:Ke,hideSelected:!0}};class $e extends ot{initialize(){super.initialize(),this.referenceOutputs&&(this.referenceOutputs.modeSwitch=Q=>{this.valuesLoaded=!1;const U=this.requests.lastRequestedValue;this.requests.input$.next('_/&"()____'),this.requests.input$.next(U)})}autocompleterComponent(){return be.R}isRequired(){return!0}loadAllowedValues(Q){return this.recentWorkPackageIds?this.fetchAllowedValueQuery(Q):this.apiV3Service.time_entries.list({filters:[["user_id","=",["me"]]],sortBy:[["updated_at","desc"]],pageSize:30}).toPromise().then(U=>(this.recentWorkPackageIds=U.elements.filter(we=>{var X;return null===(X=we.workPackage)||void 0===X?void 0:X.href}).map(we=>(0,rt.Z)(we.workPackage.href)).filter((we,X,z)=>z.indexOf(we)===X),this.fetchAllowedValueQuery(Q)))}allowedValuesFilter(Q){const U=new Ae.qM;return"recent"===this._autocompleterComponent.mode&&this.recentWorkPackageIds.length>0&&U.add("id","=",this.recentWorkPackageIds),Q&&U.add("subjectOrId","**",[Q]),{filters:U.toJson()}}sortValues(Q){return"recent"===this._autocompleterComponent.mode?this.sortValuesByRecentIds(Q):super.sortValues(Q)}sortValuesByRecentIds(Q){return Q.sort((U,we)=>this.recentWorkPackageIds.indexOf(U.id)-this.recentWorkPackageIds.indexOf(we.id))}}$e.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z($e)))(U||$e)}}(),$e.\u0275cmp=i.Xpm({type:$e,selectors:[["ng-component"]],features:[i.qOj],decls:2,vars:15,consts:[[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"]],template:function(Q,U){1&Q&&(i._UZ(0,"ndc-dynamic",0),i.ALo(1,"async")),2&Q&&i.Q6J("ndcDynamicComponent",U.autocompleterComponent())("ndcDynamicInputs",i.rFY(5,Me,[i.lcZ(1,3,U.requests.output$),U.appendTo,U.selectedOption?U.selectedOption:"",U.required,U.inFlight,U.handler.htmlId,U.requests.loading$,"inline-edit--field "+U.handler.fieldName,U.typeahead]))("ndcDynamicOutputs",U.referenceOutputs)},directives:[J.B5,J.oc],pipes:[e.Ov],encapsulation:2}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",ge.T)],$e.prototype,"apiV3Service",void 0);var pt=t(60312),mt=t(14882),vt=t(12703);class Ue{mappedDate(Q){return""===Q?null:Q}parseDate(Q){return Q instanceof Date?new Date(Q.setHours(0,0,0,0)):""===Q?"":new Date(new Date(Q).setHours(0,0,0,0))}validDate(Q){return Q instanceof Date||""===Q||!!new Date(Q).valueOf()}sortDates(Q){return Q.sort((U,we)=>U.getTime()-we.getTime())}areDatesEqual(Q,U){const we=this.parseDate(Q),X=this.parseDate(U);return"string"!=typeof we&&"string"!=typeof X&&we.getTime()===X.getTime()}setCurrentActivatedField(Q){this.currentlyActivatedDateField=Q}toggleCurrentActivatedField(Q,U){this.currentlyActivatedDateField="start"===this.currentlyActivatedDateField?"end":"start",this.setDatepickerRestrictions(Q,U)}isStateOfCurrentActivatedField(Q){return this.currentlyActivatedDateField===Q}setDates(Q,U,we){const{currentMonth:X}=U.datepickerInstance,{currentYear:z}=U.datepickerInstance;U.setDates(Q),we?(U.datepickerInstance.currentMonth=we.getMonth(),U.datepickerInstance.currentYear=we.getFullYear()):(U.datepickerInstance.currentMonth=X,U.datepickerInstance.currentYear=z),U.datepickerInstance.redraw()}setDatepickerRestrictions(Q,U){if(!Q.start&&!Q.end)return;let we=X=>!1;this.isStateOfCurrentActivatedField("start")&&Q.end?we=X=>X.getTime()>new Date(Q.end).setHours(0,0,0,0):this.isStateOfCurrentActivatedField("end")&&Q.start&&(we=X=>X.getTime()<new Date(Q.start).setHours(0,0,0,0)),U.datepickerInstance.set("disable",[we])}setRangeClasses(Q){if(!Q.start||!Q.end||Q.start===Q.end)return;const U=document.getElementsByClassName("dayContainer");for(let we=0;we<U.length;we++)this.highlightRangeInSingleMonth(U[we],Q)}highlightRangeInSingleMonth(Q,U){const we=jQuery(Q).find(".flatpickr-day.selected");if(2===we.length)we[0].classList.add("startRange"),we[1].classList.add("endRange"),this.selectRangeFromUntil(we[0],we[1]);else if(1===we.length){if(Ue.datepickerShowsDate(U.start,we[0]))we[0].classList.add("startRange"),this.selectRangeFromUntil(we[0],"");else if(Ue.datepickerShowsDate(U.end,we[0])){const X=jQuery(Q).find(".flatpickr-day")[0];we[0].classList.add("endRange"),X.classList.add("inRange"),this.selectRangeFromUntil(X,we[0])}}else Ue.datepickerIsInDateRange(Q,U)&&jQuery(Q).find(".flatpickr-day").addClass("inRange")}static datepickerShowsDate(Q,U){const we=U.getAttribute("data-iso-date");return!!we&&moment(we).isSame(Q,"days")}static datepickerIsInDateRange(Q,U){const X=jQuery(Q).find(".flatpickr-day:not(.hidden)")[0].getAttribute("data-iso-date");if(X){const z=new Date(X);return z<=new Date(U.end)&&z>=new Date(U.start)}return!1}selectRangeFromUntil(Q,U){jQuery(Q).nextUntil(U).addClass("inRange")}}Ue.\u0275fac=function(Q){return new(Q||Ue)},Ue.\u0275prov=i.Yz7({token:Ue,factory:Ue.\u0275fac,providedIn:"root"});var Le=t(1056),Ee=t(12877);const st=["modalContainer"],ut=function(Te){return{"-current":Te}};function It(Te,Q){if(1&Te){const U=i.EpF();i.ynx(0),i.TgZ(1,"div",13),i._UZ(2,"label",14),i.TgZ(3,"div",6),i.TgZ(4,"div",15),i.TgZ(5,"input",16),i.NdJ("ngModelChange",function(X){return i.CHM(U),i.oxw().updateDate("date",X)})("click",function(){return i.CHM(U),i.oxw().datepickerHelper.setCurrentActivatedField("date")}),i.qZA(),i.qZA(),i.TgZ(6,"a",17),i.NdJ("click",function(){return i.CHM(U),i.oxw().clear("date")}),i._UZ(7,"span",18),i.qZA(),i.qZA(),i.TgZ(8,"div",19),i.TgZ(9,"a",20),i.NdJ("click",function(){return i.CHM(U),i.oxw().setToday("date")}),i.qZA(),i.qZA(),i.qZA(),i.BQk()}if(2&Te){const U=i.oxw();i.xp6(2),i.Q6J("textContent",U.text.date),i.xp6(3),i.Q6J("ngClass",i.VKq(5,ut,U.datepickerHelper.isStateOfCurrentActivatedField("date")))("ngModel",U.dates.date),i.xp6(1),i.Q6J("title",U.text.clear),i.xp6(3),i.Q6J("textContent",U.text.today)}}function Zt(Te,Q){if(1&Te){const U=i.EpF();i.TgZ(0,"a",17),i.NdJ("click",function(){return i.CHM(U),i.oxw(2).clear("start")}),i._UZ(1,"span",18),i.qZA()}if(2&Te){const U=i.oxw(2);i.Q6J("title",U.text.clear)}}function Ut(Te,Q){if(1&Te){const U=i.EpF();i.TgZ(0,"a",20),i.NdJ("click",function(){return i.CHM(U),i.oxw(2).setToday("start")}),i.qZA()}if(2&Te){const U=i.oxw(2);i.Q6J("textContent",U.text.today)}}function jt(Te,Q){if(1&Te){const U=i.EpF();i.TgZ(0,"a",17),i.NdJ("click",function(){return i.CHM(U),i.oxw(2).clear("end")}),i._UZ(1,"span",18),i.qZA()}if(2&Te){const U=i.oxw(2);i.Q6J("title",U.text.clear)}}function Dt(Te,Q){if(1&Te){const U=i.EpF();i.TgZ(0,"a",20),i.NdJ("click",function(){return i.CHM(U),i.oxw(2).setToday("end")}),i.qZA()}if(2&Te){const U=i.oxw(2);i.Q6J("textContent",U.text.today)}}function bt(Te,Q){if(1&Te){const U=i.EpF();i.ynx(0),i.TgZ(1,"div",21),i._UZ(2,"label",14),i.TgZ(3,"div",6),i.TgZ(4,"div",15),i.TgZ(5,"input",22),i.NdJ("ngModelChange",function(X){return i.CHM(U),i.oxw().updateDate("start",X)})("click",function(){return i.CHM(U),i.oxw().setCurrentActivatedField("start")}),i.qZA(),i.qZA(),i.YNc(6,Zt,2,1,"a",23),i.qZA(),i.TgZ(7,"div",19),i.YNc(8,Ut,1,1,"a",24),i.qZA(),i.qZA(),i.TgZ(9,"div",25),i._UZ(10,"label",14),i.TgZ(11,"div",6),i.TgZ(12,"div",15),i.TgZ(13,"input",26),i.NdJ("ngModelChange",function(X){return i.CHM(U),i.oxw().updateDate("end",X)})("click",function(){return i.CHM(U),i.oxw().setCurrentActivatedField("end")}),i.qZA(),i.qZA(),i.YNc(14,jt,2,1,"a",23),i.qZA(),i.TgZ(15,"div",19),i.YNc(16,Dt,1,1,"a",24),i.qZA(),i.qZA(),i.BQk()}if(2&Te){const U=i.oxw();i.xp6(2),i.Q6J("textContent",U.text.startDate),i.xp6(3),i.Q6J("ngClass",i.VKq(12,ut,U.datepickerHelper.isStateOfCurrentActivatedField("start")))("ngModel",U.dates.start)("disabled",!U.isSchedulable),i.xp6(1),i.Q6J("ngIf",U.isSchedulable),i.xp6(2),i.Q6J("ngIf",U.showTodayLink("start")),i.xp6(2),i.Q6J("textContent",U.text.endDate),i.xp6(3),i.Q6J("ngClass",i.VKq(14,ut,U.datepickerHelper.isStateOfCurrentActivatedField("end")))("ngModel",U.dates.end)("disabled",!U.isSchedulable),i.xp6(1),i.Q6J("ngIf",U.isSchedulable),i.xp6(2),i.Q6J("ngIf",U.showTodayLink("end"))}}function Lt(Te,Q){if(1&Te&&(i.ynx(0),i._UZ(1,"p",29),i.BQk()),2&Te){const U=i.oxw(2);i.xp6(1),i.Q6J("textContent",U.text.isParent)}}function Wt(Te,Q){if(1&Te&&(i.ynx(0),i._UZ(1,"p",29),i.BQk()),2&Te){const U=i.oxw(2);i.xp6(1),i.Q6J("textContent",U.text.isSwitchedFromManualToAutomatic)}}function Rt(Te,Q){if(1&Te&&(i.ynx(0),i.TgZ(1,"div",27),i.TgZ(2,"div",28),i.YNc(3,Lt,2,1,"ng-container",4),i.YNc(4,Wt,2,1,"ng-container",4),i.qZA(),i.qZA(),i.BQk()),2&Te){const U=i.oxw();i.xp6(3),i.Q6J("ngIf",U.isParent),i.xp6(1),i.Q6J("ngIf",U.isSwitchedFromManualToAutomatic&&!U.isParent)}}function xt(Te,Q){1&Te&&(i.ynx(0),i._UZ(1,"input",30),i.BQk())}class Mt extends pt.T{constructor(Q,U,we,X,z){super(U,we,X),this.injector=Q,this.locals=U,this.cdRef=we,this.elementRef=X,this.configurationService=z,this.text={save:this.I18n.t("js.button_save"),cancel:this.I18n.t("js.button_cancel"),clear:this.I18n.t("js.work_packages.button_clear"),manualScheduling:this.I18n.t("js.scheduling.manual"),date:this.I18n.t("js.work_packages.properties.date"),startDate:this.I18n.t("js.work_packages.properties.startDate"),endDate:this.I18n.t("js.work_packages.properties.dueDate"),placeholder:this.I18n.t("js.placeholders.default"),today:this.I18n.t("js.label_today"),isParent:this.I18n.t("js.work_packages.scheduling.is_parent"),isSwitchedFromManualToAutomatic:this.I18n.t("js.work_packages.scheduling.is_switched_from_manual_to_automatic")},this.onDataUpdated=new i.vpe,this.singleDate=!1,this.scheduleManually=!1,this.htmlId="",this.dates={date:"",start:"",end:""},this.changeset=U.changeset,this.htmlId=`wp-datepicker-${U.fieldName}`,this.singleDate=this.changeset.isWritable("date"),this.scheduleManually=!!this.changeset.value("scheduleManually"),this.singleDate?(this.dates.date=this.changeset.value("date"),this.datepickerHelper.setCurrentActivatedField("date")):(this.dates.start=this.changeset.value("startDate"),this.dates.end=this.changeset.value("dueDate"),this.datepickerHelper.setCurrentActivatedField(this.initialActivatedField()))}ngAfterViewInit(){this.isSchedulable&&this.showDateSelection(),this.onDataChange()}changeSchedulingMode(){this.scheduleManually=!this.scheduleManually,this.cdRef.detectChanges(),this.scheduleManually?this.showDateSelection():this.isParent&&this.removeDateSelection()}save(Q){Q.preventDefault(),this.isSavable&&(this.changeset.setValue("scheduleManually",this.scheduleManually),this.isSchedulable&&(this.singleDate?this.changeset.setValue("date",this.datepickerHelper.mappedDate(this.dates.date)):(this.changeset.setValue("startDate",this.datepickerHelper.mappedDate(this.dates.start)),this.changeset.setValue("dueDate",this.datepickerHelper.mappedDate(this.dates.end)))),this.closeMe())}cancel(){this.closeMe()}clear(Q){this.dates[Q]="",this.enforceManualChangesToDatepicker()}updateDate(Q,U){(U.length>=8||0===U.length)&&(this.dates[Q]=U,this.datepickerHelper.validDate(U)&&this.datePickerInstance&&this.enforceManualChangesToDatepicker(!1))}setToday(Q){const U=this.datepickerHelper.parseDate(new Date);this.dates[Q]=this.timezoneService.formattedISODate(U),U instanceof Date?this.enforceManualChangesToDatepicker(!0,U):this.enforceManualChangesToDatepicker()}reposition(Q,U){Q.position({my:"left top",at:"left bottom",of:U,collision:"flipfit"})}setCurrentActivatedField(Q){this.datepickerHelper.setCurrentActivatedField(Q),this.datepickerHelper.setDatepickerRestrictions(this.dates,this.datePickerInstance),this.datepickerHelper.setRangeClasses(this.dates)}showTodayLink(Q){return!!this.isSchedulable&&("start"===Q?!this.dates.end||this.datepickerHelper.parseDate(new Date)<=this.datepickerHelper.parseDate(this.dates.end):!this.dates.start||this.datepickerHelper.parseDate(new Date)>=this.datepickerHelper.parseDate(this.dates.start))}get isSchedulable(){return this.scheduleManually||!this.isParent&&!this.isSwitchedFromManualToAutomatic}get isSavable(){return this.isSchedulable||this.isSwitchedFromManualToAutomatic}get isParent(){const Q=this.changeset.projectedResource;return Q.$links.children&&Q.$links.children.length>0}get isSwitchedFromManualToAutomatic(){return!this.scheduleManually&&!!this.changeset.value("scheduleManually")}showDateSelection(){this.initializeDatepicker(),this.datepickerHelper.setDatepickerRestrictions(this.dates,this.datePickerInstance),this.datepickerHelper.setRangeClasses(this.dates)}removeDateSelection(){this.datePickerInstance.destroy()}initializeDatepicker(){var Q;null===(Q=this.datePickerInstance)||void 0===Q||Q.destroy(),this.datePickerInstance=new mt.M("#flatpickr-input",this.singleDate?this.dates.date:[this.dates.start,this.dates.end],{mode:this.singleDate?"single":"multiple",showMonths:this.browserDetector.isMobile?1:2,inline:!0,onChange:U=>{this.handleDatePickerChange(U),this.onDataChange()},onMonthChange:()=>{this.datepickerHelper.setRangeClasses(this.dates)},onYearChange:()=>{this.datepickerHelper.setRangeClasses(this.dates)},onDayCreate:(U,we,X,z)=>{z.setAttribute("data-iso-date",z.dateObj.toISOString())}},null,this.configurationService)}enforceManualChangesToDatepicker(Q=!0,U){if(this.singleDate){const we=this.datepickerHelper.parseDate(this.dates.date);this.datepickerHelper.setDates(we,this.datePickerInstance,U)}else{const we=[this.datepickerHelper.parseDate(this.dates.start),this.datepickerHelper.parseDate(this.dates.end)];this.datepickerHelper.setDates(we,this.datePickerInstance,U),this.setRangeClassesAndToggleActiveField(Q)}}handleDatePickerChange(Q){switch(Q.length){case 0:(this.dates.start||this.dates.end)&&this.setDateAndToggleActiveField(this.dates.start||this.dates.end);break;case 1:if(this.singleDate)this.dates.date=this.timezoneService.formattedISODate(Q[0]);else if(this.dates.start&&this.dates.end){if(this.dates.start===this.dates.end)return;if(this.datepickerHelper.isStateOfCurrentActivatedField("start")&&this.datepickerHelper.areDatesEqual(this.dates.start,Q[0])||this.datepickerHelper.isStateOfCurrentActivatedField("end")&&this.datepickerHelper.areDatesEqual(this.dates.end,Q[0])){const U=this.datepickerHelper.isStateOfCurrentActivatedField("start")?"end":"start";this.setDateAndToggleActiveField(this.dates[U])}else this.enforceManualChangesToDatepicker(!0)}else this.setDateAndToggleActiveField(this.timezoneService.formattedISODate(Q[0]),!1);break;case 2:if(!this.dates.end&&this.datepickerHelper.isStateOfCurrentActivatedField("start")||!this.dates.start&&this.datepickerHelper.isStateOfCurrentActivatedField("end"))this.overwriteDatePickerWithNewDates([Q[1]]);else{Q[0]>Q[1]&&(Q=this.datepickerHelper.sortDates(Q),this.datepickerHelper.setDates(Q,this.datePickerInstance));const U=this.datepickerHelper.isStateOfCurrentActivatedField("start")?0:1;this.dates[this.datepickerHelper.currentlyActivatedDateField]=this.timezoneService.formattedISODate(Q[U]),this.setRangeClassesAndToggleActiveField()}break;default:this.datepickerHelper.isStateOfCurrentActivatedField("start")?this.overwriteDatePickerWithNewDates([Q[2],Q[1]]):this.overwriteDatePickerWithNewDates([Q[0],Q[2]])}this.cdRef.detectChanges()}overwriteDatePickerWithNewDates(Q){this.datepickerHelper.setDates(Q,this.datePickerInstance),this.handleDatePickerChange(Q)}setDateAndToggleActiveField(Q,U=!0){this.dates[this.datepickerHelper.currentlyActivatedDateField]=Q,U&&this.datepickerHelper.setDates([this.datepickerHelper.parseDate(Q)],this.datePickerInstance),this.datepickerHelper.toggleCurrentActivatedField(this.dates,this.datePickerInstance)}setRangeClassesAndToggleActiveField(Q=!0){Q&&this.datepickerHelper.toggleCurrentActivatedField(this.dates,this.datePickerInstance),this.datepickerHelper.setRangeClasses(this.dates)}onDataChange(){const Q=this.dates.date||"",U=this.dates.start||"",we=this.dates.end||"",X=this.singleDate?Q:`${U} - ${we}`;this.onDataUpdated.emit(X)}initialActivatedField(){return"dueDate"===this.locals.fieldName||this.dates.start&&!this.dates.end?"end":"start"}}Mt.\u0275fac=function(Q){return new(Q||Mt)(i.Y36(i.zs3),i.Y36(it.E),i.Y36(i.sBO),i.Y36(i.SBq),i.Y36(Ee.e))},Mt.\u0275cmp=i.Xpm({type:Mt,selectors:[["ng-component"]],viewQuery:function(Q,U){if(1&Q&&i.Gf(st,5),2&Q){let we;i.iGM(we=i.CRH())&&(U.modalContainer=we.first)}},features:[i.qOj],decls:17,vars:10,consts:[["data-qa-selector","op-datepicker-modal","data-indicator-name","modal",1,"op-modal","op-datepicker-modal","loading-indicator--location",3,"submit"],["modalContainer",""],[1,"op-modal--body","form","-vertical"],[1,"op-datepicker-modal--dates-container"],[4,"ngIf"],[1,"form--field","op-datepicker-modal--scheduling-action-container"],[1,"form--field-container"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","name","scheduling","data-qa-selector","op-datepicker-modal--scheduling-action",1,"form--check-box","op-datepicker-modal--scheduling-action",3,"ngModel","ngModelChange"],[1,"op-modal--footer"],["data-qa-selector","op-datepicker-modal--action",1,"op-datepicker-modal--action","button",3,"textContent","click"],["data-qa-selector","op-datepicker-modal--action",1,"op-datepicker-modal--action","button","-highlight",3,"textContent"],[1,"form--field"],[1,"form--label",3,"textContent"],[1,"form--text-field-container","-xslim"],["type","text","name","date",1,"form--date-field",3,"ngClass","ngModel","ngModelChange","click"],[1,"form--field-inline-action",3,"title","click"],[1,"icon2","icon-small","icon-cancel"],[1,"form--field-extra-actions"],[3,"textContent","click"],["data-qa-selector","datepicker-start-date",1,"form--field"],["type","text","name","startDate",1,"form--date-field",3,"ngClass","ngModel","disabled","ngModelChange","click"],["class","form--field-inline-action",3,"title","click",4,"ngIf"],[3,"textContent","click",4,"ngIf"],["data-qa-selector","datepicker-end-date",1,"form--field"],["type","text","name","endDate",1,"form--date-field",3,"ngClass","ngModel","disabled","ngModelChange","click"],[1,"op-toast","-info"],[1,"op-toast--content"],[3,"textContent"],["id","flatpickr-input","hidden",""]],template:function(Q,U){1&Q&&(i.TgZ(0,"form",0,1),i.NdJ("submit",function(X){return U.save(X)}),i.TgZ(2,"div",2),i.TgZ(3,"div",3),i.YNc(4,It,10,7,"ng-container",4),i.YNc(5,bt,17,16,"ng-container",4),i.TgZ(6,"div",5),i.TgZ(7,"div",6),i.TgZ(8,"label",7),i.TgZ(9,"div",8),i.TgZ(10,"input",9),i.NdJ("ngModelChange",function(){return U.changeSchedulingMode()}),i.qZA(),i.qZA(),i._uU(11),i.qZA(),i.qZA(),i.qZA(),i.qZA(),i.YNc(12,Rt,5,2,"ng-container",4),i.YNc(13,xt,2,0,"ng-container",4),i.qZA(),i.TgZ(14,"div",10),i.TgZ(15,"button",11),i.NdJ("click",function(){return U.cancel()}),i.qZA(),i._UZ(16,"button",12),i.qZA(),i.qZA()),2&Q&&(i.uIk("id",U.htmlId),i.xp6(4),i.Q6J("ngIf",U.singleDate),i.xp6(1),i.Q6J("ngIf",!U.singleDate),i.xp6(5),i.Q6J("ngModel",U.scheduleManually),i.xp6(1),i.hij(" ",U.text.manualScheduling," "),i.xp6(1),i.Q6J("ngIf",!U.isSchedulable),i.xp6(1),i.Q6J("ngIf",U.isSchedulable),i.xp6(2),i.Q6J("textContent",U.text.cancel),i.xp6(1),i.Q6J("textContent",U.text.save),i.uIk("disabled",!U.isSavable||void 0))},directives:[d._Y,d.JL,d.F,e.O5,d.Wl,d.JJ,d.On,d.Fj,e.mk],styles:[".op-datepicker-modal{position:relative;z-index:500;width:auto;max-width:730px;box-shadow:0 0 5px 2px #00000040;padding:5px 0 0}.op-datepicker-modal .grid-block{align-items:center}.op-datepicker-modal--dates-container{display:grid;grid-template-columns:170px 1fr auto;margin:0 1.5rem}.op-datepicker-modal--dates-container .form--date-field{margin:2px!important}.op-datepicker-modal--dates-container .form--date-field.-current,.op-datepicker-modal--dates-container .form--date-field.-current:hover{outline:2px solid var(--primary-color)}.op-datepicker-modal--dates-container .op-datepicker-modal--scheduling-action-container{margin-top:28px}.op-datepicker-modal--dates-container .op-datepicker-modal--scheduling-action-container .form--label-with-check-box{padding:0}.op-datepicker-modal--dates-container .form--field-inline-action .icon-small:before{vertical-align:text-bottom}.op-datepicker-modal--dates-container .form--field-inline-action:hover,.op-datepicker-modal--dates-container .form--field-inline-action:focus{text-decoration:none}.op-datepicker-modal--actions-container{display:flex;justify-content:flex-end;padding:15px 1.5rem 0;border-top:1px solid #DDDDDD;background:#F8F8F8}.op-datepicker-modal--actions-container .op-datepicker-modal--action[disabled]{color:var(--gray-dark);cursor:not-allowed}.op-datepicker-modal--actions-container .op-datepicker-modal--action[disabled]:hover{text-decoration:none}\n","@media screen and (max-width: 679px){.op-datepicker-modal--dates-container{grid-template-columns:1fr 1fr;grid-template-rows:75px 40px}.op-datepicker-modal--scheduling-action-container{margin:10px 0}}\n"],encapsulation:2,changeDetection:0}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",ee.D)],Mt.prototype,"I18n",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",w.B)],Mt.prototype,"timezoneService",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",vt.l)],Mt.prototype,"halEditing",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",Ue)],Mt.prototype,"datepickerHelper",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",Le.o)],Mt.prototype,"browserDetector",void 0);class wt extends Ie{constructor(){super(...arguments),this.dates="",this.text_no_start_date=this.I18n.t("js.label_no_start_date"),this.text_no_due_date=this.I18n.t("js.label_no_due_date")}ngOnInit(){super.ngOnInit(),this.handler.$onUserActivate.pipe(this.untilDestroyed()).subscribe(()=>{this.showDatePickerModal()})}ngOnDestroy(){var Q;super.ngOnDestroy(),null===(Q=this.modal)||void 0===Q||Q.closeMe()}handleClick(){this.showDatePickerModal()}showDatePickerModal(){const Q=this.modal=this.opModalService.show(Mt,this.injector,{changeset:this.change,fieldName:this.name},!0);setTimeout(()=>{const U=jQuery(Q.elementRef.nativeElement).find(".op-datepicker-modal"),we=jQuery(this.elementRef.nativeElement);Q.reposition(U,we)}),Q.onDataUpdated.subscribe(U=>{this.dates=U,this.cdRef.detectChanges()}),Q.closingEvent.pipe((0,ke.q)(1)).subscribe(()=>{this.handler.handleUserSubmit()})}initialize(){super.initialize(),this.dates=`${this.currentStartDate} - ${this.currentDueDate}`}get currentStartDate(){return this.resource.startDate||this.text_no_start_date}get currentDueDate(){return this.resource.dueDate||this.text_no_due_date}}wt.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(wt)))(U||wt)}}(),wt.\u0275cmp=i.Xpm({type:wt,selectors:[["ng-component"]],features:[i.qOj],decls:1,vars:1,consts:[["type","text",1,"op-input",3,"value","click"]],template:function(Q,U){1&Q&&(i.TgZ(0,"input",0),i.NdJ("click",function(){return U.handleClick()}),i.qZA()),2&Q&&i.Q6J("value",U.dates)},encapsulation:2}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",w.B)],wt.prototype,"timezoneService",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",it.S)],wt.prototype,"opModalService",void 0);var Jt=t(54622),Ze=t(61598);function ve(Te,Q){if(1&Te){const U=i.EpF();i.TgZ(0,"edit-field-controls",4),i.NdJ("onSave",function(){return i.CHM(U),i.oxw().handleUserSubmit()})("onCancel",function(){return i.CHM(U),i.oxw().handler.handleUserCancel()}),i.qZA()}if(2&Te){const U=i.oxw();i.Q6J("fieldController",U.field)("saveTitle",U.text.save)("cancelTitle",U.text.cancel)}}class ne extends L{constructor(){super(...arguments),this.isBusy=!1,this.name="comment"}get required(){return!0}ngOnInit(){super.ngOnInit()}}ne.\u0275fac=function(){let Te;return function(U){return(Te||(Te=i.n5z(ne)))(U||ne)}}(),ne.\u0275cmp=i.Xpm({type:ne,selectors:[["ng-component"]],features:[i.qOj],decls:4,vars:3,consts:[[1,"textarea-wrapper"],[1,"op-ckeditor--wrapper","op-ckeditor-element"],[3,"context","content","onContentChange","onInitializationFailed","onInitialized"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel",4,"ngIf"],[3,"fieldController","saveTitle","cancelTitle","onSave","onCancel"]],template:function(Q,U){1&Q&&(i.TgZ(0,"div",0),i.TgZ(1,"div",1),i.TgZ(2,"op-ckeditor",2),i.NdJ("onContentChange",function(X){return U.onContentChange(X)})("onInitializationFailed",function(){return U.initializationError=!0})("onInitialized",function(X){return U.onCkeditorSetup(X)}),i.qZA(),i.qZA(),i.YNc(3,ve,1,3,"edit-field-controls",3),i.qZA()),2&Q&&(i.xp6(2),i.Q6J("context",U.ckEditorContext)("content",U.initialContent),i.xp6(1),i.Q6J("ngIf",!(U.handler.inEditMode||U.initializationError)))},directives:[ue.F,e.O5,se.e],encapsulation:2}),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",Ee.e)],ne.prototype,"ConfigurationService",void 0);var K=t(23237),de=t(73726),yt=(t(94232),t(86029),t(91923)),St=t(79902),Et=t(53882),je=t(91593);class le extends l.su{constructor(Q,U,we,X,z,V,Qe,Ke,Ct,Nt){super(Q,U,we,X,z,V,Qe),this.I18n=Q,this.elementRef=U,this.change=we,this.schema=X,this.handler=z,this.cdRef=V,this.injector=Qe,this.apiV3Service=Ke,this.http=Ct,this.halResourceService=Nt,this.isNew=(0,ie.Z)(this.resource),this.getOptionsFn=Kt=>this.autocomplete(Kt)}onModelChange(Q){if(Q){const U=Object.assign({},Q),we=this.halResourceService.createHalResourceOfType("project",U);this.value=we}else this.value=null;return this.handler.handleUserSubmit()}autocomplete(Q=""){return(0,b.D)(this.change.getForm()).pipe((0,St.w)(()=>(0,K.rP)(U=>{const we=(0,de.g)(Object.assign(Object.assign({},this.getParams(Q)),U));return this.http.get(`${this.schema.allowedValues.$link.href}${we}`)})))}getParams(Q=""){const U=[["active","=",["t"]]];if(Q&&U.push(["name_and_identifier","~",[Q]]),(0,ie.Z)(this.resource)&&this.change.value("type")){const we=(0,rt.Z)(this.change.value("type").href);U.push(["type_id","=",[we]])}return{filters:U,pageSize:-1,select:["elements/id","elements/identifier","elements/name","elements/self","total","count","pageSize"]}}}le.\u0275fac=function(Q){return new(Q||le)(i.Y36(ee.D),i.Y36(i.SBq),i.Y36(l.Nm),i.Y36(l.Dz),i.Y36(l.uS),i.Y36(i.sBO),i.Y36(i.zs3),i.Y36(ge.T),i.Y36(Et.eN),i.Y36(yt.u))},le.\u0275cmp=i.Xpm({type:le,selectors:[["ng-component"]],viewQuery:function(Q,U){if(1&Q&&i.Gf(G.w9,7),2&Q){let we;i.iGM(we=i.CRH())&&(U.ngSelectComponent=we.first)}},features:[i.qOj],decls:1,vars:5,consts:[["appendTo","body","resource","default",3,"fetchDataDirectly","focusDirectly","openDirectly","getOptionsFn","classes","change"]],template:function(Q,U){1&Q&&(i.TgZ(0,"op-autocompleter",0),i.NdJ("change",function(X){return U.onModelChange(X)}),i.qZA()),2&Q&&i.Q6J("fetchDataDirectly",!0)("focusDirectly",!(U.handler.inEditMode||U.isNew))("openDirectly",!(U.handler.inEditMode||U.isNew))("getOptionsFn",U.getOptionsFn)("classes","inline-edit--field "+U.handler.fieldName)},directives:[je.s],encapsulation:2,changeDetection:0});var pe=t(55741);class De extends pe.C{}class qe extends pe.C{get valueString(){return null==this.value?"":this.value.toLocaleString(this.I18n.locale,{useGrouping:!0,maximumFractionDigits:20})}}class ct extends pe.C{get value(){return parseInt(this.resource[this.name])}isEmpty(){return isNaN(this.value)}}class Tt extends pe.C{get value(){return this.schema?this.attribute&&this.attribute.name:null}}var Pt=t(79644),nt=t(80261);class Pe extends pe.C{render(Q,U,we={}){const X=document.createElement("div");X.classList.add("read-value--html","highlight","op-uc-container","op-uc-container_reduced-headings","-multiline"),we.rtl&&X.classList.add("-rtl"),X.innerHTML=U,Q.innerHTML="",Q.appendChild(X),nt.Z.bootstrapOptionalEmbeddable(this.appRef,X)}get isFormattable(){return!0}get value(){if(!this.schema)return null;const Q=this.resource[this.name];return Q&&Q.html?this.unescape(Q.html):""}unescape(Q){return Q?class{static get UNESCAPED_EXPRESSION(){return"{{"}static get ESCAPED_EXPRESSION(){return"{{ \\$root\\.DOUBLE_LEFT_CURLY_BRACE }}"}static escape(Q){return Q.replace(new RegExp(this.UNESCAPED_EXPRESSION,"g"),this.ESCAPED_EXPRESSION)}static unescape(Q){return Q.replace(new RegExp(this.ESCAPED_EXPRESSION,"g"),this.UNESCAPED_EXPRESSION)}}.unescape(Q):""}}(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",i.z2F)],Pe.prototype,"appRef",void 0);class We extends pe.C{constructor(){super(...arguments),this.derivedText=this.I18n.t("js.label_value_derived_from_children")}get valueString(){return this.timezoneService.formattedDuration(this.value)}get derivedPropertyName(){return`derived${this.name.charAt(0).toUpperCase()}${this.name.slice(1)}`}get derivedValue(){return this.resource[this.derivedPropertyName]}get derivedValueString(){const Q=this.derivedValue;return Q?this.timezoneService.formattedDuration(Q):this.placeholder}render(Q,U){if(this.isEmpty())return void(Q.textContent=this.placeholder);Q.classList.add("split-time-field");const{value:we}=this,X=we&&this.timezoneService.toHours(we)||0;0!==X&&this.renderActual(Q,U);const z=this.derivedValue;z&&0!==this.timezoneService.toHours(z)&&this.renderDerived(Q,this.derivedValueString,0!==X)}renderActual(Q,U){const we=document.createElement("span");we.textContent=U,we.title=this.valueString,we.classList.add("-actual-value"),Q.appendChild(we)}renderDerived(Q,U,we){const X=document.createElement("span");X.setAttribute("title",this.texts.empty),X.textContent=`(${we?"+":""}${U})`,X.title=`${this.derivedValueString} ${this.derivedText}`,X.classList.add("-derived-value"),we&&X.classList.add("-with-actual-value"),Q.appendChild(X)}get title(){return null}isEmpty(){const{value:Q}=this,U=this.derivedValue,we=!Q||0===this.timezoneService.toHours(Q),X=!U||0===this.timezoneService.toHours(U);return we&&X}}(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",w.B)],We.prototype,"timezoneService",void 0);var et=t(63733);class lt extends pe.C{get valueString(){return this.value?this.timezoneService.formattedDatetime(this.value):""}}(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",w.B)],lt.prototype,"timezoneService",void 0);class ft extends pe.C{get valueString(){return this.translatedValue()}get placeholder(){return this.translatedValue()}translatedValue(){return this.value?this.I18n.t("js.general_text_yes"):this.I18n.t("js.general_text_no")}isEmpty(){return!1}}var kt=t(39469);class Ft extends pe.C{constructor(){super(...arguments),this.text={none:this.I18n.t("js.filter.noneElement")}}get value(){return this.resource[this.name]}get title(){return this.isEmpty()?this.text.none:this.value.name}get wpId(){return this.isEmpty()?null:this.value.$loaded?this.value.id:this.value.href.match(/(\d+)$/)[0]}get valueString(){return`#${this.wpId} ${this.title}`}isEmpty(){return!this.value}get unknownAttribute(){return!1}}var qt=t(70233),Xt=t(97973),Ht=t(46709);class ei extends We{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_view_spent_time"),logTime:this.I18n.t("js.button_log_time")}}render(Q,U){if(!this.value)return;const we=document.createElement("a");if(we.textContent=U,we.setAttribute("title",this.text.linkTitle),U===this.placeholder?we.setAttribute("class","time-logging--value time-logging--value_empty"):we.setAttribute("class","time-logging--value"),this.resource.project){const X=this.resource.id.toString();this.apiV3Service.projects.id(this.resource.project).get().subscribe(z=>{const V=Xt(this.PathHelper.projectTimeEntriesPath(z.identifier)).search(`fields[]=WorkPackageId&operators[WorkPackageId]=%3D&values[WorkPackageId]=${X}&set_filter=1`).toString();we.href=V})}Q.innerHTML="",Q.appendChild(we),this.appendTimelogLink(Q)}appendTimelogLink(Q){if(this.timeEntryCreateService&&this.resource.logTime){const U=document.createElement("a");U.setAttribute("class","icon icon-time"),U.setAttribute("href",""),U.setAttribute("title",this.text.logTime),Q.appendChild(U),U.addEventListener("click",this.showTimelogWidget.bind(this,this.resource))}}showTimelogWidget(Q){this.timeEntryCreateService.create(moment(new Date),Q,!1).catch(()=>{})}}(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",qt.j)],ei.prototype,"PathHelper",void 0),(0,m.gn)([(0,P.W)(Ht.f,null),(0,m.w6)("design:type",Ht.f)],ei.prototype,"timeEntryCreateService",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",ge.T)],ei.prototype,"apiV3Service",void 0);class ni extends pe.C{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen")}}get value(){return(0,ie.Z)(this.resource)?null:this.resource[this.name]}render(Q,U){!this.value||(Q.textContent=U)}isEmpty(){return!1}}var oi=t(50076),di=t(69671),Ri=t(80044);class gi extends di.z{render(Q,U){super.render(Q,U),this.shouldHighlight&&this.addHighlight(Q)}get value(){return this.schema?this.attribute&&this.attribute.name:null}addHighlight(Q){if(this.attribute instanceof Ri.X){const U=oi.Z.inlineClass(this.name,this.attribute.id);Q.classList.add(U)}}}class rn extends gi{get shouldHighlight(){return!0}}var fi=t(13964);class pi extends pe.C{get value(){return this.schema?this.attribute&&this.attribute.name:null}render(Q,U){this.placeholder===U?this.renderEmpty(Q):this.principalRenderer.render(Q,this.attribute,{hide:!1,link:!1},{hide:!1,size:"medium"})}}(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",fi.C)],pi.prototype,"principalRenderer",void 0);class Zi extends Pt.L{render(Q,U){const we=this.value;Q.innerHTML="",Q.setAttribute("title",we.join(", ")),0===we.length?this.renderEmpty(Q):this.renderValues(this.attribute,Q)}renderValues(Q,U){const we=document.createDocumentFragment(),X=document.createElement("div");if(X.classList.add(pe.x),we.appendChild(X),this.renderAbridgedValues(X,Q),Q.length>2){const z=document.createElement("span");z.innerHTML="... ",X.appendChild(z);const V=this.optionDiv(Q.length.toString(),"badge","-secondary");we.appendChild(V)}U.appendChild(we)}renderAbridgedValues(Q,U){const we=_.take(U,2);this.principalRenderer.renderMultiple(Q,we,{hide:!1,link:!1},{hide:!1,size:"medium"},!1)}}(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",fi.C)],Zi.prototype,"principalRenderer",void 0);var vi=t(84109),Yt=t(20506);class ui extends ni{constructor(){super(...arguments),this.uiStateBuilder=new Yt.mE(this.$state,this.keepTab)}render(Q,U){if(!this.value)return;const we=this.uiStateBuilder.linkToShow(this.value,U,this.value);Q.appendChild(we)}}(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",A.StateService)],ui.prototype,"$state",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",vi.p)],ui.prototype,"keepTab",void 0);class Hi extends pe.C{render(Q,U){const we=this.value&&this.value.id,X=document.createElement("span");X.classList.add("project-status--bulb",(0,W.p)(we));const z=document.createElement("span");if(z.classList.add("project-status--name",(0,W.p)(we)),z.textContent=(0,W.v)(we,this.I18n),Q.innerHTML="",Q.appendChild(X),Q.appendChild(z),this.writable){const V=document.createElement("span");V.classList.add("project-status--pulldown-icon","icon","icon-pulldown"),Q.appendChild(V)}}}class Ki extends pe.C{get value(){if(!this.schema)return null;const Q=this.resource[this.name];return Q&&Q.raw||""}}class Ui extends Ft{constructor(){super(...arguments),this.text={linkTitle:this.I18n.t("js.work_packages.message_successful_show_in_fullscreen"),none:this.I18n.t("js.filter.noneElement")},this.uiStateBuilder=new Yt.mE(this.$state,this.keepTab)}render(Q,U){if(this.isEmpty())return void(Q.innerText=this.placeholder);const we=this.uiStateBuilder.linkToShow(this.wpId,this.text.linkTitle,this.valueString),X=document.createElement("span");X.textContent=` ${_.truncate(this.title,{length:40})}`,Q.innerHTML="",Q.appendChild(we),Q.appendChild(X)}get writable(){return!1}get valueString(){return`#${this.wpId}`}}(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",A.StateService)],Ui.prototype,"$state",void 0),(0,m.gn)([(0,P.W)(),(0,m.w6)("design:type",vi.p)],Ui.prototype,"keepTab",void 0);var an=t(74215);var si=t(74990);class ki{}ki.\u0275fac=function(Q){return new(Q||ki)},ki.\u0275mod=i.oAB({type:ki}),ki.\u0275inj=i.cJS({imports:[[e.ez]]});class xi{}xi.\u0275fac=function(Q){return new(Q||xi)},xi.\u0275mod=i.oAB({type:xi}),xi.\u0275inj=i.cJS({imports:[[e.ez,d.u5]]});var ln=t(63415);class Ci{}Ci.\u0275fac=function(Q){return new(Q||Ci)},Ci.\u0275mod=i.oAB({type:Ci}),Ci.\u0275inj=i.cJS({imports:[[e.ez,d.u5,ln.J]]});var Mi=t(81496);class ri{}ri.\u0275fac=function(Q){return new(Q||ri)},ri.\u0275mod=i.oAB({type:ri}),ri.\u0275inj=i.cJS({imports:[[e.ez,Mi.I]]});class _i{}_i.\u0275fac=function(Q){return new(Q||_i)},_i.\u0275mod=i.oAB({type:_i}),_i.\u0275inj=i.cJS({imports:[[e.ez,J.wA]]});var yi=t(76315),Ei=t(45755);class ai{}ai.\u0275fac=function(Q){return new(Q||ai)},ai.\u0275mod=i.oAB({type:ai}),ai.\u0275inj=i.cJS({providers:[{provide:i.ip1,useFactory:function(Te,Q){return()=>{Te.defaultFieldType="text",Te.addFieldType(C,"text",["String"]).addFieldType(y,"integer",["Integer"]).addFieldType(x,"duration",["Duration"]).addFieldType(le,"project",["Project"]).addFieldType(te,"select",["Priority","Status","Type","User","Version","TimeEntriesActivity","Category","CustomOption"]).addFieldType(ae,"multi-select",["[]CustomOption","[]User"]).addFieldType(re,"float",["Float"]).addFieldType(ot,"workPackage",["WorkPackage"]).addFieldType(ye,"boolean",["Boolean"]).addFieldType(Ie,"date",["Date"]).addFieldType(L,"wiki-textarea",["Formattable"]).addFieldType(ne,"_comment",["comment"]),Te.addSpecificFieldType("WorkPackage",wt,"date",["combinedDate","startDate","dueDate","date"]).addSpecificFieldType("Project",$,"status",["status"]).addSpecificFieldType("TimeEntry",Xe,"comment",["comment"]).addSpecificFieldType("TimeEntry",$e,"workPackage",["WorkPackage"]),Q.register(Jt.y,"Version"),Q.register(Ze.e,"WorkPackage")}},deps:[a.h,k],multi:!0},{provide:i.ip1,useFactory:function(Te){return()=>{Te.defaultFieldType="text",Te.addFieldType(De,"text",["String"]).addFieldType(qe,"float",["Float"]).addFieldType(ct,"integer",["Integer"]).addFieldType(gi,"highlight",["Status","Priority"]).addFieldType(rn,"type",["Type"]).addFieldType(Tt,"resource",["Project","TimeEntriesActivity","Version","Category","CustomOption"]).addFieldType(Pt.L,"resources",["[]CustomOption"]).addFieldType(Zi,"users",["[]User"]).addFieldType(Pe,"formattable",["Formattable"]).addFieldType(We,"duration",["Duration"]).addFieldType(et.C,"date",["Date"]).addFieldType(lt,"datetime",["DateTime"]).addFieldType(ft,"boolean",["Boolean"]).addFieldType(kt.N,"progress",["percentageDone"]).addFieldType(Ui,"work_package",["WorkPackage"]).addFieldType(ni,"id",["id"]).addFieldType(pi,"user",["User"]),Te.addSpecificFieldType("WorkPackage",ui,"id",["id"]).addSpecificFieldType("WorkPackage",ei,"spentTime",["spentTime"]).addSpecificFieldType("WorkPackage",an.Z,"combinedDate",["combinedDate"]).addSpecificFieldType("TimeEntry",Ki,"comment",["comment"]).addSpecificFieldType("Project",Hi,"status",["status"]).addSpecificFieldType("TimeEntry",Ft,"work_package",["workPackage"])}},deps:[p.i],multi:!0}],imports:[[e.ez,n.H,r.Z,u.$,c.K,si.C,h.a,ki,xi,Ci,ri,_i,yi.s,Ei.i]]})},22784:(H,D,t)=>{"use strict";t.d(D,{X:()=>g});var i=t(1707),e=t(2316),c=t(54364),u=t(83845);function r(C,y){1&C&&(e.TgZ(0,"span",11),e._uU(1,"Invalid"),e.qZA())}function n(C,y){1&C&&(e.TgZ(0,"span",12),e._uU(1,"*"),e.qZA())}function h(C,y){if(1&C&&(e.TgZ(0,"div",7),e.YNc(1,r,2,0,"span",8),e._uU(2),e.YNc(3,n,2,0,"span",9),e._UZ(4,"attribute-help-text",10),e.qZA()),2&C){const m=e.oxw(2);e.xp6(1),e.Q6J("ngIf",m.showErrorMessage),e.xp6(1),e.hij(" ",m.label," "),e.xp6(1),e.Q6J("ngIf",m.required),e.xp6(1),e.Q6J("attribute",m.helpTextAttribute)("attributeScope",m.helpTextAttributeScope)}}function a(C,y){if(1&C&&(e.TgZ(0,"div",13),e.Hsn(1,3),e.qZA()),2&C){const m=e.oxw(2);e.Q6J("id",m.errorsID)}}function p(C,y){if(1&C&&(e.ynx(0),e.TgZ(1,"label",1),e.TgZ(2,"div",2),e.Hsn(3),e.qZA(),e.YNc(4,h,5,5,"div",3),e.TgZ(5,"div",4),e.Hsn(6,1),e.qZA(),e.qZA(),e.TgZ(7,"div",5),e.Hsn(8,2),e.qZA(),e.YNc(9,a,2,1,"div",6),e.BQk()),2&C){const m=e.oxw();e.xp6(2),e.uIk("aria-describedby",m.describedByID),e.xp6(2),e.Q6J("ngIf",m.label),e.xp6(1),e.Q6J("id",m.descriptionID),e.xp6(4),e.Q6J("ngIf",m.showErrorMessage)}}const l=[[["","slot","input"]],[["","slot","description"]],[["","slot","help-text"]],[["","slot","errors"]]];class g{constructor(y){this.formGroupDirective=y,this.className=!0,this.classNameCheckbox=!0,this.label="",this.hidden=!1,this.required=!1,this.showValidationErrorOn="submit",this.internalID="op-checkbox-field-"+ +new Date}get errorClassName(){return this.showErrorMessage}get errorsID(){return`${this.internalID}-errors`}get descriptionID(){return`${this.internalID}-description`}get describedByID(){return this.showErrorMessage?this.errorsID:this.descriptionID}get formControl(){var y;return(null===(y=this.ngControl)||void 0===y?void 0:y.control)||this.control}get showErrorMessage(){var y;return!!this.formControl&&("submit"===this.showValidationErrorOn?this.formControl.invalid&&(null===(y=this.formGroupDirective)||void 0===y?void 0:y.submitted):"blur"===this.showValidationErrorOn?this.formControl.invalid&&this.formControl.touched:"change"===this.showValidationErrorOn&&(this.formControl.invalid&&this.formControl.dirty))}}g.\u0275fac=function(y){return new(y||g)(e.Y36(i.sg,8))},g.\u0275cmp=e.Xpm({type:g,selectors:[["op-checkbox-field"]],contentQueries:function(y,m,E){if(1&y&&e.Suo(E,i.a5,5),2&y){let P;e.iGM(P=e.CRH())&&(m.ngControl=P.first)}},hostVars:6,hostBindings:function(y,m){2&y&&e.ekj("op-form-field",m.className)("op-checkbox-field",m.classNameCheckbox)("op-form-field_invalid",m.errorClassName)},inputs:{label:"label",hidden:"hidden",required:"required",showValidationErrorOn:"showValidationErrorOn",control:"control",helpTextAttribute:"helpTextAttribute",helpTextAttributeScope:"helpTextAttributeScope"},ngContentSelectors:["[slot=input]","[slot=description]","[slot=help-text]","[slot=errors]"],decls:1,vars:1,consts:[[4,"ngIf"],[1,"op-form-field--label-wrap","op-checkbox-field--label-wrap"],[1,"op-form-field--input","op-checkbox-field--input"],["class","op-form-field--label op-checkbox-field--label",4,"ngIf"],[1,"op-form-field--description","op-checkbox-field--description",3,"id"],[1,"op-form-field--help-text"],["class","op-form-field--errors",3,"id",4,"ngIf"],[1,"op-form-field--label","op-checkbox-field--label"],["class","Hidden for sighted",4,"ngIf"],["class","op-form-field--label-indicator",4,"ngIf"],[3,"attribute","attributeScope"],[1,"Hidden","for","sighted"],[1,"op-form-field--label-indicator"],[1,"op-form-field--errors",3,"id"]],template:function(y,m){1&y&&(e.F$t(l),e.YNc(0,p,10,4,"ng-container",0)),2&y&&e.Q6J("ngIf",!m.hidden)},directives:[c.O5,u.y],encapsulation:2})},18252:(H,D,t)=>{"use strict";t.d(D,{V:()=>E});var i=t(1707),e=t(2316),c=t(54364),u=t(83845);function r(P,w){1&P&&(e.TgZ(0,"span",9),e._uU(1,"Invalid"),e.qZA())}function n(P,w){1&P&&(e.TgZ(0,"span",10),e._uU(1,"*"),e.qZA())}function h(P,w){1&P&&e.GkF(0)}function a(P,w){if(1&P&&(e.ynx(0),e.YNc(1,h,1,0,"ng-container",11),e.BQk()),2&P){e.oxw(2);const x=e.MAs(2);e.xp6(1),e.Q6J("ngTemplateOutlet",x)}}function p(P,w){1&P&&e.GkF(0)}function l(P,w){if(1&P&&(e.ynx(0),e.YNc(1,p,1,0,"ng-container",11),e.BQk()),2&P){e.oxw(2);const x=e.MAs(2);e.xp6(1),e.Q6J("ngTemplateOutlet",x)}}function d(P,w){if(1&P&&(e.TgZ(0,"div",12),e.Hsn(1,1),e.qZA()),2&P){const x=e.oxw(2);e.Q6J("id",x.errorsID)}}function g(P,w){if(1&P&&(e.ynx(0),e.TgZ(1,"label",2),e.TgZ(2,"div",3),e.YNc(3,r,2,0,"span",4),e._uU(4),e.YNc(5,n,2,0,"span",5),e._UZ(6,"attribute-help-text",6),e.qZA(),e.YNc(7,a,2,1,"ng-container",0),e.qZA(),e.YNc(8,l,2,1,"ng-container",0),e.TgZ(9,"div",7),e.Hsn(10),e.qZA(),e.YNc(11,d,2,1,"div",8),e.BQk()),2&P){const x=e.oxw();e.xp6(3),e.Q6J("ngIf",x.showErrorMessage),e.xp6(1),e.hij(" ",x.label," "),e.xp6(1),e.Q6J("ngIf",x.required),e.xp6(1),e.Q6J("attribute",x.helpTextAttribute)("attributeScope",x.helpTextAttributeScope),e.xp6(1),e.Q6J("ngIf",!x.noWrapLabel),e.xp6(1),e.Q6J("ngIf",x.noWrapLabel),e.xp6(3),e.Q6J("ngIf",x.showErrorMessage)}}function C(P,w){if(1&P&&(e.TgZ(0,"div",13),e.Hsn(1,2),e.qZA(),e.TgZ(2,"div",14),e.Hsn(3,3),e.qZA()),2&P){const x=e.oxw();e.Q6J("id",x.descriptionID),e.xp6(2),e.uIk("aria-describedby",x.describedByID)}}const y=[[["","slot","help-text"]],[["","slot","errors"]],[["","slot","description"]],[["","slot","input"]]];class E{constructor(w){this._formGroupDirective=w,this.className=!0,this.label="",this.noWrapLabel=!1,this.required=!1,this.hidden=!1,this.showValidationErrorOn="submit",this.internalID="op-form-field-"+ +new Date}get errorClassName(){return this.showErrorMessage}get errorsID(){return`${this.internalID}-errors`}get descriptionID(){return`${this.internalID}-description`}get describedByID(){return this.showErrorMessage?this.errorsID:this.descriptionID}get formControl(){var w;return(null===(w=this.ngControl)||void 0===w?void 0:w.control)||this.control}get showErrorMessage(){var w;return!!this.formControl&&("submit"===this.showValidationErrorOn?this.formControl.invalid&&(null===(w=this._formGroupDirective)||void 0===w?void 0:w.submitted):"blur"===this.showValidationErrorOn?this.formControl.invalid&&this.formControl.touched:"change"===this.showValidationErrorOn&&(this.formControl.invalid&&this.formControl.dirty))}}E.\u0275fac=function(w){return new(w||E)(e.Y36(i.sg,8))},E.\u0275cmp=e.Xpm({type:E,selectors:[["op-form-field"]],contentQueries:function(w,x,k){if(1&w&&e.Suo(k,i.a5,5),2&w){let b;e.iGM(b=e.CRH())&&(x.ngControl=b.first)}},hostVars:4,hostBindings:function(w,x){2&w&&e.ekj("op-form-field",x.className)("op-form-field_invalid",x.errorClassName)},inputs:{label:"label",noWrapLabel:"noWrapLabel",required:"required",hidden:"hidden",showValidationErrorOn:"showValidationErrorOn",control:"control",helpTextAttribute:"helpTextAttribute",helpTextAttributeScope:"helpTextAttributeScope"},ngContentSelectors:["[slot=help-text]","[slot=errors]","[slot=description]","[slot=input]"],decls:3,vars:1,consts:[[4,"ngIf"],["inputTemplate",""],[1,"op-form-field--label-wrap"],[1,"op-form-field--label"],["class","Hidden for sighted",4,"ngIf"],["class","op-form-field--label-indicator",4,"ngIf"],[3,"attribute","attributeScope"],[1,"op-form-field--help-text"],["class","op-form-field--errors",3,"id",4,"ngIf"],[1,"Hidden","for","sighted"],[1,"op-form-field--label-indicator"],[4,"ngTemplateOutlet"],[1,"op-form-field--errors",3,"id"],[1,"op-form-field--description",3,"id"],[1,"op-form-field--input"]],template:function(w,x){1&w&&(e.F$t(y),e.YNc(0,g,12,8,"ng-container",0),e.YNc(1,C,4,2,"ng-template",null,1,e.W1O)),2&w&&e.Q6J("ngIf",!x.hidden)},directives:[c.O5,u.y,c.tP],encapsulation:2})},49369:(H,D,t)=>{"use strict";t.d(D,{_:()=>h});var i=t(2316),c=(t(75421),t(96617)),u=t(94232);class r extends u.W{}var n=t(26942);class h extends n.N{constructor(p,l){super(),this.i18n=p,this.injector=l,this.resourceChanged=new i.vpe}get widgetName(){var p,l;const d=null===(p=this.resource)||void 0===p?void 0:p.options.name,g=null===(l=this.resource)||void 0===l?void 0:l.identifier;return this.isEditable?d:this.i18n.t(`js.grid.widgets.${g}.title`,{defaultValue:d})}renameWidget(p){const l=this.setChangesetOptions({name:p});this.resourceChanged.emit(l)}get isEditable(){return!0}setChangesetOptions(p){const l=new r(this.resource);return l.setValue("options",Object.assign(Object.assign({},this.resource.options),p)),l}}h.\u0275fac=function(p){return new(p||h)(i.Y36(c.D),i.Y36(i.zs3))},h.\u0275dir=i.lG2({type:h,hostVars:8,hostBindings:function(p,l){2&p&&i.Udp("grid-column-start",l.gridColumnStart)("grid-column-end",l.gridColumnEnd)("grid-row-start",l.gridRowStart)("grid-row-end",l.gridRowEnd)},inputs:{resource:"resource"},outputs:{resourceChanged:"resourceChanged"},features:[i.qOj]})},2775:(H,D,t)=>{"use strict";t.d(D,{o:()=>u});var i=t(2316),e=t(54364);function c(r,n){if(1&r&&i._UZ(0,"span",2),2&r){const h=i.oxw();i.Q6J("textContent",h.iconTitle)}}class u{constructor(){this.iconTitle=""}}u.\u0275fac=function(n){return new(n||u)},u.\u0275cmp=i.Xpm({type:u,selectors:[["op-icon"]],hostAttrs:[1,"op-icon--wrapper"],inputs:{iconClasses:["icon-classes","iconClasses"],iconTitle:["icon-title","iconTitle"]},decls:2,vars:3,consts:[["aria-hidden","true",3,"ngClass","title"],["class","hidden-for-sighted",3,"textContent",4,"ngIf"],[1,"hidden-for-sighted",3,"textContent"]],template:function(n,h){1&n&&(i._UZ(0,"i",0),i.YNc(1,c,1,1,"span",1)),2&n&&(i.Q6J("ngClass",h.iconClasses)("title",h.iconTitle),i.xp6(1),i.Q6J("ngIf",h.iconTitle))},directives:[e.mk,e.O5],encapsulation:2})},53875:(H,D,t)=>{"use strict";t.d(D,{Q:()=>c});var i=t(54364),e=t(2316);class c{}c.\u0275fac=function(r){return new(r||c)},c.\u0275mod=e.oAB({type:c}),c.\u0275inj=e.cJS({providers:[],imports:[[i.ez]]})},52932:(H,D,t)=>{"use strict";t.d(D,{g:()=>h});var i=t(2316),e=t(96617),c=t(54364),u=t(2775);function r(a,p){if(1&a&&i._UZ(0,"op-icon",4),2&a){const l=i.oxw();i.MGl("icon-classes","",l.icon," icon-context")}}class h{constructor(p){this.I18n=p,this.className=!0,this.icon="",this.close=new i.vpe,this.text={closePopup:this.I18n.t("js.close_popup_title")}}}h.\u0275fac=function(p){return new(p||h)(i.Y36(e.D))},h.\u0275cmp=i.Xpm({type:h,selectors:[["op-modal-header"]],hostVars:2,hostBindings:function(p,l){2&p&&i.ekj("op-modal--header",l.className)},inputs:{icon:"icon"},outputs:{close:"close"},ngContentSelectors:["*"],decls:5,vars:2,consts:[[3,"icon-classes",4,"ngIf"],[1,"op-modal--title"],["type","button","data-qa-selector","op-modal-close",1,"op-modal--close-button",3,"click"],["icon-classes","icon-close"],[3,"icon-classes"]],template:function(p,l){1&p&&(i.F$t(),i.YNc(0,r,1,1,"op-icon",0),i.TgZ(1,"h1",1),i.Hsn(2),i.qZA(),i.TgZ(3,"button",2),i.NdJ("click",function(){return l.close.emit()}),i._UZ(4,"op-icon",3),i.qZA()),2&p&&(i.Q6J("ngIf",l.icon),i.xp6(3),i.uIk("aria-label",l.text.closePopup))},directives:[c.O5,u.o],encapsulation:2})},55280:(H,D,t)=>{"use strict";t.d(D,{v:()=>n});var i=t(54364),e=t(77355),c=t(58057),u=t(2316);class n{constructor(a,p,l){this.documentElement=a,this.injector=p,this.opModalService=l}setupListener(){const a=this.documentElement.querySelectorAll("[data-augmented-model-wrapper]");for(let p=0;p<a.length;++p)this.wrapElement(jQuery(a[p]))}wrapElement(a){const p=a.data("activationSelector")||".modal-delivery-element--activation-link",l=jQuery(p);a.data("modalInitializeNow")?this.show(a):l.click(g=>{this.show(a),g.preventDefault()})}show(a){const p=a.data("modalClassName"),l=a.data("modalIframeUrl"),d=a.find(".modal-delivery-element");let g=d.html();l&&(g=this.appendIframe(d,l)),this.opModalService.show(c.T,this.injector,{modalBody:g,modalClassName:p})}appendIframe(a,p){const l=jQuery('<iframe frameborder="0" height="400" allowfullscreen>></iframe>');return l.attr("src",p),a.find(".iframe-target-wrapper").append(l),a.html()}}n.\u0275fac=function(a){return new(a||n)(u.LFG(i.K0),u.LFG(u.zs3),u.LFG(e.S))},n.\u0275prov=u.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})},60312:(H,D,t)=>{"use strict";t.d(D,{T:()=>c});var i=t(2316),e=t(26942);class c extends e.N{constructor(r,n,h){super(),this.locals=r,this.cdRef=n,this.elementRef=h,this.closeOnEscape=!0,this.closeOnEscapeFunction=this.closeMe,this.closeOnOutsideClick=!0,this.service=this.locals.service,this.closingEvent=new i.vpe,this.openingEvent=new i.vpe}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement)}ngOnDestroy(){this.closingEvent.complete(),this.openingEvent.complete()}onClose(){return this.afterFocusOn&&this.afterFocusOn.focus(),!0}closeMe(r){this.service.close(),r&&(r.stopPropagation(),r.preventDefault())}onOpen(r){this.openingEvent.emit(),this.cdRef.detectChanges()}get afterFocusOn(){return this.$element}}c.\u0275fac=function(r){i.$Z()},c.\u0275dir=i.lG2({type:c,features:[i.qOj]})},55811:(H,D,t)=>{"use strict";t.d(D,{K:()=>h});var i=t(54364),e=t(63415),c=t(53875),u=t(77355),r=t(55280),n=t(2316);class h{}h.\u0275fac=function(p){return new(p||h)},h.\u0275mod=n.oAB({type:h}),h.\u0275inj=n.cJS({providers:[u.S,r.v],imports:[[i.ez,e.J,c.Q]]})},77355:(H,D,t)=>{"use strict";t.d(D,{E:()=>n,S:()=>h});var i=t(2316),e=t(40912),c=t(47775),u=t(7101),r=t(33406);const n=new i.OlP("OP_MODAL_LOCALS");class h{constructor(p,l,d,g,C){this.componentFactoryResolver=p,this.FocusHelper=l,this.appRef=d,this.$transitions=g,this.injector=C,this.active=null,this.opening=!1;const y=this.portalHostElement=document.createElement("div");y.classList.add("op-modal-overlay"),document.body.appendChild(y),jQuery(window).on("keydown",m=>(this.active&&this.active.closeOnEscape&&m.which===r.m.ESCAPE&&this.active.closeOnEscapeFunction(m),!0)),jQuery(window).on("click",m=>{this.active&&!this.opening&&this.active.closeOnOutsideClick&&this.activeModal[0]===m.target&&this.close()}),this.bodyPortalHost=new e.u0(y,this.componentFactoryResolver,this.appRef,this.injector)}show(p,l,d={},g=!1){this.close(),this.opening=!0,"global"===l&&(l=this.injector);const C=new e.C5(p,null,this.injectorFor(l,d)),y=this.bodyPortalHost.attach(C),m=y.instance;return this.active=m,this.portalHostElement.classList.add("op-modal-overlay_active"),g&&this.portalHostElement.classList.add("op-modal-overlay_not-full-screen"),setTimeout(()=>{this.active&&this.active.onOpen(this.activeModal),this.opening=!1,y.changeDetectorRef.detectChanges()},20),this.active}isActive(p){return this.active&&this.active===p}close(){this.active&&this.active.onClose()&&(this.active.closingEvent.emit(this.active),this.bodyPortalHost.detach(),this.portalHostElement.classList.remove("op-modal-overlay_active"),this.portalHostElement.classList.remove("op-modal-overlay_not-full-screen"),this.active=null)}get activeModal(){return jQuery(this.portalHostElement).find(".op-modal")}injectorFor(p,l){const d=new WeakMap;return l.service=this,d.set(n,l),new e.nK(p,d)}}h.\u0275fac=function(p){return new(p||h)(i.LFG(i._Vd),i.LFG(u.i),i.LFG(i.z2F),i.LFG(c.TransitionService),i.LFG(i.zs3))},h.\u0275prov=i.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})},298:(H,D,t)=>{"use strict";t.d(D,{j:()=>p});var i=t(60312),e=t(77355),c=t(96617),u=t(2316),r=t(54364),n=t(52932);function h(l,d){if(1&l&&(u.TgZ(0,"span"),u._UZ(1,"br"),u.TgZ(2,"strong"),u._uU(3),u.qZA(),u.qZA()),2&l){const g=d.$implicit;u.xp6(3),u.Oqu(g)}}const a=function(l){return{"-highlight -danger-zone":l}};class p extends i.T{constructor(d,g,C,y){super(g,C,d),this.elementRef=d,this.locals=g,this.cdRef=C,this.I18n=y,this.confirmed=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text"),button_continue:this.I18n.t("js.button_continue"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.options=g.options||{},this.dangerHighlighting=_.defaultTo(this.options.dangerHighlighting,!1),this.passedData=_.defaultTo(this.options.passedData,[]),this.closeOnEscape=_.defaultTo(this.options.closeByEscape,!0),this.closeOnOutsideClick=_.defaultTo(this.options.closeByDocument,!0),this.showClose=_.defaultTo(this.options.showClose,!0),this.text=_.defaults(this.options.text,this.text)}confirmAndClose(d){this.confirmed=!0,this.closeMe(d)}}p.\u0275fac=function(d){return new(d||p)(u.Y36(u.SBq),u.Y36(e.E),u.Y36(u.sBO),u.Y36(c.D))},p.\u0275cmp=u.Xpm({type:p,selectors:[["ng-component"]],features:[u.qOj],decls:11,vars:9,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_autoheight","confirm-form-submit--modal","loading-indicator--location",3,"ngClass"],[3,"close"],[1,"op-modal--body"],[3,"textContent"],[4,"ngFor","ngForOf"],[1,"op-modal--footer"],[1,"confirm-form-submit--continue","button",3,"ngClass","textContent","click"],[1,"confirm-form-submit--cancel","button",3,"textContent","click"]],template:function(d,g){1&d&&(u.TgZ(0,"div",0),u.TgZ(1,"op-modal-header",1),u.NdJ("close",function(y){return g.closeMe(y)}),u._uU(2),u.qZA(),u.TgZ(3,"div",2),u.TgZ(4,"p"),u._UZ(5,"span",3),u._UZ(6,"br"),u.YNc(7,h,4,1,"span",4),u.qZA(),u.qZA(),u.TgZ(8,"div",5),u.TgZ(9,"button",6),u.NdJ("click",function(y){return g.confirmAndClose(y)}),u.qZA(),u.TgZ(10,"button",7),u.NdJ("click",function(y){return g.closeMe(y)}),u.qZA(),u.qZA(),u.qZA()),2&d&&(u.Q6J("ngClass",u.VKq(7,a,g.dangerHighlighting)),u.xp6(2),u.Oqu(g.text.title),u.xp6(3),u.Q6J("textContent",g.text.text),u.xp6(2),u.Q6J("ngForOf",g.passedData),u.xp6(2),u.Q6J("ngClass",g.dangerHighlighting?"-danger":"-highlight")("textContent",g.text.button_continue),u.xp6(1),u.Q6J("textContent",g.text.button_cancel))},directives:[r.mk,n.g,r.sg],encapsulation:2})},84335:(H,D,t)=>{"use strict";t.d(D,{D:()=>u});var i=t(298),e=t(77355),c=t(2316);class u{constructor(n,h){this.opModalService=n,this.injector=h}confirm(n){return new Promise((h,a)=>{this.opModalService.show(i.j,this.injector,{options:n}).closingEvent.subscribe(l=>{l.confirmed?h():a()})})}}u.\u0275fac=function(n){return new(n||u)(c.LFG(e.S),c.LFG(c.zs3))},u.\u0275prov=c.Yz7({token:u,factory:u.\u0275fac})},82170:(H,D,t)=>{"use strict";t.d(D,{f:()=>x});var i=t(77355),e=t(60312),c=t(96617),u=t(65146),r=t(20979),n=t(2316),h=t(1707),a=t(52932),p=t(54364);const l=["typeSelect"];function d(k,b){if(1&k&&n._UZ(0,"option",11),2&k){const v=b.$implicit,M=n.oxw();n.Q6J("textContent",v.name)("selected",M.selectedType===v.name)("value",v.name)}}class g extends e.T{constructor(b,v,M,S,O,A){super(v,O,b),this.elementRef=b,this.locals=v,this.currentProject=M,this.apiV3Service=S,this.cdRef=O,this.I18n=A,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.type="",this.classes="",this.text={title:this.I18n.t("js.editor.macro.work_package_button.button"),none:this.I18n.t("js.label_none"),selected_type:this.I18n.t("js.editor.macro.work_package_button.type"),button_style:this.I18n.t("js.editor.macro.work_package_button.button_style"),button_style_hint:this.I18n.t("js.editor.macro.work_package_button.button_style_hint"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedType=this.type=this.locals.type,this.classes=this.locals.classes,this.buttonStyle="button"===this.classes,this.apiV3Service.withOptionalProject(this.currentProject.identifier).work_packages.form.post({}).subscribe(F=>{this.availableTypes=F.schema.type.allowedValues})}applyAndClose(b){this.changed=!0,this.classes=this.buttonStyle?"button":"",this.type=this.selectedType,this.closeMe(b)}ngAfterViewInit(){this.typeSelect.nativeElement.focus()}}g.\u0275fac=function(b){return new(b||g)(n.Y36(n.SBq),n.Y36(i.E),n.Y36(u.R),n.Y36(r.T),n.Y36(n.sBO),n.Y36(c.D))},g.\u0275cmp=n.Xpm({type:g,selectors:[["ng-component"]],viewQuery:function(b,v){if(1&b&&n.Gf(l,7),2&b){let M;n.iGM(M=n.CRH())&&(v.typeSelect=M.first)}},features:[n.qOj],decls:24,vars:11,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_autoheight","loading-indicator--location",3,"submit"],[3,"close"],[1,"op-modal--body","form"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-type",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["id","selected-type","tabindex","1","name","selected-type",1,"form--select",3,"change"],["typeSelect",""],[3,"textContent","selected","value"],[3,"textContent","selected","value",4,"ngFor","ngForOf"],[1,"form--field","-wide-label"],[1,"form--field-container","-vertical"],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["type","checkbox","tabindex","2","id","wp_button_macro_style","name","button_style",3,"checked","change"],[1,"op-modal--footer"],["tabindex","4","type","button",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent"]],template:function(b,v){1&b&&(n.TgZ(0,"form",0),n.NdJ("submit",function(S){return v.applyAndClose(S)}),n.TgZ(1,"op-modal-header",1),n.NdJ("close",function(S){return v.closeMe(S)}),n._uU(2),n.qZA(),n.TgZ(3,"div",2),n.TgZ(4,"fieldset",3),n._UZ(5,"legend",4),n.TgZ(6,"div",5),n._UZ(7,"label",6),n.TgZ(8,"div",7),n.TgZ(9,"div",8),n.TgZ(10,"select",9,10),n.NdJ("change",function(S){return v.selectedType=S.target.value}),n._UZ(12,"option",11),n.YNc(13,d,1,3,"option",12),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(14,"div",13),n.TgZ(15,"div",14),n.TgZ(16,"label",15),n.TgZ(17,"div",16),n.TgZ(18,"input",17),n.NdJ("change",function(S){return v.buttonStyle=S.target.checked}),n.qZA(),n.qZA(),n._uU(19),n.qZA(),n.qZA(),n.qZA(),n._UZ(20,"p",4),n.qZA(),n.TgZ(21,"div",18),n.TgZ(22,"button",19),n.NdJ("click",function(S){return v.closeMe(S)}),n.qZA(),n._UZ(23,"button",20),n.qZA(),n.qZA()),2&b&&(n.xp6(2),n.Oqu(v.text.title),n.xp6(3),n.Q6J("textContent",v.text.selected_type),n.xp6(2),n.Q6J("textContent",v.text.selected_type),n.xp6(5),n.Q6J("textContent",v.text.none)("selected",!v.selectedType),n.xp6(1),n.Q6J("ngForOf",v.availableTypes),n.xp6(5),n.Q6J("checked",v.buttonStyle),n.xp6(1),n.hij(" ",v.text.button_style," "),n.xp6(1),n.Q6J("textContent",v.text.button_style_hint),n.xp6(2),n.Q6J("textContent",v.text.button_cancel),n.xp6(1),n.Q6J("textContent",v.text.button_save))},directives:[h._Y,h.JL,h.F,a.g,h.YN,h.Kr,p.sg],encapsulation:2});const C=["selectedPageInput"];class y extends e.T{constructor(b,v,M,S){super(v,M,b),this.elementRef=b,this.locals=v,this.cdRef=M,this.I18n=S,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.page="",this.text={title:this.I18n.t("js.editor.macro.wiki_page_include.button"),hint:this.I18n.t("js.editor.macro.wiki_page_include.hint"),page:this.I18n.t("js.editor.macro.wiki_page_include.page"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedPage=this.page=this.locals.page}applyAndClose(b){this.changed=!0,this.page=this.selectedPage,this.closeMe(b)}ngAfterViewInit(){this.selectedPageInput.nativeElement.focus()}}y.\u0275fac=function(b){return new(b||y)(n.Y36(n.SBq),n.Y36(i.E),n.Y36(n.sBO),n.Y36(c.D))},y.\u0275cmp=n.Xpm({type:y,selectors:[["ng-component"]],viewQuery:function(b,v){if(1&b&&n.Gf(C,7),2&b){let M;n.iGM(M=n.CRH())&&(v.selectedPageInput=M.first)}},features:[n.qOj],decls:19,vars:9,consts:[[1,"op-modal",3,"submit"],[3,"close"],[1,"op-modal--body"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-page",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-page","name","selected-page",1,"form--select",3,"value","change"],["selectedPageInput",""],[1,"op-modal--footer"],["tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent","click"]],template:function(b,v){1&b&&(n.TgZ(0,"form",0),n.NdJ("submit",function(S){return v.applyAndClose(S)}),n.TgZ(1,"op-modal-header",1),n.NdJ("close",function(S){return v.closeMe(S)}),n._uU(2),n.qZA(),n.TgZ(3,"div",2),n.TgZ(4,"fieldset",3),n._UZ(5,"legend",4),n.TgZ(6,"div",5),n._UZ(7,"label",6),n.TgZ(8,"div",7),n.TgZ(9,"div",8),n.TgZ(10,"input",9,10),n.NdJ("change",function(S){return v.selectedPage=S.target.value}),n.qZA(),n.qZA(),n.qZA(),n._UZ(12,"p",4),n.TgZ(13,"p"),n.TgZ(14,"kbd"),n._uU(15,"project-identifier:my-wiki-page"),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(16,"div",11),n.TgZ(17,"button",12),n.NdJ("click",function(S){return v.closeMe(S)}),n.qZA(),n.TgZ(18,"button",13),n.NdJ("click",function(S){return v.applyAndClose(S)}),n.qZA(),n.qZA(),n.qZA()),2&b&&(n.xp6(2),n.Oqu(v.text.title),n.xp6(3),n.Q6J("textContent",v.text.page),n.xp6(2),n.Q6J("textContent",v.text.page),n.xp6(3),n.Q6J("value",v.selectedPage),n.xp6(2),n.Q6J("textContent",v.text.hint),n.xp6(5),n.Q6J("textContent",v.text.button_cancel),n.uIk("title",v.text.button_cancel),n.xp6(1),n.Q6J("textContent",v.text.button_save),n.uIk("title",v.text.button_save))},directives:[h._Y,h.JL,h.F,a.g],encapsulation:2});const m=["codeMirrorPane"];class E extends e.T{constructor(b,v,M,S){super(v,M,b),this.elementRef=b,this.locals=v,this.cdRef=M,this.I18n=S,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this._language="",this.debouncedLanguageLoader=_.debounce(()=>this.loadLanguageAsMode(this.language),300),this.text={title:this.I18n.t("js.editor.macro.code_block.title"),language:this.I18n.t("js.editor.macro.code_block.language"),language_hint:this.I18n.t("js.editor.macro.code_block.language_hint"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.languageClass=v.languageClass||"language-text",this.content=v.content;const O=/language-(\w+)/.exec(this.languageClass);this.language=O?O[1]:"text"}applyAndClose(b){this.content=this.codeMirrorInstance.getValue();const v=this.language||"text";this.languageClass=`language-${v}`,this.changed=!0,this.closeMe(b)}ngAfterViewInit(){t.e("default-node_modules_codemirror_lib_codemirror_js").then(t.t.bind(t,21302,23)).then(b=>{const v=b.default;this.codeMirrorInstance=v.fromTextArea(this.codeMirrorPane.nativeElement,{lineNumbers:!0,smartIndent:!0,autofocus:!0,value:this.content,mode:""})})}get language(){return this._language}set language(b){this._language=b,this.debouncedLanguageLoader()}loadLanguageAsMode(b){if(!b||"text"===b)return this.updateCodeMirrorMode("");t(30341)(`./${b}/${b}.js`).then(()=>{this.updateCodeMirrorMode(b)}).catch(v=>{console.error(`Failed to load language ${b}: ${v}`),this.updateCodeMirrorMode("")})}updateCodeMirrorMode(b){const v=this.codeMirrorInstance;v&&v.setOption("mode",b)}updateLanguage(b){b?/^\w+$/.exec(b)?this.language=b:console.error(`Not updating non-matching language: ${b}`):this.language=""}}E.\u0275fac=function(b){return new(b||E)(n.Y36(n.SBq),n.Y36(i.E),n.Y36(n.sBO),n.Y36(c.D))},E.\u0275cmp=n.Xpm({type:E,selectors:[["ng-component"]],viewQuery:function(b,v){if(1&b&&n.Gf(m,7),2&b){let M;n.iGM(M=n.CRH())&&(v.codeMirrorPane=M.first)}},features:[n.qOj],decls:17,vars:7,consts:[[1,"op-modal",3,"submit"],[3,"close"],[1,"op-modal--body"],["name","codemirror-element","id","codemirror-element",3,"ngModel"],["codeMirrorPane",""],[1,"form--field"],["for","selected-language",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-language","name","selected-language",1,"form--select",3,"ngModel","ngModelChange"],["selectedLanguage",""],[3,"textContent"],[1,"op-modal--footer"],["tabindex","4","type","button",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent"]],template:function(b,v){1&b&&(n.TgZ(0,"form",0),n.NdJ("submit",function(S){return v.applyAndClose(S)}),n.TgZ(1,"op-modal-header",1),n.NdJ("close",function(S){return v.closeMe(S)}),n._uU(2),n.qZA(),n.TgZ(3,"div",2),n._UZ(4,"textarea",3,4),n._UZ(6,"hr"),n.TgZ(7,"div",5),n._UZ(8,"label",6),n.TgZ(9,"div",7),n.TgZ(10,"div",8),n.TgZ(11,"input",9,10),n.NdJ("ngModelChange",function(S){return v.updateLanguage(S)}),n.qZA(),n.qZA(),n.qZA(),n._UZ(13,"p",11),n.qZA(),n.qZA(),n.TgZ(14,"div",12),n.TgZ(15,"button",13),n.NdJ("click",function(S){return v.closeMe(S)}),n.qZA(),n._UZ(16,"button",14),n.qZA(),n.qZA()),2&b&&(n.xp6(2),n.Oqu(v.text.title),n.xp6(2),n.Q6J("ngModel",v.content),n.xp6(4),n.Q6J("textContent",v.text.language),n.xp6(3),n.Q6J("ngModel",v.language),n.xp6(2),n.Q6J("textContent",v.text.language_hint),n.xp6(2),n.Q6J("textContent",v.text.button_cancel),n.xp6(1),n.Q6J("textContent",v.text.button_save))},directives:[h._Y,h.JL,h.F,a.g,h.Fj,h.JJ,h.On],encapsulation:2});const P=["selectedPageInput"];class w extends e.T{constructor(b,v,M,S){super(v,M,b),this.elementRef=b,this.locals=v,this.cdRef=M,this.I18n=S,this.changed=!1,this.showClose=!0,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.page="",this.includeParent=!1,this.text={title:this.I18n.t("js.editor.macro.child_pages.button"),hint:this.I18n.t("js.editor.macro.child_pages.hint"),page:this.I18n.t("js.editor.macro.child_pages.page"),include_parent:this.I18n.t("js.editor.macro.child_pages.include_parent"),button_save:this.I18n.t("js.button_save"),button_cancel:this.I18n.t("js.button_cancel"),close_popup:this.I18n.t("js.close_popup_title")},this.selectedPage=this.page=this.locals.page,this.selectedIncludeParent=this.includeParent=this.locals.includeParent}applyAndClose(b){this.changed=!0,this.page=this.selectedPage,this.includeParent=this.selectedIncludeParent,this.closeMe(b)}ngAfterViewInit(){this.selectedPageInput.nativeElement.focus()}updateIncludeParent(b){this.selectedIncludeParent=b}}w.\u0275fac=function(b){return new(b||w)(n.Y36(n.SBq),n.Y36(i.E),n.Y36(n.sBO),n.Y36(c.D))},w.\u0275cmp=n.Xpm({type:w,selectors:[["ng-component"]],viewQuery:function(b,v){if(1&b&&n.Gf(P,7),2&b){let M;n.iGM(M=n.CRH())&&(v.selectedPageInput=M.first)}},features:[n.qOj],decls:23,vars:9,consts:[[1,"op-modal",3,"submit"],[3,"close"],[1,"op-modal--body","form"],[1,"form--fieldset"],[3,"textContent"],[1,"form--field"],["for","selected-page",1,"form--label","hidden-for-sighted",3,"textContent"],[1,"form--field-container"],[1,"form--select-container"],["tabindex","2","type","text","id","selected-page","name","selected-page","placeholder","my-project:my-page",1,"form--select",3,"value","change"],["selectedPageInput",""],[1,"form--label-with-check-box"],[1,"form--check-box-container"],["tabindex","3","type","checkbox","id","include-parent","name","include-parent",1,"form--check-box",3,"ngModel","ngModelChange"],["parentIncludedInput",""],[1,"op-modal--footer"],["type","button","tabindex","4",1,"op-modal--cancel-button","button",3,"textContent","click"],["tabindex","3",1,"op-modal--submit-button","button","-highlight",3,"textContent"]],template:function(b,v){1&b&&(n.TgZ(0,"form",0),n.NdJ("submit",function(S){return v.applyAndClose(S)}),n.TgZ(1,"op-modal-header",1),n.NdJ("close",function(S){return v.closeMe(S)}),n._uU(2),n.qZA(),n.TgZ(3,"div",2),n.TgZ(4,"fieldset",3),n._UZ(5,"legend",4),n.TgZ(6,"div",5),n._UZ(7,"label",6),n.TgZ(8,"div",7),n.TgZ(9,"div",8),n.TgZ(10,"input",9,10),n.NdJ("change",function(S){return v.selectedPage=S.target.value}),n.qZA(),n.qZA(),n.qZA(),n.qZA(),n.TgZ(12,"div",5),n.TgZ(13,"div",7),n.TgZ(14,"label",11),n.TgZ(15,"div",12),n.TgZ(16,"input",13,14),n.NdJ("ngModelChange",function(S){return v.updateIncludeParent(S)}),n.qZA(),n.qZA(),n._uU(18),n.qZA(),n.qZA(),n.qZA(),n._UZ(19,"p",4),n.qZA(),n.qZA(),n.TgZ(20,"div",15),n.TgZ(21,"button",16),n.NdJ("click",function(S){return v.closeMe(S)}),n.qZA(),n._UZ(22,"button",17),n.qZA(),n.qZA()),2&b&&(n.xp6(2),n.Oqu(v.text.title),n.xp6(3),n.Q6J("textContent",v.text.page),n.xp6(2),n.Q6J("textContent",v.text.page),n.xp6(3),n.Q6J("value",v.selectedPage),n.xp6(6),n.Q6J("ngModel",v.selectedIncludeParent),n.xp6(2),n.hij(" ",v.text.include_parent," "),n.xp6(1),n.Q6J("textContent",v.text.hint),n.xp6(2),n.Q6J("textContent",v.text.button_cancel),n.xp6(1),n.Q6J("textContent",v.text.button_save))},directives:[h._Y,h.JL,h.F,a.g,h.Wl,h.JJ,h.On],encapsulation:2});class x{constructor(b,v){this.opModalService=b,this.injector=v}configureWorkPackageButton(b,v){return new Promise((M,S)=>{this.opModalService.show(g,this.injector,{type:b,classes:v}).closingEvent.subscribe(A=>{A.changed&&M({type:A.type,classes:A.classes})})})}configureWikiPageInclude(b){return new Promise((v,M)=>{const S=b||"";this.opModalService.show(y,this.injector,{page:S}).closingEvent.subscribe(A=>{A.changed&&v(A.page)})})}editCodeBlock(b,v){return new Promise((M,S)=>{this.opModalService.show(E,this.injector,{content:b,languageClass:v}).closingEvent.subscribe(A=>{A.changed&&M({languageClass:A.languageClass,content:A.content})})})}configureChildPages(b,v){return new Promise((M,S)=>{this.opModalService.show(w,this.injector,{page:b,includeParent:v}).closingEvent.subscribe(A=>{A.changed&&M({page:A.page,includeParent:A.includeParent})})})}}x.\u0275fac=function(b){return new(b||x)(n.LFG(i.S),n.LFG(n.zs3))},x.\u0275prov=n.Yz7({token:x,factory:x.\u0275fac})},39656:(H,D,t)=>{"use strict";t.d(D,{x:()=>x});var i=t(60312),e=t(71562),c=t(96617),u=t(97973),n=t(86469),h=t(36293),a=t(18137),p=t(43440),l=t(77355),d=t(2316),g=t(53882),C=t(52932),y=t(54364),m=t(2775);function E(k,b){if(1&k){const v=d.EpF();d.TgZ(0,"li",6),d.TgZ(1,"a",7),d.NdJ("click",function(S){const A=d.CHM(v).$implicit;return d.oxw(2).triggerByLink(A.url,S)}),d._UZ(2,"op-icon",8),d._UZ(3,"span",9),d.qZA(),d.qZA()}if(2&k){const v=b.$implicit;d.xp6(1),d.MGl("id","export-",v.identifier,""),d.uIk("href",v.url,d.LSH),d.xp6(1),d.MGl("icon-classes","icon-export-",v.identifier," icon-big"),d.xp6(1),d.Q6J("textContent",v.label)}}const P=function(k){return{"-hidden":k}};function w(k,b){if(1&k&&(d.TgZ(0,"ul",4),d.YNc(1,E,4,4,"li",5),d.qZA()),2&k){const v=d.oxw();d.Q6J("ngClass",d.VKq(2,P,v.isLoading)),d.xp6(1),d.Q6J("ngForOf",v.exportOptions)}}class x extends i.T{constructor(b,v,M,S,O,A,F,I,J){super(b,O,M),this.locals=b,this.I18n=v,this.elementRef=M,this.querySpace=S,this.cdRef=O,this.httpClient=A,this.wpTableColumns=F,this.loadingIndicator=I,this.toastService=J,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.text={title:this.I18n.t("js.label_export"),closePopup:this.I18n.t("js.close_popup_title"),exportPreparing:this.I18n.t("js.label_export_preparing")}}ngOnInit(){super.ngOnInit(),this.locals.link?this.requestExport(this.locals.link):this.querySpace.results.valuesPromise().then(b=>this.exportOptions=this.buildExportOptions(b))}buildExportOptions(b){return b.representations.map(v=>{const M=v.$link;return{identifier:M.identifier,label:M.title,url:this.addColumnsToHref(v.href)}})}triggerByLink(b,v){v.preventDefault(),this.requestExport(b)}requestExport(b){this.httpClient.get(b,{observe:"body",responseType:"json"}).subscribe(v=>this.replaceWithJobModal(v.job_id),v=>this.handleError(v))}replaceWithJobModal(b){this.service.show(a.L,"global",{jobId:b})}handleError(b){200===b.status&&b.url?window.open(b.url):this.showError(b)}showError(b){this.toastService.addError(b.message||this.I18n.t("js.error.internal"))}addColumnsToHref(b){const M=this.wpTableColumns.getColumns().map(O=>O.id),S=u(b);return S.removeSearch("columns[]"),S.addSearch("columns[]",M),S.toString()}get afterFocusOn(){return jQuery("#work-packages-settings-button")}}x.\u0275fac=function(b){return new(b||x)(d.Y36(l.E),d.Y36(c.D),d.Y36(d.SBq),d.Y36(p.q),d.Y36(d.sBO),d.Y36(g.eN),d.Y36(e.i),d.Y36(n.vt),d.Y36(h.kl))},x.\u0275cmp=d.Xpm({type:x,selectors:[["ng-component"]],features:[d.qOj],decls:5,vars:2,consts:[[1,"op-modal","op-modal_wide","wp-table--configuration-modal","op-wp-table-export"],[3,"close"],[1,"op-modal--body"],["class","op-export-options",3,"ngClass",4,"ngIf"],[1,"op-export-options",3,"ngClass"],["class","op-export-options--option",4,"ngFor","ngForOf"],[1,"op-export-options--option"],[1,"op-export-options--option-link",3,"id","click"],[3,"icon-classes"],[1,"op-export-options--option-label",3,"textContent"]],template:function(b,v){1&b&&(d.TgZ(0,"div",0),d.TgZ(1,"op-modal-header",1),d.NdJ("close",function(S){return v.closeMe(S)}),d._uU(2),d.qZA(),d.TgZ(3,"div",2),d.YNc(4,w,2,4,"ul",3),d.qZA(),d.qZA()),2&b&&(d.xp6(2),d.Oqu(v.text.title),d.xp6(2),d.Q6J("ngIf",v.exportOptions))},directives:[C.g,y.O5,y.mk,y.sg,m.o],styles:[".op-wp-table-export[_ngcontent-%COMP%]   #download-link[_ngcontent-%COMP%]{display:none}.op-wp-table-export[_ngcontent-%COMP%]   .loading-indicator--location[_ngcontent-%COMP%]{height:220px}.op-wp-table-export[_ngcontent-%COMP%]   .export-options.-hidden[_ngcontent-%COMP%]{display:none}"],changeDetection:0})},58057:(H,D,t)=>{"use strict";t.d(D,{T:()=>r});var i=t(77355),e=t(60312),c=t(96617),u=t(2316);class r extends e.T{constructor(h,a,p,l){super(a,p,h),this.elementRef=h,this.locals=a,this.cdRef=p,this.I18n=l,this.closeOnOutsideClick=!1}ngOnInit(){super.ngOnInit(),this.$element.find(".dynamic-content-modal--wrapper").addClass(this.locals.modalClassName).append(this.locals.modalBody),jQuery(document.body).on("click.opdynamicmodal",".op-modal--close-button, [dynamic-content-modal-close-button]",h=>{this.closeMe(h)})}ngOnDestroy(){jQuery(document.body).off("click.opdynamicmodal"),super.ngOnDestroy()}}r.\u0275fac=function(h){return new(h||r)(u.Y36(u.SBq),u.Y36(i.E),u.Y36(u.sBO),u.Y36(c.D))},r.\u0275cmp=u.Xpm({type:r,selectors:[["ng-component"]],features:[u.qOj],decls:1,vars:0,consts:[["data-indicator-name","modal",1,"op-modal","dynamic-content-modal--wrapper","loading-indicator--location"]],template:function(h,a){1&h&&u._UZ(0,"div",0)},encapsulation:2})},62681:(H,D,t)=>{"use strict";t.d(D,{I:()=>v});var i=t(61043),e=t(87853),c=t(60312),u=t(77355),r=t(48451),n=t(47775),h=t(96617),a=t(57014),p=t(62964),l=t(56686),d=t(2316),g=t(52932),C=t(54364),y=t(1707);function m(M,S){if(1&M&&(d.TgZ(0,"li"),d._uU(1," #"),d._UZ(2,"span",7),d._UZ(3,"span",7),d.qZA()),2&M){const O=S.$implicit;d.xp6(2),d.Q6J("textContent",O.id),d.xp6(1),d.Q6J("textContent",O.subject||"")}}function E(M,S){if(1&M&&(d.TgZ(0,"div"),d.TgZ(1,"p",8),d._UZ(2,"span",9),d._UZ(3,"strong",7),d._uU(4,": "),d._UZ(5,"span",7),d.qZA(),d.TgZ(6,"ul"),d.YNc(7,m,4,2,"li",10),d.qZA(),d.TgZ(8,"p"),d._UZ(9,"span",7),d.qZA(),d.qZA()),2&M){const O=d.oxw(2);d.xp6(3),d.Q6J("textContent",O.text.warning),d.xp6(2),d.Q6J("textContent",O.text.hasChildren(O.singleWorkPackage)),d.xp6(2),d.Q6J("ngForOf",O.singleWorkPackageChildren),d.xp6(2),d.Q6J("textContent",O.text.deletesChildren)}}function P(M,S){if(1&M&&(d.ynx(0),d.TgZ(1,"p"),d._UZ(2,"span",7),d._UZ(3,"br"),d.TgZ(4,"strong"),d._uU(5),d.qZA(),d.qZA(),d.YNc(6,E,10,4,"div",3),d.BQk()),2&M){const O=d.oxw();d.xp6(2),d.Q6J("textContent",O.text.text),d.xp6(3),d.lnq(" ",O.singleWorkPackage.type.name," #",O.singleWorkPackage.id," ",O.singleWorkPackage.subject," "),d.xp6(1),d.Q6J("ngIf",O.singleWorkPackageChildren&&O.singleWorkPackageChildren.length>0)}}function w(M,S){if(1&M&&(d.TgZ(0,"strong"),d._uU(1),d.qZA()),2&M){const O=d.oxw().$implicit,A=d.oxw(2);d.xp6(1),d.hij(" (+ ",A.text.childCount(O),") ")}}function x(M,S){if(1&M&&(d.TgZ(0,"li"),d._uU(1," #"),d._UZ(2,"span",7),d._uU(3," "),d._UZ(4,"span",7),d.YNc(5,w,2,1,"strong",3),d.qZA()),2&M){const O=S.$implicit,A=d.oxw(2);d.xp6(2),d.Q6J("textContent",O.id),d.xp6(2),d.Q6J("textContent",O.subject),d.xp6(1),d.Q6J("ngIf",A.children(O).length>0)}}function k(M,S){if(1&M&&(d.ynx(0),d.TgZ(1,"p",8),d._UZ(2,"span",9),d._UZ(3,"strong",7),d.qZA(),d.TgZ(4,"ul"),d.YNc(5,x,6,3,"li",10),d.qZA(),d.BQk()),2&M){const O=d.oxw();d.xp6(3),d.Q6J("textContent",O.text.text),d.xp6(2),d.Q6J("ngForOf",O.workPackages)}}function b(M,S){if(1&M){const O=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"label",11),d.TgZ(2,"div",12),d.TgZ(3,"input",13),d.NdJ("ngModelChange",function(F){d.CHM(O);return d.oxw().childrenDeletionConfirmed=F}),d.qZA(),d.qZA(),d._uU(4),d.qZA(),d.qZA()}if(2&M){const O=d.oxw();d.xp6(3),d.Q6J("ngModel",O.childrenDeletionConfirmed),d.xp6(1),d.hij(" ",O.text.label_confirm_children_deletion," ")}}class v extends c.T{constructor(S,O,A,F,I,J,N,te,ee,G,se){super(A,I,S),this.elementRef=S,this.WorkPackageService=O,this.locals=A,this.I18n=F,this.cdRef=I,this.$state=J,this.states=N,this.wpTableFocus=te,this.wpListService=ee,this.notificationService=G,this.backRoutingService=se,this.busy=!1,this.childrenDeletionConfirmed=!1,this.text={label_visibility_settings:this.I18n.t("js.label_visibility_settings"),button_save:this.I18n.t("js.modals.button_save"),confirm:this.I18n.t("js.button_confirm"),warning:this.I18n.t("js.label_warning"),cancel:this.I18n.t("js.button_cancel"),close:this.I18n.t("js.close_popup_title"),label_confirm_children_deletion:this.I18n.t("js.modals.destroy_work_package.confirm_deletion_children")}}ngOnInit(){super.ngOnInit(),this.workPackages=this.locals.workPackages,this.workPackageLabel=this.I18n.t("js.units.workPackage",{count:this.workPackages.length}),1===this.workPackages.length&&(this.singleWorkPackage=this.workPackages[0],this.singleWorkPackageChildren=this.singleWorkPackage.children),this.text.title=this.I18n.t("js.modals.destroy_work_package.title",{label:this.workPackageLabel}),this.text.text=this.I18n.t("js.modals.destroy_work_package.text",{label:this.workPackageLabel,count:this.workPackages.length}),this.text.childCount=S=>{const O=this.children(S).length;return this.I18n.t("js.units.child_work_packages",{count:O})},this.text.hasChildren=S=>this.I18n.t("js.modals.destroy_work_package.has_children",{childUnits:this.text.childCount(S)}),this.text.deletesChildren=this.I18n.t("js.modals.destroy_work_package.deletes_children")}get blockedDueToUnconfirmedChildren(){return this.mustConfirmChildren&&!this.childrenDeletionConfirmed}get mustConfirmChildren(){if(this.singleWorkPackage&&this.singleWorkPackageChildren){this.singleWorkPackageChildren.length}return!!_.find(this.workPackages,O=>O.children&&O.children.length>0)}confirmDeletion(S){return this.busy||this.blockedDueToUnconfirmedChildren||(this.busy=!0,this.WorkPackageService.performBulkDelete(this.workPackages.map(O=>O.id),!0).then(()=>{this.busy=!1,this.closeMe(S),this.wpTableFocus.clear("Clearing after destroying work packages"),this.$state.current.data.baseRoute&&this.backRoutingService.goBack(!0)}).catch(()=>{this.busy=!1})),!1}children(S){return S.hasOwnProperty("children")?S.children:[]}}v.\u0275fac=function(S){return new(S||v)(d.Y36(d.SBq),d.Y36(l.h),d.Y36(u.E),d.Y36(h.D),d.Y36(d.sBO),d.Y36(n.StateService),d.Y36(e.G),d.Y36(r.o),d.Y36(i.Z),d.Y36(p.q),d.Y36(a.Y))},v.\u0275cmp=d.Xpm({type:v,selectors:[["ng-component"]],features:[d.qOj],decls:10,vars:7,consts:[["data-indicator-name","modal","id","wp_destroy_modal",1,"op-modal","op-modal_autoheight","wp-table--configuration-modal","-danger-zone","loading-indicator--location"],[3,"close"],[1,"op-modal--body"],[4,"ngIf"],[1,"op-modal--footer"],[1,"button",3,"textContent","click"],[1,"button","-danger",3,"textContent","click"],[3,"textContent"],[1,"danger-zone--warning"],[1,"icon-context","icon-error"],[4,"ngFor","ngForOf"],[1,"form--label-with-check-box","-no-ellipsis"],[1,"form--check-box-container"],["type","checkbox","name","confirm-children-deletion","id","confirm-children-deletion",1,"form--check-box",3,"ngModel","ngModelChange"]],template:function(S,O){1&S&&(d.TgZ(0,"div",0),d.TgZ(1,"op-modal-header",1),d.NdJ("close",function(F){return O.closeMe(F)}),d._uU(2),d.qZA(),d.TgZ(3,"div",2),d.YNc(4,P,7,5,"ng-container",3),d.YNc(5,k,6,2,"ng-container",3),d.YNc(6,b,5,2,"div",3),d.qZA(),d.TgZ(7,"div",4),d.TgZ(8,"button",5),d.NdJ("click",function(F){return O.closeMe(F)}),d.qZA(),d.TgZ(9,"button",6),d.NdJ("click",function(F){return O.confirmDeletion(F)}),d.qZA(),d.qZA(),d.qZA()),2&S&&(d.xp6(2),d.Oqu(O.text.title),d.xp6(2),d.Q6J("ngIf",O.singleWorkPackage),d.xp6(1),d.Q6J("ngIf",O.workPackages.length>1),d.xp6(1),d.Q6J("ngIf",O.mustConfirmChildren),d.xp6(2),d.Q6J("textContent",O.text.cancel),d.xp6(1),d.Q6J("textContent",O.text.confirm),d.uIk("disabled",O.busy||O.blockedDueToUnconfirmedChildren||void 0))},directives:[g.g,C.O5,C.sg,y.Wl,y.JJ,y.On],encapsulation:2})},55216:(H,D,t)=>{"use strict";t.d(D,{S:()=>r});var i=t(2316),e=t(54364);function c(n,h){1&n&&i._UZ(0,"i",3)}function u(n,h){if(1&n&&i._UZ(0,"div",4),2&n){const a=i.oxw();i.Q6J("innerHTML",a.description,i.oJD)}}class r{constructor(){this.showIcon=!0,this.setHostClass=!0}}r.\u0275fac=function(h){return new(h||r)},r.\u0275cmp=i.Xpm({type:r,selectors:[["no-results"]],hostVars:2,hostBindings:function(h,a){2&h&&i.ekj("generic-table--no-results-container",a.setHostClass)},inputs:{title:"title",description:"description",showIcon:"showIcon"},decls:4,vars:3,consts:[["class","icon-info1","aria-hidden","true",4,"ngIf"],[1,"generic-table--no-results-title"],["class","generic-table--no-results-description",3,"innerHTML",4,"ngIf"],["aria-hidden","true",1,"icon-info1"],[1,"generic-table--no-results-description",3,"innerHTML"]],template:function(h,a){1&h&&(i.YNc(0,c,1,0,"i",0),i.TgZ(1,"span",1),i._uU(2),i.YNc(3,u,1,1,"div",2),i.qZA()),2&h&&(i.Q6J("ngIf",a.showIcon),i.xp6(2),i.hij(" ",a.title," "),i.xp6(1),i.Q6J("ngIf",a.description))},directives:[e.O5],encapsulation:2})},70099:(H,D,t)=>{"use strict";t.d(D,{V:()=>u});var i=t(2316),e=t(52332);class u{constructor(){this.viewBox="0 0 400 130"}ngOnInit(){this.baseUrl=window.appBasePath}}u.\u0275fac=function(n){return new(n||u)},u.\u0275cmp=i.Xpm({type:u,selectors:[["op-content-loader"]],inputs:{viewBox:"viewBox"},ngContentSelectors:["*"],decls:2,vars:3,consts:[[3,"baseUrl","speed","viewBox"]],template:function(n,h){1&n&&(i.F$t(),i.TgZ(0,"content-loader",0),i.Hsn(1),i.qZA()),2&n&&i.Q6J("baseUrl",h.baseUrl)("speed",3)("viewBox",h.viewBox)},directives:[e.H1],encapsulation:2,changeDetection:0})},87523:(H,D,t)=>{"use strict";t.d(D,{a:()=>u});var i=t(54364),e=t(52332),c=t(2316);class u{}u.\u0275fac=function(n){return new(n||u)},u.\u0275mod=c.oAB({type:u}),u.\u0275inj=c.cJS({imports:[[i.ez,e.GO]]})},55548:(H,D,t)=>{"use strict";t.d(D,{n:()=>u});var i=t(20342),e=t(53358),c=t(2316);class u extends e.m{constructor(n,h){super(h),this.elementRef=n,this.opContextMenu=h,this.items=[]}ngAfterViewInit(){this.$element=jQuery(this.elementRef.nativeElement),this.$element.on("click",n=>{n.preventDefault(),this.opContextMenu.isActive(this)?this.opContextMenu.close():this.open(n)}),Mousetrap(this.$element[0]).bind("shift+alt+f10",n=>{this.open(n)})}positionArgs(n){return{my:"left top",at:"left bottom",of:this.$element,collision:"flipfit"}}}u.\u0275fac=function(n){return new(n||u)(c.Y36(c.SBq),c.Y36(i.$))},u.\u0275dir=c.lG2({type:u,selectors:[["","opContextMenuTrigger",""]],features:[c.qOj]})},8643:(H,D,t)=>{"use strict";t.d(D,{Y:()=>n});var i=t(20342),e=t(55548),c=t(12703),u=t(87853),r=t(2316);class n extends e.n{constructor(a,p,l,d){super(a,p),this.elementRef=a,this.opContextMenu=p,this.states=l,this.halEditing=d}open(a){const p=this.states.workPackages.get("new").value;p&&this.halEditing.changeFor(p).getForm().then(d=>{this.buildItems(d),this.opContextMenu.show(this,a)})}positionArgs(a){const l=super.positionArgs(a);return _.assign(l,{my:"right top",at:"right bottom"}),l}buildItems(a){this.items=[];const p=a.configureForm,l=a.customFields;l&&this.items.push({href:l.href,icon:"icon-custom-fields",linkText:l.name,onClick:()=>!1}),p&&this.items.push({href:p.href,icon:"icon-settings3",linkText:p.name,onClick:()=>!1})}}n.\u0275fac=function(a){return new(a||n)(r.Y36(r.SBq),r.Y36(i.$),r.Y36(u.G),r.Y36(c.l))},n.\u0275dir=r.lG2({type:n,selectors:[["","wpCreateSettingsMenu",""]],features:[r.qOj]})},11269:(H,D,t)=>{"use strict";t.d(D,{I:()=>a});var i=t(3786),e=t(96617),c=t(55548),u=t(20342),r=t(77355),n=t(2316),h=t(2775);class a extends c.n{constructor(l,d,g,C,y,m){super(l,d),this.elementRef=l,this.opContextMenu=d,this.opModalService=g,this.injector=C,this.cdRef=y,this.I18n=m}open(l){return(0,i.mG)(this,void 0,void 0,function*(){this.items=yield this.buildItems(),this.opContextMenu.show(this,l)})}positionArgs(l){const g=super.positionArgs(l);return _.assign(g,{my:"right top",at:"right bottom"}),g}buildItems(){return(0,i.mG)(this,void 0,void 0,function*(){const l=[];if(this.menuItems){const d=yield this.menuItems();return l.concat(d)}return l})}}a.\u0275fac=function(l){return new(l||a)(n.Y36(n.SBq),n.Y36(u.$),n.Y36(r.S),n.Y36(n.zs3),n.Y36(n.sBO),n.Y36(e.D))},a.\u0275cmp=n.Xpm({type:a,selectors:[["icon-triggered-context-menu"]],inputs:{menuItems:["menu-items","menuItems"]},features:[n.qOj],decls:2,vars:0,consts:[["href","#"],["icon-classes","icon-show-more-horizontal"]],template:function(l,d){1&l&&(n.TgZ(0,"a",0),n._UZ(1,"op-icon",1),n.qZA())},directives:[h.o],styles:["a[_ngcontent-%COMP%], a[_ngcontent-%COMP%]:hover{color:var(--light-gray);text-decoration:none}"]})},53358:(H,D,t)=>{"use strict";t.d(D,{m:()=>e});var i=t(26942);class e extends i.N{constructor(u){super(),this.opContextMenu=u,this.items=[]}onClose(){this.afterFocusOn.trigger("focus")}onOpen(u){u.find(".menu-item").first().trigger("focus")}positionArgs(u){return{my:"left top",at:"right bottom",of:u,collision:"flipfit"}}get locals(){return{items:this.items}}open(u){this.opContextMenu.show(this,u)}get afterFocusOn(){return this.$element}}},36322:(H,D,t)=>{"use strict";t.d(D,{n:()=>m});var i=t(30712),e=t(2316),c=t(54364),u=t(2775);function r(E,P){1&E&&e._UZ(0,"li",5)}function n(E,P){if(1&E&&e._UZ(0,"op-icon",11),2&E){const w=e.oxw(3).$implicit;e.MGl("icon-classes","icon-action-menu ",w.icon,"")}}function h(E,P){if(1&E&&e._UZ(0,"op-icon",12),2&E){const w=e.oxw(3).$implicit;e.MGl("icon-classes","icon-action-menu-post ",w.postIcon,""),e.Q6J("icon-title",w.postIconTitle||"")}}function a(E,P){if(1&E){const w=e.EpF();e.TgZ(0,"a",7),e.NdJ("click",function(k){e.CHM(w);const b=e.oxw(2).$implicit;return e.oxw().handleClick(b,k)}),e.YNc(1,n,1,1,"op-icon",8),e._UZ(2,"span",9),e.YNc(3,h,1,2,"op-icon",10),e.qZA()}if(2&E){const w=e.oxw(2).$implicit;e.ekj("inactive",w.disabled),e.Q6J("ngClass",w.class),e.uIk("href",w.href,e.LSH)("aria-disabled",w.disabled)("aria-label",w.ariaLabel||w.linkText),e.xp6(1),e.Q6J("ngIf",w.icon),e.xp6(1),e.Q6J("textContent",w.linkText),e.xp6(1),e.Q6J("ngIf",w.postIcon)}}function p(E,P){if(1&E&&e._UZ(0,"op-icon",11),2&E){const w=e.oxw(3).$implicit;e.MGl("icon-classes","icon-action-menu ",w.icon,"")}}function l(E,P){if(1&E&&e._UZ(0,"op-icon",12),2&E){const w=e.oxw(3).$implicit;e.MGl("icon-classes","icon-action-menu-post ",w.postIcon,""),e.Q6J("icon-title",w.postIconTitle||"")}}function d(E,P){if(1&E){const w=e.EpF();e.TgZ(0,"button",7),e.NdJ("click",function(k){e.CHM(w);const b=e.oxw(2).$implicit;return e.oxw().handleClick(b,k)}),e.YNc(1,p,1,1,"op-icon",8),e._UZ(2,"span",9),e.YNc(3,l,1,2,"op-icon",10),e.qZA()}if(2&E){const w=e.oxw(2).$implicit;e.ekj("inactive",w.disabled),e.Q6J("ngClass",w.class),e.uIk("aria-disabled",w.disabled)("aria-label",w.ariaLabel||w.linkText),e.xp6(1),e.Q6J("ngIf",w.icon),e.xp6(1),e.Q6J("textContent",w.linkText),e.xp6(1),e.Q6J("ngIf",w.postIcon)}}function g(E,P){if(1&E&&(e.TgZ(0,"li"),e.YNc(1,a,4,9,"a",6),e.YNc(2,d,4,8,"button",6),e.qZA()),2&E){const w=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",w.href),e.xp6(1),e.Q6J("ngIf",!w.href)}}function C(E,P){if(1&E&&(e.ynx(0),e.YNc(1,r,1,0,"li",3),e.YNc(2,g,3,2,"li",4),e.BQk()),2&E){const w=P.$implicit;e.xp6(1),e.Q6J("ngIf",w.divider),e.xp6(1),e.Q6J("ngIf",!w.divider)}}const y=function(E){return{"-empty":E}};class m{constructor(P){this.locals=P,this.items=this.locals.items.filter(w=>!(null==w?void 0:w.hidden)),this.service=this.locals.service}handleClick(P,w){return!P.disabled&&!P.divider&&(!P.onClick(w)||(this.locals.service.close(),w.preventDefault(),w.stopPropagation(),!1))}}m.\u0275fac=function(P){return new(P||m)(e.Y36(i.Q))},m.\u0275cmp=e.Xpm({type:m,selectors:[["ng-component"]],decls:3,vars:5,consts:[["ng-class","{'dropdown-anchor-right': locals.showAnchorRight}",1,"dropdown-relative","dropdown","-overflow-in-view"],["role","menu",1,"dropdown-menu",3,"ngClass"],[4,"ngFor","ngForOf"],["class","dropdown-divider",4,"ngIf"],[4,"ngIf"],[1,"dropdown-divider"],["class","menu-item",3,"ngClass","inactive","click",4,"ngIf"],[1,"menu-item",3,"ngClass","click"],[3,"icon-classes",4,"ngIf"],[3,"textContent"],[3,"icon-title","icon-classes",4,"ngIf"],[3,"icon-classes"],[3,"icon-title","icon-classes"]],template:function(P,w){1&P&&(e.TgZ(0,"div",0),e.TgZ(1,"ul",1),e.YNc(2,C,3,2,"ng-container",2),e.qZA(),e.qZA()),2&P&&(e.uIk("id",w.locals.contextMenuId),e.xp6(1),e.Q6J("ngClass",e.VKq(3,y,0===w.items.length)),e.xp6(1),e.Q6J("ngForOf",w.items))},directives:[c.mk,c.sg,c.O5,u.o],encapsulation:2})},20342:(H,D,t)=>{"use strict";t.d(D,{$:()=>a});var i=t(40912),e=t(47775),c=t(30712),u=t(36322),r=t(33406),n=t(7101),h=t(2316);class a{constructor(l,d,g,C,y){this.componentFactoryResolver=l,this.FocusHelper=d,this.appRef=g,this.$transitions=C,this.injector=y,this.active=null,this.isOpening=!1;const m=this.portalHostElement=document.createElement("div");m.classList.add("op-context-menu--overlay"),document.body.appendChild(m),this.bodyPortalHost=new i.u0(m,this.componentFactoryResolver,this.appRef,this.injector),C.onStart({},()=>this.close()),jQuery(window).on("keydown",P=>(this.active&&P.which===r.m.ESCAPE&&this.close(),!0));const E=this;document.getElementById("wrapper").addEventListener("click",P=>{E.active&&!E.portalHostElement.contains(P.target)&&E.close()},!0)}show(l,d,g=u.n){this.close(),this.isOpening=!0;const C=new i.C5(g,null,this.injectorFor(l.locals));this.bodyPortalHost.attach(C),this.portalHostElement.style.display="block",this.active=l,setTimeout(()=>{var y;this.reposition(d),null===(y=this.active)||void 0===y||y.onOpen(this.activeMenu),this.isOpening=!1})}isActive(l){return!!this.active&&this.active===l}close(){var l;this.isOpening||(this.bodyPortalHost.detach(),this.portalHostElement.style.display="none",null===(l=this.active)||void 0===l||l.onClose(),this.active=null)}reposition(l){!this.active||this.activeMenu.position(this.active.positionArgs(l)).css("visibility","visible")}get activeMenu(){return jQuery(this.portalHostElement).find(".dropdown")}injectorFor(l){const d=new WeakMap;return l.service=this,d.set(c.Q,l),new i.nK(this.injector,d)}}a.\u0275fac=function(l){return new(l||a)(h.LFG(h._Vd),h.LFG(n.i),h.LFG(h.z2F),h.LFG(e.TransitionService),h.LFG(h.zs3))},a.\u0275prov=h.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"})},30712:(H,D,t)=>{"use strict";t.d(D,{Q:()=>e});const e=new(t(2316).OlP)("CONTEXT_MENU_LOCALS")},74565:(H,D,t)=>{"use strict";t.d(D,{B:()=>P});var i=t(3786),e=t(47775),c=t(67325),u=t(7493),r=t(70233),h=(t(24897),t(53448)),a=t(55548),p=t(20342),l=t(60713),d=t(77355),g=t(29161),C=t(46709),y=t(62681);class m{constructor(x,k,b){this.workPackage=x,this.PathHelper=k,this.$state=b,this.project=x.project}linkForAction(x){let k;switch(x.key){case"copy":k=this.copyLink();break;case"copy_to_other_project":k=this.bulkCopyLink();break;default:k=this.workPackage[x.link].href}return Object.assign(Object.assign({},x),{link:k})}isPermitted(x){return void 0!==this.workPackage[x.link]}permittedActionKeys(x){return x.filter(k=>this.isPermitted(k)).map(k=>k.key)}permittedActionsWithLinks(x){return x.filter(k=>this.isPermitted(k)).map(k=>this.linkForAction(k))}copyLink(){return 0===this.$state.current.name.indexOf("work-packages.partitioned.list.details")?this.PathHelper.workPackageDetailsCopyPath(this.project.identifier,this.workPackage.id):this.PathHelper.workPackageCopyPath(this.workPackage.id)}bulkCopyLink(){return`${this.PathHelper.staticBase}/work_packages/move/new?copy=true&ids[]=${this.workPackage.id}`}}var E=t(2316);class P extends a.n{constructor(x,k,b,v,M,S,O,A){super(M,O),this.HookService=x,this.$state=k,this.injector=b,this.PathHelper=v,this.elementRef=M,this.opModalService=S,this.opContextMenuService=O,this.authorisationService=A}open(x){this.workPackage.project.$load().then(()=>{this.authorisationService.initModelAuth("work_package",this.workPackage.$links);const k=new m(this.workPackage,this.PathHelper,this.$state),b=this.getPermittedActions(k);this.buildItems(b),this.opContextMenu.show(this,x)})}triggerContextMenuAction(x,k){const{link:b}=x;switch(k){case"copy_to_other_project":window.location.href=`${this.PathHelper.staticBase}/work_packages/move/new?copy=true&ids[]=${this.workPackage.id}`;break;case"copy":this.$state.go("work-packages.copy",{copiedFromWorkPackageId:this.workPackage.id});break;case"delete":this.opModalService.show(y.I,this.injector,{workPackages:[this.workPackage]});break;case"log_time":this.timeEntryCreateService.create(moment(new Date),this.workPackage,!1).catch(()=>{});break;default:window.location.href=b}}positionArgs(x){const b=super.positionArgs(x);return _.assign(b,{my:"right top",at:"right bottom"}),b}getPermittedActions(x){const k=x.permittedActionsWithLinks(l.p);return _.each(this.getPermittedPluginActions(x),b=>{const v=b.indexBy?b.indexBy(k):k.length;k.splice(v,0,b)}),k}getPermittedPluginActions(x){const k=this.HookService.call("workPackageSingleContextMenu");return x.permittedActionsWithLinks(k)}buildItems(x){const k=this.workPackage.configureForm;return this.items=x.map(b=>{const{key:v}=b;return{disabled:!1,linkText:I18n.t(`js.button_${v}`),href:b.link,icon:b.icon||`icon-${v}`,onClick:M=>(!b.link||!(0,c.F)(M))&&(this.triggerContextMenuAction(b,v),!0)}}),k&&this.items.push({href:k.href,icon:"icon-settings3",linkText:I18n.t("js.button_configure-form"),onClick:()=>!1}),this.items}}P.\u0275fac=function(x){return new(x||P)(E.Y36(h.$),E.Y36(e.StateService),E.Y36(E.zs3),E.Y36(r.j),E.Y36(E.SBq),E.Y36(d.S),E.Y36(p.$),E.Y36(u.g))},P.\u0275dir=E.lG2({type:P,selectors:[["","wpSingleContextMenu",""]],inputs:{workPackage:["wpSingleContextMenu-workPackage","workPackage"]},features:[E.qOj]}),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",C.f)],P.prototype,"timeEntryCreateService",void 0)},60713:(H,D,t)=>{"use strict";t.d(D,{p:()=>i});const i=[{key:"log_time",link:"logTime"},{key:"change_project",icon:"icon-move",link:"move"},{key:"copy",link:"copy"},{key:"copy_to_other_project",link:"copy",icon:"icon-project-types"},{key:"delete",link:"delete"},{key:"export-pdf",link:"pdf"},{key:"export-atom",link:"atom"}]},99794:(H,D,t)=>{"use strict";t.d(D,{X:()=>w});var i=t(3786),e=t(77591),c=t(87853),u=t(41945),r=t(60914),n=t(67325),h=t(53358),a=t(20342),p=t(60713),l=t(77355),d=t(47775),g=t(29161),C=t(46709),y=t(70482),m=t(62681),E=t(84699),P=t(70233);class w extends h.m{constructor(k,b,v,M={},S=!0){super(k.get(a.$)),this.injector=k,this.workPackageId=b,this.$element=v,this.additionalPositionArgs=M,this.allowSplitScreenActions=S,this.workPackage=this.states.workPackages.get(this.workPackageId).value,this.selectedWorkPackages=this.getSelectedWorkPackages(),this.permittedActions=this.WorkPackageContextMenuHelper.getPermittedActions(this.selectedWorkPackages,p.p,this.allowSplitScreenActions),this.baseRoute=this.$state.current.data.baseRoute||this.$state.current.name,this.items=this.buildItems()}get locals(){return{contextMenuId:"work-package-context-menu",items:this.items}}positionArgs(k){const b=super.positionArgs(k);return _.assign(b,this.additionalPositionArgs),b}triggerContextMenuAction(k){const{link:b}=k,v=this.workPackage.id;switch(k.key){case"delete":this.deleteSelectedWorkPackages();break;case"edit":this.editSelectedWorkPackages(b);break;case"copy":this.copySelectedWorkPackages(b);break;case"copy_to_other_project":window.location.href=`${this.pathHelper.staticBase}/work_packages/move/new?copy=true&ids[]=${v}`;break;case"relation-new-child":this.wpRelationsHierarchyService.addNewChildWp(this.baseRoute,this.workPackage);break;case"log_time":this.logTimeForSelectedWorkPackage();break;default:window.location.href=b}}deleteSelectedWorkPackages(){const k=this.getSelectedWorkPackages();this.opModalService.show(m.I,this.injector,{workPackages:k})}editSelectedWorkPackages(k){this.getSelectedWorkPackages().length>1&&(window.location.href=k)}copySelectedWorkPackages(k){const b=this.getSelectedWorkPackages();if(b.length>1)return void(window.location.href=k);const v={copiedFromWorkPackageId:b[0].id};this.$state.go(`${this.baseRoute}.copy`,v)}logTimeForSelectedWorkPackage(){this.timeEntryCreateService.create(moment(new Date),this.workPackage).catch(()=>{})}getSelectedWorkPackages(){const k=this.wpTableSelection.getSelectedWorkPackages();return 0===k.length?[this.workPackage]:(-1===k.indexOf(this.workPackage)&&k.push(this.workPackage),k)}buildItems(){const k=this.permittedActions.map(b=>({class:void 0,disabled:!1,linkText:b.text,href:b.href,icon:null!=b.icon?b.icon:`icon-${b.key}`,onClick:v=>(!b.href||!(0,n.F)(v))&&(this.triggerContextMenuAction(b),!0)}));return(0,E.Z)(this.workPackage)||(k.unshift({disabled:!1,icon:"icon-view-fullscreen",class:"openFullScreenView",href:this.$state.href("work-packages.show",{workPackageId:this.workPackageId}),linkText:I18n.t("js.button_open_fullscreen"),onClick:b=>!(0,n.F)(b)&&(this.$state.go("work-packages.show",{workPackageId:this.workPackageId}),!0)}),this.allowSplitScreenActions&&k.unshift({disabled:!1,icon:"icon-view-split",class:"detailsViewMenuItem",href:this.$state.href(`${(0,y.W)(this.$state)}.tabs`,{workPackageId:this.workPackageId,tabIdentifier:"overview"}),linkText:I18n.t("js.button_open_details"),onClick:b=>!(0,n.F)(b)&&(this.$state.go(`${(0,y.W)(this.$state)}.tabs`,{workPackageId:this.workPackageId,tabIdentifier:"overview"}),!0)})),k}}(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",c.G)],w.prototype,"states",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",u.O)],w.prototype,"wpRelationsHierarchyService",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",l.S)],w.prototype,"opModalService",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",d.StateService)],w.prototype,"$state",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",r.J)],w.prototype,"wpTableSelection",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",e.j)],w.prototype,"WorkPackageContextMenuHelper",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",C.f)],w.prototype,"timeEntryCreateService",void 0),(0,i.gn)([(0,g.W)(),(0,i.w6)("design:type",P.j)],w.prototype,"pathHelper",void 0)},14279:(H,D,t)=>{"use strict";t.d(D,{J:()=>n});var i=t(2316),e=t(26942),c=t(70692),u=t(12877);const r=["dateInput"];class n extends e.N{constructor(a,p){super(),this.timezoneService=a,this.configurationService=p,this.canceled=new i.vpe,this.classes="",this.id="",this.name="",this.required=!1,this.size=20,this.disabled=!1,this.id||(this.id=`datepicker-input-${Math.floor(1e3*Math.random()).toString(3)}`)}ngAfterViewInit(){this.initializeDatepicker()}ngOnDestroy(){this.datePickerInstance&&this.datePickerInstance.destroy()}openOnClick(){this.disabled||this.datePickerInstance.show()}closeOnOutsideClick(a){a.relatedTarget&&this.datePickerInstance.datepickerInstance.calendarContainer.contains(a.relatedTarget)||this.close()}close(){this.datePickerInstance.hide()}isEmpty(){return""===this.currentValue.trim()}get currentValue(){var a;return(null===(a=this.inputElement)||void 0===a?void 0:a.value)||""}get inputElement(){var a;return null===(a=this.dateInput)||void 0===a?void 0:a.nativeElement}}n.\u0275fac=function(a){return new(a||n)(i.Y36(c.B),i.Y36(u.e))},n.\u0275dir=i.lG2({type:n,viewQuery:function(a,p){if(1&a&&i.Gf(r,5),2&a){let l;i.iGM(l=i.CRH())&&(p.dateInput=l.first)}},inputs:{appendTo:"appendTo",classes:"classes",id:"id",name:"name",required:"required",size:"size",disabled:"disabled"},outputs:{canceled:"canceled"},features:[i.qOj]})},81496:(H,D,t)=>{"use strict";t.d(D,{I:()=>c});var i=t(54364),e=t(2316);class c{}c.\u0275fac=function(r){return new(r||c)},c.\u0275mod=e.oAB({type:c}),c.\u0275inj=e.cJS({imports:[[i.ez]]})},14882:(H,D,t)=>{"use strict";t.d(D,{M:()=>h});var i=t(2281),c=t(89187),u=t.n(c),r=t(96617),n=t(51590);class h{constructor(p,l,d,g,C){this.datepickerElemIdentifier=p,this.date=l,this.options=d,this.datepickerTarget=g,this.configurationService=C,this.datepickerFormat="Y-m-d",this.datepickerCont=document.querySelector(this.datepickerElemIdentifier),this.hideDuringScroll=y=>{var m,E;const P=y.target;(null===(m=null==P?void 0:P.classList)||void 0===m?void 0:m.contains("flatpickr-monthDropdown-months"))||(null===(E=null==P?void 0:P.classList)||void 0===E?void 0:E.contains("flatpickr-input"))||(this.datepickerInstance.close(),this.reshowTimeout&&clearTimeout(this.reshowTimeout),this.reshowTimeout=setTimeout(()=>{this.visibleAndActive()&&this.datepickerInstance.open()},50))},this.initialize(d)}initialize(p){const l=new r.D,d=this.configurationService.startOfWeek(),g=_.extend({},p,{weekNumbers:!0,getWeek:y=>i(y).format("W"),dateFormat:this.datepickerFormat,defaultDate:this.date,locale:{weekdays:{shorthand:l.t("date.abbr_day_names"),longhand:l.t("date.day_names")},months:{shorthand:l.t("date.abbr_month_names").slice(1),longhand:l.t("date.month_names").slice(1)},firstDayOfWeek:d,weekAbbreviation:l.t("date.abbr_week"),rangeSeparator:` ${n.e} `}});let C;C=this.datepickerTarget?u()(this.datepickerTarget,g):u()(this.datepickerElemIdentifier,g),this.datepickerInstance=Array.isArray(C)?C[0]:C,document.addEventListener("scroll",this.hideDuringScroll,!0)}clear(){this.datepickerInstance.clear()}destroy(){this.hide(),this.datepickerInstance.destroy()}hide(){this.isOpen&&this.datepickerInstance.close(),document.removeEventListener("scroll",this.hideDuringScroll,!0)}show(){this.datepickerInstance.open(),document.addEventListener("scroll",this.hideDuringScroll,!0)}setDates(p){this.datepickerInstance.setDate(p)}get isOpen(){return this.datepickerInstance.isOpen}visibleAndActive(){try{return this.isInViewport(this.datepickerCont)&&document.activeElement===this.datepickerCont}catch(p){return console.error(`Failed to test visibleAndActive ${p}`),!1}}isInViewport(p){const l=p.getBoundingClientRect();return l.top>=0&&l.left>=0&&l.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&l.right<=(window.innerWidth||document.documentElement.clientWidth)}}},51590:(H,D,t)=>{"use strict";t.d(D,{e:()=>a,r:()=>p});var i=t(33406),e=t(14882),c=t(14279),u=t(93175),r=t(38519),n=t(2316),h=t(54364);const a="-";class p extends c.J{constructor(){super(...arguments),this.changed=new u.R((0,r.J6)(this)),this.initialDates=[],this.initialValue=""}initializeDatepicker(){this.initialDates=this.initialDates||[],this.initialValue=this.resolveDateArrayToString(this.initialDates);const d={allowInput:!0,appendTo:this.appendTo,mode:"range",onChange:(C,y)=>{this.isEmpty()||(this.inputElement.value=y,2===C.length&&this.changed.emit(this.resolveDateStringToArray(y)))},onKeyDown:(C,y,m,E)=>{E.which===i.m.ESCAPE&&this.canceled.emit()}};let g;g=this.isEmpty()&&this.initialDates.length>0?this.initialDates.map(C=>this.timezoneService.parseISODate(C).toDate()):this.resolveDateStringToArray(this.currentValue),this.datePickerInstance=new e.M(`#${this.id}`,g,d,null,this.configurationService)}onKeyDown(){return!1}resolveDateStringToArray(d){return d.split(` ${a} `).map(g=>g.trim())}resolveDateArrayToString(d){return d.join(` ${a} `)}}p.\u0275fac=function(){let l;return function(g){return(l||(l=n.n5z(p)))(g||p)}}(),p.\u0275cmp=n.Xpm({type:p,selectors:[["op-range-date-picker"]],inputs:{initialDates:"initialDates"},outputs:{changed:"changed"},features:[n.qOj],decls:2,vars:7,consts:[["type","text",3,"id","name","value","ngClass","size","required","disabled","click","keydown.escape","keydown","blur"],["dateInput",""]],template:function(d,g){1&d&&(n.TgZ(0,"input",0,1),n.NdJ("click",function(){return g.openOnClick()})("keydown.escape",function(){return g.close()})("keydown",function(){return g.onKeyDown()})("blur",function(y){return g.closeOnOutsideClick(y)}),n.qZA()),2&d&&n.Q6J("id",g.id)("name",g.name)("value",g.initialValue)("ngClass",g.classes+" op-input")("size",g.size)("required",g.required)("disabled",g.disabled)},directives:[h.mk],encapsulation:2,changeDetection:0})},90547:(H,D,t)=>{"use strict";t.d(D,{S:()=>a});var i=t(33406),e=t(14882),c=t(14279),u=t(93175),r=t(38519),n=t(2316),h=t(54364);class a extends c.J{constructor(){super(...arguments),this.changed=new u.R((0,r.J6)(this)),this.initialDate=""}onInputChange(){this.inputIsValidDate()?this.changed.emit(this.currentValue):this.changed.emit("")}inputIsValidDate(){return null!==/\d{4}-\d{2}-\d{2}/.exec(this.currentValue)}initializeDatepicker(){const l={allowInput:!0,appendTo:this.appendTo,onChange:(g,C)=>{const y=C;this.isEmpty()||(this.inputElement.value=y,this.changed.emit(y))},onKeyDown:(g,C,y,m)=>{m.which===i.m.ESCAPE&&this.canceled.emit()}};let d;d=this.isEmpty()&&this.initialDate?this.timezoneService.parseISODate(this.initialDate).toDate():this.currentValue,this.datePickerInstance=new e.M(`#${this.id}`,d,l,null,this.configurationService)}}a.\u0275fac=function(){let p;return function(d){return(p||(p=n.n5z(a)))(d||a)}}(),a.\u0275cmp=n.Xpm({type:a,selectors:[["op-single-date-picker"]],inputs:{initialDate:"initialDate"},outputs:{changed:"changed"},features:[n.qOj],decls:2,vars:7,consts:[["type","text",3,"id","name","value","ngClass","size","required","disabled","click","keydown.escape","blur","input"],["dateInput",""]],template:function(l,d){1&l&&(n.TgZ(0,"input",0,1),n.NdJ("click",function(){return d.openOnClick()})("keydown.escape",function(){return d.close()})("blur",function(C){return d.closeOnOutsideClick(C)})("input",function(){return d.onInputChange()}),n.qZA()),2&l&&n.Q6J("id",d.id)("name",d.name)("value",d.initialDate||"")("ngClass",d.classes+" op-input")("size",d.size)("required",d.required)("disabled",d.disabled)},directives:[h.mk],encapsulation:2})},75867:(H,D,t)=>{"use strict";t.d(D,{p:()=>h});var i=t(96617),e=t(70233),c=t(65146),u=t(47775),r=t(96905),n=t(2316);class h{constructor(p,l,d,g,C){this.I18n=p,this.$state=l,this.CurrentProject=d,this.PathHelper=g,this.CurrentUser=C,this.staticQueries=[],this.text={assignee:this.I18n.t("js.work_packages.properties.assignee"),author:this.I18n.t("js.work_packages.properties.author"),created_at:this.I18n.t("js.work_packages.properties.createdAt"),updated_at:this.I18n.t("js.work_packages.properties.updatedAt"),status:this.I18n.t("js.work_packages.properties.status"),work_packages:this.I18n.t("js.label_work_package_plural"),gantt:this.I18n.t("js.timelines.gantt_chart"),latest_activity:this.I18n.t("js.work_packages.default_queries.latest_activity"),created_by_me:this.I18n.t("js.work_packages.default_queries.created_by_me"),assigned_to_me:this.I18n.t("js.work_packages.default_queries.assigned_to_me"),recently_created:this.I18n.t("js.work_packages.default_queries.recently_created"),all_open:this.I18n.t("js.work_packages.default_queries.all_open"),summary:this.I18n.t("js.work_packages.default_queries.summary")},this.staticQueries=this.buildQueries()}getStaticName(p){if(this.$state.params.query_props){const l=JSON.parse(this.$state.params.query_props);delete l.pp,delete l.pa;const d=JSON.stringify(l),g=this.staticQueries.find(C=>{const y=C.uiParams;return y&&y.query_props===d});if(g)return g.title}return 1===p.filters.length&&"status"===p.filters[0].id&&"o"===p.filters[0].operator.id?this.text.all_open:this.text.work_packages}buildQueries(){let p=[{title:this.text.all_open,uiSref:"work-packages",uiParams:{query_id:"",query_props:""},view:"WorkPackagesTable"},{title:this.text.latest_activity,uiSref:"work-packages",uiParams:{query_id:"",query_props:'{"c":["id","subject","type","status","assignee","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc","f":[{"n":"status","o":"o","v":[]}]}'},view:"WorkPackagesTable"},{title:this.text.recently_created,uiSref:"work-packages",uiParams:{query_id:"",query_props:'{"c":["id","subject","type","status","assignee","createdAt"],"hi":false,"g":"","t":"createdAt:desc","f":[{"n":"status","o":"o","v":[]}]}'},view:"WorkPackagesTable"},{title:this.text.gantt,uiSref:"work-packages",uiParams:{query_id:"",query_props:'{"c":["id","type","subject","status","startDate","dueDate"],"tv":true,"tzl":"auto","tll":"{\\"left\\":\\"startDate\\",\\"right\\":\\"dueDate\\",\\"farRight\\":\\"subject\\"}","hi":true,"g":"","t":"startDate:asc","f":[{"n":"status","o":"o","v":[]}]}'},view:"WorkPackagesTable"},{title:this.text.all_open,uiSref:"bim.partitioned.list",uiParams:{query_id:"",query_props:'{"c":["id","subject","bcfThumbnail","type","status","assignee","updatedAt"],"t":"id:desc"}'},view:"Bim"},{title:this.text.latest_activity,uiSref:"bim.partitioned.list",uiParams:{query_id:"",query_props:'{"c":["id","subject","bcfThumbnail","type","status","assignee","updatedAt"],"t":"updatedAt:desc","f":[{"n":"status","o":"o","v":[]}]}'},view:"Bim"},{title:this.text.recently_created,uiSref:"bim.partitioned.list",uiParams:{query_id:"",query_props:'{"c":["id","subject","bcfThumbnail","type","status","assignee","createdAt"],"t":"createdAt:desc","f":[{"n":"status","o":"o","v":[]}]}'},view:"Bim"}];const l=this.CurrentProject.identifier;return l&&(p=[...p,...this.projectDependentQueries(l)]),this.CurrentUser.isLoggedIn&&(p=[...p,...this.userDependentQueries()]),p}getStaticQueriesForView(p){return this.staticQueries.filter(l=>l.view===p)}projectDependentQueries(p){return[{title:this.text.summary,href:`${this.PathHelper.projectWorkPackagesPath(p)}/report`,view:"WorkPackagesTable"}]}userDependentQueries(){return[{title:this.text.created_by_me,uiSref:"work-packages",uiParams:{query_id:"",query_props:'{"c":["id","subject","type","status","assignee","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc,id:asc","f":[{"n":"status","o":"o","v":[]},{"n":"author","o":"=","v":["me"]}]}'},view:"WorkPackagesTable"},{title:this.text.assigned_to_me,uiSref:"work-packages",uiParams:{query_id:"",query_props:'{"c":["id","subject","type","status","author","updatedAt"],"hi":false,"g":"","t":"updatedAt:desc,id:asc","f":[{"n":"status","o":"o","v":[]},{"n":"assigneeOrGroup","o":"=","v":["me"]}]}'},view:"WorkPackagesTable"},{title:this.text.created_by_me,uiSref:"bim.partitioned.list",uiParams:{query_id:"",query_props:'{"c":["id","subject","bcfThumbnail","type","status","assignee","updatedAt"],"t":"id:desc","f":[{"n":"status","o":"o","v":[]},{"n":"author","o":"=","v":["me"]}]}'},view:"Bim"},{title:this.text.assigned_to_me,uiSref:"bim.partitioned.list",uiParams:{query_id:"",query_props:'{"c":["id","subject","bcfThumbnail","type","status","author","updatedAt"],"t":"id:desc","f":[{"n":"status","o":"o","v":[]},{"n":"assigneeOrGroup","o":"=","v":["me"]}]}'},view:"Bim"}]}}h.\u0275fac=function(p){return new(p||h)(n.LFG(i.D),n.LFG(u.StateService),n.LFG(c.R),n.LFG(e.j),n.LFG(r.S))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac})},46862:(H,D,t)=>{"use strict";function i(c){return c.href?c.href||"":c._links&&c._links.self.href||""}function e(c){const u=/\/(user|group|placeholder_user)s\/\d+$/.exec(c);return u?u[1]:null}t.d(D,{S:()=>i,l:()=>e})},13964:(H,D,t)=>{"use strict";t.d(D,{C:()=>h});var i=t(70233),e=t(52167),c=t(20979),u=t(10190),r=t(46862),n=t(2316);class h{constructor(p,l,d){this.pathHelper=p,this.apiV3Service=l,this.colors=d}renderMultiple(p,l,d={hide:!1,link:!1},g={hide:!1,size:"default"},C=!1){p.classList.add("op-principal");const y=document.createElement("span");for(let m=0;m<l.length;m++){const E=document.createElement("span");if(C&&E.classList.add("op-principal--multi-line"),this.render(E,l[m],d,g),y.appendChild(E),!C&&m<l.length-1){const P=document.createElement("span");P.textContent=", ",y.appendChild(P)}}p.appendChild(y)}render(p,l,d={hide:!1,link:!0},g={hide:!1,size:"default"}){p.classList.add("op-principal");const C=(0,r.l)((0,r.S)(l));if(!g.hide){const y=this.renderAvatar(l,g,C);p.appendChild(y)}if(!d.hide){const y=this.renderName(l,C,d.link);p.appendChild(y)}}renderAvatar(p,l,d){const g=this.getInitials(p.name),C=this.colors.toHsl(p.name),y=document.createElement("div");return y.classList.add("op-principal--avatar"),y.classList.add("op-avatar"),y.classList.add(`op-avatar_${l.size}`),y.classList.add(`op-avatar_${d.replace("_","-")}`),y.classList.add("op-avatar--fallback"),y.title=p.name,y.textContent=g,"placeholder_user"===d?(y.style.color=C,y.style.borderColor=C):y.style.background=C,"user"===d&&this.renderUserAvatar(p,y,l),y}renderUserAvatar(p,l,d){const g=this.userAvatarUrl(p);if(!g)return;const C=new Image;C.classList.add("op-avatar"),C.classList.add(`op-avatar_${d.size}`),C.src=g,C.title=p.name,C.alt=p.name,C.onload=()=>{l.replaceWith(C),l=void 0}}userAvatarUrl(p){const l=p.id||(0,u.Z)((0,r.S)(p));return l?this.apiV3Service.users.id(l).avatar.toString():null}renderName(p,l,d=!0){if(d){const C=document.createElement("a");return C.textContent=p.name,C.href=this.principalURL(p,l),C.target="_blank",C.classList.add("op-principal--name"),C}const g=document.createElement("span");return g.textContent=p.name,g.classList.add("op-principal--name"),g}principalURL(p,l){const d=(0,r.S)(p),g=p.id||(d?(0,u.Z)(d):"");switch(l){case"group":return this.pathHelper.groupPath(g);case"placeholder_user":return this.pathHelper.placeholderUserPath(g);case"user":return this.pathHelper.userPath(g);default:throw new Error("Invalid principal type provided")}}getInitials(p){var l,d;const g=[...p],C=p.lastIndexOf(" ");return[null===(l=g[0])||void 0===l?void 0:l.toUpperCase(),null===(d=p[C+1])||void 0===d?void 0:d.toUpperCase()].join("")}}h.\u0275fac=function(p){return new(p||h)(n.LFG(i.j),n.LFG(c.T),n.LFG(e.c))},h.\u0275prov=n.Yz7({token:h,factory:h.\u0275fac,providedIn:"root"})},32824:(H,D,t)=>{"use strict";t.d(D,{j:()=>u});var i=t(54364),e=t(13964),c=t(2316);class u{}u.\u0275fac=function(n){return new(n||u)},u.\u0275mod=c.oAB({type:u}),u.\u0275inj=c.cJS({providers:[e.C],imports:[[i.ez]]})},3742:(H,D,t)=>{"use strict";t.d(D,{y:()=>l,N:()=>d});var i=t(3786),e=t(2316),c=t(96617),u=t(70233),r=t(20979),n=t(70692),h=t(13964),a=t(58004),p=t(32042);const l="op-principal";let d=class{constructor(C,y,m,E,P,w,x){this.elementRef=C,this.PathHelper=y,this.principalRenderer=m,this.principalResourceService=E,this.I18n=P,this.apiV3Service=w,this.timezoneService=x,this.hideAvatar=!1,this.hideName=!1,this.link=!0,this.size="default"}ngOnInit(){!this.principal.name||this.principalRenderer.render(this.elementRef.nativeElement,this.principal,{hide:this.hideName,link:this.link},{hide:this.hideAvatar,size:this.size})}};d.\u0275fac=function(C){return new(C||d)(e.Y36(e.SBq),e.Y36(u.j),e.Y36(h.C),e.Y36(p.P),e.Y36(c.D),e.Y36(r.T),e.Y36(n.B))},d.\u0275cmp=e.Xpm({type:d,selectors:[["op-principal"]],inputs:{principal:"principal",hideAvatar:"hideAvatar",hideName:"hideName",link:"link",size:"size"},decls:0,vars:0,template:function(C,y){},encapsulation:2,changeDetection:0}),d=(0,i.gn)([a.z,(0,i.w6)("design:paramtypes",[e.SBq,u.j,h.C,p.P,c.D,r.T,n.B])],d)},35561:(H,D,t)=>{"use strict";t.d(D,{P:()=>it});var i=t(96617),e=t(76491),c=t(61486),u=t(33927),r=t(83720),n=t(80639),h=t(85816),a=t(53466),p=t(92597),l=t(71435),d=t(20979),g=t(73726),C=t(74647),y=t(20066),m=t(26942),E=t(91923),P=t(65146);const w=(Ve,Ie,ue,ie)=>{if(!ie.length)return[...ue,{id:Ie.id,name:Ie.name,href:Ie._links.self.href,found:!0,children:[]}];const R=ie[0].href,L=ue.find(oe=>oe.href===R);if(L)return L.children=w(Ve,Ie,L.children,ie.slice(1)),[...ue];const W=Ve.find(oe=>oe._links.self.href===R);return W?[...ue,{id:W.id,name:W.name,href:W._links.self.href,found:!1,children:w(Ve,Ie,[],ie.slice(1))}]:[...ue]},x=Ve=>Ve.map(Ie=>Object.assign(Object.assign({},Ie),{children:x(Ie.children)})).sort((Ie,ue)=>Ie.name.localeCompare(ue.name));var k=t(23237),b=t(2316),v=t(53882),M=t(21090),S=t(54364),O=t(91448),A=t(1707),F=t(87912),I=t(1476),J=t(1706),N=t(48705);class te{constructor(Ie){this.elementRef=Ie,this.query=""}ngAfterViewChecked(){if(!this.query)return;const Ie=this.elementRef.nativeElement,ue=Array.from(Ie.childNodes).find(Xe=>Xe.nodeType===Xe.TEXT_NODE),ie=(null==ue?void 0:ue.textContent)||"";if(!ie)return;const R=this.query.toLowerCase(),L=ie.toLowerCase().indexOf(R);if(L<0)return;const W=ie.slice(0,L),oe=ie.slice(L,L+R.length),Oe=ie.slice(L+R.length),$=document.createElement("span");$.innerHTML=`${W}<span class="op-search-highlight">${oe}</span>${Oe}`,Ie.replaceChild($,ue)}}te.\u0275fac=function(Ie){return new(Ie||te)(b.Y36(b.SBq))},te.\u0275dir=b.lG2({type:te,selectors:[["","opSearchHighlight",""]],inputs:{query:["opSearchHighlight","query"]}});function G(Ve,Ie){if(1&Ve){const ue=b.EpF();b.TgZ(0,"spot-checkbox",10),b.NdJ("change",function(){b.CHM(ue);const R=b.oxw().$implicit;return b.oxw().changeSelected(R)}),b.qZA()}if(2&Ve){const ue=Ie.$implicit,ie=b.oxw().$implicit,R=b.oxw();b.Q6J("checked",ue||R.includeSubprojects&&R.parentChecked)("disabled",R.isDisabled(ie)),b.uIk("data-qa-project-include-id",ie.id)("data-qa-project-include-checked",ue||R.includeSubprojects&&R.parentChecked?1:0)}}function se(Ve,Ie){if(1&Ve&&(b.TgZ(0,"span"),b._uU(1),b.qZA()),2&Ve){const ue=b.oxw(2);b.xp6(1),b.Oqu(ue.text.include_all_selected)}}function me(Ve,Ie){if(1&Ve&&(b.TgZ(0,"span"),b._uU(1),b.qZA()),2&Ve){const ue=b.oxw(2);b.xp6(1),b.Oqu(ue.text.current_project)}}function _e(Ve,Ie){if(1&Ve){const ue=b.EpF();b.TgZ(0,"ul",11),b.NdJ("update",function(R){return b.CHM(ue),b.oxw(2).updateSelected(R)}),b.qZA()}if(2&Ve){const ue=b.oxw().$implicit,ie=b.oxw();b.Q6J("projects",ue.children)("selected",ie.selected)("includeSubprojects",ie.includeSubprojects)("parentChecked",ie.parentChecked||ie.isChecked(ue.href))("searchText",ie.searchText)}}const he=function(Ve){return{"spot-list--item-action_disabled":Ve}},ae=function(Ve){return[Ve]};function re(Ve,Ie){if(1&Ve&&(b.TgZ(0,"li",1),b.TgZ(1,"label",2),b.TgZ(2,"spot-tooltip",3),b.ynx(3,4),b.YNc(4,G,1,4,"spot-checkbox",5),b.TgZ(5,"div",6),b._uU(6),b.qZA(),b.BQk(),b.TgZ(7,"p",7),b.YNc(8,se,2,1,"span",8),b.YNc(9,me,2,1,"span",8),b.qZA(),b.qZA(),b.qZA(),b.YNc(10,_e,1,5,"ul",9),b.qZA()),2&Ve){const ue=Ie.$implicit,ie=Ie.first,R=Ie.last,L=b.oxw();b.xp6(1),b.Q6J("ngClass",b.VKq(11,he,L.isDisabled(ue))),b.xp6(1),b.Q6J("alignment",L.getAlignment(ue,ie,R))("disabled",!L.isDisabled(ue))("dark",!0),b.xp6(2),b.Q6J("ngForOf",b.VKq(13,ae,L.isChecked(ue.href))),b.xp6(1),b.Q6J("opSearchHighlight",L.searchText)("title",ue.name),b.xp6(1),b.Oqu(ue.name),b.xp6(2),b.Q6J("ngIf",L.includeSubprojects&&L.parentChecked),b.xp6(1),b.Q6J("ngIf",ue.href===L.currentProjectHref),b.xp6(1),b.Q6J("ngIf",ue.children.length)}}class ye{constructor(Ie,ue){this.I18n=Ie,this.currentProjectService=ue,this.classNameList=!0,this.className=!0,this.update=new b.vpe,this.root=!1,this.projects=[],this.selected=[],this.searchText="",this.includeSubprojects=!1,this.parentChecked=!1,this.text={include_all_selected:this.I18n.t("js.include_projects.tooltip.include_all_selected"),current_project:this.I18n.t("js.include_projects.tooltip.current_project")}}get currentProjectHref(){return this.currentProjectService.apiv3Path}isDisabled(Ie){return Ie.href===this.currentProjectHref||this.includeSubprojects&&this.parentChecked}updateSelected(Ie){this.update.emit(Ie)}isChecked(Ie){return this.selected.includes(Ie)}changeSelected(Ie){const{href:ue}=Ie,ie=this.isChecked(ue);this.isDisabled(Ie)||(ie?this.updateSelected(this.selected.filter(L=>L!==ue)):this.updateSelected([...this.selected,ue]))}getAlignment(Ie,ue,ie){return this.root&&ue?ie&&!Ie.children.length?J.Z.RightCenter:J.Z.BottomLeft:J.Z.TopLeft}}ye.\u0275fac=function(Ie){return new(Ie||ye)(b.Y36(i.D),b.Y36(P.R))},ye.\u0275cmp=b.Xpm({type:ye,selectors:[["","op-project-list",""]],hostVars:4,hostBindings:function(Ie,ue){2&Ie&&b.ekj("spot-list",ue.classNameList)("op-project-list",ue.className)},inputs:{root:"root",projects:"projects",selected:"selected",searchText:"searchText",includeSubprojects:"includeSubprojects",parentChecked:"parentChecked"},outputs:{update:"update"},attrs:["op-project-list",""],decls:1,vars:1,consts:[["class","spot-list--item",4,"ngFor","ngForOf"],[1,"spot-list--item"],[1,"spot-list--item-action","op-project-list--item-action",3,"ngClass"],[1,"op-project-list--tooltip",3,"alignment","disabled","dark"],["slot","trigger"],[3,"checked","disabled","change",4,"ngFor","ngForOf"],[1,"spot-list--item-title","op-project-list--item-title",3,"opSearchHighlight","title"],["slot","body",1,"spot-body-small"],[4,"ngIf"],["op-project-list","",3,"projects","selected","includeSubprojects","parentChecked","searchText","update",4,"ngIf"],[3,"checked","disabled","change"],["op-project-list","",3,"projects","selected","includeSubprojects","parentChecked","searchText","update"]],template:function(Ie,ue){1&Ie&&b.YNc(0,re,11,15,"li",0),2&Ie&&b.Q6J("ngForOf",ue.projects)},directives:[S.sg,S.mk,N.s,te,S.O5,I.B,ye],styles:[".op-project-list--item-action[_ngcontent-%COMP%]{display:flex}.op-project-list--child-toggle[_ngcontent-%COMP%]{opacity:0;width:0;height:0;margin-left:auto}.op-project-list--item-action[_ngcontent-%COMP%]:hover   .op-project-list--child-toggle[_ngcontent-%COMP%], .op-project-list--child-toggle[_ngcontent-%COMP%]:focus{opacity:1;width:auto;height:auto}.op-project-list--tooltip[_ngcontent-%COMP%]{max-width:100%}.op-project-list--item-title[_ngcontent-%COMP%]{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}"],changeDetection:0});var Ce=t(70099);function ke(Ve,Ie){if(1&Ve&&b._UZ(0,"span",20),2&Ve){const ue=Ie.ngIf;b.Q6J("textContent",ue)}}function Ae(Ve,Ie){if(1&Ve){const ue=b.EpF();b.ynx(0),b.TgZ(1,"ul",21),b.NdJ("update",function(R){b.CHM(ue);return b.oxw().selectedProjects=R}),b.ALo(2,"async"),b.ALo(3,"async"),b.qZA(),b.BQk()}if(2&Ve){const ue=b.oxw();b.xp6(1),b.Q6J("projects",b.lcZ(2,5,ue.projects$))("selected",ue.selectedProjects)("includeSubprojects",b.lcZ(3,7,ue.includeSubprojects$))("searchText",ue.searchText)("root",!0)}}function Fe(Ve,Ie){1&Ve&&(b.TgZ(0,"op-content-loader",22),b.O4$(),b._UZ(1,"rect",23),b._UZ(2,"rect",24),b._UZ(3,"rect",25),b._UZ(4,"rect",26),b._UZ(5,"rect",27),b._UZ(6,"rect",28),b._UZ(7,"rect",29),b._UZ(8,"rect",30),b._UZ(9,"rect",31),b._UZ(10,"rect",32),b._UZ(11,"rect",33),b._UZ(12,"rect",34),b._UZ(13,"rect",35),b._UZ(14,"rect",36),b._UZ(15,"rect",37),b._UZ(16,"rect",38),b._UZ(17,"rect",39),b._UZ(18,"rect",40),b.qZA())}const ot=function(){return{standalone:!0}};class it extends m.N{constructor(Ie,ue,ie,R,L,W,oe){super(),this.apiV3Service=Ie,this.I18n=ue,this.http=ie,this.wpTableFilters=R,this.wpIncludeSubprojects=L,this.halResourceService=W,this.currentProjectService=oe,this.className=!0,this.text={toggle_title:this.I18n.t("js.include_projects.toggle_title"),title:this.I18n.t("js.include_projects.title"),filter_all:this.I18n.t("js.include_projects.selected_filter.all"),filter_selected:this.I18n.t("js.include_projects.selected_filter.selected"),search_placeholder:this.I18n.t("js.include_projects.search_placeholder"),clear_selection:this.I18n.t("js.include_projects.clear_selection"),apply:this.I18n.t("js.include_projects.apply"),include_subprojects:this.I18n.t("js.include_projects.include_subprojects")},this.opened=!1,this.query$=this.wpTableFilters.querySpace.query.values$(),this.displayModeOptions=[{value:"all",title:this.text.filter_all},{value:"selected",title:this.text.filter_selected}],this._displayMode="all",this.displayMode$=new e.X("all"),this._searchText="",this.searchText$=new e.X(""),this._includeSubprojects=!0,this.includeSubprojects$=new e.X(!0),this._selectedProjects=[],this.selectedProjects$=new e.X([]),this.projectsInFilter$=this.wpTableFilters.live$().pipe(this.untilDestroyed(),(0,u.U)(Oe=>{const $=Oe.find(be=>"ProjectQueryFilter"===be._type),Xe=((null==$?void 0:$.values)||[]).map(be=>be.href),rt=this.currentProjectService.apiv3Path;if(Xe.includes(rt))return Xe;const ge=[...Xe];return rt&&ge.push(rt),ge})),this.numberOfProjectsInFilter$=this.projectsInFilter$.pipe((0,u.U)(Oe=>Oe.length)),this.allProjects$=new e.X([]),this.projects$=(0,c.aj)([this.allProjects$,this.displayMode$.pipe((0,r.x)()),this.includeSubprojects$,this.searchText$.pipe((0,n.b)(200))]).pipe((0,n.b)(50),(0,h.zg)(([Oe,$,Xe,rt])=>this.selectedProjects$.pipe((0,a.q)(1),(0,u.U)(ge=>[Oe,$,Xe,rt,ge]))),(0,u.U)(([Oe,$,Xe,rt,ge])=>Oe.filter(be=>{if(rt.length&&!be.name.toLowerCase().includes(rt.toLowerCase())&&!be.identifier.toLowerCase().includes(rt.toLowerCase()))return!1;if("selected"!==$||ge.includes(be._links.self.href))return!0;const Me=be._links.ancestors.reduce((Re,$e)=>Re||ge.includes($e.href),!1);return!(!Xe||!Me)}).sort((be,Me)=>be._links.ancestors.length-Me._links.ancestors.length).reduce((be,Me)=>{const{ancestors:Re}=Me._links;return w(Oe,Me,be,Re)},[])),(0,u.U)(Oe=>x(Oe)),(0,p.d)()),this.fetchingProjects$=new e.X(!1),this.loading$=(0,c.aj)([this.fetchingProjects$,this.projects$]).pipe((0,u.U)(([Oe,$])=>Oe||0===$.length))}get displayMode(){return this._displayMode}set displayMode(Ie){this._displayMode=Ie,this.displayMode$.next(Ie)}get searchText(){return this._searchText}set searchText(Ie){this._searchText=Ie,this.searchText$.next(Ie)}get includeSubprojects(){return this._includeSubprojects}set includeSubprojects(Ie){this._includeSubprojects=Ie,this.includeSubprojects$.next(Ie)}get selectedProjects(){return this._selectedProjects}set selectedProjects(Ie){this._selectedProjects=Ie,this.selectedProjects$.next(Ie)}get params(){return{filters:[["active","=",["t"]]],pageSize:-1,select:["elements/id","elements/name","elements/identifier","elements/self","elements/ancestors","total","count","pageSize"]}}ngOnInit(){this.query$.pipe((0,u.U)(Ie=>Ie.includeSubprojects),(0,r.x)()).subscribe(Ie=>{this.includeSubprojects=Ie})}toggleIncludeSubprojects(){this.wpIncludeSubprojects.setIncludeSubprojects(!this.wpIncludeSubprojects.current)}toggleOpen(){this.opened=!this.opened,this.opened&&(this.loadAllProjects(),this.projectsInFilter$.pipe((0,a.q)(1)).subscribe(Ie=>{this.displayMode="all",this.searchText="",this.selectedProjects=Ie}))}loadAllProjects(){this.fetchingProjects$.next(!0),(0,k.rP)(Ie=>{const ue=(0,g.g)(Object.assign(Object.assign({},this.params),Ie));return this.http.get(this.apiV3Service.projects.path+ue)}).pipe((0,l.x)(()=>this.fetchingProjects$.next(!1))).subscribe(Ie=>{this.allProjects$.next(Ie)})}clearSelection(){this.selectedProjects=[this.currentProjectService.apiv3Path||""]}onSubmit(Ie){Ie.preventDefault(),this.wpTableFilters.replace("project",ue=>{const ie=this.selectedProjects;ue.values=ie.map(R=>this.halResourceService.createHalResource({href:R},!0))}),this.wpIncludeSubprojects.update(this.includeSubprojects),this.close()}close(){this.opened=!1}}it.\u0275fac=function(Ie){return new(Ie||it)(b.Y36(d.T),b.Y36(i.D),b.Y36(v.eN),b.Y36(C.Z),b.Y36(y.F),b.Y36(E.u),b.Y36(P.R))},it.\u0275cmp=b.Xpm({type:it,selectors:[["op-project-include"]],hostVars:2,hostBindings:function(Ie,ue){2&Ie&&b.ekj("op-project-include",ue.className)},features:[b.qOj],decls:31,vars:31,consts:[["alignment","bottom-right",3,"open","closed"],["slot","trigger","type","button","data-qa-selector","project-include-button",1,"button",3,"click"],["class","badge -secondary",3,"textContent",4,"ngIf"],["slot","body"],[1,"op-project-include--header"],[1,"op-project-include--title"],[3,"options","ngModel","ngModelChange"],[1,"spot-container","op-project-include--body",3,"submit"],["name","project-include-search","data-qa-selector","project-include-search",3,"disabled","placeholder","ngModel","ngModelOptions","ngModelChange"],["slot","before",1,"spot-icon","spot-icon_search"],[4,"ngIf","ngIfElse"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],[1,"op-project-include--include-all"],["data-qa-project-include-all-subprojects","1",3,"ngModel","ngModelOptions","ngModelChange"],[1,"op-project-include--include-all-text"],[1,"spot-action-bar--right"],["type","button",1,"button",3,"disabled","click"],[1,"button","-highlight",3,"disabled"],["loadingTemplate",""],[1,"badge","-secondary",3,"textContent"],["op-project-list","","data-qa-selector","project-include-list",1,"op-project-include--list",3,"projects","selected","includeSubprojects","searchText","root","update"],["data-qa-selector","op-project-include--loading","viewBox","0 0 200 140",1,"op-project-include--loading"],["x","0","width","12","height","12","rx","1"],["x","15","width","100%","height","12","rx","1"],["x","10","y","16","width","12","height","12","rx","1"],["x","25","y","16","width","100%","height","12","rx","1"],["x","10","y","32","width","12","height","12","rx","1"],["x","25","y","32","width","100%","height","12","rx","1"],["x","20","y","48","width","12","height","12","rx","1"],["x","35","y","48","width","100%","height","12","rx","1"],["x","20","y","64","width","12","height","12","rx","1"],["x","35","y","64","width","100%","height","12","rx","1"],["x","0","y","80","width","12","height","12","rx","1"],["x","15","y","80","width","100%","height","12","rx","1"],["x","10","y","96","width","12","height","12","rx","1"],["x","25","y","96","width","100%","height","12","rx","1"],["x","10","y","112","width","12","height","12","rx","1"],["x","25","y","112","width","100%","height","12","rx","1"],["x","0","y","128","width","12","height","12","rx","1"],["x","15","y","128","width","100%","height","12","rx","1"]],template:function(Ie,ue){if(1&Ie&&(b.TgZ(0,"spot-drop-modal",0),b.NdJ("closed",function(){return ue.opened=!1}),b.TgZ(1,"button",1),b.NdJ("click",function(){return ue.toggleOpen()}),b._uU(2),b.YNc(3,ke,1,1,"span",2),b.ALo(4,"async"),b.qZA(),b.ynx(5,3),b.TgZ(6,"div",4),b.TgZ(7,"h1",5),b._uU(8),b.qZA(),b.TgZ(9,"spot-toggle",6),b.NdJ("ngModelChange",function(R){return ue.displayMode=R}),b.qZA(),b.qZA(),b.TgZ(10,"form",7),b.NdJ("submit",function(R){return ue.onSubmit(R)}),b.TgZ(11,"spot-text-field",8),b.NdJ("ngModelChange",function(R){return ue.searchText=R}),b.ALo(12,"async"),b._UZ(13,"span",9),b.qZA(),b.YNc(14,Ae,4,9,"ng-container",10),b.ALo(15,"async"),b.TgZ(16,"div",11),b.TgZ(17,"div",12),b.TgZ(18,"label",13),b.TgZ(19,"spot-checkbox",14),b.NdJ("ngModelChange",function(R){return ue.includeSubprojects=R}),b.qZA(),b.TgZ(20,"span",15),b._uU(21),b.qZA(),b.qZA(),b.qZA(),b.TgZ(22,"div",16),b.TgZ(23,"button",17),b.NdJ("click",function(){return ue.clearSelection()}),b.ALo(24,"async"),b._uU(25),b.qZA(),b.TgZ(26,"button",18),b.ALo(27,"async"),b._uU(28),b.qZA(),b.qZA(),b.qZA(),b.qZA(),b.BQk(),b.qZA(),b.YNc(29,Fe,19,0,"ng-template",null,19,b.W1O)),2&Ie){const ie=b.MAs(30);b.Q6J("open",ue.opened),b.xp6(2),b.hij(" ",ue.text.toggle_title," "),b.xp6(1),b.Q6J("ngIf",b.lcZ(4,19,ue.numberOfProjectsInFilter$)),b.xp6(5),b.Oqu(ue.text.title),b.xp6(1),b.Q6J("options",ue.displayModeOptions)("ngModel",ue.displayMode),b.xp6(2),b.Q6J("disabled",b.lcZ(12,21,ue.loading$))("placeholder",ue.text.search_placeholder)("ngModel",ue.searchText)("ngModelOptions",b.DdM(29,ot)),b.xp6(3),b.Q6J("ngIf",!1===b.lcZ(15,23,ue.loading$))("ngIfElse",ie),b.xp6(5),b.Q6J("ngModel",ue.includeSubprojects)("ngModelOptions",b.DdM(30,ot)),b.xp6(2),b.Oqu(ue.text.include_subprojects),b.xp6(2),b.Q6J("disabled",b.lcZ(24,25,ue.loading$)),b.xp6(2),b.hij(" ",ue.text.clear_selection," "),b.xp6(1),b.Q6J("disabled",b.lcZ(27,27,ue.loading$)),b.xp6(2),b.hij(" ",ue.text.apply," ")}},directives:[M.m,S.O5,O.v,A.JJ,A.On,A._Y,A.JL,A.F,F.A,I.B,ye,Ce.V],pipes:[S.Ov],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media screen and (min-width: 1000px) and (min-height: 500px){  .spot-drop-modal--body{width:460px}}.op-project-include--header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:1rem}.op-project-include--title[_ngcontent-%COMP%]{margin:0;padding:0;font-family:Lato,sans-serif;font-size:1.25rem;font-weight:bold;font-style:normal;line-height:1.75rem}.op-project-include--body[_ngcontent-%COMP%]{flex-shrink:1;flex-basis:100%;overflow:hidden}@media screen and (min-width: 1000px) and (min-height: 500px){.op-project-include--body[_ngcontent-%COMP%]{max-height:70vh}}.op-project-include--list[_ngcontent-%COMP%]{scrollbar-color:transparent transparent;scrollbar-width:thin;overflow-y:auto;flex-shrink:1;flex-basis:100%}.op-project-include--list[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.op-project-include--list[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.op-project-include--list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.op-project-include--list[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.op-project-include--list[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.op-project-include--loading[_ngcontent-%COMP%]{padding:1rem}.op-project-include--include-all[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer}.op-project-include--include-all-text[_ngcontent-%COMP%]{padding-top:1px;margin-left:.5rem}"],changeDetection:0})},83609:(H,D,t)=>{"use strict";t.d(D,{d:()=>n});var i=t(2316),e=t(87873),c=t(54364);function u(h,a){if(1&h&&i._UZ(0,"div",1),2&h){const p=i.oxw();i.Q6J("ngClass",p.resizerClass)}}class n{constructor(){this.resizing=!1,this.end=new i.vpe,this.start=new i.vpe,this.move=new i.vpe,this.customHandler=!1,this.cursorClass="nwse-resize",this.resizerClass="resizer"}ngOnDestroy(){this.removeEventListener()}startResize(a){a.preventDefault(),a.stopPropagation(),(1===a.buttons||1===a.which||0===a.which)&&(this.oldX=this.startX=a.clientX||a.pageX||a.touches[0].clientX,this.oldY=this.startY=a.clientY||a.pageY||a.touches[0].clientY,this.newX=a.clientX||a.pageX||a.touches[0].clientX,this.newY=a.clientY||a.pageY||a.touches[0].clientY,this.resizing=!0,this.setResizeCursor(),this.bindEventListener(a),this.start.emit(this.buildDelta(a)))}onMouseUp(a){this.setAutoCursor(),this.removeEventListener(),this.end.emit(this.buildDelta(a))}onMouseMove(a){a.preventDefault(),a.stopPropagation(),this.oldX=this.newX,this.oldY=this.newY,this.newX=a.clientX||a.pageX||a.touches[0].clientX,this.newY=a.clientY||a.pageY||a.touches[0].clientX,this.move.emit(this.buildDelta(a))}bindEventListener(a){this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),window.addEventListener("mousemove",this.mouseMoveHandler),window.addEventListener("touchmove",this.mouseMoveHandler),window.addEventListener("mouseup",this.mouseUpHandler),window.addEventListener("touchend",this.mouseUpHandler)}removeEventListener(){window.removeEventListener("touchmove",this.mouseMoveHandler),window.removeEventListener("mousemove",this.mouseMoveHandler),window.removeEventListener("mouseup",this.mouseUpHandler),window.removeEventListener("touchend",this.mouseUpHandler)}setResizeCursor(){(0,e.h)(this.cursorClass,"important")}setAutoCursor(){(0,e.h)("auto")}buildDelta(a){return{origin:a,absolute:{x:this.newX-this.startX,y:this.newY-this.startY},relative:{x:this.newX-this.oldX,y:this.newY-this.oldX}}}}n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["resizer"]],hostBindings:function(a,p){1&a&&i.NdJ("mousedown",function(d){return p.startResize(d)})("touchstart",function(d){return p.startResize(d)})},inputs:{customHandler:"customHandler",cursorClass:"cursorClass",resizerClass:"resizerClass"},outputs:{end:"end",start:"start",move:"move"},ngContentSelectors:["*"],decls:2,vars:1,consts:[[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function(a,p){1&a&&(i.F$t(),i.YNc(0,u,1,1,"div",0),i.Hsn(1)),2&a&&i.Q6J("ngIf",!p.customHandler)},directives:[c.O5,c.mk],encapsulation:2})},87947:(H,D,t)=>{"use strict";t.d(D,{H:()=>l});var i=t(83720),e=t(80639),c=t(47775),u=t(1056),r=t(26942),n=t(82516),h=t(83835),a=t(2316),p=t(83609);class l extends r.N{constructor(g,C,y,m){super(),this.toggleService=g,this.elementRef=C,this.$transitions=y,this.browserDetector=m,this.resizeStyle="flexBasis",this.elementMinWidth=530,this.moving=!1,this.resizerClass="work-packages--resizer icon-resizer-vertical-lines"}ngOnInit(){this.resizingElement=document.getElementsByClassName(this.elementClass)[0];const g=this.parseLocalStorageValue();this.elementWidth=g||(this.resizingElement.offsetWidth<this.elementMinWidth?this.elementMinWidth:this.resizingElement.offsetWidth),0===this.elementWidth&&this.resizingElement.parentElement&&(this.elementWidth=this.resizingElement.parentElement.offsetWidth/2),this.resizingElement.style[this.resizeStyle]=`${this.elementWidth}px`,this.element=this.elementRef.nativeElement,this.toggleService.changeData$.pipe((0,i.x)(),this.untilDestroyed(),(0,e.b)(100)).subscribe(()=>{this.applyColumnLayout()}),(0,n.R)(window,"resize",{passive:!0}).pipe(this.untilDestroyed(),(0,e.b)(250)).subscribe(()=>this.applyColumnLayout())}ngAfterViewInit(){this.resizer=this.elementRef.nativeElement.getElementsByClassName(this.resizerClass)[0],this.applyColumnLayout()}ngOnDestroy(){super.ngOnDestroy(),this.resizingElement.style[this.resizeStyle]=""}resizeStart(){const g=this.parseLocalStorageValue(),C=this.resizingElement.offsetWidth;g&&g>C&&(this.elementWidth=C)}resizeEnd(){const g=this.parseLocalStorageValue();g&&(this.elementWidth=g);const C=new Event(this.resizeEvent);window.dispatchEvent(C),this.manageErrorClass(!1)}resizeMove(g){let C;this.elementWidth-=g.relative.x,this.elementWidth<this.elementMinWidth?(C=this.elementMinWidth,this.manageErrorClass(!0)):(C=this.elementWidth,this.manageErrorClass(!1)),window.OpenProject.guardedLocalStorage(this.localStorageKey,`${C}`),this.applyColumnLayout(),this.resizingElement.style[this.resizeStyle]=`${C}px`}parseLocalStorageValue(){const g=window.OpenProject.guardedLocalStorage(this.localStorageKey),C=parseInt(g||"",10);if("number"==typeof C&&NaN!==C)return C}applyColumnLayout(g=750){const C=document.querySelectorAll("[data-selector='wp-single-view']")[0];C&&jQuery(C).toggleClass("work-package--single-view_with-columns",C.offsetWidth>g)}manageErrorClass(g){g&&!this.resizer.classList.contains("-error-font")&&this.resizer.classList.add("-error-font"),!g&&this.resizer.classList.contains("-error-font")&&this.resizer.classList.remove("-error-font")}}l.\u0275fac=function(g){return new(g||l)(a.Y36(h.J),a.Y36(a.SBq),a.Y36(c.TransitionService),a.Y36(u.o))},l.\u0275cmp=a.Xpm({type:l,selectors:[["wp-resizer"]],inputs:{elementClass:"elementClass",resizeEvent:"resizeEvent",localStorageKey:"localStorageKey",resizeStyle:"resizeStyle"},features:[a.qOj],decls:1,vars:2,consts:[["cursorClass","col-resize",3,"customHandler","resizerClass","end","start","move"]],template:function(g,C){1&g&&(a.TgZ(0,"resizer",0),a.NdJ("end",function(){return C.resizeEnd()})("start",function(){return C.resizeStart()})("move",function(m){return C.resizeMove(m)}),a.qZA()),2&g&&a.Q6J("customHandler",!1)("resizerClass",C.resizerClass)},directives:[p.d],encapsulation:2,changeDetection:0})},47124:(H,D,t)=>{"use strict";t.d(D,{F:()=>r,w:()=>n});var i=t(2316),e=t(54364),c=t(1707);const u=function(h){return{"-active":h}},r="slide-toggle";class n{constructor(a,p){this.elementRef=a,this.cdRef=p,this.valueChanged=new i.vpe}ngOnChanges(a){console.warn(JSON.stringify(a))}ngOnInit(){const{dataset:a}=this.elementRef.nativeElement;a.inputName&&(this.containerId=a.containerId,this.containerClasses=a.containerClasses,this.inputId=a.inputId,this.inputName=a.inputName,this.active="true"===a.active.toString())}onValueChanged(a){this.active=a,this.valueChanged.emit(a),this.cdRef.detectChanges()}}n.\u0275fac=function(a){return new(a||n)(i.Y36(i.SBq),i.Y36(i.sBO))},n.\u0275cmp=i.Xpm({type:n,selectors:[["slide-toggle"]],inputs:{containerId:"containerId",containerClasses:"containerClasses",inputId:"inputId",inputName:"inputName",active:"active"},outputs:{valueChanged:"valueChanged"},features:[i.TTD],decls:4,vars:10,consts:[[3,"ngClass"],[1,"switch"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"slider","round"]],template:function(a,p){1&a&&(i.TgZ(0,"div",0),i.TgZ(1,"label",1),i.TgZ(2,"input",2),i.NdJ("ngModelChange",function(d){return p.onValueChanged(d)}),i.qZA(),i._UZ(3,"span",3),i.qZA(),i.qZA()),2&a&&(i.Gre("slide-toggle ",p.containerClasses,""),i.Q6J("ngClass",i.VKq(8,u,p.active)),i.uIk("id",p.containerId),i.xp6(2),i.Q6J("ngModel",p.active),i.uIk("id",p.inputId||void 0)("name",p.inputName||void 0))},directives:[e.mk,c.Wl,c.JJ,c.On],styles:['.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:24px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:#fff;transition:.4s}.slide-toggle.-active[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{background-color:#00008b}.slide-toggle.-active[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{transform:translate(26px)}.slider.round[_ngcontent-%COMP%]{border-radius:34px}.slider.round[_ngcontent-%COMP%]:before{border-radius:50%}'],changeDetection:0})},14359:(H,D,t)=>{"use strict";t.d(D,{M:()=>i});class i{constructor(c,u,r){this.page=c,this.total=u,this.perPage=r}getLowerPageBound(){return this.perPage*(this.page-1)+1}getUpperPageBound(c){return Math.min(this.perPage*this.page,c)}nextPage(){this.page+=1}previousPage(){this.page-=1}}},68853:(H,D,t)=>{"use strict";t.d(D,{N:()=>u});var i=t(12877),e=t(2316);const c_maxVisiblePageOptions=6,c_optionsTruncationSize=1;class u{constructor(n){this.configuration=n,this.loadPaginationOptions()}getCachedPerPage(n){const h=this.localStoragePerPage,a=(null==n?void 0:n.length)||0;return null!==h&&h>0&&(0===a||-1!==(null==n?void 0:n.indexOf(h)))?h:a>0?n[0]:20}get localStoragePerPage(){const n=window.OpenProject.guardedLocalStorage("pagination.perPage");return void 0!==n?parseInt(n,10):null}getPaginationOptions(){return this.paginationOptions}get isPerPageKnown(){return!(!this.localStoragePerPage&&!this.paginationOptions)}getPerPage(){return this.localStoragePerPage||this.paginationOptions.perPage}getMaxVisiblePageOptions(){return _.get(this.paginationOptions,"maxVisiblePageOptions",c_maxVisiblePageOptions)}getOptionsTruncationSize(){return _.get(this.paginationOptions,"optionsTruncationSize",c_optionsTruncationSize)}setPerPage(n){window.OpenProject.guardedLocalStorage("pagination.perPage",n.toString()),this.paginationOptions.perPage=n}getPerPageOptions(){return this.paginationOptions.perPageOptions}setPerPageOptions(n){this.paginationOptions.perPageOptions=n}loadPaginationOptions(){return this.configuration.initialized.then(()=>(this.paginationOptions={perPage:this.getCachedPerPage(this.configuration.perPageOptions),perPageOptions:this.configuration.perPageOptions,maxVisiblePageOptions:c_maxVisiblePageOptions,optionsTruncationSize:c_optionsTruncationSize},this.paginationOptions))}}u.\u0275fac=function(n){return new(n||u)(e.LFG(i.e))},u.\u0275prov=e.Yz7({token:u,factory:u.\u0275fac})},5282:(H,D,t)=>{"use strict";t.d(D,{l:()=>h});var i=t(54364),e=t(84906),c=t(63415),u=t(71858),r=t(53875),n=t(2316);class h{}h.\u0275fac=function(p){return new(p||h)},h.\u0275mod=n.oAB({type:h}),h.\u0275inj=n.cJS({imports:[[i.ez,c.J,r.Q,u.a,e.UIRouterModule]]})},90590:(H,D,t)=>{"use strict";t.d(D,{P:()=>x});var i=t(2316),e=t(43682),c=t(47775),u=t(54364),r=t(84906),n=t(54471);const h=["scrollContainer"],a=["scrollPane"],p=["scrollRightBtn"],l=["scrollLeftBtn"];function d(k,b){if(1&k){const v=i.EpF();i.TgZ(0,"a",16),i.NdJ("click",function(S){i.CHM(v);const O=i.oxw().$implicit;return i.oxw().clickTab(O,S)}),i.qZA()}if(2&k){const v=i.oxw().$implicit,M=i.oxw();i.ekj("op-tab-row--link_selected",v.id===M.currentTabId)("op-tab-row--link_disabled",void 0!==v.disable),i.Q6J("href",v.path,i.LSH)("textContent",v.name),i.uIk("title",M.tabTitle(v))}}function g(k,b){if(1&k&&(i._UZ(0,"op-tab-count",21),i.ALo(1,"async")),2&k){const v=i.oxw(2).$implicit,M=i.oxw();i.Q6J("count",i.lcZ(1,2,v.counter(M.injector))),i.uIk("data-qa-selector","tab-counter-"+v.name)}}function C(k,b){if(1&k&&(i.TgZ(0,"span",23),i._uU(1),i.qZA()),2&k){const v=i.oxw().ngIf;i.xp6(1),i.hij(" (",v,")")}}function y(k,b){if(1&k&&(i.ynx(0),i.YNc(1,C,2,1,"span",22),i.BQk()),2&k){const v=b.ngIf,M=i.oxw(2).$implicit;i.xp6(1),i.Q6J("ngIf",v>0&&!M.showCountAsBubble)}}function m(k,b){if(1&k){const v=i.EpF();i.TgZ(0,"a",17),i.NdJ("click",function(S){i.CHM(v);const O=i.oxw().$implicit;return i.oxw().clickTab(O,S)}),i._UZ(1,"span",18),i.YNc(2,g,2,4,"op-tab-count",19),i.YNc(3,y,2,1,"ng-container",20),i.ALo(4,"async"),i.qZA()}if(2&k){const v=i.oxw().$implicit,M=i.oxw();i.ekj("op-tab-row--link_disabled",void 0!==v.disable),i.Q6J("uiSref",v.route)("uiParams",v.routeParams),i.uIk("title",M.tabTitle(v)),i.xp6(1),i.Q6J("textContent",v.name),i.xp6(1),i.Q6J("ngIf",v.counter&&v.showCountAsBubble),i.xp6(1),i.Q6J("ngIf",i.lcZ(4,8,v.counter(M.injector)))}}function E(k,b){if(1&k){const v=i.EpF();i.TgZ(0,"li",13),i.NdJ("dragenter",function(){const O=i.CHM(v).$implicit;return i.oxw().startDebouncedTabActivation(O)})("dragleave",function(){return i.CHM(v),i.oxw().cancelDebouncedTabActivation()}),i.YNc(1,d,1,7,"a",14),i.YNc(2,m,5,10,"a",15),i.qZA()}if(2&k){const v=b.$implicit,M=i.oxw();i.uIk("data-tab-id",v.id)("data-qa-tab-id",v.id)("data-qa-tab-selected",v.id===M.currentTabId||void 0)("data-qa-tab-disabled",v.disable||void 0),i.xp6(1),i.Q6J("ngIf",!v.route),i.xp6(1),i.Q6J("ngIf",v.route)}}const P=[[["","slot","actions"]]];class x{constructor(b,v,M){this.$state=b,this.cdRef=v,this.injector=M,this.currentTabId=null,this.tabs=[],this.classes=[],this.hideLeftButton=!0,this.hideRightButton=!0,this.tabSelected=new i.vpe,this.trackById=(0,e.AT)("id"),this.dragTargetStack=0}ngAfterViewInit(){this.container=this.scrollContainer.nativeElement,this.pane=this.scrollPane.nativeElement,this.updateScrollableArea()}ngOnChanges(b){this.pane&&this.updateScrollableArea()}updateScrollableArea(){this.determineScrollButtonVisibility(),null!=this.currentTabId&&this.scrollIntoVisibleArea(this.currentTabId)}clickTab(b,v){this.currentTabId=b.id,this.tabSelected.emit(b),b.path||v.preventDefault()}startDebouncedTabActivation(b){this.dragTargetStack+=1,null!==this.debouncedTabActivationTimeout&&this.clearDebouncedTabActivation(),this.debouncedTabActivationTimeout=setTimeout(()=>{this.currentTabId=b.id,this.tabSelected.emit(b);const v=this.$state.includes("**.details.*")?this.$state.$current.name:b.route;v&&this.$state.go(v,b.routeParams),this.debouncedTabActivationTimeout=null},300)}cancelDebouncedTabActivation(){this.dragTargetStack-=1,0===this.dragTargetStack&&this.clearDebouncedTabActivation()}clearDebouncedTabActivation(){null!==this.debouncedTabActivationTimeout&&(clearTimeout(this.debouncedTabActivationTimeout),this.debouncedTabActivationTimeout=null)}onScroll(){this.determineScrollButtonVisibility()}determineScrollButtonVisibility(){this.hideLeftButton=this.pane.scrollLeft<=0,this.hideRightButton=this.pane.scrollWidth-this.pane.scrollLeft<=this.container.clientWidth,this.cdRef.detectChanges()}scrollRight(){this.pane.scrollLeft+=this.container.clientWidth}scrollLeft(){this.pane.scrollLeft-=this.container.clientWidth}tabTitle(b){return"string"==typeof b.disable?b.disable:b.name}scrollIntoVisibleArea(b){const v=jQuery(this.pane).find(`[data-tab-id=${b}]`),S=v.position().left+Number(v.outerWidth());this.pane.scrollLeft+this.container.clientWidth<S&&(this.pane.scrollLeft=S-this.container.clientWidth+40)}}x.\u0275fac=function(b){return new(b||x)(i.Y36(c.StateService),i.Y36(i.sBO),i.Y36(i.zs3))},x.\u0275cmp=i.Xpm({type:x,selectors:[["op-scrollable-tabs"]],viewQuery:function(b,v){if(1&b&&(i.Gf(h,7),i.Gf(a,7),i.Gf(p,7),i.Gf(l,7)),2&b){let M;i.iGM(M=i.CRH())&&(v.scrollContainer=M.first),i.iGM(M=i.CRH())&&(v.scrollPane=M.first),i.iGM(M=i.CRH())&&(v.scrollRightBtn=M.first),i.iGM(M=i.CRH())&&(v.scrollLeftBtn=M.first)}},inputs:{currentTabId:"currentTabId",tabs:"tabs",classes:"classes",hideLeftButton:"hideLeftButton",hideRightButton:"hideRightButton"},outputs:{tabSelected:"tabSelected"},features:[i.TTD],ngContentSelectors:["[slot=actions]"],decls:14,vars:5,consts:[[1,"op-scrollable-tabs",3,"ngClass"],[1,"op-scrollable-tabs--tab-container"],["scrollContainer",""],[1,"op-tab-row",3,"scroll"],["scrollPane",""],["class","op-tab-row--tab",3,"dragenter","dragleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[1,"op-scrollable-tabs--actions"],[1,"op-tab-row--tab",3,"dragenter","dragleave"],["class","op-tab-row--link",3,"href","op-tab-row--link_selected","op-tab-row--link_disabled","textContent","click",4,"ngIf"],["class","op-tab-row--link","uiSrefActive","op-tab-row--link_selected","href","","role","button",3,"uiSref","uiParams","op-tab-row--link_disabled","click",4,"ngIf"],[1,"op-tab-row--link",3,"href","textContent","click"],["uiSrefActive","op-tab-row--link_selected","href","","role","button",1,"op-tab-row--link",3,"uiSref","uiParams","click"],[3,"textContent"],[3,"count",4,"ngIf"],[4,"ngIf"],[3,"count"],["data-qa-selector","tab-count",4,"ngIf"],["data-qa-selector","tab-count"]],template:function(b,v){1&b&&(i.F$t(P),i.TgZ(0,"div",0),i.TgZ(1,"div",1,2),i.TgZ(3,"ul",3,4),i.NdJ("scroll",function(){return v.onScroll()}),i.YNc(5,E,3,6,"li",5),i.qZA(),i.TgZ(6,"div",6,7),i.NdJ("click",function(){return v.scrollLeft()}),i._UZ(8,"span",8),i.qZA(),i.TgZ(9,"div",9,10),i.NdJ("click",function(){return v.scrollRight()}),i._UZ(11,"span",11),i.qZA(),i.qZA(),i.TgZ(12,"ul",12),i.Hsn(13),i.qZA(),i.qZA()),2&b&&(i.Q6J("ngClass",v.classes),i.xp6(5),i.Q6J("ngForOf",v.tabs)("ngForTrackBy",v.trackById),i.xp6(1),i.Q6J("hidden",v.hideLeftButton),i.xp6(3),i.Q6J("hidden",v.hideRightButton))},directives:[u.mk,u.sg,u.O5,r.AnchorUISref,r.UISrefActive,r.UISrefStatus,r.UISref,n.x],pipes:[u.Ov],styles:[".op-tab-row--link[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{pointer-events:none}"],changeDetection:0})},54471:(H,D,t)=>{"use strict";t.d(D,{x:()=>r});var i=t(2316),e=t(54364);function c(n,h){if(1&n&&i._UZ(0,"span",2),2&n){const a=i.oxw(2);i.Q6J("textContent",a.count)}}function u(n,h){if(1&n&&(i.ynx(0),i.YNc(1,c,1,1,"span",1),i.BQk()),2&n){const a=i.oxw();i.xp6(1),i.Q6J("ngIf",a.count>0)}}class r{}r.\u0275fac=function(h){return new(h||r)},r.\u0275cmp=i.Xpm({type:r,selectors:[["op-tab-count"]],inputs:{count:"count"},decls:1,vars:1,consts:[[4,"ngIf"],["class","op-tab-count",3,"textContent",4,"ngIf"],[1,"op-tab-count",3,"textContent"]],template:function(h,a){1&h&&i.YNc(0,u,2,1,"ng-container",0),2&h&&i.Q6J("ngIf",a.count)},directives:[e.O5],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-tab-count[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center;box-sizing:content-box;height:16px;line-height:16px;width:16px;border-radius:.5rem;padding:0 .15rem;font-size:.7rem;font-weight:bold;background:#00A3FF;color:#fff;flex-shrink:0;margin-left:5px;vertical-align:text-bottom}"],changeDetection:0})},46709:(H,D,t)=>{"use strict";t.d(D,{f:()=>w});var i=t(77355),e=t(91923),c=t(96617),u=t(53466),r=t(12703),n=t(58021),h=t(2316),a=t(52932),p=t(81301),l=t(54364),d=t(2775);function g(x,k){if(1&x){const b=h.EpF();h.TgZ(0,"button",8),h.NdJ("click",function(){return h.CHM(b),h.oxw().saveEntry()}),h._UZ(1,"op-icon",9),h._UZ(2,"span",10),h.qZA()}if(2&x){const b=h.oxw();h.Q6J("disabled",b.formInFlight),h.uIk("title",b.saveText),h.xp6(2),h.Q6J("textContent",b.saveText)}}function C(x,k){if(1&x){const b=h.EpF();h.TgZ(0,"button",11),h.NdJ("click",function(M){return h.CHM(b),h.oxw().closeMe(M)}),h._UZ(1,"op-icon",12),h._UZ(2,"span",10),h.qZA()}if(2&x){const b=h.oxw();h.uIk("title",b.text.cancel),h.xp6(2),h.Q6J("textContent",b.text.cancel)}}function y(x,k){if(1&x){const b=h.EpF();h.TgZ(0,"button",11),h.NdJ("click",function(){return h.CHM(b),h.oxw().destroy()}),h._UZ(1,"op-icon",13),h._UZ(2,"span",10),h.qZA()}if(2&x){const b=h.oxw();h.uIk("title",b.text.delete),h.xp6(2),h.Q6J("textContent",b.text.delete)}}class m extends n.G{get deleteAllowed(){return!1}setModifiedEntry(k){this.createdEntry=k.savedResource,this.reloadWorkPackageAndClose()}get saveText(){return this.i18n.t("js.label_create")}}m.\u0275fac=function(){let x;return function(b){return(x||(x=h.n5z(m)))(b||m)}}(),m.\u0275cmp=h.Xpm({type:m,selectors:[["ng-component"]],features:[h._Bn([r.l]),h.qOj],decls:10,vars:6,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_autoheight","loading-indicator--location"],["icon","icon-log_time",3,"close"],[1,"ngdialog-body","op-modal--body"],[3,"changeset","showWorkPackageField","modifiedEntry"],["editForm",""],[1,"op-modal--footer"],["class","button -highlight",3,"disabled","click",4,"ngIf"],["class","button",3,"click",4,"ngIf"],[1,"button","-highlight",3,"disabled","click"],["icon-classes","button--icon icon-checkmark"],["aria-hidden","true",1,"button--text",3,"textContent"],[1,"button",3,"click"],["icon-classes","button--icon icon-close"],["icon-classes","button--icon icon-delete"]],template:function(k,b){1&k&&(h.TgZ(0,"div",0),h.TgZ(1,"op-modal-header",1),h.NdJ("close",function(M){return b.closeMe(M)}),h._uU(2),h.qZA(),h.TgZ(3,"div",2),h.TgZ(4,"te-form",3,4),h.NdJ("modifiedEntry",function(M){return b.setModifiedEntry(M)}),h.qZA(),h.qZA(),h.TgZ(6,"div",5),h.YNc(7,g,3,3,"button",6),h.YNc(8,C,3,2,"button",7),h.YNc(9,y,3,2,"button",7),h.qZA(),h.qZA()),2&k&&(h.xp6(2),h.hij(" ",b.text.title," "),h.xp6(2),h.Q6J("changeset",b.changeset)("showWorkPackageField",b.showWorkPackageField),h.xp6(3),h.Q6J("ngIf",b.saveAllowed),h.xp6(1),h.Q6J("ngIf",b.saveAllowed),h.xp6(1),h.Q6J("ngIf",b.deleteAllowed))},directives:[a.g,p.y,l.O5,d.o],encapsulation:2,changeDetection:0});var E=t(20979),P=t(44022);class w{constructor(k,b,v,M,S,O,A){this.opModalService=k,this.injector=b,this.halResource=v,this.apiV3Service=M,this.schemaCache=S,this.halEditing=O,this.i18n=A}create(k,b,v=!0){return new Promise((M,S)=>{this.createNewTimeEntry(k,b).then(O=>{const A=this.opModalService.show(m,this.injector,{changeset:O,showWorkPackageField:v});A.closingEvent.pipe((0,u.q)(1)).subscribe(()=>{A.createdEntry?M({entry:A.createdEntry,action:"create"}):S()})})})}createNewTimeEntry(k,b){const v={spentOn:k.format("YYYY-MM-DD")};return b&&(v._links={workPackage:{href:b.href}}),this.apiV3Service.time_entries.form.post(v).toPromise().then(M=>this.fromCreateForm(M))}fromCreateForm(k){const b=this.initializeNewResource(k);return this.halEditing.edit(b,k)}initializeNewResource(k){const b=this.halResource.createHalResourceOfType("TimeEntry",k.payload.$plain());return b.$links.schema={href:"new"},b._type="TimeEntry",b.id="new",b.hours="PT1H",b.update=b.$links.update=k.$links.self,b.updateImmediately=b.$links.updateImmediately=v=>this.apiV3Service.time_entries.post(v).toPromise(),b.state.putValue(b),this.schemaCache.update(b,k.schema),b}}w.\u0275fac=function(k){return new(k||w)(h.LFG(i.S),h.LFG(h.zs3),h.LFG(e.u),h.LFG(E.T),h.LFG(P.y),h.LFG(r.l),h.LFG(c.D))},w.\u0275prov=h.Yz7({token:w,factory:w.\u0275fac})},72388:(H,D,t)=>{"use strict";t.d(D,{d:()=>P});var i=t(77355),e=t(91923),c=t(96617),u=t(53466),r=t(12703),n=t(20979),h=t(58021),a=t(2316),p=t(52932),l=t(81301),d=t(54364),g=t(2775);function C(w,x){if(1&w){const k=a.EpF();a.TgZ(0,"button",8),a.NdJ("click",function(){return a.CHM(k),a.oxw().saveEntry()}),a._UZ(1,"op-icon",9),a._UZ(2,"span",10),a.qZA()}if(2&w){const k=a.oxw();a.Q6J("disabled",k.formInFlight),a.uIk("title",k.saveText),a.xp6(2),a.Q6J("textContent",k.saveText)}}function y(w,x){if(1&w){const k=a.EpF();a.TgZ(0,"button",11),a.NdJ("click",function(v){return a.CHM(k),a.oxw().closeMe(v)}),a._UZ(1,"op-icon",12),a._UZ(2,"span",10),a.qZA()}if(2&w){const k=a.oxw();a.uIk("title",k.text.cancel),a.xp6(2),a.Q6J("textContent",k.text.cancel)}}function m(w,x){if(1&w){const k=a.EpF();a.TgZ(0,"button",11),a.NdJ("click",function(){return a.CHM(k),a.oxw().destroy()}),a._UZ(1,"op-icon",13),a._UZ(2,"span",10),a.qZA()}if(2&w){const k=a.oxw();a.uIk("title",k.text.delete),a.xp6(2),a.Q6J("textContent",k.text.delete)}}class E extends h.G{setModifiedEntry(x){this.modifiedEntry=x.savedResource,this.reloadWorkPackageAndClose()}get saveAllowed(){return!!this.entry.update}get deleteAllowed(){return!!this.entry.delete}destroy(){!window.confirm(this.text.areYouSure)||(this.destroyedEntry=this.entry,this.service.close())}}E.\u0275fac=function(){let w;return function(k){return(w||(w=a.n5z(E)))(k||E)}}(),E.\u0275cmp=a.Xpm({type:E,selectors:[["ng-component"]],features:[a._Bn([r.l]),a.qOj],decls:10,vars:6,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_autoheight","loading-indicator--location"],["icon","icon-log_time",3,"close"],[1,"ngdialog-body","op-modal--body"],[3,"changeset","showWorkPackageField","modifiedEntry"],["editForm",""],[1,"op-modal--footer"],["class","button -highlight",3,"disabled","click",4,"ngIf"],["class","button",3,"click",4,"ngIf"],[1,"button","-highlight",3,"disabled","click"],["icon-classes","button--icon icon-checkmark"],["aria-hidden","true",1,"button--text",3,"textContent"],[1,"button",3,"click"],["icon-classes","button--icon icon-close"],["icon-classes","button--icon icon-delete"]],template:function(x,k){1&x&&(a.TgZ(0,"div",0),a.TgZ(1,"op-modal-header",1),a.NdJ("close",function(v){return k.closeMe(v)}),a._uU(2),a.qZA(),a.TgZ(3,"div",2),a.TgZ(4,"te-form",3,4),a.NdJ("modifiedEntry",function(v){return k.setModifiedEntry(v)}),a.qZA(),a.qZA(),a.TgZ(6,"div",5),a.YNc(7,C,3,3,"button",6),a.YNc(8,y,3,2,"button",7),a.YNc(9,m,3,2,"button",7),a.qZA(),a.qZA()),2&x&&(a.xp6(2),a.hij(" ",k.text.title," "),a.xp6(2),a.Q6J("changeset",k.changeset)("showWorkPackageField",k.showWorkPackageField),a.xp6(3),a.Q6J("ngIf",k.saveAllowed),a.xp6(1),a.Q6J("ngIf",k.saveAllowed),a.xp6(1),a.Q6J("ngIf",k.deleteAllowed))},directives:[p.g,l.y,d.O5,g.o],encapsulation:2,changeDetection:0});class P{constructor(x,k,b,v,M,S){this.opModalService=x,this.injector=k,this.apiV3Service=b,this.halResource=v,this.halEditing=M,this.i18n=S}edit(x){return new Promise((k,b)=>{this.createChangeset(x).then(v=>{const M=this.opModalService.show(E,this.injector,{changeset:v});M.closingEvent.pipe((0,u.q)(1)).subscribe(()=>{M.destroyedEntry?M.destroyedEntry.delete().then(()=>{k({entry:M.destroyedEntry,action:"destroy"})}):M.modifiedEntry?k({entry:M.modifiedEntry,action:"update"}):b()})})})}createChangeset(x){return this.apiV3Service.time_entries.id(x).form.post(x).toPromise().then(k=>this.halEditing.edit(x,k))}}P.\u0275fac=function(x){return new(x||P)(a.LFG(i.S),a.LFG(a.zs3),a.LFG(n.T),a.LFG(e.u),a.LFG(r.l),a.LFG(c.D))},P.\u0275prov=a.Yz7({token:P,factory:P.\u0275fac})},81301:(H,D,t)=>{"use strict";t.d(D,{y:()=>E});var i=t(12703),e=t(96617),c=t(2316),u=t(61342),r=t(26942),h=(t(94232),t(54364)),a=t(54262);const p=["editForm"],l=function(P){return{"-required":P}};function d(P,w){if(1&P&&c._UZ(0,"div",3),2&P){const x=c.oxw();c.Q6J("ngClass",c.VKq(2,l,x.isRequired("workPackage")))("textContent",x.text.attributes.workPackage)}}function g(P,w){if(1&P&&(c.TgZ(0,"div",4),c._UZ(1,"editable-attribute-field",10),c.qZA()),2&P){const x=c.oxw();c.xp6(1),c.Q6J("resource",x.entry)("fieldName","workPackage")}}function C(P,w){if(1&P&&c._UZ(0,"editable-attribute-field",10),2&P){const x=c.oxw();c.Q6J("resource",x.entry)("fieldName","activity")}}function y(P,w){if(1&P&&c._UZ(0,"i",12),2&P){const x=c.oxw();c.Q6J("textContent",x.text.wpRequired)}}function m(P,w){if(1&P&&(c.ynx(0),c._UZ(1,"div",3),c.TgZ(2,"div",4),c._UZ(3,"editable-attribute-field",10),c.qZA(),c.BQk()),2&P){const x=w.$implicit,k=c.oxw();c.xp6(1),c.Q6J("ngClass",c.VKq(4,l,k.isRequired(x.key)))("textContent",x.label),c.xp6(2),c.Q6J("resource",k.entry)("fieldName",x.key)}}class E extends r.N{constructor(w,x,k){super(),this.halEditing=w,this.cdRef=x,this.i18n=k,this.showWorkPackageField=!0,this.modifiedEntry=new c.vpe,this.text={attributes:{comment:this.i18n.t("js.time_entry.comment"),hours:this.i18n.t("js.time_entry.hours"),activity:this.i18n.t("js.time_entry.activity"),workPackage:this.i18n.t("js.time_entry.work_package"),spentOn:this.i18n.t("js.time_entry.spent_on")},wpRequired:this.i18n.t("js.time_entry.work_package_required")},this.workPackageSelected=!1,this.customFields=[]}ngOnInit(){this.halEditing.temporaryEditResource(this.changeset.projectedResource).values$().pipe(this.untilDestroyed()).subscribe(w=>{w&&w.workPackage&&(this.workPackageSelected=!0,this.cdRef.markForCheck())}),this.setCustomFields(),this.cdRef.detectChanges()}get entry(){return this.changeset.projectedResource}signalModifiedEntry(w){this.modifiedEntry.emit(w)}save(){return this.editForm.submit()}get inEditMode(){return!0}isRequired(w){return"workPackage"===w||this.schema.ofProperty(w).required}setCustomFields(){Object.entries(this.schema).forEach(([w,x])=>{/customField\d+/.exec(w)&&this.customFields.push({key:w,label:x.name})})}get schema(){return this.changeset.schema}}E.\u0275fac=function(w){return new(w||E)(c.Y36(i.l),c.Y36(c.sBO),c.Y36(e.D))},E.\u0275cmp=c.Xpm({type:E,selectors:[["te-form"]],viewQuery:function(w,x){if(1&w&&c.Gf(p,7),2&w){let k;c.iGM(k=c.CRH())&&(x.editForm=k.first)}},inputs:{changeset:"changeset",showWorkPackageField:"showWorkPackageField"},outputs:{modifiedEntry:"modifiedEntry"},features:[c.qOj],decls:19,vars:31,consts:[[3,"resource","inEditMode","onSaved"],["editForm",""],[1,"attributes-map"],[1,"attributes-map--key",3,"ngClass","textContent"],[1,"attributes-map--value"],[3,"resource","wrapperClasses","fieldName"],["class","attributes-map--key",3,"ngClass","textContent",4,"ngIf"],["class","attributes-map--value",4,"ngIf"],[3,"resource","fieldName",4,"ngIf"],[3,"textContent",4,"ngIf"],[3,"resource","fieldName"],[4,"ngFor","ngForOf"],[3,"textContent"]],template:function(w,x){1&w&&(c.TgZ(0,"edit-form",0,1),c.NdJ("onSaved",function(b){return x.signalModifiedEntry(b)}),c.TgZ(2,"div",2),c._UZ(3,"div",3),c.TgZ(4,"div",4),c._UZ(5,"editable-attribute-field",5),c.qZA(),c._UZ(6,"div",3),c.TgZ(7,"div",4),c._UZ(8,"editable-attribute-field",5),c.qZA(),c.YNc(9,d,1,4,"div",6),c.YNc(10,g,2,2,"div",7),c._UZ(11,"div",3),c.TgZ(12,"div",4),c.YNc(13,C,1,2,"editable-attribute-field",8),c.YNc(14,y,1,1,"i",9),c.qZA(),c._UZ(15,"div",3),c.TgZ(16,"div",4),c._UZ(17,"editable-attribute-field",10),c.qZA(),c.YNc(18,m,4,6,"ng-container",11),c.qZA(),c.qZA()),2&w&&(c.Q6J("resource",x.entry)("inEditMode",x.inEditMode),c.xp6(3),c.Q6J("ngClass",c.VKq(23,l,x.isRequired("spentOn")))("textContent",x.text.attributes.spentOn),c.xp6(2),c.Q6J("resource",x.entry)("wrapperClasses","-tiny")("fieldName","spentOn"),c.xp6(1),c.Q6J("ngClass",c.VKq(25,l,x.isRequired("hours")))("textContent",x.text.attributes.hours),c.xp6(2),c.Q6J("resource",x.entry)("wrapperClasses","-tiny")("fieldName","hours"),c.xp6(1),c.Q6J("ngIf",x.showWorkPackageField),c.xp6(1),c.Q6J("ngIf",x.showWorkPackageField),c.xp6(1),c.Q6J("ngClass",c.VKq(27,l,x.isRequired("activity")))("textContent",x.text.attributes.activity),c.xp6(2),c.Q6J("ngIf",x.workPackageSelected),c.xp6(1),c.Q6J("ngIf",!x.workPackageSelected),c.xp6(1),c.Q6J("ngClass",c.VKq(29,l,x.isRequired("comment")))("textContent",x.text.attributes.comment),c.xp6(2),c.Q6J("resource",x.entry)("fieldName","comment"),c.xp6(1),c.Q6J("ngForOf",x.customFields))},directives:[u.n,h.mk,a.k,h.O5,h.sg],encapsulation:2,changeDetection:0})},54349:(H,D,t)=>{"use strict";t.d(D,{I:()=>n});var i=t(21757),e=t(55811),c=t(65084),u=t(72388),r=t(2316);class n{}n.\u0275fac=function(a){return new(a||n)},n.\u0275mod=r.oAB({type:n}),n.\u0275inj=r.cJS({providers:[u.d],imports:[[i.H,e.K,c.E]]})},58021:(H,D,t)=>{"use strict";t.d(D,{G:()=>l});var i=t(3786),e=t(60312),c=t(77355),u=t(96617),n=(t(81301),t(29161)),h=t(20979),a=t(2316);const p=["editForm"];class l extends e.T{constructor(g,C,y,m,E){super(C,y,g),this.elementRef=g,this.locals=C,this.cdRef=y,this.i18n=m,this.injector=E,this.text={title:this.i18n.t("js.time_entry.title"),cancel:this.i18n.t("js.button_cancel"),close:this.i18n.t("js.button_close"),delete:this.i18n.t("js.button_delete"),areYouSure:this.i18n.t("js.text_are_you_sure")},this.closeOnEscape=!1,this.closeOnOutsideClick=!1}get changeset(){return this.locals.changeset}get entry(){return this.changeset.projectedResource}get showWorkPackageField(){return void 0===this.locals.showWorkPackageField||this.locals.showWorkPackageField}saveEntry(){this.formInFlight=!0,this.editForm.save().then(()=>this.reloadWorkPackageAndClose()).catch(()=>{this.formInFlight=!1,this.cdRef.detectChanges()})}get saveText(){return this.i18n.t("js.button_save")}get saveAllowed(){return!0}get deleteAllowed(){return!0}reloadWorkPackageAndClose(){this.entry.workPackage&&this.apiV3Service.work_packages.id(this.entry.workPackage).refresh(),this.service.close(),this.formInFlight=!1,this.cdRef.detectChanges()}}l.\u0275fac=function(g){return new(g||l)(a.Y36(a.SBq),a.Y36(c.E),a.Y36(a.sBO),a.Y36(u.D),a.Y36(a.zs3))},l.\u0275dir=a.lG2({type:l,viewQuery:function(g,C){if(1&g&&a.Gf(p,7),2&g){let y;a.iGM(y=a.CRH())&&(C.editForm=y.first)}},features:[a.qOj]}),(0,i.gn)([(0,n.W)(),(0,i.w6)("design:type",h.T)],l.prototype,"apiV3Service",void 0)},36293:(H,D,t)=>{"use strict";t.d(D,{kl:()=>p});var i=t(12877),e=t(14808),c=t(85758),u=t(53882),r=t(96617),n=t(2316);class p{constructor(d,g){this.configurationService=d,this.I18n=g,this.stack=(0,e.qH)([]),jQuery(window).on("op:toasters:add",(C,y)=>{this.add(y)})}get current(){return this.stack}add(d,g=5e3){return jQuery(".flash.notice").remove(),this.stack.doModify(C=>{const y=[d].concat(C);return _.remove(y,(m,E)=>E>0&&this.removeOnAdd(m)),y}),"success"===d.type&&this.configurationService.autoHidePopups()&&setTimeout(()=>this.remove(d),g),d}removeOnAdd(d){return["success","error","loading"].includes(d.type)}addError(d,g=[]){var C,y;let m,E;E="string"==typeof g?[g]:[...g],d instanceof u.UA?(m=(0,c.G$)(d.error)?d.error.message:d.message,(null===(y=null===(C=d.error)||void 0===C?void 0:C._embedded)||void 0===y?void 0:y.errors)&&(E=[...E,...d.error._embedded.errors.map(w=>w.message)])):m=d;const P=this.createToast(m,"error");return P.data=E,this.add(P)}addWarning(d){return this.add(this.createToast(d,"warning"))}addSuccess(d){return this.add(this.createToast(d,"success"))}addNotice(d){return this.add(this.createToast(d,"info"))}addAttachmentUpload(d,g){return this.add(this.createAttachmentUploadToast(d,g))}addLoading(d){return this.add(this.createLoadingToast(this.I18n.t("js.ajax.updating"),d))}remove(d){this.stack.doModify(g=>(_.remove(g,C=>C===d),g))}clear(){this.stack.putValue([])}createToast(d,g){return"string"==typeof d?{message:d,type:g}:{message:d.message,type:g,link:d.link,data:d.data}}createAttachmentUploadToast(d,g){if(!g.length)throw new Error("Cannot create an upload toast without uploads!");const C=this.createToast(d,"upload");return C.data=g,C}createLoadingToast(d,g){const C=this.createToast(d,"loading");return C.data=g,C}}p.\u0275fac=function(d){return new(d||p)(n.LFG(i.e),n.LFG(r.D))},p.\u0275prov=n.Yz7({token:p,factory:p.\u0275fac,providedIn:"root"})},65532:(H,D,t)=>{"use strict";t.d(D,{F:()=>h});t(84481);var e=t(96617),c=t(2316),u=t(54364);function r(a,p){if(1&a&&c._UZ(0,"a",2),2&a){const l=c.oxw();c.Q6J("textContent",l.name),c.uIk("href",l.href,c.LSH)("title",l.label)}}function n(a,p){if(1&a&&(c.ynx(0),c._uU(1),c.GkF(2),c.BQk()),2&a){const l=c.oxw();c.xp6(1),c.hij(" ",l.name," ")}}class h{constructor(p){this.I18n=p}get href(){return this.user&&this.user.showUserPath}get name(){return this.user&&this.user.name}get label(){return this.I18n.t("js.label_author",{user:this.name})}}h.\u0275fac=function(p){return new(p||h)(c.Y36(e.D))},h.\u0275cmp=c.Xpm({type:h,selectors:[["op-user-link"]],inputs:{user:"user"},decls:2,vars:2,consts:[[3,"textContent",4,"ngIf"],[4,"ngIf"],[3,"textContent"]],template:function(p,l){1&p&&(c.YNc(0,r,1,3,"a",0),c.YNc(1,n,3,1,"ng-container",1)),2&p&&(c.Q6J("ngIf",l.href),c.xp6(1),c.Q6J("ngIf",!l.href))},directives:[u.O5],encapsulation:2,changeDetection:0})},84312:(H,D,t)=>{"use strict";t.d(D,{U:()=>c});var i=t(7101),e=t(2316);class c{constructor(r,n){this.FocusHelper=r,this.elementRef=n,this.condition=!0,this.priority=0}ngAfterViewInit(){this.updateFocus()}updateFocus(){if(this.condition){const r=jQuery(this.elementRef.nativeElement);this.FocusHelper.focusElement(r,this.priority)}}}c.\u0275fac=function(r){return new(r||c)(e.Y36(i.i),e.Y36(e.SBq))},c.\u0275dir=e.lG2({type:c,selectors:[["","opAutofocus",""]],inputs:{condition:["opAutofocus","condition"],priority:["opAutofocusPriority","priority"]}})},49951:(H,D,t)=>{"use strict";function i(c,u){return c===u||c.contains(u)}function e(c,u){setTimeout(()=>{i(c,document.activeElement)||u()},20)}t.d(D,{j:()=>i,w:()=>e})},7101:(H,D,t)=>{"use strict";t.d(D,{i:()=>e});var i=t(2316);class e{constructor(){this.minimumOffsetForNewSwitchInMs=100,this.lastFocusSwitch=-this.minimumOffsetForNewSwitchInMs,this.lastPriority=-1}throttleAndCheckIfAllowedFocusChangeBasedOnTimeout(){const u=Date.now()-this.lastFocusSwitch>=this.minimumOffsetForNewSwitchInMs;return this.lastFocusSwitch=Date.now(),u}checkIfAllowedFocusChange(u){const r=this.throttleAndCheckIfAllowedFocusChangeBasedOnTimeout();return r?(this.lastPriority=-1,r):u>this.lastPriority?(this.lastPriority=u,!0):r}getFocusableElement(u){const r=u.find("input.ui-select-focusser");if(r.length>0)return r[0];let n=u;return u.is(e.FOCUSABLE_SELECTORS)||(n=u.find(e.FOCUSABLE_SELECTORS)),n[0]}focus(u){const r=jQuery(this.getFocusableElement(u)),n=jQuery(r),h=n.is("[disabled]");h&&!n.attr("ng-disabled")&&n.prop("disabled",!1),r.focus(),h&&!n.attr("ng-disabled")&&n.prop("disabled",!0)}focusElement(u,r){!this.checkIfAllowedFocusChange(r)||setTimeout(()=>{this.focus(u)},10)}}e.FOCUSABLE_SELECTORS="a, button, :input, [tabindex], select",e.\u0275fac=function(u){return new(u||e)},e.\u0275prov=i.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"})},51017:(H,D,t)=>{"use strict";t.d(D,{N:()=>r});var i=t(76491),e=t(77763),c=t(26942),u=t(2316);class r extends c.N{constructor(h){super(),this.elementRef=h}ngOnInit(){const h=jQuery(this.elementRef.nativeElement),a=new i.X(!1);a.pipe(this.untilDestroyed(),(0,e.e)(50)).subscribe(d=>{h.toggleClass("-focus",d)});h[0].addEventListener("focus",function(){a.next(!0)},!0);h[0].addEventListener("blur",function(){a.next(!1)},!0),setTimeout(()=>{h.addClass("op-focus-within"),h.find(this.selector).addClass("op-focus-within")},0)}}r.\u0275fac=function(h){return new(h||r)(u.Y36(u.SBq))},r.\u0275dir=u.lG2({type:r,selectors:[["","opFocusWithin",""]],inputs:{selector:"selector"},features:[u.qOj]})},63415:(H,D,t)=>{"use strict";t.d(D,{J:()=>c});var i=t(54364),e=t(2316);class c{}c.\u0275fac=function(r){return new(r||c)},c.\u0275mod=e.oAB({type:c}),c.\u0275inj=e.cJS({imports:[[i.ez]]})},81979:(H,D,t)=>{"use strict";t.d(D,{o:()=>c,K:()=>u});var i=t(2316);const c="col[opHighlightCol]";class u{constructor(n){this.elementRef=n}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.thead=this.$element.parent("colgroup").siblings("thead"),this.thead.on("mouseenter","th",n=>{this.$element.index()===jQuery(n.currentTarget).index()&&this.$element.addClass("hover")}),this.thead.on("mouseleave","th",n=>{this.$element.index()===jQuery(n.currentTarget).index()&&this.$element.removeClass("hover")})}ngOnDestroy(){this.thead.off("mouseenter mouseleave")}}u.\u0275fac=function(n){return new(n||u)(i.Y36(i.SBq))},u.\u0275cmp=i.Xpm({type:u,selectors:[["col","opHighlightCol",""]],attrs:["opHighlightCol",""],decls:0,vars:0,template:function(n,h){},encapsulation:2})},29161:(H,D,t)=>{"use strict";t.d(D,{W:()=>u});t(43887);var c=t(3352);function u(r,n=null,h){return(a,p)=>{delete a[p]&&Object.defineProperty(a,p,{get(){if(r)return this.injector.get(r,n,h);const l=Reflect.getMetadata("design:type",a,p);return this.injector.get(l,n,h)},set(){(0,c.qu)(`Trying to set InjectField property ${p}`)}})}}},43682:(H,D,t)=>{"use strict";t.d(D,{tL:()=>e,As:()=>r,u9:()=>n,AT:()=>h,WJ:()=>a,U5:()=>l,q9:()=>d});var i=t(80044);function e(g,C){return C.href}function r(g,C){return _.get(C,"name")}function n(g,C){return _.get(C,"href")}function h(g){return(C,y)=>_.get(y,g)}function a(g){return(C,y)=>{const m=_.get(y,"href")||"",E=_.get(y,g,"none");return`${m}#${g}=${E}`}}function l(g,C){return!g&&!C||!!g&&!!C&&g.href===C.href}function d(g,C){return g instanceof i.X&&C instanceof i.X?l(g,C):!g&&!C||g===C}},26942:(H,D,t)=>{"use strict";t.d(D,{N:()=>c});var i=t(38519),e=t(2316);class c extends i.QQ{constructor(){super(...arguments),this.componentDestroyed=!1}ngOnDestroy(){this.componentDestroyed=!0,super.ngOnDestroy()}untilDestroyed(){return(0,i.WJ)(this)}}c.\u0275fac=function(){let u;return function(n){return(u||(u=e.n5z(c)))(n||c)}}(),c.\u0275dir=e.lG2({type:c,features:[e.qOj]})},26269:(H,D,t)=>{"use strict";t.d(D,{qM:()=>c,PQ:()=>u});const i=["f"],e=["t"];class c{constructor(){this.filterMap={}}add(n,h,a){const p=!0===a?e:!1===a?i:a;return this.filterMap[n]={operator:h,values:p},this}remove(n){delete this.filterMap[n]}static toFilterObject(n){const h={};return n.forEach(a=>{_.each(a,(p,l)=>{h[l]=p})}),h}merge(n,...h){const a=_.pickBy(c.toFilterObject(n),(p,l)=>h.includes(l));this.filterMap=Object.assign(Object.assign({},this.filterMap),a)}get filters(){const n=[];return _.each(this.filterMap,(h,a)=>{n.push({[a]:h})}),n}toJson(){return JSON.stringify(this.filters)}toParams(n={}){const h=Object.assign({filters:this.toJson()},n);return new URLSearchParams(h).toString()}clone(){const n=new c;return this.filters.forEach(h=>{Object.keys(h).forEach(a=>{n.add(a,h[a].operator,h[a].values)})}),n}}function u(r,n,h){return(new c).add(r,n,h)}},3352:(H,D,t)=>{"use strict";t.d(D,{SC:()=>e,qu:()=>c,IN:()=>u});var i=t(92340);function e(n){i.N.production||n()}function c(n,...h){e(()=>console.log(`[DEBUG] ${n}`,...h))}function u(n,h){if(!i.N.production){const a=performance.now(),p=h(),l=performance.now();return console.log(`%c${n} completed in ${l-a} milliseconds.`,"color:#00A093;"),p}return h()}},87873:(H,D,t)=>{"use strict";function i(e,c=""){document.body.style.setProperty("cursor",e,c)}t.d(D,{h:()=>i})},35900:(H,D,t)=>{"use strict";t.d(D,{x:()=>e});var i=t(92242);class e{constructor(u,r){this.down=!1,this.elements=u,this.scrollWhenOutside=r.scrollWhenOutside||!1,this.maxSpeed=r.maxSpeed||5,this.margin=r.margin||10,this.scrollWhenOutside=r.scrollWhenOutside||!1,this.autoScroll=r.autoScroll,this.point={},this.pointCB=(0,i.Fi)(this.point),this.init()}init(){jQuery(window).on("mousemove.domautoscroll touchmove.domautoscroll",u=>{this.down&&(this.pointCB(u),this.onMove(u))}),jQuery(window).on("mousedown.domautoscroll touchstart.domautoscroll",()=>{this.down=!0}),jQuery(window).on("mouseup.domautoscroll touchend.domautoscroll",()=>this.onUp()),jQuery(window).on("scroll.domautoscroll",u=>this.setScroll(u))}destroy(){jQuery(window).off(".domautoscroll"),this.elements=[],this.cleanAnimation()}add(u){Array.isArray(u)?(this.elements=this.elements.concat(u),this.elements=Array.from(new Set(this.elements))):this.elements.push(u)}onUp(){this.down=!1,cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.windowAnimationFrame)}setScroll(u){for(let r=0;r<this.elements.length;r++)if(this.elements[r]===u.target){this.scrolling=!0;break}this.scrolling&&requestAnimationFrame(()=>{this.scrolling=!1})}cleanAnimation(){cancelAnimationFrame(this.animationFrame),cancelAnimationFrame(this.windowAnimationFrame)}getTarget(u){if(!u)return[];const r=n=>[...this.elements.includes(n)?[n]:[],...n.parentElement?r(n.parentElement):[]];return r(u)}getElementsUnderPoint(){const u=[];for(let r=0;r<this.elements.length;r++)this.inside(this.point,this.elements[r])&&u.push(this.elements[r]);return u}onMove(u){if(!this.autoScroll()||u.dispatched)return;let r=[];null!==u.target&&r.push(u.target);const{body:n}=document;r.length>0&&r[0].parentNode===n?r=this.getElementsUnderPoint():(r=this.getTarget(r[0]),0===r.length&&(r=this.getElementsUnderPoint())),this.current=r,0===this.current.length&&(this.current=[this.outerScrollContainer]),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.scrollTick.bind(this))}setOuterScrollContainer(u){this.outerScrollContainer=u}scrollTick(){0!==this.current.length&&(this.current.forEach(u=>{u&&this.scrollAutomatically(u)}),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.scrollTick.bind(this)))}scrollAutomatically(u){const r=(0,i.VK)(u),n=(()=>this.point.x<r.left+this.margin?-this.maxSpeed:this.point.x>r.right-this.margin?this.maxSpeed:0)(),h=(()=>this.point.y<r.top+this.margin?-this.maxSpeed:this.point.y>r.bottom-this.margin?this.maxSpeed:0)();setTimeout(()=>{h&&this.scrollY(u,h),n&&this.scrollX(u,n)})}scrollY(u,r){u===window?window.scrollTo(u.pageXOffset,u.pageYOffset+r):u.scrollTop+=r}scrollX(u,r){u===window?window.scrollTo(u.pageXOffset+r,u.pageYOffset):u.scrollLeft+=r}inside(u,r,n){return n?u.y>n.top&&u.y<n.bottom&&u.x>n.left&&u.x<n.right:(0,i.XI)(u,r)}}},68354:(H,D,t)=>{"use strict";function i(c){return c.parentElement?Array.from(c.parentElement.children).indexOf(c):-1}function e(c,u,r){const n="string"==typeof u?parseInt(u,10):u,h=c.parentNode?Array.from(c.parentNode.children).indexOf(c):null,a=Array.from(r.children),p=null!=h&&h>=0?h>n?a[n]:a[n+1]:a[n];p?r.insertBefore(c,p):r.appendChild(c)}t.d(D,{c:()=>i,d:()=>e})},45237:(H,D,t)=>{"use strict";t.d(D,{j:()=>n});var i=t(3786),e=t(54364),c=t(35900),u=t(68354),r=t(2316);class n{constructor(a,p){this.document=a,this.injector=p,this.drake=null,this.members=[],this.escapeListener=l=>{this.drake&&"Escape"===l.key&&this.drake.cancel(!0)},this.document.documentElement.addEventListener("keydown",this.escapeListener)}ngOnDestroy(){this.document.documentElement.removeEventListener("keydown",this.escapeListener),this.autoscroll&&this.autoscroll.destroy(),this.drake&&this.drake.destroy()}remove(a){this.initialized&&(_.remove(this.drake.containers,p=>p===a),_.remove(this.members,p=>p.dragContainer===a))}member(a){return _.find(this.members,p=>p.dragContainer===a)}get initialized(){return null!==this.drake}register(a){this.members.push(a);const{scrollContainers:p}=a;this.autoscroll?this.autoscroll.add(p):this.setupAutoscroll(p);const{dragContainer:l}=a;null===this.drake?this.initializeDrake([l]):this.drake.containers.push(l)}addScrollContainer(a){this.autoscroll?this.autoscroll.add(a):this.setupAutoscroll([a]),this.autoscroll.setOuterScrollContainer(a)}setupAutoscroll(a){this.autoscroll=new c.x(a,{margin:100,maxSpeed:10,scrollWhenOutside:!0,autoScroll:()=>this.drake&&this.drake.dragging})}getMember(a){return this.members.find(p=>p.dragContainer===a)}initializeDrake(a){this.drake=dragula(a,{moves:(p,l,d,g)=>{const C=this.getMember(l);return!!C&&C.moves(p,l,d,g)},accepts:(p,l)=>{const d=this.getMember(l);return!d||!d.accepts||d.accepts(p,l)},invalid:()=>!1,direction:"vertical",copy:!1,revertOnSpill:!0,removeOnSpill:!1,mirrorContainer:document.body,ignoreInputTextSelection:!0}),this.drake.on("drag",p=>{p.dataset.sourceIndex=(0,u.c)(p).toString()}),this.drake.on("over",(p,l)=>{const d=l.closest(".drop-zone");d&&d.classList.add("-dragged-over")}),this.drake.on("out",(p,l)=>{const d=l.closest(".drop-zone");d&&d.classList.remove("-dragged-over")}),this.drake.on("cloned",(p,l)=>{const d=this.member(l.parentElement);d&&d.onCloned&&d.onCloned(p,l)}),this.drake.on("drop",(p,l,d,g)=>{try{this.handleDrop(p,l,d,g)}catch(C){console.error("Failed to handle drop of %O, %O",p,C)}}),this.drake.on("shadow",(p,l)=>{const d=this.member(l);d&&d.onShadowInserted&&d.onShadowInserted(p)}),this.drake.on("cancel",(p,l)=>{const d=this.member(l);d&&d.onCancel&&d.onCancel(p)})}handleDrop(a,p,l,d){return(0,i.mG)(this,void 0,void 0,function*(){const g=this.member(p),C=this.member(l);g&&C&&(g!==C?(yield g.onAdded(a,p,l,d))?C.onRemoved(a,p,l,d):(0,u.d)(a,a.dataset.sourceIndex||-1,l):g.onMoved(a,p,l,d))})}}n.\u0275fac=function(a){return new(a||n)(r.LFG(e.K0),r.LFG(r.zs3))},n.\u0275prov=r.Yz7({token:n,factory:n.\u0275fac})},97656:(H,D,t)=>{"use strict";function i(e){return`${t.p}assets/images/${e}`}t.d(D,{h:()=>i})},33406:(H,D,t)=>{"use strict";var i,e;t.d(D,{m:()=>i}),(e=i||(i={}))[e.BACKSPACE=8]="BACKSPACE",e[e.TAB=9]="TAB",e[e.ENTER=13]="ENTER",e[e.SHIFT=16]="SHIFT",e[e.CTRL=17]="CTRL",e[e.ALT=18]="ALT",e[e.PAUSE=19]="PAUSE",e[e.CAPS_LOCK=20]="CAPS_LOCK",e[e.ESCAPE=27]="ESCAPE",e[e.SPACE=32]="SPACE",e[e.PAGE_UP=33]="PAGE_UP",e[e.PAGE_DOWN=34]="PAGE_DOWN",e[e.END=35]="END",e[e.HOME=36]="HOME",e[e.LEFT_ARROW=37]="LEFT_ARROW",e[e.UP_ARROW=38]="UP_ARROW",e[e.RIGHT_ARROW=39]="RIGHT_ARROW",e[e.DOWN_ARROW=40]="DOWN_ARROW",e[e.INSERT=45]="INSERT",e[e.DELETE=46]="DELETE",e[e.KEY_0=48]="KEY_0",e[e.KEY_1=49]="KEY_1",e[e.KEY_2=50]="KEY_2",e[e.KEY_3=51]="KEY_3",e[e.KEY_4=52]="KEY_4",e[e.KEY_5=53]="KEY_5",e[e.KEY_6=54]="KEY_6",e[e.KEY_7=55]="KEY_7",e[e.KEY_8=56]="KEY_8",e[e.KEY_9=57]="KEY_9",e[e.KEY_A=65]="KEY_A",e[e.KEY_B=66]="KEY_B",e[e.KEY_C=67]="KEY_C",e[e.KEY_D=68]="KEY_D",e[e.KEY_E=69]="KEY_E",e[e.KEY_F=70]="KEY_F",e[e.KEY_G=71]="KEY_G",e[e.KEY_H=72]="KEY_H",e[e.KEY_I=73]="KEY_I",e[e.KEY_J=74]="KEY_J",e[e.KEY_K=75]="KEY_K",e[e.KEY_L=76]="KEY_L",e[e.KEY_M=77]="KEY_M",e[e.KEY_N=78]="KEY_N",e[e.KEY_O=79]="KEY_O",e[e.KEY_P=80]="KEY_P",e[e.KEY_Q=81]="KEY_Q",e[e.KEY_R=82]="KEY_R",e[e.KEY_S=83]="KEY_S",e[e.KEY_T=84]="KEY_T",e[e.KEY_U=85]="KEY_U",e[e.KEY_V=86]="KEY_V",e[e.KEY_W=87]="KEY_W",e[e.KEY_X=88]="KEY_X",e[e.KEY_Y=89]="KEY_Y",e[e.KEY_Z=90]="KEY_Z",e[e.LEFT_META=91]="LEFT_META",e[e.RIGHT_META=92]="RIGHT_META",e[e.SELECT=93]="SELECT",e[e.NUMPAD_0=96]="NUMPAD_0",e[e.NUMPAD_1=97]="NUMPAD_1",e[e.NUMPAD_2=98]="NUMPAD_2",e[e.NUMPAD_3=99]="NUMPAD_3",e[e.NUMPAD_4=100]="NUMPAD_4",e[e.NUMPAD_5=101]="NUMPAD_5",e[e.NUMPAD_6=102]="NUMPAD_6",e[e.NUMPAD_7=103]="NUMPAD_7",e[e.NUMPAD_8=104]="NUMPAD_8",e[e.NUMPAD_9=105]="NUMPAD_9",e[e.MULTIPLY=106]="MULTIPLY",e[e.ADD=107]="ADD",e[e.SUBTRACT=109]="SUBTRACT",e[e.DECIMAL=110]="DECIMAL",e[e.DIVIDE=111]="DIVIDE",e[e.F1=112]="F1",e[e.F2=113]="F2",e[e.F3=114]="F3",e[e.F4=115]="F4",e[e.F5=116]="F5",e[e.F6=117]="F6",e[e.F7=118]="F7",e[e.F8=119]="F8",e[e.F9=120]="F9",e[e.F10=121]="F10",e[e.F11=122]="F11",e[e.F12=123]="F12",e[e.NUM_LOCK=144]="NUM_LOCK",e[e.SCROLL_LOCK=145]="SCROLL_LOCK",e[e.SEMICOLON=186]="SEMICOLON",e[e.EQUALS=187]="EQUALS",e[e.COMMA=188]="COMMA",e[e.DASH=189]="DASH",e[e.PERIOD=190]="PERIOD",e[e.FORWARD_SLASH=191]="FORWARD_SLASH",e[e.GRAVE_ACCENT=192]="GRAVE_ACCENT",e[e.OPEN_BRACKET=219]="OPEN_BRACKET",e[e.BACK_SLASH=220]="BACK_SLASH",e[e.CLOSE_BRACKET=221]="CLOSE_BRACKET",e[e.SINGLE_QUOTE=222]="SINGLE_QUOTE"},67325:(H,D,t)=>{"use strict";function i(e){const c=e.ctrlKey||e.shiftKey||e.metaKey,u=1===e.button;return c||u}t.d(D,{F:()=>i})},65978:(H,D,t)=>{"use strict";function i(...e){const c=document.createElement("i");return c.setAttribute("aria-hidden","true"),c.classList.add(...e),c}t.d(D,{c:()=>i})},68197:(H,D,t)=>{"use strict";t.d(D,{O:()=>e});const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function e(c=16){return new Array(c).fill(null).map(()=>i.charAt(Math.floor(Math.random()*i.length))).join("")}},93175:(H,D,t)=>{"use strict";t.d(D,{R:()=>r});var i=t(2316),e=t(79441),c=t(80639),u=t(22663);class r{constructor(h,a=250){this.emitter=new i.vpe,this.debouncer=new e.xQ,this.debouncer.pipe((0,c.b)(a),(0,u.R)(h)).subscribe(p=>this.emitter.emit(p))}emit(h){this.debouncer.next(h)}subscribe(h,a,p){return this.emitter.subscribe(h,a,p)}}},26479:(H,D,t)=>{"use strict";t.d(D,{G:()=>g,u:()=>C});var i=t(79441),e=t(83972),c=t(81134),u=t(9170),r=t(83720),n=t(80639),h=t(98636),a=t(79902),p=t(18293),l=t(92597),d=t(22663);function g(y){return m=>y.handleRawError(m)}class C{constructor(m,E,P=!1,w=250){this.requestHandler=m,this.errorHandler=E,this.preFilterNull=P,this.debounceMs=w,this.input$=new i.xQ,this.loading$=new i.xQ,this.lastResult=[],this.output$=(0,e.z)((0,c.of)([]),this.input$.pipe((0,u.h)(x=>!P||null!=x),(0,r.x)(),(0,n.b)(w),(0,h.b)(x=>{this.lastRequestedValue=x,this.lastResult=[],this.loading$.next(!0)}),(0,a.w)(x=>this.requestHandler(x).pipe((0,p.K)(k=>(this.errorHandler(k),(0,c.of)([]))),(0,h.b)(k=>{this.loading$.next(!1),this.lastResult=k}))),(0,l.d)(1)))}request(m){this.input$.next(m)}get hasResults(){return this.lastResult.length>0}observe(m){return this.output$.pipe((0,d.R)(m))}}},88837:(H,D,t)=>{"use strict";t.d(D,{w:()=>e,b:()=>c});var i=t(3352);function e(u,r){try{u.setSelectionRange(r,r)}catch(n){(0,i.qu)("Failed to set click position for edit field.",n)}}function c(u){const r=u.originalEvent;try{if(r.rangeParent){const n=document.createRange();return n.setStart(r.rangeParent,r.rangeOffset),n.startOffset}return document.caretRangeFromPoint?document.caretRangeFromPoint(u.clientX,u.clientY).startOffset:0}catch(n){return(0,i.qu)("Failed to get click position for edit field.",n),0}}},18217:(H,D,t)=>{"use strict";function i(e,c){const u=new URL(e,window.location.origin);return Object.keys(c).forEach(r=>{u.searchParams.set(r,c[r])}),u.pathname+u.search}t.d(D,{Y:()=>i})},21757:(H,D,t)=>{"use strict";t.d(D,{H:()=>F});var i=t(1707),e=t(36868),c=t(80395),u=t(40912),r=t(54364),n=t(3353),h=t(82503),a=t(32853),p=t(84906),l=t(47775),d=t(45921),g=t(37991),C=t(53875),y=t(71858),m=t(65146),E=t(32824),P=t(81496),w=t(63415),x=t(53448),k=t(75867),b=t(81979),v=t(2316);class M{}M.\u0275fac=function(J){return new(J||M)},M.\u0275mod=v.oAB({type:M}),M.\u0275inj=v.cJS({});var S=t(84272),O=t(87523);class F{constructor(J){!function(I){const J=I.get(m.R),N=I.get(l.StateService);window.ErrorReporter.addContext(ee=>{J.inProjectContext&&ee.setTag("project",J.identifier),ee.setExtra("router state",N.current.name)}),I.get(x.$).register("openProjectAngularBootstrap",()=>[{selector:b.o,cls:b.K}])}(J)}}F.\u0275fac=function(J){return new(J||F)(v.LFG(v.zs3))},F.\u0275mod=v.oAB({type:F}),F.\u0275inj=v.cJS({providers:[k.p,S.s],imports:[[p.UIRouterModule,r.ez,i.u5,d.s,u.eL,c._t,h.qE,g.H,e.A0,n._,M,E.j,O.a,P.I,w.J,C.Q,y.a],p.UIRouterModule,r.ez,i.u5,u.eL,c._t,C.Q,y.a,e.A0,n._,M,E.j,d.s,P.I,w.J,a.wA]})},1476:(H,D,t)=>{"use strict";t.d(D,{B:()=>u});var i=t(2316),e=t(1707);const c=["input"];class u{constructor(){this.className=!0,this.disabled=!1,this.name="spot-checkbox-"+ +new Date,this.checkedChange=new i.vpe,this.checked=!1,this.onChange=n=>{},this.onTouched=n=>{}}onStateChange(){const n=this.input.nativeElement.checked;this.checkedChange.emit(n),this.onChange(n),this.onTouched(n)}writeValue(n){setTimeout(()=>{const h=this.input.nativeElement;h.indeterminate=null===n,this.checked=!!n})}registerOnChange(n){this.onChange=n}registerOnTouched(n){this.onTouched=n}}u.\u0275fac=function(n){return new(n||u)},u.\u0275cmp=i.Xpm({type:u,selectors:[["spot-checkbox"]],viewQuery:function(n,h){if(1&n&&i.Gf(c,5),2&n){let a;i.iGM(a=i.CRH())&&(h.input=a.first)}},hostVars:2,hostBindings:function(n,h){2&n&&i.ekj("spot-checkbox",h.className)},inputs:{disabled:"disabled",name:"name",checked:"checked"},outputs:{checkedChange:"checkedChange"},features:[i._Bn([{provide:e.JU,useExisting:(0,i.Gpc)(()=>u),multi:!0}])],decls:3,vars:3,consts:[["type","checkbox",1,"spot-checkbox--input",3,"disabled","checked","change"],["input",""],[1,"spot-checkbox--fake"]],template:function(n,h){1&n&&(i.TgZ(0,"input",0,1),i.NdJ("change",function(){return h.onStateChange()}),i.qZA(),i._UZ(2,"span",2)),2&n&&(i.Q6J("disabled",h.disabled)("checked",h.checked),i.uIk("name",h.name))},encapsulation:2})},21090:(H,D,t)=>{"use strict";t.d(D,{m:()=>d});var i=t(2316),e=t(33406),c=t(96617),u=t(1706),r=t(54364),n=t(55901);const h=function(g){return["spot-drop-modal--body","spot-container",g]};function a(g,C){if(1&g){const y=i.EpF();i.TgZ(0,"div",1),i.NdJ("click",function(E){return i.CHM(y),i.oxw().onBodyClick(E)}),i.Hsn(1,1),i.TgZ(2,"button",2),i.NdJ("click",function(){return i.CHM(y),i.oxw().close()}),i._UZ(3,"span",3),i.qZA(),i.qZA()}if(2&g){const y=i.oxw();i.Q6J("ngClass",i.VKq(2,h,y.alignmentClass)),i.xp6(2),i.uIk("aria-label",y.text.close)}}const p=[[["","slot","trigger"]],[["","slot","body"]]];class d{constructor(C){this.i18n=C,this.className=!0,this.closed=new i.vpe,this.alignment=u.Z.BottomLeft,this._open=!1,this.text={close:this.i18n.t("js.spot.drop_modal.close")},this.closeEventListener=this.close.bind(this),this.onEscape=y=>{y.keyCode===e.m.ESCAPE&&this.close()},this.escapeListener=this.onEscape.bind(this)}set open(C){this._open=C,this._open?setTimeout(()=>{document.body.addEventListener("click",this.closeEventListener),document.body.addEventListener("keydown",this.escapeListener)}):(document.body.removeEventListener("click",this.closeEventListener),document.body.removeEventListener("click",this.escapeListener),this.closed.emit())}get open(){return this._open}get alignmentClass(){return`spot-drop-modal--body_${this.alignment}`}close(){this.open=!1}onBodyClick(C){C.stopPropagation()}ngOnDestroy(){document.body.removeEventListener("click",this.closeEventListener),document.body.removeEventListener("click",this.escapeListener)}}d.\u0275fac=function(C){return new(C||d)(i.Y36(c.D))},d.\u0275cmp=i.Xpm({type:d,selectors:[["spot-drop-modal"]],hostVars:4,hostBindings:function(C,y){2&C&&i.ekj("spot-drop-modal",y.className)("spot-drop-modal_opened",y.open)},inputs:{alignment:"alignment",open:"open"},outputs:{closed:"closed"},ngContentSelectors:["[slot=trigger]","[slot=body]"],decls:2,vars:1,consts:[["cdkTrapFocus","",3,"ngClass","click",4,"ngIf"],["cdkTrapFocus","",3,"ngClass","click"],["type","button",1,"spot-drop-modal--close-button","spot-button",3,"click"],[1,"spot-icon","spot-icon_close"]],template:function(C,y){1&C&&(i.F$t(p),i.Hsn(0),i.YNc(1,a,4,4,"div",0)),2&C&&(i.xp6(1),i.Q6J("ngIf",y.open))},directives:[r.O5,n.mK,r.mk],encapsulation:2})},87912:(H,D,t)=>{"use strict";t.d(D,{A:()=>a});var i=t(2316),e=t(1707),c=t(54364);const u=["input"];function r(p,l){if(1&p){const d=i.EpF();i.TgZ(0,"button",3),i.NdJ("click",function(){i.CHM(d);return i.oxw().value=""}),i._UZ(1,"span",4),i.qZA()}}const n=[[["","slot","before"]],[["","slot","after"]]];class a{constructor(){this.className=!0,this.focused=!1,this.name="spot-text-field-"+ +new Date,this.disabled=!1,this.showClearButton=!0,this.placeholder="",this._value="",this.onChange=l=>{},this.onTouched=l=>{}}onParentClick(){this.input.nativeElement.focus()}get value(){return this._value}set value(l){this._value=l,this.onChange(l),this.onTouched(l)}writeValue(l){this.value=l}registerOnChange(l){this.onChange=l}registerOnTouched(l){this.onTouched=l}}a.\u0275fac=function(l){return new(l||a)},a.\u0275cmp=i.Xpm({type:a,selectors:[["spot-text-field"]],viewQuery:function(l,d){if(1&l&&i.Gf(u,5),2&l){let g;i.iGM(g=i.CRH())&&(d.input=g.first)}},hostVars:4,hostBindings:function(l,d){1&l&&i.NdJ("click",function(){return d.onParentClick()}),2&l&&i.ekj("spot-text-field",d.className)("spot-text-field_focused",d.focused)},inputs:{name:"name",disabled:"disabled",showClearButton:"showClearButton",placeholder:"placeholder",_value:["value","_value"]},features:[i._Bn([{provide:e.JU,useExisting:(0,i.Gpc)(()=>a),multi:!0}])],ngContentSelectors:["[slot=before]","[slot=after]"],decls:5,vars:5,consts:[[1,"spot-text-field--input",3,"disabled","placeholder","ngModel","ngModelChange","focus","blur"],["input",""],["type","button","class","spot-text-field--clear-button",3,"click",4,"ngIf"],["type","button",1,"spot-text-field--clear-button",3,"click"],[1,"spot-icon","spot-icon_close"]],template:function(l,d){1&l&&(i.F$t(n),i.Hsn(0),i.TgZ(1,"input",0,1),i.NdJ("ngModelChange",function(C){return d.value=C})("focus",function(){return d.focused=!0})("blur",function(){return d.focused=!1}),i.qZA(),i.YNc(3,r,2,0,"button",2),i.Hsn(4,1)),2&l&&(i.xp6(1),i.Q6J("disabled",d.disabled)("placeholder",d.placeholder)("ngModel",d.value),i.uIk("name",d.name),i.xp6(2),i.Q6J("ngIf",d.showClearButton&&""!==d.value))},directives:[e.Fj,e.JJ,e.On,c.O5],encapsulation:2})},91448:(H,D,t)=>{"use strict";t.d(D,{v:()=>n});var i=t(2316),e=t(1707),c=t(54364);const u=function(h){return{button:!0,"form--field-inline-button":!0,"-active":h}};function r(h,a){if(1&h){const p=i.EpF();i.TgZ(0,"label",1),i.TgZ(1,"input",2),i.NdJ("ngModelChange",function(d){i.CHM(p);return i.oxw().value=d}),i.qZA(),i._uU(2),i.qZA()}if(2&h){const p=a.$implicit,l=i.oxw();i.Q6J("ngClass",i.VKq(5,u,l.value===p.value)),i.xp6(1),i.Q6J("name",l.name)("value",p.value)("ngModel",l.value),i.xp6(1),i.hij(" ",p.title,"\n")}}class n{constructor(){this.classNameOld=!0,this.className=!0,this.checkedChange=new i.vpe,this.options=[],this.name="spot-toggle-"+ +new Date,this.onChange=a=>{},this.onTouched=a=>{}}get value(){return this._value}set value(a){this._value=a,this.onChange(a),this.onTouched(a)}writeValue(a){this.value=a}registerOnChange(a){this.onChange=a}registerOnTouched(a){this.onTouched=a}}n.\u0275fac=function(a){return new(a||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["spot-toggle"]],hostVars:4,hostBindings:function(a,p){2&a&&i.ekj("form--field-inline-buttons-container",p.classNameOld)("spot-toggle",p.className)},inputs:{options:"options",name:"name",_value:["value","_value"]},outputs:{checkedChange:"checkedChange"},features:[i._Bn([{provide:e.JU,useExisting:(0,i.Gpc)(()=>n),multi:!0}])],decls:1,vars:1,consts:[["data-qa-selector","spot-toggle--option",3,"ngClass",4,"ngFor","ngForOf"],["data-qa-selector","spot-toggle--option",3,"ngClass"],["type","radio",1,"spot-toggle--option-input",3,"name","value","ngModel","ngModelChange"]],template:function(a,p){1&a&&i.YNc(0,r,3,7,"label",0),2&a&&i.Q6J("ngForOf",p.options)},directives:[c.sg,c.mk,e._,e.Fj,e.JJ,e.On],encapsulation:2})},48705:(H,D,t)=>{"use strict";t.d(D,{s:()=>a});var i=t(1706),e=t(2316),c=t(54364);const u=function(p){return["spot-tooltip--body","spot-container",p]};function r(p,l){if(1&p&&(e.TgZ(0,"div",1),e.Hsn(1,1),e.qZA()),2&p){const d=e.oxw();e.Q6J("ngClass",e.VKq(1,u,d.alignmentClass))}}const n=[[["","slot","trigger"]],[["","slot","body"]]];class a{constructor(){this.className=!0,this.dark=!1,this.disabled=!1,this.alignment=i.Z.BottomCenter}get alignmentClass(){return`spot-tooltip--body_${this.alignment}`}}a.\u0275fac=function(l){return new(l||a)},a.\u0275cmp=e.Xpm({type:a,selectors:[["spot-tooltip"]],hostVars:4,hostBindings:function(l,d){2&l&&e.ekj("spot-tooltip",d.className)("spot-tooltip_dark",d.dark)},inputs:{dark:"dark",disabled:"disabled",alignment:"alignment"},ngContentSelectors:["[slot=trigger]","[slot=body]"],decls:2,vars:1,consts:[[3,"ngClass",4,"ngIf"],[3,"ngClass"]],template:function(l,d){1&l&&(e.F$t(n),e.Hsn(0),e.YNc(1,r,2,3,"div",0)),2&l&&(e.xp6(1),e.Q6J("ngIf",!d.disabled))},directives:[c.O5,c.mk],encapsulation:2,changeDetection:0})},1706:(H,D,t)=>{"use strict";var i,c;t.d(D,{Z:()=>e}),(c=i||(i={})).TopLeft="top-left",c.TopCenter="top-center",c.TopRight="top-right",c.RightTop="right-top",c.RightCenter="right-center",c.RightBottom="right-bottom",c.BottomLeft="bottom-left",c.BottomCenter="bottom-center",c.BottomRight="bottom-right",c.LeftTop="left-top",c.LeftCenter="left-center",c.LeftBottom="left-bottom";const e=i},45921:(H,D,t)=>{"use strict";t.d(D,{s:()=>P});var i=t(1707),e=t(54364),c=t(55901),u=t(84906),r=t(2316),n=t(91448),h=t(1476),a=t(96617);function p(w,x){if(1&w){const k=r.EpF();r.TgZ(0,"button",3),r.NdJ("click",function(){return r.CHM(k),r.oxw().remove.emit()}),r._UZ(1,"span",4),r.qZA()}if(2&w){const k=r.oxw();r.Q6J("disabled",k.disabled),r.uIk("aria-label",k.text.remove)}}function l(w,x){if(1&w&&r._UZ(0,"span",5),2&w){const k=r.oxw();r.Q6J("ngClass",k.iconClasses)}}class d{constructor(x){this.i18n=x,this.className=!0,this.disabled=!1,this.removable=!0,this.title="",this.icon="",this.remove=new r.vpe,this.text={remove:this.i18n.t("js.spot.filter_chip.remove")}}get iconClasses(){return["spot-icon",`spot-icon_${this.icon}`]}}d.\u0275fac=function(x){return new(x||d)(r.Y36(a.D))},d.\u0275cmp=r.Xpm({type:d,selectors:[["spot-filter-chip"]],hostVars:4,hostBindings:function(x,k){2&x&&r.ekj("spot-filter-chip",k.className)("spot-filter-chip_disabled",k.disabled)},inputs:{disabled:"disabled",removable:"removable",title:"title",icon:"icon"},outputs:{remove:"remove"},decls:4,vars:3,consts:[["class","spot-filter-chip--remove","type","button",3,"disabled","click",4,"ngIf"],[1,"spot-filter-chip--title"],[3,"ngClass",4,"ngIf"],["type","button",1,"spot-filter-chip--remove",3,"disabled","click"],[1,"spot-icon","spot-icon_close"],[3,"ngClass"]],template:function(x,k){1&x&&(r.YNc(0,p,2,2,"button",0),r.TgZ(1,"div",1),r.YNc(2,l,1,1,"span",2),r._uU(3),r.qZA()),2&x&&(r.Q6J("ngIf",k.removable),r.xp6(2),r.Q6J("ngIf",k.icon),r.xp6(1),r.hij(" ",k.title,"\n"))},directives:[e.O5,e.mk],encapsulation:2});var g=t(87912),C=t(21090),y=t(48705);class m{constructor(){this.indeterminateState=null,this.checkboxValue=null,this.listCheckboxValue=null,this.textFieldValue="ngModel value",this.dropModalOpen=!1,this.dropModalAlignment="bottom-left",this.tooltipAlignment="right-center",this.toggleValue=null,this.toggleOptions=[{value:1,title:"1"},{value:2,title:"2"},{value:3,title:"3"}]}onRemoveChip(){alert("Remove chip")}checkboxValueString(){return null===this.checkboxValue?"null (indeterminate)":this.checkboxValue?"true (checked)":"false (unchecked)"}}m.\u0275fac=function(x){return new(x||m)},m.\u0275cmp=r.Xpm({type:m,selectors:[["spot-docs"]],decls:255,vars:40,consts:[[1,"space-children"],[1,"spot-button"],[1,"spot-icon","spot-icon_bell"],[1,"spot-button","spot-button_main"],[1,"spot-button","spot-button_accent"],[1,"spot-button","spot-button_danger"],["disabled","",1,"spot-button"],[1,"spot-button","spot-button_outlined"],[1,"spot-button","spot-button_outlined","spot-button_main"],[1,"spot-button","spot-button_outlined","spot-button_accent"],[1,"spot-button","spot-button_outlined","spot-button_danger"],["disabled","",1,"spot-button","spot-button_outlined"],[1,"spot-link"],["href","#",1,"spot-link"],[1,"spot-link","spot-link_danger"],["href","#",1,"spot-link","spot-link_danger"],[3,"options","ngModel","ngModelChange"],[3,"checked"],[3,"disabled"],[3,"checked","disabled"],[3,"ngModel","ngModelChange"],["name","checkbox-name",3,"ngModel","disabled","ngModelChange"],[1,"spot-list"],[1,"spot-list--item"],[1,"spot-list--item-action"],[1,"spot-list--item-title"],[1,"spot-list--item-action","spot-list--item-action_disabled"],[3,"ngModel","disabled","ngModelChange"],["title","Default chip",3,"remove"],["title","Unremovable chip",3,"removable"],["title","Default chip with icon","icon","bell",3,"remove"],["icon","bell","title","Unremovable chip with icon",3,"removable"],["title","Default chip",3,"disabled","remove"],["title","Unremovable chip",3,"removable","disabled"],["title","Default chip with icon","icon","bell",3,"disabled","remove"],["icon","bell","title","Unremovable chip with icon",3,"removable","disabled"],["placeholder","Placeholder value",1,"spot-text-field"],["value","Test value",1,"spot-text-field"],["placeholder","Placeholder value","value","Test value","name","textfield-name"],["placeholder","Placeholder value",3,"ngModel","ngModelChange"],["slot","after",1,"spot-icon","spot-icon_bell"],["slot","before",1,"spot-icon","spot-icon_bell"],[3,"open","alignment","closed"],["slot","trigger","type","button",1,"spot-button","spot-button_main",3,"click"],["slot","body"],[1,"spot-container"],[1,"spot-header-small"],[3,"alignment"],["slot","trigger"],["slot","body",1,"spot-body-small"],[1,"spot-body-small"],[3,"alignment","dark"],[1,"spot-action-bar"],[1,"spot-action-bar--left"],[1,"spot-action-bar--right"]],template:function(x,k){1&x&&(r.TgZ(0,"h1"),r._uU(1,"Buttons & Links"),r.qZA(),r.TgZ(2,"section",0),r.TgZ(3,"button",1),r._uU(4,"Default"),r.qZA(),r.TgZ(5,"button",1),r.TgZ(6,"span"),r._uU(7,"Default"),r.qZA(),r._UZ(8,"span",2),r.qZA(),r.TgZ(9,"button",1),r._UZ(10,"span",2),r.qZA(),r.qZA(),r.TgZ(11,"section",0),r.TgZ(12,"button",3),r._uU(13,"Main"),r.qZA(),r.TgZ(14,"button",3),r.TgZ(15,"span"),r._uU(16,"Main"),r.qZA(),r._UZ(17,"span",2),r.qZA(),r.TgZ(18,"button",3),r._UZ(19,"span",2),r.qZA(),r.qZA(),r.TgZ(20,"section",0),r.TgZ(21,"button",4),r._uU(22,"Accent"),r.qZA(),r.TgZ(23,"button",4),r.TgZ(24,"span"),r._uU(25,"Accent"),r.qZA(),r._UZ(26,"span",2),r.qZA(),r.TgZ(27,"button",4),r._UZ(28,"span",2),r.qZA(),r.qZA(),r.TgZ(29,"section",0),r.TgZ(30,"button",5),r._uU(31,"Danger"),r.qZA(),r.TgZ(32,"button",5),r.TgZ(33,"span"),r._uU(34,"Danger"),r.qZA(),r._UZ(35,"span",2),r.qZA(),r.TgZ(36,"button",5),r._UZ(37,"span",2),r.qZA(),r.qZA(),r.TgZ(38,"section",0),r.TgZ(39,"button",6),r._uU(40,"Disabled"),r.qZA(),r.TgZ(41,"button",6),r.TgZ(42,"span"),r._uU(43,"Disabled"),r.qZA(),r._UZ(44,"span",2),r.qZA(),r.TgZ(45,"button",6),r._UZ(46,"span",2),r.qZA(),r.qZA(),r.TgZ(47,"section",0),r.TgZ(48,"button",7),r._uU(49,"Default"),r.qZA(),r.TgZ(50,"button",8),r._uU(51,"Main"),r.qZA(),r.TgZ(52,"button",9),r._uU(53,"Accent"),r.qZA(),r.TgZ(54,"button",10),r._uU(55,"Danger"),r.qZA(),r.TgZ(56,"button",11),r._uU(57,"Disabled"),r.qZA(),r.qZA(),r.TgZ(58,"section",0),r.TgZ(59,"button",12),r._uU(60,"Default link"),r.qZA(),r.TgZ(61,"a",13),r.TgZ(62,"span"),r._uU(63,"Default Link"),r.qZA(),r._UZ(64,"span",2),r.qZA(),r.TgZ(65,"button",12),r._UZ(66,"span",2),r.qZA(),r.qZA(),r.TgZ(67,"section",0),r.TgZ(68,"button",14),r._uU(69,"Danger Link"),r.qZA(),r.TgZ(70,"a",15),r.TgZ(71,"span"),r._uU(72,"Danger Link"),r.qZA(),r._UZ(73,"span",2),r.qZA(),r.TgZ(74,"button",14),r._UZ(75,"span",2),r.qZA(),r.qZA(),r.TgZ(76,"h1"),r._uU(77,"Toggles"),r.qZA(),r.TgZ(78,"spot-toggle",16),r.NdJ("ngModelChange",function(v){return k.toggleValue=v}),r.qZA(),r._uU(79),r.TgZ(80,"h1"),r._uU(81,"Checkbox"),r.qZA(),r.TgZ(82,"label"),r._UZ(83,"spot-checkbox"),r._uU(84," Unchecked\n"),r.qZA(),r.TgZ(85,"label"),r._UZ(86,"spot-checkbox",17),r._uU(87," Checked\n"),r.qZA(),r.TgZ(88,"label"),r._UZ(89,"spot-checkbox",18),r._uU(90," Disabled\n"),r.qZA(),r.TgZ(91,"label"),r._UZ(92,"spot-checkbox",19),r._uU(93," Disabled checked\n"),r.qZA(),r.TgZ(94,"label"),r.TgZ(95,"spot-checkbox",20),r.NdJ("ngModelChange",function(v){return k.checkboxValue=v}),r.qZA(),r._uU(96),r.qZA(),r.TgZ(97,"label"),r.TgZ(98,"spot-checkbox",21),r.NdJ("ngModelChange",function(v){return k.checkboxValue=v}),r.qZA(),r._uU(99),r.qZA(),r.TgZ(100,"h1"),r._uU(101,"Lists"),r.qZA(),r.TgZ(102,"ul",22),r.TgZ(103,"li",23),r.TgZ(104,"label",24),r.TgZ(105,"spot-checkbox",20),r.NdJ("ngModelChange",function(v){return k.listCheckboxValue=v}),r.qZA(),r.TgZ(106,"div",25),r._uU(107,"Checkbox item"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(108,"li",23),r.TgZ(109,"label",24),r.TgZ(110,"spot-checkbox",20),r.NdJ("ngModelChange",function(v){return k.listCheckboxValue=v}),r.qZA(),r.TgZ(111,"div",25),r._uU(112,"Checkbox item with children"),r.qZA(),r.qZA(),r.TgZ(113,"ul",22),r.TgZ(114,"li",23),r.TgZ(115,"label",24),r.TgZ(116,"spot-checkbox",20),r.NdJ("ngModelChange",function(v){return k.listCheckboxValue=v}),r.qZA(),r.TgZ(117,"div",25),r._uU(118,"Child checkbox item"),r.qZA(),r.qZA(),r.TgZ(119,"ul",22),r.TgZ(120,"li",23),r.TgZ(121,"label",24),r.TgZ(122,"spot-checkbox",20),r.NdJ("ngModelChange",function(v){return k.listCheckboxValue=v}),r.qZA(),r.TgZ(123,"div",25),r._uU(124,"Secon level child"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(125,"li",23),r.TgZ(126,"label",24),r.TgZ(127,"spot-checkbox",20),r.NdJ("ngModelChange",function(v){return k.listCheckboxValue=v}),r.qZA(),r.TgZ(128,"div",25),r._uU(129,"Second child checkbox item"),r.qZA(),r.qZA(),r.qZA(),r.TgZ(130,"li",23),r.TgZ(131,"label",26),r.TgZ(132,"spot-checkbox",27),r.NdJ("ngModelChange",function(v){return k.listCheckboxValue=v}),r.qZA(),r.TgZ(133,"div",25),r._uU(134,"Disabled item"),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.qZA(),r.TgZ(135,"h1"),r._uU(136,"Filter Chip"),r.qZA(),r.TgZ(137,"section",0),r.TgZ(138,"spot-filter-chip",28),r.NdJ("remove",function(){return k.onRemoveChip()}),r.qZA(),r._UZ(139,"spot-filter-chip",29),r.TgZ(140,"spot-filter-chip",30),r.NdJ("remove",function(){return k.onRemoveChip()}),r.qZA(),r._UZ(141,"spot-filter-chip",31),r.qZA(),r.TgZ(142,"section",0),r.TgZ(143,"spot-filter-chip",32),r.NdJ("remove",function(){return k.onRemoveChip()}),r.qZA(),r._UZ(144,"spot-filter-chip",33),r.TgZ(145,"spot-filter-chip",34),r.NdJ("remove",function(){return k.onRemoveChip()}),r.qZA(),r._UZ(146,"spot-filter-chip",35),r.qZA(),r.TgZ(147,"h1"),r._uU(148,"Text Field"),r.qZA(),r.TgZ(149,"section",0),r._UZ(150,"input",36),r._UZ(151,"input",37),r._UZ(152,"spot-text-field",38),r.TgZ(153,"spot-text-field",39),r.NdJ("ngModelChange",function(v){return k.textFieldValue=v}),r.qZA(),r.TgZ(154,"spot-text-field",39),r.NdJ("ngModelChange",function(v){return k.textFieldValue=v}),r._UZ(155,"span",40),r.qZA(),r.TgZ(156,"spot-text-field",39),r.NdJ("ngModelChange",function(v){return k.textFieldValue=v}),r._UZ(157,"span",41),r._UZ(158,"span",40),r.qZA(),r.TgZ(159,"spot-text-field",39),r.NdJ("ngModelChange",function(v){return k.textFieldValue=v}),r._UZ(160,"span",41),r.qZA(),r.qZA(),r.TgZ(161,"h1"),r._uU(162,"Drop Modal"),r.qZA(),r.TgZ(163,"select",20),r.NdJ("ngModelChange",function(v){return k.dropModalAlignment=v}),r.TgZ(164,"option"),r._uU(165,"left-top"),r.qZA(),r.TgZ(166,"option"),r._uU(167,"left-center"),r.qZA(),r.TgZ(168,"option"),r._uU(169,"left-bottom"),r.qZA(),r.TgZ(170,"option"),r._uU(171,"top-left"),r.qZA(),r.TgZ(172,"option"),r._uU(173,"top-center"),r.qZA(),r.TgZ(174,"option"),r._uU(175,"top-right"),r.qZA(),r.TgZ(176,"option"),r._uU(177,"right-top"),r.qZA(),r.TgZ(178,"option"),r._uU(179,"right-center"),r.qZA(),r.TgZ(180,"option"),r._uU(181,"right-bottom"),r.qZA(),r.TgZ(182,"option"),r._uU(183,"bottom-left"),r.qZA(),r.TgZ(184,"option"),r._uU(185,"bottom-center"),r.qZA(),r.TgZ(186,"option"),r._uU(187,"bottom-right"),r.qZA(),r.qZA(),r.TgZ(188,"spot-drop-modal",42),r.NdJ("closed",function(){return k.dropModalOpen=!1}),r.TgZ(189,"button",43),r.NdJ("click",function(){return k.dropModalOpen=!k.dropModalOpen}),r._uU(190,"Open Modal"),r.qZA(),r.ynx(191,44),r.TgZ(192,"div",45),r.TgZ(193,"h1",46),r._uU(194,"Test"),r.qZA(),r.TgZ(195,"spot-text-field",39),r.NdJ("ngModelChange",function(v){return k.textFieldValue=v}),r._UZ(196,"span",41),r.qZA(),r.qZA(),r.BQk(),r.qZA(),r.TgZ(197,"h1"),r._uU(198,"Tooltip"),r.qZA(),r.TgZ(199,"section",0),r.TgZ(200,"select",20),r.NdJ("ngModelChange",function(v){return k.tooltipAlignment=v}),r.TgZ(201,"option"),r._uU(202,"left-top"),r.qZA(),r.TgZ(203,"option"),r._uU(204,"left-center"),r.qZA(),r.TgZ(205,"option"),r._uU(206,"left-bottom"),r.qZA(),r.TgZ(207,"option"),r._uU(208,"top-left"),r.qZA(),r.TgZ(209,"option"),r._uU(210,"top-center"),r.qZA(),r.TgZ(211,"option"),r._uU(212,"top-right"),r.qZA(),r.TgZ(213,"option"),r._uU(214,"right-top"),r.qZA(),r.TgZ(215,"option"),r._uU(216,"right-center"),r.qZA(),r.TgZ(217,"option"),r._uU(218,"right-bottom"),r.qZA(),r.TgZ(219,"option"),r._uU(220,"bottom-left"),r.qZA(),r.TgZ(221,"option"),r._uU(222,"bottom-center"),r.qZA(),r.TgZ(223,"option"),r._uU(224,"bottom-right"),r.qZA(),r.qZA(),r.TgZ(225,"spot-tooltip",47),r.ynx(226,48),r._uU(227,"Trigger"),r.BQk(),r.TgZ(228,"p",49),r._uU(229,"Body"),r.qZA(),r.qZA(),r.TgZ(230,"spot-tooltip",47),r.ynx(231,48),r._uU(232,"Trigger"),r.BQk(),r.ynx(233,44),r.TgZ(234,"p",50),r._uU(235,"Body with multiple paragraphs coming in here"),r.qZA(),r.TgZ(236,"p",50),r._uU(237,"This is the second paragraph"),r.qZA(),r.BQk(),r.qZA(),r.TgZ(238,"spot-tooltip",51),r.ynx(239,48),r._uU(240,"Dark tooltip trigger"),r.BQk(),r.ynx(241,44),r.TgZ(242,"p",50),r._uU(243,"This is a dark tooltip"),r.qZA(),r.BQk(),r.qZA(),r.qZA(),r.TgZ(244,"h1"),r._uU(245,"Action Bar"),r.qZA(),r.TgZ(246,"div",52),r.TgZ(247,"div",53),r.TgZ(248,"button",8),r._uU(249," Independent action "),r.qZA(),r.qZA(),r.TgZ(250,"div",54),r.TgZ(251,"button",8),r._uU(252," Some Action "),r.qZA(),r.TgZ(253,"button",3),r._uU(254," Another Action "),r.qZA(),r.qZA(),r.qZA()),2&x&&(r.xp6(78),r.Q6J("options",k.toggleOptions)("ngModel",k.toggleValue),r.xp6(1),r.hij("\nCurrently selected value is ",k.toggleValue," "),r.xp6(7),r.Q6J("checked",!0),r.xp6(3),r.Q6J("disabled",!0),r.xp6(3),r.Q6J("checked",!0)("disabled",!0),r.xp6(3),r.Q6J("ngModel",k.checkboxValue),r.xp6(1),r.hij(" Currently ",k.checkboxValueString(),"\n"),r.xp6(2),r.Q6J("ngModel",k.checkboxValue)("disabled",!0),r.xp6(1),r.hij(" Currently ",k.checkboxValueString(),"\n"),r.xp6(6),r.Q6J("ngModel",k.listCheckboxValue),r.xp6(5),r.Q6J("ngModel",k.listCheckboxValue),r.xp6(6),r.Q6J("ngModel",k.listCheckboxValue),r.xp6(6),r.Q6J("ngModel",k.listCheckboxValue),r.xp6(5),r.Q6J("ngModel",k.listCheckboxValue),r.xp6(5),r.Q6J("ngModel",k.listCheckboxValue)("disabled",!0),r.xp6(7),r.Q6J("removable",!1),r.xp6(2),r.Q6J("removable",!1),r.xp6(2),r.Q6J("disabled",!0),r.xp6(1),r.Q6J("removable",!1)("disabled",!0),r.xp6(1),r.Q6J("disabled",!0),r.xp6(1),r.Q6J("removable",!1)("disabled",!0),r.xp6(7),r.Q6J("ngModel",k.textFieldValue),r.xp6(1),r.Q6J("ngModel",k.textFieldValue),r.xp6(2),r.Q6J("ngModel",k.textFieldValue),r.xp6(3),r.Q6J("ngModel",k.textFieldValue),r.xp6(4),r.Q6J("ngModel",k.dropModalAlignment),r.xp6(25),r.Q6J("open",k.dropModalOpen)("alignment",k.dropModalAlignment),r.xp6(7),r.Q6J("ngModel",k.textFieldValue),r.xp6(5),r.Q6J("ngModel",k.tooltipAlignment),r.xp6(25),r.Q6J("alignment",k.tooltipAlignment),r.xp6(5),r.Q6J("alignment",k.tooltipAlignment),r.xp6(8),r.Q6J("alignment",k.tooltipAlignment)("dark",!0))},directives:[n.v,i.JJ,i.On,h.B,d,g.A,i.EJ,i.YN,i.Kr,C.m,y.s],styles:[".space-children{display:flex;flex-wrap:wrap}.space-children>*{margin:.5rem}#content,#content-wrapper{background-color:#eee}\n","\n  #content-wrapper {\n    background-color: #eee;\n  }\n"],encapsulation:2});const E=[{name:"styleguide",parent:"root",url:"/design/spot",views:{"!$default":{component:m}}}];class P{}P.\u0275fac=function(x){return new(x||P)},P.\u0275mod=r.oAB({type:P}),P.\u0275inj=r.cJS({imports:[[u.UIRouterModule.forChild({states:E}),i.u5,e.ez,c.rt]]})},92340:(H,D,t)=>{"use strict";t.d(D,{N:()=>i});const i={production:!0}},64970:(H,D,t)=>{"use strict";var i=t(71570),e=t(2316),c=t(1707),u=t(87853),r=t(65084),n=t(21757),h=t(45921),a=t(80261),p=t(99250),l=t(31283),d=t(97779),g=t(32853),C=t(53448),y=t(55811),m=t(51303),E=t(80395),P=t(49369),w=t(96617),x=t(65146);class k{constructor(o,s,T,j){this.startRow=o,this.endRow=s,this.startColumn=T,this.endColumn=j}get gridStartRow(){return 2*this.startRow}get gridEndRow(){return 2*this.endRow-1}get gridStartColumn(){return 2*this.startColumn}get gridEndColumn(){return 2*this.endColumn-1}get guid(){return this.storedGuid||(this.storedGuid=this.newGuid()),this.storedGuid}newGuid(){function o(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return`${o()+o()}-${o()}-${o()}-${o()}-${o()}${o()}${o()}`}}class b extends k{constructor(o){super(o.startRow,o.endRow,o.startColumn,o.endColumn),this.widget=o}reset(){this.startRow=this.widget.startRow,this.endRow=this.widget.endRow,this.startColumn=this.widget.startColumn,this.endColumn=this.widget.endColumn}moveRight(){this.startColumn++,this.endColumn++}moveLeft(){this.startColumn--,this.endColumn--}growColumn(){this.endColumn++}overlaps(o){return this.rowOverlaps(o)&&this.columnOverlaps(o)}rowOverlaps(o){return this.startRow<o.endRow&&this.endRow>=o.endRow||this.startRow<=o.startRow&&this.endRow>o.startRow||this.startRow>o.startRow&&this.endRow<o.endRow}columnOverlaps(o){return this.startColumn<o.endColumn&&this.endColumn>=o.endColumn||this.startColumn<=o.startColumn&&this.endColumn>o.startColumn||this.startColumn>o.startColumn&&this.endColumn<o.endColumn}startColumnOverlaps(o){return this.startColumn<o.startColumn&&this.endColumn>o.startColumn&&this.rowOverlaps(o)}get unchangedSize(){return this.startColumn===this.widget.startColumn&&this.endColumn===this.widget.endColumn&&this.startRow===this.widget.startRow&&this.endRow===this.widget.endRow}writeAreaChangeToWidget(){this.widget.startRow=this.startRow,this.widget.endRow=this.endRow,this.widget.startColumn=this.startColumn,this.widget.endColumn=this.endColumn}copyDimensionsTo(o){o.startRow=this.startRow,o.startColumn=this.startColumn,o.endRow=this.endRow,o.endColumn=this.endColumn}}class v extends k{constructor(o,s,T,j,q){super(o,s,T,j),this.type=q}get gridStartRow(){return this.isRow?2*this.startRow-1:2*this.startRow}get gridEndRow(){return this.isRow?2*this.endRow-2:2*this.endRow-1}get gridStartColumn(){return this.isRow?2*this.startColumn:2*this.startColumn-1}get gridEndColumn(){return this.isRow?2*this.endColumn-1:2*this.endColumn-2}get isRow(){return"row"===this.type}get isColumn(){return"column"===this.type}}var M=t(36293),S=t(76491),O=t(20979),A=t(71909);class F{constructor(o,s,T){this.apiV3Service=o,this.toastService=s,this.i18n=T,this.numColumns=0,this.numRows=0,this.mousedOverArea=null,this.$mousedOverArea=new S.X(this.mousedOverArea),this.helpMode=!1}set gridResource(o){this.resource=o,this.fetchSchema(),this.numRows=this.resource.rowCount,this.numColumns=this.resource.columnCount,this.buildAreas(!0)}get gridResource(){return this.resource}setMousedOverArea(o){this.mousedOverArea=o,this.$mousedOverArea.next(o)}cleanupUnusedAreas(){let o=_.range(this.numRows,0,-1);this.widgetAreas.forEach(T=>{o=o.filter(j=>j!==T.startRow)}),o.forEach(T=>{this.numRows>1&&this.removeRow(T)});let s=_.range(this.numColumns,0,-1);this.widgetAreas.forEach(T=>{s=s.filter(j=>j!==T.startColumn)}),s.forEach(T=>{this.numColumns>1&&this.removeColumn(T)})}buildAreas(o=!1){this.gridAreas=this.buildGridAreas(),this.gridGaps=this.buildGridGaps(),this.gridAreaIds=this.buildGridAreaIds(),o&&(this.widgetAreas=this.buildGridWidgetAreas())}rebuildAndPersist(){this.persist(),this.buildAreas(!1)}persist(){this.resource.rowCount=this.numRows=(this.widgetAreas.map(o=>o.endRow).sort((o,s)=>o-s).pop()||2)-1,this.resource.columnCount=this.numColumns,this.writeAreaChangesToWidgets(),this.saveGrid(this.resource,this.schema)}saveWidgetChangeset(o){const s=A.E.extractPayload(this.resource,this.schema),T=s.widgets.find(j=>j.id===o.pristineResource.id);Object.assign(T,o.changes),s.id=this.resource.id,this.saveGrid(s)}isGap(o){return o instanceof v}get isSingleCell(){return 1===this.numRows&&1===this.numColumns&&0===this.widgetResources.length}get inHelpMode(){return this.helpMode||this.isSingleCell}toggleHelpMode(){this.helpMode=!this.helpMode}scrollPlaceholderIntoView(){const o=jQuery(".grid--area.-placeholder");o[0].scrollIntoViewIfNeeded&&setTimeout(()=>o[0].scrollIntoViewIfNeeded())}saveGrid(o,s){this.apiV3Service.grids.id(o).patch(o,s).subscribe(T=>{this.assignAreasWidget(T),this.toastService.addSuccess(this.i18n.t("js.notice_successful_update"))})}assignAreasWidget(o){this.resource.widgets=o.widgets;const s=this.widgetAreas.map(T=>T.widget.id);this.widgetAreas.forEach(T=>{let j;j=T.widget.id?o.widgets.find(q=>q.id===T.widget.id):o.widgets.find(q=>!s.includes(q.id)&&q.identifier===T.widget.identifier&&q.startRow===T.widget.startRow&&q.startColumn===T.widget.startColumn),T.widget=j})}buildGridAreas(){const o=[];for(let s=1;s<=this.numRows+1;s++)o.push(...this.buildGridAreasRow(s));return o}buildGridGaps(){const o=[];if(this.isSingleCell)return o;for(let s=1;s<=this.numRows+1;s++)o.push(...this.buildGridGapRow(s));return o}buildGridAreasRow(o){const s=[];for(let T=1;T<=this.numColumns;T++){const j=new k(o,o+1,T,T+1);s.push(j)}return s}buildGridGapRow(o){const s=[];for(let T=1;T<=this.numColumns;T++)s.push(new v(o,o+1,T,T+1,"row"));if(o<=this.numRows)for(let T=1;T<=this.numColumns+1;T++)s.push(new v(o,o+1,T,T+1,"column"));return s}buildGridWidgetAreas(){return this.widgetResources.map(o=>new b(o))}writeAreaChangesToWidgets(){this.widgetAreas.forEach(o=>{o.writeAreaChangeToWidget()})}addColumn(o,s){this.numColumns++;const T=[];for(let j=1;j<=this.numRows;j++){if(j===s)continue;const q=this.rowWidgets(j).sort((fe,Be)=>fe.startColumn-Be.startColumn).find(fe=>!(fe.startRow<s&&fe.endRow>s)&&(fe.startColumn===o+1||fe.endColumn===o+1||fe.startColumn<=o&&fe.endColumn>o));q&&(T.push(q),q.endColumn++)}this.moveSubsequentRowWidgets(this.widgetAreas.filter(j=>!T.includes(j)),o)}addRow(o,s){this.numRows++;const T=[];for(let j=1;j<=this.numColumns;j++){if(j===s)continue;const q=this.columnWidgets(j).sort((fe,Be)=>fe.startRow-Be.startRow).find(fe=>!(fe.startColumn<s&&fe.endColumn>s)&&(fe.startRow===o+1||fe.endRow===o+1||fe.startRow<=o&&fe.endRow>o));q&&(T.push(q),q.endRow++)}this.moveSubsequentColumnWidgets(this.widgetAreas.filter(j=>!T.includes(j)),o)}removeColumn(o){this.numColumns--,this.widgetAreas.forEach(s=>{s.startColumn<=o&&s.endColumn>=o+1&&s.endColumn--}),this.widgetAreas.filter(s=>s.startColumn>o).forEach(s=>{s.startColumn--,s.endColumn--})}removeRow(o){this.numRows--,this.widgetAreas.forEach(s=>{s.startRow<=o&&s.endRow>=o+1&&s.endRow--}),this.widgetAreas.filter(s=>s.startRow>o).forEach(s=>{s.startRow--,s.endRow--})}resetAreas(o=null){this.widgetAreas.filter(s=>!o||s.guid!==o.guid).forEach(s=>s.reset()),this.numRows=this.resource.rowCount,this.numColumns=this.resource.columnCount}get isEditable(){return void 0!==this.gridResource.updateImmediately}buildGridAreaIds(){return this.gridAreas.filter(o=>!this.isGap(o)).map(o=>o.guid)}fetchSchema(){this.apiV3Service.grids.id(this.resource).form.post({}).subscribe(o=>this.schema=o.schema)}removeWidget(o){let s=this.resource.widgets.findIndex(T=>T.id===o.id);this.resource.widgets.splice(s,1),s=this.widgetAreas.findIndex(T=>T.widget.id===o.id),this.widgetAreas.splice(s,1),this.cleanupUnusedAreas(),this.rebuildAndPersist()}get widgetResources(){return this.resource&&this.resource.widgets||[]}rowWidgets(o){return this.widgetAreas.filter(s=>s.startRow===o)}moveSubsequentRowWidgets(o,s){o.forEach(T=>{T.startColumn>s&&(T.startColumn++,T.endColumn++)})}columnWidgets(o){return this.widgetAreas.filter(s=>s.startColumn===o)}moveSubsequentColumnWidgets(o,s){o.forEach(T=>{T.startRow>s&&(T.startRow++,T.endRow++)})}}F.\u0275fac=function(o){return new(o||F)(e.LFG(O.T),e.LFG(M.kl),e.LFG(w.D))},F.\u0275prov=e.Yz7({token:F,factory:F.\u0275fac});var I=t(54364),J=t(77616);const N=[[["","slot","prepend"]],[["","slot","menu"]]],te=function(f){return{"-editable":f}};class G{constructor(o){this.layout=o,this.editable=!0,this.onRenamed=new e.vpe}renamed(o){this.onRenamed.emit(o)}get isRenameable(){return this.editable&&this.layout.isEditable}}G.\u0275fac=function(o){return new(o||G)(e.Y36(F))},G.\u0275cmp=e.Xpm({type:G,selectors:[["widget-header"]],inputs:{name:"name",editable:"editable"},outputs:{onRenamed:"onRenamed"},ngContentSelectors:["[slot=prepend]","[slot=menu]"],decls:4,vars:5,consts:[["data-qa-selector","op-widget-box--header",1,"op-widget-box--header",3,"ngClass"],[1,"op-widget-box--header-title",3,"title","editable","onSave"]],template:function(o,s){1&o&&(e.F$t(N),e.TgZ(0,"h3",0),e.Hsn(1),e.TgZ(2,"editable-toolbar-title",1),e.NdJ("onSave",function(j){return s.renamed(j)}),e.qZA(),e.Hsn(3,1),e.qZA()),2&o&&(e.Q6J("ngClass",e.VKq(3,te,s.isRenameable)),e.xp6(2),e.Q6J("title",s.name)("editable",s.isRenameable))},directives:[I.mk,J.s5],styles:[".op-widget-box--header.-editable[_ngcontent-%COMP%]{margin-top:0}.op-widget-box--header-title[_ngcontent-%COMP%]{padding-right:5px}"],changeDetection:0});var se=t(3786);t(75421);class _e{constructor(o){this.layout=o}area(o){this.widget(o.widget)}widget(o){this.layout.removeWidget(o)}}_e.\u0275fac=function(o){return new(o||_e)(e.LFG(F))},_e.\u0275prov=e.Yz7({token:_e,factory:_e.\u0275fac});class he{constructor(o,s,T){this.i18n=o,this.remove=s,this.layout=T,this.menuItemList=[this.removeItem]}get menuItems(){return()=>(0,se.mG)(this,void 0,void 0,function*(){return this.menuItemList})}get removeItem(){return{linkText:this.i18n.t("js.grid.remove"),onClick:()=>(this.remove.widget(this.resource),!0)}}get hasMenu(){return this.layout.isEditable}}he.\u0275fac=function(o){return new(o||he)(e.Y36(w.D),e.Y36(_e),e.Y36(F))},he.\u0275dir=e.lG2({type:he,inputs:{resource:"resource"}});var ae=t(11269);function re(f,o){if(1&f&&e._UZ(0,"icon-triggered-context-menu",1),2&f){const s=e.oxw();e.Q6J("menu-items",s.menuItems)}}class ye extends he{}ye.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(ye)))(s||ye)}}(),ye.\u0275cmp=e.Xpm({type:ye,selectors:[["widget-menu"]],features:[e.qOj],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(o,s){1&o&&e.YNc(0,re,1,1,"icon-triggered-context-menu",0),2&o&&e.Q6J("ngIf",s.hasMenu)},directives:[I.O5,ae.I],styles:["[_nghost-%COMP%]{align-self:center}"]});var Ce=t(97047),ke=t(15334);class Ae extends P._{constructor(o,s,T){super(o,s),this.i18n=o,this.injector=s,this.currentProject=T}get projectIdentifier(){return this.currentProject.identifier}}Ae.\u0275fac=function(o){return new(o||Ae)(e.Y36(w.D),e.Y36(e.zs3),e.Y36(x.R))},Ae.\u0275cmp=e.Xpm({type:Ae,selectors:[["ng-component"]],features:[e.qOj],decls:4,vars:3,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource"],["wp-isolated-query-space",""],[3,"static"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e.NdJ("onRenamed",function(j){return s.renameWidget(j)}),e._UZ(1,"widget-menu",1),e.qZA(),e.ynx(2,2),e._UZ(3,"op-wp-calendar",3),e.BQk()),2&o&&(e.Q6J("name",s.widgetName),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(2),e.Q6J("static",!0))},directives:[G,ye,Ce.A,ke.X],encapsulation:2});var Fe=t(70233),ot=t(70692),it=t(77355),Ve=t(60312),Ie=t(12877),ue=t(86469),ie=t(62964);class R{getOrderedDaysData(o,s=moment.weekdays(!0),T=moment.localeData().firstDayOfWeek()){const j=T-1,q=j>=0?o.splice(0,j):o.splice(j),fe=j>=0?[...o,...q]:[...q,...o];return fe.map((Ye,at)=>({weekDay:s[at],checked:Ye,originalIndex:this.getOriginalIndex(j,at,fe.length)}))}getOriginalIndex(o,s,T){let j=s+o;return j<0?j=T-1:j>=T&&(j=0),j}getCheckedValuesInOriginalOrder(o){const s=o.sort((T,j)=>T.originalIndex<j.originalIndex?-1:1).map(T=>T.checked);return this.validDays(s)}validDays(o){return o.every(s=>!s)?Array.apply(null,Array(7)).map(()=>!0):o}}R.\u0275fac=function(o){return new(o||R)},R.\u0275prov=e.Yz7({token:R,factory:R.\u0275fac});var L=t(52932);function W(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",7),e._UZ(1,"label",8),e.TgZ(2,"span",9),e.TgZ(3,"span",10),e.TgZ(4,"input",11),e.NdJ("ngModelChange",function(j){return e.CHM(s).$implicit.checked=j}),e.qZA(),e.qZA(),e.qZA(),e.qZA()}if(2&f){const s=o.$implicit,T=o.index;e.xp6(1),e.Q6J("textContent",s.weekDay)("htmlFor","day_"+T),e.xp6(3),e.Q6J("id","day_"+T)("ngModel",s.checked)}}class oe extends Ve.T{constructor(o,s,T,j,q,fe,Be,Ye,at,At){super(o,Be,at),this.locals=o,this.I18n=s,this.injector=T,this.appRef=j,this.loadingIndicator=q,this.notificationService=fe,this.cdRef=Be,this.configuration=Ye,this.elementRef=at,this.timeEntriesCurrentUserConfigurationModalService=At,this.closeOnEscape=!0,this.closeOnOutsideClick=!0,this.text={displayedDays:this.I18n.t("js.grid.widgets.time_entries_current_user.displayed_days"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel")}}ngOnInit(){const o=this.locals.options.days;this.daysOriginalCheckedValues=o.length>0?o:Array.from({length:7},()=>!0),this.days=this.timeEntriesCurrentUserConfigurationModalService.getOrderedDaysData(this.daysOriginalCheckedValues)}saveChanges(){const o=this.timeEntriesCurrentUserConfigurationModalService.getCheckedValuesInOriginalOrder(this.days);this.options={days:o},this.service.close()}}function Oe(f,o){if(1&f&&e._UZ(0,"icon-triggered-context-menu",1),2&f){const s=e.oxw();e.Q6J("menu-items",s.menuItems)}}oe.\u0275fac=function(o){return new(o||oe)(e.Y36(it.E),e.Y36(w.D),e.Y36(e.zs3),e.Y36(e.z2F),e.Y36(ue.vt),e.Y36(ie.q),e.Y36(e.sBO),e.Y36(Ie.e),e.Y36(e.SBq),e.Y36(R))},oe.\u0275cmp=e.Xpm({type:oe,selectors:[["ng-component"]],features:[e._Bn([R]),e.qOj],decls:8,vars:4,consts:[["data-indicator-name","modal","tabindex","0",1,"op-modal"],[3,"close"],[1,"op-modal--body"],["class","form--field -trailing-label",4,"ngFor","ngForOf"],[1,"op-modal--footer"],[1,"button",3,"textContent","click"],[1,"button","-highlight",3,"textContent","click"],[1,"form--field","-trailing-label"],[1,"form--label",3,"textContent","htmlFor"],[1,"form--field-container"],[1,"form--check-box-container"],["type","checkbox","name","days",1,"form--check-box",3,"id","ngModel","ngModelChange"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"op-modal-header",1),e.NdJ("close",function(j){return s.closeMe(j)}),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,W,5,4,"div",3),e.qZA(),e.TgZ(5,"div",4),e.TgZ(6,"button",5),e.NdJ("click",function(j){return s.closeMe(j)}),e.qZA(),e.TgZ(7,"button",6),e.NdJ("click",function(){return s.saveChanges()}),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.Oqu(s.text.displayedDays),e.xp6(2),e.Q6J("ngForOf",s.days),e.xp6(2),e.Q6J("textContent",s.text.cancelButton),e.xp6(1),e.Q6J("textContent",s.text.applyButton))},directives:[L.g,I.sg,c.Wl,c.JJ,c.On],encapsulation:2});class $ extends he{constructor(o,s,T,j,q){super(T,j,q),this.injector=o,this.opModalService=s,this.i18n=T,this.remove=j,this.layout=q,this.onConfigured=new e.vpe,this.menuItemList=[this.removeItem,this.configureItem]}get configureItem(){return{linkText:this.i18n.t("js.grid.configure"),onClick:()=>(this.opModalService.show(oe,this.injector,this.locals).closingEvent.subscribe(o=>{o.options&&this.onConfigured.emit(o.options)}),!0)}}get locals(){return{options:this.resource.options}}}$.\u0275fac=function(o){return new(o||$)(e.Y36(e.zs3),e.Y36(it.S),e.Y36(w.D),e.Y36(_e),e.Y36(F))},$.\u0275cmp=e.Xpm({type:$,selectors:[["widget-time-entries-current-user-menu"]],outputs:{onConfigured:"onConfigured"},features:[e.qOj],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(o,s){1&o&&e.YNc(0,Oe,1,1,"icon-triggered-context-menu",0),2&o&&e.Q6J("ngIf",s.hasMenu)},directives:[I.O5,ae.I],encapsulation:2});var Xe=t(76910),rt=t(2281),ge=t(47775),be=t(47104),Me=t(17281),Re=t(12703),$e=t(72388),pt=t(46709),mt=t(52167),vt=t(1056),Ue=t(44022),Le=t(67727),Ee=t(10190),st=t(18640),ut=t(2775);function It(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){return e.CHM(s),e.oxw().addEventToday()}),e._UZ(1,"op-icon",5),e._UZ(2,"span",6),e.qZA()}if(2&f){const s=e.oxw();e.uIk("aria-label",s.text.logTime),e.xp6(2),e.Q6J("textContent",s.text.logTime)}}const Zt="te-calendar--time-entry",jt="te-calendar--add-entry",bt="-prohibited";class Lt{constructor(o,s,T,j,q,fe,Be,Ye,at,At,Ot,zt,Wi,Ds,yr){this.states=o,this.apiV3Service=s,this.$state=T,this.element=j,this.i18n=q,this.injector=fe,this.notifications=Be,this.sanitizer=Ye,this.configuration=at,this.timezone=At,this.timeEntryEdit=Ot,this.timeEntryCreate=zt,this.schemaCache=Wi,this.colors=Ds,this.browserDetector=yr,this.static=!1,this.entries=new e.vpe,this.minHour=1,this.maxHour=12,this.labelIntervalHours=2,this.scaleRatio=1,this.memoizedCreateAllowed=!1,this.hiddenDays=[],this.text={logTime:this.i18n.t("js.button_log_time"),today:this.i18n.t("js.team_planner.today")},this.calendarOptions={editable:!1,locale:this.i18n.locale,fixedWeekCount:!1,headerToolbar:{right:"",center:"title",left:"prev,next today"},buttonText:{today:this.text.today},initialView:"timeGridWeek",firstDay:this.configuration.startOfWeek(),hiddenDays:[],contentHeight:550,slotEventOverlap:!1,slotLabelInterval:`${this.labelIntervalHours}:00:00`,slotLabelFormat:Eo=>((this.maxHour-Eo.date.hour)/this.scaleRatio).toString(),allDaySlot:!1,displayEventTime:!1,slotMinTime:this.minHour-1+":00:00",slotMaxTime:`${this.maxHour}:00:00`,events:this.calendarEventsFunction.bind(this),eventOverlap:Eo=>!Eo.classNames.includes(Zt),plugins:[be.ZP,Me.ZP],eventDidMount:this.alterEventEntry.bind(this),eventWillUnmount:this.beforeEventRemove.bind(this),eventClick:this.dispatchEventClick.bind(this),eventDrop:this.moveEvent.bind(this)}}set displayedDays(o){this.setHiddenDays(o)}calendarEventsFunction(o,s,T){this.fetchTimeEntries(o.start,o.end).then(j=>{this.entries.emit(j),s(this.buildEntries(j.elements,o))})}fetchTimeEntries(o,s){if(!this.memoizedTimeEntries||this.memoizedTimeEntries.start.getTime()!==o.getTime()||this.memoizedTimeEntries.end.getTime()!==s.getTime()){const T=this.apiV3Service.time_entries.list({filters:this.dmFilters(o,s),pageSize:500}).toPromise().then(j=>(this.memoizedCreateAllowed=!!j.createTimeEntry,j));this.memoizedTimeEntries={start:o,end:s,entries:T}}return this.memoizedTimeEntries.entries}buildEntries(o,s){return this.setRatio(o),this.buildTimeEntryEntries(o).concat(this.buildAuxEntries(o,s))}setRatio(o){const s=this.calculateDateSums(o),T=Math.max(...Object.values(s),0),j=this.scaleRatio;T>this.maxHour-this.minHour?this.scaleRatio=this.smallerSuitableRatio((this.maxHour-this.minHour)/T):this.scaleRatio=1,j!==this.scaleRatio&&this.ucCalendar.getApi().setOption("slotLabelFormat",q=>((this.maxHour-q.date.hour)/this.scaleRatio).toString())}buildTimeEntryEntries(o){const s={};return o.map(T=>{let j,q;const fe=this.timezone.toHours(T.hours)*this.scaleRatio;s[T.spentOn]?(j=s[T.spentOn].clone().subtract(fe,"h"),q=s[T.spentOn].clone()):(j=rt(T.spentOn).add(this.maxHour-fe,"h"),q=rt(T.spentOn).add(this.maxHour,"h")),s[T.spentOn]=j;this.colors.toHsl(this.entryName(T));return this.timeEntry(T,fe,j,q)})}buildAuxEntries(o,s){const T=this.calculateDateSums(o),j=[];for(let q=rt(s.start);q.diff(s.end,"days")<=0;q.add(1,"days")){const fe=T[q.format("YYYY-MM-DD")]||0;j.push(this.sumEntry(q,fe)),this.memoizedCreateAllowed&&j.push(this.addEntry(q,fe))}return j}calculateDateSums(o){const s={};return o.forEach(T=>{const j=this.timezone.toHours(T.hours);s[T.spentOn]?s[T.spentOn]+=j:s[T.spentOn]=j}),s}timeEntry(o,s,T,j){const q=this.colors.toHsl(this.entryName(o)),fe=[Zt],Be=j.diff(T,"m");return Be<40&&fe.push("-no-fadeout"),{title:Be<20?"":this.entryName(o),startEditable:!!o.update,start:T.format(),end:j.format(),backgroundColor:q,borderColor:q,classNames:fe,entry:o}}sumEntry(o,s){return{start:o.clone().add(this.maxHour-Math.min(s*this.scaleRatio,this.maxHour-.5)-.5,"h").format(),end:o.clone().add(this.maxHour-Math.min((s+.05)*this.scaleRatio,this.maxHour-.5),"h").format(),classNames:"te-calendar--day-sum",rendering:"background",startEditable:!1,sum:this.i18n.t("js.units.hour",{count:this.formatNumber(s)})}}addEntry(o,s){const T=[jt];return s>=24&&T.push(bt),{start:o.clone().format(),end:o.clone().add(this.maxHour-Math.min(s*this.scaleRatio,this.maxHour-1)-.5,"h").format(),rendering:"background",classNames:T}}dmFilters(o,s){return[["spentOn","<>d",[rt(o).format("YYYY-MM-DD"),rt(s).subtract(1,"d").format("YYYY-MM-DD")]],["user_id","=",["me"]]]}dispatchEventClick(o){o.event.extendedProps.entry?this.editEvent(o.event.extendedProps.entry):o.el.classList.contains(jt)&&!o.el.classList.contains(bt)&&this.addEvent(rt(o.event.start))}editEvent(o){this.timeEntryEdit.edit(o).then(s=>{this.updateEventSet(s.entry,s.action)}).catch(()=>{})}moveEvent(o){const{entry:s}=o.event.extendedProps;s.spentOn=rt(o.event.end).format("YYYY-MM-DD"),this.schemaCache.ensureLoaded(s).then(T=>{this.apiV3Service.time_entries.id(s).patch(s,T).subscribe(j=>this.updateEventSet(j,"update"),j=>{this.notifications.handleRawError(j),o.revert()})})}addEventToday(){this.addEvent(rt(new Date))}addEvent(o){!this.memoizedCreateAllowed||this.timeEntryCreate.create(o).then(s=>{this.updateEventSet(s.entry,s.action)}).catch(()=>{})}updateEventSet(o,s){this.memoizedTimeEntries.entries.then(T=>{const j=T.elements.findIndex(q=>q.id===o.id);switch(s){case"update":T.elements[j]=o;break;case"destroy":T.elements.splice(j,1);break;case"create":this.apiV3Service.time_entries.cache.updateFor(o),T.elements.push(o)}this.ucCalendar.getApi().refetchEvents()})}alterEventEntry(o){this.appendAddIcon(o),this.appendSum(o),o.event.extendedProps.entry&&(this.addTooltip(o),this.prependDuration(o),this.appendFadeout(o))}appendAddIcon(o){if(!o.el.classList.contains(jt))return;const s=document.createElement("div");s.classList.add("te-calendar--add-icon"),s.innerText="+",o.el.append(s)}appendSum(o){o.event.extendedProps.sum&&(o.el.innerHTML=o.event.extendedProps.sum)}addTooltip(o){this.browserDetector.isMobile||jQuery(o.el).tooltip({content:this.tooltipContentString(o.event.extendedProps.entry),items:".fc-event",close(){jQuery(".ui-helper-hidden-accessible").remove()},track:!0})}removeTooltip(o){jQuery(o.el).tooltip("disable")}prependDuration(o){const s=o.event.extendedProps.entry;if(this.timezone.toHours(s.hours)<.5)return;const T=this.timezone.formattedDuration(s.hours);jQuery(o.el).find(".fc-event-title").prepend(`<div class="fc-duration">${T}</div>`)}appendFadeout(o){const s=o.event.extendedProps.entry;if(this.timezone.toHours(s.hours)<.5)return;const T=jQuery(o.el),j=jQuery('<div class="fc-fadeout"></div>'),q=this.colors.toHsla(this.entryName(s),0),fe=this.colors.toHsla(this.entryName(s),100);j.css("background",`-webkit-linear-gradient(${q} 0%, ${fe} 100%`),["-moz-linear-gradient","-o-linear-gradient","linear-gradient","-ms-linear-gradient"].forEach(Be=>{j.css("background-image",`${Be}(${q} 0%, ${fe} 100%`)}),T.append(j)}beforeEventRemove(o){!o.event.extendedProps.entry||this.removeTooltip(o)}entryName(o){let{name:s}=o.project;return o.workPackage&&(s+=` - ${this.workPackageName(o)}`),s||"-"}workPackageName(o){return`#${(0,Ee.Z)(o.workPackage.href)}: ${o.workPackage.name}`}tooltipContentString(o){return`\n        <ul class="tooltip--map">\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.project")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(o.project.name)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.work_package")}:</span>\n            <span class="tooltip--map--value">${o.workPackage?this.sanitizedValue(this.workPackageName(o)):this.i18n.t("js.placeholders.default")}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.activity")}:</span>\n            <span class="tooltip--map--value">${this.sanitizedValue(o.activity.name)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.hours")}:</span>\n            <span class="tooltip--map--value">${this.timezone.formattedDuration(o.hours)}</span>\n          </li>\n          <li class="tooltip--map--item">\n            <span class="tooltip--map--key">${this.i18n.t("js.time_entry.comment")}:</span>\n            <span class="tooltip--map--value">${o.comment.raw||this.i18n.t("js.placeholders.default")}</span>\n          </li>\n        `}sanitizedValue(o){return this.sanitizer.sanitize(e.q3G.HTML,o)}formatNumber(o){return this.i18n.toNumber(o,{precision:2})}smallerSuitableRatio(o){for(let s=this.labelIntervalHours+1;s<100;s++){const T=this.labelIntervalHours/s;if(o>=T)return T}return 1}setHiddenDays(o){const s=Array.from(o,(T,j)=>T?null:(j+1)%7).filter(T=>null!==T);this.calendarOptions=Object.assign(Object.assign({},this.calendarOptions),{hiddenDays:s})}}Lt.\u0275fac=function(o){return new(o||Lt)(e.Y36(u.G),e.Y36(O.T),e.Y36(ge.StateService),e.Y36(e.SBq),e.Y36(w.D),e.Y36(e.zs3),e.Y36(Le.W),e.Y36(i.H7),e.Y36(Ie.e),e.Y36(ot.B),e.Y36($e.d),e.Y36(pt.f),e.Y36(Ue.y),e.Y36(mt.c),e.Y36(vt.o))},Lt.\u0275cmp=e.Xpm({type:Lt,selectors:[["te-calendar"]],viewQuery:function(o,s){if(1&o&&e.Gf(Xe.woE,5),2&o){let T;e.iGM(T=e.CRH())&&(s.ucCalendar=T.first)}},inputs:{projectIdentifier:"projectIdentifier",static:"static",displayedDays:"displayedDays"},outputs:{entries:"entries"},features:[e._Bn([st.j,$e.d,pt.f,Re.l])],decls:4,vars:3,consts:[[1,"te-calendar--container","loading-indicator--location",2,"position","relative"],["class","button te-calendar--create-button",3,"click",4,"ngIf"],[3,"options"],["ucCalendar",""],[1,"button","te-calendar--create-button",3,"click"],["icon-classes","button--icon icon-log_time"],["aria-hidden","true",1,"button--text",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.YNc(1,It,3,2,"button",1),e._UZ(2,"full-calendar",2,3),e.qZA()),2&o&&(e.uIk("data-indicator-name","table"),e.xp6(1),e.Q6J("ngIf",s.memoizedCreateAllowed),e.xp6(1),e.Q6J("options",s.calendarOptions))},directives:[I.O5,Xe.woE,ut.o],styles:["te-calendar full-calendar{overflow-x:auto}te-calendar full-calendar .fc-view{min-width:800px}te-calendar full-calendar thead{display:table-footer-group}te-calendar full-calendar th.fc-day,te-calendar full-calendar th.fc-timegrid-axis{border-bottom:none}te-calendar full-calendar table.fc-scrollgrid.fc-scrollgrid-liquid{border-left:none}.-browser-firefox te-calendar full-calendar .fc-col-header-cell-cushion{padding:2px 4px!important}te-calendar full-calendar .fc-event,te-calendar full-calendar .fc-bgevent{border-radius:0;margin-right:8px;margin-left:8px}te-calendar full-calendar .fc-head-container{border-color:#fff}te-calendar full-calendar .fc-day-header{padding-top:5px}te-calendar full-calendar .fc-day{background:white!important}te-calendar full-calendar .fc-widget-content{border-left-color:#fff}te-calendar full-calendar .fc-widget-content .fc-day{border-left:0;border-right:0}te-calendar full-calendar .fc-timeGrid-view .fc-day-grid .fc-row{min-height:1em}te-calendar full-calendar .fc-timeGrid-view .fc-day-grid .fc-row .fc-content-skeleton{padding-bottom:0}te-calendar full-calendar .fc-timegrid-slot.fc-timegrid-slot-minor{border-top:0}te-calendar full-calendar .te-calendar--day-sum{border:none;background-color:initial;color:#000;text-align:center;font-size:.875em;font-weight:bold;line-height:22px;opacity:1;cursor:default}te-calendar full-calendar .te-calendar--add-entry{text-align:center;font-weight:bold;opacity:0;background:none;border:none;display:flex;align-items:center}te-calendar full-calendar .te-calendar--add-entry:hover{opacity:1;transition:opacity 1s ease;background:#EAEAEA}te-calendar full-calendar .te-calendar--add-entry .te-calendar--add-icon{color:#000;width:100%;font-weight:normal;font-size:1.5rem}te-calendar full-calendar .te-calendar--add-entry.-prohibited{cursor:not-allowed}te-calendar full-calendar .te-calendar--add-entry.-prohibited .te-calendar--add-icon{display:none}te-calendar full-calendar .te-calendar--add-entry .fc-event-title-container{margin:0!important}te-calendar full-calendar .te-calendar--time-entry{color:#fff}te-calendar full-calendar .te-calendar--time-entry .fc-content{height:100%}te-calendar full-calendar .te-calendar--time-entry .fc-fadeout{position:relative;bottom:2em;height:2em;z-index:5}te-calendar full-calendar .te-calendar--time-entry.-no-fadeout .fc-fadeout{display:none}te-calendar full-calendar .te-calendar--time-entry .fc-event-title-container{margin:0 4px!important;line-height:14px!important}te-calendar full-calendar .fc-duration{display:inline-block;margin-right:5px;padding-right:5px;font-weight:bold}te-calendar .te-calendar--create-button{position:absolute;right:0;top:6px;margin-right:0}\n"],encapsulation:2,changeDetection:0});class Wt extends P._{constructor(o,s,T,j,q){super(T,o),this.injector=o,this.timezone=s,this.i18n=T,this.pathHelper=j,this.cdr=q,this.entries=[]}ngOnInit(){this.displayedDays=this.resource.options.days}updateEntries(o){this.entries=o.elements,this.cdr.detectChanges()}get total(){const o=this.entries.reduce((s,T)=>s+this.timezone.toHours(T.hours),0);return o>0?this.i18n.t("js.units.hour",{count:this.formatNumber(o)}):this.i18n.t("js.placeholders.default")}get isEditable(){return!1}updateConfiguration(o){this.resourceChanged.emit(this.setChangesetOptions(o)),this.displayedDays=[...o.days]}formatNumber(o){return this.i18n.toNumber(o,{precision:2})}}Wt.\u0275fac=function(o){return new(o||Wt)(e.Y36(e.zs3),e.Y36(ot.B),e.Y36(w.D),e.Y36(Fe.j),e.Y36(e.sBO))},Wt.\u0275cmp=e.Xpm({type:Wt,selectors:[["ng-component"]],features:[e.qOj],decls:8,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource","onConfigured"],[3,"displayedDays","entries"],[1,"total-hours"],[3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e.TgZ(1,"widget-time-entries-current-user-menu",1),e.NdJ("onConfigured",function(j){return s.updateConfiguration(j)}),e.qZA(),e.qZA(),e.TgZ(2,"te-calendar",2),e.NdJ("entries",function(j){return s.updateEntries(j)}),e.qZA(),e.ynx(3),e.TgZ(4,"div",3),e.TgZ(5,"p"),e._uU(6,"Total: "),e._UZ(7,"span",4),e.qZA(),e.qZA(),e.BQk()),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(1),e.Q6J("displayedDays",s.displayedDays),e.xp6(5),e.Q6J("textContent",s.total))},directives:[G,$,Lt],encapsulation:2,changeDetection:0});class Rt{constructor(o){this.Hook=o}get registered(){let o=[];return _.each(this.Hook.call("gridWidgets"),s=>{o=o.concat(s)}),o}}Rt.\u0275fac=function(o){return new(o||Rt)(e.LFG(C.$))},Rt.\u0275prov=e.Yz7({token:Rt,factory:Rt.\u0275fac});var xt=t(91923),Mt=t(55216);function wt(f,o){if(1&f&&e._UZ(0,"no-results",5),2&f){const s=e.oxw();e.Q6J("title",s.text.noResults)}}function Jt(f,o){if(1&f&&(e.ynx(0),e.TgZ(1,"h4",6),e._UZ(2,"a",7),e.qZA(),e.TgZ(3,"p",8),e._UZ(4,"em",9),e.qZA(),e._UZ(5,"div",10),e.BQk()),2&f){const s=o.$implicit,T=e.oxw();e.xp6(2),e.Q6J("href",T.documentPath(s),e.LSH)("textContent",s.title),e.xp6(2),e.Q6J("textContent",T.documentCreated(s)),e.xp6(1),e.Q6J("innerHtml",T.documentDescription(s),e.oJD)}}class Ze extends P._{constructor(o,s,T,j,q,fe,Be,Ye,at){super(j,Be),this.halResource=o,this.pathHelper=s,this.apiV3Service=T,this.i18n=j,this.timezone=q,this.domSanitizer=fe,this.injector=Be,this.currentProject=Ye,this.cdr=at,this.text={noResults:this.i18n.t("js.grid.widgets.documents.no_results")},this.entries=[],this.entriesLoaded=!1}ngOnInit(){this.halResource.get(this.documentsUrl).toPromise().then(o=>{this.entries=o.elements,this.entriesLoaded=!0,this.cdr.detectChanges()})}get isEditable(){return!1}documentPath(o){return`${this.pathHelper.appBasePath}/documents/${o.id}`}documentCreated(o){return this.timezone.formattedDatetime(o.createdAt)}documentDescription(o){return this.domSanitizer.sanitize(e.q3G.HTML,o.description.html)}get noEntries(){return!this.entries.length&&this.entriesLoaded}get documentsUrl(){const o=JSON.stringify([["updated_at","desc"]]);let s=`${this.apiV3Service.documents.toPath()}?sortBy=${o}&pageSize=10`;return this.currentProject.id&&(s+=`&filters=${JSON.stringify([{project_id:{operator:"=",values:[this.currentProject.id.toString()]}}])}`),s}}Ze.\u0275fac=function(o){return new(o||Ze)(e.Y36(xt.u),e.Y36(Fe.j),e.Y36(O.T),e.Y36(w.D),e.Y36(ot.B),e.Y36(i.H7),e.Y36(e.zs3),e.Y36(x.R),e.Y36(e.sBO))},Ze.\u0275cmp=e.Xpm({type:Ze,selectors:[["ng-component"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title"],[1,"document-category-elements--header"],[3,"href","textContent"],[1,"document-category-elements--date"],[3,"textContent"],[1,"wiki","grid--widget-limited-text","op-uc-container",3,"innerHtml"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e._UZ(1,"widget-menu",1),e.qZA(),e.TgZ(2,"div",2),e.YNc(3,wt,1,1,"no-results",3),e.YNc(4,Jt,6,4,"ng-container",4),e.qZA()),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(2),e.Q6J("ngIf",s.noEntries),e.xp6(1),e.Q6J("ngForOf",s.entries))},directives:[G,ye,I.O5,I.sg,Mt.S],encapsulation:2,changeDetection:0});var ve=t(3742);function ne(f,o){if(1&f&&e._UZ(0,"no-results",6),2&f){const s=e.oxw();e.Q6J("title",s.text.noResults)}}function K(f,o){if(1&f&&e._UZ(0,"op-principal",13),2&f){const s=e.oxw().$implicit;e.Q6J("principal",s.author)("hideName",!0)}}function de(f,o){if(1&f&&e._UZ(0,"div",14),2&f){const s=e.oxw().$implicit,T=e.oxw();e.Q6J("innerHTML",T.text.addedBy(s),e.oJD)}}function He(f,o){if(1&f&&e._UZ(0,"p",15),2&f){const s=e.oxw().$implicit;e.Q6J("textContent",s.summary)}}function ht(f,o){if(1&f&&(e.TgZ(0,"li",7),e.YNc(1,K,1,2,"op-principal",8),e.TgZ(2,"div",9),e._UZ(3,"a",10),e._uU(4,": "),e._UZ(5,"a",10),e.qZA(),e.YNc(6,de,1,1,"div",11),e.YNc(7,He,1,1,"p",12),e.qZA()),2&f){const s=o.$implicit,T=e.oxw();e.xp6(1),e.Q6J("ngIf",s.author),e.xp6(2),e.Q6J("href",T.newsProjectPath(s),e.LSH)("textContent",T.newsProjectName(s)),e.xp6(2),e.Q6J("href",T.newsPath(s),e.LSH)("textContent",s.title),e.xp6(1),e.Q6J("ngIf",s.author),e.xp6(1),e.Q6J("ngIf",s.summary)}}class yt extends P._{constructor(o,s,T,j,q,fe,Be){super(s,T),this.pathHelper=o,this.i18n=s,this.injector=T,this.timezone=j,this.currentProject=q,this.apiV3Service=fe,this.cdr=Be,this.text={at:this.i18n.t("js.grid.widgets.news.at"),noResults:this.i18n.t("js.grid.widgets.news.no_results"),addedBy:Ye=>this.i18n.t("js.label_added_time_by",{author:this.newsAuthorName(Ye),age:this.newsCreated(Ye),authorLink:this.newsAuthorPath(Ye)})},this.entries=[],this.entriesLoaded=!1}ngOnInit(){this.apiV3Service.news.list(this.newsDmParams).subscribe(o=>this.setupNews(o.elements))}setupNews(o){this.entries=o,this.entriesLoaded=!0,this.cdr.detectChanges()}get isEditable(){return!1}newsPath(o){return this.pathHelper.newsPath(o.id)}newsProjectPath(o){var s;return this.pathHelper.projectPath((0,Ee.Z)(null===(s=o.project)||void 0===s?void 0:s.href))}newsProjectName(o){var s;return null===(s=o.project)||void 0===s?void 0:s.name}newsAuthorName(o){var s;return null===(s=o.author)||void 0===s?void 0:s.name}newsAuthorPath(o){var s;return this.pathHelper.userPath(null===(s=o.author)||void 0===s?void 0:s.id)}newsCreated(o){return this.timezone.formattedDatetime(o.createdAt)}get noEntries(){return!this.entries.length&&this.entriesLoaded}get newsDmParams(){const o={sortBy:[["created_at","desc"]],pageSize:3};return this.currentProject.id&&(o.filters=[["project_id","=",[this.currentProject.id]]]),o}}yt.\u0275fac=function(o){return new(o||yt)(e.Y36(Fe.j),e.Y36(w.D),e.Y36(e.zs3),e.Y36(ot.B),e.Y36(x.R),e.Y36(O.T),e.Y36(e.sBO))},yt.\u0275cmp=e.Xpm({type:yt,selectors:[["ng-component"]],features:[e.qOj],decls:6,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[1,"widget-box--arrow-links"],["class","widget-box--arrow-multiline",4,"ngFor","ngForOf"],[3,"title"],[1,"widget-box--arrow-multiline"],["class","widget-box--avatar news-author-avatar hidden-for-mobile",3,"principal","hideName",4,"ngIf"],[1,"widget-box--project"],[3,"href","textContent"],["class","widget-box--author news-author",3,"innerHTML",4,"ngIf"],["class","widget-box--additional-info",3,"textContent",4,"ngIf"],[1,"widget-box--avatar","news-author-avatar","hidden-for-mobile",3,"principal","hideName"],[1,"widget-box--author","news-author",3,"innerHTML"],[1,"widget-box--additional-info",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e._UZ(1,"widget-menu",1),e.qZA(),e.TgZ(2,"div",2),e.YNc(3,ne,1,1,"no-results",3),e.TgZ(4,"ul",4),e.YNc(5,ht,8,7,"li",5),e.qZA(),e.qZA()),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(2),e.Q6J("ngIf",s.noEntries),e.xp6(2),e.Q6J("ngForOf",s.entries))},directives:[G,ye,I.O5,I.sg,Mt.S,ve.N],encapsulation:2,changeDetection:0});var St=t(79902);class Et{constructor(o,s){this.apiV3Service=o,this.halResourceService=s}initialize(o){return this.apiV3Service.grids.list({filters:[["scope","=",[o]]]}).toPromise().then(s=>0===s.total?this.myPageForm(o):s.elements[0])}myPageForm(o){const s={_links:{scope:{href:o}}};return this.apiV3Service.grids.form.post(s).pipe((0,St.w)(T=>{const j=T.payload.$source,q=this.halResourceService.createHalResource(j);return 0===q.widgets.length&&(q.rowCount=1,q.columnCount=1),this.apiV3Service.grids.post(q,T.schema)})).toPromise()}}Et.\u0275fac=function(o){return new(o||Et)(e.LFG(O.T),e.LFG(xt.u))},Et.\u0275prov=e.Yz7({token:Et,factory:Et.\u0275fac});const je=["tabInner"];class le{onSave(){this.tabInner.onSave()}}le.\u0275fac=function(o){return new(o||le)},le.\u0275cmp=e.Xpm({type:le,selectors:[["ng-component"]],viewQuery:function(o,s){if(1&o&&e.Gf(je,7),2&o){let T;e.iGM(T=e.CRH())&&(s.tabInner=T.first)}},decls:3,vars:0,consts:[["wp-isolated-query-space",""],["tabInner",""]],template:function(o,s){1&o&&(e.ynx(0,0),e._UZ(1,"op-settings-tab-inner",null,1),e.BQk())},encapsulation:2});const B=["tabInner"];class pe{onSave(){this.tabInner.onSave()}}pe.\u0275fac=function(o){return new(o||pe)},pe.\u0275cmp=e.Xpm({type:pe,selectors:[["ng-component"]],viewQuery:function(o,s){if(1&o&&e.Gf(B,7),2&o){let T;e.iGM(T=e.CRH())&&(s.tabInner=T.first)}},decls:3,vars:0,consts:[["wp-isolated-query-space",""],["tabInner",""]],template:function(o,s){1&o&&(e.ynx(0,0),e._UZ(1,"op-filters-tab-inner",null,1),e.BQk())},encapsulation:2});class De{constructor(o,s,T){this.queryParams=o,this.chartOptions=s,this.chartType=T,this.queries=[],this.chartType=this.chartType||"horizontalBar"}static queryCreationParams(o,s){return{public:s,name:o.t("js.grid.widgets.work_packages_graph.title"),showHierarchies:!1,_links:{groupBy:{href:"/api/v3/queries/group_bys/status"}}}}}class qe{constructor(o,s,T,j){this.I18n=o,this.apiv3Service=s,this.notificationService=T,this.currentProject=j,this._forms={}}persistAndReload(){return this.persistChanges().then(()=>this.reloadQueries())}persistChanges(){const o=this.queries.map(s=>this.saveQuery(s));return Promise.all(o)}get datasets(){return this.queries.map(o=>({groups:o.results.groups,queryProps:"",label:o.name}))}reloadQueries(){return this.configuration.queries.length=0,this.loadQueries()}ensureQueryAndLoad(){return 0===this.queryParams.length?this.createInitial().then(o=>(this.queryParams.push({id:o.id}),this.loadQueries())):this.loadQueries()}createInitial(){return this.apiv3Service.queries.form.loadWithParams({pageSize:0},void 0,this.currentProject.identifier,De.queryCreationParams(this.I18n,!!this.currentProject.identifier)).toPromise().then(([o,s])=>this.apiv3Service.queries.post(s,o).toPromise())}loadQueries(){const o=this.queryParams.map(s=>this.loadQuery(s));return Promise.all(o)}loadQuery(o){return this.apiv3Service.queries.find(Object.assign({pageSize:0},o.props),o.id,this.currentProject.identifier).toPromise().then(s=>{o.name&&(s.name=o.name),this.configuration.queries.push(s)})}saveQuery(o){return(0,se.mG)(this,void 0,void 0,function*(){return this.formFor(o).then(s=>this.apiv3Service.queries.id(o).patch(o,s).toPromise())})}get configuration(){return this._configuration}set configuration(o){this._configuration=o,this._formsPromise=null}formFor(o){return(0,se.mG)(this,void 0,void 0,function*(){return this.loadForms().then(()=>this._forms[o.id])})}get tabs(){const o=[{id:"graph-settings",name:this.I18n.t("js.chart.tabs.graph_settings"),componentClass:le}],s=this.configuration.queries.map(T=>({id:T.id,name:this.I18n.t("js.work_packages.query.filters"),componentClass:pe}));return o.concat(s)}loadForms(){if(!this._formsPromise){const o=this.configuration.queries.map(s=>this.apiv3Service.queries.form.load(s).toPromise().then(([T])=>{this._forms[s.id]=T}).catch(T=>this.notificationService.handleRawError(T)));this._formsPromise=Promise.all(o)}return this._formsPromise}get chartType(){return this._configuration.chartType}set chartType(o){this._configuration.chartType=o}get queries(){return this._configuration.queries}get chartOptions(){return this._configuration.chartOptions}get queryParams(){return this._configuration.queryParams}}qe.\u0275fac=function(o){return new(o||qe)(e.LFG(w.D),e.LFG(O.T),e.LFG(ie.q),e.LFG(x.R))},qe.\u0275prov=e.Yz7({token:qe,factory:qe.\u0275fac});var ct=t(61736),Tt=t(90590);const Pt=["tabContentOutlet"];function nt(f,o){1&f&&e.GkF(0)}function Se(f,o){if(1&f&&(e.ynx(0),e.YNc(1,nt,1,0,"ng-container",10),e.BQk()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("ngComponentOutlet",s.prependModalComponent)("ngComponentOutletInjector",s.injector)}}function Pe(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"op-scrollable-tabs",11),e.NdJ("tabSelected",function(j){return e.CHM(s),e.oxw().switchTo(j)}),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("tabs",s.availableTabs)("currentTabId",null==s.tabPortalHost.currentTab?null:s.tabPortalHost.currentTab.id)}}const We=new e.OlP("WpTableConfigurationModalPrependComponent");class et extends Ve.T{constructor(o,s,T,j,q,fe,Be,Ye,at,At,Ot,zt){super(o,at,Ot),this.locals=o,this.prependModalComponent=s,this.I18n=T,this.injector=j,this.appRef=q,this.componentFactoryResolver=fe,this.loadingIndicator=Be,this.notificationService=Ye,this.cdRef=at,this.configurationService=At,this.elementRef=Ot,this.graphConfiguration=zt,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={title:this.I18n.t("js.chart.modal_title"),closePopup:this.I18n.t("js.close_popup_title"),applyButton:this.I18n.t("js.modals.button_apply"),cancelButton:this.I18n.t("js.modals.button_cancel")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.loadingIndicator.indicator("modal").promise=this.graphConfiguration.loadForms().then(()=>{this.tabPortalHost=new ct.M(this.graphConfiguration.tabs,this.tabContentOutlet.nativeElement,this.componentFactoryResolver,this.appRef,this.injector);const o=this.locals.initialTab,s=this.availableTabs.find(T=>T.id===o);this.cdRef.markForCheck(),this.switchTo(s||this.availableTabs[0])})}ngOnDestroy(){this.tabPortalHost.dispose()}get availableTabs(){return this.tabPortalHost.availableTabs}get currentTab(){return this.tabPortalHost.currentTab}switchTo(o){this.tabPortalHost.switchTo(o)}saveChanges(){this.tabPortalHost.activeComponents.forEach(o=>{o.onSave()}),this.configuration=this.graphConfiguration.configuration,this.service.close()}onClose(){return this.afterFocusOn.focus(),!0}get afterFocusOn(){return this.$element}}et.\u0275fac=function(o){return new(o||et)(e.Y36(it.E),e.Y36(We,8),e.Y36(w.D),e.Y36(e.zs3),e.Y36(e.z2F),e.Y36(e._Vd),e.Y36(ue.vt),e.Y36(ie.q),e.Y36(e.sBO),e.Y36(Ie.e),e.Y36(e.SBq),e.Y36(qe))},et.\u0275cmp=e.Xpm({type:et,selectors:[["ng-component"]],viewQuery:function(o,s){if(1&o&&e.Gf(Pt,7),2&o){let T;e.iGM(T=e.CRH())&&(s.tabContentOutlet=T.first)}},features:[e.qOj],decls:11,vars:5,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_wide","wp-table--configuration-modal","loading-indicator--location"],[3,"close"],[1,"op-modal--body"],[4,"ngIf"],[3,"tabs","currentTabId","tabSelected",4,"ngIf"],[1,"tab-content"],["tabContentOutlet",""],[1,"op-modal--footer"],[1,"button","-highlight",3,"textContent","click"],[1,"button",3,"textContent","click"],[4,"ngComponentOutlet","ngComponentOutletInjector"],[3,"tabs","currentTabId","tabSelected"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"op-modal-header",1),e.NdJ("close",function(j){return s.closeMe(j)}),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,Se,2,2,"ng-container",3),e.YNc(5,Pe,1,2,"op-scrollable-tabs",4),e._UZ(6,"div",5,6),e.qZA(),e.TgZ(8,"div",7),e.TgZ(9,"button",8),e.NdJ("click",function(){return s.saveChanges()}),e.qZA(),e.TgZ(10,"button",9),e.NdJ("click",function(j){return s.closeMe(j)}),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.Oqu(s.text.title),e.xp6(2),e.Q6J("ngIf",!!s.prependModalComponent),e.xp6(1),e.Q6J("ngIf",s.tabPortalHost),e.xp6(4),e.Q6J("textContent",s.text.applyButton),e.xp6(1),e.Q6J("textContent",s.text.cancelButton))},directives:[L.g,I.O5,I.$G,g.dw,Tt.P],encapsulation:2,changeDetection:0});class lt extends he{constructor(o,s,T,j,q){super(T,j,q),this.injector=o,this.opModalService=s,this.i18n=T,this.remove=j,this.layout=q,this.onConfigured=new e.vpe,this.menuItemList=[this.removeItem,this.configureItem]}get configureItem(){return{linkText:this.i18n.t("js.toolbar.settings.configure_view"),onClick:()=>(this.opModalService.show(this.configurationComponent,this.injector,this.locals).closingEvent.subscribe(o=>{this.onConfigured.emit(o.configuration)}),!0)}}get locals(){return{}}}function ft(f,o){if(1&f&&e._UZ(0,"icon-triggered-context-menu",1),2&f){const s=e.oxw();e.Q6J("menu-items",s.menuItems)}}lt.\u0275fac=function(o){return new(o||lt)(e.Y36(e.zs3),e.Y36(it.S),e.Y36(w.D),e.Y36(_e),e.Y36(F))},lt.\u0275dir=e.lG2({type:lt,outputs:{onConfigured:"onConfigured"},features:[e.qOj]});class kt extends lt{constructor(){super(...arguments),this.configurationComponent=et}}kt.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(kt)))(s||kt)}}(),kt.\u0275cmp=e.Xpm({type:kt,selectors:[["widget-wp-graph-menu"]],features:[e.qOj],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(o,s){1&o&&e.YNc(0,ft,1,1,"icon-triggered-context-menu",0),2&o&&e.Q6J("ngIf",s.hasMenu)},directives:[I.O5,ae.I],encapsulation:2});var Ft=t(23141);function qt(f,o){if(1&f&&e._UZ(0,"canvas",4),2&f){const s=e.oxw();e.Q6J("datasets",s.chartData)("labels",s.chartLabels)("chartType",s.chartType)("options",s.internalChartOptions)}}function Xt(f,o){if(1&f&&e._UZ(0,"no-results",5),2&f){const s=e.oxw();e.Q6J("title",s.text.noResults)}}const Ht=function(f){return{height:f}};class ei{constructor(o){this.i18n=o,this.chartType="horizontalBar",this.error=null,this.chartHeight="100%",this.chartLabels=[],this.chartData=[],this.initialized=!1,this.text={noResults:this.i18n.t("js.work_packages.no_results.title")}}ngOnChanges(o){o.datasets?(this.setChartOptions(),this.updateChartData(),o.datasets.firstChange||(this.initialized=!0)):o.chartType&&this.setChartOptions()}updateChartData(){let o=_.uniq(this.datasets.reduce((T,j)=>{const q=(j.groups||[]).map(fe=>fe.value);return T.concat(q)},[]));const s=this.datasets.map(T=>{const j=(T.groups||[]).reduce((q,fe)=>Object.assign(Object.assign({},q),{[fe.value]:fe.count}),{});return{label:T.label,data:o.map(q=>j[q]||0)}});o=o.map(T=>T||this.i18n.t("js.placeholders.default")),this.setHeight(),this.chartLabels.length=0,this.chartLabels.push(...o),this.chartData.length=0,this.chartData.push(...s)}setChartOptions(){const o={responsive:!0,maintainAspectRatio:!1,legend:{display:this.datasets.length>1},plugins:{datalabels:{align:"bar"===this.chartType?"top":"center"}}},s=(()=>"horizontalBar"===this.chartType||"bar"===this.chartType?this.setChartAxesValues():{scales:{}})();this.internalChartOptions=Object.assign(Object.assign(Object.assign({},o),s),this.chartOptions)}get hasDataToDisplay(){return this.chartData.length>0&&this.chartData.some(o=>o.data.length>0)}setHeight(){if("horizontalBar"===this.chartType&&this.datasets&&this.datasets[0]){const o=[];this.datasets.forEach(T=>T.groups.forEach(j=>{o.includes(j.value)||o.push(j.value)}));let s=40*o.length;this.datasets.length>1&&(s+=40),s+=40,this.chartHeight=`${s}px`}else this.chartHeight="100%"}setChartAxesValues(){const o={scales:{}},s=[{stacked:!0,ticks:{callback:j=>Math.floor(j)===j?j:null}}],T=[{stacked:!0}];return o.scales&&("bar"===this.chartType?(o.scales.yAxes=s,o.scales.xAxes=T):"horizontalBar"===this.chartType&&(o.scales.xAxes=s,o.scales.yAxes=T)),o}}ei.\u0275fac=function(o){return new(o||ei)(e.Y36(w.D))},ei.\u0275cmp=e.Xpm({type:ei,selectors:[["op-wp-embedded-graph"]],inputs:{datasets:"datasets",chartOptions:"chartOptions",chartType:"chartType"},features:[e.TTD],decls:4,vars:5,consts:[[1,"op-wp-embeded-graph","work-packages-embedded-view--container","loading-indicator--location",3,"ngStyle"],["graphContainer",""],["baseChart","",3,"datasets","labels","chartType","options",4,"ngIf"],[3,"title",4,"ngIf"],["baseChart","",3,"datasets","labels","chartType","options"],[3,"title"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0,1),e.YNc(2,qt,1,4,"canvas",2),e.YNc(3,Xt,1,1,"no-results",3),e.qZA()),2&o&&(e.Q6J("ngStyle",e.VKq(3,Ht,s.chartHeight)),e.xp6(2),e.Q6J("ngIf",s.hasDataToDisplay),e.xp6(1),e.Q6J("ngIf",!s.hasDataToDisplay&&s.initialized))},directives:[I.PC,I.O5,Ft.jh,Mt.S],styles:[".op-wp-embeded-graph.work-packages-embedded-view--container[_ngcontent-%COMP%]{height:100%;max-height:500px;position:relative}"]});class ni extends P._{constructor(o,s,T,j){super(o,s),this.i18n=o,this.injector=s,this.cdr=T,this.graphConfiguration=j,this.datasets=[]}ngOnInit(){this.initializeConfiguration(),this.loadQueriesInitially()}set chartType(o){this.resource.options.chartType=o}updateGraph(o){this.graphConfiguration.persistAndReload().then(()=>{if(this.repaint(),this.resource.options.chartType!==this.graphConfiguration.chartType){const s=this.setChangesetOptions({chartType:this.graphConfiguration.chartType});this.resourceChanged.emit(s)}})}repaint(){this.datasets=this.graphConfiguration.datasets,this.cdr.detectChanges()}initializeConfiguration(){const o=[];this.resource.options.queryId&&o.push({id:this.resource.options.queryId}),this.graphConfiguration.configuration=new De(o,this.resource.options.chartOptions,this.resource.options.chartType)}loadQueriesInitially(){this.graphConfiguration.ensureQueryAndLoad().then(()=>{if(!this.resource.options.queryId){const o=this.setChangesetOptions({queryId:this.graphConfiguration.queryParams[0].id});this.resourceChanged.emit(o)}this.repaint()})}get chartOptions(){return this.graphConfiguration.chartOptions}get chartType(){return this.graphConfiguration.chartType}}ni.\u0275fac=function(o){return new(o||ni)(e.Y36(w.D),e.Y36(e.zs3),e.Y36(e.sBO),e.Y36(qe))},ni.\u0275cmp=e.Xpm({type:ni,selectors:[["widget-wp-graph"]],features:[e._Bn([qe]),e.qOj],decls:3,vars:4,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource","onConfigured"],[1,"grid--widget-content","-no-overflow",3,"datasets","chartType"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e.NdJ("onRenamed",function(j){return s.renameWidget(j)}),e.TgZ(1,"widget-wp-graph-menu",1),e.NdJ("onConfigured",function(j){return s.updateGraph(j)}),e.qZA(),e.qZA(),e._UZ(2,"op-wp-embedded-graph",2)),2&o&&(e.Q6J("name",s.widgetName),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(1),e.Q6J("datasets",s.datasets)("chartType",s.chartType))},directives:[G,kt,ei],styles:["wp-embedded-table[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0});var oi=t(55977),di=t(43440),Ri=t(84515),gi=t(57119);function rn(f,o){if(1&f&&e._UZ(0,"icon-triggered-context-menu",1),2&f){const s=e.oxw();e.Q6J("menu-items",s.menuItems)}}class fi extends lt{constructor(){super(...arguments),this.configurationComponent=gi.Q}}fi.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(fi)))(s||fi)}}(),fi.\u0275cmp=e.Xpm({type:fi,selectors:[["widget-wp-table-menu"]],features:[e.qOj],decls:1,vars:1,consts:[[3,"menu-items",4,"ngIf"],[3,"menu-items"]],template:function(o,s){1&o&&e.YNc(0,rn,1,1,"icon-triggered-context-menu",0),2&o&&e.Q6J("ngIf",s.hasMenu)},directives:[I.O5,ae.I],encapsulation:2});var pi=t(166);function Zi(f,o){if(1&f&&e._UZ(0,"wp-embedded-table",3),2&f){const s=e.oxw();e.Q6J("queryId",s.queryId)("configuration",s.configuration)}}class vi extends P._{constructor(o,s,T,j,q,fe){super(o,s),this.i18n=o,this.injector=s,this.urlParamsHelper=T,this.state=j,this.querySpace=q,this.apiV3Service=fe,this.inFlight=!1,this.configuration={actionsColumnEnabled:!1,columnMenuEnabled:!1,hierarchyToggleEnabled:!0,contextMenuEnabled:!1}}ngOnInit(){this.resource.options.queryId?this.queryId=this.resource.options.queryId:this.createInitial().then(o=>{const s=this.setChangesetOptions({queryId:o.id});this.resourceChanged.emit(s),this.queryId=o.id}),this.query$=this.querySpace.query.values$(),this.query$.pipe((0,Ri.T)(2),this.untilDestroyed()).subscribe(o=>{this.ensureFormAndSaveQuery(o)})}get widgetName(){return this.resource.options.name}static get identifier(){return"work_packages_table"}ensureFormAndSaveQuery(o){this.queryForm?this.saveQuery(o,this.queryForm):this.apiV3Service.queries.form.load(o).subscribe(([s,T])=>{this.queryForm=s,this.saveQuery(o,s)})}saveQuery(o,s){this.inFlight=!0,this.apiV3Service.queries.id(o).patch(o,this.queryForm).subscribe(()=>this.inFlight=!1,()=>this.inFlight=!1)}createInitial(){const o=this.state.params.projectPath,s=this.resource.options.queryProps,T=Object.assign({pageSize:0},s);return this.apiV3Service.queries.form.loadWithParams(T,void 0,o,this.queryCreationParams()).toPromise().then(([j,q])=>this.apiV3Service.queries.post(q,j).toPromise().then(fe=>(delete this.resource.options.queryProps,fe)))}queryCreationParams(){return{hidden:!0,public:!!this.state.params.projectPath}}}vi.\u0275fac=function(o){return new(o||vi)(e.Y36(w.D),e.Y36(e.zs3),e.Y36(oi.Z),e.Y36(ge.StateService),e.Y36(di.q),e.Y36(O.T))},vi.\u0275cmp=e.Xpm({type:vi,selectors:[["widget-wp-table"]],features:[e.qOj],decls:3,vars:3,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource"],[3,"queryId","configuration",4,"ngIf"],[3,"queryId","configuration"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e.NdJ("onRenamed",function(j){return s.renameWidget(j)}),e._UZ(1,"widget-wp-table-menu",1),e.qZA(),e.YNc(2,Zi,1,2,"wp-embedded-table",2)),2&o&&(e.Q6J("name",s.widgetName),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(1),e.Q6J("ngIf",s.queryId))},directives:[G,fi,I.O5,pi.Z],styles:["wp-embedded-table[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0});class Yt extends P._{onResourceChanged(o){this.resourceChanged.emit(o)}}Yt.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(Yt)))(s||Yt)}}(),Yt.\u0275cmp=e.Xpm({type:Yt,selectors:[["ng-component"]],features:[e.qOj],decls:2,vars:1,consts:[["wp-isolated-query-space","",1,"op-wp-table-qs"],[3,"resource","resourceChanged"]],template:function(o,s){1&o&&(e.ynx(0,0),e.TgZ(1,"widget-wp-table",1),e.NdJ("resourceChanged",function(j){return s.onResourceChanged(j)}),e.qZA(),e.BQk()),2&o&&(e.xp6(1),e.Q6J("resource",s.resource))},directives:[Ce.A,vi],styles:[".op-wp-table-qs[_ngcontent-%COMP%]   widget-wp-table[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}"]});var ui=t(74647),Hi=t(74478);class Ki{constructor(o,s,T){this.I18n=o,this.wpStatesInitialization=s,this.wpGraphConfiguration=T}initializeQuerySpace(){return this.wpGraphConfiguration.formFor(this.query).then(o=>{this.wpStatesInitialization.initialize(this.query,this.query.results),this.wpStatesInitialization.updateStatesFromForm(this.query,o)})}}var Ui=t(78434),an=t(51522);function cn(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"query-filters",1),e.NdJ("filtersChanged",function(j){e.CHM(s);return e.oxw().filters=j}),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("filters",s.filters)}}class si extends Ki{constructor(o,s,T,j,q){super(o,j,q),this.I18n=o,this.wpTableFilters=s,this.wpFiltersService=T,this.wpStatesInitialization=j,this.wpGraphConfiguration=q,this.filters=[],this.text={multiSelectLabel:this.I18n.t("js.work_packages.label_column_multiselect")}}ngOnInit(){this.initializeQuerySpace().then(()=>{this.wpTableFilters.onReady().then(()=>{this.filters=this.wpTableFilters.current})})}onSave(){this.filters&&(this.wpTableFilters.replaceIfComplete(this.filters),this.wpTableFilters.applyToQuery(this.wpGraphConfiguration.queries[0]))}get query(){return this.wpGraphConfiguration.queries[0]}}si.\u0275fac=function(o){return new(o||si)(e.Y36(w.D),e.Y36(ui.Z),e.Y36(Ui.U),e.Y36(Hi.f),e.Y36(qe))},si.\u0275cmp=e.Xpm({type:si,selectors:[["op-filters-tab-inner"]],features:[e.qOj],decls:1,vars:1,consts:[[3,"filters","filtersChanged",4,"ngIf"],[3,"filters","filtersChanged"]],template:function(o,s){1&o&&e.YNc(0,cn,1,1,"query-filters",0),2&o&&e.Q6J("ngIf",!!s.filters)},directives:[I.O5,an.H],encapsulation:2});var ki=t(61083);function xi(f,o){if(1&f&&e._UZ(0,"option",9),2&f){const s=o.$implicit;e.Q6J("ngValue",s)("textContent",s.name)}}function ln(f,o){if(1&f&&e._UZ(0,"option",9),2&f){const s=o.$implicit;e.Q6J("ngValue",s)("textContent",s.label)}}const Ci=function(){return{standalone:!0}};class Mi extends Ki{constructor(o,s,T,j){super(o,T,j),this.I18n=o,this.wpTableGroupBy=s,this.wpStatesInitialization=T,this.wpGraphConfiguration=j,this.availableGroups=[],this.text={group_by:this.I18n.t("js.chart.axis_criteria"),chart_type:this.I18n.t("js.chart.type")}}onSave(){this.wpGraphConfiguration.chartType=this.currentChartType.identifier,this.wpGraphConfiguration.queries.forEach(o=>{this.wpTableGroupBy.applyToQuery(o)})}get currentGroup(){return this.wpTableGroupBy.current}set currentGroup(o){this.wpTableGroupBy.update(o)}ngOnInit(){this.initializeQuerySpace().then(()=>{this.wpTableGroupBy.onReady().then(()=>{this.initializeAvailableGroups(),this.initializeAvailableChartType()})})}initializeAvailableGroups(){let{available:o}=this.wpTableGroupBy;const{current:s}=this.wpTableGroupBy;s&&(o=o.filter(T=>T.id!==s.id),o=o.concat(s)),this.availableGroups=_.sortBy(o,"name")}initializeAvailableChartType(){this.availableChartTypes=_.sortBy([{identifier:"horizontalBar",label:this.I18n.t("js.chart.types.horizontal_bar")},{identifier:"bar",label:this.I18n.t("js.chart.types.bar")},{identifier:"line",label:this.I18n.t("js.chart.types.line")},{identifier:"pie",label:this.I18n.t("js.chart.types.pie")},{identifier:"doughnut",label:this.I18n.t("js.chart.types.doughnut")},{identifier:"radar",label:this.I18n.t("js.chart.types.radar")},{identifier:"polarArea",label:this.I18n.t("js.chart.types.polar_area")}],"label"),this.currentChartType=this.availableChartTypes.find(o=>o.identifier===this.wpGraphConfiguration.configuration.chartType)||this.availableChartTypes[0]}get query(){return this.wpGraphConfiguration.queries[0]}}Mi.\u0275fac=function(o){return new(o||Mi)(e.Y36(w.D),e.Y36(ki.w),e.Y36(Hi.f),e.Y36(qe))},Mi.\u0275cmp=e.Xpm({type:Mi,selectors:[["op-settings-tab-inner"]],features:[e.qOj],decls:14,vars:10,consts:[[1,"form"],[1,"form--field"],["for","selected_grouping",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--select-container","-middle"],["id","selected_grouping",1,"form--select",3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngValue","textContent",4,"ngFor","ngForOf"],["for","selected_chart_type",1,"form--label",3,"textContent"],["id","selected_chart_type",3,"ngModel","ngModelOptions","ngModelChange"],[3,"ngValue","textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div"),e.TgZ(1,"form",0),e.TgZ(2,"div",1),e._UZ(3,"label",2),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.TgZ(6,"select",5),e.NdJ("ngModelChange",function(j){return s.currentGroup=j}),e.YNc(7,xi,1,2,"option",6),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(8,"div",1),e._UZ(9,"label",7),e.TgZ(10,"div",3),e.TgZ(11,"div",4),e.TgZ(12,"select",8),e.NdJ("ngModelChange",function(j){return s.currentChartType=j}),e.YNc(13,ln,1,2,"option",6),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("textContent",s.text.group_by),e.xp6(3),e.Q6J("ngModel",s.currentGroup)("ngModelOptions",e.DdM(8,Ci)),e.xp6(1),e.Q6J("ngForOf",s.availableGroups),e.xp6(2),e.Q6J("textContent",s.text.chart_type),e.xp6(3),e.Q6J("ngModel",s.currentChartType)("ngModelOptions",e.DdM(9,Ci)),e.xp6(1),e.Q6J("ngForOf",s.availableChartTypes))},directives:[c._Y,c.JL,c.F,c.EJ,c.JJ,c.On,I.sg,c.YN,c.Kr],encapsulation:2});t(52386);var _i=t(5282);class yi{constructor(){}}yi.\u0275fac=function(o){return new(o||yi)},yi.\u0275mod=e.oAB({type:yi}),yi.\u0275inj=e.cJS({imports:[[n.H,y.K,p.H,Ft.m9,_i.l]]}),e.B6R(pe,[Ce.A,si],[]),e.B6R(le,[Ce.A,Mi],[]);var Ei=t(83845),ai=t(61342),Te=t(54262);function Q(f,o){if(1&f&&(e.TgZ(0,"edit-form",5),e._UZ(1,"editable-attribute-field",6),e.qZA()),2&f){const s=o.ngIf;e.Q6J("resource",s),e.xp6(1),e.Q6J("resource",s)}}class U extends P._{constructor(o,s,T,j,q){super(o,s),this.i18n=o,this.injector=s,this.apiV3Service=T,this.currentProject=j,this.cdRef=q}ngOnInit(){this.currentProject.id&&(this.project$=this.apiV3Service.projects.id(this.currentProject.id).get(),this.cdRef.detectChanges())}get isEditable(){return!1}}U.\u0275fac=function(o){return new(o||U)(e.Y36(w.D),e.Y36(e.zs3),e.Y36(O.T),e.Y36(x.R),e.Y36(e.sBO))},U.\u0275cmp=e.Xpm({type:U,selectors:[["ng-component"]],features:[e._Bn([Re.l]),e.qOj],decls:6,vars:7,consts:[[3,"name","editable"],["slot","prepend","attribute","description",3,"attributeScope"],["slot","menu",3,"resource"],[1,"grid--widget-content","-allow-inner-overflow"],[3,"resource",4,"ngIf"],[3,"resource"],["fieldName","description",3,"resource"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e._UZ(1,"attribute-help-text",1),e._UZ(2,"widget-menu",2),e.qZA(),e.TgZ(3,"div",3),e.YNc(4,Q,2,2,"edit-form",4),e.ALo(5,"async"),e.qZA()),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("attributeScope","Project"),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,5,s.project$)))},directives:[G,Ei.y,ye,I.O5,ai.n,Te.k],pipes:[I.Ov],encapsulation:2,changeDetection:0});const we=["wpEmbeddedGraphMulti"],X=["wpEmbeddedGraphSingle"];function z(f,o){if(1&f&&(e.TgZ(0,"option",4),e._uU(1),e.qZA()),2&f){const s=o.$implicit;e.Q6J("ngValue",s.key),e.xp6(1),e.Oqu(s.label)}}function V(f,o){if(1&f&&(e.TgZ(0,"div",5),e._UZ(1,"div",6),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("textContent",s.error)}}function Qe(f,o){if(1&f&&e._UZ(0,"op-wp-embedded-graph",7,8),2&f){const s=e.oxw();e.Q6J("datasets",s.datasets)("chartOptions",s.chartOptions)}}function Ke(f,o){if(1&f&&e._UZ(0,"op-wp-embedded-graph",7,9),2&f){const s=e.oxw();e.Q6J("datasets",s.datasets)("chartOptions",s.chartOptions)}}class Nt{constructor(o,s,T,j){this.elementRef=o,this.I18n=s,this.graphConfigurationService=T,this.cdr=j,this.groupBy="status",this.chartOptions={maintainAspectRatio:!1},this.datasets=[],this.displayModeSingle=!0,this.error=null,this.availableGroupBy=[{label:s.t("js.work_packages.properties.category"),key:"category"},{label:s.t("js.work_packages.properties.type"),key:"type"},{label:s.t("js.work_packages.properties.status"),key:"status"},{label:s.t("js.work_packages.properties.priority"),key:"priority"},{label:s.t("js.work_packages.properties.author"),key:"author"},{label:s.t("js.work_packages.properties.assignee"),key:"assignee"}]}ngOnInit(){const o=this.elementRef.nativeElement;this.additionalFilter=JSON.parse(o.getAttribute("additional-filter")),this.setQueryProps()}setQueryProps(){this.datasets=[];const o=this.graphParams;this.graphConfigurationService.configuration=new De(o,{},"horizontalBar"),this.graphConfigurationService.reloadQueries().then(()=>{this.datasets=this.sortedDatasets(this.graphConfigurationService.datasets,o),this.cdr.detectChanges()}).catch(()=>{this.error=this.I18n.t("js.chart.errors.could_not_load"),this.cdr.detectChanges()})}get graphParams(){const o=[];return"status"===this.groupBy?(this.displayModeSingle=!0,o.push({name:this.I18n.t("js.label_all"),props:this.propsBoth})):(this.displayModeSingle=!1,o.push({name:this.I18n.t("js.label_open_work_packages"),props:this.propsOpen}),o.push({name:this.I18n.t("js.label_closed_work_packages"),props:this.propsClosed})),o}sortedDatasets(o,s){const T=s.map(j=>j.name);return o.slice().sort((j,q)=>T.indexOf(j.label)-T.indexOf(q.label))}get propsBoth(){return this.baseProps()}get propsOpen(){return this.baseProps({status:{operator:"o",values:[]}})}get propsClosed(){return this.baseProps({status:{operator:"c",values:[]}})}baseProps(o){const s=[{subprojectId:{operator:"*",values:[]}}];return o&&s.push(o),this.additionalFilter&&s.push(this.additionalFilter),{"columns[]":[],filters:JSON.stringify(s),group_by:this.groupBy,pageSize:0}}get displaySingle(){return this.displayModeSingle}get displayMulti(){return!this.displayModeSingle}get currentGraph(){return this.displaySingle?this.embeddedGraphSingle:this.embeddedGraphMulti}}Nt.\u0275fac=function(o){return new(o||Nt)(e.Y36(e.SBq),e.Y36(w.D),e.Y36(qe),e.Y36(e.sBO))},Nt.\u0275cmp=e.Xpm({type:Nt,selectors:[["wp-overview-graph"]],viewQuery:function(o,s){if(1&o&&(e.Gf(we,5),e.Gf(X,5)),2&o){let T;e.iGM(T=e.CRH())&&(s.embeddedGraphMulti=T.first),e.iGM(T=e.CRH())&&(s.embeddedGraphSingle=T.first)}},inputs:{additionalFilter:"additionalFilter",groupBy:"groupBy",chartOptions:"chartOptions"},features:[e._Bn([qe])],decls:5,vars:5,consts:[[3,"ngModel","ngModelChange"],[3,"ngValue",4,"ngFor","ngForOf"],["class","op-toast -error",4,"ngIf"],[3,"datasets","chartOptions",4,"ngIf"],[3,"ngValue"],[1,"op-toast","-error"],[1,"op-toast--content",3,"textContent"],[3,"datasets","chartOptions"],["wpEmbeddedGraphMulti",""],["wpEmbeddedGraphSingle",""]],template:function(o,s){1&o&&(e.TgZ(0,"select",0),e.NdJ("ngModelChange",function(j){return s.groupBy=j})("ngModelChange",function(){return s.setQueryProps()}),e.YNc(1,z,2,2,"option",1),e.qZA(),e.YNc(2,V,2,1,"div",2),e.YNc(3,Qe,2,2,"op-wp-embedded-graph",3),e.YNc(4,Ke,2,2,"op-wp-embedded-graph",3)),2&o&&(e.Q6J("ngModel",s.groupBy),e.xp6(1),e.Q6J("ngForOf",s.availableGroupBy),e.xp6(1),e.Q6J("ngIf",s.error),e.xp6(1),e.Q6J("ngIf",s.displayMulti),e.xp6(1),e.Q6J("ngIf",s.displaySingle))},directives:[c.EJ,c.JJ,c.On,I.sg,I.O5,c.YN,c.Kr,ei],styles:["wp-embedded-graph[_ngcontent-%COMP%]{margin-top:20px;display:block}"],changeDetection:0});class Kt extends P._{}Kt.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(Kt)))(s||Kt)}}(),Kt.\u0275cmp=e.Xpm({type:Kt,selectors:[["ng-component"]],features:[e.qOj],decls:3,vars:3,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource"],[1,"grid--widget-content","-no-overflow",3,"groupBy"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e.NdJ("onRenamed",function(j){return s.renameWidget(j)}),e._UZ(1,"widget-menu",1),e.qZA(),e._UZ(2,"wp-overview-graph",2)),2&o&&(e.Q6J("name",s.widgetName),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(1),e.Q6J("groupBy","type"))},directives:[G,ye,Nt],encapsulation:2,changeDetection:0});var Li=t(86029),dn=t(94232);class bi extends Li.k{constructor(o,s,T,j){super(),this.elementRef=o,this.injector=s,this.halResource=T,this.schemaCache=j,this.fieldName="text"}onFocusOut(){}initialize(o){this.initializeChangeset(o),this.valueChanged$=new S.X(o.options.text)}reinitialize(o){this.initializeChangeset(o)}handleUserSubmit(){return this.update()}reset(o=""){let s=o;o.length>0&&(s+="\n"),this.changeset.setValue(this.fieldName,{raw:s})}get schema(){return{name:I18n.t("js.grid.widgets.custom_text.title"),writable:!0,required:!1,type:"Formattable",hasDefault:!1}}update(){return(0,se.mG)(this,void 0,void 0,function*(){return this.onSubmit().then(()=>{this.valueChanged$.next(this.rawText),this.deactivate()})})}get rawText(){return _.get(this.textValue,"raw","")}get htmlText(){return _.get(this.textValue,"html","")}get textValue(){return this.changeset.value(this.fieldName)}handleUserCancel(){this.deactivate()}deactivate(){this.changeset.clear(),this.active=!1}activate(){this.active=!0}get inEditMode(){return!1}get inFlight(){return this.changeset.inFlight}focus(){const o=this.elementRef.nativeElement.querySelector(".inplace-editing--trigger-container");o&&o.focus()}setErrors(){}handleUserKeydown(){}isChanged(){return!this.changeset.isEmpty()}stopPropagation(){return!1}initializeChangeset(o){const s="customtext-schema",T={text:o.options.text,getEditorContext:()=>({type:"full",macros:"resource"}),canAddAttachments:o.grid.canAddAttachments,_links:{attachments:o.grid.attachments,schema:{href:s}}},j=this.halResource.createHalResource(T,!0),q={text:this.schema,_links:{self:{href:s}}},fe=this.halResource.createHalResource(q,!0);this.schemaCache.update(j,fe),this.changeset=new dn.W(j)}}bi.\u0275fac=function(o){return new(o||bi)(e.LFG(e.SBq),e.LFG(e.zs3),e.LFG(xt.u),e.LFG(Ue.y))},bi.\u0275prov=e.Yz7({token:bi,factory:bi.\u0275fac});var wi=t(9170),Oo=t(92058),On=t(41689);const Ys=["displayContainer"];function $s(f,o){if(1&f&&e._UZ(0,"div",12),2&f){const s=e.oxw(2);e.Q6J("innerHTML",s.customText,e.oJD)}}function Vs(f,o){if(1&f&&e._UZ(0,"div",13),2&f){const s=e.oxw(2);e.Q6J("innerHTML",s.placeholderText,e.oJD)}}function Hs(f,o){if(1&f&&(e.TgZ(0,"span",8,9),e.YNc(2,$s,1,1,"div",10),e.YNc(3,Vs,1,1,"div",11),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("ngIf",!s.textEmpty),e.xp6(1),e.Q6J("ngIf",s.textEmpty)}}function pn(f,o){if(1&f&&e._UZ(0,"edit-form-portal",14),2&f){const s=e.oxw();e.Q6J("schemaInput",s.schema)("changeInput",s.changeset)("editFieldHandler",s.handler)}}function Mo(f,o){if(1&f&&e._UZ(0,"attachments",15),2&f){const s=e.oxw();e.Q6J("resource",s.resource.grid)}}function Ks(f,o){1&f&&e.GkF(0)}function Gs(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",19),e.NdJ("click",function(j){return e.CHM(s),e.oxw(2).activate(j)}),e.YNc(1,Ks,1,0,"ng-container",20),e.qZA()}if(2&f){const s=e.oxw(2),T=e.MAs(3);e.Q6J("ngClass",s.inplaceEditClasses),e.xp6(1),e.Q6J("ngTemplateOutlet",T)}}function Ii(f,o){1&f&&e.GkF(0)}function Ne(f,o){if(1&f&&(e.ynx(0),e.YNc(1,Ii,1,0,"ng-container",20),e.BQk()),2&f){e.oxw(2);const s=e.MAs(3);e.xp6(1),e.Q6J("ngTemplateOutlet",s)}}const Z=function(f){return{"inline-edit--container":f}};function Y(f,o){if(1&f&&(e.TgZ(0,"div",16),e.YNc(1,Gs,2,2,"button",17),e.YNc(2,Ne,2,1,"ng-container",18),e.qZA()),2&f){const s=e.oxw();e.Q6J("ngClass",e.VKq(3,Z,s.isTextEditable)),e.xp6(1),e.Q6J("ngIf",s.isTextEditable),e.xp6(1),e.Q6J("ngIf",!s.isTextEditable)}}class ce extends P._{constructor(o,s,T,j,q,fe,Be){super(o,s),this.i18n=o,this.injector=s,this.handler=T,this.cdr=j,this.sanitization=q,this.appRef=fe,this.layout=Be}ngOnInit(){this.setupVariables(!0),this.handler.valueChanged$.pipe(this.untilDestroyed(),(0,wi.h)(o=>o!==this.resource.options.text)).subscribe(o=>{const s=this.setChangesetOptions({text:{raw:o}});this.resourceChanged.emit(s)})}ngOnChanges(o){o.resource.currentValue.options.text.raw!==this.currentRawText&&(this.setupVariables(),this.cdr.detectChanges())}activate(o){this.clickedElementIsLinkWithinDisplayContainer(o)||this.resource.grid.updateAttachments().then(()=>{this.handler.activate()})}get placeholderText(){return this.i18n.t("js.grid.widgets.work_packages_overview.placeholder")}get inplaceEditClasses(){let o="inplace-editing--container inline-edit--display-field -editable";return this.textEmpty&&(o+=" -placeholder"),o}get schema(){return this.handler.schema}get changeset(){return this.handler.changeset}get active(){return this.handler.active}get textEmpty(){return!this.currentRawText.length}get isTextEditable(){return this.layout.isEditable}setupVariables(o=!1){this.memorizeRawText(),o?this.handler.initialize(this.resource):this.handler.reinitialize(this.resource),this.memorizeCustomText()}memorizeRawText(){this.currentRawText=this.resource.options.text.raw}memorizeCustomText(){this.customText=this.sanitization.bypassSecurityTrustHtml(this.handler.htmlText),setTimeout(()=>{a.Z.bootstrapOptionalEmbeddable(this.appRef,this.displayContainer.nativeElement)},100)}clickedElementIsLinkWithinDisplayContainer(o){return this.displayContainer.nativeElement.contains(o.target.closest("a,macro"))}}ce.\u0275fac=function(o){return new(o||ce)(e.Y36(w.D),e.Y36(e.zs3),e.Y36(bi),e.Y36(e.sBO),e.Y36(i.H7),e.Y36(e.z2F),e.Y36(F))},ce.\u0275cmp=e.Xpm({type:ce,selectors:[["ng-component"]],viewQuery:function(o,s){if(1&o&&e.Gf(Ys,5),2&o){let T;e.iGM(T=e.CRH())&&(s.displayContainer=T.first)}},features:[e._Bn([bi]),e.qOj,e.TTD],decls:9,vars:5,consts:[[3,"name","onRenamed"],["slot","menu",3,"resource"],["text",""],[1,"grid--widget-content","-custom-text","-allow-inner-overflow"],[1,"inline-edit--container","inplace-edit"],[3,"schemaInput","changeInput","editFieldHandler",4,"ngIf"],["data-allow-uploading","true",3,"resource",4,"ngIf"],["class","inplace-edit--read wiki -no-label",3,"ngClass",4,"ngIf"],[1,"inline-edit--formattable-display-text","-default"],["displayContainer",""],["class","op-uc-container",3,"innerHTML",4,"ngIf"],[3,"innerHTML",4,"ngIf"],[1,"op-uc-container",3,"innerHTML"],[3,"innerHTML"],[3,"schemaInput","changeInput","editFieldHandler"],["data-allow-uploading","true",3,"resource"],[1,"inplace-edit--read","wiki","-no-label",3,"ngClass"],["type","button",3,"ngClass","click",4,"ngIf"],[4,"ngIf"],["type","button",3,"ngClass","click"],[4,"ngTemplateOutlet"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e.NdJ("onRenamed",function(j){return s.renameWidget(j)}),e._UZ(1,"widget-menu",1),e.qZA(),e.YNc(2,Hs,4,2,"ng-template",null,2,e.W1O),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e.YNc(6,pn,1,3,"edit-form-portal",5),e.YNc(7,Mo,1,1,"attachments",6),e.YNc(8,Y,3,5,"div",7),e.qZA(),e.qZA()),2&o&&(e.Q6J("name",s.widgetName),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(5),e.Q6J("ngIf",s.active),e.xp6(1),e.Q6J("ngIf",s.active),e.xp6(1),e.Q6J("ngIf",!s.active))},directives:[G,ye,I.O5,Oo.m,On.t,I.mk,I.tP],encapsulation:2,changeDetection:0});const xe=["contentContainer"];function Je(f,o){if(1&f&&(e.ynx(0),e.TgZ(1,"div",7),e._uU(2),e._UZ(3,"attribute-help-text",8),e.qZA(),e.TgZ(4,"div",9),e._UZ(5,"editable-attribute-field",10),e.qZA(),e.BQk()),2&f){const s=o.$implicit,T=e.oxw().ngIf;e.xp6(1),e.uIk("title",s.label),e.xp6(1),e.hij(" ",s.label," "),e.xp6(1),e.Q6J("attribute",s.key)("attributeScope","Project"),e.xp6(2),e.Q6J("resource",T)("fieldName",s.key)}}function Ge(f,o){if(1&f&&(e.TgZ(0,"edit-form",4),e.TgZ(1,"div",5),e.YNc(2,Je,6,6,"ng-container",6),e.qZA(),e.qZA()),2&f){const s=o.ngIf,T=e.oxw();e.Q6J("resource",s),e.xp6(2),e.Q6J("ngForOf",T.customFields)}}class tt extends P._{constructor(o,s,T,j,q){super(o,s),this.i18n=o,this.injector=s,this.apiV3Service=T,this.currentProject=j,this.cdRef=q,this.customFields=[]}ngOnInit(){this.loadAndRender(),this.currentProject.id&&(this.project$=this.apiV3Service.projects.id(this.currentProject.id).requireAndStream())}get isEditable(){return!1}loadAndRender(){Promise.all([this.loadProjectSchema()]).then(([o])=>{this.setCustomFields(o)})}loadProjectSchema(){return this.apiV3Service.projects.schema.get().toPromise()}setCustomFields(o){Object.entries(o).forEach(([s,T])=>{/customField\d+/.exec(s)&&this.customFields.push({key:s,label:T.name})}),this.cdRef.detectChanges()}}tt.\u0275fac=function(o){return new(o||tt)(e.Y36(w.D),e.Y36(e.zs3),e.Y36(O.T),e.Y36(x.R),e.Y36(e.sBO))},tt.\u0275cmp=e.Xpm({type:tt,selectors:[["ng-component"]],viewQuery:function(o,s){if(1&o&&e.Gf(xe,7),2&o){let T;e.iGM(T=e.CRH())&&(s.contentContainer=T.first)}},features:[e._Bn([Re.l]),e.qOj],decls:5,vars:6,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"resource",4,"ngIf"],[3,"resource"],[1,"attributes-map"],[4,"ngFor","ngForOf"],[1,"attributes-map--key"],[3,"attribute","attributeScope"],[1,"attributes-map--value"],[3,"resource","fieldName"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e._UZ(1,"widget-menu",1),e.qZA(),e.TgZ(2,"div",2),e.YNc(3,Ge,3,2,"edit-form",3),e.ALo(4,"async"),e.qZA()),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(2),e.Q6J("ngIf",e.lcZ(4,4,s.project$)))},directives:[G,ye,I.O5,ai.n,I.sg,Ei.y,Te.k],pipes:[I.Ov],encapsulation:2,changeDetection:0});var ze=t(29161),_t=t(84335);class dt extends P._{constructor(o,s,T,j,q,fe){super(T,o),this.injector=o,this.timezone=s,this.i18n=T,this.pathHelper=j,this.confirmDialog=q,this.cdr=fe,this.text={activity:this.i18n.t("js.time_entry.activity"),comment:this.i18n.t("js.time_entry.comment"),hour:this.i18n.t("js.time_entry.hours"),workPackage:this.i18n.t("js.label_work_package"),edit:this.i18n.t("js.button_edit"),delete:this.i18n.t("js.button_delete"),confirmDelete:{text:this.i18n.t("js.modals.destroy_time_entry.text"),title:this.i18n.t("js.modals.destroy_time_entry.title")},noResults:this.i18n.t("js.grid.widgets.time_entries_list.no_results")},this.entries=[],this.entriesLoaded=!1,this.rows=[]}ngOnInit(){this.apiV3Service.time_entries.list({filters:this.dmFilters(),pageSize:500}).subscribe(o=>{this.buildEntries(o.elements),this.entriesLoaded=!0,this.cdr.detectChanges()})}get total(){const o=this.entries.reduce((s,T)=>s+this.timezone.toHours(T.hours),0);return this.i18n.t("js.units.hour",{count:this.formatNumber(o)})}get anyEntries(){return!!this.entries.length}activityName(o){return o.activity.name}projectName(o){return o.project.name}workPackageName(o){return`#${o.workPackage.id}: ${o.workPackage.name}`}workPackageId(o){return o.workPackage.id}comment(o){return o.comment&&o.comment.raw}hours(o){return this.formatNumber(this.timezone.toHours(o.hours))}workPackagePath(o){return this.pathHelper.workPackagePath((0,Ee.Z)(o.workPackage.href))}get isEditable(){return!1}editTimeEntry(o){this.apiV3Service.time_entries.id(o.id).get().subscribe(s=>{this.timeEntryEditService.edit(s).then(T=>{const j=this.entries.findIndex(fe=>fe.id===T.entry.id),q=this.entries;q[j]=T.entry,this.buildEntries(q)}).catch(()=>{})})}deleteIfConfirmed(o,s){var T,j,q;o.preventDefault(),this.confirmDialog.confirm({text:this.text.confirmDelete,closeByEscape:!0,showClose:!0,closeByDocument:!0,passedData:[`#${(0,Ee.Z)(null===(T=s.workPackage)||void 0===T?void 0:T.href)} ${null===(j=s.workPackage)||void 0===j?void 0:j.name}`,`${this.i18n.t("js.units.hour",{count:this.timezone.toHours(s.hours)})} (${null===(q=s.activity)||void 0===q?void 0:q.name})`],dangerHighlighting:!0}).then(()=>{s.delete().then(()=>{const fe=this.entries.filter(Be=>s.id!==Be.id);this.buildEntries(fe)})}).catch(()=>{})}buildEntries(o){this.entries=o;const s={};o.forEach(q=>{const fe=q.spentOn;s[fe]||(s[fe]=0),s[fe]=s[fe]+this.timezone.toHours(q.hours)});const T=o.sort((q,fe)=>fe.spentOn.localeCompare(q.spentOn));this.rows=[];let j=null;T.forEach(q=>{q.spentOn!==j&&(j=q.spentOn,this.rows.push({date:this.timezone.formattedDate(j),sum:this.formatNumber(s[j])})),this.rows.push({date:j,entry:q})})}formatNumber(o){return this.i18n.toNumber(o,{precision:2})}get noEntries(){return!this.entries.length&&this.entriesLoaded}}dt.\u0275fac=function(o){return new(o||dt)(e.Y36(e.zs3),e.Y36(ot.B),e.Y36(w.D),e.Y36(Fe.j),e.Y36(_t.D),e.Y36(e.sBO))},dt.\u0275dir=e.lG2({type:dt,features:[e.qOj]}),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",$e.d)],dt.prototype,"timeEntryEditService",void 0),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",O.T)],dt.prototype,"apiV3Service",void 0);var gt=t(81979);function ti(f,o){if(1&f&&e._UZ(0,"no-results",4),2&f){const s=e.oxw();e.Q6J("title",s.text.noResults)}}function Ti(f,o){if(1&f&&e._UZ(0,"td",26),2&f){const s=e.oxw().$implicit,T=e.oxw(3);e.Q6J("textContent",T.activityName(s.entry))}}function ci(f,o){if(1&f&&(e.TgZ(0,"td",27),e._UZ(1,"strong",6),e.qZA()),2&f){const s=e.oxw().$implicit;e.xp6(1),e.Q6J("textContent",s.date)}}function $t(f,o){if(1&f&&(e.TgZ(0,"td",28),e._uU(1),e._UZ(2,"a",29),e.qZA()),2&f){const s=e.oxw().$implicit,T=e.oxw(3);e.xp6(1),e.hij(" ",T.projectName(s.entry)," - "),e.xp6(1),e.Q6J("href",T.workPackagePath(s.entry),e.LSH)("textContent",T.workPackageName(s.entry))}}function ii(f,o){if(1&f&&e._UZ(0,"td",30),2&f){const s=e.oxw().$implicit,T=e.oxw(3);e.Q6J("textContent",T.projectName(s.entry))}}function Mn(f,o){if(1&f&&e._UZ(0,"td",31),2&f){const s=e.oxw().$implicit,T=e.oxw(3);e.Q6J("textContent",T.comment(s.entry))}}function As(f,o){if(1&f&&e._UZ(0,"td",32),2&f){const s=e.oxw().$implicit,T=e.oxw(3);e.Q6J("textContent",T.hours(s.entry))}}function zs(f,o){if(1&f&&(e.TgZ(0,"td",33),e._UZ(1,"em",6),e.qZA()),2&f){const s=e.oxw().$implicit;e.xp6(1),e.Q6J("textContent",s.sum)}}function qs(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"a",34),e.NdJ("click",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw(3).editTimeEntry(j.entry)}),e._UZ(1,"op-icon",35),e.qZA()}if(2&f){const s=e.oxw(4);e.Q6J("title",s.text.edit)}}function js(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"a",34),e.NdJ("click",function(j){e.CHM(s);const q=e.oxw().$implicit;return e.oxw(3).deleteIfConfirmed(j,q.entry)}),e._UZ(1,"op-icon",36),e.qZA()}if(2&f){const s=e.oxw(4);e.Q6J("title",s.text.delete)}}function Rs(f,o){if(1&f&&(e.TgZ(0,"tr",16),e.YNc(1,Ti,1,1,"td",17),e.YNc(2,ci,2,1,"td",18),e.YNc(3,$t,3,3,"td",19),e.YNc(4,ii,1,1,"td",20),e.YNc(5,Mn,1,1,"td",21),e.YNc(6,As,1,1,"td",22),e.YNc(7,zs,2,1,"td",23),e.TgZ(8,"td",24),e.YNc(9,qs,2,1,"a",25),e.YNc(10,js,2,1,"a",25),e.qZA(),e.qZA()),2&f){const s=o.$implicit;e.xp6(1),e.Q6J("ngIf",s.entry),e.xp6(1),e.Q6J("ngIf",s.sum),e.xp6(1),e.Q6J("ngIf",s.entry&&s.entry.workPackage),e.xp6(1),e.Q6J("ngIf",s.entry&&!s.entry.workPackage),e.xp6(1),e.Q6J("ngIf",s.entry),e.xp6(1),e.Q6J("ngIf",s.entry),e.xp6(1),e.Q6J("ngIf",s.sum),e.xp6(2),e.Q6J("ngIf",s.entry&&s.entry.updateImmediately),e.xp6(1),e.Q6J("ngIf",s.entry&&s.entry.delete)}}function Xs(f,o){if(1&f&&(e.TgZ(0,"div",8),e.TgZ(1,"table",9),e.TgZ(2,"colgroup"),e._UZ(3,"col",10),e._UZ(4,"col",10),e._UZ(5,"col",10),e._UZ(6,"col",10),e._UZ(7,"col"),e.qZA(),e.TgZ(8,"thead",11),e.TgZ(9,"tr"),e.TgZ(10,"th"),e.TgZ(11,"div",12),e.TgZ(12,"div",13),e._UZ(13,"span",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(14,"th"),e.TgZ(15,"div",12),e.TgZ(16,"div",13),e._UZ(17,"span",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(18,"th"),e.TgZ(19,"div",12),e.TgZ(20,"div",13),e._UZ(21,"span",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(22,"th"),e.TgZ(23,"div",12),e.TgZ(24,"div",13),e._UZ(25,"span",6),e.qZA(),e.qZA(),e.qZA(),e.TgZ(26,"th"),e._UZ(27,"div",14),e.qZA(),e.qZA(),e.qZA(),e.TgZ(28,"tbody"),e.YNc(29,Rs,11,9,"tr",15),e.qZA(),e.qZA(),e.qZA()),2&f){const s=e.oxw(2);e.xp6(13),e.Q6J("textContent",s.text.activity),e.xp6(4),e.Q6J("textContent",s.text.workPackage),e.xp6(4),e.Q6J("textContent",s.text.comment),e.xp6(4),e.Q6J("textContent",s.text.hour),e.xp6(4),e.Q6J("ngForOf",s.rows)}}function un(f,o){if(1&f&&(e.ynx(0),e.TgZ(1,"div",5),e.TgZ(2,"p"),e._uU(3,"Total: "),e._UZ(4,"span",6),e.qZA(),e.qZA(),e.YNc(5,Xs,30,5,"div",7),e.BQk()),2&f){const s=e.oxw();e.xp6(4),e.Q6J("textContent",s.total),e.xp6(1),e.Q6J("ngIf",s.anyEntries)}}class Bi extends dt{constructor(o,s,T,j,q,fe,Be){super(o,s,T,j,q,fe),this.injector=o,this.timezone=s,this.i18n=T,this.pathHelper=j,this.confirmDialog=q,this.cdr=fe,this.currentProject=Be}dmFilters(){return[["spentOn",">t-",["7"]],["project_id","=",[this.currentProject.id]]]}}function er(f,o){if(1&f&&e._UZ(0,"no-results",5),2&f){const s=e.oxw();e.Q6J("title",s.text.noResults)}}function Bt(f,o){1&f&&(e.TgZ(0,"span"),e._uU(1,", "),e.qZA())}function Qt(f,o){if(1&f&&(e.TgZ(0,"span"),e._UZ(1,"a",6),e.YNc(2,Bt,2,0,"span",7),e.qZA()),2&f){const s=o.$implicit,T=o.last,j=e.oxw();e.xp6(1),e.Q6J("href",j.projectPath(s),e.LSH)("textContent",j.projectName(s)),e.xp6(1),e.Q6J("ngIf",!T)}}Bi.\u0275fac=function(o){return new(o||Bi)(e.Y36(e.zs3),e.Y36(ot.B),e.Y36(w.D),e.Y36(Fe.j),e.Y36(_t.D),e.Y36(e.sBO),e.Y36(x.R))},Bi.\u0275cmp=e.Xpm({type:Bi,selectors:[["ng-component"]],features:[e.qOj],decls:4,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[3,"title",4,"ngIf"],[4,"ngIf"],[3,"title"],[1,"total-hours"],[3,"textContent"],["class","generic-table--results-container",4,"ngIf"],[1,"generic-table--results-container"],[1,"generic-table","time-entries"],["opHighlightCol",""],[1,"-sticky"],[1,"generic-table--sort-header-outer"],[1,"generic-table--sort-header"],[1,"generic-table--empty-header"],["class","time-entry",4,"ngFor","ngForOf"],[1,"time-entry"],["class","activity",3,"textContent",4,"ngIf"],["colspan","3",4,"ngIf"],["class","subject",4,"ngIf"],["class","subject",3,"textContent",4,"ngIf"],["class","comments",3,"textContent",4,"ngIf"],["class","hours",3,"textContent",4,"ngIf"],["class","hours",4,"ngIf"],[1,"buttons"],[3,"title","click",4,"ngIf"],[1,"activity",3,"textContent"],["colspan","3"],[1,"subject"],[3,"href","textContent"],[1,"subject",3,"textContent"],[1,"comments",3,"textContent"],[1,"hours",3,"textContent"],[1,"hours"],[3,"title","click"],["icon-classes","icon-context icon-edit"],["icon-classes","icon-context icon-delete"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e._UZ(1,"widget-menu",1),e.qZA(),e.YNc(2,ti,1,1,"no-results",2),e.YNc(3,un,6,2,"ng-container",3)),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(1),e.Q6J("ngIf",s.noEntries),e.xp6(1),e.Q6J("ngIf",!s.noEntries))},directives:[G,ye,I.O5,Mt.S,gt.K,I.sg,ut.o],encapsulation:2});class Gt extends P._{constructor(o,s,T,j,q,fe,Be,Ye){super(T,j),this.halResource=o,this.pathHelper=s,this.i18n=T,this.injector=j,this.timezone=q,this.apiV3Service=fe,this.currentProject=Be,this.cdr=Ye,this.text={noResults:this.i18n.t("js.grid.widgets.subprojects.no_results")}}ngOnInit(){this.apiV3Service.projects.list(this.projectListParams).subscribe(o=>{this.projects=o.elements,this.cdr.detectChanges()})}get isEditable(){return!1}projectPath(o){return this.pathHelper.projectPath(o.identifier)}projectName(o){return o.name}get noEntries(){return this.projects&&!this.projects.length}get projectListParams(){return{sortBy:[["name","asc"]],filters:[["parent_id","=",[this.currentProject.id]]]}}}function li(f,o){if(1&f&&e._UZ(0,"no-results",10),2&f){const s=e.oxw();e.Q6J("title",s.text.noResults)}}function Pi(f,o){1&f&&(e.ynx(0),e._uU(1,", "),e.BQk())}function In(f,o){if(1&f&&(e.ynx(0),e._UZ(1,"op-principal",13),e.YNc(2,Pi,2,0,"ng-container",14),e.BQk()),2&f){const s=o.$implicit,T=o.last;e.xp6(1),e.Q6J("principal",s),e.xp6(1),e.Q6J("ngIf",!T)}}function hn(f,o){if(1&f&&(e.ynx(0),e.TgZ(1,"div",11),e._uU(2),e.qZA(),e.TgZ(3,"div",12),e.YNc(4,In,3,2,"ng-container",5),e.qZA(),e.BQk()),2&f){const s=o.$implicit;e.xp6(2),e.hij(" ",s.role.name," "),e.xp6(2),e.Q6J("ngForOf",s.users)}}function Sn(f,o){if(1&f&&(e.TgZ(0,"div",15),e._uU(1),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.hij(" ",s.moreMembersText," ")}}function la(f,o){if(1&f&&(e.TgZ(0,"a",16),e._UZ(1,"i",17),e._UZ(2,"span",18),e.qZA()),2&f){const s=e.oxw();e.Q6J("href",s.projectMembershipsPath+"?show_add_members=true",e.LSH),e.xp6(2),e.Q6J("textContent",s.text.add)}}function da(f,o){if(1&f&&(e.TgZ(0,"a",19),e._UZ(1,"i",20),e._UZ(2,"span",18),e.qZA()),2&f){const s=e.oxw();e.Q6J("href",s.projectMembershipsPath,e.LSH),e.xp6(2),e.Q6J("textContent",s.text.viewAll)}}Gt.\u0275fac=function(o){return new(o||Gt)(e.Y36(xt.u),e.Y36(Fe.j),e.Y36(w.D),e.Y36(e.zs3),e.Y36(ot.B),e.Y36(O.T),e.Y36(x.R),e.Y36(e.sBO))},Gt.\u0275cmp=e.Xpm({type:Gt,selectors:[["ng-component"]],features:[e.qOj],decls:5,vars:5,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"title"],[3,"href","textContent"],[4,"ngIf"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e._UZ(1,"widget-menu",1),e.qZA(),e.TgZ(2,"div",2),e.YNc(3,er,1,1,"no-results",3),e.YNc(4,Qt,3,3,"span",4),e.qZA()),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(2),e.Q6J("ngIf",s.noEntries),e.xp6(1),e.Q6J("ngForOf",s.projects))},directives:[G,ye,I.O5,I.sg,Mt.S],encapsulation:2,changeDetection:0});class Dn extends P._{constructor(o,s,T,j,q,fe){super(T,j),this.pathHelper=o,this.apiV3Service=s,this.i18n=T,this.injector=j,this.currentProject=q,this.cdr=fe,this.text={add:this.i18n.t("js.grid.widgets.members.add"),noResults:this.i18n.t("js.grid.widgets.members.no_results"),viewAll:this.i18n.t("js.grid.widgets.members.view_all_members")},this.entriesByRoles={},this.entriesLoaded=!1,this.membersAddable=!1}ngOnInit(){this.apiV3Service.memberships.list(this.listMembersParams).subscribe(o=>{this.partitionEntriesByRole(o.elements),this.sortUsersByName(),this.totalMembers=o.total,this.entriesLoaded=!0,this.cdr.detectChanges()}),this.apiV3Service.memberships.available_projects.list(this.listAvailableProjectsParams).subscribe(o=>{this.membersAddable=o.total>0})}get isEditable(){return!1}get noMembers(){return this.entriesLoaded&&!Object.keys(this.entriesByRoles).length}get moreMembers(){return this.entriesLoaded&&this.totalMembers>100}get moreMembersText(){return I18n.t("js.grid.widgets.members.too_many",{count:100,total:this.totalMembers})}get projectMembershipsPath(){return this.pathHelper.projectMembershipsPath(this.currentProject.identifier)}get usersByRole(){return Object.values(this.entriesByRoles)}partitionEntriesByRole(o){o.forEach(s=>{s.roles.forEach(T=>{this.entriesByRoles[T.id]||(this.entriesByRoles[T.id]={role:T,users:[]}),this.entriesByRoles[T.id].users.push(s.principal)})})}sortUsersByName(){Object.values(this.entriesByRoles).forEach(o=>{o.users.sort((s,T)=>s.name.localeCompare(T.name))})}get listMembersParams(){const o={sortBy:[["created_at","desc"]],pageSize:100};return this.currentProject.id&&(o.filters=[["project_id","=",[this.currentProject.id]]]),o}get listAvailableProjectsParams(){const o={};return this.currentProject.id&&(o.filters=[["id","=",[this.currentProject.id]]]),o}}Dn.\u0275fac=function(o){return new(o||Dn)(e.Y36(Fe.j),e.Y36(O.T),e.Y36(w.D),e.Y36(e.zs3),e.Y36(x.R),e.Y36(e.sBO))},Dn.\u0275cmp=e.Xpm({type:Dn,selectors:[["ng-component"]],features:[e.qOj],decls:10,vars:8,consts:[[3,"name","editable"],["slot","menu",3,"resource"],[1,"grid--widget-content"],[3,"title",4,"ngIf"],[1,"op-members-widget--attributes-map","-minimal-keys"],[4,"ngFor","ngForOf"],["class","op-members-widget--notification",4,"ngIf"],[1,"op-members-widget--grid--widget-footer"],["class","button -alt-highlight",3,"href",4,"ngIf"],["class","button -highlight-inverted",3,"href",4,"ngIf"],[3,"title"],[1,"attributes-map--key"],[1,"attributes-map--value"],["size","mini",3,"principal"],[4,"ngIf"],[1,"op-members-widget--notification"],[1,"button","-alt-highlight",3,"href"],["aria-hidden","true",1,"button--icon","icon-add"],[1,"button--text",3,"textContent"],[1,"button","-highlight-inverted",3,"href"],["aria-hidden","true",1,"button--icon","icon-group"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e._UZ(1,"widget-menu",1),e.qZA(),e.TgZ(2,"div",2),e.YNc(3,li,1,1,"no-results",3),e.TgZ(4,"div",4),e.YNc(5,hn,5,2,"ng-container",5),e.qZA(),e.YNc(6,Sn,2,1,"div",6),e.qZA(),e.TgZ(7,"div",7),e.YNc(8,la,3,2,"a",8),e.YNc(9,da,3,2,"a",9),e.qZA()),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(2),e.Q6J("ngIf",s.noMembers),e.xp6(2),e.Q6J("ngForOf",s.usersByRole),e.xp6(1),e.Q6J("ngIf",s.moreMembers),e.xp6(2),e.Q6J("ngIf",s.membersAddable),e.xp6(1),e.Q6J("ngIf",!s.noMembers))},directives:[G,ye,I.O5,I.sg,Mt.S,ve.N],styles:[".op-members-widget--notification[_ngcontent-%COMP%]{font-style:italic;margin-top:.5rem}.op-members-widget--grid--widget-footer[_ngcontent-%COMP%]{margin-top:.5rem}.op-members-widget--grid--widget-footer[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{margin-bottom:0}.op-members-widget--attributes-map[_ngcontent-%COMP%]{padding-bottom:.875rem;line-height:1.5rem}"],changeDetection:0});var pa=t(84897);const ua=["contentContainer"];function ha(f,o){if(1&f&&(e.TgZ(0,"edit-form",5),e.TgZ(1,"div",6),e._UZ(2,"editable-attribute-field",7),e.qZA(),e.TgZ(3,"div",8),e._UZ(4,"editable-attribute-field",9),e.qZA(),e.qZA()),2&f){const s=o.ngIf;e.Q6J("resource",s),e.xp6(2),e.Q6J("resource",s),e.xp6(2),e.Q6J("resource",s)}}class An extends P._{constructor(o,s,T,j,q){super(o,s),this.i18n=o,this.injector=s,this.apiV3Service=T,this.currentProject=j,this.cdRef=q,this.currentStatusCode="not set",this.explanation=""}ngOnInit(){this.currentProject.id&&(this.project$=this.apiV3Service.projects.id(this.currentProject.id).get(),this.cdRef.detectChanges())}get isEditable(){return!1}}An.\u0275fac=function(o){return new(o||An)(e.Y36(w.D),e.Y36(e.zs3),e.Y36(O.T),e.Y36(x.R),e.Y36(e.sBO))},An.\u0275cmp=e.Xpm({type:An,selectors:[["ng-component"]],viewQuery:function(o,s){if(1&o&&e.Gf(ua,7),2&o){let T;e.iGM(T=e.CRH())&&(s.contentContainer=T.first)}},features:[e._Bn([pa.B,di.q,Re.l]),e.qOj],decls:6,vars:7,consts:[[3,"name","editable"],["slot","prepend","attribute","status",3,"attributeScope"],["slot","menu",3,"resource"],[1,"grid--widget-content","-allow-inner-overflow"],[3,"resource",4,"ngIf"],[3,"resource"],[1,"project-status--container"],["fieldName","status","wrapperClasses","project-status--display-field",3,"resource"],[1,"project-status-explanation--container"],["fieldName","statusExplanation",3,"resource"]],template:function(o,s){1&o&&(e.TgZ(0,"widget-header",0),e._UZ(1,"attribute-help-text",1),e._UZ(2,"widget-menu",2),e.qZA(),e.TgZ(3,"div",3),e.YNc(4,ha,5,3,"edit-form",4),e.ALo(5,"async"),e.qZA()),2&o&&(e.Q6J("name",s.widgetName)("editable",s.isEditable),e.xp6(1),e.Q6J("attributeScope","Project"),e.xp6(1),e.Q6J("resource",s.resource),e.xp6(2),e.Q6J("ngIf",e.lcZ(5,5,s.project$)))},directives:[G,Ei.y,ye,I.O5,ai.n,Te.k],pipes:[I.Ov],encapsulation:2,changeDetection:0});var _a=t(54349),Zs=t(26269);class Qi{constructor(o){!function(f){const o=f.get(C.$),s=f.get(w.D);o.register("gridWidgets",()=>{const T=["id","project","type","subject"],j=new Zs.qM;j.add("assignee","=",["me"]),j.add("status","o",[]);const q={"columns[]":T,filters:j.toJson()},fe=new Zs.qM;fe.add("responsible","=",["me"]),fe.add("status","o",[]);const Be={"columns[]":T,filters:fe.toJson()},Ye=new Zs.qM;Ye.add("author","=",["me"]),Ye.add("status","o",[]);const at={"columns[]":T,filters:Ye.toJson()},At=new Zs.qM;At.add("watcher","=",["me"]),At.add("status","o",[]);const Ot={"columns[]":T,filters:At.toJson()};return[{identifier:"work_packages_assigned",component:Yt,title:s.t("js.grid.widgets.work_packages_assigned.title"),properties:{queryProps:q,name:s.t("js.grid.widgets.work_packages_assigned.title")}},{identifier:"work_packages_accountable",component:Yt,title:s.t("js.grid.widgets.work_packages_accountable.title"),properties:{queryProps:Be,name:s.t("js.grid.widgets.work_packages_accountable.title")}},{identifier:"work_packages_created",component:Yt,title:s.t("js.grid.widgets.work_packages_created.title"),properties:{queryProps:at,name:s.t("js.grid.widgets.work_packages_created.title")}},{identifier:"work_packages_watched",component:Yt,title:s.t("js.grid.widgets.work_packages_watched.title"),properties:{queryProps:Ot,name:s.t("js.grid.widgets.work_packages_watched.title")}},{identifier:"work_packages_table",component:Yt,title:s.t("js.grid.widgets.work_packages_table.title"),properties:{name:s.t("js.grid.widgets.work_packages_table.title")}},{identifier:"work_packages_graph",component:ni,title:s.t("js.grid.widgets.work_packages_graph.title"),properties:{name:s.t("js.grid.widgets.work_packages_graph.title")}},{identifier:"work_packages_calendar",component:Ae,title:s.t("js.grid.widgets.work_packages_calendar.title"),properties:{name:s.t("js.grid.widgets.work_packages_calendar.title")}},{identifier:"work_packages_overview",component:Kt,title:s.t("js.grid.widgets.work_packages_overview.title"),properties:{name:s.t("js.grid.widgets.work_packages_overview.title")}},{identifier:"time_entries_current_user",component:Wt,title:s.t("js.grid.widgets.time_entries_current_user.title"),properties:{name:s.t("js.grid.widgets.time_entries_current_user.title"),days:[!0,!0,!0,!0,!0,!0,!0]}},{identifier:"time_entries_project",component:Bi,title:s.t("js.grid.widgets.time_entries_list.title"),properties:{name:s.t("js.grid.widgets.time_entries_list.title")}},{identifier:"documents",component:Ze,title:s.t("js.grid.widgets.documents.title"),properties:{name:s.t("js.grid.widgets.documents.title")}},{identifier:"members",component:Dn,title:s.t("js.grid.widgets.members.title"),properties:{name:s.t("js.grid.widgets.members.title")}},{identifier:"news",component:yt,title:s.t("js.grid.widgets.news.title"),properties:{name:s.t("js.grid.widgets.news.title")}},{identifier:"project_description",component:U,title:s.t("js.grid.widgets.project_description.title"),properties:{name:s.t("js.grid.widgets.project_description.title")}},{identifier:"custom_text",component:ce,title:s.t("js.grid.widgets.custom_text.title"),properties:{name:s.t("js.grid.widgets.custom_text.title"),text:{raw:""}}},{identifier:"project_details",component:tt,title:s.t("js.grid.widgets.project_details.title"),properties:{name:s.t("js.grid.widgets.project_details.title")}},{identifier:"project_status",component:An,title:s.t("js.grid.widgets.project_status.title"),properties:{name:s.t("js.grid.widgets.project_status.title")}},{identifier:"subprojects",component:Gt,title:s.t("js.grid.widgets.subprojects.title"),properties:{name:s.t("js.grid.widgets.subprojects.title")}}]})}(o)}}Qi.\u0275fac=function(o){return new(o||Qi)(e.LFG(e.zs3))},Qi.\u0275mod=e.oAB({type:Qi}),Qi.\u0275inj=e.cJS({providers:[Rt,Et],imports:[[i.b2,c.u5,E._t,n.H,y.K,p.H,yi,m.OpenprojectCalendarModule,_a.I,l.Z,g.wA.withComponents([ce,Ze,Dn,yt,Yt,ni,Ae,Kt,U,tt,An,Gt,Wt,Bi]),r.E]]});var br=t(84732),Vt=t(84906);const wr="openproject-base";class _n{}_n.\u0275fac=function(o){return new(o||_n)},_n.\u0275cmp=e.Xpm({type:_n,selectors:[["openproject-base"]],decls:2,vars:0,consts:[[1,"openproject-base--ui-view"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e._UZ(1,"ui-view"),e.qZA())},directives:[Vt.UIView],encapsulation:2});var ga=t(57014);const fa=[{name:"my_notifications.**",url:"/my/notifications",loadChildren:()=>t.e("src_app_features_user-preferences_user-preferences_module_ts").then(t.bind(t,91880)).then(f=>f.OpenProjectMyAccountModule)},{name:"user_notifications.**",url:"/users/:userId/edit/notifications",loadChildren:()=>t.e("src_app_features_user-preferences_user-preferences_module_ts").then(t.bind(t,91880)).then(f=>f.OpenProjectMyAccountModule)},{name:"my_reminders.**",url:"/my/reminders",loadChildren:()=>t.e("src_app_features_user-preferences_user-preferences_module_ts").then(t.bind(t,91880)).then(f=>f.OpenProjectMyAccountModule)},{name:"user_reminders.**",url:"/users/:userId/edit/reminders",loadChildren:()=>t.e("src_app_features_user-preferences_user-preferences_module_ts").then(t.bind(t,91880)).then(f=>f.OpenProjectMyAccountModule)}],va=[{name:"notifications.**",url:"/notifications",loadChildren:()=>Promise.resolve().then(t.bind(t,99197)).then(f=>f.OpenProjectInAppNotificationsModule)}];var ir=t(53916);const Ta=[{name:"new_project.**",url:"/projects/new",loadChildren:()=>Promise.resolve().then(t.bind(t,71718)).then(f=>f.OpenprojectProjectsModule)},{name:"root",abstract:!0,url:"",component:_n,params:{flash_message:{dynamic:!0,value:null,inherit:!1}}},{name:"optional_project",parent:"root",url:"/{projects}/{projectPath}",abstract:!0,params:{projectPath:{type:"path",value:null,squash:!0},projects:{type:"path",value:null,squash:!0}},views:{"!$default":{component:_n}}},{name:"api-docs.**",parent:"optional_project",url:"/api/docs",loadChildren:()=>t.e("src_app_features_api-docs_openproject-api-docs_module_ts").then(t.bind(t,84138)).then(f=>f.OpenprojectApiDocsModule)},{name:"boards.**",parent:"optional_project",url:"/boards",loadChildren:()=>t.e("src_app_features_boards_openproject-boards_module_ts").then(t.bind(t,20555)).then(f=>f.OpenprojectBoardsModule)},{name:"bim.**",parent:"optional_project",url:"/bcf",loadChildren:()=>t.e("src_app_features_bim_ifc_models_openproject-ifc-models_module_ts").then(t.bind(t,29526)).then(f=>f.OpenprojectIFCModelsModule)},{name:"backlogs.**",parent:"optional_project",url:"/backlogs",loadChildren:()=>t.e("src_app_features_backlogs_openproject-backlogs_module_ts").then(t.bind(t,89732)).then(f=>f.OpenprojectBacklogsModule)},{name:"backlogs_sprint.**",parent:"optional_project",url:"/sprints",loadChildren:()=>t.e("src_app_features_backlogs_openproject-backlogs_module_ts").then(t.bind(t,89732)).then(f=>f.OpenprojectBacklogsModule)},{name:"reporting.**",parent:"optional_project",url:"/cost_reports",loadChildren:()=>t.e("src_app_features_reporting_openproject-reporting_module_ts").then(t.bind(t,74672)).then(f=>f.OpenprojectReportingModule)},{name:"job-statuses.**",parent:"optional_project",url:"/job_statuses",loadChildren:()=>t.e("src_app_features_job-status_openproject-job-status_module_ts").then(t.bind(t,15732)).then(f=>f.OpenProjectJobStatusModule)},{name:"project_settings.**",parent:"optional_project",url:"/settings/general",loadChildren:()=>Promise.resolve().then(t.bind(t,71718)).then(f=>f.OpenprojectProjectsModule)},{name:"project_copy.**",parent:"optional_project",url:"/copy",loadChildren:()=>Promise.resolve().then(t.bind(t,71718)).then(f=>f.OpenprojectProjectsModule)},...fa,...va,...[{name:"team_planner.**",parent:"optional_project",url:"/team_planner",loadChildren:()=>t.e("src_app_features_team-planner_team-planner_team-planner_module_ts").then(t.bind(t,36636)).then(f=>f.TeamPlannerModule)}],...[{name:"calendar.**",parent:"optional_project",url:"/calendars",loadChildren:()=>Promise.resolve().then(t.bind(t,51303)).then(f=>f.OpenprojectCalendarModule)}]];function nr(f,o="add"){f&&(Array.isArray(f)?f.forEach(s=>{document.body.classList[o](s)}):document.body.classList[o](f))}function Tr(f,o="add"){if(!f)return;const s=jQuery(`#main-menu .${f}`)[0];if(!s)return;s.classList[o]("selected");let T=(s.getAttribute("title")||"").split(":").slice(-1)[0];"add"===o&&(T=I18n.t("js.description_current_position")+T),s.setAttribute("title",T)}function ka(f){const o=f.get(ge.TransitionService),s=f.get(ge.StateService),T=f.get(M.kl),j=f.get(x.R),q=f.get(br.p),fe=f.get(ga.Y),Be=document.querySelector(wr);o.onBefore({to:Ye=>!!Ye&&function(f){return f.data&&f.data.mobileAlternative&&(new ir.U).isMobile}(Ye)},Ye=>function(f){const o=f.router.stateService,s=f.to().data.mobileAlternative;return o.target(s,f.params(),{})}(Ye)),o.onEnter({},(Ye,at)=>{nr(_.get(at,"data.bodyClasses"),"add"),Ye.from().data&&_.get(at,"data.menuItem")!==Ye.from().data.menuItem&&Tr(_.get(at,"data.menuItem"),"add")}),o.onExit({},(Ye,at)=>{nr(_.get(at,"data.bodyClasses"),"remove"),Ye.to().data&&_.get(at,"data.menuItem")!==Ye.to().data.menuItem&&Tr(_.get(at,"data.menuItem"),"remove")}),o.onStart({},Ye=>{var at;const At=Ye.router.stateService,Ot=Ye.params("to"),zt=Ye.to();if(Ot.start_onboarding_tour&&"work-packages.partitioned.list"!==zt.name){const sn=Object.assign({},Ye.params());return sn.start_onboarding_tour=void 0,At.target(Ye.to(),sn)}fe.sync(Ye);const Wi=window.MiniProfiler;null==Wi||Wi.pageTransition();const Ds=zt.$$state&&zt.$$state(),yr=null===(at=null==Ds?void 0:Ds.includes)||void 0===at?void 0:at.root,Eo=Ot.projectPath||j.identifier;if(yr&&!Ot.projects&&Eo){const sn=_.clone(Ot);return _.assign(sn,{projectPath:Eo,projects:"projects"}),At.target(zt,sn,{location:"replace"})}if(null===Be){const sn=window.location.pathname,Lh=sn+window.location.search,Js=s.href(zt,Ot);if(Js&&sn!==Js&&Lh!==Js)return window.location.href=Js,!1}return nr(_.get(zt,"data.bodyClasses"),"add"),q.setIfFirst(zt.name,Ot),Ye.to().name!==Ye.from().name&&T.clear(),Ot.flash_message&&T.add(Ot.flash_message),!0})}class jn{constructor(o){ka(o)}}jn.\u0275fac=function(o){return new(o||jn)(e.LFG(e.zs3))},jn.\u0275mod=e.oAB({type:jn}),jn.\u0275inj=e.cJS({providers:[br.p],imports:[[Vt.UIRouterModule.forRoot({states:Ta,useHash:!1,config:function(f,o,s){f.urlService.config.strictMode(!1),f.urlService.config.type("opQueryString",{encode:encodeURIComponent,decode:decodeURIComponent,raw:!0,dynamic:!0,is:T=>"string"==typeof T,equals:(T,j)=>_.isEqual(T,j)}),f.urlService.config.type("opQueryId",{pattern:new RegExp(/(?:new|[0-9]+)/),encode:T=>T||"new",decode:T=>"new"===T?null:T,raw:!0,dynamic:!0,is:T=>"string"==typeof T,equals:(T,j)=>_.isEqual(T,j)})}})]]});var xa=t(38421),Ea=t(19496),or=t(81134),Oa=t(60914),Ma=t(1818),Ia=t(50937),Sa=t(5262),Pr=t(81628),Da=t(46669),kr=t(25351),Gi=t(11266),Aa=t(74565),xr=t(77180),Er=t(84312),ja=t(70971),Ra=t(87947),Za=t(73905),Fa=t(31021);function Wa(f,o){if(1&f&&(e.TgZ(0,"li",26),e._UZ(1,"wp-watcher-button",27),e.qZA()),2&f){const s=e.oxw(2);e.xp6(1),e.Q6J("workPackage",s.workPackage)("showText",!1)}}function Ua(f,o){if(1&f&&e._UZ(0,"op-work-package-mark-notification-button",28),2&f){const s=e.oxw(2);e.Q6J("workPackage",s.workPackage)}}const La=function(){return["work_package.addChild","work_package.copy"]};function Ba(f,o){if(1&f&&(e.TgZ(0,"div",1),e._UZ(1,"wp-breadcrumb",2),e.TgZ(2,"div",3),e.TgZ(3,"div",4),e.TgZ(4,"div",5),e._UZ(5,"op-back-button",6),e.TgZ(6,"div",7),e._UZ(7,"wp-subject"),e.qZA(),e.qZA(),e.TgZ(8,"ul",8),e.TgZ(9,"li",9),e._UZ(10,"wp-create-button",10),e.qZA(),e.YNc(11,Wa,2,2,"li",11),e.TgZ(12,"li",9),e._UZ(13,"zen-mode-toggle-button"),e.qZA(),e.TgZ(14,"li",12),e.TgZ(15,"button",13),e._UZ(16,"op-icon",14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",15),e.TgZ(18,"div",16),e.TgZ(19,"div",17),e._UZ(20,"wp-single-view",2),e.qZA(),e.qZA(),e.TgZ(21,"div",18),e.TgZ(22,"div",17),e._UZ(23,"span",19),e._UZ(24,"op-wp-tabs",20),e.TgZ(25,"div",21),e.YNc(26,Ua,1,1,"op-work-package-mark-notification-button",22),e.ALo(27,"async"),e.qZA(),e._UZ(28,"div",23),e.qZA(),e.TgZ(29,"div",24),e._UZ(30,"wp-resizer",25),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.Q6J("resource",s.workPackage),e.xp6(1),e.Q6J("workPackage",s.workPackage),e.xp6(9),e.Q6J("allowed",e.DdM(16,La))("stateName$",s.stateName$),e.xp6(1),e.Q6J("ngIf",s.displayWatchButton),e.xp6(4),e.Q6J("wpSingleContextMenu-workPackage",s.workPackage),e.uIk("title",s.text.full_view.button_more),e.xp6(5),e.Q6J("workPackage",s.workPackage),e.xp6(3),e.Q6J("textContent",s.focusAnchorLabel),e.xp6(1),e.Q6J("workPackage",s.workPackage)("view","full"),e.xp6(2),e.Q6J("ngIf",e.lcZ(27,14,s.displayNotificationsButton$)&&"activity"===s.keepTab.currentTabIdentifier),e.xp6(4),e.Q6J("elementClass","work-packages-full-view--split-right")("localStorageKey","openProject-fullViewFlexBasis")}}class Io extends Ma.e{constructor(o,s,T){super(o,T.params.workPackageId),this.injector=o,this.wpTableSelection=s,this.$state=T,this.stateName$=(0,or.of)("work-packages.new")}ngOnInit(){this.observeWorkPackage()}initializeTexts(){super.initializeTexts(),this.text.full_view={button_more:this.I18n.t("js.button_more")}}init(){super.init(),this.wpTableFocus.updateFocus(this.workPackage.id),this.setWorkPackageScopeProperties(this.workPackage)}setWorkPackageScopeProperties(o){this.isWatched=o.hasOwnProperty("unwatch"),this.displayWatchButton=o.hasOwnProperty("unwatch")||o.hasOwnProperty("watch"),o.watchers&&(this.watchers=o.watchers.elements)}}Io.\u0275fac=function(o){return new(o||Io)(e.Y36(e.zs3),e.Y36(Oa.J),e.Y36(ge.StateService))},Io.\u0275cmp=e.Xpm({type:Io,selectors:[["wp-full-view-entry"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[e._Bn([Ia.O,{provide:Le.W,useExisting:ie.q}]),e.qOj],decls:1,vars:1,consts:[["edit-form","","class","work-packages--show-view",3,"resource",4,"ngIf"],["edit-form","",1,"work-packages--show-view",3,"resource"],[3,"workPackage"],[1,"toolbar-container"],["id","toolbar"],[1,"wp-show--header-container"],["linkClass","work-packages-back-button op-back-button_mobile-full-width"],[1,"subject-header"],["id","toolbar-items",1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],[3,"allowed","stateName$"],["class","toolbar-item",4,"ngIf"],["id","action-show-more-dropdown-menu",1,"toolbar-item","action_menu_main"],["wpSingleContextMenu","",1,"button","dropdown-relative","toolbar-icon",3,"wpSingleContextMenu-workPackage"],["icon-classes","button--icon icon-show-more"],[1,"work-packages-full-view--split-container"],[1,"work-packages-full-view--split-left"],[1,"work-packages--panel-inner"],[1,"work-packages-full-view--split-right","work-packages-tab-view--overflow"],["tabindex","-1","opAutofocus","",1,"hidden-for-sighted",3,"textContent"],[3,"workPackage","view"],[1,"work-packages-full-view--tab-breadcrumb"],["class","work-package--details-button","buttonClasses","-round button_no-margin","data-qa-selector","mark-notification-read-button",3,"workPackage",4,"ngIf"],["data-notification-selector","notification-scroll-container","ui-view","",1,"tabcontent"],[1,"work-packages-full-view--resizer","hidden-for-mobile","hide-when-print"],[3,"elementClass","localStorageKey"],[1,"toolbar-item"],[3,"workPackage","showText"],["buttonClasses","-round button_no-margin","data-qa-selector","mark-notification-read-button",1,"work-package--details-button",3,"workPackage"]],template:function(o,s){1&o&&e.YNc(0,Ba,31,17,"div",0),2&o&&e.Q6J("ngIf",s.workPackage)},directives:[I.O5,ai.n,Sa.f,Pr.W,Da.x,kr.z,Gi.a,Aa.B,ut.o,xr.G,Er.U,ja.e,Vt.UIView,Ra.H,Za.u,Fa.q],pipes:[I.Ov],encapsulation:2});var Qa=t(85603),Na=t(1813),Ja=t(73648),Rn=t(53466),Ya=t(91654),$a=t(57973),Va=t(22956),Si=t(2888),sr=t(73165),zi=t(61486),hi=t(26942),rr=t(20342),ar=t(55548);class So extends ar.n{constructor(o,s,T,j,q){super(o,s),this.elementRef=o,this.opContextMenu=s,this.I18n=T,this.wpDisplayRepresentationService=j,this.wpTableTimeline=q}open(o){this.buildItems(),this.opContextMenu.show(this,o)}get locals(){return{items:this.items,contextMenuId:"wp-view-context-menu"}}buildItems(){this.items=[],this.wpDisplayRepresentationService.current!==Si.he&&this.items.push({linkText:this.I18n.t("js.views.card"),icon:"icon-view-card",onClick:o=>(this.wpDisplayRepresentationService.setDisplayRepresentation(Si.he),this.wpTableTimeline.isVisible&&this.wpTableTimeline.toggle(),!0)}),(this.wpTableTimeline.isVisible||this.wpDisplayRepresentationService.current===Si.he)&&this.items.push({linkText:this.I18n.t("js.views.list"),icon:"icon-view-list",onClick:o=>(this.wpDisplayRepresentationService.setDisplayRepresentation(Si.M5),this.wpTableTimeline.isVisible&&this.wpTableTimeline.toggle(),!0)}),(!this.wpTableTimeline.isVisible||this.wpDisplayRepresentationService.current===Si.he)&&this.items.push({linkText:this.I18n.t("js.views.timeline"),icon:"icon-view-timeline",onClick:o=>(this.wpTableTimeline.isVisible||this.wpTableTimeline.toggle(),this.wpDisplayRepresentationService.setDisplayRepresentation(Si.M5),!0)})}}So.\u0275fac=function(o){return new(o||So)(e.Y36(e.SBq),e.Y36(rr.$),e.Y36(w.D),e.Y36(Si.ld),e.Y36(sr.W))},So.\u0275dir=e.lG2({type:So,selectors:[["","wpViewDropdown",""]],features:[e.qOj]});class Do extends hi.N{constructor(o,s,T,j){super(),this.I18n=o,this.cdRef=s,this.wpDisplayRepresentationService=T,this.wpTableTimeline=j,this.text={card:this.I18n.t("js.views.card"),list:this.I18n.t("js.views.list"),timeline:this.I18n.t("js.views.timeline")}}ngOnInit(){(0,zi.aj)([this.wpDisplayRepresentationService.live$(),this.wpTableTimeline.live$()]).pipe(this.untilDestroyed()).subscribe(([s,T])=>{this.detectView(s,T.visible),this.cdRef.detectChanges()})}detectView(o,s){o!==Si.he?this.view=s?"timeline":Si.M5:this.view=Si.he}}Do.\u0275fac=function(o){return new(o||Do)(e.Y36(w.D),e.Y36(e.sBO),e.Y36(Si.ld),e.Y36(sr.W))},Do.\u0275cmp=e.Xpm({type:Do,selectors:[["wp-view-toggle-button"]],features:[e.qOj],decls:4,vars:2,consts:[["id","wp-view-toggle-button","wpViewDropdown","",1,"button"],[3,"icon-classes"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown"]],template:function(o,s){1&o&&(e.TgZ(0,"button",0),e._UZ(1,"op-icon",1),e._UZ(2,"span",2),e._UZ(3,"op-icon",3),e.qZA()),2&o&&(e.xp6(1),e.MGl("icon-classes","button--icon icon-view-",s.view,""),e.xp6(1),e.Q6J("textContent",s.text[s.view]))},directives:[So,ut.o],encapsulation:2,changeDetection:0});var Ha=t(48451),Or=t(44210),Ka=t(84109);class Ao extends Or.S{constructor(o,s,T,j,q,fe,Be){super(s),this.$state=o,this.I18n=s,this.transitions=T,this.cdRef=j,this.states=q,this.wpTableFocus=fe,this.keepTab=Be,this.accessKey=8,this.activeState="work-packages.partitioned.list.details",this.listState="work-packages.partitioned.list",this.buttonId="work-packages-details-view-button",this.buttonClass="toolbar-icon",this.iconClass="icon-info2",this.activateLabel=s.t("js.button_open_details"),this.deactivateLabel=s.t("js.button_close_details"),this.transitionListener=this.transitions.onSuccess({},()=>{this.isActive=this.$state.includes(this.activeState),this.cdRef.detectChanges()})}ngOnDestroy(){super.ngOnDestroy(),this.transitionListener()}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}performAction(o){this.isActive?this.$state.go(this.listState):this.openDetailsView()}openListView(){}openDetailsView(){const o={workPackageId:this.wpTableFocus.focusedWorkPackage};this.keepTab.goCurrentDetailsState(o)}}function Ga(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"li"),e.TgZ(1,"button",2),e.NdJ("click",function(){return e.CHM(s),e.oxw().enableAutoZoom()}),e._UZ(2,"op-icon",3),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.Q6J("ngClass",s.getAutoZoomToggleClass()),e.uIk("title",s.text.zoomAuto)}}function za(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"li"),e.TgZ(1,"button",4),e.NdJ("click",function(){return e.CHM(s),e.oxw().updateZoomWithDelta(1)}),e._UZ(2,"op-icon",5),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.Q6J("disabled",s.isMaxLevel),e.uIk("title",s.text.zoomOut)}}function qa(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"li"),e.TgZ(1,"button",6),e.NdJ("click",function(){return e.CHM(s),e.oxw().updateZoomWithDelta(-1)}),e._UZ(2,"op-icon",7),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.Q6J("disabled",s.isMinLevel),e.uIk("title",s.text.zoomIn)}}Ao.\u0275fac=function(o){return new(o||Ao)(e.Y36(ge.StateService),e.Y36(w.D),e.Y36(ge.TransitionService),e.Y36(e.sBO),e.Y36(u.G),e.Y36(Ha.o),e.Y36(Ka.p))},Ao.\u0275cmp=e.Xpm({type:Ao,selectors:[["wp-details-view-button"]],features:[e.qOj],decls:2,vars:10,consts:[["type","button",3,"disabled","click"],[3,"icon-classes"]],template:function(o,s){1&o&&(e.TgZ(0,"button",0),e.NdJ("click",function(j){return s.performAction(j)}),e._UZ(1,"op-icon",1),e.qZA()),2&o&&(e.Gre("button ",s.buttonClass,""),e.ekj("-active",s.isActive),e.Q6J("disabled",s.disabled||!s.isToggle()&&s.isActive),e.uIk("id",s.buttonId)("title",s.label)("accesskey",s.accessKey),e.xp6(1),e.MGl("icon-classes","",s.iconClass," button--icon"))},directives:[ut.o],encapsulation:2,changeDetection:0});class jo extends Or.S{constructor(o,s,T){super(o),this.I18n=o,this.cdRef=s,this.wpTableTimeline=T,this.buttonId="work-packages-timeline-toggle-button",this.iconClass="icon-view-timeline",this.minZoomLevel="days",this.maxZoomLevel="years",this.isAutoZoom=!1,this.isMaxLevel=!1,this.isMinLevel=!1,this.activateLabel=o.t("js.timelines.button_activate"),this.deactivateLabel=o.t("js.timelines.button_deactivate"),this.text.zoomIn=o.t("js.timelines.zoom.in"),this.text.zoomOut=o.t("js.timelines.zoom.out"),this.text.zoomAuto=o.t("js.timelines.zoom.auto")}ngOnInit(){this.wpTableTimeline.live$().pipe(this.untilDestroyed()).subscribe(()=>{this.isAutoZoom=this.wpTableTimeline.isAutoZoom(),this.isActive=this.wpTableTimeline.isVisible,this.cdRef.detectChanges()}),this.wpTableTimeline.appliedZoomLevel$.values$().pipe(this.untilDestroyed()).subscribe(o=>{this.isMaxLevel=o===this.maxZoomLevel,this.isMinLevel=o===this.minZoomLevel,this.cdRef.detectChanges()})}get label(){return this.isActive?this.deactivateLabel:this.activateLabel}isToggle(){return!0}updateZoomWithDelta(o){this.wpTableTimeline.updateZoomWithDelta(o)}performAction(o){this.toggleTimeline()}toggleTimeline(){this.wpTableTimeline.toggle()}enableAutoZoom(){this.wpTableTimeline.enableAutozoom()}getAutoZoomToggleClass(){return this.isAutoZoom?"-disabled":""}}jo.\u0275fac=function(o){return new(o||jo)(e.Y36(w.D),e.Y36(e.sBO),e.Y36(sr.W))},jo.\u0275cmp=e.Xpm({type:jo,selectors:[["wp-timeline-toggle-button"]],features:[e.qOj],decls:4,vars:3,consts:[["id","work-packages-timeline-mode-selection",1,"toolbar-button-group","work-packages-timeline-toggle-button"],[4,"ngIf"],["id","work-packages-timeline-zoom-auto-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"ngClass","click"],["icon-classes","icon-zoom-auto button--icon"],["id","work-packages-timeline-zoom-out-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"disabled","click"],["icon-classes","icon-zoom-out button--icon"],["id","work-packages-timeline-zoom-in-button",1,"button","timeline-toolbar--button","toolbar-icon",3,"disabled","click"],["icon-classes","icon-zoom-in button--icon"]],template:function(o,s){1&o&&(e.TgZ(0,"ul",0),e.YNc(1,Ga,3,2,"li",1),e.YNc(2,za,3,2,"li",1),e.YNc(3,qa,3,2,"li",1),e.qZA()),2&o&&(e.xp6(1),e.Q6J("ngIf",s.isActive),e.xp6(1),e.Q6J("ngIf",s.isActive),e.xp6(1),e.Q6J("ngIf",s.isActive))},directives:[I.O5,I.mk,ut.o],styles:[".work-packages-timeline-toggle-button[_ngcontent-%COMP%]   .toolbar-button-group[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:last-child{margin-right:10px}"],changeDetection:0});var Xa=t(52025),ec=t(79174);class Ro extends ar.n{constructor(o,s,T,j){super(o,s),this.elementRef=o,this.opContextMenu=s,this.I18n=T,this.wpViewCollapsedGroups=j}open(o){this.buildItems(),this.opContextMenu.show(this,o)}get locals(){return{items:this.items,contextMenuId:"wp-group-fold-context-menu"}}buildItems(){this.items=[{disabled:this.wpViewCollapsedGroups.allGroupsAreCollapsed,linkText:this.I18n.t("js.button_collapse_all"),icon:"icon-minus2",onClick:o=>(this.wpViewCollapsedGroups.setAllGroupsCollapseStateTo(!0),!0)},{disabled:this.wpViewCollapsedGroups.allGroupsAreExpanded,linkText:this.I18n.t("js.button_expand_all"),icon:"icon-plus",onClick:o=>(this.wpViewCollapsedGroups.setAllGroupsCollapseStateTo(!1),!0)}]}}Ro.\u0275fac=function(o){return new(o||Ro)(e.Y36(e.SBq),e.Y36(rr.$),e.Y36(w.D),e.Y36(ec.q))},Ro.\u0275dir=e.lG2({type:Ro,selectors:[["","wpGroupToggleDropdown",""]],features:[e.qOj]});class Zo{}Zo.\u0275fac=function(o){return new(o||Zo)},Zo.\u0275cmp=e.Xpm({type:Zo,selectors:[["wp-fold-toggle-view-button"]],decls:4,vars:0,consts:[["id","wp-fold-toggle-button","wpGroupToggleDropdown","",1,"button"],["icon-classes","button--icon icon-outline"],[1,"button--text"],["icon-classes","button--icon icon-small icon-pulldown"]],template:function(o,s){1&o&&(e.TgZ(0,"button",0),e._UZ(1,"op-icon",1),e._UZ(2,"span",2),e._UZ(3,"op-icon",3),e.qZA())},directives:[Ro,ut.o],encapsulation:2,changeDetection:0});var tc=t(35561);function ic(f,o){if(1&f&&e._UZ(0,"op-back-button",11),2&f){const s=e.oxw();e.Q6J("customBackMethod",s.backButtonCallback)}}function nc(f,o){if(1&f&&(e.TgZ(0,"li",15),e._UZ(1,"ndc-dynamic",16),e.qZA()),2&f){const s=e.oxw().$implicit,T=e.oxw(2);e.Q6J("ngClass",s.containerClasses),e.xp6(1),e.Q6J("ndcDynamicComponent",s.component)("ndcDynamicInputs",s.inputs)("ndcDynamicInjector",T.injector)("ndcDynamicOutputs",s.outputs)}}function oc(f,o){if(1&f&&(e.ynx(0),e.YNc(1,nc,2,5,"li",14),e.BQk()),2&f){const s=o.$implicit;e.xp6(1),e.Q6J("ngIf",!s.show||s.show())}}function sc(f,o){if(1&f&&(e.TgZ(0,"ul",12),e.YNc(1,oc,2,1,"ng-container",13),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("ngForOf",s.toolbarButtonComponents)}}function rc(f,o){if(1&f&&e._UZ(0,"ndc-dynamic",17),2&f){const s=e.oxw();e.Q6J("ndcDynamicComponent",s.filterContainerDefinition.component)("ndcDynamicInputs",s.filterContainerDefinition.inputs)("ndcDynamicOutputs",s.filterContainerDefinition.outputs)("ndcDynamicInjector",s.injector)}}class Zn extends $a.r{constructor(){super(...arguments),this.toolbarButtonComponents=[{component:kr.z,inputs:{stateName$:(0,or.of)("work-packages.partitioned.list.new"),allowed:["work_packages.createWorkPackage"]}},{component:tc.P},{component:Va.U},{component:Do,containerClasses:"hidden-for-mobile"},{component:Zo,show:()=>!(!this.currentQuery||!this.currentQuery.groupBy)},{component:Ao,containerClasses:"hidden-for-mobile"},{component:jo,containerClasses:"hidden-for-mobile -no-spacing"},{component:Gi.a,containerClasses:"hidden-for-mobile"},{component:Xa.b}]}ngOnInit(){super.ngOnInit(),this.wpTableFilters.hidden.push("project"),this.text.button_settings=this.I18n.t("js.button_settings")}additionalLoadingTime(){return this.wpTableTimeline.isVisible?this.querySpace.timelineRendered.pipe((0,Rn.q)(1)).toPromise():this.querySpace.tableRendered.valuesPromise()}shouldUpdateHtmlTitle(){return"work-packages.partitioned.list"===this.$state.current.name}}Zn.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(Zn)))(s||Zn)}}(),Zn.\u0275cmp=e.Xpm({type:Zn,selectors:[["wp-view-page"]],features:[e._Bn([{provide:Le.W,useClass:ie.q},Ya.E]),e.qOj],decls:11,vars:8,consts:[[1,"work-packages-partitioned-query-space--container",3,"ngClass"],[1,"toolbar-container","-editable"],[1,"toolbar"],["class","op-back-button","linkClass","op-back-button_mobile-full-width",3,"customBackMethod",4,"ngIf"],[3,"title","inFlight","showSaveCondition","editable","onSave","onEmptySubmit"],["class","toolbar-items hide-when-print",4,"ngIf"],[1,"work-packages-partitioned-query-space--filter-area"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector",4,"ngIf"],[1,"work-packages-partitioned-page--content-container"],["data-indicator-name","table","ui-view","content-left",1,"work-packages-partitioned-page--content-left","loading-indicator--location"],["ui-view","content-right",1,"work-packages-partitioned-page--content-right"],["linkClass","op-back-button_mobile-full-width",1,"op-back-button",3,"customBackMethod"],[1,"toolbar-items","hide-when-print"],[4,"ngFor","ngForOf"],["class","toolbar-item",3,"ngClass",4,"ngIf"],[1,"toolbar-item",3,"ngClass"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicInjector","ndcDynamicOutputs"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs","ndcDynamicInjector"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.YNc(3,ic,1,1,"op-back-button",3),e.TgZ(4,"editable-toolbar-title",4),e.NdJ("onSave",function(j){return s.changeChangesFromTitle(j)})("onEmptySubmit",function(){return s.updateTitleName("")}),e.qZA(),e.YNc(5,sc,2,1,"ul",5),e.qZA(),e.qZA(),e.TgZ(6,"div",6),e.YNc(7,rc,1,4,"ndc-dynamic",7),e.qZA(),e.TgZ(8,"div",8),e._UZ(9,"div",9),e._UZ(10,"div",10),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngClass",s.currentPartition),e.xp6(3),e.Q6J("ngIf",s.backButtonCallback),e.xp6(1),e.Q6J("title",s.selectedTitle)("inFlight",s.toolbarDisabled)("showSaveCondition",s.showToolbarSaveButton)("editable",s.titleEditingEnabled),e.xp6(1),e.Q6J("ngIf",s.showToolbar),e.xp6(2),e.Q6J("ngIf",s.filterContainerDefinition))},directives:[I.mk,I.O5,J.s5,Vt.UIView,Pr.W,I.sg,g.B5,g.oc],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]{position:relative;height:100%;overflow:hidden;display:grid;grid-template-columns:1fr;grid-template-rows:auto auto minmax(200px,1fr);margin-left:-10px;padding-left:10px;width:calc(100% + 10px)}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-right-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{flex-grow:1}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{overflow:auto}.work-packages-partitioned-query-space--container.-left-only[_ngcontent-%COMP%]   wp-resizer[_ngcontent-%COMP%]{display:none}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]{display:flex;overflow:auto;scrollbar-color:transparent transparent;scrollbar-width:thin}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar{height:10px;width:10px}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover{scrollbar-color:#DDDDDD transparent}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-container[_ngcontent-%COMP%]:hover::-webkit-scrollbar-thumb{visibility:visible}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{position:relative}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%]{flex:1}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .title-container_editable[_ngcontent-%COMP%]{margin-left:-7px}@media only screen and (max-width: 679px){.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-left[_ngcontent-%COMP%], .work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .work-packages-partitioned-page--content-right[_ngcontent-%COMP%]{min-width:initial;max-width:100vw;max-height:100%}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr auto;grid-template-rows:auto auto;justify-items:start}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .op-back-button[_ngcontent-%COMP%]{grid-column:1/3;grid-row:1/2}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .title-container[_ngcontent-%COMP%]{grid-column:1/2;grid-row:2/3;overflow:hidden}.work-packages-partitioned-query-space--container[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]   .toolbar-items[_ngcontent-%COMP%]{grid-column:2/3;grid-row:2/3}}"],changeDetection:0});var ac=t(46430),cc=t(98722),lc=t(92092),dc=t(8643),pc=t(66979);const uc=function(){return["status","type"]};function hc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"edit-form",2),e.NdJ("onSaved",function(j){return e.CHM(s),e.oxw().onSaved(j)}),e.TgZ(2,"div",3),e.TgZ(3,"div",4),e._UZ(4,"wp-type-status",5),e.qZA(),e.TgZ(5,"ul",6),e.TgZ(6,"li",7),e._UZ(7,"zen-mode-toggle-button"),e.qZA(),e.TgZ(8,"li",7),e.TgZ(9,"button",8),e._UZ(10,"i",9),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(11,"wp-single-view",10),e.TgZ(12,"wp-edit-actions-bar",11),e.NdJ("onCancel",function(){return e.CHM(s),e.oxw().cancelAndBackToList()}),e.qZA(),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.Q6J("resource",s.newWorkPackage)("skippedFields",e.DdM(7,uc))("inEditMode",!0),e.xp6(3),e.Q6J("workPackage",s.newWorkPackage),e.xp6(5),e.uIk("title",s.text.button_settings),e.xp6(2),e.Q6J("workPackage",s.newWorkPackage)("showProject",s.copying)}}class Fn extends cc.H{constructor(){super(...arguments),this.successState="work-packages.show"}}Fn.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(Fn)))(s||Fn)}}(),Fn.\u0275cmp=e.Xpm({type:Fn,selectors:[["wp-copy-full-view"]],hostAttrs:[1,"work-packages-page--ui-view"],features:[e.qOj],decls:1,vars:1,consts:[["class","work-package--new-state work-packages--new work-packages--show-view toolbar-container",4,"ngIf"],[1,"work-package--new-state","work-packages--new","work-packages--show-view","toolbar-container"],[3,"resource","skippedFields","inEditMode","onSaved"],[1,"toolbar"],[1,"title-container"],[3,"workPackage"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item","hidden-for-mobile"],["id","create-wp-menu-button","wpCreateSettingsMenu","",1,"button","last","work-packages-settings-button","toolbar-icon"],[1,"button--icon","icon-show-more"],[3,"workPackage","showProject"],[3,"onCancel"]],template:function(o,s){1&o&&e.YNc(0,hc,13,8,"div",0),2&o&&e.Q6J("ngIf",s.newWorkPackage)},directives:[I.O5,ai.n,lc.E,Gi.a,dc.Y,xr.G,pc.Y],encapsulation:2,changeDetection:0});const mn="work-packages-menu-item",_c=[{name:"work-packages",parent:"optional_project",url:"/work_packages?query_id&query_props&start_onboarding_tour",redirectTo:"work-packages.partitioned.list",views:{"!$default":{component:Na.p}},data:{bodyClasses:"router--work-packages-base",menuItem:mn},params:{query_id:{type:"query",dynamic:!0},query_props:{type:"opQueryString"},start_onboarding_tour:{type:"query",squash:!0,value:void 0}}},{name:"work-packages.new",url:"/new?type&parent_id",component:Ea.v,reloadOnSearch:!1,params:{defaults:{value:null}},data:{baseRoute:"work-packages",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-full-create",menuItem:mn,successState:"work-packages.show"}},{name:"work-packages.copy",url:"/{copiedFromWorkPackageId:[0-9]+}/copy",component:Fn,reloadOnSearch:!1,data:{baseRoute:"work-packages",allowMovingInEditMode:!0,bodyClasses:"router--work-packages-full-create",menuItem:mn}},{name:"work-packages.show",url:"/{workPackageId:[0-9]+}",redirectTo:f=>{const o=f.params("to");return{state:"work-packages.show.tabs",params:Object.assign(Object.assign({},o),{tabIdentifier:"activity"})}},component:Io,data:{baseRoute:"work-packages",bodyClasses:"router--work-packages-full-view",newRoute:"work-packages.new",menuItem:mn}},{name:"work-packages.show.tabs",url:"/:tabIdentifier",component:xa.t,data:{parent:"work-packages.show",menuItem:mn}},{name:"work-packages.partitioned",component:Zn,url:"",data:{bodyClasses:""}},{name:"work-packages.partitioned.list",url:"",reloadOnSearch:!1,views:{"content-left":{component:Ja.o}},data:{bodyClasses:"router--work-packages-partitioned-split-view",menuItem:mn,partition:"-left-only"}},...(0,ac.Z)("work-packages.partitioned.list",mn,Qa.o)];class Wn{}Wn.\u0275fac=function(o){return new(o||Wn)},Wn.\u0275mod=e.oAB({type:Wn}),Wn.\u0275inj=e.cJS({imports:[[p.H,Vt.UIRouterModule.forChild({states:_c})]]});class Fi{constructor(o,s,T,j){this.I18n=o,this.injector=s,this.PathHelper=T,this.currentProjectService=j,this._searchTerm=new S.X(""),this.searchTerm$=this._searchTerm.asObservable(),this._currentTab=new S.X("work_packages"),this.currentTab$=this._currentTab.asObservable(),this._projectScope=new S.X(""),this.projectScope$=this._projectScope.asObservable(),this._tabs=new S.X([]),this.tabs$=this._tabs.asObservable(),this._resultsHidden=new S.X(!1),this.resultsHidden$=this._resultsHidden.asObservable(),this.initialize()}initialize(){const o=this.loadGonData();o&&(o.available_search_types&&this._tabs.next(o.available_search_types),o.search_term&&this._searchTerm.next(o.search_term),o.current_tab&&this._currentTab.next(o.current_tab),o.project_scope?this._projectScope.next(o.project_scope):this.currentProjectService.path||this._projectScope.next("all"))}loadGonData(){try{return window.gon.global_search}catch(o){return null}}submitSearch(){window.location.href=this.searchPath()}searchPath(){let o=this.PathHelper.staticBase;return this.currentProjectService.path&&"all"!==this.projectScope&&(o=this.currentProjectService.path),o+=`/search?${this.searchQueryParams()}`,o}set searchTerm(o){this._searchTerm.next(o)}get searchTerm(){return this._searchTerm.value}get tabs(){return this._tabs.value}get currentTab(){return this._currentTab.value}set currentTab(o){this._currentTab.next(o)}get projectScope(){return this._projectScope.value}set projectScope(o){this._projectScope.next(o)}get resultsHidden(){return this._resultsHidden.value}set resultsHidden(o){this._resultsHidden.next(o)}searchQueryParams(){let o;return o=`q=${encodeURIComponent(this.searchTerm)}`,this.currentTab.length>0&&"all"!==this.currentTab&&(o=`${o}&${this.currentTab}=1`),this.projectScope.length>0&&(o=`${o}&scope=${this.projectScope}`),o}isAfterSearch(){return jQuery("body.controller-search").length>0}}Fi.\u0275fac=function(o){return new(o||Fi)(e.LFG(w.D),e.LFG(e.zs3),e.LFG(Fe.j),e.LFG(x.R))},Fi.\u0275prov=e.Yz7({token:Fi,factory:Fi.\u0275fac});var Mr=t(74990);class Un{}Un.\u0275fac=function(o){return new(o||Un)},Un.\u0275mod=e.oAB({type:Un}),Un.\u0275inj=e.cJS({providers:[Fi],imports:[[n.H,p.H,Mr.C]]});var Fs=t(24e3),Ir=t(8158);function mc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",5),e.NdJ("click",function(j){const fe=e.CHM(s).$implicit;return e.oxw().select(j,fe)}),e.qZA()}if(2&f){const s=o.$implicit;e.Q6J("id",s.identifier)("textContent",s.title)}}function gc(f,o){if(1&f&&e._UZ(0,"enterprise-banner",6),2&f){const s=e.oxw();e.Q6J("linkMessage",s.text.upsale_link)("textMessage",s.text.upsale_text)}}class Fo extends Ve.T{constructor(o,s,T,j,q,fe){super(s,T,o),this.elementRef=o,this.locals=s,this.cdRef=T,this.widgetsService=j,this.i18n=q,this.bannerService=fe,this.text={title:this.i18n.t("js.grid.add_widget"),close_popup:this.i18n.t("js.button_close"),upsale_link:this.i18n.t("js.grid.upsale.link"),upsale_text:this.i18n.t("js.grid.upsale.text")},this.eeShowBanners=!1}ngOnInit(){super.ngOnInit(),this.eeShowBanners=this.bannerService.eeShowBanners}get selectable(){return this.eligibleWidgets.sort((o,s)=>o.title.localeCompare(s.title))}select(o,s){this.chosenWidget=s,this.closeMe(o)}trackWidgetBy(o){return o.identifier}get eligibleWidgets(){const o=this.locals.schema.widgets.allowedValues.map(s=>s.identifier);return this.widgetsService.registered.filter(s=>o.includes(s.identifier))}}Fo.\u0275fac=function(o){return new(o||Fo)(e.Y36(e.SBq),e.Y36(it.E),e.Y36(e.sBO),e.Y36(Rt),e.Y36(w.D),e.Y36(Fs.j))},Fo.\u0275cmp=e.Xpm({type:Fo,selectors:[["ng-component"]],features:[e.qOj],decls:6,vars:4,consts:[["data-indicator-name","modal",1,"op-modal","loading-indicator--location"],[3,"close"],[1,"ngdialog-body","op-modal--body"],["class","grid--addable-widget",3,"id","textContent","click",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--add-widget-ee","opReferrer","grids#add-widget",3,"linkMessage","textMessage",4,"ngIf"],[1,"grid--addable-widget",3,"id","textContent","click"],["opReferrer","grids#add-widget",1,"grid--add-widget-ee",3,"linkMessage","textMessage"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"op-modal-header",1),e.NdJ("close",function(j){return s.closeMe(j)}),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,mc,1,2,"div",3),e.YNc(5,gc,1,2,"enterprise-banner",4),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.Oqu(s.text.title),e.xp6(2),e.Q6J("ngForOf",s.selectable)("ngForTrackBy",s.trackWidgetBy),e.xp6(1),e.Q6J("ngIf",s.eeShowBanners))},directives:[L.g,I.sg,I.O5,Ir.P],encapsulation:2});class Ni{constructor(o){this.layout=o}down(o,s){const T=[];let j=this.layout.widgetAreas.slice(0);for(s&&(j=j.filter(q=>q.guid!==s.guid)),j.sort((q,fe)=>fe.startRow-q.startRow);null!==o;)T.push(o),j=j.filter(q=>q.guid!==o.guid),o=this.moveOneDown(T,j)}moveOneDown(o,s){const T=this.firstAreaToMove(o,s);if(T){const j=T[0],q=T[1],fe=j.widget.height;return j.startRow=q.endRow,j.endRow=j.startRow+fe,this.layout.numRows<j.endRow-1&&(this.layout.numRows=j.endRow-1),j}return null}firstAreaToMove(o,s){let T=null,j=null;if(s.forEach(q=>{o.forEach(fe=>{fe.overlaps(q)&&(T=fe,j=q)})}),null!==j){let q=T;return o.forEach(fe=>{fe.endRow>q.endRow&&j.columnOverlaps(fe)&&(q=fe)}),[j,q]}return null}}Ni.\u0275fac=function(o){return new(o||Ni)(e.LFG(F))},Ni.\u0275prov=e.Yz7({token:Ni,factory:Ni.\u0275fac});var Sr=t(8095),qi=t(83720);class Ji{constructor(o,s){this.layout=o,this.move=s,this.setupMousedOverAreaSubscription()}ngOnDestroy(){this.mousedOverAreaObserver.unsubscribe()}setupMousedOverAreaSubscription(){this.mousedOverAreaObserver=this.layout.$mousedOverArea.pipe((0,Sr.p)(10),(0,qi.x)(),(0,wi.h)(o=>this.currentlyDragging&&!!o&&!this.layout.isGap(o)&&(this.placeholderArea.startRow!==o.startRow||this.placeholderArea.startColumn!==o.startColumn))).subscribe(o=>{this.updateArea(o),this.layout.scrollPlaceholderIntoView()})}updateArea(o){this.layout.resetAreas(this.draggedArea),this.moveAreasOnDragging(o)}moveAreasOnDragging(o){if(!this.placeholderArea)return;const s=this.draggedArea;this.copyPositionButRestrict(o,this.placeholderArea),this.move.down(this.placeholderArea,s)}get currentlyDragging(){return!!this.draggedArea}isDropOnlyArea(o){return!this.currentlyDragging&&o.endRow===this.layout.numRows+2}isDragged(o){return this.currentlyDragging&&this.draggedArea.guid===o.guid}isPassive(o){return this.currentlyDragging&&!this.isDragged(o)}get isDraggable(){return this.layout.isEditable}start(o){this.placeholderArea=new b(o.widget),this.draggedHeight=document.getElementById(o.guid).offsetHeight-2,this.draggedArea=o}abort(){document.dispatchEvent(new Event("mouseup")),this.draggedArea=null,this.placeholderArea=null,this.layout.resetAreas()}drop(){!this.draggedArea||(this.placeholderArea.copyDimensionsTo(this.draggedArea),this.draggedArea.unchangedSize||(this.layout.writeAreaChangesToWidgets(),this.layout.cleanupUnusedAreas(),this.layout.rebuildAndPersist()),this.draggedArea=null,this.placeholderArea=null)}copyPositionButRestrict(o,s){s.startRow=o.startRow,o.startRow===this.layout.numRows+1?s.endRow=this.layout.numRows+2:o.startRow+s.widget.height>this.layout.numRows+1?s.endRow=this.layout.numRows+1:s.endRow=o.startRow+s.widget.height,s.startColumn=o.startColumn,o.startColumn+s.widget.width>this.layout.numColumns+1?s.endColumn=this.layout.numColumns+1:s.endColumn=o.startColumn+s.widget.width}}Ji.\u0275fac=function(o){return new(o||Ji)(e.LFG(F),e.LFG(Ni))},Ji.\u0275prov=e.Yz7({token:Ji,factory:Ji.\u0275fac});class Xi{constructor(o,s,T){this.layout=o,this.move=s,this.drag=T}end(o){!this.resizedArea||(this.resizedArea=null,!o.unchangedSize&&(this.layout.writeAreaChangesToWidgets(),this.layout.cleanupUnusedAreas(),this.layout.rebuildAndPersist()))}abort(){this.resizedArea&&(this.layout.resetAreas(),this.resizedArea=null)}start(o){this.resizedArea=o;const s=this.layout.gridAreas.filter(T=>{const j=T.startRow===this.resizedArea.startRow&&T.startColumn>=this.resizedArea.startColumn,q=T.startRow>this.resizedArea.startRow&&T.startColumn>=this.resizedArea.startColumn&&this.layout.widgetAreas.some(fe=>fe.startRow===T.startRow&&(fe.endColumn<=this.resizedArea.startColumn||fe.startColumn>=T.endColumn));return j||q});this.targetIds=s.map(T=>T.guid)}moving(){!this.resizedArea||!this.layout.mousedOverArea||!this.targetIds.includes(this.layout.mousedOverArea.guid)||(this.layout.resetAreas(),this.resizedArea.endRow=this.layout.mousedOverArea.endRow,this.resizedArea.endColumn=this.layout.mousedOverArea.endColumn,this.move.down(this.resizedArea,this.resizedArea))}isTarget(o){const s=o.guid;return this.resizedArea&&this.targetIds.includes(s)}isResized(o){return this.resizedArea&&this.resizedArea.guid===o.guid}isPassive(o){return this.currentlyResizing&&!this.isResized(o)}get currentlyResizing(){return!!this.resizedArea}get isResizable(){return!this.drag.currentlyDragging&&this.isAllowed}get isAllowed(){return this.layout.gridResource.updateImmediately}}Xi.\u0275fac=function(o){return new(o||Xi)(e.LFG(F),e.LFG(Ni),e.LFG(Ji))},Xi.\u0275prov=e.Yz7({token:Xi,factory:Xi.\u0275fac});class en{constructor(o,s,T,j,q,fe,Be,Ye){this.opModalService=o,this.injector=s,this.halResource=T,this.layout=j,this.drag=q,this.move=fe,this.resize=Be,this.i18n=Ye,this.text={add:this.i18n.t("js.grid.add_widget")}}isAddable(o){return!this.drag.currentlyDragging&&!this.resize.currentlyResizing&&(this.layout.mousedOverArea===o||this.layout.isSingleCell||this.layout.inHelpMode)&&this.isAllowed}widget(o){this.select(o).then(s=>{this.layout.isGap(o)&&this.addLine(o);const T=new b(s);this.setMaxWidth(T),this.persist(T)}).catch(()=>{})}get addText(){return this.text.add}select(o){return new Promise((s,T)=>{this.opModalService.show(Fo,this.injector,{schema:this.layout.schema}).closingEvent.subscribe(q=>{const fe=q.chosenWidget;if(!fe)return void T();const Be={_type:"GridWidget",identifier:fe.identifier,startRow:o.startRow,endRow:o.endRow,startColumn:o.startColumn,endColumn:o.endColumn,options:fe.properties||{}},Ye=this.halResource.createHalResource(Be);Ye.grid=this.layout.gridResource,s(Ye)})})}addLine(o){o.isRow?this.layout.addRow(o.startRow-1,o.startColumn):o.isColumn&&this.layout.addColumn(o.startColumn-1,o.startRow)}setMaxWidth(o){o.endColumn=this.layout.numColumns+1,this.layout.widgetAreas.forEach(s=>{o.startColumnOverlaps(s)&&(o.endColumn=s.startColumn)})}persist(o){o.writeAreaChangeToWidget(),this.layout.widgetAreas.push(o),this.layout.widgetResources.push(o.widget),this.layout.rebuildAndPersist()}get isAllowed(){return this.layout.gridResource&&this.layout.gridResource.updateImmediately}}en.\u0275fac=function(o){return new(o||en)(e.LFG(it.S),e.LFG(e.zs3),e.LFG(xt.u),e.LFG(F),e.LFG(Ji),e.LFG(Ni),e.LFG(Xi),e.LFG(w.D))},en.\u0275prov=e.Yz7({token:en,factory:en.\u0275fac});class gn{constructor(o,s,T,j,q,fe,Be,Ye,at){this.gridInitialization=o,this.pathHelper=s,this.currentProject=T,this.i18n=j,this.cdRef=q,this.title=fe,this.addWidget=Be,this.renderer=Ye,this.areas=at,this.text={title:this.i18n.t(`js.${this.i18nNamespace()}.label`),html_title:this.i18n.t(`js.${this.i18nNamespace()}.label`)}}ngOnInit(){this.renderer.addClass(document.body,"widget-grid-layout"),this.gridInitialization.initialize(this.gridScopePath()).then(o=>{this.grid=o,this.cdRef.detectChanges()}),this.setHtmlTitle()}ngOnDestroy(){this.renderer.removeClass(document.body,"widget-grid-layout")}setHtmlTitle(){this.title.setTitle(this.text.html_title)}}gn.\u0275fac=function(o){return new(o||gn)(e.Y36(Et),e.Y36(Fe.j),e.Y36(x.R),e.Y36(w.D),e.Y36(e.sBO),e.Y36(i.Dx),e.Y36(en),e.Y36(e.Qsj),e.Y36(F))},gn.\u0275dir=e.lG2({type:gn});t(46384);var Dr=t(83609);function fc(f,o){if(1&f&&e._UZ(0,"span",10),2&f){const s=e.oxw(2);e.Q6J("hidden",s.isMobileDevice)}}function vc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"resizer",11),e.NdJ("end",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw().resize.end(j)})("start",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw().resize.start(j)})("move",function(){return e.CHM(s),e.oxw(2).resize.moving()}),e.TgZ(1,"div",12),e._UZ(2,"i",13),e.qZA(),e.qZA()}2&f&&e.Q6J("customHandler",!0)}const Cc=function(f,o,s){return{"-dragged":f,"-passive":o,"-resizing":s}};function yc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",5),e.TgZ(1,"div",6),e.NdJ("cdkDragStarted",function(){const q=e.CHM(s).$implicit;return e.oxw().drag.start(q)})("cdkDragDropped",function(){return e.CHM(s),e.oxw().drag.drop()}),e.YNc(2,fc,1,1,"span",7),e._UZ(3,"ndc-dynamic",8),e.qZA(),e.YNc(4,vc,3,1,"resizer",9),e.qZA()}if(2&f){const s=o.$implicit,T=e.oxw();e.Udp("grid-row-start",s.gridStartRow)("grid-row-end",s.gridEndRow)("grid-column-start",s.gridStartColumn)("grid-column-end",s.gridEndColumn),e.Q6J("ngClass",e.kEZ(18,Cc,T.drag.isDragged(s),T.drag.isPassive(s)||T.resize.isPassive(s),T.resize.isResized(s)))("id",s.guid)("cdkDropListData",s)("cdkDropListConnectedTo",T.layout.gridAreaIds),e.xp6(1),e.Q6J("cdkDragDisabled",T.isMobileDevice||!T.drag.isDraggable),e.xp6(1),e.Q6J("ngIf",T.drag.isDraggable),e.xp6(1),e.Q6J("ndcDynamicComponent",T.widgetComponent(s))("ndcDynamicInputs",T.widgetComponentInput(s))("ndcDynamicOutputs",T.widgetComponentOutput(s)),e.xp6(1),e.Q6J("ngIf",T.resize.isResizable)}}function bc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",16),e.NdJ("click",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw().add.widget(j)}),e.qZA()}if(2&f){const s=e.oxw(2);e.Q6J("title",s.add.addText)}}const wc=function(f,o,s,T,j){return{"-drop-target":f,"-drop-only":o,"-resize-target":s,"-addable":T,"-help-mode":j}};function Tc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",14),e.NdJ("mouseover",function(){const q=e.CHM(s).$implicit;return e.oxw().layout.setMousedOverArea(q)}),e.YNc(1,bc,1,1,"div",15),e.qZA()}if(2&f){const s=o.$implicit,T=e.oxw();e.Udp("grid-row-start",s.gridStartRow)("grid-row-end",s.gridEndRow)("grid-column-start",s.gridStartColumn)("grid-column-end",s.gridEndColumn),e.Q6J("ngClass",e.qbA(13,wc,T.drag.currentlyDragging,T.drag.isDropOnlyArea(s),T.resize.isTarget(s),T.add.isAddable(s),T.layout.inHelpMode))("id",s.guid)("cdkDropListData",s)("cdkDropListConnectedTo",T.layout.gridAreaIds),e.xp6(1),e.Q6J("ngIf",T.add.isAllowed)}}function Pc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",19),e.NdJ("click",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw().add.widget(j)}),e.qZA()}if(2&f){const s=e.oxw(2);e.Q6J("title",s.add.addText)}}const kc=function(f,o,s,T){return{"-addable":f,"-help-mode":o,"-row":s,"-column":T}};function xc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",17),e.NdJ("mouseover",function(){const q=e.CHM(s).$implicit;return e.oxw().layout.setMousedOverArea(q)}),e.YNc(1,Pc,1,1,"div",18),e.qZA()}if(2&f){const s=o.$implicit,T=e.oxw();e.Udp("grid-row-start",s.gridStartRow)("grid-row-end",s.gridEndRow)("grid-column-start",s.gridStartColumn)("grid-column-end",s.gridEndColumn),e.Q6J("ngClass",e.l5B(11,kc,T.add.isAddable(s),T.layout.inHelpMode,s.isRow,s.isColumn))("id",s.guid),e.xp6(1),e.Q6J("ngIf",T.add.isAllowed)}}function Ec(f,o){if(1&f&&(e.TgZ(0,"div",20),e._UZ(1,"div",21),e.qZA()),2&f){const s=e.oxw();e.Udp("grid-row-start",s.drag.placeholderArea.gridStartRow)("grid-row-end",s.drag.placeholderArea.gridEndRow)("grid-column-start",s.drag.placeholderArea.gridStartColumn)("grid-column-end",s.drag.placeholderArea.gridEndColumn)("min-height",s.drag.draggedHeight,"px")}}const cr=[F,Ni,Ji,Xi,en,_e];class fn{constructor(o,s,T,j,q,fe,Be,Ye){this.sanitization=o,this.widgetsService=s,this.drag=T,this.resize=j,this.layout=q,this.add=fe,this.remove=Be,this.browserDetector=Ye,this.uiWidgets=[],this.GRID_AREA_HEIGHT="auto",this.GRID_GAP_DIMENSION="20px",this.component=ni}ngOnInit(){this.layout.gridResource=this.grid}ngOnDestroy(){this.uiWidgets.forEach(o=>o.destroy())}handleKeyboardEvent(o){"Escape"!==o.key||(this.drag.currentlyDragging?this.drag.abort():this.resize.currentlyResizing&&this.resize.abort())}widgetComponent(o){const{widget:s}=o;if(!s)return null;const T=this.widgetsService.registered.find(j=>j.identifier===s.identifier);return T?T.component:null}widgetComponentInput(o){return{resource:o.widget}}widgetComponentOutput(o){return{resourceChanged:this.layout.saveWidgetChangeset.bind(this.layout)}}get gridColumnStyle(){return this.gridStyle(this.layout.numColumns,`calc((100% - ${this.GRID_GAP_DIMENSION} * ${this.layout.numColumns+1}) / ${this.layout.numColumns})`)}get gridRowStyle(){return this.gridStyle(this.layout.numRows,this.GRID_AREA_HEIGHT)}identifyGridArea(o,s){return s.guid}get isHeadersDisplayed(){return this.layout.isEditable}get isMobileDevice(){return this.browserDetector.isMobile}gridStyle(o,s){let T="";for(let j=0;j<o;j++)T+=`${this.GRID_GAP_DIMENSION} ${s} `;return T+=`${this.GRID_GAP_DIMENSION}`,this.sanitization.bypassSecurityTrustStyle(T)}}fn.\u0275fac=function(o){return new(o||fn)(e.Y36(i.H7),e.Y36(Rt),e.Y36(Ji),e.Y36(Xi),e.Y36(F),e.Y36(en),e.Y36(_e),e.Y36(vt.o))},fn.\u0275cmp=e.Xpm({type:fn,selectors:[["grid"]],hostBindings:function(o,s){1&o&&e.NdJ("keyup",function(j){return s.handleKeyboardEvent(j)},!1,e.Jf7)},inputs:{grid:"grid"},decls:5,vars:11,consts:[[1,"grid--container"],["class","grid--area -widgeted","cdkDropList","",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","cdkDropListData","cdkDropListConnectedTo",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area hidden-for-mobile","cdkDropList","",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","cdkDropListData","cdkDropListConnectedTo","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area -gap hidden-for-mobile",3,"ngClass","grid-row-start","grid-row-end","grid-column-start","grid-column-end","id","mouseover",4,"ngFor","ngForOf","ngForTrackBy"],["class","grid--area -widgeted -placeholder",3,"grid-row-start","grid-row-end","grid-column-start","grid-column-end","min-height",4,"ngIf"],["cdkDropList","",1,"grid--area","-widgeted",3,"ngClass","id","cdkDropListData","cdkDropListConnectedTo"],["cdkDrag","",1,"grid--area-content","widget-box",3,"cdkDragDisabled","cdkDragStarted","cdkDragDropped"],["class","grid--area-drag-handle\n                   icon\n                   icon-drag-handle\n                   hidden-for-mobile","cdkDragHandle","",3,"hidden",4,"ngIf"],[3,"ndcDynamicComponent","ndcDynamicInputs","ndcDynamicOutputs"],[3,"customHandler","end","start","move",4,"ngIf"],["cdkDragHandle","",1,"grid--area-drag-handle","icon","icon-drag-handle","hidden-for-mobile",3,"hidden"],[3,"customHandler","end","start","move"],[1,"grid--resizer"],["aria-hidden","true",1,"icon-resizer-bottom-right","hidden-for-mobile"],["cdkDropList","",1,"grid--area","hidden-for-mobile",3,"ngClass","id","cdkDropListData","cdkDropListConnectedTo","mouseover"],["class","grid--widget-add",3,"title","click",4,"ngIf"],[1,"grid--widget-add",3,"title","click"],[1,"grid--area","-gap","hidden-for-mobile",3,"ngClass","id","mouseover"],["class","grid--widget-add -gap",3,"title","click",4,"ngIf"],[1,"grid--widget-add","-gap",3,"title","click"],[1,"grid--area","-widgeted","-placeholder"],[1,"widget-box"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.YNc(1,yc,5,22,"div",1),e.YNc(2,Tc,2,19,"div",2),e.YNc(3,xc,2,16,"div",3),e.YNc(4,Ec,2,10,"div",4),e.qZA()),2&o&&(e.Udp("grid-template-columns",s.gridColumnStyle)("grid-template-rows",s.gridRowStyle),e.xp6(1),e.Q6J("ngForOf",s.layout.widgetAreas)("ngForTrackBy",s.identifyGridArea),e.xp6(1),e.Q6J("ngForOf",s.layout.gridAreas)("ngForTrackBy",s.identifyGridArea),e.xp6(1),e.Q6J("ngForOf",s.layout.gridGaps)("ngForTrackBy",s.identifyGridArea),e.xp6(1),e.Q6J("ngIf",s.drag.placeholderArea))},directives:[I.sg,I.O5,E.Wj,I.mk,E.Zt,g.B5,g.oc,E.Bh,Dr.d],encapsulation:2});const Oc=function(f){return{"-active":f}};function Mc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(s),e.oxw().areas.toggleHelpMode()}),e._UZ(1,"op-icon",10),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("title",s.addWidget.addText)("ngClass",e.VKq(2,Oc,s.areas.inHelpMode))}}function Ic(f,o){if(1&f&&e._UZ(0,"grid",11),2&f){const s=e.oxw();e.Q6J("grid",s.grid)}}class Ln extends gn{i18nNamespace(){return"dashboards"}gridScopePath(){return this.pathHelper.projectDashboardsPath(this.currentProject.identifier)}}Ln.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(Ln)))(s||Ln)}}(),Ln.\u0275cmp=e.Xpm({type:Ln,selectors:[["dashboard"]],features:[e._Bn(cr),e.qOj],decls:10,vars:3,consts:[[1,"op-grid-page"],[1,"toolbar","op-grid-page--toolbar-container"],[1,"op-grid-page--title-container","title-container"],[3,"textContent"],[1,"op-grid-page--toolbar-items","toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"h2",3),e.qZA(),e.TgZ(4,"ul",4),e.TgZ(5,"li",5),e._UZ(6,"zen-mode-toggle-button"),e.qZA(),e.TgZ(7,"li",6),e.YNc(8,Mc,2,4,"button",7),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,Ic,1,1,"grid",8),e.qZA()),2&o&&(e.xp6(3),e.Q6J("textContent",s.text.title),e.xp6(5),e.Q6J("ngIf",s.addWidget.isAllowed),e.xp6(1),e.Q6J("ngIf",s.grid))},directives:[Gi.a,I.O5,I.mk,ut.o,fn],styles:[".op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.op-grid-page--toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.op-grid-page--toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width: 679px){.op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Sc=[{name:"dashboards",parent:"optional_project",url:"/dashboards/",data:{bodyClasses:["router--dashboards-view-base","widget-grid-layout"],menuItem:"dashboards-menu-item"},component:Ln}];class Bn{}Bn.\u0275fac=function(o){return new(o||Bn)},Bn.\u0275mod=e.oAB({type:Bn}),Bn.\u0275inj=e.cJS({providers:[],imports:[[n.H,Qi,Vt.UIRouterModule.forChild({states:Sc,config:function(f){f.urlService.rules.when(new RegExp("^/projects/(.*)/dashboards$"),o=>`/projects/${o[1]}/dashboards/`)}})]]});var Ac=t(37409);function jc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"wp-single-card",2),e.NdJ("stateLinkClicked",function(j){return e.CHM(s),e.oxw().openStateLink(j)}),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.Q6J("workPackage",s.workPackage)}}class Wo extends Ve.T{constructor(o,s,T,j,q,fe,Be){super(s,T,o),this.elementRef=o,this.locals=s,this.cdRef=T,this.i18n=j,this.apiV3Service=q,this.opModalService=fe,this.$state=Be,this.text={created_by:this.i18n.t("js.label_created_by")}}ngOnInit(){super.ngOnInit();const{workPackageLink:o}=this.locals,s=(0,Ee.Z)(o);this.apiV3Service.work_packages.id(s).requireAndStream().subscribe(T=>{this.workPackage=T,this.cdRef.detectChanges();const j=jQuery(this.elementRef.nativeElement).find(".op-wp-preview-modal");this.reposition(j,this.locals.event.target)})}reposition(o,s){o.position({my:"right top",at:"right bottom",of:s,collision:"flipfit"})}openStateLink(o){const s={workPackageId:o.workPackageId};this.$state.go(o.requestedState,s)}}Wo.\u0275fac=function(o){return new(o||Wo)(e.Y36(e.SBq),e.Y36(it.E),e.Y36(e.sBO),e.Y36(w.D),e.Y36(O.T),e.Y36(it.S),e.Y36(ge.StateService))},Wo.\u0275cmp=e.Xpm({type:Wo,selectors:[["ng-component"]],features:[e.qOj],decls:1,vars:1,consts:[["class","op-wp-preview-modal","wp-isolated-query-space","",4,"ngIf"],["wp-isolated-query-space","",1,"op-wp-preview-modal"],["orientation","horizontal",3,"workPackage","stateLinkClicked"]],template:function(o,s){1&o&&e.YNc(0,jc,2,1,"div",0),2&o&&e.Q6J("ngIf",s.workPackage)},directives:[I.O5,Ce.A,Ac.P],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-wp-preview-modal[_ngcontent-%COMP%]{position:absolute;z-index:5000;min-width:350px;padding:0;box-shadow:0 0 5px 2px #00000040;pointer-events:all}"],changeDetection:0});class Qn{constructor(o,s,T){this.opModalService=o,this.ngZone=s,this.injector=T,this.mouseInModal=!1}setupListener(){jQuery(document.body).on("mouseover",".preview-trigger",o=>{o.preventDefault(),o.stopPropagation();const s=jQuery(o.target),T=s.attr("href");!T||(this.previewModal=this.opModalService.show(Wo,this.injector,{workPackageLink:T,event:o},!0),this.modalElement=this.previewModal.elementRef.nativeElement,this.previewModal.reposition(jQuery(this.modalElement),s))}),jQuery(document.body).on("mouseleave",".preview-trigger",()=>{this.closeAfterTimeout()}),jQuery(document.body).on("mouseleave",".op-wp-preview-modal",()=>{this.mouseInModal=!1,this.closeAfterTimeout()}),jQuery(document.body).on("mouseenter",".op-wp-preview-modal",()=>{this.mouseInModal=!0})}closeAfterTimeout(){this.ngZone.runOutsideAngular(()=>{setTimeout(()=>{this.mouseInModal||this.opModalService.close()},100)})}isMouseOverPreview(o){if(!this.modalElement)return!1;const s=jQuery(this.modalElement.children[0]);if(s&&s.offset()){const T=o.pageX>=Math.floor(s.offset().left)&&o.pageX<s.offset().left+s.width(),j=o.pageY>=Math.floor(s.offset().top)&&o.pageY<s.offset().top+s.height();return T&&j}return!1}}Qn.\u0275fac=function(o){return new(o||Qn)(e.LFG(it.S),e.LFG(e.R0b),e.LFG(e.zs3))},Qn.\u0275prov=e.Yz7({token:Qn,factory:Qn.\u0275fac,providedIn:"root"});const Rc=function(f){return{"-active":f}};function Zc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(s),e.oxw().areas.toggleHelpMode()}),e._UZ(1,"op-icon",10),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("title",s.addWidget.addText)("ngClass",e.VKq(2,Rc,s.areas.inHelpMode))}}function Fc(f,o){if(1&f&&e._UZ(0,"grid",11),2&f){const s=e.oxw();e.Q6J("grid",s.grid)}}class Nn extends gn{i18nNamespace(){return"overviews"}gridScopePath(){return this.pathHelper.projectPath(this.currentProject.identifier)}}Nn.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(Nn)))(s||Nn)}}(),Nn.\u0275cmp=e.Xpm({type:Nn,selectors:[["overview"]],features:[e._Bn(cr),e.qOj],decls:10,vars:3,consts:[[1,"op-grid-page"],[1,"toolbar","op-grid-page--toolbar-container"],[1,"op-grid-page--title-container","title-container"],[3,"textContent"],[1,"op-grid-page--toolbar-items","toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"h2",3),e.qZA(),e.TgZ(4,"ul",4),e.TgZ(5,"li",5),e._UZ(6,"zen-mode-toggle-button"),e.qZA(),e.TgZ(7,"li",6),e.YNc(8,Zc,2,4,"button",7),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,Fc,1,1,"grid",8),e.qZA()),2&o&&(e.xp6(3),e.Q6J("textContent",s.text.title),e.xp6(5),e.Q6J("ngIf",s.addWidget.isAllowed),e.xp6(1),e.Q6J("ngIf",s.grid))},directives:[Gi.a,I.O5,I.mk,ut.o,fn],styles:[".op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.op-grid-page--toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.op-grid-page--toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width: 679px){.op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Wc=[{name:"overview",parent:"optional_project",url:"/",data:{menuItem:"overview-menu-item"},component:Nn}];class Jn{}Jn.\u0275fac=function(o){return new(o||Jn)},Jn.\u0275mod=e.oAB({type:Jn}),Jn.\u0275inj=e.cJS({providers:[],imports:[[n.H,Qi,Vt.UIRouterModule.forChild({states:Wc,config:function(f){f.urlService.rules.when(new RegExp("^/projects(?!/new$)/([^/]+)$"),o=>`/projects/${o[1]}/`)}})]]});const Lc=function(f){return{"-active":f}};function Bc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(s),e.oxw().areas.toggleHelpMode()}),e._UZ(1,"op-icon",10),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("title",s.addWidget.addText)("ngClass",e.VKq(2,Lc,s.areas.inHelpMode))}}function Qc(f,o){if(1&f&&e._UZ(0,"grid",11),2&f){const s=e.oxw();e.Q6J("grid",s.grid)}}class Yn extends gn{i18nNamespace(){return"my_page"}gridScopePath(){return this.pathHelper.myPagePath()}}Yn.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(Yn)))(s||Yn)}}(),Yn.\u0275cmp=e.Xpm({type:Yn,selectors:[["ng-component"]],features:[e._Bn(cr),e.qOj],decls:10,vars:3,consts:[[1,"op-grid-page"],[1,"toolbar","op-grid-page--toolbar-container"],[1,"op-grid-page--title-container","title-container"],[3,"textContent"],[1,"op-grid-page--toolbar-items","toolbar-items","hidden-for-mobile"],[1,"toolbar-item","hidden-for-mobile"],[1,"toolbar-item"],["class","button",3,"title","ngClass","click",4,"ngIf"],[3,"grid",4,"ngIf"],[1,"button",3,"title","ngClass","click"],["icon-classes","button--icon icon-add"],[3,"grid"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"h2",3),e.qZA(),e.TgZ(4,"ul",4),e.TgZ(5,"li",5),e._UZ(6,"zen-mode-toggle-button"),e.qZA(),e.TgZ(7,"li",6),e.YNc(8,Bc,2,4,"button",7),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,Qc,1,1,"grid",8),e.qZA()),2&o&&(e.xp6(3),e.Q6J("textContent",s.text.title),e.xp6(5),e.Q6J("ngIf",s.addWidget.isAllowed),e.xp6(1),e.Q6J("ngIf",s.grid))},directives:[Gi.a,I.O5,I.mk,ut.o,fn],styles:[".op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:-5px}.op-grid-page--toolbar-container[_ngcontent-%COMP%]{margin-bottom:0}.op-grid-page--toolbar-items[_ngcontent-%COMP%]{padding-right:20px}@media only screen and (max-width: 679px){.op-grid-page--title-container[_ngcontent-%COMP%]{margin-left:0;margin-bottom:0}}"]});const Nc=[{name:"my_page",url:"/my/page",component:Yn,data:{bodyClasses:["router--work-packages-my-page","widget-grid-layout"],parent:"work-packages"}}];class $n{}$n.\u0275fac=function(o){return new(o||$n)},$n.\u0275mod=e.oAB({type:$n}),$n.\u0275inj=e.cJS({imports:[[n.H,Qi,y.K,Vt.UIRouterModule.forChild({states:Nc})]]});var Jc=t(71718),Ar=t(7101);const Yc={preview:1,newWorkPackage:2,edit:3,quickSearch:4,projectSearch:5,help:6,moreMenu:7,details:8};class Vn{constructor(o,s,T){this.PathHelper=o,this.FocusHelper=s,this.currentProject=T,this.shortcuts={"?":()=>this.showHelpModal(),"g m":this.globalAction("myPagePath"),"g o":this.projectScoped("projectPath"),"g w p":this.projectScoped("projectWorkPackagesPath"),"g w i":this.projectScoped("projectWikiPath"),"g a":this.projectScoped("projectActivityPath"),"g c":this.projectScoped("projectCalendarPath"),"g n":this.projectScoped("projectNewsPath"),"n w p":this.projectScoped("projectWorkPackageNewPath"),"g e":this.accessKey("edit"),"g p":this.accessKey("preview"),"d w p":this.accessKey("details"),m:this.accessKey("moreMenu"),p:this.accessKey("projectSearch"),s:this.accessKey("quickSearch"),k:()=>this.focusPrevItem(),j:()=>this.focusNextItem()},this.register()}register(){_.each(this.shortcuts,(o,s)=>Mousetrap.bind(s,o))}accessKey(o){const s=Yc[o];return()=>{const T=jQuery(`[accesskey=${s}]:first`);T.is("input")||"global-search-input"===T.attr("id")?setTimeout(()=>this.FocusHelper.focus(T),200):T.is("[href]")?this.clickLink(T[0]):T[0].click()}}globalAction(o){return()=>{window.location.href=this.PathHelper[o]()}}projectScoped(o){return()=>{const s=this.currentProject.identifier;s&&(window.location.href=this.PathHelper[o](s))}}clickLink(o){const s=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});!o.dispatchEvent(s)||(window.location.href=o.href)}showHelpModal(){window.open(this.PathHelper.keyboardShortcutsHelpPath())}focusItemOffset(o){const s=document.querySelector("table.keyboard-accessible-list");if(!s)return;const T=Array.from(s.querySelectorAll("tbody > tr"));let j;if(document.activeElement){j=T.indexOf(document.activeElement);const q=T[j+o];null==q||q.focus()}}focusNextItem(){this.focusItemOffset(1)}focusPrevItem(){this.focusItemOffset(-1)}}Vn.\u0275fac=function(o){return new(o||Vn)(e.LFG(Fe.j),e.LFG(Ar.i),e.LFG(x.R))},Vn.\u0275prov=e.Yz7({token:Vn,factory:Vn.\u0275fac,providedIn:"root"});var lr=t(36868);class Hn{}Hn.\u0275fac=function(o){return new(o||Hn)},Hn.\u0275mod=e.oAB({type:Hn}),Hn.\u0275inj=e.cJS({imports:[[n.H,lr.A0]]});var Vc=t(55280),Kn=t(3352);class vn{constructor(o){this.documentElement=o}loadRequiredScripts(){const o=this.documentElement.querySelectorAll('meta[name="required_script"]');for(let s=0;s<o.length;++s){const T=o[s].content;(0,Kn.qu)(`Loading required script ${T}`),t(37294)(`./${T}`)}}}vn.\u0275fac=function(o){return new(o||vn)(e.LFG(I.K0))},vn.\u0275prov=e.Yz7({token:vn,factory:vn.\u0275fac,providedIn:"root"});class Gn{constructor(o,s){o.setupListener(),s.loadRequiredScripts()}}Gn.\u0275fac=function(o){return new(o||Gn)(e.LFG(Vc.v),e.LFG(vn))},Gn.\u0275mod=e.oAB({type:Gn}),Gn.\u0275inj=e.cJS({providers:[vn],imports:[[y.K]]});var Hc=t(32775);class Cn{constructor(o,s){this.injector=o,this.i18n=s,window.navigator.userAgent.search("Revit")>-1&&(this.labelText=s.t("js.revit.revit_add_in_settings"),this.groupLabelText=s.t("js.revit.revit_add_in"),this.addUserMenuItem(),this.addLoginMenuItem())}addUserMenuItem(){const o=document.getElementById("user-menu");if(o){const s=document.createElement("li");s.dataset.name=this.labelText,s.innerHTML=`\n        <a class="revit-addin-settings-menu-item ellipsis" title="${this.labelText}" href="#">\n          <span class="menu-item--title ellipsis ">${this.labelText}</span>\n        </a>\n      `,s.addEventListener("click",()=>this.goToSettings()),o.appendChild(s)}}addLoginMenuItem(){const o=document.querySelector("#nav-login-content");if(o){const s=document.createElement("div");s.dataset.name=this.labelText,s.innerHTML=`\n        <div class="login-auth-providers">\n          <h3 class="login-auth-providers-title">\n            <span>\n              ${this.groupLabelText}\n            </span>\n           </h3>\n          <div class="login-auth-provider-list revit-add-in-button">\n            <div class="auth-provider auth-provider-developer button">\n              <span class="auth-provider-name">${this.labelText}</span>\n            </div>\n          </div>\n        </div>\n      `,o.appendChild(s),o.querySelector(".revit-add-in-button").addEventListener("click",()=>this.goToSettings())}}goToSettings(){window.RevitBridge.sendMessageToRevit("GoToSettings","1","")}}Cn.\u0275fac=function(o){return new(o||Cn)(e.LFG(e.zs3),e.LFG(w.D))},Cn.\u0275prov=e.Yz7({token:Cn,factory:Cn.\u0275fac});var dr=t(76825),yn=t(14808),mi=t(53882);class Oi{constructor(o,s,T,j){this.I18n=o,this.http=s,this.pathHelper=T,this.toastService=j,this.userData$=(0,yn.qH)(),this.modalOpen=!1,this.cancelled=!1,this.emailInvalid=!1,this.text={invalid_email:this.I18n.t("js.admin.enterprise.trial.form.invalid_email"),taken_email:this.I18n.t("js.admin.enterprise.trial.form.taken_email"),taken_domain:this.I18n.t("js.admin.enterprise.trial.form.taken_domain")};const{gon:q}=window;this.baseUrlAugur=q.augur_url,this.tokenVersion=q.token_version,window.gon.ee_trial_key&&this.setMailSubmittedStatus()}sendForm(o){const s=Object.assign(Object.assign({},o.value),{token_version:this.tokenVersion});this.http.post(`${this.baseUrlAugur}/public/v1/trials`,s).toPromise().then(T=>{this.userData$.putValue(o.value),this.cancelled=!1,this.trialLink=T._links.self.href,this.saveTrialKey(this.trialLink),this.retryConfirmation()}).catch(T=>{422===T.status||400===T.status?this.error=T:this.toastService.addWarning(T.error.description||I18n.t("js.error.internal"))})}getToken(){this.http.get(this.trialLink).toPromise().then(o=>(0,se.mG)(this,void 0,void 0,function*(){this.confirmed=!0,o.token_retrieved||(yield this.saveToken(o.token))})).catch(o=>{422===o.status&&"waiting_for_email_verification"===o.error.identifier?(this.resendLink=o.error._links.resend.href,(!this.status||this.cancelled)&&this.saveTrialKey(this.resendLink),this.setMailSubmittedStatus(),this.confirmed=!1):"Error"===_.get(o,"error._type")?this.toastService.addError(o.error.message):this.toastService.addError(o.error||I18n.t("js.error.internal"))})}saveTrialKey(o){const s=o.split("/")[6];return this.http.post(`${this.pathHelper.appBasePath}/admin/enterprise/save_trial_key`,{trial_key:s},{withCredentials:!0}).toPromise().catch(T=>{this.toastService.addError(T.error.message||T.message||T)})}saveToken(o){return this.http.post(`${this.pathHelper.appBasePath}/admin/enterprise`,{enterprise_token:{encoded_token:o}},{withCredentials:!0}).toPromise().then(()=>{this.modalOpen||setTimeout(()=>{window.location.reload()},500)}).catch(s=>{this.http.delete(`${this.pathHelper.api.v3.apiV3Base}/admin/enterprise/delete_trial_key`,{withCredentials:!0}).toPromise(),this.toastService.addError(s.error.description||I18n.t("js.error.internal"))})}retryConfirmation(o=5e3,s=60){this.cancelled||this.confirmed||(0===s?this.cancelled=!0:(this.getToken(),setTimeout(()=>{this.retryConfirmation(o,s-1)},o)))}setStartTrialStatus(){this.status="startTrial"}setMailSubmittedStatus(){this.status="mailSubmitted"}get trialStarted(){return"startTrial"===this.status}get mailSubmitted(){return"mailSubmitted"===this.status}get domainTaken(){return!!this.error&&"domain_taken"===this.error.error.identifier}get emailTaken(){return!!this.error&&"user_already_created_trial"===this.error.error.identifier}get emailError(){return!!this.emailInvalid||!!this.error&&this.emailTaken}get errorMsg(){let o="";return this.emailInvalid?o=this.text.invalid_email:this.domainTaken?o=this.text.taken_domain:this.emailTaken&&(o=this.text.taken_email),o}}Oi.\u0275fac=function(o){return new(o||Oi)(e.LFG(w.D),e.LFG(mi.eN),e.LFG(Fe.j),e.LFG(M.kl))},Oi.\u0275prov=e.Yz7({token:Oi,factory:Oi.\u0275fac});class zn{}zn.\u0275fac=function(o){return new(o||zn)},zn.\u0275mod=e.oAB({type:zn}),zn.\u0275inj=e.cJS({providers:[Oi],imports:[[n.H,y.K,c.u5,c.UX]]});class Yi{constructor(){this.navigationEvents$=new S.X("")}onActivate(...o){return this.navigationEvents$.pipe((0,wi.h)(s=>-1!==o.indexOf(s)),(0,Rn.q)(1))}recreateToggler(){const o=this;jQuery("#main-menu .toggler").remove();const s=jQuery('<a class="toggler" href="#"><i class="icon6 icon-toggler icon-arrow-right3" aria-hidden="true"></i><span class="hidden-for-sighted"></span></a>').on("click",function(){const T=jQuery(this);if(T.hasClass("toggler")){jQuery("#sidebar").toggleClass("-hidden",!0),jQuery(".menu_root li").removeClass("open"),jQuery(".menu_root").removeClass("open").addClass("closed");const j=T.closest("li");j.addClass("open").find("li > a:first, .tree-menu--title:first").first().focus(),o.navigationEvents$.next(j.data("name"))}return!1});return s.attr("title",I18n.t("js.project_menu_details")),s}wrapMainItem(){const o=jQuery("#main-menu li > a").not("ul ul a");o.wrap(s=>{const j=o[s].id,q=jQuery('<div class="main-item-wrapper"/>');return j&&q.attr("id",`${j}-wrapper`),q})}register(){this.wrapMainItem();const o=document.querySelector(".tree-menu--item.-selected")||document.querySelector(".main-item-wrapper a.selected");null==o||o.scrollIntoView();const s=this.recreateToggler(),T=jQuery("#main-menu .menu_root > li.open").data("name"),j=jQuery("#main-menu .menu_root.open > li").data("name");function q(fe){fe.preventDefault();const Be=jQuery(this);jQuery(Be).parents("li").first().removeClass("open"),jQuery(".menu_root").removeClass("closed").addClass("open"),Be.parents("li").first().find(".toggler").first().focus(),jQuery("#sidebar").toggleClass("-hidden",!1)}(T||j)&&this.navigationEvents$.next(T||j),jQuery("#main-menu li:has(ul) .main-item-wrapper > a").not("ul ul a").unbind("click").wrapInner('<span class="ellipsis"/>').after(s),jQuery("#main-menu ul.main-menu--children").each((fe,Be)=>{const Ye=jQuery(Be).parents("li").find(".main-item-wrapper .op-menu--item-title").contents()[0].textContent,at=jQuery(Be).parents("li").find(".main-item-wrapper > a").attr("href"),At=jQuery('<div class="main-menu--children-menu-header"></div>'),Ot=jQuery('<a class="main-menu--arrow-left-to-project" href="#"><i class="icon-arrow-left1" aria-hidden="true"></i></a>'),zt=jQuery(`<a href="${at}" class="main-menu--parent-node ellipsis">${Ye}</a>`);Ot.attr("title",I18n.t("js.label_up")),Ot.on("click",q),At.append(Ot),At.append(zt),jQuery(Be).before(At)}),jQuery(".menu_root").hasClass("closed")&&jQuery("#sidebar").toggleClass("-hidden",!0)}}Yi.\u0275fac=function(o){return new(o||Yi)},Yi.\u0275prov=e.Yz7({token:Yi,factory:Yi.\u0275fac,providedIn:"root"});var Kc=t(68853),Gc=t(82267),Ws=t(82503);class bn extends Fs.j{constructor(o,s,T){super(o),this.documentElement=o,this.confirmDialog=s,this.I18n=T}showEEOnlyHint(){this.confirmDialog.confirm({text:{title:this.I18n.t("js.types.attribute_groups.upgrade_to_ee"),text:this.I18n.t("js.types.attribute_groups.upgrade_to_ee_text"),button_continue:this.I18n.t("js.types.attribute_groups.more_information"),button_cancel:this.I18n.t("js.types.attribute_groups.nevermind")}}).then(()=>{window.location.href="https://www.openproject.org/enterprise-edition/?utm_source=unknown&utm_medium=community-edition&utm_campaign=form-configuration"}).catch(()=>{})}}function zc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",2),e.NdJ("click",function(){return e.CHM(s),e.oxw().startEditing()}),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("textContent",s.name)}}function qc(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"input",3,4),e.NdJ("ngModelChange",function(j){e.CHM(s);return e.oxw().editedName=j})("blur",function(j){return e.CHM(s),e.oxw().saveEdition(j)})("keydown.escape",function(){return e.CHM(s),e.oxw().reset()})("keydown.enter",function(j){return e.CHM(s),e.oxw().saveEdition(j)}),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("ngModel",s.editedName),e.uIk("placeholder",s.placeholder)}}bn.\u0275fac=function(o){return new(o||bn)(e.LFG(I.K0),e.LFG(_t.D),e.LFG(w.D))},bn.\u0275prov=e.Yz7({token:bn,factory:bn.\u0275fac});class qn{constructor(o,s){this.bannerService=o,this.cdRef=s,this.placeholder="",this.onValueChange=new e.vpe,this.editing=!1}ngOnInit(){this.editedName=this.name,(!this.name||0===this.name.length)&&this.startEditing()}startEditing(){this.bannerService.conditional(()=>this.bannerService.showEEOnlyHint(),()=>{this.editing=!0})}saveEdition(o){return this.leaveEditingMode(),this.name=this.editedName.trim(),this.cdRef.detectChanges(),""!==this.name&&this.onValueChange.emit(this.name),o.preventDefault(),o.stopPropagation(),!1}reset(){this.editing=!1,this.editedName=this.name}leaveEditingMode(){null!=this.editedName&&this.editedName.trim().length>0&&(this.editing=!1)}}function Xc(f,o){if(1&f&&e._UZ(0,"span",12),2&f){const s=e.oxw(2);e.Q6J("textContent",s.text.custom_field)}}function el(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",7),e._UZ(1,"span",8),e.TgZ(2,"span",9),e._uU(3),e.YNc(4,Xc,1,1,"span",10),e.qZA(),e.TgZ(5,"span",11),e.NdJ("click",function(){const q=e.CHM(s).$implicit;return e.oxw().removeFromGroup(q)}),e.qZA(),e.qZA()}if(2&f){const s=o.$implicit;e.uIk("data-key",s.key),e.xp6(3),e.hij(" ",s.translation," "),e.xp6(1),e.Q6J("ngIf",s.is_cf)}}qn.\u0275fac=function(o){return new(o||qn)(e.Y36(bn),e.Y36(e.sBO))},qn.\u0275cmp=e.Xpm({type:qn,selectors:[["op-group-edit-in-place"]],inputs:{placeholder:"placeholder",name:"name"},outputs:{onValueChange:"onValueChange"},decls:2,vars:2,consts:[["class","group-edit-handler",3,"textContent","click",4,"ngIf"],["class","group-edit-in-place--input","type","text","opAutofocus","",3,"ngModel","ngModelChange","blur","keydown.escape","keydown.enter",4,"ngIf"],[1,"group-edit-handler",3,"textContent","click"],["type","text","opAutofocus","",1,"group-edit-in-place--input",3,"ngModel","ngModelChange","blur","keydown.escape","keydown.enter"],["nameInput",""]],template:function(o,s){1&o&&(e.YNc(0,zc,1,1,"div",0),e.YNc(1,qc,2,2,"input",1)),2&o&&(e.Q6J("ngIf",!s.editing),e.xp6(1),e.Q6J("ngIf",s.editing))},directives:[I.O5,c.Fj,Er.U,c.JJ,c.On],encapsulation:2,changeDetection:0});class Uo{constructor(o,s){this.I18n=o,this.cdRef=s,this.deleteGroup=new e.vpe,this.removeAttribute=new e.vpe,this.text={custom_field:this.I18n.t("js.admin.type_form.custom_field")}}rename(o){this.group.name=o,delete this.group.key,this.cdRef.detectChanges()}removeFromGroup(o){this.group.attributes=this.group.attributes.filter(s=>s!==o),this.removeAttribute.emit(o)}}Uo.\u0275fac=function(o){return new(o||Uo)(e.Y36(w.D),e.Y36(e.sBO))},Uo.\u0275cmp=e.Xpm({type:Uo,selectors:[["op-type-form-attribute-group"]],inputs:{group:"group"},outputs:{deleteGroup:"deleteGroup",removeAttribute:"removeAttribute"},decls:7,vars:3,consts:[[1,"type-form-conf-group"],[1,"group-head"],[1,"group-handle","icon-drag-handle"],[1,"group-name",3,"name","onValueChange"],[1,"delete-group","icon-small","icon-close",3,"click"],["dragula","attributes",1,"attributes",3,"dragulaModel","dragulaModelChange"],["class","type-form-conf-attribute",4,"ngFor","ngForOf"],[1,"type-form-conf-attribute"],[1,"attribute-handle","icon-drag-handle"],[1,"attribute-name"],["class","attribute-cf-label",3,"textContent",4,"ngIf"],[1,"delete-attribute","icon-small","icon-close",3,"click"],[1,"attribute-cf-label",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"span",2),e.TgZ(3,"op-group-edit-in-place",3),e.NdJ("onValueChange",function(j){return s.rename(j)}),e.qZA(),e.TgZ(4,"span",4),e.NdJ("click",function(){return s.deleteGroup.emit()}),e.qZA(),e.qZA(),e.TgZ(5,"div",5),e.NdJ("dragulaModelChange",function(j){return s.group.attributes=j}),e.YNc(6,el,6,3,"div",6),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("name",s.group.name),e.xp6(2),e.Q6J("dragulaModel",s.group.attributes),e.xp6(1),e.Q6J("ngForOf",s.group.attributes))},directives:[qn,Ws.sW,I.sg,I.O5],encapsulation:2,changeDetection:0});var jr=t(74961),Rr=t(35900),Lo=t(84032),tl=t(57597);function il(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"op-type-form-attribute-group",25),e.NdJ("removeAttribute",function(j){return e.CHM(s),e.oxw(2).deactivateAttribute(j)})("deleteGroup",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw().deleteGroup(j)}),e.qZA()}if(2&f){const s=e.oxw().$implicit;e.Q6J("group",s)}}function nl(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"op-type-form-query-group",26),e.NdJ("editQuery",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw().editQuery(j)})("deleteGroup",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw().deleteGroup(j)}),e.qZA()}if(2&f){const s=e.oxw().$implicit;e.Q6J("group",s)}}function ol(f,o){if(1&f&&(e.ynx(0),e.YNc(1,il,1,1,"op-type-form-attribute-group",23),e.YNc(2,nl,1,1,"op-type-form-query-group",24),e.BQk()),2&f){const s=o.$implicit;e.xp6(1),e.Q6J("ngIf","attribute"===s.type),e.xp6(1),e.Q6J("ngIf","query"===s.type)}}function sl(f,o){if(1&f&&e._UZ(0,"span",31),2&f){const s=e.oxw(2);e.Q6J("textContent",s.text.custom_field)}}function rl(f,o){if(1&f&&(e.TgZ(0,"div",27),e._UZ(1,"span",28),e.TgZ(2,"span",29),e._uU(3),e.YNc(4,sl,1,1,"span",30),e.qZA(),e.qZA()),2&f){const s=o.$implicit;e.uIk("data-key",s.key),e.xp6(3),e.hij(" ",s.translation," "),e.xp6(1),e.Q6J("ngIf",s.is_cf)}}const Zr="__empty";class Xn extends hi.N{constructor(o,s,T,j,q,fe,Be){super(),this.elementRef=o,this.I18n=s,this.Gon=T,this.dragula=j,this.confirmDialog=q,this.toastService=fe,this.externalRelationQuery=Be,this.text={drag_to_activate:this.I18n.t("js.admin.type_form.drag_to_activate"),reset:this.I18n.t("js.admin.type_form.reset_to_defaults"),label_group:this.I18n.t("js.label_group"),new_group:this.I18n.t("js.admin.type_form.new_group"),label_inactive:this.I18n.t("js.admin.type_form.inactive"),custom_field:this.I18n.t("js.admin.type_form.custom_field"),add_group:this.I18n.t("js.admin.type_form.add_group"),add_table:this.I18n.t("js.admin.type_form.add_table")},this.groups=[],this.inactives=[]}ngOnInit(){this.element=this.elementRef.nativeElement,this.no_filter_query=this.element.dataset.noFilterQuery,this.form=jQuery(this.element).closest("form"),this.submit=this.form.find(".form-configuration--save");let o=!1;this.form.on("submit",()=>{o=!0}),this.submit.on("mousedown",()=>(setTimeout(()=>{o||this.form.trigger("submit")},50),!0)),this.form.on("submit.typeformupdater",()=>(this.updateHiddenFields(),!0)),this.groupsDrake=this.dragula.createGroup("groups",{moves:(T,j,q)=>q.classList.contains("group-handle")}).drake,this.attributeDrake=this.dragula.createGroup("attributes",{moves:(T,j,q)=>q.classList.contains("attribute-handle")}).drake,this.groups=JSON.parse(this.element.dataset.activeGroups).filter(T=>(null==T?void 0:T.key)!==Zr),this.inactives=JSON.parse(this.element.dataset.inactiveAttributes);const s=this;this.autoscroll=new Rr.x([document.getElementById("content-wrapper")],{margin:25,maxSpeed:10,scrollWhenOutside:!0,autoScroll(){const T=s.groupsDrake&&s.groupsDrake.dragging,j=s.attributeDrake&&s.attributeDrake.dragging;return T||j}})}ngAfterViewInit(){const o=jQuery(this.elementRef.nativeElement).find(".toolbar-items");(0,tl.o)(o)}deactivateAttribute(o){this.updateInactives(this.inactives.concat(o))}addGroupAndOpenQuery(){const o=this.createGroup("query");this.editQuery(o)}editQuery(o){const s={"display-settings":I18n.t("js.work_packages.table_configuration.embedded_tab_disabled"),timelines:I18n.t("js.work_packages.table_configuration.embedded_tab_disabled")};this.externalRelationQuery.show({currentQuery:JSON.parse(o.query),callback:T=>o.query=JSON.stringify(T),disabledTabs:s})}deleteGroup(o){return"attribute"===o.type&&this.updateInactives(this.inactives.concat(o.attributes)),this.groups=this.groups.filter(s=>s!==o),o}createGroup(o,s=""){const T={type:o,name:s,key:null,query:this.no_filter_query,attributes:[]};return this.groups.unshift(T),T}resetToDefault(o){return this.confirmDialog.confirm({text:{title:this.I18n.t("js.types.attribute_groups.reset_title"),text:this.I18n.t("js.types.attribute_groups.confirm_reset"),button_continue:this.I18n.t("js.label_reset")}}).then(()=>{this.form.find("input#type_attribute_groups").val(JSON.stringify([])),this.form.off("submit.typeformupdater"),this.form.trigger("submit")}).catch(()=>{}),o.preventDefault(),!1}updateInactives(o){this.inactives=[...o].sort((s,T)=>s.translation.localeCompare(T.translation))}get emptyGroup(){return{type:"attribute",key:Zr,name:"empty",attributes:[]}}updateHiddenFields(){const o=this.form.find(".admin-type-form--hidden-field");0===this.groups.length?o.val(JSON.stringify([this.emptyGroup])):o.val(JSON.stringify(this.groups))}}Xn.\u0275fac=function(o){return new(o||Xn)(e.Y36(e.SBq),e.Y36(w.D),e.Y36(Lo.U),e.Y36(Ws.pQ),e.Y36(_t.D),e.Y36(M.kl),e.Y36(jr.Q))},Xn.\u0275cmp=e.Xpm({type:Xn,selectors:[["admin-type-form-configuration"]],features:[e._Bn([bn]),e.qOj],decls:29,vars:10,consts:[[1,"toolbar-container","-with-dropdown"],[1,"toolbar","toolbar_empty-title"],[1,"toolbar-items"],[1,"toolbar-item"],["type","button -alt-highlight",1,"form-configuration--reset","button",3,"click"],["icon-classes","button--icon icon-undo"],[1,"button--text",3,"textContent"],[1,"toolbar-item","drop-down"],["aria-haspopup","true",1,"form-configuration--add-group","button","-alt-highlight"],["icon-classes","button--icon icon-add"],["icon-classes","button--dropdown-indicator"],[1,"menu-drop-down-container"],["type","button",1,"menu-item","form-configuration--add-group",3,"textContent","click"],[1,"grid-block","wrap"],[1,"grid-content","small-12","medium-6"],["id","draggable-groups","dragula","groups",3,"dragulaModel","dragulaModelChange"],[4,"ngFor","ngForOf"],["id","type-form-conf-inactive-group"],[1,"group-head"],[1,"group-name",3,"textContent"],[1,"advice",3,"textContent"],["dragula","attributes",1,"attributes",3,"dragulaModel","dragulaModelChange"],["class","type-form-conf-attribute",4,"ngFor","ngForOf"],[3,"group","removeAttribute","deleteGroup",4,"ngIf"],[3,"group","editQuery","deleteGroup",4,"ngIf"],[3,"group","removeAttribute","deleteGroup"],[3,"group","editQuery","deleteGroup"],[1,"type-form-conf-attribute"],[1,"attribute-handle","icon-drag-handle"],[1,"attribute-name"],["class","attribute-cf-label",3,"textContent",4,"ngIf"],[1,"attribute-cf-label",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"ul",2),e.TgZ(3,"li",3),e.TgZ(4,"button",4),e.NdJ("click",function(j){return s.resetToDefault(j)}),e._UZ(5,"op-icon",5),e._UZ(6,"span",6),e.qZA(),e.qZA(),e.TgZ(7,"li",7),e.TgZ(8,"a",8),e._UZ(9,"op-icon",9),e._UZ(10,"span",6),e._UZ(11,"op-icon",10),e.qZA(),e.TgZ(12,"ul",11),e.TgZ(13,"li"),e.TgZ(14,"button",12),e.NdJ("click",function(){return s.createGroup("attribute","")}),e.qZA(),e.qZA(),e.TgZ(15,"li"),e.TgZ(16,"button",12),e.NdJ("click",function(){return s.addGroupAndOpenQuery()}),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(17,"div",13),e.TgZ(18,"div",14),e.TgZ(19,"div",15),e.NdJ("dragulaModelChange",function(j){return s.groups=j}),e.YNc(20,ol,3,2,"ng-container",16),e.qZA(),e.qZA(),e.TgZ(21,"div",14),e.TgZ(22,"div",17),e.TgZ(23,"div",18),e._UZ(24,"span",19),e._uU(25," "),e._UZ(26,"span",20),e.qZA(),e.TgZ(27,"div",21),e.NdJ("dragulaModelChange",function(j){return s.inactives=j}),e.YNc(28,rl,5,3,"div",22),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(6),e.Q6J("textContent",s.text.reset),e.xp6(4),e.Q6J("textContent",s.text.label_group),e.xp6(4),e.Q6J("textContent",s.text.add_group),e.xp6(2),e.Q6J("textContent",s.text.add_table),e.xp6(3),e.Q6J("dragulaModel",s.groups),e.xp6(1),e.Q6J("ngForOf",s.groups),e.xp6(4),e.Q6J("textContent",s.text.label_inactive),e.xp6(2),e.Q6J("textContent",s.text.drag_to_activate),e.xp6(1),e.Q6J("dragulaModel",s.inactives),e.xp6(1),e.Q6J("ngForOf",s.inactives))},encapsulation:2});class Bo{constructor(o,s){this.I18n=o,this.cdRef=s,this.text={edit_query:this.I18n.t("js.admin.type_form.edit_query")},this.editQuery=new e.vpe,this.deleteGroup=new e.vpe}rename(o){this.group.name=o,this.cdRef.detectChanges()}}Bo.\u0275fac=function(o){return new(o||Bo)(e.Y36(w.D),e.Y36(e.sBO))},Bo.\u0275cmp=e.Xpm({type:Bo,selectors:[["op-type-form-query-group"]],inputs:{group:"group"},outputs:{editQuery:"editQuery",deleteGroup:"deleteGroup"},decls:9,vars:2,consts:[[1,"type-form-conf-group","type-form-query-group"],[1,"group-head"],[1,"group-handle","icon-drag-handle"],[1,"group-name",3,"name","onValueChange"],[1,"delete-group","icon-small","icon-close",3,"click"],[1,"type-form-query"],[1,"type-form-query-group--edit-button",3,"click"],["icon-classes","button--icon icon-edit"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"span",2),e.TgZ(3,"op-group-edit-in-place",3),e.NdJ("onValueChange",function(j){return s.rename(j)}),e.qZA(),e.TgZ(4,"span",4),e.NdJ("click",function(){return s.deleteGroup.emit()}),e.qZA(),e.qZA(),e.TgZ(5,"div",5),e.TgZ(6,"span",6),e.NdJ("click",function(){return s.editQuery.emit()}),e._UZ(7,"op-icon",7),e._uU(8),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("name",s.group.name),e.xp6(5),e.hij(" ",s.text.edit_query," "))},directives:[qn,ut.o],encapsulation:2,changeDetection:0});class eo{}eo.\u0275fac=function(o){return new(o||eo)},eo.\u0275mod=e.oAB({type:eo}),eo.\u0275inj=e.cJS({providers:[],imports:[[Ws.qE.forRoot(),n.H]]}),e.B6R(Xn,[ut.o,Ws.sW,I.sg,I.O5,Uo,Bo],[]);var cl=t(6496),Us=t(58004);let wn=class{constructor(o){this.elementRef=o,this.initialLoadingIndicator=!0}};wn.\u0275fac=function(o){return new(o||wn)(e.Y36(e.SBq))},wn.\u0275cmp=e.Xpm({type:wn,selectors:[["wp-embedded-table-entry"]],inputs:{queryProps:"queryProps",configuration:"configuration",initialLoadingIndicator:"initialLoadingIndicator"},decls:2,vars:3,consts:[["wp-isolated-query-space",""],[3,"queryProps","initialLoadingIndicator","configuration"]],template:function(o,s){1&o&&(e.ynx(0,0),e._UZ(1,"wp-embedded-table",1),e.BQk()),2&o&&(e.xp6(1),e.Q6J("queryProps",s.queryProps)("initialLoadingIndicator",s.initialLoadingIndicator)("configuration",s.configuration))},directives:[Ce.A,pi.Z],encapsulation:2}),wn=(0,se.gn)([Us.z,(0,se.w6)("design:paramtypes",[e.SBq])],wn);class Qo{constructor(o){this.elementRef=o,this.configuration={actionsColumnEnabled:!1,columnMenuEnabled:!1,contextMenuEnabled:!1}}ngOnInit(){const o=this.elementRef.nativeElement;this.queryProps=JSON.parse(o.dataset.queryProps)}}Qo.\u0275fac=function(o){return new(o||Qo)(e.Y36(e.SBq))},Qo.\u0275cmp=e.Xpm({type:Qo,selectors:[["macro",8,"embedded-table"]],attrs:["class","embedded-table"],decls:1,vars:2,consts:[[3,"queryProps","configuration"]],template:function(o,s){1&o&&e._UZ(0,"wp-embedded-table-entry",0),2&o&&e.Q6J("queryProps",s.queryProps)("configuration",s.configuration)},directives:[wn],encapsulation:2});var Fr=t(87064),pr=t(78001),pl=t(80639);function ul(f,o){if(1&f&&e._UZ(0,"wp-embedded-table",1),2&f){const s=e.oxw();e.Q6J("queryProps",s.queryProps)("configuration",s.tableConfiguration)}}class to extends hi.N{constructor(o,s,T,j,q,fe,Be,Ye,at,At,Ot){super(),this.FocusHelper=o,this.elementRef=s,this.renderer=T,this.I18n=j,this.halResourceService=q,this.globalSearchService=fe,this.wpTableFilters=Be,this.querySpace=Ye,this.wpFilters=at,this.cdRef=At,this.UrlParamsHelper=Ot,this.resultsHidden=!1,this.tableConfiguration={actionsColumnEnabled:!1,columnMenuEnabled:!0,contextMenuEnabled:!1,inlineCreateEnabled:!1,withFilters:!0,showFilterButton:!0,filterButtonText:this.I18n.t("js.button_advanced_filter")}}ngAfterViewInit(){(0,zi.aj)([this.globalSearchService.searchTerm$,this.globalSearchService.projectScope$]).pipe((0,Ri.T)(1),(0,qi.x)(),(0,pl.b)(10),this.untilDestroyed()).subscribe(([])=>{this.wpFilters.visible=!1,this.setQueryProps()}),this.globalSearchService.resultsHidden$.pipe(this.untilDestroyed()).subscribe(o=>this.resultsHidden=o)}ngOnInit(){this.setQueryProps()}setQueryProps(){const o=[];let s=["id","project","subject","type","status","updatedAt"];this.globalSearchService.searchTerm.length>0&&o.push({search:{operator:"**",values:[this.globalSearchService.searchTerm]}}),"current_project"===this.globalSearchService.projectScope&&(o.push({subprojectId:{operator:"!*",values:[]}}),s=["id","subject","type","status","updatedAt"]),""===this.globalSearchService.projectScope&&o.push({subprojectId:{operator:"*",values:[]}}),this.queryProps={"columns[]":s,filters:JSON.stringify(o),sortBy:JSON.stringify([["updatedAt","desc"]]),showHierarchies:!1}}}to.\u0275fac=function(o){return new(o||to)(e.Y36(Ar.i),e.Y36(e.SBq),e.Y36(e.Qsj),e.Y36(w.D),e.Y36(xt.u),e.Y36(Fi),e.Y36(ui.Z),e.Y36(di.q),e.Y36(Ui.U),e.Y36(e.sBO),e.Y36(oi.Z))},to.\u0275cmp=e.Xpm({type:to,selectors:[["global-search-work-packages"]],features:[e.qOj],decls:1,vars:1,consts:[[3,"queryProps","configuration",4,"ngIf"],[3,"queryProps","configuration"]],template:function(o,s){1&o&&e.YNc(0,ul,1,2,"wp-embedded-table",0),2&o&&e.Q6J("ngIf",!s.resultsHidden)},directives:[I.O5,pi.Z],encapsulation:2});var _l=t(90547);function ml(f,o){if(1&f&&e._UZ(0,"option",6),2&f){const s=o.$implicit;e.Q6J("textContent",s.label)("ngValue",s)}}function gl(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"span",7),e.TgZ(1,"op-single-date-picker",8),e.NdJ("changed",function(j){return e.CHM(s),e.oxw().updateField(j)}),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.Q6J("id",s.fieldId+"_visible")("name",s.fieldId+"_input")("initialDate",s.fieldValue)}}class No{constructor(o,s,T,j){this.elementRef=o,this.cdRef=s,this.appRef=T,this.I18n=j,this.valueVisible=!1,this.onKey="on",this.currentKey="current",this.currentFieldValue="%CURRENT_DATE%",this.operators=[{key:this.onKey,label:this.I18n.t("js.custom_actions.date.specific")},{key:this.currentKey,label:this.I18n.t("js.custom_actions.date.current_date")}]}ngOnInit(){const o=this.elementRef.nativeElement;this.fieldName=o.dataset.fieldName,this.fieldValue=o.dataset.fieldValue,this.fieldValue===this.currentFieldValue?this.selectedOperator=this.operators[1]:(this.selectedOperator=this.operators[0],this.visibleValue=this.fieldValue),this.toggleValueVisibility()}toggleValueVisibility(){this.valueVisible=this.selectedOperator.key===this.onKey,this.fieldValue===this.currentFieldValue&&(this.fieldValue=""),this.updateDbValue()}updateDbValue(){this.selectedOperator.key===this.currentKey&&(this.fieldValue=this.currentFieldValue)}get fieldId(){return this.fieldName.replace(/\[|\]/g,"_").replace("__","_").replace(/_$/,"")}updateField(o){this.fieldValue=o,this.cdRef.detectChanges()}}No.\u0275fac=function(o){return new(o||No)(e.Y36(e.SBq),e.Y36(e.sBO),e.Y36(e.z2F),e.Y36(w.D))},No.\u0275cmp=e.Xpm({type:No,selectors:[["custom-date-action-admin"]],decls:6,vars:6,consts:[[1,"form--field-container"],[1,"form--select-container"],[1,"form--select",3,"ngModel","ngModelChange","change"],[3,"textContent","ngValue",4,"ngFor","ngForOf"],["class","form--text-field-container -slim",4,"ngIf"],["type","hidden",3,"name","value"],[3,"textContent","ngValue"],[1,"form--text-field-container","-slim"],["classes","form--text-field",3,"id","name","initialDate","changed"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"span",1),e.TgZ(2,"select",2),e.NdJ("ngModelChange",function(j){return s.selectedOperator=j})("change",function(){return s.toggleValueVisibility()}),e.YNc(3,ml,1,2,"option",3),e.qZA(),e.qZA(),e.YNc(4,gl,2,3,"span",4),e._UZ(5,"input",5),e.qZA()),2&o&&(e.xp6(2),e.Q6J("ngModel",s.selectedOperator),e.uIk("id",s.fieldId),e.xp6(1),e.Q6J("ngForOf",s.operators),e.xp6(1),e.Q6J("ngIf",s.valueVisible),e.xp6(1),e.Q6J("name",s.fieldName)("value",s.fieldValue))},directives:[c.EJ,c.JJ,c.On,I.sg,I.O5,c.YN,c.Kr,_l.S],encapsulation:2});var vl=t(3216),Di=t(33927),io=t(96905),Cl=t(56945);function yl(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",function(){return e.CHM(s),e.oxw().toggleCollapsed()}),e._UZ(1,"span",6),e._uU(2),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.Q6J("ngClass",s.collapsed?"icon-arrow-down1":"icon-arrow-up1"),e.xp6(1),e.hij(" ",s.title,"\n")}}function bl(f,o){if(1&f&&(e.TgZ(0,"div",7),e._uU(1),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.hij(" ",s.title,"\n")}}function wl(f,o){if(1&f&&e._UZ(0,"op-sidemenu",12),2&f){const s=e.oxw().$implicit;e.Q6J("title",s.title)("items",s.children)("collapsible",s.collapsible)}}function Tl(f,o){1&f&&e.GkF(0)}const Wr=function(f){return{"op-sidemenu--item-action_with_icon":f}},Ur=function(f){return{item:f}};function Pl(f,o){if(1&f&&(e.TgZ(0,"a",13),e.YNc(1,Tl,1,0,"ng-container",14),e.qZA()),2&f){const s=e.oxw().$implicit;e.oxw();const T=e.MAs(5);e.Tol(e.VKq(8,Wr,!!s.icon)),e.Q6J("uiSref",s.uiSref)("uiParams",s.uiParams)("uiOptions",s.uiOptions),e.uIk("data-qa-selector","op-sidemenu--item-action--"+s.title.split(" ").join("")),e.xp6(1),e.Q6J("ngTemplateOutlet",T)("ngTemplateOutletContext",e.VKq(10,Ur,s))}}function kl(f,o){1&f&&e.GkF(0)}function xl(f,o){if(1&f&&(e.TgZ(0,"a",15),e.YNc(1,kl,1,0,"ng-container",14),e.qZA()),2&f){const s=e.oxw().$implicit;e.oxw();const T=e.MAs(5);e.Tol(e.VKq(6,Wr,!!s.icon)),e.Q6J("href",s.href,e.LSH),e.uIk("data-qa-selector","op-sidemenu--item-action--"+s.title.split(" ").join("")),e.xp6(1),e.Q6J("ngTemplateOutlet",T)("ngTemplateOutletContext",e.VKq(8,Ur,s))}}function El(f,o){if(1&f&&(e.TgZ(0,"li",8),e.YNc(1,wl,1,3,"op-sidemenu",9),e.YNc(2,Pl,2,12,"a",10),e.YNc(3,xl,2,10,"a",11),e.qZA()),2&f){const s=o.$implicit;e.xp6(1),e.Q6J("ngIf",s.children&&s.children.length),e.xp6(1),e.Q6J("ngIf",!s.children&&s.uiSref),e.xp6(1),e.Q6J("ngIf",!s.children&&s.href)}}function Ol(f,o){if(1&f&&e._UZ(0,"span",19),2&f){const s=e.oxw().item;e.Tol("icon-"+s.icon)}}function Ml(f,o){if(1&f&&(e.TgZ(0,"span",20),e._uU(1),e.qZA()),2&f){const s=e.oxw().item;e.xp6(1),e.Oqu(s.count)}}function Il(f,o){if(1&f&&(e.YNc(0,Ol,1,2,"span",16),e.TgZ(1,"span",17),e._uU(2),e.qZA(),e.YNc(3,Ml,2,1,"span",18)),2&f){const s=o.item;e.Q6J("ngIf",s.icon),e.xp6(2),e.Oqu(s.title),e.xp6(1),e.Q6J("ngIf",s.count)}}const Sl=function(f,o){return{"op-sidemenu--items_collapsed":f,"searchable-menu--search-ul":o}};class $i{constructor(o,s,T){this.elementRef=o,this.cdRef=s,this.I18n=T,this.className=!0,this.items=[],this.collapsible=!1,this.searchable=!1,this.collapsed=!1}toggleCollapsed(){this.collapsed=!this.collapsed}}function Al(f,o){if(1&f&&e._UZ(0,"op-sidemenu",4),2&f){const s=o.ngIf;e.Q6J("items",s)}}function jl(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",function(){return e.CHM(s),e.oxw().showNewBoardModal()}),e._UZ(1,"span",6),e._UZ(2,"span",7),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("title",s.text.create_new_board),e.xp6(2),e.Q6J("textContent",s.text.board)}}$i.\u0275fac=function(o){return new(o||$i)(e.Y36(e.SBq),e.Y36(e.sBO),e.Y36(w.D))},$i.\u0275cmp=e.Xpm({type:$i,selectors:[["op-sidemenu"]],hostVars:2,hostBindings:function(o,s){2&o&&e.ekj("op-sidemenu",s.className)},inputs:{items:"items",title:"title",collapsible:"collapsible",searchable:"searchable"},decls:6,vars:7,consts:[["class","op-sidemenu--title","type","button",3,"click",4,"ngIf"],["class","op-sidemenu--title",4,"ngIf"],[1,"op-sidemenu--items",3,"ngClass"],["class","op-sidemenu--item","data-qa-selector","op-sidemenu--item",4,"ngFor","ngForOf"],["itemTemplate",""],["type","button",1,"op-sidemenu--title",3,"click"],["aria-hidden","true",1,"icon3","icon-small",3,"ngClass"],[1,"op-sidemenu--title"],["data-qa-selector","op-sidemenu--item",1,"op-sidemenu--item"],[3,"title","items","collapsible",4,"ngIf"],["class","op-sidemenu--item-action","uiSrefActive","op-sidemenu--item-action_active-child","uiSrefActiveEq","op-sidemenu--item-action_active",3,"class","uiSref","uiParams","uiOptions",4,"ngIf"],["class","op-sidemenu--item-action",3,"class","href",4,"ngIf"],[3,"title","items","collapsible"],["uiSrefActive","op-sidemenu--item-action_active-child","uiSrefActiveEq","op-sidemenu--item-action_active",1,"op-sidemenu--item-action",3,"uiSref","uiParams","uiOptions"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"op-sidemenu--item-action",3,"href"],["class","op-sidemenu--item-icon",3,"class",4,"ngIf"],[1,"op-sidemenu--item-title"],["class","op-bubble op-bubble_alt_highlighting",4,"ngIf"],[1,"op-sidemenu--item-icon"],[1,"op-bubble","op-bubble_alt_highlighting"]],template:function(o,s){1&o&&(e.YNc(0,yl,3,2,"button",0),e.YNc(1,bl,2,1,"div",1),e.TgZ(2,"ul",2),e.YNc(3,El,4,3,"li",3),e.qZA(),e.YNc(4,Il,4,3,"ng-template",null,4,e.W1O)),2&o&&(e.Q6J("ngIf",s.title&&s.collapsible),e.xp6(1),e.Q6J("ngIf",s.title&&!s.collapsible),e.xp6(1),e.Q6J("ngClass",e.WLB(4,Sl,s.collapsed,s.searchable)),e.xp6(1),e.Q6J("ngForOf",s.items))},directives:[I.O5,I.mk,I.sg,$i,Vt.AnchorUISref,Vt.UISrefActive,Vt.UISrefStatus,Vt.UISref,I.tP],styles:[".op-sidemenu[_ngcontent-%COMP%]{display:flex;flex-direction:column;font-size:14px}.op-sidemenu--title[_ngcontent-%COMP%]{display:flex;background:transparent;color:var(--main-menu-fieldset-header-color);border:0;text-transform:uppercase;padding:8px 12px;margin-top:12px;font-size:12px;cursor:pointer}.op-sidemenu--title[_ngcontent-%COMP%]:hover{background:var(--main-menu-bg-hover-background);color:var(--main-menu-hover-font-color)}.op-sidemenu--items[_ngcontent-%COMP%]{list-style:none}.op-sidemenu--items_collapsed[_ngcontent-%COMP%]{display:none}.op-sidemenu--item-action[_ngcontent-%COMP%]{display:flex;align-items:center;color:var(--main-menu-font-color);padding:8px 12px 8px 32px}.op-sidemenu--item-action[_ngcontent-%COMP%]:hover{background:var(--main-menu-bg-hover-background);color:var(--main-menu-hover-font-color)}.op-sidemenu--item-action_active[_ngcontent-%COMP%]{background:var(--main-menu-bg-selected-background);color:var(--main-menu-selected-font-color)}.op-sidemenu--item-action_active-child[_ngcontent-%COMP%]{background:var(--main-menu-bg-selected-background);color:var(--main-menu-selected-font-color)}.op-sidemenu--item-action_with_icon[_ngcontent-%COMP%]{padding-left:12px}.op-sidemenu--item-title[_ngcontent-%COMP%]{margin-right:auto;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;line-height:30px;text-decoration:none}.op-sidemenu--item-icon[_ngcontent-%COMP%]{font-size:24px;margin-right:8px}"],changeDetection:0});class Jo extends hi.N{constructor(o,s,T,j,q,fe,Be,Ye){super(),this.boardService=o,this.apiV3Service=s,this.currentProject=T,this.mainMenuService=j,this.currentUserService=q,this.I18n=fe,this.opModalService=Be,this.injector=Ye,this.className=!0,this.boardOptions$=this.apiV3Service.boards.observeAll().pipe((0,Di.U)(at=>at.map(Ot=>({title:Ot.name,uiSref:"boards.partitioned.show",uiParams:{board_id:Ot.id,query_props:"",projects:"projects",projectPath:this.currentProject.identifier},uiOptions:{reload:!0}})).sort((Ot,zt)=>Ot.title.localeCompare(zt.title)))),this.canCreateBoards$=this.currentUserService.hasCapabilities$("boards/create",this.currentProject.id||void 0).pipe(this.untilDestroyed()),this.text={board:this.I18n.t("js.label_board"),create_new_board:this.I18n.t("js.boards.create_new")}}ngOnInit(){this.mainMenuService.onActivate("board_view").subscribe(()=>{this.focusBackArrow(),this.boardService.loadAllBoards()})}showNewBoardModal(){this.opModalService.show(Cl.r,this.injector)}focusBackArrow(){jQuery('*[data-name="board_view"] .main-menu--arrow-left-to-project').focus()}}Jo.\u0275fac=function(o){return new(o||Jo)(e.Y36(vl.$),e.Y36(O.T),e.Y36(x.R),e.Y36(Yi),e.Y36(io.S),e.Y36(w.D),e.Y36(it.S),e.Y36(e.zs3))},Jo.\u0275cmp=e.Xpm({type:Jo,selectors:[["boards-menu"]],hostVars:2,hostBindings:function(o,s){2&o&&e.ekj("op-sidebar",s.className)},features:[e.qOj],decls:6,vars:6,consts:[[1,"op-sidebar--body"],[3,"items",4,"ngIf"],[1,"op-sidebar--footer"],["class","button -alt-highlight",3,"title","click",4,"ngIf"],[3,"items"],[1,"button","-alt-highlight",3,"title","click"],[1,"spot-icon","spot-icon_add"],[3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.YNc(1,Al,1,1,"op-sidemenu",1),e.ALo(2,"async"),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,jl,3,2,"button",3),e.ALo(5,"async"),e.qZA()),2&o&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.boardOptions$)),e.xp6(3),e.Q6J("ngIf",e.lcZ(5,4,s.canCreateBoards$)))},directives:[I.O5,$i],pipes:[I.Ov],encapsulation:2});class Yo{}Yo.\u0275fac=function(o){return new(o||Yo)},Yo.\u0275cmp=e.Xpm({type:Yo,selectors:[["global-search-work-packages-entry"]],decls:2,vars:0,consts:[["wp-isolated-query-space",""]],template:function(o,s){1&o&&(e.ynx(0,0),e._UZ(1,"global-search-work-packages"),e.BQk())},directives:[Ce.A,to],encapsulation:2});var Fl=t(43358),Wl=t(71435),Ul=t(23896);const Ll=["progressBar"],Bl=["progressPercentage"];function Ql(f,o){1&f&&e._UZ(0,"op-icon",8)}function Nl(f,o){1&f&&e._UZ(0,"op-icon",9)}function Jl(f,o){if(1&f&&(e.TgZ(0,"span",5),e.YNc(1,Ql,1,0,"op-icon",6),e.YNc(2,Nl,1,0,"op-icon",7),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.error),e.xp6(1),e.Q6J("ngIf",s.completed)}}class $o extends hi.N{constructor(o){super(),this.I18n=o,this.onError=new e.vpe,this.onSuccess=new e.vpe,this.error=!1,this.completed=!1}set value(o){this.progressBar.nativeElement.value=o,this.progressPercentage.nativeElement.innerText=`${o}%`,100===o&&(this.progressBar.nativeElement.style.display="none")}ngOnInit(){this.file=this.upload[0],this.upload[1].pipe(this.untilDestroyed()).subscribe(s=>{switch(s.type){case mi.dt.Sent:return this.value=5,(0,Kn.qu)(`Uploading file "${this.file.name}" of size ${this.file.size}.`);case mi.dt.UploadProgress:return this.updateProgress(s);case mi.dt.Response:return(0,Kn.qu)(`File ${this.fileName} was fully uploaded.`),this.value=100,this.completed=!0,this.onSuccess.emit()}},s=>this.handleError(s))}get fileName(){return this.file&&this.file.name}updateProgress(o){o.total?this.value=Math.round(o.loaded/o.total*100):this.value=10}handleError(o){this.error=!0,this.onError.emit(o)}}function Yl(f,o){1&f&&(e.TgZ(0,"div",8),e._UZ(1,"div",9),e._UZ(2,"div",10),e._UZ(3,"div",11),e._UZ(4,"div",12),e._UZ(5,"div",13),e.qZA())}function $l(f,o){if(1&f&&(e.ynx(0),e.YNc(1,Yl,6,0,"div",6),e.ALo(2,"async"),e._UZ(3,"p",7),e.BQk()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("ngIf",e.lcZ(2,2,s.loading$)),e.xp6(2),e.Q6J("textContent",s.toast.message)}}function Vl(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"a",15),e.NdJ("click",function(j){return e.CHM(s),e.oxw(2).executeTarget(j)}),e.qZA()}if(2&f){const s=e.oxw(2);e.Q6J("textContent",s.toast.link.text)}}function Hl(f,o){if(1&f&&(e.TgZ(0,"p"),e._UZ(1,"span",7),e._UZ(2,"span",7),e.YNc(3,Vl,1,1,"a",14),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("textContent",s.toast.message),e.xp6(1),e.Q6J("textContent"," "),e.xp6(1),e.Q6J("ngIf",s.toast.link)}}function Kl(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"a",18),e.NdJ("click",function(){e.CHM(s);return e.oxw(2).show=!0}),e._UZ(2,"op-icon",19),e.qZA(),e.TgZ(3,"a",18),e.NdJ("click",function(){e.CHM(s);return e.oxw(2).show=!1}),e._UZ(4,"op-icon",20),e.qZA(),e._UZ(5,"span",7),e.qZA()}if(2&f){const s=e.oxw(2);e.xp6(1),e.Q6J("hidden",s.show),e.xp6(2),e.Q6J("hidden",!s.show),e.xp6(2),e.Q6J("textContent",s.uploadText)}}function Gl(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"op-toasters-upload-progress",23),e.NdJ("onSuccess",function(){return e.CHM(s),e.oxw(3).onUploadSuccess()})("onError",function(){return e.CHM(s),e.oxw(3).remove()}),e.qZA()}if(2&f){const s=o.$implicit;e.Q6J("upload",s)}}function zl(f,o){if(1&f&&(e.TgZ(0,"ul",21),e.YNc(1,Gl,1,1,"op-toasters-upload-progress",22),e.qZA()),2&f){const s=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",s.data)}}$o.\u0275fac=function(o){return new(o||$o)(e.Y36(w.D))},$o.\u0275cmp=e.Xpm({type:$o,selectors:[["op-toasters-upload-progress"]],viewQuery:function(o,s){if(1&o&&(e.Gf(Ll,5),e.Gf(Bl,5)),2&o){let T;e.iGM(T=e.CRH())&&(s.progressBar=T.first),e.iGM(T=e.CRH())&&(s.progressPercentage=T.first)}},inputs:{upload:"upload"},outputs:{onError:"onError",onSuccess:"onSuccess"},features:[e.qOj],decls:8,vars:2,consts:[[1,"filename",3,"textContent"],["max","100","value","0"],["progressBar",""],["progressPercentage",""],["class","upload-completed",4,"ngIf"],[1,"upload-completed"],["icon-classes","icon-close",4,"ngIf"],["icon-classes","icon-checkmark",4,"ngIf"],["icon-classes","icon-close"],["icon-classes","icon-checkmark"]],template:function(o,s){1&o&&(e.TgZ(0,"li"),e._UZ(1,"span",0),e._UZ(2,"progress",1,2),e.TgZ(4,"p",null,3),e._uU(6,"0%"),e.qZA(),e.YNc(7,Jl,3,2,"span",4),e.qZA()),2&o&&(e.xp6(1),e.Q6J("textContent",s.fileName),e.xp6(6),e.Q6J("ngIf",s.completed||s.error))},directives:[I.O5,ut.o],encapsulation:2});const ql=function(f){return{"-hidden":f}};function Xl(f,o){if(1&f&&(e.TgZ(0,"div"),e.YNc(1,Kl,6,3,"div",2),e.TgZ(2,"div",16),e.YNc(3,zl,2,1,"ul",17),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("ngIf",s.canBeHidden),e.xp6(1),e.Q6J("ngClass",e.VKq(3,ql,!s.show&&s.canBeHidden)),e.xp6(1),e.Q6J("ngIf",s.data&&s.data.length>0)}}function ed(f,o){1&f&&e._UZ(0,"div")}function td(f,o){if(1&f&&e._UZ(0,"li",7),2&f){const s=o.$implicit;e.Q6J("textContent",s)}}function id(f,o){if(1&f&&(e.TgZ(0,"div"),e.TgZ(1,"ul",24),e.YNc(2,td,1,1,"li",25),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("ngForOf",s.data)}}function nd(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",26),e.NdJ("click",function(){return e.CHM(s),e.oxw().remove()}),e._UZ(1,"op-icon",27),e.qZA()}if(2&f){const s=e.oxw();e.Q6J("title",s.text.close_popup)}}class Vo{constructor(o,s){this.I18n=o,this.toastService=s,this.text={close_popup:this.I18n.t("js.close_popup_title")},this.uploadCount=0,this.show=!1,this.canBeHidden=!1,this.removable=!0,this.loading$=new S.X(!1)}ngOnInit(){if(this.type=this.toast.type,this.removable=!["upload","loading"].includes(this.type),"upload"===this.type){const o=this.data;this.removable=!1,this.canBeHidden=o&&o.length>5}"loading"===this.type&&(this.removable=!1,this.loading$.next(!0),this.data.pipe((0,Ul.take)(1),(0,Fl.V)(2e4),(0,Wl.x)(()=>{this.loading$.next(!1),this.remove()})).subscribe())}get data(){return this.toast.data}remove(){this.toastService.remove(this.toast)}executeTarget(){this.toast.link&&(this.toast.link.target(),this.remove())}onUploadSuccess(){this.uploadCount+=1}get uploadText(){return this.I18n.t("js.label_upload_counter",{done:this.uploadCount,count:this.data.length})}}function od(f,o){if(1&f&&e._UZ(0,"op-toast",3),2&f){const s=o.$implicit;e.Q6J("toast",s)}}Vo.\u0275fac=function(o){return new(o||Vo)(e.Y36(w.D),e.Y36(M.kl))},Vo.\u0275cmp=e.Xpm({type:Vo,selectors:[["op-toast"]],inputs:{toast:"toast"},decls:9,vars:10,consts:[["tabindex","0"],["role","alert","aria-atomic","true",1,"op-toast--content"],[4,"ngIf"],[3,"ngSwitch"],[4,"ngSwitchCase"],["type","button","class","spot-link op-toast--close",3,"title","click",4,"ngIf"],["class","loading-indicator -small",4,"ngIf"],[3,"textContent"],[1,"loading-indicator","-small"],[1,"block-1"],[1,"block-2"],[1,"block-3"],[1,"block-4"],[1,"block-5"],["class","op-toast--target-link",3,"textContent","click",4,"ngIf"],[1,"op-toast--target-link",3,"textContent","click"],[3,"ngClass"],["class","op-toast--uploads",4,"ngIf"],[3,"hidden","click"],["icon-classes","icon-arrow-right2"],["icon-classes","icon-arrow-down1"],[1,"op-toast--uploads"],[3,"upload","onSuccess","onError",4,"ngFor","ngForOf"],[3,"upload","onSuccess","onError"],[1,"op-toast--errors"],[3,"textContent",4,"ngFor","ngForOf"],["type","button",1,"spot-link","op-toast--close",3,"title","click"],["icon-classes","icon-context icon-close icon-no-color"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,$l,4,4,"ng-container",2),e.YNc(3,Hl,4,3,"p",2),e.TgZ(4,"div",3),e.YNc(5,Xl,4,5,"div",4),e.YNc(6,ed,1,0,"div",4),e.YNc(7,id,3,1,"div",4),e.qZA(),e.YNc(8,nd,2,1,"button",5),e.qZA(),e.qZA()),2&o&&(e.Gre("op-toast -",s.type,""),e.xp6(2),e.Q6J("ngIf","loading"===s.type),e.xp6(1),e.Q6J("ngIf","loading"!==s.type),e.xp6(1),e.Q6J("ngSwitch",s.type),e.xp6(1),e.Q6J("ngSwitchCase","upload"),e.xp6(1),e.Q6J("ngSwitchCase","success"),e.xp6(1),e.Q6J("ngSwitchCase","error"),e.xp6(1),e.Q6J("ngIf",s.removable))},directives:[I.O5,I.RF,I.n9,I.mk,ut.o,I.sg,$o],pipes:[I.Ov],encapsulation:2,changeDetection:0});class Ho extends hi.N{constructor(o,s){super(),this.toastService=o,this.cdRef=s,this.stack=[]}ngOnInit(){this.toastService.current.values$("Subscribing to changes in the toaster stack").pipe(this.untilDestroyed()).subscribe(o=>{this.stack=o,this.cdRef.detectChanges()})}}Ho.\u0275fac=function(o){return new(o||Ho)(e.Y36(M.kl),e.Y36(e.sBO))},Ho.\u0275cmp=e.Xpm({type:Ho,selectors:[["op-toasts-container"]],features:[e.qOj],decls:3,vars:1,consts:[[1,"op-toast--wrapper"],[1,"op-toast--casing"],[3,"toast",4,"ngFor","ngForOf"],[3,"toast"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.YNc(2,od,1,1,"op-toast",2),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.Q6J("ngForOf",s.stack))},directives:[I.sg,Vo],encapsulation:2,changeDetection:0});var rd=t(22663),Lr=t(26611),ad=t(38519);function cd(f,o){if(1&f&&(e.ynx(0),e._UZ(1,"attachments",3),e.BQk()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("resource",s.resource)}}class Ko extends hi.N{constructor(o,s,T,j,q,fe,Be){super(),this.elementRef=o,this.pathHelper=s,this.halResourceService=T,this.Notifications=j,this.I18n=q,this.states=fe,this.ConfigurationService=Be,this.changed=!1,this.inFlight=!1,this.isEditing=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.textareaSelector=this.$element.attr("textarea-selector"),this.previewContext=this.$element.attr("preview-context"),this.macros="false"!==this.$element.attr("macros");const o=this.$element.attr("editor-type")||"full",s=this.$element.data("resource");this.resource=s?this.halResourceService.createHalResource(s,!0):void 0,this.formElement=this.$element.closest("form"),this.wrappedTextArea=this.formElement.find(this.textareaSelector),this.wrappedTextArea.removeAttr("required").hide(),this.initialContent=this.wrappedTextArea.val(),this.$attachmentsElement=this.formElement.find("#attachments_fields"),this.context={type:o,resource:this.resource,previewContext:this.previewContext},this.macros||(this.context.macros="none")}ngOnDestroy(){super.ngOnDestroy(),this.formElement.off("submit.ckeditor")}markEdited(){window.OpenProject.pageWasEdited=!0}setup(o){return this.$element.data("editor",o),this.resource&&this.resource.attachments&&(this.setupAttachmentAddedCallback(o),this.setupAttachmentRemovalSignal(o)),this.formElement.on("submit.ckeditor change.ckeditor",()=>{try{this.wrappedTextArea.val(this.ckEditorInstance.getRawData())}catch(s){return console.error(`Failed to save CKEditor body to textarea: ${s}.`),this.Notifications.addError(s||this.I18n.t("js.error.internal")),!1}return this.addUploadedAttachmentsToForm(),!0}),this.setLabel(),o}setupAttachmentAddedCallback(o){o.model.on("op:attachment-added",()=>{this.states.forResource(this.resource).putValue(this.resource)})}setupAttachmentRemovalSignal(o){this.attachments=_.clone(this.resource.attachments.elements),this.states.forResource(this.resource).changes$().pipe((0,rd.R)((0,ad.J6)(this)),(0,wi.h)(s=>!!s)).subscribe(s=>{const j=_.differenceBy(this.attachments,s.attachments.elements,q=>q.id).map(q=>q.downloadLocation.href);j.length&&o.model.fire("op:attachment-removed",j),this.attachments=_.clone(s.attachments.elements)})}setLabel(){const o=this.textareaSelector.substring(1),s=jQuery(`label[for=${o}]`),T=this.$element.find(".ck-content");T.attr("aria-label",null),T.attr("aria-labelledby",o),s.click(()=>{T.focus()})}addUploadedAttachmentsToForm(){if(!this.resource||!this.resource.attachments||this.resource.id)return;const s=this.$attachmentsElement.find("input[type='file']").map((j,q)=>{const fe=/attachments\[(\d+)\]\[(?:file|id)\]/.exec(q.getAttribute("name")||"");return fe?parseInt(fe[1]):0}).toArray().sort().pop()||0,T=this.resource.attachments.elements||[];jQuery.each(T,(j,q)=>{this.$attachmentsElement.append(`<input type="hidden" name="attachments[${s+j+1}][id]" value="${q.id}">`)})}}Ko.\u0275fac=function(o){return new(o||Ko)(e.Y36(e.SBq),e.Y36(Fe.j),e.Y36(xt.u),e.Y36(M.kl),e.Y36(w.D),e.Y36(u.G),e.Y36(Ie.e))},Ko.\u0275cmp=e.Xpm({type:Ko,selectors:[["ckeditor-augmented-textarea"]],viewQuery:function(o,s){if(1&o&&e.Gf(Lr.F,7),2&o){let T;e.iGM(T=e.CRH())&&(s.ckEditorInstance=T.first)}},features:[e.qOj],decls:4,vars:3,consts:[[1,"op-ckeditor--wrapper"],[3,"context","content","onInitialized","onContentChange"],[4,"ngIf"],["data-allow-uploading","true","data-destroy-immediately","false",3,"resource"]],template:function(o,s){1&o&&(e.ynx(0),e.TgZ(1,"div",0),e.TgZ(2,"op-ckeditor",1),e.NdJ("onInitialized",function(j){return s.setup(j)})("onContentChange",function(){return s.markEdited()}),e.qZA(),e.qZA(),e.YNc(3,cd,2,1,"ng-container",2),e.BQk()),2&o&&(e.xp6(2),e.Q6J("context",s.context)("content",s.initialContent),e.xp6(1),e.Q6J("ngIf",s.resource&&s.resource.attachments))},directives:[Lr.F,I.O5,On.t],encapsulation:2});class Go{constructor(o){this.elementRef=o,this.isHidden=!1}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.$targetNotification=this.getTargetNotification(),this.identifier=this.$element.data("identifier"),this.isHidden="true"===window.OpenProject.guardedLocalStorage(this.identifier),this.$targetNotification.prop("hidden",!!this.isHidden),this.$element.parent().find(".persistent-toggle--click-handler").on("click",()=>this.toggle(!this.isHidden)),this.$targetNotification.find(".op-toast--close").on("click",()=>this.toggle(!0))}getTargetNotification(){return this.$element.parent().find(".persistent-toggle--toaster")}toggle(o){this.isHidden=o,window.OpenProject.guardedLocalStorage(this.identifier,(!!o).toString()),o?this.$targetNotification.slideUp(400,()=>{this.$targetNotification.prop("hidden",!0)}):(this.$targetNotification.slideDown(400),this.$targetNotification.prop("hidden",!1))}}Go.\u0275fac=function(o){return new(o||Go)(e.Y36(e.SBq))},Go.\u0275cmp=e.Xpm({type:Go,selectors:[["persistent-toggle"]],decls:0,vars:0,template:function(o,s){},encapsulation:2});class tn{constructor(o){this.displayed=(0,yn.qH)(),this.all=[];const s=o.get("hideSections");this.all=s.all,this.displayed.putValue(s.active.map(T=>(this.toggleVisibility(T.key,!0),T.key))),this.removeHiddenOnSubmit()}section(o){return document.querySelector(`section.hide-section[data-section-name="${o}"]`)}hide(o){this.displayed.doModify(s=>s.filter(T=>T!==o)),this.toggleVisibility(o,!1)}show(o){this.displayed.doModify(s=>[...s,o]),this.toggleVisibility(o,!0)}toggleVisibility(o,s){const T=this.section(o);T&&(T.hidden=!s)}removeHiddenOnSubmit(){jQuery(document.body).on("submit","form",function(o){const s=jQuery(this),T=s.find("section.hide-section:hidden");return!(!s.data("hideSectionRemoved")&&0!==T.length)||(s.data("hideSectionRemoved",!0),T.remove(),s.trigger("submit"),o.preventDefault(),!1)})}}tn.\u0275fac=function(o){return new(o||tn)(e.LFG(Lo.U))},tn.\u0275prov=e.Yz7({token:tn,factory:tn.\u0275fac,providedIn:"root"});class zo{constructor(o,s,T){this.elementRef=o,this.hideSectionService=s,this.I18n=T,this.displayed=!0,this.text={remove:this.I18n.t("js.label_remove")}}ngOnInit(){this.sectionName=this.elementRef.nativeElement.dataset.sectionName}hideSection(){return this.hideSectionService.hide(this.sectionName),!1}}zo.\u0275fac=function(o){return new(o||zo)(e.Y36(e.SBq),e.Y36(tn),e.Y36(w.D))},zo.\u0275cmp=e.Xpm({type:zo,selectors:[["hide-section-link"]],decls:2,vars:1,consts:[["type","button",1,"spot-link",3,"title","click"],["icon-classes","icon-close icon-small"]],template:function(o,s){1&o&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return s.hideSection()}),e._UZ(1,"op-icon",1),e.qZA()),2&o&&e.Q6J("title",s.text.remove)},directives:[ut.o],encapsulation:2});class qo{constructor(o,s){this.HideSection=o,this.elementRef=s}ngOnInit(){const o=jQuery(this.elementRef.nativeElement);this.optValue=o.data("optValue"),this.hideSecWithName=o.data("hideSecWithName"),jQuery(this.elementRef.nativeElement).prev().on("change",T=>{jQuery("option:selected",T.target).val()!==this.optValue?this.HideSection.hide(this.hideSecWithName):this.HideSection.show(this.hideSecWithName)})}}qo.\u0275fac=function(o){return new(o||qo)(e.Y36(tn),e.Y36(e.SBq))},qo.\u0275cmp=e.Xpm({type:qo,selectors:[["show-section-dropdown"]],decls:0,vars:0,template:function(o,s){},encapsulation:2});var hd=t(43682);const _d=["fallbackOption"];function md(f,o){if(1&f&&e._UZ(0,"option",4),2&f){const s=o.$implicit;e.Q6J("value",s.key)("textContent",s.label)}}class Xo extends hi.N{constructor(o,s,T){super(),this.hideSectionService=o,this.elementRef=s,this.I18n=T,this.trackByKey=(0,hd.AT)("key"),this.selectable=[],this.active=[],this.placeholder=this.I18n.t("js.placeholders.selection")}ngOnInit(){this.htmlId=this.elementRef.nativeElement.dataset.htmlId,this.hideSectionService.displayed.values$().pipe(this.untilDestroyed()).subscribe(o=>{this.selectable=this.hideSectionService.all.filter(s=>-1===o.indexOf(s.key)).sort((s,T)=>s.label.localeCompare(T.label)),this.option.nativeElement.selected=!0})}show(o){this.hideSectionService.show(o)}}Xo.\u0275fac=function(o){return new(o||Xo)(e.Y36(tn),e.Y36(e.SBq),e.Y36(w.D))},Xo.\u0275cmp=e.Xpm({type:Xo,selectors:[["add-section-dropdown"]],viewQuery:function(o,s){if(1&o&&e.Gf(_d,7),2&o){let T;e.iGM(T=e.CRH())&&(s.option=T.first)}},features:[e.qOj],decls:4,vars:3,consts:[[1,"form--select",3,"id","change"],["value","","selected","","disabled","",3,"textContent"],["fallbackOption",""],[3,"value","textContent",4,"ngFor","ngForTrackByKey","ngForOf"],[3,"value","textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"select",0),e.NdJ("change",function(j){return s.show(j.target.value)}),e._UZ(1,"option",1,2),e.YNc(3,md,1,2,"option",3),e.qZA()),2&o&&(e.Q6J("id",s.htmlId),e.xp6(1),e.Q6J("textContent",s.placeholder),e.xp6(2),e.Q6J("ngForOf",s.selectable))},directives:[c.YN,c.Kr,I.sg],encapsulation:2});var Br=t(7301),fd=t(54471);function vd(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"a",16),e.NdJ("click",function(j){e.CHM(s);const q=e.oxw().$implicit;return e.oxw().clickTab(q,j)}),e.qZA()}if(2&f){const s=e.oxw().$implicit,T=e.oxw();e.ekj("op-tab-row--link_selected",s.id===T.currentTabId)("op-tab-row--link_disabled",void 0!==s.disable),e.Q6J("href",s.path,e.LSH)("textContent",s.name),e.uIk("title",T.tabTitle(s))}}function Cd(f,o){if(1&f&&(e._UZ(0,"op-tab-count",21),e.ALo(1,"async")),2&f){const s=e.oxw(2).$implicit,T=e.oxw();e.Q6J("count",e.lcZ(1,2,s.counter(T.injector))),e.uIk("data-qa-selector","tab-counter-"+s.name)}}function yd(f,o){if(1&f&&(e.TgZ(0,"span",23),e._uU(1),e.qZA()),2&f){const s=e.oxw().ngIf;e.xp6(1),e.hij(" (",s,")")}}function bd(f,o){if(1&f&&(e.ynx(0),e.YNc(1,yd,2,1,"span",22),e.BQk()),2&f){const s=o.ngIf,T=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",s>0&&!T.showCountAsBubble)}}function wd(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"a",17),e.NdJ("click",function(j){e.CHM(s);const q=e.oxw().$implicit;return e.oxw().clickTab(q,j)}),e._UZ(1,"span",18),e.YNc(2,Cd,2,4,"op-tab-count",19),e.YNc(3,bd,2,1,"ng-container",20),e.ALo(4,"async"),e.qZA()}if(2&f){const s=e.oxw().$implicit,T=e.oxw();e.ekj("op-tab-row--link_disabled",void 0!==s.disable),e.Q6J("uiSref",s.route)("uiParams",s.routeParams),e.uIk("title",T.tabTitle(s)),e.xp6(1),e.Q6J("textContent",s.name),e.xp6(1),e.Q6J("ngIf",s.counter&&s.showCountAsBubble),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,8,s.counter(T.injector)))}}function Td(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"li",13),e.NdJ("dragenter",function(){const q=e.CHM(s).$implicit;return e.oxw().startDebouncedTabActivation(q)})("dragleave",function(){return e.CHM(s),e.oxw().cancelDebouncedTabActivation()}),e.YNc(1,vd,1,7,"a",14),e.YNc(2,wd,5,10,"a",15),e.qZA()}if(2&f){const s=o.$implicit,T=e.oxw();e.uIk("data-tab-id",s.id)("data-qa-tab-id",s.id)("data-qa-tab-selected",s.id===T.currentTabId||void 0)("data-qa-tab-disabled",s.disable||void 0),e.xp6(1),e.Q6J("ngIf",!s.route),e.xp6(1),e.Q6J("ngIf",s.route)}}const Pd=[[["","slot","actions"]]];class es extends Tt.P{constructor(o,s,T,j,q,fe){super(s,j,fe),this.elementRef=o,this.$state=s,this.gon=T,this.I18n=q,this.injector=fe,this.classes=["content--tabs","scrollable-tabs"];const Be=JSON.parse(this.gon.get("contentTabs").tabs),Ye=JSON.parse(this.gon.get("contentTabs").selected);this.tabs=Be.map(at=>({id:at.name,name:this.I18n.t(`js.${at.label}`,{defaultValue:at.label}),path:at.path})),this.currentTabId=Ye.name}}es.\u0275fac=function(o){return new(o||es)(e.Y36(e.SBq),e.Y36(ge.StateService),e.Y36(Lo.U),e.Y36(e.sBO),e.Y36(w.D),e.Y36(e.zs3))},es.\u0275cmp=e.Xpm({type:es,selectors:[["op-content-tabs"]],features:[e.qOj],ngContentSelectors:["[slot=actions]"],decls:14,vars:5,consts:[[1,"op-scrollable-tabs",3,"ngClass"],[1,"op-scrollable-tabs--tab-container"],["scrollContainer",""],[1,"op-tab-row",3,"scroll"],["scrollPane",""],["class","op-tab-row--tab",3,"dragenter","dragleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[1,"op-scrollable-tabs--actions"],[1,"op-tab-row--tab",3,"dragenter","dragleave"],["class","op-tab-row--link",3,"href","op-tab-row--link_selected","op-tab-row--link_disabled","textContent","click",4,"ngIf"],["class","op-tab-row--link","uiSrefActive","op-tab-row--link_selected","href","","role","button",3,"uiSref","uiParams","op-tab-row--link_disabled","click",4,"ngIf"],[1,"op-tab-row--link",3,"href","textContent","click"],["uiSrefActive","op-tab-row--link_selected","href","","role","button",1,"op-tab-row--link",3,"uiSref","uiParams","click"],[3,"textContent"],[3,"count",4,"ngIf"],[4,"ngIf"],[3,"count"],["data-qa-selector","tab-count",4,"ngIf"],["data-qa-selector","tab-count"]],template:function(o,s){1&o&&(e.F$t(Pd),e.TgZ(0,"div",0),e.TgZ(1,"div",1,2),e.TgZ(3,"ul",3,4),e.NdJ("scroll",function(){return s.onScroll()}),e.YNc(5,Td,3,6,"li",5),e.qZA(),e.TgZ(6,"div",6,7),e.NdJ("click",function(){return s.scrollLeft()}),e._UZ(8,"span",8),e.qZA(),e.TgZ(9,"div",9,10),e.NdJ("click",function(){return s.scrollRight()}),e._UZ(11,"span",11),e.qZA(),e.qZA(),e.TgZ(12,"ul",12),e.Hsn(13),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngClass",s.classes),e.xp6(5),e.Q6J("ngForOf",s.tabs)("ngForTrackBy",s.trackById),e.xp6(1),e.Q6J("hidden",s.hideLeftButton),e.xp6(3),e.Q6J("hidden",s.hideRightButton))},directives:[I.mk,I.sg,I.O5,Vt.AnchorUISref,Vt.UISrefActive,Vt.UISrefStatus,Vt.UISref,fd.x],pipes:[I.Ov],styles:["content-tabs[_ngcontent-%COMP%]{min-height:73px;display:block}"],changeDetection:0});class ts{constructor(o,s,T,j){this.toastService=o,this.elementRef=s,this.I18n=T,this.ConfigurationService=j}ngOnInit(){const o=this.elementRef.nativeElement;this.clickTarget=o.getAttribute("click-target"),this.clipboardTarget=o.getAttribute("clipboard-target"),jQuery(this.clickTarget).on("click",s=>this.onClick(s)),o.classList.add("copy-to-clipboard"),this.target=jQuery(this.clipboardTarget?this.clipboardTarget:o)}addNotification(o,s){const T=this.toastService[o](s);setTimeout(()=>this.toastService.remove(T),5e3)}onClick(o){const s=document.queryCommandSupported&&document.queryCommandSupported("copy");if(o.preventDefault(),this.target.select().focus(),s)try{if(document.execCommand("copy"))return void this.addNotification("addSuccess",this.I18n.t("js.clipboard.copied_successful"))}catch(T){console.log(`Your browser seems to support the clipboard API, but copying failed: ${T}`)}this.addNotification("addError",this.I18n.t("js.clipboard.browser_error"))}}ts.\u0275fac=function(o){return new(o||ts)(e.Y36(M.kl),e.Y36(e.SBq),e.Y36(w.D),e.Y36(Ie.e))},ts.\u0275cmp=e.Xpm({type:ts,selectors:[["copy-to-clipboard"]],decls:0,vars:0,template:function(o,s){},encapsulation:2});var Ls=t(98636),Qr=t(67325),Nr=t(50076),Od=t(49951),Jr=t(91593),Bs=t(80044),Md=t(80104);const Id=["btn"];function Sd(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",8),e.NdJ("click",function(){return e.CHM(s),e.oxw().toggleMobileSearch()}),e._UZ(1,"i",9),e.qZA()}if(2&f){const s=e.oxw();e.s9C("title",s.text.close_search)}}function Dd(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"div",12),e.NdJ("click",function(){e.CHM(s);const j=e.oxw().$implicit;return e.oxw().followItem(j)}),e.TgZ(2,"div",13),e._uU(3),e.qZA(),e.TgZ(4,"div",14),e._uU(5),e.qZA(),e.qZA(),e.qZA()}if(2&f){const s=e.oxw().$implicit,T=e.oxw();e.xp6(3),e.hij(" ",T.currentValue,""),e.xp6(1),e.s9C("title",s.projectScope),e.xp6(1),e.hij("",s.text," \u21b5")}}function Ad(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"a",15),e.NdJ("click",function(j){e.CHM(s);const q=e.oxw().$implicit;return e.oxw().redirectToWp(q.id,j)}),e._UZ(1,"op-principal",16),e.TgZ(2,"div",17),e.TgZ(3,"span",18),e._UZ(4,"span",19),e._uU(5),e.qZA(),e.TgZ(6,"div",20),e._UZ(7,"span",21),e._uU(8),e._UZ(9,"span",22),e.qZA(),e.qZA(),e.qZA()}if(2&f){const s=e.oxw().$implicit,T=e.oxw();e.Q6J("href",T.wpPath(s.id),e.LSH),e.xp6(1),e.Q6J("hideName",!0)("principal",s.author),e.xp6(3),e.Q6J("ngClass",T.highlighting("type",s.type.id))("textContent",s.type.name),e.xp6(1),e.hij(" ",s.subject," "),e.xp6(2),e.Q6J("textContent",s.project.name),e.xp6(1),e.hij(" #",s.id," "),e.xp6(1),e.Q6J("textContent",s.status.name)("ngClass",T.statusHighlighting(s.status.id))}}function jd(f,o){if(1&f&&(e.YNc(0,Dd,6,3,"div",10),e.YNc(1,Ad,10,10,"ng-template",null,11,e.W1O)),2&f){const s=o.$implicit,T=e.MAs(2);e.Q6J("ngIf",!s.id)("ngIfElse",T)}}const Rd=function(f,o){return{"top-menu-search--input":!0,"-markable":f,"-expanded":o}};class is{constructor(o,s,T,j,q,fe,Be,Ye,at,At,Ot){this.elementRef=o,this.I18n=s,this.apiV3Service=T,this.pathHelperService=j,this.halResourceService=q,this.globalSearchService=fe,this.currentProjectService=Be,this.deviceService=Ye,this.cdRef=at,this.halNotification=At,this.ngZone=Ot,this.expanded=!1,this.markable=!1,this.getAutocompleterData=zt=>this.autocompleteWorkPackages(zt),this.autocompleterOptions={filters:[],resource:"work_packages",searchKey:"subjectOrId",getOptionsFn:this.getAutocompleterData},this.currentValue="",this.isFocusedDirectly=this.globalSearchService.searchTerm.length>0,this.text={all_projects:this.I18n.t("js.global_search.all_projects"),current_project:this.I18n.t("js.global_search.current_project"),current_project_and_all_descendants:this.I18n.t("js.global_search.current_project_and_all_descendants"),search:this.I18n.t("js.global_search.search"),search_dots:`${this.I18n.t("js.global_search.search")} ...`,close_search:this.I18n.t("js.global_search.close_search")}}ngAfterViewInit(){this.searchTerm=this.globalSearchService.searchTerm,this.currentValue="",this.toggleTopMenuClass()}ngOnDestroy(){this.unregister()}set searchTerm(o){this.ngSelectComponent.ngSelectInstance.searchTerm=o}get searchTerm(){return this.ngSelectComponent.ngSelectInstance.searchTerm}handleClick(o){var s;o.preventDefault(),(0,Od.j)(this.btn.nativeElement,o.target)&&(this.deviceService.isMobile?(this.toggleMobileSearch(),jQuery(".ng-input input").focus(),o.stopPropagation()):0===(null===(s=this.searchTerm)||void 0===s?void 0:s.length)?this.ngSelectComponent.ngSelectInstance.focus():this.submitNonEmptySearch())}toggleMobileSearch(){this.expanded=!this.expanded,this.toggleTopMenuClass()}redirectToWp(o,s){return s.stopImmediatePropagation(),!!(0,Qr.F)(s)||(window.location.href=this.wpPath(o),s.preventDefault(),!1)}wpPath(o){return this.pathHelperService.workPackagePath(o)}highlighting(o,s){return Nr.Z.inlineClass(o,s)}search(o){this.currentValue=this.searchTerm,this.openCloseMenu(o.term)}openCloseMenu(o){this.ngSelectComponent.ngSelectInstance.isOpen=o.trim().length>0}onFocus(){this.expanded=!0,this.toggleTopMenuClass(),this.openCloseMenu(this.currentValue)}onFocusOut(){this.deviceService.isMobile||(this.expanded=null!==this.searchTerm&&this.searchTerm.length>0,this.ngSelectComponent.ngSelectInstance.isOpen=!1,this.selectedItem=null,this.toggleTopMenuClass())}onClose(){this.searchTerm=this.currentValue}clearSearch(){this.currentValue="",this.searchTerm="",this.openCloseMenu(this.currentValue)}onEnterBeforeResultsLoaded(){this.selectedItem?this.followSelectedItem():this.searchInScope(this.currentScope)}statusHighlighting(o){return Nr.Z.inlineClass("status",o)}followItem(o){this.selectedItem=o,o instanceof Bs.X?window.location.href=this.wpPath(o.id):(this.globalSearchService.searchTerm=this.currentValue,this.searchInScope(o.projectScope))}followSelectedItem(){this.selectedItem&&this.followItem(this.selectedItem)}customSearchFn(o,s){return void 0===s.id||-1!==s.subject.toLowerCase().indexOf(o.toLowerCase())}autocompleteWorkPackages(o){if(!o)return(0,or.of)([]);this.selectedItem=null,this.markable=!1;const s=this.queryWithoutHash(o);return this.fetchSearchResults(s,s!==o).get().pipe((0,Di.U)(T=>this.searchResultsToOptions(T.elements,s)),(0,Ls.b)(()=>{this.setMarkedOption()}))}queryWithoutHash(o){return/^#(\d+)/.exec(o)?o.substr(1):o}fetchSearchResults(o,s){return this.apiV3Service.work_packages.filterByTypeaheadOrId(o,s)}searchResultsToOptions(o,s){const T=this.detailedSearchOptions();return this.selectedItem=o.find(j=>{var q;return(null===(q=j.id)||void 0===q?void 0:q.toString())===s})||T[0],[...T,...o]}detailedSearchOptions(){const o=[];return this.currentProjectService.path&&(o.push("current_project_and_all_descendants"),o.push("current_project")),"current_project"===this.globalSearchService.projectScope&&o.reverse(),o.push("all_projects"),o.map(s=>({projectScope:s,text:this.text[s]}))}setMarkedOption(){this.markable=!0,this.ngSelectComponent.ngSelectInstance.itemsList.markItem(this.ngSelectComponent.ngSelectInstance.itemsList.selectedItems[0]),this.cdRef.detectChanges()}searchInScope(o){switch(o){case"all_projects":{let s=!1;"all"!==this.globalSearchService.projectScope&&(s=!0,this.globalSearchService.resultsHidden=!0),this.globalSearchService.projectScope="all",this.submitNonEmptySearch(s);break}case"current_project":this.globalSearchService.projectScope="current_project",this.submitNonEmptySearch();break;case"current_project_and_all_descendants":this.globalSearchService.projectScope="",this.submitNonEmptySearch()}}submitNonEmptySearch(o=!1){if(this.globalSearchService.searchTerm=this.currentValue,this.currentValue.length>0){if(this.ngSelectComponent.ngSelectInstance.close(),!o&&this.globalSearchService.isAfterSearch()&&"work_packages"===this.globalSearchService.currentTab)return void window.history.replaceState({},`${I18n.t("global_search.search")}: ${this.searchTerm}`,this.globalSearchService.searchPath());this.globalSearchService.submitSearch()}}blur(){this.ngSelectComponent.ngSelectInstance.searchTerm="",document.activeElement.blur()}get currentScope(){const o=this.globalSearchService.projectScope;return""===o?"current_project_and_all_descendants":o}unregister(){this.unregisterGlobalListener&&(this.unregisterGlobalListener(),this.unregisterGlobalListener=void 0)}toggleTopMenuClass(){const o=document.getElementsByClassName("op-app-header")[0];o.classList.toggle("op-app-header_search-open",this.expanded),o.dataset.qaSearchOpen="1"}}is.\u0275fac=function(o){return new(o||is)(e.Y36(e.SBq),e.Y36(w.D),e.Y36(O.T),e.Y36(Fe.j),e.Y36(xt.u),e.Y36(Fi),e.Y36(x.R),e.Y36(ir.U),e.Y36(e.sBO),e.Y36(Le.W),e.Y36(e.R0b))},is.\u0275cmp=e.Xpm({type:is,selectors:[["global-search-input"]],viewQuery:function(o,s){if(1&o&&(e.Gf(Id,7),e.Gf(Jr.s,7)),2&o){let T;e.iGM(T=e.CRH())&&(s.btn=T.first),e.iGM(T=e.CRH())&&(s.ngSelectComponent=T.first)}},hostBindings:function(o,s){1&o&&e.NdJ("click",function(j){return s.handleClick(j)})},decls:8,vars:22,consts:[[1,"top-menu-search"],["class","top-menu-search--back-button","href","#",3,"title","click",4,"ngIf"],[1,"global-search",3,"defaultData","name","id","accesskey","placeholder","classes","openOnEnter","labelRequired","focusDirectly","model","searchFn","filters","resource","searchKey","getOptionsFn","focus","blur","search","open","close","change","keydown.enter","keydown.escape","clear"],["select",""],["op-autocompleter-option-tmp",""],["role","button","id","top-menu-search-button",1,"top-menu-search--button","search-form-normal",3,"title","click"],["btn",""],["icon-classes","icon5 icon-search ellipsis"],["href","#",1,"top-menu-search--back-button",3,"title","click"],["aria-hidden","true",1,"icon-arrow-left1"],[4,"ngIf","ngIfElse"],["workPackageItemTemplate",""],["tabindex","-1",1,"global-search--option",3,"click"],[1,"global-search--search-term"],[1,"global-search--project-scope",3,"title"],["tabindex","-1",1,"global-search--option",2,"line-height","1",3,"href","click"],[1,"hidden-for-mobile","global-search--principal",3,"hideName","principal"],[1,"global-search--option-meta"],[1,"global-search--wp-subject"],[3,"ngClass","textContent"],[1,"global-search--wp-content"],[1,"global-search--wp-project",3,"textContent"],[1,"global-search--wp-status",3,"textContent","ngClass"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.YNc(1,Sd,2,1,"button",1),e.TgZ(2,"op-autocompleter",2,3),e.NdJ("focus",function(){return s.onFocus()})("blur",function(){return s.onFocusOut()})("search",function(j){return s.search(j)})("open",function(){return s.openCloseMenu(s.currentValue)})("close",function(){return s.onClose()})("change",function(j){return s.followItem(j)})("keydown.enter",function(){return s.onEnterBeforeResultsLoaded()})("keydown.escape",function(){return s.blur()})("clear",function(){return s.clearSearch()}),e.YNc(4,jd,3,2,"ng-template",4),e.qZA(),e.TgZ(5,"button",5,6),e.NdJ("click",function(j){return s.handleClick(j)}),e._UZ(7,"op-icon",7),e.qZA(),e.qZA()),2&o&&(e.xp6(1),e.Q6J("ngIf",s.expanded),e.xp6(1),e.Q6J("defaultData",!1)("name","global-search-input")("id","global-search-input")("accesskey",4)("placeholder",s.text.search_dots)("classes",e.WLB(19,Rd,s.markable,s.expanded))("openOnEnter",!1)("labelRequired",!1)("focusDirectly",s.isFocusedDirectly)("model",s.selectedItem)("searchFn",s.customSearchFn)("filters",s.autocompleterOptions.filters)("resource",s.autocompleterOptions.resource)("searchKey",s.autocompleterOptions.searchKey)("getOptionsFn",s.autocompleterOptions.getOptionsFn),e.xp6(3),e.ekj("-input-focused",s.expanded),e.s9C("title",s.text.search))},directives:[I.O5,Jr.s,Md.u,ut.o,ve.N,I.mk],styles:[".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.top-menu-search{display:flex;align-items:center;position:relative;height:var(--header-height);line-height:var(--header-height);margin:0 15px}@media screen and (max-width: 679px){.top-menu-search{margin:0}}.top-menu-search--back-button{display:none}.top-menu-search--button{padding:0;margin:0;background:transparent;border:0;font:inherit;text-align:inherit;position:absolute;right:2px;font-size:var(--header-item-font-size);color:var(--header-item-font-color)}.top-menu-search--button:hover{text-decoration:none}@media screen and (max-width: 679px){.top-menu-search--button{position:relative;padding:0 8px}.top-menu-search--button:hover{background:var(--header-item-bg-hover-color);color:var(--header-item-font-hover-color);border-bottom:var(--header-border-bottom-width) solid var(--header-border-bottom-color)}}.top-menu-search--button.-input-focused{color:var(--header-search-field-font-color)}.top-menu-search--loading{top:var(--header-height)-11px;height:46px;z-index:1051}.top-menu-search--input{width:calc(160px + 3vw);font-size:.9rem;transition:width .2s ease-in-out}.top-menu-search--input::-ms-clear{margin-right:5px;width:20px}.top-menu-search--input .ng-select-container{background:transparent;border-color:var(--header-item-font-color)}.top-menu-search--input .ng-arrow-wrapper{display:none}.top-menu-search--input .ng-clear-wrapper{color:var(--header-item-font-color);top:1px;width:30px;right:25px;text-align:center}@media screen and (max-width: 679px){.top-menu-search--input .ng-input{top:0!important}}.top-menu-search--input .ng-input input{color:var(--header-item-font-color);height:30px;cursor:text}.top-menu-search--input .ng-placeholder{color:var(--header-item-font-color)!important}.top-menu-search--input.-expanded{width:calc(160px + 13vw);background:white;border-radius:4px;color:var(--header-search-field-font-color)}.top-menu-search--input.-expanded .ng-placeholder,.top-menu-search--input.-expanded .ng-clear-wrapper,.top-menu-search--input.-expanded input{color:var(--header-search-field-font-color)}.top-menu-search--input .ng-dropdown-panel-items.scroll-host{scrollbar-color:transparent transparent;scrollbar-width:thin;max-height:80vh;height:auto}.top-menu-search--input .ng-dropdown-panel-items.scroll-host::-webkit-scrollbar{height:10px;width:10px}.top-menu-search--input .ng-dropdown-panel-items.scroll-host::-webkit-scrollbar-track{background:transparent}.top-menu-search--input .ng-dropdown-panel-items.scroll-host::-webkit-scrollbar-thumb{background:#DDDDDD;visibility:hidden}.top-menu-search--input .ng-dropdown-panel-items.scroll-host:hover{scrollbar-color:#DDDDDD transparent}.top-menu-search--input .ng-dropdown-panel-items.scroll-host:hover::-webkit-scrollbar-thumb{visibility:visible}.top-menu-search--input .ng-option{border-bottom:1px solid #EAEAEA;white-space:normal;padding:5px 10px;background-color:unset}.top-menu-search--input .ng-option:last-child{border-bottom:none}.top-menu-search--input .ng-option.ng-option-marked{color:var(--header-drop-down-item-font-hover-color)}.top-menu-search--input .ng-option.ng-option-disabled{display:none}.top-menu-search--input .ng-option.ng-option-selected{color:var(--header-drop-down-item-font-hover-color)}.top-menu-search--input.-markable .ng-option.ng-option-marked{background-color:var(--drop-down-hover-bg-color)}.top-menu-search--input.-markable .ng-option.ng-option-selected{background-color:var(--drop-down-selected-bg-color)}.top-menu-search--input .ng-spinner-loader{position:relative;right:14px}\n",".cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media only screen and (max-width: 679px){.top-menu-search--input{display:none}.top-menu-search--input.-expanded{display:block;min-width:unset;flex-basis:100%;position:unset;flex-grow:1}.top-menu-search--input.-expanded .scroll-host{max-height:calc(100vh - var(--header-height))}.top-menu-search--input.-expanded .ng-clear-wrapper{width:40px;right:0}.top-menu-search--input.-expanded .ng-select-bottom{height:calc(100vh - var(--header-height));overflow-y:auto;margin:0}.top-menu-search--input.-expanded .ng-select-container{height:36px!important;border-radius:4px}.top-menu-search--input.-expanded .ng-input input{height:36px}.top-menu-search .top-menu-search--back-button{padding:0;margin:0;background:transparent;border:0;font:inherit;text-align:inherit;display:initial;width:50px;text-align:center;color:var(--header-item-font-color)}.top-menu-search .top-menu-search--back-button:hover,.top-menu-search .top-menu-search--back-button:focus,.top-menu-search .top-menu-search--back-button:active{text-decoration:none}.top-menu-search .top-menu-search--loading{top:var(--header-height)1px}.top-menu-search .top-menu-search--button.-input-focused{color:var(--header-item-font-color)}}\n",'.cdk-drag-preview{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.global-search{flex-grow:1}@media screen and (max-width: 679px){.global-search{display:none}}.global-search--option,.global-search--option:hover{padding:5px;line-height:15px;min-height:25px;word-break:break-word;color:var(--body-font-color);text-decoration:none;display:flex}.global-search--option-meta{display:flex;flex-direction:column;flex-grow:1;overflow:hidden}.global-search--search-term{flex-grow:1}.global-search--project-scope{flex-grow:0;flex-shrink:1;border:1px solid var(--button--border-color);font-size:13px;background:var(--button--background-color);border-radius:2px;padding:0 4px;color:var(--body-font-color)}.global-search--principal{margin-right:5px;margin-left:-5px}.global-search--wp-content{display:grid;grid-template-columns:50% 1fr auto;grid-template-areas:"project idlink status";font-size:.8rem;padding:5px 0}.global-search--wp-project{grid-area:project;overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap}.global-search--wp-id{grid-area:idlink;place-self:right;font-style:italic;color:var(--gray-dark);font-size:13px;white-space:nowrap}.global-search--wp-status{grid-area:status;overflow:hidden;font-style:italic}.global-search--wp-subject{font-weight:bold;display:inline-block;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}\n'],encapsulation:2,changeDetection:0});const Fd=["sectionBody"],Wd=function(f){return{"-expanded":f}};class ns{constructor(o){this.elementRef=o,this.expanded=!1}ngOnInit(){const o=this.elementRef.nativeElement;this.sectionTitle=o.getAttribute("section-title"),"true"===o.getAttribute("initially-expanded")&&(this.expanded=!0);const s=o.nextElementSibling;this.sectionBody.nativeElement.appendChild(s),s.removeAttribute("hidden")}toggle(o){this.expanded=!this.expanded,o.preventDefault()}}ns.\u0275fac=function(o){return new(o||ns)(e.Y36(e.SBq))},ns.\u0275cmp=e.Xpm({type:ns,selectors:[["collapsible-section-augment"]],viewQuery:function(o,s){if(1&o&&e.Gf(Fd,7),2&o){let T;e.iGM(T=e.CRH())&&(s.sectionBody=T.first)}},decls:5,vars:5,consts:[[1,"collapsible-section",3,"ngClass"],[1,"collapsible-section--toggle-link",3,"click"],[1,"collapsible-section--legend",3,"textContent"],[1,"collapsible-section--body","toggle-slide-animation",3,"hidden"],["sectionBody",""]],template:function(o,s){1&o&&(e.TgZ(0,"section",0),e.TgZ(1,"button",1),e.NdJ("click",function(j){return s.toggle(j)}),e._UZ(2,"span",2),e.qZA(),e._UZ(3,"div",3,4),e.qZA()),2&o&&(e.Q6J("ngClass",e.VKq(3,Wd,s.expanded)),e.xp6(2),e.Q6J("textContent",s.sectionTitle),e.xp6(1),e.Q6J("hidden",!s.expanded))},directives:[I.mk],encapsulation:2});var ur,Ld=t(77729);(ur||(ur={})).register=function(T,j){jQuery.widget(`custom.${T}`,jQuery.ui.autocomplete,{_create(){j.currentPage=0,this._super(),this.widget().menu("option","items","> .ui-matched-item"),this._search("")},_renderMenu(q,fe){jQuery(q).unbind("scroll"),this._renderLazyMenu(q,fe)},_renderMenuPage(q,fe,Be=null){const Ye=this;let at=fe.length,At=fe;const Ot=j.maxItemsPerPage;if(null!==Be&&(At=fe.slice(Be*Ot,Be*Ot+Ot),at=Math.min(fe.length,Be*Ot+Ot)),jQuery.each(At,(zt,Wi)=>{Ye._renderItemData(q,Wi)}),q.css("height","auto"),at<fe.length){const Wi=32*at;Wi<.55*document.body.offsetHeight&&q.css("height",Wi-50)}},_pages:q=>Math.ceil(q.length/j.maxItemsPerPage),_repositionMenu(q){const fe=this,{menu:Be}=fe;Be.refresh(),fe._resizeMenu(),q.position(jQuery.extend({of:fe.element},fe.options.position)),fe.options.autoFocus&&Be.next(new jQuery.Event("mouseover"))},_resizeMenu(){this.menu.element.outerWidth(this.element.outerWidth())},_renderItem(q,fe){const Be=this.element.val(),Ye="disabled"===fe.render,at=jQuery("<div>").addClass("ui-menu-item-wrapper");j.renderItem(fe,at);const At=jQuery("<li>").toggleClass("ui-state-disabled",Ye).toggleClass("ui-matched-item",!Ye).append(at).appendTo(q);return""!==Be&&At.mark(Be,{className:"ui-autocomplete-match"}),At},_renderLazyMenu(q,fe){const Be=this,Ye=jQuery(q),at=this._pages(fe);if(at<=1)return Be._renderMenuPage(q,fe);Be._renderMenuPage(q,fe,0),Ye.scroll(()=>{if(function(T){const j=T.outerHeight(),{scrollHeight:q}=T[0];return T.scrollTop()>=q-j-6}(Ye)){if(++j.currentPage>=at)return;Be._renderMenuPage(q,fe,j.currentPage),Be._repositionMenu(q)}})}})};var Qs=t(33406);class os extends class{constructor(o){this.widgetName=o,ur.register(o,this)}renderItem(o,s){s.text(o.label)}fuzzySearch(o,s){if(""===s)return o;if(s.length>=3){const T=this.literalSearch(o,s);if(T.length>0)return T}return this.fuseInstance.search(s)}literalSearch(o,s){const T=[],j=s.toLowerCase();return o.forEach(q=>{-1!==q.label.toLowerCase().indexOf(j)&&T.push(q)}),T}augmentedResultSet(o,s){const T=[];return s.forEach(j=>{T.push({label:j.label,object:j.object,render:"match"})}),T}setup(o,s){this.currentPage=0,this.input=o,this.input[this.widgetName].call(this.input,this.setupParams(s));this.fuseInstance=new Ld(s,{shouldSort:!0,tokenize:!1,threshold:.2,location:0,distance:1e4,maxPatternLength:16,minMatchCharLength:2,keys:["label"]})}setupParams(o){const s=this;return{delay:50,source(T,j){const q=s.fuzzySearch(o,T.term);j(s.augmentedResultSet(o,q))},select:(T,j)=>{"match"===j.item.render&&s.onItemSelected(j.item.object)},create:()=>s.input.focus(),response:(T,j)=>{s.onNoResultsFound(T,j)},autoFocus:!0,minLength:0}}}{constructor(o,s,T,j,q,fe){super("projectMenuAutocomplete"),this.PathHelper=o,this.elementRef=s,this.http=T,this.cdRef=j,this.I18n=q,this.currentProject=fe,this.results=null,this.loaded=!1,this.text={label:q.t("js.projects.autocompleter.label"),no_results:q.t("js.notice_no_principals_found"),loading:q.t("js.ajax.loading")}}ngOnInit(){this.$element=jQuery(this.elementRef.nativeElement),this.dropdownMenu=this.$element.parents("li.op-app-menu--item_has-dropdown"),this.input=this.$element.find(".project-menu-autocomplete--input"),this.noResults=this.$element.find(".project-menu-autocomplete--no-results"),this.dropdownMenu.on("opened",()=>this.open()),this.dropdownMenu.on("closed",()=>this.close())}close(){try{this.input.projectMenuAutocomplete("destroy")}catch(o){console.warn("Failed to destroy autocomplete: %O",o)}this.$element.find(".project-search-results").css("visibility","hidden")}open(){this.$element.find(".project-search-results").css("visibility","visible"),this.loadProjects().then(o=>{const s=_.map(o,T=>({label:T.name,render:"match",object:T}));this.setup(this.input,s),this.addInputHandlers(),this.addClickHandler(),this.loaded=!0,this.cdRef.detectChanges(),this.scrollCurrentProjectIntoView()})}get maxItemsPerPage(){return 250}onItemSelected(o){window.location.href=this.projectLink(o.identifier)}onNoResultsFound(o,s){this.noResults.toggle(0===s.content.length)}renderItem(o,s){const T=jQuery("<a>").attr("href",this.projectLink(o.object.identifier)).text(o.label).appendTo(s);o.object.level>0&&T.text(`\xbb ${o.label}`).css("padding-left",4+16*o.object.level+"px"),o.object.identifier===this.currentProject.identifier&&s.addClass("selected")}projectLink(o){const s=jQuery('meta[name="current_menu_item"]').attr("content");let T=this.PathHelper.projectPath(o);return s&&(T+=`?jump=${encodeURIComponent(s)}`),T}get loadingText(){return this.loaded?"":this.text.loading}loadProjects(){if(null!==this.results)return Promise.resolve(this.results);const o=this.PathHelper.projectLevelListPath();return this.http.get(o).toPromise().then(s=>this.results=this.augmentWithParents(s.projects))}augmentWithParents(o){const s=[];let T=-1;return o.map(j=>{for(;T>=j.level;)s.pop(),T--;return s.push(j),T=j.level,j.parents=s.slice(0,-1),j})}augmentedResultSet(o,s){const T=s.map(fe=>fe.object.identifier),j=_.flatten(s.map(fe=>fe.object.parents)),q=[];return o.forEach(fe=>{const{identifier:Be}=fe.object;let Ye;if(T.indexOf(Be)>=0)Ye="match";else{if(!_.find(j,at=>at.identifier===Be))return;Ye="disabled"}q.push({label:fe.label,object:fe.object,render:Ye})}),q}addInputHandlers(){this.input.off("blur"),this.input.keydown(o=>o.which!==Qs.m.ESCAPE||(this.input.val(""),this.input[this.widgetName].call(this.input,"search",""),!1))}addClickHandler(){let o=!1;this.$element.find(".project-menu-autocomplete--results").on("click",".ui-menu-item a",s=>((0,Qr.F)(s)&&s.stopImmediatePropagation(),!0)).on("touchend",".ui-menu-item a",s=>{o||(window.location.href=s.target.href)}).on("touchmove",".ui-menu-item a",()=>{o=!0}).on("touchstart",".ui-menu-item a",()=>{o=!1})}setupParams(o){const s=super.setupParams(o);return s.appendTo=".project-menu-autocomplete--wrapper",s.classes={"ui-autocomplete":"-inplace project-menu-autocomplete--results"},s.position={of:".project-menu-autocomplete--input-container"},s}scrollCurrentProjectIntoView(){const o=document.querySelector(".ui-menu-item-wrapper.selected");if(!o)return;const s=o.offsetHeight,T=document.getElementsByClassName("project-menu-autocomplete--results")[0],j=o.offsetTop-T.offsetHeight/2+s/2;T.scrollTop=j%s==0?j:j-j%s}}os.\u0275fac=function(o){return new(o||os)(e.Y36(Fe.j),e.Y36(e.SBq),e.Y36(mi.eN),e.Y36(e.sBO),e.Y36(w.D),e.Y36(x.R))},os.\u0275cmp=e.Xpm({type:os,selectors:[["project-menu-autocomplete"]],features:[e.qOj],decls:7,vars:3,consts:[["id","project_autocompletion_wrapper",1,"dropdown","dropdown-relative","project-search-results"],[1,"project-menu-autocomplete--wrapper"],[1,"project-menu-autocomplete--input-container"],["for","project_autocompletion_input",1,"hidden-for-sighted",3,"textContent"],["type","text","id","project_autocompletion_input","name","project_autocompletion_input",1,"ui-autocomplete--input","project-menu-autocomplete--input"],[1,"project-menu-autocomplete--search-icon","icon-search"],["hidden","",1,"project-menu-autocomplete--no-results",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"label",3),e._UZ(4,"input",4),e._UZ(5,"i",5),e.qZA(),e._UZ(6,"p",6),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("textContent",s.text.label),e.xp6(1),e.uIk("placeholder",s.loadingText),e.xp6(2),e.Q6J("textContent",s.text.no_results))},encapsulation:2,changeDetection:0});class ss{constructor(o,s){this.elementRef=o,this.http=s}ngOnInit(){const o=jQuery(this.elementRef.nativeElement),s=o.parent();this.inputs=s.find(".remote-field--input"),this.target=s.find(".remote-field--target"),this.url=o.data("url"),this.htmlMode="html"===o.data("mode"),this.inputs.on("keyup change",_.debounce(T=>{const j=[Qs.m.TAB,Qs.m.ENTER,Qs.m.SHIFT];("change"===T.type||T.which&&-1===j.indexOf(T.which))&&this.updater()},500))}request(o){const s={};return this.htmlMode?s.Accept="text/html":s.Accept="application/json",this.http.get(this.url,{params:o,headers:s,responseType:this.htmlMode?"text":"json",withCredentials:!0})}updater(){const o={};this.inputs.each((s,T)=>{o[T.dataset.remoteFieldKey]=T.value}),this.request(o).subscribe(s=>{this.htmlMode?this.target.html(s):_.each(s,(T,j)=>{const q=document.getElementById(j);q instanceof HTMLInputElement?q.value=T:q&&(q.textContent=T)})})}}ss.\u0275fac=function(o){return new(o||ss)(e.Y36(e.SBq),e.Y36(mi.eN))},ss.\u0275cmp=e.Xpm({type:ss,selectors:[["remote-field-updater"]],decls:0,vars:0,template:function(o,s){},encapsulation:2});var Ns,Yr=t(75867),$r=t(84272);let Vi=Ns=class extends hi.N{constructor(o,s,T,j,q,fe,Be,Ye){super(),this.elementRef=o,this.apiV3Service=s,this.I18n=T,this.states=j,this.opStaticQueries=q,this.mainMenuService=fe,this.cdRef=Be,this.viewsService=Ye,this.text={search:this.I18n.t("js.toolbar.search_query_label"),label:this.I18n.t("js.toolbar.search_query_label"),scope_default:this.I18n.t("js.label_default_queries"),scope_starred:this.I18n.t("js.label_starred_queries"),scope_global:this.I18n.t("js.label_global_queries"),scope_private:this.I18n.t("js.label_custom_queries"),scope_new:this.I18n.t("js.label_create_new_query"),no_results:this.I18n.t("js.work_packages.query.text_no_results")},this.menuItems=[],this.viewCategories$=new S.X([]),this.search$=new S.X(""),this.initialized=!1}set search(o){this.search$.value!==o&&this.search$.next(o)}ngOnInit(){this.apiViewType=`Views::${this.viewType}`,this.mainMenuService.onActivate(...this.menuItems).subscribe(()=>this.initializeAutocomplete()),this.views$=(0,zi.aj)([this.search$,this.viewCategories$]).pipe((0,Di.U)(([o,s])=>s.map(T=>{var j;if(Ns.matchesText(T.title,o))return T;const q=null===(j=T.children)||void 0===j?void 0:j.filter(fe=>Ns.matchesText(fe.title,o));return{title:T.title,children:q,collapsible:!0}}).filter(T=>T.children&&T.children.length>0)))}initializeAutocomplete(){var o,s;if(this.initialized)return;const T=null===(s=null===(o=document.getElementById("main-menu-work-packages-wrapper"))||void 0===o?void 0:o.parentElement)||void 0===s?void 0:s.getElementsByClassName("main-menu--arrow-left-to-project")[0];T&&T.focus(),this.updateMenuOnChanges(),this.initializeViews(),this.initialized=!0}static matchesText(o,s){return o.toLowerCase().includes(s.toLowerCase())}initializeViews(){var o,s;const T={starred:[],default:[],public:[],private:[],createNew:[]},j={filters:[["type","=",[this.apiViewType]]]};this.projectId?null===(o=j.filters)||void 0===o||o.push(["project","=",[this.projectId]]):null===(s=j.filters)||void 0===s||s.push(["project","!*",[]]),this.viewsService.fetchViews(j).pipe(this.untilDestroyed()).subscribe(q=>{q._embedded.elements.sort((Ye,at)=>Ye._links.query.title.localeCompare(at._links.query.title)).forEach(Ye=>{let at="private";Ye.public&&(at="public"),Ye.starred&&(at="starred"),T[at].push(this.toOpSideMenuItem(Ye))});const fe=this.opStaticQueries.getStaticQueriesForView(this.viewType),Be=[{title:this.text.scope_starred,children:T.starred,collapsible:!0},{title:this.text.scope_default,children:fe,collapsible:!0},{title:this.text.scope_global,children:T.public,collapsible:!0},{title:this.text.scope_private,children:T.private,collapsible:!0}];this.viewCategories$.next(Be)})}toOpSideMenuItem(o){const{query:s}=o._links;return{title:s.title,uiSref:this.baseRoute,uiParams:{query_id:(0,Ee.Z)(s.href),query_props:""},uiOptions:{reload:!0}}}updateMenuOnChanges(){this.states.changes.queries.pipe(this.untilDestroyed()).subscribe(()=>this.initializeViews())}};Vi.\u0275fac=function(o){return new(o||Vi)(e.Y36(e.SBq),e.Y36(O.T),e.Y36(w.D),e.Y36(u.G),e.Y36(Yr.p),e.Y36(Yi),e.Y36(e.sBO),e.Y36($r.s))},Vi.\u0275cmp=e.Xpm({type:Vi,selectors:[["op-view-select"]],inputs:{menuItems:"menuItems",projectId:"projectId",baseRoute:"baseRoute",viewType:"viewType"},features:[e.qOj],decls:10,vars:12,consts:[["id","viewSelect",1,"searchable-menu"],[1,"searchable-menu--search-container"],[1,"searchable-menu--search-bar"],["for","query-title-filter",1,"hidden-for-sighted",3,"textContent"],["type","text","name","query-title-filter","id","query-title-filter",1,"searchable-menu--search-input","ellipsis",3,"ngModel","ngModelChange"],[1,"icon-search","searchable-menu--search-icon"],[1,"searchable-menu--no-results-container",3,"hidden","textContent"],[1,"op-view-select--search-results",3,"items","collapsible","searchable"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"label",3),e.TgZ(4,"input",4),e.NdJ("ngModelChange",function(j){return s.search=j}),e.qZA(),e._UZ(5,"i",5),e.qZA(),e._UZ(6,"p",6),e.ALo(7,"async"),e._UZ(8,"op-sidemenu",7),e.ALo(9,"async"),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("textContent",s.text.label),e.xp6(1),e.Q6J("ngModel",s.search),e.uIk("placeholder",s.text.search),e.xp6(2),e.Q6J("hidden",e.lcZ(7,8,s.views$).length>0)("textContent",s.text.no_results),e.xp6(2),e.Q6J("items",e.lcZ(9,10,s.views$))("collapsible",!0)("searchable",!0))},directives:[c.Fj,c.JJ,c.On,$i],pipes:[I.Ov],encapsulation:2,changeDetection:0}),Vi=Ns=(0,se.gn)([Us.z,(0,se.w6)("design:paramtypes",[e.SBq,O.T,w.D,u.G,Yr.p,Yi,e.sBO,$r.s])],Vi);class no extends hi.N{constructor(o,s,T,j,q){super(),this.elementRef=o,this.cdRef=s,this.globalSearchService=T,this.I18n=j,this.injector=q,this.text={all_projects:this.I18n.t("js.global_search.title.all_projects"),project_and_subprojects:this.I18n.t("js.global_search.title.project_and_subprojects"),search_for:this.I18n.t("js.global_search.title.search_for"),in:this.I18n.t("js.label_in")}}ngOnInit(){(0,zi.aj)([this.globalSearchService.searchTerm$,this.globalSearchService.projectScope$]).pipe((0,qi.x)(),this.untilDestroyed()).subscribe(([o,s])=>{this.searchTerm=o,this.project=this.projectText(s),this.searchTitle=`${this.text.search_for} ${this.searchTerm} ${""===this.project?"":this.text.in} ${this.project}`,this.cdRef.detectChanges()})}projectText(o){const s=this.currentProjectService.name?this.currentProjectService.name:"";switch(o){case"all":return this.text.all_projects;case"current_project":return s;case"":return`${s} ${this.text.project_and_subprojects}`;default:return""}}}function $d(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"a",16),e.NdJ("click",function(j){e.CHM(s);const q=e.oxw().$implicit;return e.oxw().clickTab(q,j)}),e.qZA()}if(2&f){const s=e.oxw().$implicit,T=e.oxw();e.ekj("op-tab-row--link_selected",s.id===T.currentTabId)("op-tab-row--link_disabled",void 0!==s.disable),e.Q6J("href",s.path,e.LSH)("textContent",s.name),e.uIk("title",T.tabTitle(s))}}function Vd(f,o){if(1&f&&(e._UZ(0,"op-tab-count",21),e.ALo(1,"async")),2&f){const s=e.oxw(2).$implicit,T=e.oxw();e.Q6J("count",e.lcZ(1,2,s.counter(T.injector))),e.uIk("data-qa-selector","tab-counter-"+s.name)}}function Hd(f,o){if(1&f&&(e.TgZ(0,"span",23),e._uU(1),e.qZA()),2&f){const s=e.oxw().ngIf;e.xp6(1),e.hij(" (",s,")")}}function Kd(f,o){if(1&f&&(e.ynx(0),e.YNc(1,Hd,2,1,"span",22),e.BQk()),2&f){const s=o.ngIf,T=e.oxw(2).$implicit;e.xp6(1),e.Q6J("ngIf",s>0&&!T.showCountAsBubble)}}function Gd(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"a",17),e.NdJ("click",function(j){e.CHM(s);const q=e.oxw().$implicit;return e.oxw().clickTab(q,j)}),e._UZ(1,"span",18),e.YNc(2,Vd,2,4,"op-tab-count",19),e.YNc(3,Kd,2,1,"ng-container",20),e.ALo(4,"async"),e.qZA()}if(2&f){const s=e.oxw().$implicit,T=e.oxw();e.ekj("op-tab-row--link_disabled",void 0!==s.disable),e.Q6J("uiSref",s.route)("uiParams",s.routeParams),e.uIk("title",T.tabTitle(s)),e.xp6(1),e.Q6J("textContent",s.name),e.xp6(1),e.Q6J("ngIf",s.counter&&s.showCountAsBubble),e.xp6(1),e.Q6J("ngIf",e.lcZ(4,8,s.counter(T.injector)))}}function zd(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"li",13),e.NdJ("dragenter",function(){const q=e.CHM(s).$implicit;return e.oxw().startDebouncedTabActivation(q)})("dragleave",function(){return e.CHM(s),e.oxw().cancelDebouncedTabActivation()}),e.YNc(1,$d,1,7,"a",14),e.YNc(2,Gd,5,10,"a",15),e.qZA()}if(2&f){const s=o.$implicit,T=e.oxw();e.uIk("data-tab-id",s.id)("data-qa-tab-id",s.id)("data-qa-tab-selected",s.id===T.currentTabId||void 0)("data-qa-tab-disabled",s.disable||void 0),e.xp6(1),e.Q6J("ngIf",!s.route),e.xp6(1),e.Q6J("ngIf",s.route)}}no.\u0275fac=function(o){return new(o||no)(e.Y36(e.SBq),e.Y36(e.sBO),e.Y36(Fi),e.Y36(w.D),e.Y36(e.zs3))},no.\u0275cmp=e.Xpm({type:no,selectors:[["global-search-title"]],inputs:{searchTerm:"searchTerm",project:"project",projectScope:"projectScope",searchTitle:"searchTitle"},features:[e.qOj],decls:11,vars:5,consts:[[1,"toolbar-container"],[1,"toolbar"],[1,"title-container"],[1,"toolbar-items"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e.TgZ(3,"h2"),e._uU(4),e.TgZ(5,"i"),e._uU(6),e.qZA(),e._uU(7),e.TgZ(8,"i"),e._uU(9),e.qZA(),e.qZA(),e._UZ(10,"ul",3),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.uIk("title",s.searchTitle),e.xp6(1),e.hij(" ",s.text.search_for," "),e.xp6(2),e.hij('"',s.searchTerm,'"'),e.xp6(1),e.hij(" ",""===s.project?"":s.text.in," "),e.xp6(2),e.Oqu(s.project))},encapsulation:2}),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",x.R)],no.prototype,"currentProjectService",void 0);const qd=[[["","slot","actions"]]];class rs extends Tt.P{constructor(o,s,T,j){super(s,j,T),this.globalSearchService=o,this.$state=s,this.injector=T,this.classes=["global-search--tabs","scrollable-tabs"]}ngOnInit(){this.currentTabSub=this.globalSearchService.currentTab$.subscribe(o=>{this.currentTabId=o}),this.tabsSub=this.globalSearchService.tabs$.subscribe(o=>{this.tabs=o,this.tabs.map(s=>s.path="#")})}clickTab(o,s){super.clickTab(o,s),this.globalSearchService.currentTab=o.id,this.globalSearchService.submitSearch()}ngOnDestroy(){this.currentTabSub.unsubscribe(),this.tabsSub.unsubscribe()}}rs.\u0275fac=function(o){return new(o||rs)(e.Y36(Fi),e.Y36(ge.StateService),e.Y36(e.zs3),e.Y36(e.sBO))},rs.\u0275cmp=e.Xpm({type:rs,selectors:[["global-search-tabs"]],features:[e.qOj],ngContentSelectors:["[slot=actions]"],decls:14,vars:5,consts:[[1,"op-scrollable-tabs",3,"ngClass"],[1,"op-scrollable-tabs--tab-container"],["scrollContainer",""],[1,"op-tab-row",3,"scroll"],["scrollPane",""],["class","op-tab-row--tab",3,"dragenter","dragleave",4,"ngFor","ngForOf","ngForTrackBy"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_left",3,"hidden","click"],["scrollLeftBtn",""],[1,"icon-arrow-left2"],[1,"op-scrollable-tabs--button","op-scrollable-tabs--button_right",3,"hidden","click"],["scrollRightBtn",""],[1,"icon-arrow-right2"],[1,"op-scrollable-tabs--actions"],[1,"op-tab-row--tab",3,"dragenter","dragleave"],["class","op-tab-row--link",3,"href","op-tab-row--link_selected","op-tab-row--link_disabled","textContent","click",4,"ngIf"],["class","op-tab-row--link","uiSrefActive","op-tab-row--link_selected","href","","role","button",3,"uiSref","uiParams","op-tab-row--link_disabled","click",4,"ngIf"],[1,"op-tab-row--link",3,"href","textContent","click"],["uiSrefActive","op-tab-row--link_selected","href","","role","button",1,"op-tab-row--link",3,"uiSref","uiParams","click"],[3,"textContent"],[3,"count",4,"ngIf"],[4,"ngIf"],[3,"count"],["data-qa-selector","tab-count",4,"ngIf"],["data-qa-selector","tab-count"]],template:function(o,s){1&o&&(e.F$t(qd),e.TgZ(0,"div",0),e.TgZ(1,"div",1,2),e.TgZ(3,"ul",3,4),e.NdJ("scroll",function(){return s.onScroll()}),e.YNc(5,zd,3,6,"li",5),e.qZA(),e.TgZ(6,"div",6,7),e.NdJ("click",function(){return s.scrollLeft()}),e._UZ(8,"span",8),e.qZA(),e.TgZ(9,"div",9,10),e.NdJ("click",function(){return s.scrollRight()}),e._UZ(11,"span",11),e.qZA(),e.qZA(),e.TgZ(12,"ul",12),e.Hsn(13),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngClass",s.classes),e.xp6(5),e.Q6J("ngForOf",s.tabs)("ngForTrackBy",s.trackById),e.xp6(1),e.Q6J("hidden",s.hideLeftButton),e.xp6(3),e.Q6J("hidden",s.hideRightButton))},directives:[I.mk,I.sg,I.O5,Vt.AnchorUISref,Vt.UISrefActive,Vt.UISrefStatus,Vt.UISref],pipes:[I.Ov],encapsulation:2,changeDetection:0});var tp=t(51784);function ip(f,o){if(1&f&&e._UZ(0,"op-principal",3),2&f){const s=e.oxw().item;e.Q6J("principal",s)("hideName",!0)}}function np(f,o){if(1&f&&(e.YNc(0,ip,1,2,"op-principal",2),e._uU(1)),2&f){const s=o.item;e.Q6J("ngIf",s&&s.href),e.xp6(1),e.hij(" ",s.name," ")}}class nn extends pr.U{getAvailableUsers(o,s){return this.http.get(o,{params:new mi.LE({encoder:new tp.c,fromObject:{q:s}}),responseType:"json",headers:{"Content-Type":"application/json; charset=utf-8"}})}}nn.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(nn)))(s||nn)}}(),nn.\u0275cmp=e.Xpm({type:nn,selectors:[["members-autocompleter"]],features:[e.qOj],decls:4,vars:12,consts:[["bindLabel","name","bindValue","id",3,"items","ngModel","virtualScroll","trackByFn","typeahead","loading","appendTo","multiple","focus","change"],["ng-option-tmp",""],["size","mini",3,"principal","hideName",4,"ngIf"],["size","mini",3,"principal","hideName"]],template:function(o,s){1&o&&(e.TgZ(0,"ng-select",0),e.NdJ("focus",function(){return s.onFocus()})("change",function(j){return s.onModelChange(j)}),e.ALo(1,"async"),e.ALo(2,"async"),e.YNc(3,np,2,2,"ng-template",1),e.qZA()),2&o&&e.Q6J("items",e.lcZ(1,8,s.requests.output$))("ngModel",s.initialSelection)("virtualScroll",!0)("trackByFn",s.userTracker)("typeahead",s.requests.input$)("loading",e.lcZ(2,10,s.requests.loading$))("appendTo",s.appendTo)("multiple",s.multiple)},directives:[lr.w9,c.JJ,c.On,lr.Z2,I.O5,ve.N],pipes:[I.Ov],encapsulation:2}),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",mi.eN)],nn.prototype,"http",void 0),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",Fe.j)],nn.prototype,"pathHelper",void 0);class Ai{constructor(o){this.injector=o,this.text={edit:this.i18n.t("js.button_edit"),delete:this.i18n.t("js.button_delete"),error:this.i18n.t("js.error.internal"),areYouSure:this.i18n.t("js.text_are_you_sure")}}editTimeEntry(){this.loadEntry().then(o=>{this.timeEntryEditService.edit(o).then(()=>{window.location.reload()}).catch(()=>{})})}deleteTimeEntry(){!window.confirm(this.text.areYouSure)||this.loadEntry().then(o=>{this.apiv3Service.time_entries.id(o).delete().subscribe(()=>window.location.reload(),s=>this.toastService.addError(s||this.text.error))})}loadEntry(){const o=this.elementRef.nativeElement.dataset.entry;return this.apiv3Service.time_entries.id(o).get().toPromise()}}Ai.\u0275fac=function(o){return new(o||Ai)(e.Y36(e.zs3))},Ai.\u0275cmp=e.Xpm({type:Ai,selectors:[["time-entry--trigger-actions-entry"]],features:[e._Bn([Re.l,$e.d])],decls:4,vars:2,consts:[[1,"no-decoration-on-hover",3,"title","click"],["icon-classes","icon-context icon-edit"],["icon-classes","icon-context icon-delete"]],template:function(o,s){1&o&&(e.TgZ(0,"a",0),e.NdJ("click",function(){return s.editTimeEntry()}),e._UZ(1,"op-icon",1),e.qZA(),e.TgZ(2,"a",0),e.NdJ("click",function(){return s.deleteTimeEntry()}),e._UZ(3,"op-icon",2),e.qZA()),2&o&&(e.Q6J("title",s.text.edit),e.xp6(2),e.Q6J("title",s.text.delete))},directives:[ut.o],encapsulation:2,changeDetection:0}),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",$e.d)],Ai.prototype,"timeEntryEditService",void 0),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",O.T)],Ai.prototype,"apiv3Service",void 0),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",M.kl)],Ai.prototype,"toastService",void 0),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",e.SBq)],Ai.prototype,"elementRef",void 0),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",w.D)],Ai.prototype,"i18n",void 0),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",e.sBO)],Ai.prototype,"cdRef",void 0);var Vr=t(67731),as=t(60874),rp=t(90425),Hr=t(45871);class Tn{constructor(o,s,T,j){this.apiV3Service=o,this.transitions=s,this.currentProject=T,this.I18n=j,this.text={not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found")},this.cache$=(0,yn.r9)(),s.onStart({},()=>(this.cache$.clear(),!0))}require(o,s){const T=`${o}-${s}`,j=this.cache$.get(T);if(j.isPristine()){const q=this.load(o,s).pipe((0,wi.h)(fe=>!!fe)).toPromise();return j.clearAndPutFromPromise(q),q}return j.values$().pipe((0,Rn.q)(1),(0,Ls.b)(q=>console.log(`VAL ${q}`),q=>console.error(`ERR ${q}`))).toPromise()}load(o,s){switch(o){case"workPackage":return this.loadWorkPackage(s);case"project":return this.loadProject(s);default:return rp.C}}loadProject(o){return(o=o||this.currentProject.id)?this.apiV3Service.projects.id(o).get().pipe((0,Rn.q)(1)):(0,Hr._)(this.text.not_found)}loadWorkPackage(o){return o?/^[1-9]\d*$/.test(o)?this.apiV3Service.work_packages.id(o).get().pipe((0,Rn.q)(1)):this.apiV3Service.withOptionalProject(this.currentProject.id).work_packages.filterByTypeaheadOrId(o,!1,{pageSize:"1"}).get().pipe((0,Rn.q)(1),(0,Di.U)(s=>s.elements[0]||null)):(0,Hr._)(this.text.not_found)}}Tn.\u0275fac=function(o){return new(o||Tn)(e.LFG(O.T),e.LFG(ge.TransitionService),e.LFG(x.R),e.LFG(w.D))},Tn.\u0275prov=e.Yz7({token:Tn,factory:Tn.\u0275fac,providedIn:"root"});const ap=["displayFieldContainer"];class oo{constructor(o,s,T){this.injector=o,this.displayFieldService=s,this.schemaCache=T,this.containerType="table",this.displayFieldOptions={}}ngOnInit(){this.schemaCache.ensureLoaded(this.resource).then(o=>{this.render(o[this.fieldName])})}render(o){const s=this.getDisplayFieldInstance(o),T=this.container.nativeElement;T.hidden=!1,s.isEmpty()?T.textContent="-":s.render(T,s.valueString)}getDisplayFieldInstance(o){if(this.displayClass){const s=new this.displayClass(this.fieldName,this.displayFieldContext);return s.apply(this.resource,o),s}return this.displayFieldService.getField(this.resource,this.fieldName,o,this.displayFieldContext)}get displayFieldContext(){return{injector:this.injector,container:this.containerType,options:this.displayFieldOptions}}}oo.\u0275fac=function(o){return new(o||oo)(e.Y36(e.zs3),e.Y36(as.i),e.Y36(Ue.y))},oo.\u0275cmp=e.Xpm({type:oo,selectors:[["display-field"]],viewQuery:function(o,s){if(1&o&&e.Gf(ap,5),2&o){let T;e.iGM(T=e.CRH())&&(s.container=T.first)}},inputs:{resource:"resource",fieldName:"fieldName",displayClass:"displayClass",containerType:"containerType",displayFieldOptions:"displayFieldOptions"},decls:2,vars:0,consts:[["displayFieldContainer",""]],template:function(o,s){1&o&&e._UZ(0,"span",null,0)},encapsulation:2,changeDetection:0});const cp=["displayContainer"];function dp(f,o){if(1&f&&(e.TgZ(0,"span"),e._UZ(1,"i",2),e._UZ(2,"em",3),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.error)}}const pp=function(){return{writable:!1}};function up(f,o){if(1&f&&e._UZ(0,"display-field",4),2&f){const s=e.oxw();e.Q6J("resource",s.resource)("displayFieldOptions",e.DdM(3,pp))("fieldName",s.fieldName)}}class cs{constructor(o,s,T,j,q,fe,Be){this.elementRef=o,this.injector=s,this.resourceLoader=T,this.schemaCache=j,this.displayField=q,this.I18n=fe,this.cdRef=Be,this.error=null,this.text={help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip"),placeholder:this.I18n.t("js.placeholders.default"),not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),invalid_attribute:Ye=>this.I18n.t("js.editor.macro.attribute_reference.invalid_attribute",{name:Ye})},this.hostTitle=this.text.help}ngOnInit(){const o=this.elementRef.nativeElement,s=o.dataset.model,T=o.dataset.id,j=o.dataset.attribute;this.loadAndRender(s,T,j)}loadAndRender(o,s,T){return(0,se.mG)(this,void 0,void 0,function*(){let j;try{j=yield this.resourceLoader.require(o,s)}catch(Ye){return console.error(`Failed to render macro ${Ye}`),this.markError(this.text.not_found)}if(!j)return void this.markError(this.text.not_found);const q=yield this.schemaCache.ensureLoaded(j),fe=q.attributeFromLocalizedName(T)||T;q[fe]?(this.resource=j,this.fieldName=fe):this.markError(this.text.invalid_attribute(T)),this.cdRef.detectChanges()})}markError(o){this.error=this.I18n.t("js.editor.macro.error",{message:o}),this.cdRef.detectChanges()}}cs.\u0275fac=function(o){return new(o||cs)(e.Y36(e.SBq),e.Y36(e.zs3),e.Y36(Tn),e.Y36(Ue.y),e.Y36(as.i),e.Y36(w.D),e.Y36(e.sBO))},cs.\u0275cmp=e.Xpm({type:cs,selectors:[["macro",8,"macro--attribute-value"]],viewQuery:function(o,s){if(1&o&&e.Gf(cp,5),2&o){let T;e.iGM(T=e.CRH())&&(s.displayContainer=T.first)}},hostVars:1,hostBindings:function(o,s){2&o&&e.Ikx("title",s.hostTitle)},features:[e._Bn([Re.l])],attrs:["class","macro--attribute-value"],decls:2,vars:2,consts:[[4,"ngIf"],[3,"resource","displayFieldOptions","fieldName",4,"ngIf"],[1,"icon","icon-error"],[3,"textContent"],[3,"resource","displayFieldOptions","fieldName"]],template:function(o,s){1&o&&(e.YNc(0,dp,3,1,"span",0),e.YNc(1,up,1,4,"display-field",1)),2&o&&(e.Q6J("ngIf",s.error),e.xp6(1),e.Q6J("ngIf",!!s.resource))},directives:[I.O5,oo],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline-block;background:rgba(218,223,225,.19);border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:#c7c7c7;background:rgba(218,223,225,.75)}}"],changeDetection:0});function gp(f,o){if(1&f&&(e.ynx(0),e._UZ(1,"span",1),e._UZ(2,"attribute-help-text",2),e.BQk()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("textContent",s.label),e.xp6(1),e.Q6J("attribute",s.attribute)("attributeScope",s.attributeScope)}}function fp(f,o){if(1&f&&(e.TgZ(0,"span"),e._UZ(1,"i",3),e._UZ(2,"em",1),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.error)}}class ls{constructor(o,s,T,j,q,fe,Be){this.elementRef=o,this.injector=s,this.resourceLoader=T,this.schemaCache=j,this.displayField=q,this.I18n=fe,this.cdRef=Be,this.error=null,this.text={help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip"),not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),invalid_attribute:Ye=>this.I18n.t("js.editor.macro.attribute_reference.invalid_attribute",{name:Ye})},this.hostTitle=this.text.help,this.resource=null}ngOnInit(){const o=this.elementRef.nativeElement,s=o.dataset.model,T=o.dataset.id,j=o.dataset.attribute;this.attributeScope=function(f){return f.charAt(0).toUpperCase()+f.slice(1)}(s),this.loadResourceAttribute(s,T,j)}loadResourceAttribute(o,s,T){var j;return(0,se.mG)(this,void 0,void 0,function*(){let q;try{this.resource=q=yield this.resourceLoader.require(o,s)}catch(Be){return console.error(`Failed to render macro ${Be}`),this.markError(this.text.not_found)}if(!q)return void this.markError(this.text.not_found);const fe=yield this.schemaCache.ensureLoaded(q);this.attribute=fe.attributeFromLocalizedName(T)||T,this.label=null===(j=fe[this.attribute])||void 0===j?void 0:j.name,this.label||this.markError(this.text.invalid_attribute(T)),this.cdRef.detectChanges()})}markError(o){this.error=this.I18n.t("js.editor.macro.error",{message:o}),this.cdRef.detectChanges()}}ls.\u0275fac=function(o){return new(o||ls)(e.Y36(e.SBq),e.Y36(e.zs3),e.Y36(Tn),e.Y36(Ue.y),e.Y36(as.i),e.Y36(w.D),e.Y36(e.sBO))},ls.\u0275cmp=e.Xpm({type:ls,selectors:[["macro",8,"macro--attribute-label"]],hostVars:1,hostBindings:function(o,s){2&o&&e.Ikx("title",s.hostTitle)},features:[e._Bn([Re.l])],attrs:["class","macro--attribute-label"],decls:2,vars:2,consts:[[4,"ngIf"],[3,"textContent"],[3,"attribute","attributeScope"],[1,"icon","icon-error"]],template:function(o,s){1&o&&(e.YNc(0,gp,3,3,"ng-container",0),e.YNc(1,fp,3,1,"span",0)),2&o&&(e.Q6J("ngIf",s.resource),e.xp6(1),e.Q6J("ngIf",s.error))},directives:[I.O5,Ei.y],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline-block;background:rgba(218,223,225,.19);border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:#c7c7c7;background:rgba(218,223,225,.75)}}"],changeDetection:0});var Cp=t(74215);const ds=function(){return{writable:!1}};function bp(f,o){if(1&f&&e._UZ(0,"display-field",5),2&f){const s=e.oxw().ngIf;e.Q6J("resource",s)("displayFieldOptions",e.DdM(2,ds))}}function wp(f,o){if(1&f&&e._UZ(0,"display-field",8),2&f){const s=e.oxw(2).ngIf;e.Q6J("resource",s)("displayFieldOptions",e.DdM(2,ds))}}function Tp(f,o){if(1&f&&e._UZ(0,"display-field",9),2&f){const s=e.oxw(2).ngIf,T=e.oxw();e.Q6J("resource",s)("displayFieldOptions",e.DdM(3,ds))("displayClass",T.dateDisplayField)}}function Pp(f,o){if(1&f&&(e.ynx(0),e._uU(1," ("),e.YNc(2,wp,1,3,"display-field",6),e.YNc(3,Tp,1,4,"display-field",7),e._uU(4,") "),e.BQk()),2&f){const s=e.oxw().ngIf;e.xp6(2),e.Q6J("ngIf",!!s.date),e.xp6(1),e.Q6J("ngIf",!s.date)}}function kp(f,o){if(1&f&&(e.ynx(0),e.YNc(1,bp,1,3,"display-field",1),e._UZ(2,"display-field",2),e.TgZ(3,"a",3),e._uU(4),e.qZA(),e._UZ(5,"display-field",4),e.YNc(6,Pp,5,2,"ng-container",0),e.BQk()),2&f){const s=o.ngIf,T=e.oxw();e.xp6(1),e.Q6J("ngIf",T.detailed),e.xp6(1),e.Q6J("resource",s)("displayFieldOptions",e.DdM(9,ds)),e.xp6(1),e.Q6J("href",T.workPackageLink,e.LSH),e.uIk("data-work-package-id",s.id),e.xp6(1),e.hij(" #",s.id,": "),e.xp6(1),e.Q6J("resource",s)("displayFieldOptions",e.DdM(10,ds)),e.xp6(1),e.Q6J("ngIf",T.detailed)}}function xp(f,o){if(1&f&&(e.TgZ(0,"span"),e._UZ(1,"i",10),e._UZ(2,"em",11),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.error)}}class ps{constructor(o,s,T,j,q,fe,Be,Ye){this.elementRef=o,this.injector=s,this.apiV3Service=T,this.schemaCache=j,this.displayField=q,this.pathHelper=fe,this.I18n=Be,this.cdRef=Ye,this.error=null,this.text={not_found:this.I18n.t("js.editor.macro.attribute_reference.not_found"),help:this.I18n.t("js.editor.macro.attribute_reference.macro_help_tooltip")},this.hostTitle=this.text.help,this.dateDisplayField=Cp.Z,this.detailed=!1}ngOnInit(){const o=this.elementRef.nativeElement,s=o.dataset.id;this.detailed="true"===o.dataset.detailed,this.workPackageLink=this.pathHelper.workPackagePath(s),this.workPackage$=this.apiV3Service.work_packages.id(s).get().pipe((0,Ls.b)({error:T=>this.markError(this.text.not_found)}))}markError(o){console.error(`Failed to render macro ${o}`),this.error=this.I18n.t("js.editor.macro.error",{message:o}),this.cdRef.detectChanges()}}ps.\u0275fac=function(o){return new(o||ps)(e.Y36(e.SBq),e.Y36(e.zs3),e.Y36(O.T),e.Y36(Ue.y),e.Y36(as.i),e.Y36(Fe.j),e.Y36(w.D),e.Y36(e.sBO))},ps.\u0275cmp=e.Xpm({type:ps,selectors:[["macro",8,"macro--wp-quickinfo"]],hostVars:1,hostBindings:function(o,s){2&o&&e.Ikx("title",s.hostTitle)},features:[e._Bn([Re.l])],attrs:["class","macro--wp-quickinfo"],decls:3,vars:4,consts:[[4,"ngIf"],["fieldName","status",3,"resource","displayFieldOptions",4,"ngIf"],["fieldName","type",3,"resource","displayFieldOptions"],[1,"work-package--quickinfo","preview-trigger",3,"href"],["fieldName","subject",3,"resource","displayFieldOptions"],["fieldName","status",3,"resource","displayFieldOptions"],["fieldName","date",3,"resource","displayFieldOptions",4,"ngIf"],["fieldName","startDate",3,"resource","displayFieldOptions","displayClass",4,"ngIf"],["fieldName","date",3,"resource","displayFieldOptions"],["fieldName","startDate",3,"resource","displayFieldOptions","displayClass"],[1,"icon","icon-error"],[3,"textContent"]],template:function(o,s){1&o&&(e.YNc(0,kp,7,11,"ng-container",0),e.ALo(1,"async"),e.YNc(2,xp,3,1,"span",0)),2&o&&(e.Q6J("ngIf",e.lcZ(1,2,s.workPackage$)),e.xp6(2),e.Q6J("ngIf",s.error))},directives:[I.O5,oo],pipes:[I.Ov],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}@media screen{[_nghost-%COMP%]{display:inline-block;background:rgba(218,223,225,.19);border:1px solid transparent;padding:2px}[_nghost-%COMP%]:hover{cursor:default;border-color:#c7c7c7;background:rgba(218,223,225,.75)}}display-field[_ngcontent-%COMP%]{padding-right:2px}"],changeDetection:0});var Kr=t(47124),Op=t(18137);class Pn{constructor(o){this.apiV3Service=o}triggerBackup(o,s=!0){return this.apiV3Service.backups.post(o,s)}}Pn.\u0275fac=function(o){return new(o||Pn)(e.LFG(O.T))},Pn.\u0275prov=e.Yz7({token:Pn,factory:Pn.\u0275fac,providedIn:"root"});const Mp=["backupTokenInput"];class so{constructor(o,s,T,j,q,fe){this.elementRef=o,this.injector=s,this.i18n=T,this.toastService=j,this.opModalService=q,this.pathHelper=fe,this.text={info:this.i18n.t("js.backup.info"),note:this.i18n.t("js.backup.note"),title:this.i18n.t("js.backup.title"),lastBackup:this.i18n.t("js.backup.last_backup"),lastBackupFrom:this.i18n.t("js.backup.last_backup_from"),includeAttachments:this.i18n.t("js.backup.include_attachments"),options:this.i18n.t("js.backup.options"),downloadBackup:this.i18n.t("js.backup.download_backup"),requestBackup:this.i18n.t("js.backup.request_backup"),attachmentsDisabled:this.i18n.t("js.backup.attachments_disabled")},this.jobStatusId=this.elementRef.nativeElement.dataset.jobStatusId,this.lastBackupDate=this.elementRef.nativeElement.dataset.lastBackupDate,this.lastBackupAttachmentId=this.elementRef.nativeElement.dataset.lastBackupAttachmentId,this.mayIncludeAttachments="false"!=this.elementRef.nativeElement.dataset.mayIncludeAttachments,this.isInProgress=!1,this.includeAttachments=!0,this.backupToken="",this.includeAttachments=this.mayIncludeAttachments}ngAfterViewInit(){this.backupTokenInput.nativeElement.focus()}isDownloadReady(){return void 0!==this.jobStatusId&&""!==this.jobStatusId&&void 0!==this.lastBackupAttachmentId&&""!==this.lastBackupAttachmentId}getDownloadUrl(){return this.pathHelper.attachmentDownloadPath(this.lastBackupAttachmentId,void 0)}includeAttachmentsDefault(){return this.mayIncludeAttachments}includeAttachmentsTitle(){return this.mayIncludeAttachments?"":this.text.attachmentsDisabled}triggerBackup(o){o&&(o.stopPropagation(),o.preventDefault());const{backupToken:s}=this;this.backupToken="",this.opBackup.triggerBackup(s,this.includeAttachments).subscribe(T=>{this.jobStatusId=T.jobStatusId,this.opModalService.show(Op.L,"global",{jobId:T.jobStatusId})},T=>{this.toastService.addError(T.message)})}}function Gr(f){const{locale:o}=I18n;return f[o]||f.en}function Sp(f,o){if(1&f&&(e.TgZ(0,"div",26),e._uU(1),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Oqu(s.eeTrialService.errorMsg)}}function Dp(f,o){if(1&f&&(e.TgZ(0,"div",27),e._uU(1),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Oqu(s.eeTrialService.errorMsg)}}so.\u0275fac=function(o){return new(o||so)(e.Y36(e.SBq),e.Y36(e.zs3),e.Y36(w.D),e.Y36(M.kl),e.Y36(it.S),e.Y36(Fe.j))},so.\u0275cmp=e.Xpm({type:so,selectors:[["backup"]],viewQuery:function(o,s){if(1&o&&e.Gf(Mp,5),2&o){let T;e.iGM(T=e.CRH())&&(s.backupTokenInput=T.first)}},decls:41,vars:17,consts:[["method","get",1,"form","-bordered","-compressed",3,"action","hidden"],[1,"form--section"],[1,"form--section-title"],[1,"form--field"],[1,"form--label"],[1,"form--field-container"],[1,"form--text-field-container"],["name","button","type","submit",1,"button"],[1,"button--icon","icon-save"],[1,"button--text"],["action","#",1,"form","danger-zone"],[1,"wiki"],[1,"danger-zone--warning"],[1,"icon","icon-error"],[1,"form--fieldset"],[1,"form--fieldset-legend"],[1,"form--label-with-check-box",3,"title"],[1,"form--check-box-container"],["type","checkbox",1,"form--check-box",3,"checked","disabled","change"],[1,"danger-zone--verification"],["type","password","name","backupToken","placeholder","Backup token","required","required",3,"value","input"],["backupTokenInput",""],["name","button","type","submit",1,"-highlight","button",3,"disabled","click"],[1,"button--icon","icon-export"]],template:function(o,s){1&o&&(e.TgZ(0,"form",0),e.TgZ(1,"section",1),e.TgZ(2,"h3",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"label",4),e._uU(6),e.qZA(),e.TgZ(7,"div",5),e.TgZ(8,"div",6),e.TgZ(9,"em"),e._uU(10),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(11,"button",7),e._UZ(12,"i",8),e.TgZ(13,"span",9),e._uU(14),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(15,"form",10),e.TgZ(16,"div",11),e.TgZ(17,"section",1),e.TgZ(18,"h3",2),e._uU(19),e.qZA(),e.TgZ(20,"p"),e._uU(21),e.qZA(),e.TgZ(22,"p",12),e._UZ(23,"span",13),e.TgZ(24,"span"),e._uU(25),e.qZA(),e.qZA(),e.TgZ(26,"div"),e.TgZ(27,"fieldset",14),e.TgZ(28,"legend",15),e._uU(29),e.qZA(),e.TgZ(30,"label",16),e.TgZ(31,"div",17),e.TgZ(32,"input",18),e.NdJ("change",function(){return s.includeAttachments=!s.includeAttachments}),e.qZA(),e.qZA(),e._uU(33),e.qZA(),e.qZA(),e.qZA(),e.TgZ(34,"div",19),e.TgZ(35,"input",20,21),e.NdJ("input",function(j){return s.backupToken=j.target.value}),e.qZA(),e.TgZ(37,"button",22),e.NdJ("click",function(j){return s.triggerBackup(j)}),e._UZ(38,"i",23),e.TgZ(39,"span",9),e._uU(40),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.Q6J("action",s.getDownloadUrl(),e.LSH)("hidden",!s.isDownloadReady()),e.xp6(3),e.hij(" ",s.text.lastBackup," "),e.xp6(3),e.hij("",s.text.lastBackupFrom,":"),e.xp6(4),e.Oqu(s.lastBackupDate),e.xp6(4),e.Oqu(s.text.downloadBackup),e.xp6(5),e.hij(" ",s.text.title," "),e.xp6(2),e.hij(" ",s.text.info," "),e.xp6(4),e.Oqu(s.text.note),e.xp6(4),e.hij(" ",s.text.options," "),e.xp6(1),e.Q6J("title",s.includeAttachmentsTitle()),e.xp6(2),e.Q6J("checked",s.includeAttachments)("disabled",!s.mayIncludeAttachments),e.xp6(1),e.hij(" ",s.text.includeAttachments," "),e.xp6(2),e.Q6J("value",s.backupToken),e.xp6(2),e.Q6J("disabled",0==s.backupToken.length),e.xp6(3),e.Oqu(s.text.requestBackup))},encapsulation:2}),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",Pn)],so.prototype,"opBackup",void 0);const zr=function(f){return{"-required-highlighting":f}};class ro{constructor(o,s,T,j,q){this.elementRef=o,this.I18n=s,this.formBuilder=T,this.currentUserService=j,this.eeTrialService=q,this.userData=this.eeTrialService.userData$.getValueOr({}),this.trialForm=this.formBuilder.group({company:[this.userData.company,c.kI.required],first_name:[this.userData.first_name,c.kI.required],last_name:[this.userData.last_name,c.kI.required],email:["",[c.kI.required,c.kI.email]],domain:[this.userData.domain||window.location.host,c.kI.required],general_consent:[null,c.kI.required],newsletter_consent:null,language:this.currentUserService.language}),this.text={general_consent:this.I18n.t("js.admin.enterprise.trial.form.general_consent",{link_terms:Gr({en:"https://www.openproject.com/terms-of-service/",de:"https://www.openproject.org/de/nutzungsbedingungen/"}),link_privacy:Gr({en:"https://www.openproject.org/data-privacy-and-security/",de:"https://www.openproject.org/de/datenschutz/"})}),label_test_ee:this.I18n.t("js.admin.enterprise.trial.form.test_ee"),label_company:this.I18n.t("js.admin.enterprise.trial.form.label_company"),label_first_name:this.I18n.t("js.admin.enterprise.trial.form.label_first_name"),label_last_name:this.I18n.t("js.admin.enterprise.trial.form.label_last_name"),label_email:this.I18n.t("js.label_email"),label_domain:this.I18n.t("js.admin.enterprise.trial.form.label_domain"),privacy_policy:this.I18n.t("js.admin.enterprise.trial.form.privacy_policy"),receive_newsletter:this.I18n.t("js.admin.enterprise.trial.form.receive_newsletter",{link:"https://www.openproject.com/newsletter/"}),terms_of_service:this.I18n.t("js.admin.enterprise.trial.form.terms_of_service")}}checkMailField(){""!==this.trialForm.value.email&&this.trialForm.controls.email.errors?this.eeTrialService.emailInvalid=!0:(this.eeTrialService.emailInvalid=!1,this.eeTrialService.error=void 0)}}ro.\u0275fac=function(o){return new(o||ro)(e.Y36(e.SBq),e.Y36(w.D),e.Y36(c.qu),e.Y36(io.S),e.Y36(Oi))},ro.\u0275cmp=e.Xpm({type:ro,selectors:[["enterprise-trial-form"]],decls:45,vars:16,consts:[["id","enterprise-trial-form",1,"form",3,"formGroup"],[1,"form--field","-wide-label","-required"],["for","trial-company-name",1,"form--label"],[1,"form--field-container"],[1,"form--text-field-container"],["type","text","id","trial-company-name","formControlName","company",1,"form--text-field"],["for","trial-first-name",1,"form--label"],["type","text","id","trial-first-name","formControlName","first_name",1,"form--text-field"],["for","trial-last-name",1,"form--label"],["type","text","id","trial-last-name","formControlName","last_name",1,"form--text-field"],["for","trial-email",1,"form--label"],[1,"form--text-field-container",3,"ngClass"],["type","email","id","trial-email","formControlName","email",1,"form--text-field",3,"blur"],["class","form--field-instructions op-ee-trial-email-error",4,"ngIf"],["for","trial-domain-name",1,"form--label"],["type","text","id","trial-domain-name","formControlName","domain","disabled","",1,"form--text-field"],["class","form--field-instructions",4,"ngIf"],[1,"form--field","-required"],["for","trial-general-consent",1,"form--label-with-check-box","-no-ellipsis"],[1,"form--check-box-container"],["type","checkbox","id","trial-general-consent","formControlName","general_consent","required","",1,"form--check-box"],[3,"innerHTML"],[1,"form--field"],["for","trial-newsletter-consent",1,"form--label-with-check-box","-no-ellipsis"],["type","checkbox","id","trial-newsletter-consent","formControlName","newsletter_consent",1,"form--check-box"],[3,"innerHtml"],[1,"form--field-instructions","op-ee-trial-email-error"],[1,"form--field-instructions"]],template:function(o,s){1&o&&(e.TgZ(0,"form",0),e.TgZ(1,"div",1),e.TgZ(2,"label",2),e._uU(3),e.qZA(),e.TgZ(4,"div",3),e.TgZ(5,"div",4),e._UZ(6,"input",5),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",1),e.TgZ(8,"label",6),e._uU(9),e.qZA(),e.TgZ(10,"div",3),e.TgZ(11,"div",4),e._UZ(12,"input",7),e.qZA(),e.qZA(),e.qZA(),e.TgZ(13,"div",1),e.TgZ(14,"label",8),e._uU(15),e.qZA(),e.TgZ(16,"div",3),e.TgZ(17,"div",4),e._UZ(18,"input",9),e.qZA(),e.qZA(),e.qZA(),e.TgZ(19,"div",1),e.TgZ(20,"label",10),e._uU(21),e.qZA(),e.TgZ(22,"div",3),e.TgZ(23,"div",11),e.TgZ(24,"input",12),e.NdJ("blur",function(){return s.checkMailField()}),e.qZA(),e.qZA(),e.qZA(),e.YNc(25,Sp,2,1,"div",13),e.qZA(),e.TgZ(26,"div",1),e.TgZ(27,"label",14),e._uU(28),e.qZA(),e.TgZ(29,"div",3),e.TgZ(30,"div",11),e._UZ(31,"input",15),e.qZA(),e.qZA(),e.YNc(32,Dp,2,1,"div",16),e.qZA(),e.TgZ(33,"div",17),e.TgZ(34,"div",3),e.TgZ(35,"label",18),e.TgZ(36,"div",19),e._UZ(37,"input",20),e.qZA(),e._UZ(38,"span",21),e.qZA(),e.qZA(),e.qZA(),e.TgZ(39,"div",22),e.TgZ(40,"div",3),e.TgZ(41,"label",23),e.TgZ(42,"div",19),e._UZ(43,"input",24),e.qZA(),e._UZ(44,"span",25),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.Q6J("formGroup",s.trialForm),e.xp6(3),e.Oqu(s.text.label_company),e.xp6(6),e.Oqu(s.text.label_first_name),e.xp6(6),e.Oqu(s.text.label_last_name),e.xp6(6),e.Oqu(s.text.label_email),e.xp6(2),e.Q6J("ngClass",e.VKq(12,zr,s.eeTrialService.emailError)),e.xp6(2),e.Q6J("ngIf",s.eeTrialService.emailError),e.xp6(3),e.Oqu(s.text.label_domain),e.xp6(2),e.Q6J("ngClass",e.VKq(14,zr,s.eeTrialService.domainTaken)),e.xp6(2),e.Q6J("ngIf",s.eeTrialService.domainTaken),e.xp6(6),e.Q6J("innerHTML",s.text.general_consent,e.oJD),e.xp6(6),e.Q6J("innerHtml",s.text.receive_newsletter,e.oJD))},directives:[c._Y,c.JL,c.sg,c.Fj,c.JJ,c.u,I.mk,I.O5,c.Wl,c.Zs],styles:[".op-ee-trial-email-error[_ngcontent-%COMP%]{width:min-content}"]});class qr extends hi.N{constructor(o){super(),this.I18n=o,this.text={label_email:this.I18n.t("js.label_email"),label_expires_at:this.I18n.t("js.admin.enterprise.trial.form.label_expires_at"),label_maximum_users:this.I18n.t("js.admin.enterprise.trial.form.label_maximum_users"),label_company:this.I18n.t("js.admin.enterprise.trial.form.label_company"),label_domain:this.I18n.t("js.admin.enterprise.trial.form.label_domain"),label_starts_at:this.I18n.t("js.admin.enterprise.trial.form.label_starts_at"),label_subscriber:this.I18n.t("js.admin.enterprise.trial.form.label_subscriber"),text_expired:this.I18n.t("js.admin.enterprise.text_expired"),text_reprieve_days_left:s=>this.I18n.t("js.admin.enterprise.text_reprieve_days_left",{days:s})}}}function jp(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_company)}}function Rp(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.company)}}function Zp(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_domain)}}function Fp(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.domain)}}function Wp(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_maximum_users)}}function Up(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.userCount)}}function Lp(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_starts_at)}}function Bp(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.startsAt)}}function Qp(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_expires_at)}}function Np(f,o){if(1&f&&e._UZ(0,"span",10),2&f){const s=e.oxw(2);e.Q6J("textContent",s.expiredWarningText)}}function Jp(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.YNc(3,Np,1,1,"span",9),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.expiresAt),e.xp6(1),e.Q6J("ngIf",s.isExpired)}}class us extends qr{constructor(o,s,T,j,q,fe){super(T),this.elementRef=o,this.cdRef=s,this.I18n=T,this.http=j,this.Gon=q,this.eeTrialService=fe}ngOnInit(){this.subscriber||(this.eeTrialService.userData$.values$().pipe((0,qi.x)(),this.untilDestroyed()).subscribe(o=>{this.formatUserData(o),this.cdRef.detectChanges()}),this.initialize())}initialize(){const o=this.Gon.get("ee_trial_key");o&&!this.eeTrialService.userData$.hasValue()&&(this.eeTrialService.trialLink=`${this.eeTrialService.baseUrlAugur}/public/v1/trials/${o.value}`,this.getUserDataFromAugur())}getUserDataFromAugur(){this.http.get(`${this.eeTrialService.trialLink}/details`).toPromise().then(o=>{this.eeTrialService.userData$.putValue(o),this.eeTrialService.retryConfirmation()}).catch(o=>{this.eeTrialService.getToken()})}formatUserData(o){this.subscriber=`${o.first_name} ${o.last_name}`,this.email=o.email,this.company=o.company,this.domain=o.domain}}function Yp(f,o){if(1&f&&(e.TgZ(0,"p"),e._uU(1),e.qZA()),2&f){const s=e.oxw(2);e.xp6(1),e.Oqu(s.text.session_timeout)}}function $p(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"span",3),e._uU(1),e.TgZ(2,"button",4),e.NdJ("click",function(){return e.CHM(s),e.oxw().resendMail()}),e._uU(3),e.qZA(),e.YNc(4,Yp,2,1,"p",5),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.hij(" ",s.text.status_waiting," "),e.xp6(2),e.hij(" ",s.text.resend,""),e.xp6(1),e.Q6J("ngIf",s.eeTrialService.cancelled)}}function Vp(f,o){if(1&f&&(e.TgZ(0,"span",6),e._uU(1),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.hij(" ",s.text.status_confirmed,"")}}us.\u0275fac=function(o){return new(o||us)(e.Y36(e.SBq),e.Y36(e.sBO),e.Y36(w.D),e.Y36(mi.eN),e.Y36(Lo.U),e.Y36(Oi))},us.\u0275cmp=e.Xpm({type:us,selectors:[["enterprise-active-trial"]],features:[e.qOj],decls:21,vars:14,consts:[["data-qa-selector","op-enterprise--active-token",1,"op-enterprise--active-token"],[1,"attributes-group"],[1,"attributes-key-value"],[1,"attributes-key-value--key",3,"textContent"],[1,"attributes-key-value--value-container"],[1,"attributes-key-value--value","-text"],[3,"textContent"],["class","attributes-key-value--key",3,"textContent",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"],["class","expired-warning",3,"textContent",4,"ngIf"],[1,"expired-warning",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e._UZ(6,"span",6),e.qZA(),e.qZA(),e._UZ(7,"div",3),e.TgZ(8,"div",4),e.TgZ(9,"div",5),e._UZ(10,"span",6),e.qZA(),e.qZA(),e.YNc(11,jp,1,1,"div",7),e.YNc(12,Rp,3,1,"div",8),e.YNc(13,Zp,1,1,"div",7),e.YNc(14,Fp,3,1,"div",8),e.YNc(15,Wp,1,1,"div",7),e.YNc(16,Up,3,1,"div",8),e.YNc(17,Lp,1,1,"div",7),e.YNc(18,Bp,3,1,"div",8),e.YNc(19,Qp,1,1,"div",7),e.YNc(20,Jp,4,2,"div",8),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("textContent",s.text.label_subscriber),e.xp6(3),e.Q6J("textContent",s.subscriber),e.xp6(1),e.Q6J("textContent",s.text.label_email),e.xp6(3),e.Q6J("textContent",s.email),e.xp6(1),e.Q6J("ngIf",s.company),e.xp6(1),e.Q6J("ngIf",s.company),e.xp6(1),e.Q6J("ngIf",s.domain),e.xp6(1),e.Q6J("ngIf",s.domain),e.xp6(1),e.Q6J("ngIf",s.userCount),e.xp6(1),e.Q6J("ngIf",s.userCount),e.xp6(1),e.Q6J("ngIf",s.startsAt),e.xp6(1),e.Q6J("ngIf",s.startsAt),e.xp6(1),e.Q6J("ngIf",s.expiresAt),e.xp6(1),e.Q6J("ngIf",s.expiresAt))},directives:[I.O5],styles:[".op-enterprise--active-token[_ngcontent-%COMP%]   .attributes-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.op-enterprise--active-token[_ngcontent-%COMP%]   .expired-warning[_ngcontent-%COMP%]{margin-left:.4rem;color:red;font-weight:bold}"]});class ao{constructor(o,s,T,j,q,fe){this.elementRef=o,this.I18n=s,this.http=T,this.toastService=j,this.eeTrialService=q,this.timezoneService=fe,this.created=this.timezoneService.formattedDate((new Date).toString()),this.email="",this.text={confirmation_info:(Be,Ye)=>this.I18n.t("js.admin.enterprise.trial.confirmation_info",{date:Be,email:Ye}),resend:this.I18n.t("js.admin.enterprise.trial.resend_link"),resend_success:this.I18n.t("js.admin.enterprise.trial.resend_success"),resend_warning:this.I18n.t("js.admin.enterprise.trial.resend_warning"),session_timeout:this.I18n.t("js.admin.enterprise.trial.session_timeout"),status_confirmed:this.I18n.t("js.admin.enterprise.trial.status_confirmed"),status_label:this.I18n.t("js.admin.enterprise.trial.status_label"),status_waiting:this.I18n.t("js.admin.enterprise.trial.status_waiting")}}ngOnInit(){const o=window.gon.ee_trial_key;if(o){const s=o.created.split(" ")[0];this.created=this.timezoneService.formattedDate(s)}this.eeTrialService.userData$.values$().pipe((0,qi.x)()).subscribe(s=>{this.email=s.email})}resendMail(){this.eeTrialService.cancelled=!1,this.http.post(this.eeTrialService.resendLink,{}).toPromise().then(()=>{this.toastService.addSuccess(this.text.resend_success),this.eeTrialService.retryConfirmation()}).catch(()=>{this.eeTrialService.trialLink?this.eeTrialService.getToken():this.toastService.addError(this.text.resend_warning)})}}function Hp(f,o){1&f&&(e.TgZ(0,"div"),e._UZ(1,"enterprise-trial-form"),e.qZA())}function Kp(f,o){1&f&&(e.TgZ(0,"div"),e._UZ(1,"enterprise-trial-waiting"),e.qZA())}function Gp(f,o){if(1&f&&(e.TgZ(0,"div"),e.TgZ(1,"div",7),e.TgZ(2,"div",8),e.TgZ(3,"span"),e._uU(4),e.qZA(),e.qZA(),e.TgZ(5,"div",9),e._UZ(6,"iframe",10),e.qZA(),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(4),e.Oqu(s.text.quick_overview),e.xp6(2),e.Q6J("src",s.trustedEEVideoURL,e.uOi)}}function zp(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"button",11),e.NdJ("click",function(j){return e.CHM(s),e.oxw().closeModal(j)}),e.qZA(),e.TgZ(2,"button",12),e.NdJ("click",function(){return e.CHM(s),e.oxw().onSubmit()}),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(1),e.Q6J("textContent",s.text.button_cancel),e.uIk("title",s.text.button_cancel),e.xp6(1),e.Q6J("disabled",!s.trialForm||s.trialForm.invalid)("textContent",s.text.button_submit)("hidden",s.eeTrialService.mailSubmitted&&!s.eeTrialService.cancelled),e.uIk("title",s.text.button_submit)}}function qp(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(j){return e.CHM(s),e.oxw(2).closeModal(j)}),e.qZA()}if(2&f){const s=e.oxw(2);e.Q6J("textContent",s.text.button_continue),e.uIk("title",s.text.button_continue)}}function Xp(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",13),e.NdJ("click",function(){return e.CHM(s),e.oxw().startEnterpriseTrial()}),e.qZA(),e.YNc(1,qp,1,2,"button",14)}if(2&f){const s=e.oxw();e.Q6J("textContent",s.text.button_continue)("disabled",!s.eeTrialService.confirmed)("hidden",s.eeTrialService.trialStarted),e.uIk("title",s.text.button_continue),e.xp6(1),e.Q6J("ngIf",s.eeTrialService.trialStarted)}}ao.\u0275fac=function(o){return new(o||ao)(e.Y36(e.SBq),e.Y36(w.D),e.Y36(mi.eN),e.Y36(M.kl),e.Y36(Oi),e.Y36(ot.B))},ao.\u0275cmp=e.Xpm({type:ao,selectors:[["enterprise-trial-waiting"]],decls:10,vars:4,consts:[[1,"op-ee-trial-waiting"],["class","op-ee-trial-waiting-status--waiting","data-qa-selector","op-ee-trial-waiting-status--waiting",4,"ngIf","ngIfElse"],["confirmedStatus",""],["data-qa-selector","op-ee-trial-waiting-status--waiting",1,"op-ee-trial-waiting-status--waiting"],["data-qa-selector","op-ee-trial-waiting-resend-link",1,"spot-link","op-ee-trial-waiting-resend-link",3,"click"],[4,"ngIf"],["data-qa-selector","op-ee-trial-waiting-status--confirmed",1,"op-ee-trial-waiting-status--confirmed","icon-yes"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0),e._UZ(1,"enterprise-active-trial"),e.TgZ(2,"p"),e._uU(3),e.qZA(),e.TgZ(4,"p"),e.TgZ(5,"span"),e._uU(6),e.qZA(),e.YNc(7,$p,5,3,"span",1),e.YNc(8,Vp,2,1,"ng-template",null,2,e.W1O),e.qZA(),e.qZA()),2&o){const T=e.MAs(9);e.xp6(3),e.Oqu(s.text.confirmation_info(s.created,s.email)),e.xp6(3),e.hij("",s.text.status_label," "),e.xp6(1),e.Q6J("ngIf",!s.eeTrialService.confirmed)("ngIfElse",T)}},directives:[us,I.O5],styles:[".op-ee-trial-waiting-status--confirmed[_ngcontent-%COMP%]{color:var(--button--alt-highlight-background-color)}.op-ee-trial-waiting-status--waiting[_ngcontent-%COMP%]{color:orange}"]});class co extends Ve.T{constructor(o,s,T,j,q,fe){super(s,T,o),this.elementRef=o,this.locals=s,this.cdRef=T,this.I18n=j,this.domSanitizer=q,this.eeTrialService=fe,this.showClose=!0,this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.text={button_submit:this.I18n.t("js.modals.button_submit"),button_cancel:this.I18n.t("js.modals.button_cancel"),button_continue:this.I18n.t("js.button_continue"),close_popup:this.I18n.t("js.close_popup_title"),heading_confirmation:this.I18n.t("js.admin.enterprise.trial.confirmation"),heading_next_steps:this.I18n.t("js.admin.enterprise.trial.next_steps"),heading_test_ee:this.I18n.t("js.admin.enterprise.trial.test_ee"),quick_overview:this.I18n.t("js.admin.enterprise.trial.quick_overview")},this.trustedEEVideoURL=this.trustedURL("https://www.youtube.com/embed/zLMSydhFSkw?autoplay=1")}ngAfterViewInit(){this.trialForm=this.formComponent.trialForm}onSubmit(){this.trialForm.valid&&(this.trialForm.addControl("_type",new c.NI("enterprise-trial")),this.eeTrialService.sendForm(this.trialForm))}startEnterpriseTrial(){this.eeTrialService.setStartTrialStatus()}headerText(){return this.eeTrialService.mailSubmitted?this.text.heading_confirmation:this.eeTrialService.trialStarted?this.text.heading_next_steps:this.text.heading_test_ee}closeModal(o){if(this.closeMe(o),this.eeTrialService.trialStarted||this.eeTrialService.confirmed)window.location.reload();else if(this.eeTrialService.mailSubmitted)return void window.location.reload();this.eeTrialService.modalOpen=!1}trustedURL(o){return this.domSanitizer.bypassSecurityTrustResourceUrl(o)}openWindow(){return!this.eeTrialService.status||this.eeTrialService.cancelled?1:this.eeTrialService.mailSubmitted&&!this.eeTrialService.cancelled?2:3}}function tu(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div"),e.TgZ(1,"p"),e._uU(2),e.qZA(),e.TgZ(3,"p",3),e._uU(4),e.qZA(),e.TgZ(5,"p"),e.TgZ(6,"span",3),e._uU(7),e.qZA(),e._UZ(8,"br"),e.TgZ(9,"span"),e._uU(10),e.qZA(),e.qZA(),e.TgZ(11,"button",4),e.NdJ("click",function(){return e.CHM(s),e.oxw().openTrialModal()}),e._uU(12),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(2),e.Oqu(s.text.enterprise_edition),e.xp6(2),e.Oqu(s.text.confidence),e.xp6(3),e.Oqu(s.text.become_hero),e.xp6(3),e.Oqu(s.text.you_contribute),e.xp6(2),e.hij(" ",s.text.button_trial," ")}}function iu(f,o){if(1&f){const s=e.EpF();e._UZ(0,"enterprise-trial-waiting"),e.TgZ(1,"p",5),e._uU(2),e.TgZ(3,"a",6),e.NdJ("click",function(){return e.CHM(s),e.oxw().openTrialModal()}),e._uU(4),e.qZA(),e.qZA()}if(2&f){const s=e.oxw();e.xp6(2),e.hij("",s.text.email_not_received," "),e.xp6(2),e.Oqu(s.text.try_another_email)}}co.\u0275fac=function(o){return new(o||co)(e.Y36(e.SBq),e.Y36(it.E),e.Y36(e.sBO),e.Y36(w.D),e.Y36(i.H7),e.Y36(Oi))},co.\u0275cmp=e.Xpm({type:co,selectors:[["enterprise-trial-modal"]],viewQuery:function(o,s){if(1&o&&e.Gf(ro,5),2&o){let T;e.iGM(T=e.CRH())&&(s.formComponent=T.first)}},inputs:{opReferrer:"opReferrer"},features:[e.qOj],decls:11,vars:7,consts:[[1,"op-modal","op-enterprise-modal"],[3,"close"],[1,"op-modal--body",3,"ngSwitch"],[4,"ngSwitchCase"],[1,"op-modal--footer"],[4,"ngIf","ngIfElse"],["mailSubmitted",""],[1,"onboarding--video-block"],[1,"onboarding--video-text"],[1,"onboarding--video","iframe-target-wrapper"],["frameborder","0","height","400","width","100%","allowfullscreen","",3,"src"],[1,"confirm-form-submit--cancel","button",3,"textContent","click"],[1,"confirm-form-submit--continue","button","-highlight",3,"disabled","textContent","hidden","click"],[1,"confirm-form-submit--continue","button","-highlight",3,"textContent","disabled","hidden","click"],["class","confirm-form-submit--continue button -highlight",3,"textContent","click",4,"ngIf"],[1,"confirm-form-submit--continue","button","-highlight",3,"textContent","click"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"op-modal-header",1),e.NdJ("close",function(j){return s.closeModal(j)}),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e.YNc(4,Hp,2,0,"div",3),e.YNc(5,Kp,2,0,"div",3),e.YNc(6,Gp,7,2,"div",3),e.qZA(),e.TgZ(7,"div",4),e.YNc(8,zp,3,6,"div",5),e.YNc(9,Xp,2,5,"ng-template",null,6,e.W1O),e.qZA(),e.qZA()),2&o){const T=e.MAs(10);e.xp6(2),e.Oqu(s.headerText()),e.xp6(1),e.Q6J("ngSwitch",s.openWindow()),e.xp6(1),e.Q6J("ngSwitchCase",1),e.xp6(1),e.Q6J("ngSwitchCase",2),e.xp6(1),e.Q6J("ngSwitchCase",3),e.xp6(2),e.Q6J("ngIf",!s.eeTrialService.status||s.eeTrialService.cancelled)("ngIfElse",T)}},directives:[L.g,I.RF,I.n9,I.O5,ro,ao],styles:[".op-enterprise-modal[_ngcontent-%COMP%]   .onboarding--video-text[_ngcontent-%COMP%]{margin-bottom:1.25rem}"]});class hs{constructor(o,s,T,j){this.I18n=o,this.opModalService=s,this.injector=T,this.eeTrialService=j,this.text={button_trial:this.I18n.t("js.admin.enterprise.upsale.button_start_trial"),button_book:this.I18n.t("js.admin.enterprise.upsale.button_book_now"),link_quote:this.I18n.t("js.admin.enterprise.upsale.link_quote"),become_hero:this.I18n.t("js.admin.enterprise.upsale.become_hero"),you_contribute:this.I18n.t("js.admin.enterprise.upsale.you_contribute"),email_not_received:this.I18n.t("js.admin.enterprise.trial.email_not_received"),enterprise_edition:this.I18n.t("js.admin.enterprise.upsale.text"),confidence:this.I18n.t("js.admin.enterprise.upsale.confidence"),try_another_email:this.I18n.t("js.admin.enterprise.trial.try_another_email")}}openTrialModal(){this.eeTrialService.cancelled=!0,this.eeTrialService.modalOpen=!0,this.opModalService.show(co,this.injector)}get noTrialRequested(){return void 0===window.gon.ee_trial_key}}hs.\u0275fac=function(o){return new(o||hs)(e.Y36(w.D),e.Y36(it.S),e.Y36(e.zs3),e.Y36(Oi))},hs.\u0275cmp=e.Xpm({type:hs,selectors:[["enterprise-base"]],decls:4,vars:2,consts:[[1,"op-enterprise-base"],[4,"ngIf","ngIfElse"],["alreadyRequested",""],[1,"-bold"],[1,"button","-alt-highlight",3,"click"],[1,"op-enterprise-base--confirmation-hint"],[3,"click"]],template:function(o,s){if(1&o&&(e.TgZ(0,"div",0),e.YNc(1,tu,13,5,"div",1),e.YNc(2,iu,5,2,"ng-template",null,2,e.W1O),e.qZA()),2&o){const T=e.MAs(3);e.xp6(1),e.Q6J("ngIf",s.noTrialRequested)("ngIfElse",T)}},directives:[I.O5,ao],styles:[".op-enterprise-base[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{float:left}.op-enterprise-base--confirmation-hint[_ngcontent-%COMP%]{font-size:.9em;font-style:italic;margin-bottom:2rem}"]});const ou=function(f){return{"tooltip--top":f}};class _s{constructor(o,s,T,j,q,fe,Be,Ye){this.I18n=o,this.opModalService=s,this.injector=T,this.http=j,this.cdRef=q,this.Gon=fe,this.eeTrialService=Be,this.timezoneService=Ye,this.created=this.timezoneService.formattedDate((new Date).toString()),this.email="",this.text={button_trial:this.I18n.t("js.admin.enterprise.upsale.button_start_trial"),confirmation_info:(at,At)=>this.I18n.t("js.admin.enterprise.trial.confirmation_info",{date:at,email:At})}}ngOnInit(){this.eeTrialService.userData$.values$().pipe((0,qi.x)()).subscribe(o=>{this.email=o.email,this.cdRef.detectChanges()}),this.initialize()}initialize(){const o=this.Gon.get("ee_trial_key");if(o){const s=o.created.split(" ")[0];this.created=this.timezoneService.formattedDate(s),this.eeTrialService.userData$.hasValue()||(this.eeTrialService.trialLink=`${this.eeTrialService.baseUrlAugur}/public/v1/trials/${o.value}`,this.getUserDataFromAugur())}}getUserDataFromAugur(){this.http.get(`${this.eeTrialService.trialLink}/details`).toPromise().then(o=>{this.eeTrialService.userData$.putValue(o),this.eeTrialService.retryConfirmation()}).catch(()=>{this.eeTrialService.getToken()})}openTrialModal(){this.eeTrialService.cancelled=!0,this.eeTrialService.modalOpen=!0,this.opModalService.show(co,this.injector)}get trialRequested(){const o=this.Gon.get("ee_trial_key");return o&&void 0!==o}}function ru(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_company)}}function au(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.company)}}function cu(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_domain)}}function lu(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.domain)}}function du(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_maximum_users)}}function pu(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.userCount)}}function uu(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_starts_at)}}function hu(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.startsAt)}}function _u(f,o){if(1&f&&e._UZ(0,"div",3),2&f){const s=e.oxw();e.Q6J("textContent",s.text.label_expires_at)}}function mu(f,o){if(1&f&&e._UZ(0,"span",10),2&f){const s=e.oxw(2);e.Q6J("textContent",s.expiredWarningText)}}function gu(f,o){if(1&f&&(e.TgZ(0,"div",4),e.TgZ(1,"div",5),e._UZ(2,"span",6),e.YNc(3,mu,1,1,"span",9),e.qZA(),e.qZA()),2&f){const s=e.oxw();e.xp6(2),e.Q6J("textContent",s.expiresAt),e.xp6(1),e.Q6J("ngIf",s.isExpired)}}_s.\u0275fac=function(o){return new(o||_s)(e.Y36(w.D),e.Y36(it.S),e.Y36(e.zs3),e.Y36(mi.eN),e.Y36(e.sBO),e.Y36(Lo.U),e.Y36(Oi),e.Y36(ot.B))},_s.\u0275cmp=e.Xpm({type:_s,selectors:[["free-trial-button"]],decls:3,vars:6,consts:[[3,"ngClass"],[1,"button","-alt-highlight","-round",3,"disabled","click"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return s.openTrialModal()}),e._uU(2),e.qZA(),e.qZA()),2&o&&(e.Q6J("ngClass",e.VKq(4,ou,s.trialRequested)),e.uIk("data-tooltip",s.trialRequested?s.text.confirmation_info(s.created,s.email):""),e.xp6(1),e.Q6J("disabled",s.trialRequested),e.xp6(1),e.hij(" ",s.text.button_trial," "))},directives:[I.mk],encapsulation:2,changeDetection:0});class ms extends qr{constructor(o,s){super(s),this.elementRef=o,this.I18n=s,this.subscriber=this.elementRef.nativeElement.dataset.subscriber,this.email=this.elementRef.nativeElement.dataset.email,this.company=this.elementRef.nativeElement.dataset.company,this.domain=this.elementRef.nativeElement.dataset.domain,this.userCount=this.elementRef.nativeElement.dataset.userCount,this.startsAt=this.elementRef.nativeElement.dataset.startsAt,this.expiresAt=this.elementRef.nativeElement.dataset.expiresAt,this.isExpired="true"===this.elementRef.nativeElement.dataset.isExpired,this.reprieveDaysLeft=this.elementRef.nativeElement.dataset.reprieveDaysLeft}get expiredWarningText(){let o=this.text.text_expired;return this.reprieveDaysLeft&&this.reprieveDaysLeft>0&&(o=`${o}: ${this.text.text_reprieve_days_left(this.reprieveDaysLeft)}`),o}}ms.\u0275fac=function(o){return new(o||ms)(e.Y36(e.SBq),e.Y36(w.D))},ms.\u0275cmp=e.Xpm({type:ms,selectors:[["enterprise-active-saved-trial"]],features:[e.qOj],decls:21,vars:14,consts:[["data-qa-selector","op-enterprise--active-token",1,"op-enterprise--active-token"],[1,"attributes-group"],[1,"attributes-key-value"],[1,"attributes-key-value--key",3,"textContent"],[1,"attributes-key-value--value-container"],[1,"attributes-key-value--value","-text"],[3,"textContent"],["class","attributes-key-value--key",3,"textContent",4,"ngIf"],["class","attributes-key-value--value-container",4,"ngIf"],["class","expired-warning",3,"textContent",4,"ngIf"],[1,"expired-warning",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"div",2),e._UZ(3,"div",3),e.TgZ(4,"div",4),e.TgZ(5,"div",5),e._UZ(6,"span",6),e.qZA(),e.qZA(),e._UZ(7,"div",3),e.TgZ(8,"div",4),e.TgZ(9,"div",5),e._UZ(10,"span",6),e.qZA(),e.qZA(),e.YNc(11,ru,1,1,"div",7),e.YNc(12,au,3,1,"div",8),e.YNc(13,cu,1,1,"div",7),e.YNc(14,lu,3,1,"div",8),e.YNc(15,du,1,1,"div",7),e.YNc(16,pu,3,1,"div",8),e.YNc(17,uu,1,1,"div",7),e.YNc(18,hu,3,1,"div",8),e.YNc(19,_u,1,1,"div",7),e.YNc(20,gu,4,2,"div",8),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.Q6J("textContent",s.text.label_subscriber),e.xp6(3),e.Q6J("textContent",s.subscriber),e.xp6(1),e.Q6J("textContent",s.text.label_email),e.xp6(3),e.Q6J("textContent",s.email),e.xp6(1),e.Q6J("ngIf",s.company),e.xp6(1),e.Q6J("ngIf",s.company),e.xp6(1),e.Q6J("ngIf",s.domain),e.xp6(1),e.Q6J("ngIf",s.domain),e.xp6(1),e.Q6J("ngIf",s.userCount),e.xp6(1),e.Q6J("ngIf",s.userCount),e.xp6(1),e.Q6J("ngIf",s.startsAt),e.xp6(1),e.Q6J("ngIf",s.startsAt),e.xp6(1),e.Q6J("ngIf",s.expiresAt),e.xp6(1),e.Q6J("ngIf",s.expiresAt))},directives:[I.O5],styles:[".op-enterprise--active-token[_ngcontent-%COMP%]   .attributes-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.op-enterprise--active-token[_ngcontent-%COMP%]   .expired-warning[_ngcontent-%COMP%]{margin-left:.4rem;color:red;font-weight:bold}"],changeDetection:0});class gs{constructor(o,s){this.elementRef=o,this.i18n=s}ngOnInit(){const o=jQuery(this.elementRef.nativeElement);this.textMessage=o.attr("text-message"),this.linkMessage=o.attr("link-message")||this.i18n.t("js.work_packages.table_configuration.upsale.check_out_link"),this.referrer=o.attr("referrer")}}gs.\u0275fac=function(o){return new(o||gs)(e.Y36(e.SBq),e.Y36(w.D))},gs.\u0275cmp=e.Xpm({type:gs,selectors:[["enterprise-banner-bootstrap"]],decls:1,vars:3,consts:[[3,"textMessage","linkMessage","opReferrer"]],template:function(o,s){1&o&&e._UZ(0,"enterprise-banner",0),2&o&&e.Q6J("textMessage",s.textMessage)("linkMessage",s.linkMessage)("opReferrer",s.referrer)},directives:[Ir.P],encapsulation:2});var yu=t(97656);class fs{constructor(o,s){this.i18n=o,this.domSanitizer=s,this.new_features_image=(0,yu.h)("12_1_features.png"),this.text={newFeatures:this.i18n.t("js.label_new_features"),descriptionNewFeatures:this.i18n.t("js.homescreen.blocks.new_features.text_new_features"),learnAbout:this.i18n.t("js.homescreen.blocks.new_features.learn_about")},this.isStandardEdition=window.OpenProject.isStandardEdition}get teaserWebsiteUrl(){const o=this.translated("learn_about_link");return this.domSanitizer.bypassSecurityTrustResourceUrl(o)}get currentNewFeatureHtml(){return this.translated("new_features_html")}translated(o){return this.i18n.t(`js.homescreen.blocks.new_features.12_1.${this.isStandardEdition?"standard":"bim"}.${o}`,{list_styling_class:"widget-box--arrow-links",bcf_api_link:"https://github.com/opf/openproject/blob/dev/docs/api/bcf/bcf-rest-api.md"})}}fs.\u0275fac=function(o){return new(o||fs)(e.Y36(w.D),e.Y36(i.H7))},fs.\u0275cmp=e.Xpm({type:fs,selectors:[["homescreen-new-features-block"]],decls:8,vars:5,consts:[[1,"op-new-features"],[1,"widget-box--additional-info"],[1,"widget-box--description"],[3,"innerHtml"],[1,"widget-box--teaser-image","op-new-features--teaser-image",3,"src"],["target","_blank",3,"href"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"p",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e._UZ(4,"p",3),e._UZ(5,"img",4),e.qZA(),e.TgZ(6,"a",5),e._uU(7),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.hij(" ",s.text.descriptionNewFeatures," "),e.xp6(2),e.Q6J("innerHtml",s.currentNewFeatureHtml,e.oJD),e.xp6(1),e.Q6J("src",s.new_features_image,e.LSH),e.xp6(1),e.Q6J("href",s.teaserWebsiteUrl,e.LSH),e.xp6(1),e.Oqu(s.text.learnAbout))},styles:[".op-new-features--teaser-image[_ngcontent-%COMP%]{background-image:var(--new-feature-teaser-image);min-width:170px;background-size:contain;background-repeat:no-repeat;background-position-x:right}"]});var Xr=t(83835);function Tu(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"button",1),e.NdJ("click",function(j){return e.CHM(s),e.oxw().toggleService.toggleNavigation(j)}),e._UZ(1,"op-icon",2),e._UZ(2,"op-icon",3),e.qZA()}if(2&f){const s=e.oxw();e.uIk("title",s.toggleTitle)}}class lo extends hi.N{constructor(o,s,T,j){super(),this.toggleService=o,this.cdRef=s,this.deviceService=T,this.injector=j,this.toggleTitle=""}ngOnInit(){this.toggleService.initializeMenu(),this.toggleService.titleData$.pipe((0,qi.x)(),this.untilDestroyed()).subscribe(o=>{this.toggleTitle=o,this.cdRef.detectChanges()})}}lo.\u0275fac=function(o){return new(o||lo)(e.Y36(Xr.J),e.Y36(e.sBO),e.Y36(ir.U),e.Y36(e.zs3))},lo.\u0275cmp=e.Xpm({type:lo,selectors:[["main-menu-toggle"]],hostAttrs:[1,"op-app-menu","op-main-menu-toggle"],features:[e.qOj],decls:1,vars:1,consts:[["class","op-app-menu--item-action","id","main-menu-toggle","aria-haspopup","true","type","button",3,"click",4,"ngIf"],["id","main-menu-toggle","aria-haspopup","true","type","button",1,"op-app-menu--item-action",3,"click"],["aria-hidden","true",1,"icon-hamburger"],["aria-hidden","true",1,"icon-close"]],template:function(o,s){1&o&&e.YNc(0,Tu,3,1,"button",0),2&o&&e.Q6J("ngIf",null!==s.currentProject.id||s.deviceService.isMobile)},directives:[I.O5,ut.o],encapsulation:2,changeDetection:0}),(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",x.R)],lo.prototype,"currentProject",void 0);class vs{constructor(o,s,T){this.element=o,this.confirmDialog=s,this.I18n=T,this.confirmed=!1,this.text={title:this.I18n.t("js.modals.form_submit.title"),text:this.I18n.t("js.modals.form_submit.text")}}ngOnInit(){this.$element=jQuery(this.element.nativeElement),this.$element.is("form")?this.$form=this.$element:this.$form=this.$element.closest("form"),this.$form.on("submit",o=>!!this.confirmed||(o.preventDefault(),this.openConfirmationDialog(),!1))}openConfirmationDialog(){this.confirmDialog.confirm({text:this.text,closeByEscape:!0,showClose:!0,closeByDocument:!0}).then(()=>{this.confirmed=!0,this.$form.trigger("submit")}).catch(()=>this.confirmed=!1)}}vs.\u0275fac=function(o){return new(o||vs)(e.Y36(e.SBq),e.Y36(_t.D),e.Y36(w.D))},vs.\u0275cmp=e.Xpm({type:vs,selectors:[["confirm-form-submit"]],decls:0,vars:0,template:function(o,s){},encapsulation:2});class Cs extends hi.N{constructor(o,s,T){super(),this.toggleService=o,this.cdRef=s,this.elementRef=T,this.mainMenu=jQuery("#main-menu")[0],this.moving=!1}ngOnInit(){this.toggleService.titleData$.pipe((0,qi.x)(),this.untilDestroyed()).subscribe(o=>{this.toggleTitle=o,this.cdRef.detectChanges()}),this.resizeEvent="main-menu-resize",this.localStorageKey="openProject-mainMenuWidth"}resizeStart(){this.elementWidth=this.mainMenu.clientWidth}resizeMove(o){this.toggleService.saveWidth(this.elementWidth+o.absolute.x)}resizeEnd(){const o=new Event(this.resizeEvent);window.dispatchEvent(o)}}Cs.\u0275fac=function(o){return new(o||Cs)(e.Y36(Xr.J),e.Y36(e.sBO),e.Y36(e.SBq))},Cs.\u0275cmp=e.Xpm({type:Cs,selectors:[["main-menu-resizer"]],features:[e.qOj],decls:4,vars:5,consts:[[1,"main-menu--resizer",3,"customHandler","cursorClass","end","start","move"],[1,"resizer-toggle-container"],[1,"spot-link","main-menu--navigation-toggler",3,"click"],["icon-classes","icon-resizer-vertical-lines"]],template:function(o,s){1&o&&(e.TgZ(0,"resizer",0),e.NdJ("end",function(){return s.resizeEnd()})("start",function(){return s.resizeStart()})("move",function(j){return s.resizeMove(j)}),e.TgZ(1,"div",1),e.TgZ(2,"button",2),e.NdJ("click",function(j){return s.toggleService.toggleNavigation(j)}),e._UZ(3,"op-icon",3),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.Q6J("customHandler",!0)("cursorClass","col-resize"),e.xp6(2),e.ekj("open",s.toggleService.showNavigation),e.uIk("title",s.toggleTitle))},directives:[Dr.d,ut.o],encapsulation:2});var ea=t(5275);class ys{constructor(o,s,T,j,q){this.elementRef=o,this.I18n=s,this.cdRef=T,this.urlParamsHelper=j,this.externalQuery=q,this.urlParams=!1,this.text={edit_query:this.I18n.t("js.admin.type_form.edit_query")}}ngOnInit(){const o=this.elementRef.nativeElement;this.id=o.dataset.id,this.name=o.dataset.name,this.urlParams="true"===o.dataset.urlParams,this.queryProps=o.dataset.query}editQuery(){const o=(()=>{if(this.urlParams)return this.queryProps;try{return JSON.parse(this.queryProps)}catch(s){return console.error(`Failed to parse query props from ${this.queryProps}: ${s}`),{}}})();this.externalQuery.show({currentQuery:o,urlParams:this.urlParams,callback:s=>{this.queryProps=this.urlParams?s:JSON.stringify(s),this.cdRef.detectChanges()}})}}ys.\u0275fac=function(o){return new(o||ys)(e.Y36(e.SBq),e.Y36(w.D),e.Y36(e.sBO),e.Y36(oi.Z),e.Y36(ea.W))},ys.\u0275cmp=e.Xpm({type:ys,selectors:[["editable-query-props"]],decls:2,vars:4,consts:[["type","hidden",3,"value"],["type","button",1,"spot-link",3,"textContent","click"]],template:function(o,s){1&o&&(e._UZ(0,"input",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return s.editQuery()}),e.qZA()),2&o&&(e.Q6J("value",s.queryProps),e.uIk("name",s.name||void 0)("id",s.id||void 0),e.xp6(1),e.Q6J("textContent",s.text.edit_query))},encapsulation:2,changeDetection:0});var Ou=t(89919),ta=t(12702),Mu=t(86664),Iu=t(13623);function Su(f,o){if(1&f&&e._UZ(0,"span",4),2&f){const s=e.oxw().ngIf;e.Q6J("textContent",s>99?"":s)}}function Du(f,o){if(1&f&&(e.ynx(0),e.YNc(1,Su,1,1,"span",3),e.BQk()),2&f){const s=o.ngIf;e.xp6(1),e.Q6J("ngIf",s>0)}}class bs{constructor(o,s,T,j){this.storeService=o,this.apiV3Service=s,this.activeWindow=T,this.pathHelper=j,this.polling$=(0,Ou.T)((0,ta.H)(10,1e4).pipe((0,wi.h)(()=>this.activeWindow.isActive)),(0,ta.H)(10,12e4).pipe((0,wi.h)(()=>!this.activeWindow.isActive))).pipe((0,Sr.p)(1e4),(0,St.w)(()=>this.storeService.fetchUnread())),this.unreadCount$=(0,zi.aj)([this.storeService.unread$,this.polling$]).pipe((0,Di.U)(([q])=>q))}notificationsPath(){return this.pathHelper.notificationsPath()}}bs.\u0275fac=function(o){return new(o||bs)(e.Y36(Iu.L),e.Y36(O.T),e.Y36(Mu.u),e.Y36(Fe.j))},bs.\u0275cmp=e.Xpm({type:bs,selectors:[["op-in-app-notification-bell"]],decls:4,vars:4,consts:[["data-qa-selector","op-ian-bell",1,"op-ian-bell","op-app-menu--item-action",3,"href"],["icon-classes","icon-bell"],[4,"ngIf"],["class","op-ian-bell--indicator","data-qa-selector","op-ian-notifications-count",3,"textContent",4,"ngIf"],["data-qa-selector","op-ian-notifications-count",1,"op-ian-bell--indicator",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"a",0),e._UZ(1,"op-icon",1),e.YNc(2,Du,2,1,"ng-container",2),e.ALo(3,"async"),e.qZA()),2&o&&(e.Q6J("href",s.notificationsPath(),e.LSH),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,2,s.unreadCount$)))},directives:[ut.o,I.O5],pipes:[I.Ov],styles:[".cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}.op-ian-bell[_ngcontent-%COMP%]{position:relative}.op-ian-bell--indicator[_ngcontent-%COMP%]{display:inline-flex;justify-content:center;align-items:center;box-sizing:content-box;height:16px;line-height:16px;width:16px;border-radius:.5rem;padding:0 .15rem;font-size:.7rem;font-weight:bold;background:#00A3FF;color:#fff;flex-shrink:0;position:absolute;top:10px;right:3px;background:darkred}"],changeDetection:0});var na=t(78509),hr=t(44838),oa=t(60419),_r=t(97542),Ru=t(18293),po=t(19100);class Zu extends po.Gv{}var ws=t(96725);let mr=class extends po.cf{constructor(){super((0,ws.cq)())}};mr=(0,se.gn)([(0,po.yC)({name:"projects"}),(0,se.w6)("design:paramtypes",[])],mr);class on{constructor(o,s,T){this.http=o,this.apiV3Service=s,this.toastService=T,this.store=new mr,this.query=new Zu(this.store)}get projectsPath(){return this.apiV3Service.projects.path}fetchProjects(o){const s=(0,ws.ZU)(o);return this.http.get(this.projectsPath+s).pipe((0,Ls.b)(T=>(0,ws.V7)(this.store,T,s)),(0,Ru.K)(T=>{throw this.toastService.addError(T),T}))}update(o,s){this.store.update(o,s)}modifyCollection(o,s){const T=(0,ws.ZU)(o);this.store.update(({collections:j})=>{var q;return{collections:Object.assign(Object.assign({},j),{[T]:Object.assign(Object.assign({},j[T]),{ids:[...s((null===(q=j[T])||void 0===q?void 0:q.ids)||[])]})})}})}}on.\u0275fac=function(o){return new(o||on)(e.LFG(mi.eN),e.LFG(O.T),e.LFG(M.kl))},on.\u0275prov=e.Yz7({token:on,factory:on.\u0275fac});class Fu extends po.AE{constructor(o,s,T){super(o),this.store=o,this.resourceService=s,this.projectsResourceService=T,this.projectsFilter$=this.select("projectsFilter"),this.projectsForNotifications$=(0,zi.aj)([this.projectsFilter$,this.projectsResourceService.query.select()]).pipe((0,Di.U)(([j,q])=>{const fe=(0,ws.ZU)(j),Be=q.collections[fe];return((null==Be?void 0:Be.ids)||[]).map(at=>this.projectsResourceService.query.getEntity(at)).filter(at=>!!at)})),this.notificationsByProject$=(0,zi.aj)([this.select("notificationsByProject"),this.projectsForNotifications$]).pipe((0,Di.U)(([j,q])=>j.map(fe=>{const Be=q.find(Ye=>Ye.id.toString()===(0,Ee.Z)(fe._links.valueLink[0].href));return Object.assign(Object.assign({},fe),{projectHasParent:!!(null==Be?void 0:Be._links.parent.href)})}))),this.notificationsByReason$=this.select("notificationsByReason")}}const Wu={pageSize:100,groupBy:"project",filters:[["read_ian","=",!1]]},Uu={pageSize:100,groupBy:"reason",filters:[["read_ian","=",!1]]};let gr=class extends po.yh{constructor(){super({notificationsByProject:[],notificationsByReason:[],projectsFilter:{}})}};gr=(0,se.gn)([(0,po.yC)({name:"ian-menu"}),(0,se.w6)("design:paramtypes",[])],gr);let ji=class{constructor(o,s,T,j,q){this.injector=o,this.ianResourceService=s,this.projectsResourceService=T,this.actions$=j,this.apiV3Service=q,this.id="ian-center",this.store=new gr,this.query=new Fu(this.store,this.ianResourceService,this.projectsResourceService)}checkForNewNotifications(){this.reload()}reloadOnNotificationRead(){return this.reload()}reload(){this.ianResourceService.fetchNotifications(Wu).subscribe(o=>{const s={pageSize:100,filters:[]};o.groups&&(s.filters=[["id","=",o.groups.map(T=>(0,Ee.Z)(T._links.valueLink[0].href))]]),this.store.update({notificationsByProject:o.groups,projectsFilter:s}),o.groups&&o.groups.length>0&&this.projectsResourceService.fetchProjects(s).subscribe()}),this.ianResourceService.fetchNotifications(Uu).subscribe(o=>this.store.update({notificationsByReason:o.groups}))}};ji.\u0275fac=function(o){return new(o||ji)(e.LFG(e.zs3),e.LFG(_r.W),e.LFG(on),e.LFG(oa.b),e.LFG(O.T))},ji.\u0275prov=e.Yz7({token:ji,factory:ji.\u0275fac}),(0,se.gn)([(0,hr.B)(na.vw),(0,se.w6)("design:type",Function),(0,se.w6)("design:paramtypes",[]),(0,se.w6)("design:returntype",void 0)],ji.prototype,"checkForNewNotifications",null),(0,se.gn)([(0,hr.B)(na.A6),(0,se.w6)("design:type",Function),(0,se.w6)("design:paramtypes",[]),(0,se.w6)("design:returntype",void 0)],ji.prototype,"reloadOnNotificationRead",null),ji=(0,se.gn)([hr.b,(0,se.w6)("design:paramtypes",[e.zs3,_r.W,on,oa.b,O.T])],ji);const uo=(f={})=>({uiSref:"notifications.center.show",uiParams:f});class Ts{constructor(o,s,T,j){this.cdRef=o,this.I18n=s,this.ianMenuService=T,this.state=j,this.className=!0,this.baseMenuItems=[Object.assign({key:"inbox",title:this.I18n.t("js.notifications.menu.inbox"),icon:"inbox"},uo({filter:"",name:""}))],this.reasonMenuItems=[Object.assign({key:"mentioned",title:this.I18n.t("js.notifications.menu.mentioned"),icon:"mention"},uo({filter:"reason",name:"mentioned"})),Object.assign({key:"assigned",title:this.I18n.t("js.label_assignee"),icon:"assigned"},uo({filter:"reason",name:"assigned"})),Object.assign({key:"responsible",title:this.I18n.t("js.notifications.menu.accountable"),icon:"accountable"},uo({filter:"reason",name:"responsible"})),Object.assign({key:"watched",title:this.I18n.t("js.notifications.menu.watching"),icon:"watching"},uo({filter:"reason",name:"watched"}))],this.notificationsByProject$=this.ianMenuService.query.notificationsByProject$.pipe((0,Di.U)(q=>q.map(fe=>Object.assign(Object.assign(Object.assign({},fe),{title:(fe.projectHasParent?"... ":"")+fe.value}),uo({filter:"project",name:(0,Ee.Z)(fe._links.valueLink[0].href)}))).sort((fe,Be)=>Be.projectHasParent&&!fe.projectHasParent?-1:fe.value.toLowerCase().localeCompare(Be.value.toLowerCase())))),this.notificationsByReason$=this.ianMenuService.query.notificationsByReason$.pipe((0,Di.U)(q=>this.reasonMenuItems.map(fe=>Object.assign(Object.assign({},q.find(Be=>Be.value===fe.key)),fe)))),this.menuItems$=(0,zi.aj)([this.notificationsByProject$,this.notificationsByReason$]).pipe((0,Di.U)(([q,fe])=>[...this.baseMenuItems.map(Be=>Object.assign(Object.assign({},Be),{count:q.reduce((Ye,at)=>Ye+(at.count||0),0)})),{title:this.I18n.t("js.notifications.menu.by_reason"),collapsible:!0,children:fe},{title:this.I18n.t("js.notifications.menu.by_project"),collapsible:!0,children:q}])),this.text={title:this.I18n.t("js.notifications.title"),button_close:this.I18n.t("js.button_close"),no_results:{unread:this.I18n.t("js.notifications.no_unread"),all:this.I18n.t("js.notice_no_results_to_display")}}}ngOnInit(){this.ianMenuService.reload()}}function Qu(f,o){if(1&f&&(e.TgZ(0,"button",3),e._UZ(1,"span",4),e._UZ(2,"span",5),e.qZA()),2&f){const s=e.oxw();e.Q6J("uiSref",s.createButton.uiSref)("uiParams",s.createButton.uiParams),e.xp6(2),e.Q6J("textContent",s.createButton.title)}}Ts.\u0275fac=function(o){return new(o||Ts)(e.Y36(e.sBO),e.Y36(w.D),e.Y36(ji),e.Y36(ge.StateService))},Ts.\u0275cmp=e.Xpm({type:Ts,selectors:[["op-ian-menu"]],hostVars:2,hostBindings:function(o,s){2&o&&e.ekj("op-ian-menu",s.className)},features:[e._Bn([ji])],decls:2,vars:3,consts:[["data-qa-selector","op-sidemenu",3,"items"]],template:function(o,s){1&o&&(e._UZ(0,"op-sidemenu",0),e.ALo(1,"async")),2&o&&e.Q6J("items",e.lcZ(1,1,s.menuItems$))},directives:[$i],pipes:[I.Ov],styles:[".op-ian-menu[_ngcontent-%COMP%], [_nghost-%COMP%]{display:block;padding-top:16px}"],changeDetection:0});let kn=class extends hi.N{constructor(o,s,T,j,q){super(),this.elementRef=o,this.currentUserService=s,this.currentProjectService=T,this.bannersService=j,this.I18n=q,this.className=!0,this.menuItems=[],this.canAddTeamPlanner$=this.currentUserService.hasCapabilities$("team_planners/create",this.currentProjectService.id||void 0).pipe((0,Di.U)(fe=>fe&&!this.bannersService.eeShowBanners)),this.text={create_new_team_planner:this.I18n.t("js.team_planner.title")},this.createButton={title:this.text.create_new_team_planner,uiSref:"team_planner.page.show",uiParams:{query_id:null,query_props:""}}}};function Ju(f,o){if(1&f&&(e.TgZ(0,"button",3),e._UZ(1,"span",4),e._UZ(2,"span",5),e.qZA()),2&f){const s=e.oxw();e.Q6J("uiSref",s.createButton.uiSref)("uiParams",s.createButton.uiParams)("title",s.text.create_new_calendar),e.xp6(2),e.Q6J("textContent",s.createButton.title)}}kn.\u0275fac=function(o){return new(o||kn)(e.Y36(e.SBq),e.Y36(io.S),e.Y36(x.R),e.Y36(Fs.j),e.Y36(w.D))},kn.\u0275cmp=e.Xpm({type:kn,selectors:[["op-team-planner-sidemenu"]],hostVars:2,hostBindings:function(o,s){2&o&&e.ekj("op-sidebar",s.className)},inputs:{menuItems:"menuItems",projectId:"projectId"},features:[e.qOj],decls:4,vars:5,consts:[["baseRoute","team_planner.page.show","viewType","TeamPlanner",1,"op-sidebar--body",3,"projectId","menuItems"],[1,"op-sidebar--footer"],["class","button -alt-highlight","data-qa-selector","team-planner--create-button",3,"uiSref","uiParams",4,"ngIf"],["data-qa-selector","team-planner--create-button",1,"button","-alt-highlight",3,"uiSref","uiParams"],[1,"spot-icon","spot-icon_add"],[3,"textContent"]],template:function(o,s){1&o&&(e._UZ(0,"op-view-select",0),e.TgZ(1,"div",1),e.YNc(2,Qu,3,3,"button",2),e.ALo(3,"async"),e.qZA()),2&o&&(e.Q6J("projectId",s.projectId)("menuItems",s.menuItems),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,3,s.canAddTeamPlanner$)))},directives:[Vi,I.O5,Vt.UISref],pipes:[I.Ov],encapsulation:2,changeDetection:0}),kn=(0,se.gn)([Us.z,(0,se.w6)("design:paramtypes",[e.SBq,io.S,x.R,Fs.j,w.D])],kn);let xn=class extends hi.N{constructor(o,s,T,j){super(),this.elementRef=o,this.currentUserService=s,this.currentProjectService=T,this.I18n=j,this.className=!0,this.menuItems=[],this.canCreateCalendar$=this.currentUserService.hasCapabilities$("calendars/create",this.currentProjectService.id||void 0).pipe(this.untilDestroyed()),this.text={calendar:this.I18n.t("js.calendar.title"),create_new_calendar:this.I18n.t("js.calendar.create_new")},this.createButton={title:this.text.calendar,uiSref:"calendar.page.show",uiParams:{query_id:null,query_props:""}}}};xn.\u0275fac=function(o){return new(o||xn)(e.Y36(e.SBq),e.Y36(io.S),e.Y36(x.R),e.Y36(w.D))},xn.\u0275cmp=e.Xpm({type:xn,selectors:[["op-calendar-sidemenu"]],hostVars:2,hostBindings:function(o,s){2&o&&e.ekj("op-sidebar",s.className)},inputs:{menuItems:"menuItems",projectId:"projectId"},features:[e.qOj],decls:4,vars:5,consts:[["baseRoute","calendar.page.show","viewType","WorkPackagesCalendar",1,"op-sidebar--body",3,"projectId","menuItems"],[1,"op-sidebar--footer"],["class","button -alt-highlight",3,"uiSref","uiParams","title",4,"ngIf"],[1,"button","-alt-highlight",3,"uiSref","uiParams","title"],[1,"spot-icon","spot-icon_add"],[3,"textContent"]],template:function(o,s){1&o&&(e._UZ(0,"op-view-select",0),e.TgZ(1,"div",1),e.YNc(2,Ju,3,4,"button",2),e.ALo(3,"async"),e.qZA()),2&o&&(e.Q6J("projectId",s.projectId)("menuItems",s.menuItems),e.xp6(2),e.Q6J("ngIf",e.lcZ(3,3,s.canCreateCalendar$)))},directives:[Vi,I.O5,Vt.UISref],pipes:[I.Ov],encapsulation:2,changeDetection:0}),xn=(0,se.gn)([Us.z,(0,se.w6)("design:paramtypes",[e.SBq,io.S,x.R,w.D])],xn);const $u=[{selector:wr,cls:_n},{selector:Ei.w,cls:Ei.y},{selector:"macro.embedded-table",cls:Qo,embeddable:!0},{selector:Fr.w,cls:Fr.O},{selector:Gi.h,cls:Gi.a},{selector:On.e,cls:On.t,embeddable:!0},{selector:pr.X,cls:pr.U},{selector:"members-autocompleter",cls:nn},{selector:"global-search-tabs",cls:rs},{selector:"global-search-work-packages",cls:to},{selector:"homescreen-new-features-block",cls:fs},{selector:"custom-date-action-admin",cls:No},{selector:"boards-menu",cls:Jo},{selector:"global-search-work-packages-entry",cls:Yo},{selector:"op-toasts-container",cls:Ho},{selector:"op-sidemenu",cls:$i},{selector:"admin-type-form-configuration",cls:Xn},{selector:"ckeditor-augmented-textarea",cls:Ko,embeddable:!0},{selector:"persistent-toggle",cls:Go},{selector:ve.y,cls:ve.N},{selector:"hide-section-link",cls:zo},{selector:"show-section-dropdown",cls:qo},{selector:"add-section-dropdown",cls:Xo},{selector:Br.$,cls:Br.r},{selector:"content-tabs",cls:es},{selector:"global-search-title",cls:no},{selector:"copy-to-clipboard",cls:ts},{selector:"confirm-form-submit",cls:vs},{selector:"main-menu-resizer",cls:Cs},{selector:"main-menu-toggle",cls:lo},{selector:"global-search-input",cls:is},{selector:"collapsible-section-augment",cls:ns},{selector:"enterprise-banner-bootstrap",cls:gs},{selector:"enterprise-base",cls:hs},{selector:"free-trial-button",cls:_s},{selector:"enterprise-active-saved-trial",cls:ms},{selector:"project-menu-autocomplete",cls:os},{selector:"remote-field-updater",cls:ss},{selector:"wp-overview-graph",cls:Nt},{selector:"op-view-select",cls:Vi},{selector:"op-team-planner-sidemenu",cls:kn},{selector:"op-calendar-sidemenu",cls:xn},{selector:"time-entry--trigger-actions-entry",cls:Ai,embeddable:!0},{selector:Vr.m,cls:Vr.V},{selector:"macro.macro--attribute-value",cls:cs,embeddable:!0},{selector:"macro.macro--attribute-label",cls:ls,embeddable:!0},{selector:"macro.macro--wp-quickinfo",cls:ps,embeddable:!0},{selector:"editable-query-props",cls:ys},{selector:Kr.F,cls:Kr.w},{selector:"backup",cls:so},{selector:"op-in-app-notification-bell",cls:bs},{selector:"op-ian-menu",cls:Ts}];var fr=t(55741),Vu=t(84568),Hu=t(17076),Ku=t(82170);class ho{constructor(o){this.sanitizer=o}sanitize(o){return this.sanitizer.sanitize(e.q3G.HTML,o)||""}}ho.\u0275fac=function(o){return new(o||ho)(e.LFG(i.H7))},ho.\u0275prov=e.Yz7({token:ho,factory:ho.\u0275fac,providedIn:"root"});var Gu=t(58057),zu=t(298);const qu=["passwordConfirmationField"];class _o extends zu.j{constructor(){super(...arguments),this.password_confirmation=null}ngOnInit(){super.ngOnInit(),this.text.title=I18n.t("js.password_confirmation.title"),this.text.field_description=I18n.t("js.password_confirmation.field_description"),this.text.confirm_button=I18n.t("js.button_confirm"),this.text.password=I18n.t("js.label_password"),this.closeOnEscape=!1,this.closeOnOutsideClick=!1,this.showClose=!1}confirmAndClose(o){this.passwordValuePresent()&&super.confirmAndClose(o)}onOpen(o){super.onOpen(o),this.passwordConfirmationField.nativeElement.focus()}passwordValuePresent(){return null!==this.password_confirmation&&this.password_confirmation.length>0}}_o.\u0275fac=function(){let f;return function(s){return(f||(f=e.n5z(_o)))(s||_o)}}(),_o.\u0275cmp=e.Xpm({type:_o,selectors:[["ng-component"]],viewQuery:function(o,s){if(1&o&&e.Gf(qu,7),2&o){let T;e.iGM(T=e.CRH())&&(s.passwordConfirmationField=T.first)}},features:[e.qOj],decls:14,vars:7,consts:[["data-indicator-name","modal",1,"op-modal","op-modal_autoheight","form","-vertical","confirm-form-submit--modal","password-confirm-dialog--modal","loading-indicator--location",3,"submit"],[3,"close"],[1,"op-modal--body","request-for-confirmation--form","form"],[1,"form--field","-required"],["for","request_for_confirmation_password",1,"form--label",3,"textContent"],[1,"form--field-container"],[1,"form--text-field-container"],["type","password","id","request_for_confirmation_password","name","request_for_confirmation_password",1,"form--text-field",3,"ngModel","ngModelChange"],["passwordConfirmationField",""],[1,"form--field-instructions",3,"textContent"],[1,"op-modal--footer"],[1,"confirm-form-submit--continue","button","-highlight",3,"textContent","disabled"]],template:function(o,s){1&o&&(e.TgZ(0,"form",0),e.NdJ("submit",function(j){return s.confirmAndClose(j)}),e.TgZ(1,"op-modal-header",1),e.NdJ("close",function(j){return s.closeMe(j)}),e._uU(2),e.qZA(),e.TgZ(3,"div",2),e.TgZ(4,"div",3),e._UZ(5,"label",4),e.TgZ(6,"div",5),e.TgZ(7,"div",6),e.TgZ(8,"input",7,8),e.NdJ("ngModelChange",function(j){return s.password_confirmation=j}),e.qZA(),e.qZA(),e.qZA(),e._UZ(10,"div",9),e.qZA(),e.qZA(),e.TgZ(11,"div",10),e.TgZ(12,"button",11),e._uU(13," >"),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(2),e.hij(" ",s.text.title," "),e.xp6(3),e.Q6J("textContent",s.text.password),e.uIk("aria-label",s.text.field_description),e.xp6(3),e.Q6J("ngModel",s.password_confirmation),e.xp6(2),e.Q6J("textContent",s.text.field_description),e.xp6(2),e.Q6J("textContent",s.text.confirm_button)("disabled",!s.passwordValuePresent()))},directives:[c._Y,c.JL,c.F,L.g,c.Fj,c.JJ,c.On],encapsulation:2});var sa=t(29351);class ra{constructor(o){this.injector=o,this._knownHookNames=["workPackageBulkContextMenu","workPackageTableContextMenu","workPackageSingleContextMenu","workPackageNewInitialization"],this.services={confirmDialog:this.injector.get(_t.D),externalQueryConfiguration:this.injector.get(ea.W),externalRelationQueryConfiguration:this.injector.get(jr.Q),halResource:this.injector.get(xt.u),hooks:this.injector.get(C.$),i18n:this.injector.get(w.D),notifications:this.injector.get(M.kl),opModalService:this.injector.get(it.S),opFileUpload:this.injector.get(dr.r),displayField:this.injector.get(as.i),editField:this.injector.get(Vu.h),macros:this.injector.get(Ku.f),htmlSanitizeService:this.injector.get(ho),ckEditorPreview:this.injector.get(Hu.K),pathHelperService:this.injector.get(Fe.j),states:this.injector.get(u.G),apiV3Service:this.injector.get(O.T),configurationService:this.injector.get(Ie.e),attachmentsResourceService:this.injector.get(sa.v)},this.helpers={idFromLink:Ee.Z},this.classes={modals:{passwordConfirmation:_o,dynamicContent:Gu.T},HalResource:Bs.X,DisplayField:fr.C,DomAutoscrollService:Rr.x},this.hooks={},this._knownHookNames.forEach(s=>{this.hooks[s]=T=>this.services.hooks.register(s,T)})}runInZone(o){this.zone.run(o)}bootstrap(o){a.Z.bootstrapOptionalEmbeddable(this.injector.get(e.z2F),o)}}(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",e.R0b)],ra.prototype,"zone",void 0);class mo{constructor(o){(0,Kn.qu)("Registering OpenProject plugin context");const s=new ra(o);window.OpenProject.pluginContext.putValue(s)}}mo.\u0275fac=function(o){return new(o||mo)(e.LFG(e.zs3))},mo.\u0275mod=e.oAB({type:mo}),mo.\u0275inj=e.cJS({providers:[C.$]});class En{constructor(o,s){this.halNotification=o,this.http=s}listen(){jQuery("costs-budget-subform").each((o,s)=>{const T=jQuery(s),j=T.find(".budget-item-container"),q=T.find(".budget-row-template");q.detach();const fe=q[0].outerHTML;let Be=parseInt(T.attr("item-count"),10);T.on("change",".budget-item-value",Ye=>{const at=jQuery(Ye.target).closest(".cost_entry");this.refreshRow(T,at.attr("id"))}),T.on("click",".delete-budget-item",Ye=>(Ye.preventDefault(),jQuery(Ye.target).closest(".cost_entry").remove(),!1)),T.find(".budget-add-row").on("click",Ye=>{Ye.preventDefault();const at=jQuery(fe.replace(/INDEX/g,Be.toString()));return at.show(),at.removeClass("budget-row-template"),j.append(at),Be+=1,!1})})}refreshRow(o,s){const T=o.find(`#${s}`),j=this.buildRefreshRequest(T,s);this.http.post(o.attr("update-url"),j,{headers:{Accept:"application/json"},withCredentials:!0}).subscribe(q=>{_.each(q,(fe,Be)=>{const Ye=document.getElementById(Be);Ye instanceof HTMLInputElement?(Ye.disabled=!1,Ye.value=fe):Ye&&(Ye.textContent=fe)})},q=>this.halNotification.handleRawError(q))}buildRefreshRequest(o,s){const T={element_id:s,fixed_date:jQuery("#budget_fixed_date").val()};return o.find(".budget-item-value").each((j,q)=>{const fe=jQuery(q);T[fe.data("requestKey")]=fe.val()||"0"}),T}}En.\u0275fac=function(o){return new(o||En)(e.LFG(Le.W),e.LFG(mi.eN))},En.\u0275prov=e.Yz7({token:En,factory:En.\u0275fac});class go{constructor(){jQuery("costs-subform").each((o,s)=>{const T=jQuery(s),j=T.find(".subform-container"),q=T.find(".subform-row-template");q.detach();const fe=q[0].outerHTML;let Be=parseInt(T.attr("item-count"));T.on("click",".delete-row-button,.delete-budget-item",Ye=>(jQuery(Ye.target).closest(".subform-row").remove(),!1)),T.find(".add-row-button,.wp-inline-create--add-link").click(Ye=>{Ye.preventDefault();const at=jQuery(fe.replace(/INDEX/g,Be.toString()));return at.show(),at.removeClass("subform-row-template"),at.find("input.costs-date-picker").prop("required",!0),at.find('input[id^="cost_type_new_rate_attributes"]').prop("required",!0),j.append(at),Be+=1,j.find(".subform-row:last-child input:first").focus(),!1})})}}go.\u0275fac=function(o){return new(o||go)},go.\u0275prov=e.Yz7({token:go,factory:go.\u0275fac});var aa=t(67248);class eh extends Bs.X{}const th=(0,aa.n)(eh);function ih(f){window.OpenProject.getPluginContext().then(o=>{o.services.editField.extendFieldType("select",["Budget"]),o.services.displayField.extendFieldType("resource",["Budget"]),o.services.halResource.registerResource("Budget",{cls:th});const{states:j}=o.services;j.add("budgets",(0,yn.r9)()),new go,class{static listen(){jQuery(document).on("click",".costs--edit-planned-costs-btn",o=>{const s=o.target,T=s.nextElementSibling;s.hidden=!0,T.hidden=!1,T.querySelector("input").disabled=!1}),jQuery(document).on("click",".costs--edit-planned-costs-cancel-btn",o=>{const s=o.target.closest(".costs--edit-form");s.previousElementSibling.hidden=!1,s.hidden=!0,s.querySelector("input").disabled=!0})}}.listen(),f.get(En).listen()})}class fo{constructor(o){ih(o)}}fo.\u0275fac=function(o){return new(o||fo)(e.LFG(e.zs3))},fo.\u0275mod=e.oAB({type:fo}),fo.\u0275inj=e.cJS({providers:[En]});class ca extends fr.C{apply(o,s){super.apply(o,s),this.loadIfNecessary()}loadIfNecessary(){this.value&&!1===this.value.$loaded&&this.value.$load().then(()=>{"WorkPackage"===this.resource.$source._type&&this.apiV3Service.work_packages.cache.touch(this.resource.id)})}get title(){return""}render(o,s){this.isEmpty()?o.textContent=this.placeholder:this.value.elements.forEach((T,j)=>{this.resource.showCosts?this.renderCostAsLink(T,o,j):this.renderCostAsText(T,o,j)})}isEmpty(){return!this.value||!this.value.elements||0===this.value.elements.length}renderCostAsLink(o,s,T){const j=this.resource.showCosts,q=document.createElement("a");q.href=j.href+"&unit="+o.costType.id,q.setAttribute("target","_blank"),q.textContent=o.spentUnits+" "+o.costType.name,s.appendChild(q),this.addSeparator(s,T)}renderCostAsText(o,s,T){const j=document.createElement("span");j.textContent=o.spentUnits+" "+o.costType.name,s.appendChild(j),this.addSeparator(s,T)}addSeparator(o,s){if(s<this.value.elements.length-1){const T=document.createElement("span");T.textContent=", ",o.appendChild(T)}}}(0,se.gn)([(0,ze.W)(),(0,se.w6)("design:type",O.T)],ca.prototype,"apiV3Service",void 0);class nh extends fr.C{isEmpty(){return!this.value||!parseFloat(this.value.match(/\d+/g)[0])}}class vo{constructor(o){window.OpenProject.getPluginContext().then(o=>{const s=o.services.displayField;s.addFieldType(ca,"costs",["costsByType"]),s.addFieldType(nh,"currency",["laborCosts","materialCosts","overallCosts"]),o.hooks.workPackageSingleContextMenu(T=>({key:"log_costs",icon:"icon-projects",indexBy(j){const q=_.findIndex(j,{key:"log_time"});return-1!==q?q+1:j.length},resource:"workPackage",link:"logCosts"})),o.hooks.workPackageTableContextMenu(T=>({key:"log_costs",icon:"icon-projects",link:"logCosts",indexBy(j){const q=_.findIndex(j,{link:"logTime"});return-1!==q?q+1:j.length},text:I18n.t("js.button_log_costs")}))})}}function sh(f){const o=f.split(",")[0].indexOf("base64")>=0?atob(f.split(",")[1]):unescape(f.split(",")[1]),s=f.split(",")[0].split(":")[1].split(";")[0],T=o.length,j=new Uint8Array(T);for(let q=0;q<T;q+=1)j[q]=o.charCodeAt(q);return new Blob([j],{type:s})}function ah(f,o){return new Promise(s=>{const T=new FileReader;T.onload=j=>{const q=new Image;q.onload=()=>s(function(f,o){const s=document.createElement("canvas"),T=s.getContext("2d");let{width:j}=o,{height:q}=o;j>q?j>f&&(q*=f/j,j=f):q>f&&(j*=f/q,q=f),s.width=j,s.height=q,T.drawImage(o,0,0,j,q);const fe=s.toDataURL("image/jpeg");return[fe,sh(fe)]}(f,q)),q.src=j.target.result},T.readAsDataURL(o)})}vo.\u0275fac=function(o){return new(o||vo)(e.LFG(e.zs3))},vo.\u0275mod=e.oAB({type:vo}),vo.\u0275inj=e.cJS({providers:[]});const ch=["avatarFilePicker"];function lh(f,o){if(1&f&&e._UZ(0,"span",6),2&f){const s=e.oxw();e.Q6J("textContent",s.text.wrong_file_format)}}function dh(f,o){if(1&f&&(e.TgZ(0,"fieldset",11),e._UZ(1,"legend",12),e._UZ(2,"img",13),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("textContent",s.text.preview),e.xp6(1),e.Q6J("src",s.avatarPreviewUrl,e.LSH)}}const ph=function(f){return{"-error":f}};class Ps{constructor(o,s,T,j){this.I18n=o,this.elementRef=s,this.toastService=T,this.opFileUpload=j,this.busy=!1,this.fileInvalid=!1,this.text={label_choose_avatar:this.I18n.t("js.avatars.label_choose_avatar"),upload_instructions:this.I18n.t("js.avatars.text_upload_instructions"),error_too_large:this.I18n.t("js.avatars.error_image_too_large"),wrong_file_format:this.I18n.t("js.avatars.wrong_file_format"),button_update:this.I18n.t("js.button_update"),uploading:this.I18n.t("js.avatars.uploading_avatar"),preview:this.I18n.t("js.label_preview")}}ngOnInit(){const o=this.elementRef.nativeElement;this.target=o.getAttribute("target"),this.method=o.getAttribute("method")}onFilePickerChanged(o){const s=Array.from(this.avatarFilePicker.nativeElement.files);if(0===s.length)return;const T=s[0];-1!==["image/jpeg","image/png","image/gif"].indexOf(T.type)?ah(128,T).then(([j,q])=>{q.name=T.name,this.avatarFile=q,this.avatarPreviewUrl=j}):this.fileInvalid=!0}uploadAvatar(o){o.preventDefault(),this.busy=!0;const s=this.opFileUpload.uploadSingle(this.target,this.avatarFile,this.method,"text");this.toastService.addAttachmentUpload(this.text.uploading,[s]),s[1].subscribe(T=>{switch(T.type){case 0:return;case 4:return this.avatarFile.progress=100,this.busy=!1,void window.location.reload();default:return}},T=>{this.toastService.addError(T.error),this.busy=!1})}}Ps.\u0275fac=function(o){return new(o||Ps)(e.Y36(w.D),e.Y36(e.SBq),e.Y36(M.kl),e.Y36(dr.r))},Ps.\u0275cmp=e.Xpm({type:Ps,selectors:[["avatar-upload-form"]],viewQuery:function(o,s){if(1&o&&e.Gf(ch,7),2&o){let T;e.iGM(T=e.CRH())&&(s.avatarFilePicker=T.first)}},decls:11,vars:9,consts:[[1,"form--field"],["for","avatar_file_input",1,"form--label",3,"ngClass","textContent"],[1,"form--field-container"],["type","file","accept","image/jpeg,image/png,image/gif","id","avatar_file_input","name","avatar_file_input",3,"change"],["avatarFilePicker",""],[1,"form--field-instructions"],[3,"textContent"],[1,"avatars--error-pane"],[3,"textContent",4,"ngIf"],["class","preview",4,"ngIf"],["type","submit",1,"button","-highlight","-with-icon","icon-checkmark",3,"textContent","click"],[1,"preview"],[1,"preview--legend",3,"textContent"],[1,"avatars--local-avatar-preview",3,"src"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e._UZ(1,"label",1),e.TgZ(2,"div",2),e.TgZ(3,"input",3,4),e.NdJ("change",function(j){return s.onFilePickerChanged(j)}),e.qZA(),e.qZA(),e.TgZ(5,"div",5),e._UZ(6,"span",6),e.TgZ(7,"div",7),e.YNc(8,lh,1,1,"span",8),e.qZA(),e.qZA(),e.qZA(),e.YNc(9,dh,3,2,"fieldset",9),e.TgZ(10,"button",10),e.NdJ("click",function(j){return s.uploadAvatar(j)}),e.qZA()),2&o&&(e.xp6(1),e.Q6J("ngClass",e.VKq(7,ph,s.fileInvalid))("textContent",s.text.label_choose_avatar),e.xp6(5),e.Q6J("textContent",s.text.upload_instructions),e.xp6(2),e.Q6J("ngIf",s.fileInvalid),e.xp6(1),e.Q6J("ngIf",s.avatarPreviewUrl),e.xp6(1),e.Q6J("textContent",s.text.button_update),e.uIk("disabled",!s.avatarFile||s.busy||void 0))},directives:[I.mk,I.O5],encapsulation:2});class Co{constructor(o){o.get(C.$).register("openProjectAngularBootstrap",()=>[{selector:"avatar-upload-form",cls:Ps}])}}Co.\u0275fac=function(o){return new(o||Co)(e.LFG(e.zs3))},Co.\u0275mod=e.oAB({type:Co}),Co.\u0275inj=e.cJS({imports:[[I.ez]]});class uh extends Bs.X{constructor(){super(...arguments),this.attachmentsBackend=!1}}const hh=(0,aa.n)(uh);class yo{constructor(){window.OpenProject.getPluginContext().then(f=>{f.services.halResource.registerResource("Document",{cls:hh});const{states:s}=f.services;s.add("documents",(0,yn.r9)())})}}yo.\u0275fac=function(o){return new(o||yo)},yo.\u0275mod=e.oAB({type:yo}),yo.\u0275inj=e.cJS({});var mh=t(61024),gh=(t(24897),t(79505));class bo{sanitizeBranchString(o){return o.replace(/&/g,"and ").replace(/ +/g,"-").replace(/[\000-\039]/g,"").replace(/\177/g,"").replace(/[#\\\/\?\*\~\^\:\{\}@\.\[\]'"]/g,"").replace(/^[-]+/g,"").replace(/[-]+$/g,"").replace(/-+/g,"-").trim()}formattingInput(o){const s=o.type.name||"",T=o.id||"";return{id:T,type:s,title:o.subject,url:window.location.origin+o.pathHelper.workPackagePath(T),description:""}}sanitizeShellInput(o){return`${o.replace(/'/g,"\\'")}`}branchName(o){const{type:s,id:T,title:j}=this.formattingInput(o);return`${this.sanitizeBranchString(s)}/${T}-${this.sanitizeBranchString(j)}`.toLocaleLowerCase()}commitMessage(o){const{title:s,id:T,description:j,url:q}=this.formattingInput(o);return`[#${T}] ${s}\n\n${j}\n\n${q}\n`.replace(/\n\n+/g,"\n\n")}gitCommand(o){const s=this.branchName(o),T=this.commitMessage(o);return`git checkout -b '${this.sanitizeShellInput(s)}' && git commit --allow-empty -m '${this.sanitizeShellInput(T)}'`}}bo.\u0275fac=function(o){return new(o||bo)},bo.\u0275prov=e.Yz7({token:bo,factory:bo.\u0275fac,providedIn:"root"});var fh=t(36322),vh=t(30712);function Ch(f,o){if(1&f&&e._UZ(0,"div",11),2&f){const s=e.oxw(2);e.Q6J("textContent",s.lastCopyResult)}}function yh(f,o){if(1&f){const s=e.EpF();e.TgZ(0,"div",3),e.TgZ(1,"label",4),e.TgZ(2,"div",5),e._uU(3),e.qZA(),e.TgZ(4,"div",6),e._UZ(5,"input",7),e.TgZ(6,"button",8),e.NdJ("click",function(){const q=e.CHM(s).$implicit;return e.oxw().onCopyButtonClick(q)}),e._UZ(7,"op-icon",9),e.qZA(),e.YNc(8,Ch,1,1,"div",10),e.qZA(),e.qZA(),e.qZA()}if(2&f){const s=o.$implicit,T=e.oxw();e.xp6(3),e.Oqu(s.name),e.xp6(2),e.Q6J("value",s.textToCopy()),e.xp6(1),e.uIk("aria-label",T.text.copyButtonHelpText),e.xp6(2),e.Q6J("ngIf",T.showCopyResult&&s.id===T.copiedSnippetId)}}class ks extends fh.n{constructor(o,s,T){super(o),this.locals=o,this.I18n=s,this.gitActions=T,this.text={title:this.I18n.t("js.github_integration.tab_header.git_actions.title"),copyButtonHelpText:this.I18n.t("js.github_integration.tab_header.git_actions.copy_button_help"),copyResult:{success:this.I18n.t("js.github_integration.tab_header.git_actions.copy_success"),error:this.I18n.t("js.github_integration.tab_header.git_actions.copy_error")}},this.lastCopyResult=this.text.copyResult.success,this.showCopyResult=!1,this.copiedSnippetId="",this.snippets=[{id:"branch",name:this.I18n.t("js.github_integration.tab_header.git_actions.branch_name"),textToCopy:()=>this.gitActions.branchName(this.workPackage)},{id:"message",name:this.I18n.t("js.github_integration.tab_header.git_actions.commit_message"),textToCopy:()=>this.gitActions.commitMessage(this.workPackage)},{id:"command",name:this.I18n.t("js.github_integration.tab_header.git_actions.cmd"),textToCopy:()=>this.gitActions.gitCommand(this.workPackage)}],this.workPackage=this.locals.workPackage}onCopyButtonClick(o){(0,gh.Z)(o.textToCopy())?this.lastCopyResult=this.text.copyResult.success:this.lastCopyResult=this.text.copyResult.error,this.copiedSnippetId=o.id,this.showCopyResult=!0,window.setTimeout(()=>{this.showCopyResult=!1},2e3)}}ks.\u0275fac=function(o){return new(o||ks)(e.Y36(vh.Q),e.Y36(w.D),e.Y36(bo))},ks.\u0275cmp=e.Xpm({type:ks,selectors:[["op-git-actions-menu"]],inputs:{workPackage:"workPackage"},features:[e.qOj],decls:4,vars:2,consts:[[1,"git-actions-menu","dropdown-relative","dropdown","-overflow-in-view","dropdown-anchor-right"],[1,"title"],["class","copy-wrapper op-form-field",4,"ngFor","ngForOf"],[1,"copy-wrapper","op-form-field"],[1,"op-form-field--label-wrap"],[1,"op-form-field--label"],[1,"op-form-field--input"],["type","text","readonly","true",1,"copy-content","op-input",3,"value"],["type","button",1,"button","copy-button",3,"click"],["icon-classes","button--icon icon-copy"],["class","copy-result-message",3,"textContent",4,"ngIf"],[1,"copy-result-message",3,"textContent"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"h3",1),e._uU(2),e.qZA(),e.YNc(3,yh,9,4,"div",2),e.qZA()),2&o&&(e.xp6(2),e.Oqu(s.text.title),e.xp6(1),e.Q6J("ngForOf",s.snippets))},directives:[I.sg,ut.o,I.O5],styles:['.git-actions-menu[_ngcontent-%COMP%]{background-color:var(--body-background);border:var(--content-default-border-width) solid var(--content-default-border-color);padding:1rem 1rem 2rem;min-width:25rem;box-shadow:.1em .1em .4em #0000001a}.git-actions-menu[_ngcontent-%COMP%]   .copy-wrapper[_ngcontent-%COMP%]{width:100%;position:relative;margin-bottom:1rem}.git-actions-menu[_ngcontent-%COMP%]   .copy-content[_ngcontent-%COMP%]{width:calc(100% - 3em);min-height:calc(2 * .65em + .9em + 1px);border-radius:2px 0 0 2px;padding:.65em;color:var(--gray-dark);white-space:pre;resize:none;font-size:.9rem;display:inline-block}.git-actions-menu[_ngcontent-%COMP%]   .copy-button[_ngcontent-%COMP%]{margin:0;border:1px solid #ccc;border-radius:0 2px 2px 0;vertical-align:top;left:-1px;position:relative;font-size:.9rem}.git-actions-menu[_ngcontent-%COMP%]   .copy-button[_ngcontent-%COMP%]:hover{border-color:#999}.git-actions-menu[_ngcontent-%COMP%]   .copy-result-message[_ngcontent-%COMP%]{background-color:var(--main-menu-bg-color);display:inline-block;padding:.5em;border-radius:5px;color:var(--main-menu-font-color);position:absolute;right:0;top:calc(2 * .65em + .9em + 1px + 9px);box-shadow:1px 1px 4px var(--gray-dark);z-index:1}.git-actions-menu[_ngcontent-%COMP%]   .copy-result-message[_ngcontent-%COMP%]:before{content:"";border-bottom:.6em solid var(--main-menu-bg-color);height:0;width:0;position:absolute;top:-9px;right:10px;border-left:.3em solid transparent;border-right:.3em solid transparent}']});class xs extends ar.n{constructor(o,s){super(o,s),this.elementRef=o,this.opContextMenu=s}open(o){this.opContextMenu.show(this,o,ks)}get locals(){return{workPackage:this.workPackage,contextMenuId:"github-integration-git-actions-menu",items:[]}}}xs.\u0275fac=function(o){return new(o||xs)(e.Y36(e.SBq),e.Y36(rr.$))},xs.\u0275dir=e.lG2({type:xs,selectors:[["","gitActionsCopyDropdown",""]],inputs:{workPackage:["gitActionsCopyDropdown-workPackage","workPackage"]},features:[e.qOj]});class Es{constructor(o){this.I18n=o,this.text={title:this.I18n.t("js.github_integration.tab_header.title"),createPrButtonLabel:this.I18n.t("js.github_integration.tab_header.create_pr.label"),createPrButtonDescription:this.I18n.t("js.github_integration.tab_header.create_pr.description"),gitMenuLabel:this.I18n.t("js.github_integration.tab_header.copy_menu.label"),gitMenuDescription:this.I18n.t("js.github_integration.tab_header.copy_menu.description")}}}Es.\u0275fac=function(o){return new(o||Es)(e.Y36(w.D))},Es.\u0275cmp=e.Xpm({type:Es,selectors:[["tab-header"]],inputs:{workPackage:"workPackage"},decls:10,vars:4,consts:[[1,"github-pr-header"],[1,"title"],["icon-classes","button--icon icon-merge-branch"],[1,"toolbar-items","hide-when-print"],[1,"toolbar-item"],["type","button","gitActionsCopyDropdown","",1,"button","github-git-copy",3,"gitActionsCopyDropdown-workPackage"],["icon-classes","button--icon icon-console-light"],["aria-hidden","true",1,"button--text",3,"textContent"],["icon-classes","button--icon icon-small icon-pulldown hidden-for-mobile"]],template:function(o,s){1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"h3",1),e._UZ(2,"op-icon",2),e._uU(3),e.qZA(),e.TgZ(4,"ul",3),e.TgZ(5,"li",4),e.TgZ(6,"button",5),e._UZ(7,"op-icon",6),e._UZ(8,"span",7),e._UZ(9,"op-icon",8),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&o&&(e.xp6(3),e.hij(" ",s.text.title," "),e.xp6(3),e.Q6J("gitActionsCopyDropdown-workPackage",s.workPackage),e.uIk("aria-label",s.text.gitMenuDescription),e.xp6(2),e.Q6J("textContent",s.text.gitMenuLabel))},directives:[ut.o,xs],styles:[".github-pr-header[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap-reverse;justify-content:flex-end;border-bottom:1px solid #ddd;margin:1.5rem 0 .8rem}.github-pr-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{flex:1 1 auto;border-bottom:0;margin:0;padding:0;font-weight:bold;font-size:1rem;line-height:32px;text-transform:uppercase}"]});var bh=t(21501);function wh(f,o){if(1&f&&e._UZ(0,"img",12),2&f){const s=e.oxw();e.Q6J("src",s.pullRequest.githubUser.avatarUrl,e.LSH)}}function Th(f,o){if(1&f&&e._UZ(0,"a",13),2&f){const s=e.oxw();e.Q6J("href",s.pullRequest.githubUser.htmlUrl,e.LSH)("textContent",s.pullRequest.githubUser.login)}}function Ph(f,o){if(1&f&&(e.TgZ(0,"span",14),e._uU(1),e.qZA()),2&f){const s=e.oxw();e.xp6(1),e.Oqu(s.text.label_actions)}}function kh(f,o){if(1&f&&(e.TgZ(0,"li",17),e.TgZ(1,"span",18),e._UZ(2,"op-icon",19),e.qZA(),e.TgZ(3,"span",20),e._UZ(4,"img",21),e.qZA(),e.TgZ(5,"span",22),e._UZ(6,"span",23),e._UZ(7,"span",24),e.qZA(),e.TgZ(8,"span",25),e.TgZ(9,"a",26),e._uU(10),e.qZA(),e.qZA(),e.qZA()),2&f){const s=o.$implicit,T=e.oxw(2);e.xp6(1),e.Q6J("ngClass","op-pr-check--state-icon_"+T.checkRunState(s)),e.xp6(1),e.MGl("icon-classes","icon-",T.checkRunStateIcon(s),""),e.Q6J("icon-title",T.checkRunStateText(s)),e.xp6(2),e.Q6J("src",s.appOwnerAvatarUrl,e.LSH),e.xp6(2),e.Q6J("textContent",s.name),e.xp6(1),e.Q6J("textContent",T.checkRunStateText(s)),e.xp6(2),e.Q6J("href",s.detailsUrl,e.LSH),e.xp6(1),e.hij(" ",T.text.label_details," ")}}function xh(f,o){if(1&f&&(e.TgZ(0,"ul",15),e.YNc(1,kh,11,8,"li",16),e.qZA()),2&f){const s=e.oxw();e.uIk("aria-label",s.text.label_actions),e.xp6(1),e.Q6J("ngForOf",s.pullRequest.checkRuns)}}class Os{constructor(o,s){this.PathHelper=o,this.I18n=s,this.text={label_created_by:this.I18n.t("js.label_created_by"),label_last_updated_on:this.I18n.t("js.label_last_updated_on"),label_details:this.I18n.t("js.label_details"),label_actions:this.I18n.t("js.github_integration.github_actions")}}get state(){return"open"===this.pullRequest.state?this.pullRequest.draft?"draft":"open":this.pullRequest.merged?"merged":"closed"}checkRunStateText(o){return o.outputTitle||o.conclusion||o.status}checkRunState(o){return o.conclusion||o.status}checkRunStateIcon(o){switch(this.checkRunState(o)){case"success":return"checkmark";case"queued":return"getting-started";case"in_progress":return"loading1";case"failure":return"cancel";case"timed_out":return"reminder";case"action_required":return"warning";case"stale":return"not-supported";case"skipped":return"redo";case"neutral":case"cancelled":return"minus1";default:return"not-supported"}}}function Eh(f,o){if(1&f&&(e.ynx(0),e._UZ(1,"p",2),e.BQk()),2&f){const s=e.oxw();e.xp6(1),e.Q6J("innerHTML",s.getEmptyText(),e.oJD)}}function Oh(f,o){if(1&f&&e._UZ(0,"github-pull-request",3),2&f){const s=o.$implicit;e.Q6J("pullRequest",s)}}Os.\u0275fac=function(o){return new(o||Os)(e.Y36(Fe.j),e.Y36(w.D))},Os.\u0275cmp=e.Xpm({type:Os,selectors:[["github-pull-request"]],hostAttrs:[1,"op-pull-request"],inputs:{pullRequest:"pullRequest"},decls:17,vars:12,consts:[["target","blank",1,"op-pull-request--link",3,"href","textContent"],[1,"op-pull-request--title",3,"textContent"],[1,"op-pull-request--info"],["alt","PR author avatar","class","op-pull-request--avatar op-avatar op-avatar_mini",3,"src",4,"ngIf"],[1,"op-pull-request--user"],[3,"href","textContent",4,"ngIf"],[1,"op-pull-request--date"],[3,"dateTimeValue"],[1,"op-pull-request--state",3,"ngClass"],["icon-classes","button--icon icon-merge-branch"],["class","op-pull-request--checks-label",4,"ngIf"],["class","op-pull-request--checks",4,"ngIf"],["alt","PR author avatar",1,"op-pull-request--avatar","op-avatar","op-avatar_mini",3,"src"],[3,"href","textContent"],[1,"op-pull-request--checks-label"],[1,"op-pull-request--checks"],["class","op-pr-check",4,"ngFor","ngForOf"],[1,"op-pr-check"],[1,"op-pr-check--state-icon",3,"ngClass"],[3,"icon-classes","icon-title"],[1,"op-pr-check--avatar"],["alt","app owner avatar",3,"src"],[1,"op-pr-check--info"],[1,"op-pr-check--name",3,"textContent"],[1,"op-pr-check--state",3,"textContent"],[1,"op-pr-check--details"],[3,"href"]],template:function(o,s){1&o&&(e._UZ(0,"a",0),e._UZ(1,"div",1),e.TgZ(2,"div",2),e._uU(3),e.YNc(4,wh,1,1,"img",3),e.TgZ(5,"span",4),e.YNc(6,Th,1,2,"a",5),e._uU(7,". "),e.qZA(),e.TgZ(8,"span",6),e._uU(9),e._UZ(10,"op-date-time",7),e.qZA(),e._uU(11,".\n"),e.qZA(),e.TgZ(12,"span",8),e._UZ(13,"op-icon",9),e._uU(14),e.qZA(),e.YNc(15,Ph,2,1,"span",10),e.YNc(16,xh,2,2,"ul",11)),2&o&&(e.Q6J("href",s.pullRequest.htmlUrl,e.LSH)("textContent",s.pullRequest.repository+"#"+s.pullRequest.number),e.xp6(1),e.Q6J("textContent",s.pullRequest.title),e.xp6(2),e.hij(" ",s.text.label_created_by," "),e.xp6(1),e.Q6J("ngIf",s.pullRequest.githubUser),e.xp6(2),e.Q6J("ngIf",s.pullRequest.githubUser),e.xp6(3),e.hij(" ",s.text.label_last_updated_on," "),e.xp6(1),e.Q6J("dateTimeValue",s.pullRequest.githubUpdatedAt),e.xp6(2),e.Q6J("ngClass","op-pull-request--state_"+s.state),e.xp6(2),e.hij(" ",s.state,"\n"),e.xp6(1),e.Q6J("ngIf",null==s.pullRequest.checkRuns?null:s.pullRequest.checkRuns.length),e.xp6(1),e.Q6J("ngIf",null==s.pullRequest.checkRuns?null:s.pullRequest.checkRuns.length))},directives:[I.O5,bh.F,I.mk,ut.o,I.sg],styles:['.cdk-drag-preview[_ngcontent-%COMP%]{box-shadow:0 0 10px 5px #0000001a;z-index:10000!important}[_nghost-%COMP%], .op-pull-request[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto auto;grid-template-areas:"link link link link" "title title title state" "info info info info" "checks-label checks-label checks-label checks-label" "checks checks checks checks";margin-bottom:11px;padding-bottom:11px;border-bottom:1px solid #dddddd}[_nghost-%COMP%]:last-child, .op-pull-request[_ngcontent-%COMP%]:last-child{border-bottom:none}--title[_nghost-%COMP%], .op-pull-request--title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;-o-text-overflow:ellipsis;-ms-text-overflow:ellipsis;white-space:nowrap;font-weight:bold;grid-area:title;line-height:32px;margin-right:20px}--avatar[_nghost-%COMP%], .op-pull-request--avatar[_ngcontent-%COMP%]{grid-area:info}--info[_nghost-%COMP%], .op-pull-request--info[_ngcontent-%COMP%]{display:block;margin-bottom:3px;font-size:.9rem;grid-area:info;color:var(--gray-dark);margin-top:-4px}--date[_nghost-%COMP%], .op-pull-request--date[_ngcontent-%COMP%]{grid-area:info}--link[_nghost-%COMP%], .op-pull-request--link[_ngcontent-%COMP%]{grid-area:link;margin-top:6px;font-size:.9rem}--state[_nghost-%COMP%], .op-pull-request--state[_ngcontent-%COMP%]{grid-area:state;display:inline-block;padding:8px 11px;border-radius:16px;border:1px solid #fff;color:#fff;font-size:.9rem;text-transform:capitalize}--state_draft[_nghost-%COMP%], .op-pull-request--state_draft[_ngcontent-%COMP%]{background-color:#6a737d}--state_open[_nghost-%COMP%], .op-pull-request--state_open[_ngcontent-%COMP%]{background-color:#28a745}--state_merged[_nghost-%COMP%], .op-pull-request--state_merged[_ngcontent-%COMP%]{background-color:#6f42c1}--state_closed[_nghost-%COMP%], .op-pull-request--state_closed[_ngcontent-%COMP%]{background-color:#d73a49}--checks-label[_nghost-%COMP%], .op-pull-request--checks-label[_ngcontent-%COMP%]{grid-area:checks-label;margin-top:12px;font-size:.9rem;font-weight:bold}--checks[_nghost-%COMP%], .op-pull-request--checks[_ngcontent-%COMP%]{margin-top:12px;margin-left:0;grid-area:checks}','.op-pr-check[_ngcontent-%COMP%]{display:grid;grid-row:span 4;grid-template-columns:28px 33px 1fr auto;grid-template-areas:"check-state-icon check-avatar check-info check-details";list-style-type:none;border:1px solid #dddddd;padding:.3rem 1rem;background:rgba(0,0,0,.05);font-size:.9rem}.op-pr-check[_ngcontent-%COMP%]:first-child{border-top-right-radius:5px;border-top-left-radius:5px}.op-pr-check[_ngcontent-%COMP%]:last-child{border-bottom-right-radius:5px;border-bottom-left-radius:5px}.op-pr-check--avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{grid-area:check-avatar;display:inline-block;width:22px;height:22px;margin-right:5px;border-radius:var(--user-avatar-border-radius)}.op-pr-check--info[_ngcontent-%COMP%]{grid-area:check-info}.op-pr-check--state[_ngcontent-%COMP%]{color:var(--gray-dark);font-style:italic;margin-left:1em}.op-pr-check--state-icon[_ngcontent-%COMP%]{grid-area:check-state-icon}.op-pr-check--state-icon_queued[_ngcontent-%COMP%]{color:#5f9ea0}.op-pr-check--state-icon_in_progress[_ngcontent-%COMP%]{color:orange}.op-pr-check--state-icon_success[_ngcontent-%COMP%]{color:green}.op-pr-check--state-icon_failure[_ngcontent-%COMP%], .op-pr-check--state-icon_timed_out[_ngcontent-%COMP%], .op-pr-check--state-icon_action_required[_ngcontent-%COMP%], .op-pr-check--state-icon_stale[_ngcontent-%COMP%]{color:red}.op-pr-check--state-icon_skipped[_ngcontent-%COMP%], .op-pr-check--state-icon_neutral[_ngcontent-%COMP%], .op-pr-check--state-icon_cancelled[_ngcontent-%COMP%]{color:gray}.op-pr-check--details[_ngcontent-%COMP%]{grid-area:check-details}']});class Ms{constructor(o,s,T,j){this.I18n=o,this.apiV3Service=s,this.halResourceService=T,this.changeDetector=j,this.pullRequests=[]}ngOnInit(){var o;const s=null===(o=this.apiV3Service.work_packages.id({id:this.workPackage.id}))||void 0===o?void 0:o.github_pull_requests.path;this.halResourceService.get(s).subscribe(T=>{this.pullRequests=T.elements,this.changeDetector.detectChanges()})}getEmptyText(){return this.I18n.t("js.github_integration.tab_prs.empty",{wp_id:this.workPackage.id})}}Ms.\u0275fac=function(o){return new(o||Ms)(e.Y36(w.D),e.Y36(O.T),e.Y36(xt.u),e.Y36(e.sBO))},Ms.\u0275cmp=e.Xpm({type:Ms,selectors:[["tab-prs"]],hostAttrs:[1,"op-prs"],inputs:{workPackage:"workPackage"},decls:2,vars:2,consts:[[4,"ngIf"],[3,"pullRequest",4,"ngFor","ngForOf"],[3,"innerHTML"],[3,"pullRequest"]],template:function(o,s){1&o&&(e.YNc(0,Eh,2,1,"ng-container",0),e.YNc(1,Oh,1,1,"github-pull-request",1)),2&o&&(e.Q6J("ngIf",0===s.pullRequests.length),e.xp6(1),e.Q6J("ngForOf",s.pullRequests))},directives:[I.O5,I.sg,Os],encapsulation:2});class Is{constructor(o,s){this.PathHelper=o,this.I18n=s}}Is.\u0275fac=function(o){return new(o||Is)(e.Y36(Fe.j),e.Y36(w.D))},Is.\u0275cmp=e.Xpm({type:Is,selectors:[["github-tab"]],inputs:{workPackage:"workPackage"},decls:2,vars:2,consts:[[3,"workPackage"]],template:function(o,s){1&o&&(e._UZ(0,"tab-header",0),e._UZ(1,"tab-prs",0)),2&o&&(e.Q6J("workPackage",s.workPackage),e.xp6(1),e.Q6J("workPackage",s.workPackage))},directives:[Es,Ms],encapsulation:2});var Mh=t(61289);class wo extends Mh.N{constructor(o){super(),this.ConfigurationService=o}load(o){return o.github_pull_requests.$update().then(s=>this.sortList(s.elements))}sortList(o,s="createdAt"){return _.sortBy(_.flatten(o),s)}}wo.\u0275fac=function(o){return new(o||wo)(e.LFG(Ie.e))},wo.\u0275prov=e.Yz7({token:wo,factory:wo.\u0275fac});class To{constructor(o){!function(f){f.get(mh.o).register({component:Is,name:I18n.t("js.github_integration.work_packages.tab_name"),id:"github",displayable:s=>!!s.github})}(o)}}To.\u0275fac=function(o){return new(o||To)(e.LFG(e.zs3))},To.\u0275mod=e.oAB({type:To}),To.\u0275inj=e.cJS({providers:[wo],imports:[[n.H,_i.l]]});class Po{}Po.\u0275fac=function(o){return new(o||Po)},Po.\u0275mod=e.oAB({type:Po}),Po.\u0275inj=e.cJS({imports:[[fo,vo,Co,yo,To]]});var Sh=t(99197),Dh=t(48249),Ah=t(32042),jh=t(92054);class ko{}ko.\u0275fac=function(o){return new(o||ko)},ko.\u0275mod=e.oAB({type:ko}),ko.\u0275inj=e.cJS({providers:[sa.v,_r.W,on,Ah.P,jh.a]});class xo{ngDoBootstrap(o){a.Z.register(...$u),a.Z.bootstrapOptionalDocument(o,document),o._injector.get(C.$).call("openProjectAngularBootstrap").forEach(T=>{a.Z.bootstrapOptionalDocument(o,document,T)})}}xo.\u0275fac=function(o){return new(o||xo)},xo.\u0275mod=e.oAB({type:xo}),xo.\u0275inj=e.cJS({providers:[{provide:u.G,useValue:new u.G},{provide:e.ip1,useFactory:function(f){return()=>{const o=f.get(Qn),s=f.get(Yi),T=f.get(Vn);f.get(Cn),s.register(),o.setupListener(),T.register()}},deps:[e.zs3],multi:!0},Kc.N,Pn,dr.r,Dh.c,Gc.O,_t.D,Cn],imports:[[i.b2,n.H,h.s,ko,jn,cl.f,d.$,r.E,Qi,l.Z,Jc.OpenprojectProjectsModule,p.H,Wn,yi,m.OpenprojectCalendarModule,Bn,Jn,$n,Un,eo,zn,mo,Po,Hn,c.UX,Gn,y.K,Hc.N,Mr.C,_i.l,Sh.OpenProjectInAppNotificationsModule]]});var vr=t(31600),Zh=t(82561),Cr=t(92340),Fh=t(8849);class Ss{constructor(){this.contextCallbacks=[],this.messageStack=[],this.sentryConfigured=!0;const o=document.querySelector("meta[name=openproject_sentry]");null!==o?this.loadSentry(o):(this.sentryConfigured=!1,this.messageStack=[])}loadSentry(o){const s=o.dataset.dsn||"",T=o.dataset.version||"unknown",j=parseFloat(o.dataset.tracingFactor||"0.0");t.e("src_app_core_errors_sentry_sentry-dependency_ts").then(t.bind(t,82543)).then(q=>{const fe=q.Sentry;fe.init({dsn:s,debug:!Cr.N.production,release:T,environment:Cr.N.production?"production":"development",integrations:[new q.Integrations.BrowserTracing],tracesSampler:Be=>{switch(Be.transactionContext.op){case"op":case"navigation":return Math.min(.01*j,1);default:return Math.min(.001*j,1)}},ignoreErrors:["The transition has been superseded by a different transition","Uncaught (in promise)","Non-Error exception captured with keys: $embedded, $halType, $links, $loaded"],beforeSend:(Be,Ye)=>Ss.filterEvent(Be,Ye)}),this.sentryLoaded(fe)})}sentryLoaded(o){this.client=o,o.configureScope(this.setupContext.bind(this)),this.messageStack.forEach(s=>{this[s.type].bind(this).apply(s.args)})}captureMessage(o,s="info"){this.client?this.client.withScope(T=>{this.setupContext(T),this.client.captureMessage(o,Zh.z.fromString(s))}):this.handleOfflineMessage("captureMessage",[o,s])}captureException(o){if(!this.client||!o)throw this.handleOfflineMessage("captureException",[o]),o;"string"!=typeof o?this.client.withScope(s=>{this.setupContext(s),this.client.captureException(o)}):this.captureMessage(o,"error")}addContext(...o){this.contextCallbacks.push(...o),this.client&&o.forEach(s=>this.client.configureScope(s))}handleOfflineMessage(o,s){this.sentryConfigured?this.messageStack.push({type:o,args:s}):(0,Kn.qu)("[ErrorReporter] Would queue sentry message %O %O, but is not configured.",o,s)}setupContext(o){o.setTag("code_origin","frontend"),o.setTag("locale",window.I18n.locale),o.setTag("domain",window.location.hostname),o.setTag("url_path",window.location.pathname),o.setExtra("url_query",window.location.search),this.contextCallbacks.forEach(s=>s(o))}static filterEvent(o,s){const T=null==s?void 0:s.originalException;return T instanceof mi.UA?Ss.filterHttpError(o,T):T instanceof Fh.o?Ss.filterHttpError(o,T.httpError):document.body.classList.contains("-unsupported-browser")?(console.warn("Browser is not supported, skipping sentry reporting completely."),null):o}static filterHttpError(o,s){return s.status>=500?o:null}}window.global=window;window.appBasePath=vr("meta[name=app_base_path]").attr("content")||"",t.p=window.appBasePath+"/assets/frontend/",window.ErrorReporter=new Ss,t(50725),t(47281),Cr.N.production&&(0,e.G48)(),(0,Kn.SC)(()=>{window.enableReactiveStatesLogging=()=>(0,yn.$C)(!0),window.disableReactiveStatesLogging=()=>(0,yn.$C)(!1)}),function(){const f=document.querySelector("meta[name=openproject_initializer]"),o=f.dataset.locale||"en",s=parseInt(f.dataset.firstDayOfWeek||"",10),T=parseInt(f.dataset.firstWeekOfYear||"",10);return I18n.locale=o,!Number.isNaN(s)&&!Number.isNaN(T)&&(I18n.firstDayOfWeek=s,rt.updateLocale(o,{week:{dow:s,doy:7+s-T}})),I18n.pluralization.default=function(j){switch(j){case 0:return["zero","other"];case 1:return["one","other"];default:return["other"]}},t(51230)(`./${I18n.locale}.js`)}().then(()=>{vr(()=>{i.q6().bootstrapModule(xo).then(()=>{vr("body").addClass("__ng2-bootstrap-has-run")})})})},30341:(H,D,t)=>{var i={"./apl/apl.js":[55818,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_apl_apl_js"],"./asciiarmor/asciiarmor.js":[36050,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_asciiarmor_asciiarmor_js"],"./asn.1/asn.1.js":[5923,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_asn_1_asn_1_js"],"./asterisk/asterisk.js":[37277,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_asterisk_asterisk_js"],"./brainfuck/brainfuck.js":[30942,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_brainfuck_brainfuck_js"],"./clike/clike.js":[70409,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_clike_clike_js"],"./clojure/clojure.js":[99505,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_clojure_clojure_js"],"./cmake/cmake.js":[15022,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_cmake_cmake_js"],"./cobol/cobol.js":[96407,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_cobol_cobol_js"],"./coffeescript/coffeescript.js":[13359,"default-node_modules_codemirror_lib_codemirror_js","common"],"./commonlisp/commonlisp.js":[97677,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_commonlisp_commonlisp_js"],"./crystal/crystal.js":[42081,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_crystal_crystal_js"],"./css/css.js":[1040,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_css_css_js"],"./cypher/cypher.js":[13430,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_cypher_cypher_js"],"./d/d.js":[18346,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_d_d_js"],"./dart/dart.js":[21691,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_clike_clike_js","node_modules_codemirror_mode_dart_dart_js"],"./diff/diff.js":[56948,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_diff_diff_js"],"./django/django.js":[73829,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","common","node_modules_codemirror_mode_django_django_js"],"./dockerfile/dockerfile.js":[2875,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_dockerfile_dockerfile_js"],"./dtd/dtd.js":[32178,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_dtd_dtd_js"],"./dylan/dylan.js":[80105,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_dylan_dylan_js"],"./ebnf/ebnf.js":[21856,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ebnf_ebnf_js"],"./ecl/ecl.js":[57813,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ecl_ecl_js"],"./eiffel/eiffel.js":[18251,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_eiffel_eiffel_js"],"./elm/elm.js":[78923,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_elm_elm_js"],"./erlang/erlang.js":[7247,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_erlang_erlang_js"],"./factor/factor.js":[77281,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_factor_factor_js"],"./fcl/fcl.js":[1877,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_fcl_fcl_js"],"./forth/forth.js":[90045,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_forth_forth_js"],"./fortran/fortran.js":[35866,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_fortran_fortran_js"],"./gas/gas.js":[55653,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_gas_gas_js"],"./gfm/gfm.js":[3900,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_markdown_markdown_js","common","node_modules_codemirror_mode_gfm_gfm_js"],"./gherkin/gherkin.js":[56061,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_gherkin_gherkin_js"],"./go/go.js":[94883,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_go_go_js"],"./groovy/groovy.js":[93716,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_groovy_groovy_js"],"./haml/haml.js":[33498,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","common","node_modules_codemirror_mode_haml_haml_js"],"./handlebars/handlebars.js":[41025,"default-node_modules_codemirror_lib_codemirror_js","common"],"./haskell-literate/haskell-literate.js":[70852,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_haskell-literate_haskell-literate_js"],"./haskell/haskell.js":[6370,"default-node_modules_codemirror_lib_codemirror_js","common"],"./haxe/haxe.js":[73066,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_haxe_haxe_js"],"./htmlembedded/htmlembedded.js":[83837,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","common","node_modules_codemirror_mode_htmlembedded_htmlembedded_js"],"./htmlmixed/htmlmixed.js":[26083,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","node_modules_codemirror_mode_htmlmixed_htmlmixed_js"],"./http/http.js":[91872,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_http_http_js"],"./idl/idl.js":[14195,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_idl_idl_js"],"./javascript/javascript.js":[39837,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js"],"./jinja2/jinja2.js":[6136,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_jinja2_jinja2_js"],"./jsx/jsx.js":[71557,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","node_modules_codemirror_mode_jsx_jsx_js"],"./julia/julia.js":[93958,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_julia_julia_js"],"./livescript/livescript.js":[22961,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_livescript_livescript_js"],"./lua/lua.js":[96704,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_lua_lua_js"],"./markdown/markdown.js":[90191,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_markdown_markdown_js"],"./mathematica/mathematica.js":[56569,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mathematica_mathematica_js"],"./mbox/mbox.js":[47905,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mbox_mbox_js"],"./mirc/mirc.js":[36167,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mirc_mirc_js"],"./mllike/mllike.js":[50772,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mllike_mllike_js"],"./modelica/modelica.js":[22860,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_modelica_modelica_js"],"./mscgen/mscgen.js":[60351,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mscgen_mscgen_js"],"./mumps/mumps.js":[87269,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_mumps_mumps_js"],"./nginx/nginx.js":[73946,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_nginx_nginx_js"],"./nsis/nsis.js":[4866,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_nsis_nsis_js"],"./ntriples/ntriples.js":[90951,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ntriples_ntriples_js"],"./octave/octave.js":[66e3,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_octave_octave_js"],"./oz/oz.js":[24371,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_oz_oz_js"],"./pascal/pascal.js":[36390,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_pascal_pascal_js"],"./pegjs/pegjs.js":[85515,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","node_modules_codemirror_mode_pegjs_pegjs_js"],"./perl/perl.js":[66727,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_perl_perl_js"],"./php/php.js":[13283,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_clike_clike_js","node_modules_codemirror_mode_php_php_js"],"./pig/pig.js":[52488,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_pig_pig_js"],"./powershell/powershell.js":[4757,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_powershell_powershell_js"],"./properties/properties.js":[73226,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_properties_properties_js"],"./protobuf/protobuf.js":[23455,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_protobuf_protobuf_js"],"./pug/pug.js":[60850,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_pug_pug_js"],"./puppet/puppet.js":[16367,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_puppet_puppet_js"],"./python/python.js":[84229,"default-node_modules_codemirror_lib_codemirror_js","common"],"./q/q.js":[92885,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_q_q_js"],"./r/r.js":[26389,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_r_r_js"],"./rpm/rpm.js":[77995,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_rpm_rpm_js"],"./rst/rst.js":[15215,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_rst_rst_js"],"./ruby/ruby.js":[88558,"default-node_modules_codemirror_lib_codemirror_js","common"],"./rust/rust.js":[50871,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_rust_rust_js"],"./sas/sas.js":[17540,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_sas_sas_js"],"./sass/sass.js":[49966,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_css_css_js","common"],"./scheme/scheme.js":[99975,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_scheme_scheme_js"],"./shell/shell.js":[11577,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_shell_shell_js"],"./sieve/sieve.js":[31208,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_sieve_sieve_js"],"./slim/slim.js":[26469,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","common","node_modules_codemirror_mode_slim_slim_js"],"./smalltalk/smalltalk.js":[18009,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_smalltalk_smalltalk_js"],"./smarty/smarty.js":[45002,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_smarty_smarty_js"],"./solr/solr.js":[20899,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_solr_solr_js"],"./soy/soy.js":[5369,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","node_modules_codemirror_mode_soy_soy_js"],"./sparql/sparql.js":[99767,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_sparql_sparql_js"],"./spreadsheet/spreadsheet.js":[31343,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_spreadsheet_spreadsheet_js"],"./sql/sql.js":[85883,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_sql_sql_js"],"./stex/stex.js":[18681,"default-node_modules_codemirror_lib_codemirror_js","common"],"./stylus/stylus.js":[78176,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_stylus_stylus_js"],"./swift/swift.js":[68711,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_swift_swift_js"],"./tcl/tcl.js":[36410,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_tcl_tcl_js"],"./textile/textile.js":[28556,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_textile_textile_js"],"./tiddlywiki/tiddlywiki.js":[55959,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_tiddlywiki_tiddlywiki_js"],"./tiki/tiki.js":[32740,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_tiki_tiki_js"],"./toml/toml.js":[54804,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_toml_toml_js"],"./tornado/tornado.js":[53373,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","common","node_modules_codemirror_mode_tornado_tornado_js"],"./troff/troff.js":[1462,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_troff_troff_js"],"./ttcn-cfg/ttcn-cfg.js":[37942,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ttcn-cfg_ttcn-cfg_js"],"./ttcn/ttcn.js":[88430,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_ttcn_ttcn_js"],"./turtle/turtle.js":[18409,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_turtle_turtle_js"],"./twig/twig.js":[71632,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_twig_twig_js"],"./vb/vb.js":[58781,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_vb_vb_js"],"./vbscript/vbscript.js":[24594,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_vbscript_vbscript_js"],"./velocity/velocity.js":[97145,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_velocity_velocity_js"],"./verilog/verilog.js":[2456,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_verilog_verilog_js"],"./vhdl/vhdl.js":[92865,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_vhdl_vhdl_js"],"./vue/vue.js":[88869,"default-node_modules_codemirror_lib_codemirror_js","default-node_modules_codemirror_mode_javascript_javascript_js","default-node_modules_codemirror_mode_css_css_js","default-node_modules_codemirror_mode_stylus_stylus_js","default-node_modules_codemirror_mode_pug_pug_js","common","node_modules_codemirror_mode_vue_vue_js"],"./wast/wast.js":[38602,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_wast_wast_js"],"./webidl/webidl.js":[79883,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_webidl_webidl_js"],"./xml/xml.js":[79140,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_xml_xml_js"],"./xquery/xquery.js":[34218,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_xquery_xquery_js"],"./yacas/yacas.js":[34785,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_yacas_yacas_js"],"./yaml-frontmatter/yaml-frontmatter.js":[796,"default-node_modules_codemirror_lib_codemirror_js","common","node_modules_codemirror_mode_yaml-frontmatter_yaml-frontmatter_js"],"./yaml/yaml.js":[35098,"default-node_modules_codemirror_lib_codemirror_js","common"],"./z80/z80.js":[59190,"default-node_modules_codemirror_lib_codemirror_js","node_modules_codemirror_mode_z80_z80_js"]};function e(c){if(!t.o(i,c))return Promise.resolve().then(()=>{var n=new Error("Cannot find module '"+c+"'");throw n.code="MODULE_NOT_FOUND",n});var u=i[c],r=u[0];return Promise.all(u.slice(1).map(t.e)).then(()=>t.t(r,23))}e.keys=()=>Object.keys(i),e.id=30341,H.exports=e},32198:(H,D,t)=>{H.exports=global.I18n=t(32091)},46700:(H,D,t)=>{var i={"./af":62275,"./af.js":62275,"./ar":90857,"./ar-dz":11218,"./ar-dz.js":11218,"./ar-kw":14754,"./ar-kw.js":14754,"./ar-ly":66680,"./ar-ly.js":66680,"./ar-ma":92178,"./ar-ma.js":92178,"./ar-sa":56522,"./ar-sa.js":56522,"./ar-tn":95682,"./ar-tn.js":95682,"./ar.js":90857,"./az":70164,"./az.js":70164,"./be":79774,"./be.js":79774,"./bg":60947,"./bg.js":60947,"./bm":21832,"./bm.js":21832,"./bn":89650,"./bn-bd":74477,"./bn-bd.js":74477,"./bn.js":89650,"./bo":66005,"./bo.js":66005,"./br":98492,"./br.js":98492,"./bs":70534,"./bs.js":70534,"./ca":52061,"./ca.js":52061,"./cs":84737,"./cs.js":84737,"./cv":61167,"./cv.js":61167,"./cy":77996,"./cy.js":77996,"./da":9528,"./da.js":9528,"./de":14540,"./de-at":49430,"./de-at.js":49430,"./de-ch":67978,"./de-ch.js":67978,"./de.js":14540,"./dv":83426,"./dv.js":83426,"./el":6616,"./el.js":6616,"./en-au":63816,"./en-au.js":63816,"./en-ca":32162,"./en-ca.js":32162,"./en-gb":83305,"./en-gb.js":83305,"./en-ie":61954,"./en-ie.js":61954,"./en-il":43060,"./en-il.js":43060,"./en-in":59923,"./en-in.js":59923,"./en-nz":13540,"./en-nz.js":13540,"./en-sg":16505,"./en-sg.js":16505,"./eo":41907,"./eo.js":41907,"./es":86640,"./es-do":41246,"./es-do.js":41246,"./es-mx":56131,"./es-mx.js":56131,"./es-us":36430,"./es-us.js":36430,"./es.js":86640,"./et":62551,"./et.js":62551,"./eu":32711,"./eu.js":32711,"./fa":54572,"./fa.js":54572,"./fi":33390,"./fi.js":33390,"./fil":87860,"./fil.js":87860,"./fo":48216,"./fo.js":48216,"./fr":99291,"./fr-ca":98527,"./fr-ca.js":98527,"./fr-ch":58407,"./fr-ch.js":58407,"./fr.js":99291,"./fy":47054,"./fy.js":47054,"./ga":49540,"./ga.js":49540,"./gd":73917,"./gd.js":73917,"./gl":51486,"./gl.js":51486,"./gom-deva":56245,"./gom-deva.js":56245,"./gom-latn":48868,"./gom-latn.js":48868,"./gu":59652,"./gu.js":59652,"./he":89019,"./he.js":89019,"./hi":42040,"./hi.js":42040,"./hr":63402,"./hr.js":63402,"./hu":79322,"./hu.js":79322,"./hy-am":27609,"./hy-am.js":27609,"./id":57942,"./id.js":57942,"./is":98275,"./is.js":98275,"./it":73053,"./it-ch":4378,"./it-ch.js":4378,"./it.js":73053,"./ja":46176,"./ja.js":46176,"./jv":679,"./jv.js":679,"./ka":92726,"./ka.js":92726,"./kk":72953,"./kk.js":72953,"./km":86957,"./km.js":86957,"./kn":59181,"./kn.js":59181,"./ko":47148,"./ko.js":47148,"./ku":27752,"./ku.js":27752,"./ky":65675,"./ky.js":65675,"./lb":41263,"./lb.js":41263,"./lo":65746,"./lo.js":65746,"./lt":11143,"./lt.js":11143,"./lv":38753,"./lv.js":38753,"./me":44054,"./me.js":44054,"./mi":31573,"./mi.js":31573,"./mk":30202,"./mk.js":30202,"./ml":68523,"./ml.js":68523,"./mn":79794,"./mn.js":79794,"./mr":56681,"./mr.js":56681,"./ms":56975,"./ms-my":39859,"./ms-my.js":39859,"./ms.js":56975,"./mt":3691,"./mt.js":3691,"./my":5152,"./my.js":5152,"./nb":7607,"./nb.js":7607,"./ne":21526,"./ne.js":21526,"./nl":86368,"./nl-be":40076,"./nl-be.js":40076,"./nl.js":86368,"./nn":68420,"./nn.js":68420,"./oc-lnc":51906,"./oc-lnc.js":51906,"./pa-in":94504,"./pa-in.js":94504,"./pl":54721,"./pl.js":54721,"./pt":74645,"./pt-br":54548,"./pt-br.js":54548,"./pt.js":74645,"./ro":71977,"./ro.js":71977,"./ru":26042,"./ru.js":26042,"./sd":78849,"./sd.js":78849,"./se":27739,"./se.js":27739,"./si":50084,"./si.js":50084,"./sk":92449,"./sk.js":92449,"./sl":23086,"./sl.js":23086,"./sq":33139,"./sq.js":33139,"./sr":30607,"./sr-cyrl":30063,"./sr-cyrl.js":30063,"./sr.js":30607,"./ss":40131,"./ss.js":40131,"./sv":21665,"./sv.js":21665,"./sw":5642,"./sw.js":5642,"./ta":33622,"./ta.js":33622,"./te":74825,"./te.js":74825,"./tet":48336,"./tet.js":48336,"./tg":39238,"./tg.js":39238,"./th":99463,"./th.js":99463,"./tk":39986,"./tk.js":39986,"./tl-ph":29672,"./tl-ph.js":29672,"./tlh":40043,"./tlh.js":40043,"./tr":51212,"./tr.js":51212,"./tzl":50110,"./tzl.js":50110,"./tzm":80482,"./tzm-latn":38309,"./tzm-latn.js":38309,"./tzm.js":80482,"./ug-cn":42495,"./ug-cn.js":42495,"./uk":54157,"./uk.js":54157,"./ur":80984,"./ur.js":80984,"./uz":64141,"./uz-latn":43662,"./uz-latn.js":43662,"./uz.js":64141,"./vi":12607,"./vi.js":12607,"./x-pseudo":66460,"./x-pseudo.js":66460,"./yo":92948,"./yo.js":92948,"./zh-cn":62658,"./zh-cn.js":62658,"./zh-hk":39352,"./zh-hk.js":39352,"./zh-mo":38274,"./zh-mo.js":38274,"./zh-tw":98451,"./zh-tw.js":98451};function e(u){var r=c(u);return t(r)}function c(u){if(!t.o(i,u)){var r=new Error("Cannot find module '"+u+"'");throw r.code="MODULE_NOT_FOUND",r}return i[u]}e.keys=function(){return Object.keys(i)},e.resolve=c,H.exports=e,e.id=46700},37294:(H,D,t)=>{var i={"./admin_users":[5022,7,"src_app_core_augmenting_dynamic-scripts_admin_users_js"],"./admin_users.js":[5022,7,"src_app_core_augmenting_dynamic-scripts_admin_users_js"],"./administration_settings":[62739,7,"src_app_core_augmenting_dynamic-scripts_administration_settings_js"],"./administration_settings.js":[62739,7,"src_app_core_augmenting_dynamic-scripts_administration_settings_js"],"./backlogs":[32505,7,"common","src_app_core_augmenting_dynamic-scripts_backlogs_js"],"./backlogs.js":[32505,7,"common","src_app_core_augmenting_dynamic-scripts_backlogs_js"],"./backlogs/backlog":[57915,7,"common"],"./backlogs/backlog.js":[57915,7,"common"],"./backlogs/burndown":[12847,7,"common"],"./backlogs/burndown.js":[12847,7,"common"],"./backlogs/common":[61562,7,"common"],"./backlogs/common.js":[61562,7,"common"],"./backlogs/editable_inplace":[68040,7,"common"],"./backlogs/editable_inplace.js":[68040,7,"common"],"./backlogs/impediment":[86733,7,"common"],"./backlogs/impediment.js":[86733,7,"common"],"./backlogs/master_backlog":[6250,7,"common"],"./backlogs/master_backlog.js":[6250,7,"common"],"./backlogs/model":[20527,7,"common"],"./backlogs/model.js":[20527,7,"common"],"./backlogs/show_main":[63074,7,"common"],"./backlogs/show_main.js":[63074,7,"common"],"./backlogs/sprint":[80933,7,"common"],"./backlogs/sprint.js":[80933,7,"common"],"./backlogs/story":[71076,7,"common"],"./backlogs/story.js":[71076,7,"common"],"./backlogs/task":[10926,7,"common"],"./backlogs/task.js":[10926,7,"common"],"./backlogs/taskboard":[59439,7,"common"],"./backlogs/taskboard.js":[59439,7,"common"],"./backlogs/work_package":[39503,7,"common"],"./backlogs/work_package.js":[39503,7,"common"],"./custom_fields":[95691,7,"src_app_core_augmenting_dynamic-scripts_custom_fields_js"],"./custom_fields.js":[95691,7,"src_app_core_augmenting_dynamic-scripts_custom_fields_js"],"./forums":[99068,7,"src_app_core_augmenting_dynamic-scripts_forums_js"],"./forums.js":[99068,7,"src_app_core_augmenting_dynamic-scripts_forums_js"],"./global_roles":[49140,7,"src_app_core_augmenting_dynamic-scripts_global_roles_ts"],"./global_roles.ts":[49140,7,"src_app_core_augmenting_dynamic-scripts_global_roles_ts"],"./meeting":[81522,7,"src_app_core_augmenting_dynamic-scripts_meeting_js"],"./meeting.js":[81522,7,"src_app_core_augmenting_dynamic-scripts_meeting_js"],"./members_form":[48299,7,"src_app_core_augmenting_dynamic-scripts_members_form_js"],"./members_form.js":[48299,7,"src_app_core_augmenting_dynamic-scripts_members_form_js"],"./new_user":[52722,7,"src_app_core_augmenting_dynamic-scripts_new_user_js"],"./new_user.js":[52722,7,"src_app_core_augmenting_dynamic-scripts_new_user_js"],"./project":[98798,7,"src_app_core_augmenting_dynamic-scripts_project_js"],"./project.js":[98798,7,"src_app_core_augmenting_dynamic-scripts_project_js"],"./project_form_listener":[65904,7,"src_app_core_augmenting_dynamic-scripts_project_form_listener_js"],"./project_form_listener.js":[65904,7,"src_app_core_augmenting_dynamic-scripts_project_form_listener_js"],"./repository_navigation":[78076,7,"src_app_core_augmenting_dynamic-scripts_repository_navigation_js"],"./repository_navigation.js":[78076,7,"src_app_core_augmenting_dynamic-scripts_repository_navigation_js"],"./repository_settings":[58562,7,"src_app_core_augmenting_dynamic-scripts_repository_settings_js"],"./repository_settings.js":[58562,7,"src_app_core_augmenting_dynamic-scripts_repository_settings_js"],"./two_factor_authentication":[84078,9,"src_app_core_augmenting_dynamic-scripts_two_factor_authentication_ts"],"./two_factor_authentication.ts":[84078,9,"src_app_core_augmenting_dynamic-scripts_two_factor_authentication_ts"]};function e(c){if(!t.o(i,c))return Promise.resolve().then(()=>{var n=new Error("Cannot find module '"+c+"'");throw n.code="MODULE_NOT_FOUND",n});var u=i[c],r=u[0];return Promise.all(u.slice(2).map(t.e)).then(()=>t.t(r,16|u[1]))}e.keys=()=>Object.keys(i),e.id=37294,H.exports=e},51230:(H,D,t)=>{var i={"./af.js":[63158,"src_locales_af_js"],"./ar.js":[71100,"src_locales_ar_js"],"./az.js":[8135,"src_locales_az_js"],"./be.js":[27095,"src_locales_be_js"],"./bg.js":[2140,"src_locales_bg_js"],"./bn.js":[27e3,"src_locales_bn_js"],"./bs.js":[72886,"src_locales_bs_js"],"./ca.js":[83103,"src_locales_ca_js"],"./cs.js":[54042,"src_locales_cs_js"],"./cy.js":[28689,"src_locales_cy_js"],"./da.js":[7331,"src_locales_da_js"],"./de-AT.js":[72475,"src_locales_de-AT_js"],"./de-CH.js":[16864,"src_locales_de-CH_js"],"./de-DE.js":[72082,"src_locales_de-DE_js"],"./de.js":[81972,"src_locales_de_js"],"./el-CY.js":[64354,"src_locales_el-CY_js"],"./el.js":[97792,"src_locales_el_js"],"./en-AU.js":[45079,"src_locales_en-AU_js"],"./en-CA.js":[10653,"src_locales_en-CA_js"],"./en-CY.js":[20608,"src_locales_en-CY_js"],"./en-GB.js":[85186,"src_locales_en-GB_js"],"./en-IE.js":[78114,"src_locales_en-IE_js"],"./en-IN.js":[29656,"src_locales_en-IN_js"],"./en-NZ.js":[6086,"src_locales_en-NZ_js"],"./en-TT.js":[75109,"src_locales_en-TT_js"],"./en-US.js":[66183,"src_locales_en-US_js"],"./en-ZA.js":[26790,"src_locales_en-ZA_js"],"./en.js":[49058,"src_locales_en_js"],"./eo.js":[13634,"src_locales_eo_js"],"./es-419.js":[14585,"src_locales_es-419_js"],"./es-AR.js":[84730,"src_locales_es-AR_js"],"./es-CL.js":[90497,"src_locales_es-CL_js"],"./es-CO.js":[58668,"src_locales_es-CO_js"],"./es-CR.js":[61158,"src_locales_es-CR_js"],"./es-EC.js":[51495,"src_locales_es-EC_js"],"./es-ES.js":[73295,"src_locales_es-ES_js"],"./es-MX.js":[86920,"src_locales_es-MX_js"],"./es-NI.js":[72142,"src_locales_es-NI_js"],"./es-PA.js":[71093,"src_locales_es-PA_js"],"./es-PE.js":[1470,"src_locales_es-PE_js"],"./es-US.js":[41433,"src_locales_es-US_js"],"./es-VE.js":[68880,"src_locales_es-VE_js"],"./es.js":[48238,"src_locales_es_js"],"./et.js":[97443,"src_locales_et_js"],"./eu.js":[84126,"src_locales_eu_js"],"./fa.js":[81870,"src_locales_fa_js"],"./fi.js":[13587,"src_locales_fi_js"],"./fil.js":[7612,"src_locales_fil_js"],"./fr-CA.js":[82236,"src_locales_fr-CA_js"],"./fr-CH.js":[71025,"src_locales_fr-CH_js"],"./fr-FR.js":[81079,"src_locales_fr-FR_js"],"./fr.js":[38703,"src_locales_fr_js"],"./gl.js":[61372,"src_locales_gl_js"],"./he.js":[62539,"src_locales_he_js"],"./hi-IN.js":[86299,"src_locales_hi-IN_js"],"./hi.js":[65684,"src_locales_hi_js"],"./hr.js":[69006,"src_locales_hr_js"],"./hu.js":[67207,"src_locales_hu_js"],"./id.js":[67629,"src_locales_id_js"],"./is.js":[88879,"src_locales_is_js"],"./it-CH.js":[42753,"src_locales_it-CH_js"],"./it.js":[91281,"src_locales_it_js"],"./ja.js":[25276,"src_locales_ja_js"],"./ka.js":[87716,"src_locales_ka_js"],"./km.js":[20202,"src_locales_km_js"],"./kn.js":[71330,"src_locales_kn_js"],"./ko.js":[9312,"src_locales_ko_js"],"./lb.js":[39574,"src_locales_lb_js"],"./lo.js":[46772,"src_locales_lo_js"],"./lol.js":[61908,"src_locales_lol_js"],"./lt.js":[38328,"src_locales_lt_js"],"./lv.js":[82289,"src_locales_lv_js"],"./mg.js":[94740,"src_locales_mg_js"],"./mk.js":[91210,"src_locales_mk_js"],"./ml.js":[87452,"src_locales_ml_js"],"./mn.js":[79835,"src_locales_mn_js"],"./mr-IN.js":[32737,"src_locales_mr-IN_js"],"./ms.js":[12873,"src_locales_ms_js"],"./nb.js":[99343,"src_locales_nb_js"],"./ne.js":[60983,"src_locales_ne_js"],"./nl.js":[63837,"src_locales_nl_js"],"./nn.js":[62144,"src_locales_nn_js"],"./no.js":[42684,"src_locales_no_js"],"./oc.js":[76003,"src_locales_oc_js"],"./or.js":[89030,"src_locales_or_js"],"./pa.js":[42335,"src_locales_pa_js"],"./pap-AW.js":[82268,"src_locales_pap-AW_js"],"./pap-CW.js":[76212,"src_locales_pap-CW_js"],"./pl.js":[52635,"src_locales_pl_js"],"./pt-BR.js":[94145,"src_locales_pt-BR_js"],"./pt.js":[38366,"src_locales_pt_js"],"./rm.js":[99603,"src_locales_rm_js"],"./ro.js":[58721,"src_locales_ro_js"],"./ru.js":[85745,"src_locales_ru_js"],"./rw.js":[79666,"src_locales_rw_js"],"./si.js":[74743,"src_locales_si_js"],"./sk.js":[88230,"src_locales_sk_js"],"./sl.js":[31928,"src_locales_sl_js"],"./sq.js":[41520,"src_locales_sq_js"],"./sr.js":[84072,"src_locales_sr_js"],"./st.js":[58413,"src_locales_st_js"],"./sv-SE.js":[88395,"src_locales_sv-SE_js"],"./sv.js":[80919,"src_locales_sv_js"],"./sw.js":[38397,"src_locales_sw_js"],"./ta.js":[27908,"src_locales_ta_js"],"./te.js":[83950,"src_locales_te_js"],"./th.js":[33683,"src_locales_th_js"],"./tl.js":[43909,"src_locales_tl_js"],"./tr.js":[65320,"src_locales_tr_js"],"./tt.js":[99083,"src_locales_tt_js"],"./ug.js":[34557,"src_locales_ug_js"],"./uk.js":[5034,"src_locales_uk_js"],"./ur.js":[2978,"src_locales_ur_js"],"./uz.js":[38964,"src_locales_uz_js"],"./vi.js":[88695,"src_locales_vi_js"],"./wo.js":[36511,"src_locales_wo_js"],"./zh-CN.js":[42640,"src_locales_zh-CN_js"],"./zh-HK.js":[17264,"src_locales_zh-HK_js"],"./zh-TW.js":[34573,"src_locales_zh-TW_js"],"./zh-YUE.js":[17662,"src_locales_zh-YUE_js"]};function e(c){if(!t.o(i,c))return Promise.resolve().then(()=>{var n=new Error("Cannot find module '"+c+"'");throw n.code="MODULE_NOT_FOUND",n});var u=i[c],r=u[0];return t.e(u[1]).then(()=>t.t(r,23))}e.keys=()=>Object.keys(i),e.id=51230,H.exports=e},87983:(H,D,t)=>{var i={"./af.js":[61225,"src_vendor_ckeditor_translations_af_js"],"./ar.js":[99858,"src_vendor_ckeditor_translations_ar_js"],"./ast.js":[85552,"src_vendor_ckeditor_translations_ast_js"],"./az.js":[73469,"src_vendor_ckeditor_translations_az_js"],"./bg.js":[44512,"src_vendor_ckeditor_translations_bg_js"],"./bs.js":[28453,"src_vendor_ckeditor_translations_bs_js"],"./ca.js":[26287,"src_vendor_ckeditor_translations_ca_js"],"./cs.js":[4543,"src_vendor_ckeditor_translations_cs_js"],"./da.js":[23677,"src_vendor_ckeditor_translations_da_js"],"./de-ch.js":[94783,"src_vendor_ckeditor_translations_de-ch_js"],"./de.js":[21005,"src_vendor_ckeditor_translations_de_js"],"./el.js":[77507,"src_vendor_ckeditor_translations_el_js"],"./en-au.js":[81258,"src_vendor_ckeditor_translations_en-au_js"],"./en-gb.js":[90287,"src_vendor_ckeditor_translations_en-gb_js"],"./eo.js":[90298,"src_vendor_ckeditor_translations_eo_js"],"./es.js":[88151,"src_vendor_ckeditor_translations_es_js"],"./et.js":[47523,"src_vendor_ckeditor_translations_et_js"],"./eu.js":[27170,"src_vendor_ckeditor_translations_eu_js"],"./fa.js":[44090,"src_vendor_ckeditor_translations_fa_js"],"./fi.js":[37469,"src_vendor_ckeditor_translations_fi_js"],"./fr.js":[34457,"src_vendor_ckeditor_translations_fr_js"],"./gl.js":[7652,"src_vendor_ckeditor_translations_gl_js"],"./gu.js":[68407,"src_vendor_ckeditor_translations_gu_js"],"./he.js":[27929,"src_vendor_ckeditor_translations_he_js"],"./hi.js":[35011,"src_vendor_ckeditor_translations_hi_js"],"./hr.js":[49871,"src_vendor_ckeditor_translations_hr_js"],"./hu.js":[44330,"src_vendor_ckeditor_translations_hu_js"],"./id.js":[12297,"src_vendor_ckeditor_translations_id_js"],"./it.js":[94680,"src_vendor_ckeditor_translations_it_js"],"./ja.js":[32041,"src_vendor_ckeditor_translations_ja_js"],"./km.js":[5338,"src_vendor_ckeditor_translations_km_js"],"./kn.js":[42542,"src_vendor_ckeditor_translations_kn_js"],"./ko.js":[55539,"src_vendor_ckeditor_translations_ko_js"],"./ku.js":[50326,"src_vendor_ckeditor_translations_ku_js"],"./lt.js":[99071,"src_vendor_ckeditor_translations_lt_js"],"./lv.js":[10779,"src_vendor_ckeditor_translations_lv_js"],"./ms.js":[20624,"src_vendor_ckeditor_translations_ms_js"],"./nb.js":[38611,"src_vendor_ckeditor_translations_nb_js"],"./ne.js":[12749,"src_vendor_ckeditor_translations_ne_js"],"./nl.js":[48140,"src_vendor_ckeditor_translations_nl_js"],"./no.js":[41831,"src_vendor_ckeditor_translations_no_js"],"./oc.js":[90459,"src_vendor_ckeditor_translations_oc_js"],"./pl.js":[79377,"src_vendor_ckeditor_translations_pl_js"],"./pt-br.js":[97416,"src_vendor_ckeditor_translations_pt-br_js"],"./pt.js":[55567,"src_vendor_ckeditor_translations_pt_js"],"./ro.js":[87462,"src_vendor_ckeditor_translations_ro_js"],"./ru.js":[25675,"src_vendor_ckeditor_translations_ru_js"],"./si.js":[89298,"src_vendor_ckeditor_translations_si_js"],"./sk.js":[78948,"src_vendor_ckeditor_translations_sk_js"],"./sl.js":[6921,"src_vendor_ckeditor_translations_sl_js"],"./sq.js":[92816,"src_vendor_ckeditor_translations_sq_js"],"./sr-latn.js":[67221,"src_vendor_ckeditor_translations_sr-latn_js"],"./sr.js":[91817,"src_vendor_ckeditor_translations_sr_js"],"./sv.js":[53530,"src_vendor_ckeditor_translations_sv_js"],"./th.js":[58264,"src_vendor_ckeditor_translations_th_js"],"./tk.js":[80801,"src_vendor_ckeditor_translations_tk_js"],"./tr.js":[57018,"src_vendor_ckeditor_translations_tr_js"],"./tt.js":[54570,"src_vendor_ckeditor_translations_tt_js"],"./ug.js":[25899,"src_vendor_ckeditor_translations_ug_js"],"./uk.js":[66516,"src_vendor_ckeditor_translations_uk_js"],"./uz.js":[36527,"src_vendor_ckeditor_translations_uz_js"],"./vi.js":[26661,"src_vendor_ckeditor_translations_vi_js"],"./zh-cn.js":[55739,"src_vendor_ckeditor_translations_zh-cn_js"],"./zh.js":[86908,"src_vendor_ckeditor_translations_zh_js"]};function e(c){if(!t.o(i,c))return Promise.resolve().then(()=>{var n=new Error("Cannot find module '"+c+"'");throw n.code="MODULE_NOT_FOUND",n});var u=i[c],r=u[0];return t.e(u[1]).then(()=>t.t(r,23))}e.keys=()=>Object.keys(i),e.id=87983,H.exports=e}},H=>{H.O(0,["vendor"],()=>{return i=64970,H(H.s=i);var i});H.O()}]);
//# sourceMappingURL=main.a2dfd2e9ad43d6f9d27e.js.map